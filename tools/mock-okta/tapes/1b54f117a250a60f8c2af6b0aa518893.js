var path = require("path");

/**
 * GET /assets/js/mvc/loginpage/main-loginpage.pack.c671060fbf5f48a63eb447b6598635cc.js
 *
 * host: rain.okta1.com:1802
 * connection: keep-alive
 * user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:48.0) Gecko/20100101 Firefox/48.0
 * accept: * / *
 * accept-encoding: gzip
 * accept-language: en-US
 * cookie: DT=DI09dwIAl6ESbSY9ZSYutykqA; t=default; JSESSIONID=69C1B054FE222DF6D4657F037DB1CFFF
 * cache-control: no-cache, no-store
 * pragma: no-cache
 */

module.exports = function (req, res) {
  res.statusCode = 200;

  res.setHeader("server", "Apache-Coyote/1.1");
  res.setHeader("accept-ranges", "bytes");
  res.setHeader("etag", "W/\"1782172-1502281784000\"");
  res.setHeader("last-modified", "Wed, 09 Aug 2017 12:29:44 GMT");
  res.setHeader("content-type", "text/javascript");
  res.setHeader("content-length", "1782172");
  res.setHeader("date", "Thu, 10 Aug 2017 23:14:48 GMT");

  res.setHeader("x-yakbak-tape", path.basename(__filename, ".js"));

  res.write(new Buffer("dmFyIGluaXRMb2dpblBhZ2UgPQovKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwoKLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7CgovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKCi8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWV4cG9ydHM6IHt9LAovKioqKioqLyAJCQlpZDogbW9kdWxlSWQsCi8qKioqKiovIAkJCWxvYWRlZDogZmFsc2UKLyoqKioqKi8gCQl9OwoKLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sb2FkZWQgPSB0cnVlOwoKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KCgovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXykKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CgovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7CgovKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ucCA9ICIiOwoKLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCS8qIGVzbGludCBtYXgtcGFyYW1zOiBbMiwgNl0sIG1heC1zdGF0ZW1lbnRzOiBbMiwgMzBdICovCgkvKiBnbG9iYWwgZ29vZ2xlLCBtb2R1bGUgKi8KCgl2YXIgT2t0YVNpZ25JbiA9IF9fd2VicGFja19yZXF1aXJlX18oMSksCgkgICAgVXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMyksCgkgICAgQWNjb3VudENob29zZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSwKCSAgICBpbml0TW9iaWxlU1NPID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyksCgkgICAgJCA9IF9fd2VicGFja19yZXF1aXJlX18oNCksCgkgICAgXyA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29uZmlnKSB7CgoJICB2YXIgdXNlcm5hbWU7CgkgIHZhciBpc0Nocm9tZU9zID0gZmFsc2U7CgkgIHZhciBjaHJvbWVPc0FkZCA9ICQuRGVmZXJyZWQoKTsKCSAgdmFyIGNocm9tZU9zQ29tcGxldGUgPSAkLkRlZmVycmVkKCk7CgkgIHZhciB3YWl0Rm9yQ2hyb21lT3NDYWxsYmFjayA9IGZhbHNlOwoKCSAgZnVuY3Rpb24gc3VjY2Vzc0Z1bmMocmVzKSB7CgkgICAgLy8gTW9iaWxlIGFwcCBleHRlbnNpb24KCSAgICBpZiAoY29uZmlnLmlzTW9iaWxlQ2xpZW50TG9naW4pIHsKCSAgICAgIHdpbmRvdy53ZWJraXQubWVzc2FnZUhhbmRsZXJzLmxvZ2luTWVzc2FnZS5wb3N0TWVzc2FnZSh7CgkgICAgICAgIHRva2VuOiByZXMuc2Vzc2lvbi50b2tlbgoJICAgICAgfSk7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICAvLyBTQU1MIFNQLWluaXQ6IFJlcG9zdCBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzb21ldGltZXMgdGhlIHBvc3QgcGFyYW1zIG1ha2UKCSAgICAvLyB0aGUgcmVkaXJlY3RVcmkgdG9vIGxvbmcgKGJyb3dzZXJzIGFjY2VwdCBhcm91bmQgMjAwMCBjaGFycykuCgkgICAgLy8gVGhpcyB3aWxsIG5vIGxvbmdlciBiZSBuZWNlc3Nhcnkgb25jZSB3ZSBzdGFydCBjYWNoaW5nIHRoZSBzYW1sIHBhcmFtcy4KCSAgICBpZiAoY29uZmlnLnJlcG9zdCkgewoJICAgICAgVXRpbC5wb3N0VG9VcmwoY29uZmlnLnNpZ25Jbi5iYXNlVXJsICsgJy9sb2dpbi9zZXNzaW9uQ29va2llUmVkaXJlY3Q/Y2hlY2tBY2NvdW50U2V0dXBDb21wbGV0ZT10cnVlJnJlcG9zdD10cnVlJyArICcmdG9rZW49JyArIGVuY29kZVVSSUNvbXBvbmVudChyZXMuc2Vzc2lvbi50b2tlbikgKwoJICAgICAgLy8gZnJvbVVyaSAocmVsYXRpdmUgdXJsKSBpcyB1c2VkIHJhdGhlciB0aGFuIHJlZGlyZWN0VXJsIChhYnNvbHV0ZSB1cmwpIGJlY2F1c2UKCSAgICAgIC8vIGN1cnJlbnRseSBvbmx5IHJlbGF0aXZlIHVybHMgYXJlIHJlcG9zdGVkIHByb3Blcmx5ICh1c2luZyBmb3J3YXJkKQoJICAgICAgJyZyZWRpcmVjdFVybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGNvbmZpZy5mcm9tVXJpKSwgJCgnYm9keScpKTsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIC8vIE9LVEEtMTAyMjE3IEhBQ0sgdG8gZml4IG5ldyByZWxlYXNlIG9mIE1pY3Jvc29mdCBhcHBzIGZvciBpT1MgMTAsIHdoaWNoIHRyaWdnZXIgZG91YmxlIHJlcXVlc3QgdG8gdGhpcyBVUkwKCSAgICAvL2lmIChVdGlsLnVzZXJBZ2VudElzSW9zMTAobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsKCSAgICBpZiAoY29uZmlnLmF2b2lkRG91YmxlUmVxdWVzdE1TSW9zQXBwICYmIFV0aWwudXNlckFnZW50SXNJb3MxMChuYXZpZ2F0b3IudXNlckFnZW50KSkgewoJICAgICAgaGFja1JlZGlyZWN0V2l0aFBvcnRBZGRlZE9yUmVtb3ZlZChyZXMpOwoJICAgICAgcmV0dXJuOwoJICAgIH0KCgkgICAgLy8gTm9ybWFsIGZsb3c6IE5hdmlnYXRlIHRvIHRoZSBzZXNzaW9uQ29va2llUmVkaXJlY3QgZW5kcG9pbnQKCSAgICByZXMuc2Vzc2lvbi5zZXRDb29raWVBbmRSZWRpcmVjdChjb25maWcucmVkaXJlY3RVcmkpOwoJICB9CgoJICBmdW5jdGlvbiBoYWNrUmVkaXJlY3RXaXRoUG9ydEFkZGVkT3JSZW1vdmVkKHJlcykgewoJICAgIC8vIEhhY2sgaGVyZSBpcyB0byBhcHBlbmQgOjgwIG9yIDo0NDMgdG8gYmFzZVVybCAob3IgcmVtb3ZlIGl0KSBhbmQgcmVkaXJlY3QgdG8gdGhhdCBiYXNlIFVSTC4KCSAgICAvLyBGb3Igc29tZSByZWFzb24sIHRoaXMgcHJldmVudHMgdGhlIGRvdWJsZSByZXF1ZXN0IGNhdXNlZCBieSBNaWNyb3NvZnQgYXBwcyBmb3IgaU9TIDEwIHdoaWNoIGludmFsaWRhdGVzIHRoZSBPVFQKCSAgICB2YXIgaGFja0hvc3RuYW1lVXJsID0gVXRpbC5iYXNlVXJsV2l0aFBvcnRBZGRlZE9yUmVtb3ZlZChjb25maWcuc2lnbkluLmJhc2VVcmwpOwoKCSAgICAvLyBVUkwgY29uc3RydWN0aW9uIGxvZ2ljIGNvdXJ0ZXN5IG9mIHNldENvb2tpZUFuZFJlZGlyZWN0KCkncyBpbXBsCgkgICAgLy8gQXBwZW5kaW5nICdtb2RpZmllZEJhc2VVcmw9dHJ1ZScgZm9yIHRyYWNraW5nIHB1cnBvc2VzCgkgICAgdmFyIHF1ZXJ5UGFyYW1zID0gVXRpbC50b1F1ZXJ5UGFyYW1zKHsKCSAgICAgICdjaGVja0FjY291bnRTZXR1cENvbXBsZXRlJzogdHJ1ZSwKCSAgICAgICd0b2tlbic6IHJlcy5zZXNzaW9uLnRva2VuLAoJICAgICAgJ3JlZGlyZWN0VXJsJzogY29uZmlnLnJlZGlyZWN0VXJpLAoJICAgICAgJ21vZGlmaWVkQmFzZVVybCc6IHRydWUgfSk7CgkgICAgdmFyIGhhY2tSZWRpcmVjdFVybCA9IGhhY2tIb3N0bmFtZVVybCArICcvbG9naW4vc2Vzc2lvbkNvb2tpZVJlZGlyZWN0JyArIHF1ZXJ5UGFyYW1zOwoKCSAgICB3aW5kb3cubG9jYXRpb24gPSBoYWNrUmVkaXJlY3RVcmw7CgkgIH0KCgkgIGZ1bmN0aW9uIG5vdGlmeUFjY291bnRDaG9vc2VyKHJlcywgYWNjb3VudENob29zZXIpIHsKCSAgICB2YXIgc3VjY2VzcyA9IF8ucGFydGlhbChzdWNjZXNzRnVuYywgcmVzKTsKCSAgICBpZiAoYWNjb3VudENob29zZXIpIHsKCSAgICAgIGFjY291bnRDaG9vc2VyLmxvZ2luKHJlcy51c2VyLnByb2ZpbGUsIHN1Y2Nlc3MpOwoJICAgIH0gZWxzZSB7CgkgICAgICAvLyBFTkdfQUNDT1VOVF9DSE9PU0VSX1BVQkxJU0ggZmVhdHVyZSBpcyBub3QgZW5hYmxlZCAtIHBlcmZvcm0gc3VjY2VzcwoJICAgICAgLy8gYWN0aW9ucyBpbW1lZGlhdGVseS4KCSAgICAgIHN1Y2Nlc3MoKTsKCSAgICB9CgkgIH0KCgkgIGZ1bmN0aW9uIHByb2Nlc3NDcmVkcyhjcmVkcykgewoJICAgIGlmICghaXNDaHJvbWVPcykgewoJICAgICAgcmV0dXJuOwoJICAgIH0KCSAgICB1c2VybmFtZSA9IGNyZWRzLnVzZXJuYW1lOwoJICAgIHZhciBkZXRhaWxzID0gewoJICAgICAgdG9rZW46IGNyZWRzLnVzZXJuYW1lLAoJICAgICAgdXNlcjogY3JlZHMudXNlcm5hbWUsCgkgICAgICBwYXNzd29yZEJ5dGVzOiBjcmVkcy5wYXNzd29yZCwKCSAgICAgIGtleVR5cGU6ICdLRVlfVFlQRV9QQVNTV09SRF9QTEFJTicKCSAgICB9OwoJICAgIGlmIChjaHJvbWVPc0FkZC5zdGF0ZSgpICE9PSAncGVuZGluZycpIHsKCSAgICAgIGNocm9tZU9zQWRkID0gJC5EZWZlcnJlZCgpOwoJICAgIH0KCSAgICB3YWl0Rm9yQ2hyb21lT3NDYWxsYmFjayA9IHRydWU7CgkgICAgZ29vZ2xlLnByaW5jaXBhbC5hZGQoZGV0YWlscywgZnVuY3Rpb24gKCkgewoJICAgICAgY2hyb21lT3NBZGQucmVzb2x2ZSgpOwoJICAgIH0pOwoJICB9CgoJICAvLyBUaGlzIHByZXZlbnRzIGFuIGVtcHR5IGN1c3RvbSBrZXkgdGhhdCBjb21lIGluIGZyb20gdGhlIGFkbWluIGN1c3RvbWl6YXRpb24KCSAgLy8gZnJvbSBvdmVycmlkaW5nIGEgbG9jYWxpemVkIGxvZ2luIGtleS4KCSAgdmFyIG92ZXJyaWRlcyA9IGNvbmZpZy5zaWduSW4uaTE4bltjb25maWcuc2lnbkluLmxhbmd1YWdlXTsKCSAgXy5lYWNoKG92ZXJyaWRlcywgZnVuY3Rpb24gKHZhbHVlLCBsYWJlbCkgewoJICAgIGlmICghdmFsdWUpIHsKCSAgICAgIGRlbGV0ZSBvdmVycmlkZXNbbGFiZWxdOwoJICAgIH0KCSAgfSk7CgoJICBjb25maWcuc2lnbkluLmFzc2V0cy5yZXdyaXRlID0gVXRpbC5hc3NldFJld3JpdGU7CgoJICBjb25maWcuc2lnbkluLmZlYXR1cmVzLnJvdXRlciA9IFV0aWwuc3VwcG9ydHNSb3V0ZXIoKTsKCgkgIHZhciBhY2NvdW50Q2hvb3NlcjsKCSAgaWYgKGNvbmZpZy5wdWJsaXNoVG9BY2NvdW50Q2hvb3NlcikgewoJICAgIGFjY291bnRDaG9vc2VyID0gbmV3IEFjY291bnRDaG9vc2VyKHsKCSAgICAgIGRpc2NvdmVyeVVybDogY29uZmlnLmFjY291bnRDaG9vc2VyRGlzY292ZXJ5VXJsCgkgICAgfSk7CgkgIH0KCgkgIC8qIGVzbGludCBjb21wbGV4aXR5OiBbMiwgOF0qLwoJICBpZiAoY29uZmlnLmVuYWJsZVVybEZpeEZvckVtYmVkZGVkQnJvd3NlcnMgJiYgVXRpbC5pc0xvZ2luVXJsU3RhbGUoY29uZmlnLmxvZ2luUGFnZVVybFJlZGlyZWN0LCBsb2NhdGlvbi5ocmVmKSkgewoJICAgIC8vRm9yIGNlcnRhaW4gZW1iZWRkZWQgYnJvd3NlcnMgKGFkb2JlIGFpcikgd2hpbGUgbG9hZGluZyB0aGUgbG9naW4gcGFnZSBhZnRlciBhIDMwMiByZWRpcmVjdGlvbiBmb3IKCSAgICAvL25vbi1sb2dnZWQgaW4gdXNlcnMsIHRoZSBwcm9ibGVtIGlzIHRoYXQgdGhlIHdpbmRvdy5sb2NhdGlvbiBvYmplY3QgKHdoaWNoIGhvbGRzIGF0dHJpYnV0ZWQgbGlrZSBocmVmLAoJICAgIC8vcGF0aG5hbWUgYW5kIHNlYXJjaCkgaXMgZGlmZmVyZW50IGNvbXBhcmVkIHRvIHRoYXQgb24gdGhlIGJyb3dzZXIuCgkgICAgLy9IZW5jZSB0aGUgbG9jYXRpb24uaHJlZiBuZWVkcyB0byBiZSBhZGp1c3RlZCB0byBpbmNsdWRlIHRoZSBmdWxsIGZyb21VUkkgdmFsdWUKCSAgICAvL3NvIHRoYXQgdGhlIHJvdXRpbmcgd29ya3MgY29ycmVjdGx5Lk9LVEEtMTA5MTQxCgkgICAgVXRpbC5hZGp1c3RVcmxQYXRoKGNvbmZpZy5sb2dpblBhZ2VVcmxSZWRpcmVjdCk7CgkgIH0KCgkgIHZhciBva3RhU2lnbkluID0gbmV3IE9rdGFTaWduSW4oY29uZmlnLnNpZ25Jbik7CgkgIG9rdGFTaWduSW4ucmVuZGVyRWwoewoJICAgIGVsOiBjb25maWcuc2lnbkluLmVsLAoJICAgIHByb2Nlc3NDcmVkczogcHJvY2Vzc0NyZWRzCgkgIH0sIGZ1bmN0aW9uIChyZXMpIHsKCSAgICAvLyBPa3RhIGxvZ2luIHBhZ2UgZG9lcyBub3QgY2FyZSBhYm91dCBub24tc3VjY2VzcyByZXNwb25zZXMKCSAgICBpZiAocmVzLnN0YXR1cyAhPT0gJ1NVQ0NFU1MnKSB7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICAvKgoJICAgICAqIEZvciBpbmZvIG9uIHdhaXRGb3JDaHJvbWVPc0NhbGxiYWNrLCBsb29rIGF0IE9LVEEtMTI3MzUzLgoJICAgICAqIElmIHNpZ24gaW4gd2lkZ2V0IHdhcyBsb2FkZWQgb24gYSBjaHJvbWUgZGV2aWNlIGRpcmVjdGx5IG9uIE1GQSBwYWdlLCBwcm9jZXNzIGNyZWRzIHdpbGwgbm90IGJlIGNhbGxlZC4KCSAgICAgKiBDaGVjayBpZiBpdCBoYXMgYmVlbiBjYWxsZWQgYW5kIG9ubHkgdGhlbiBnbyB0aHJvdWdoIHRoaXMgYmxvY2suCgkgICAgICovCgkgICAgaWYgKGNvbmZpZy5oYXNDaHJvbWVPU0ZlYXR1cmUgJiYgaXNDaHJvbWVPcyAmJiB3YWl0Rm9yQ2hyb21lT3NDYWxsYmFjaykgewoJICAgICAgJC53aGVuKGNocm9tZU9zQWRkKS50aGVuKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgZ29vZ2xlLnByaW5jaXBhbC5jb21wbGV0ZSh7IHRva2VuOiB1c2VybmFtZSB9LCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgY2hyb21lT3NDb21wbGV0ZS5yZXNvbHZlKCk7CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgICAkLndoZW4oY2hyb21lT3NBZGQsIGNocm9tZU9zQ29tcGxldGUpLnRoZW4oZnVuY3Rpb24gKCkgewoJICAgICAgICBub3RpZnlBY2NvdW50Q2hvb3NlcihyZXMsIGFjY291bnRDaG9vc2VyKTsKCSAgICAgIH0pOwoJICAgIH0gZWxzZSB7CgkgICAgICBub3RpZnlBY2NvdW50Q2hvb3NlcihyZXMsIGFjY291bnRDaG9vc2VyKTsKCSAgICB9CgkgIH0pOwoKCSAgVXRpbC5jbGVhckJlZW5Ub0hvbWVQYWdlKCk7CgkgIFV0aWwucmVzZXRBdXRvTGF1bmNoKCk7CgoJICBpZiAoY29uZmlnLmlzTW9iaWxlU1NPKSB7CgkgICAgaW5pdE1vYmlsZVNTTyhjb25maWcucmVkaXJlY3RVcmksIGNvbmZpZy5saW5rUGFyYW1zKTsKCSAgfQoKCSAgaWYgKGNvbmZpZy5oYXNDaHJvbWVPU0ZlYXR1cmUpIHsKCSAgICBnb29nbGUgJiYgZ29vZ2xlLnByaW5jaXBhbC5pbml0aWFsaXplKGZ1bmN0aW9uICgpIHsKCSAgICAgIGlzQ2hyb21lT3MgPSB0cnVlOwoJICAgIH0pOwoJICB9CgoJICBpZiAoY29uZmlnLnNob3dMaW5rVG9BcHBTdG9yZSkgewoJICAgICQuc21hcnRiYW5uZXIoeyAndGl0bGUnOiAnT2t0YSBNb2JpbGUnLCAnYXV0aG9yJzogJ09rdGEsIEluYy4nIH0pOwoJICB9CgkgIC8vIFRvIGRpc2FibGUgdGhlIHZhcmlvdXMgYnJvd3NlcnMnIG1lY2hhbmlzbXMgZm9yIHNhdmluZyBwYXNzd29yZHMsIHdlIGRvIHRoaXM6CgkgIC8vIFRoZSBzaWduLWluIHdpZGdldCBzZXRzIG9mZiBhIHRyaWdnZXIgb25jZSB0aGUgcHJpbWFyeSBhdXRoIC8gcmVzZXQgcGFzc3dvcmQgZm9ybSBpcyBsb2FkZWQKCSAgLy8gV2UgY2FwdHVyZSB0aGUgZXZlbnQgaGVyZSBhbmQgYWRkIGJyb3dzZXIgc3BlY2lmaWMgcGFzc3dvcmQgamFtbWVycyBhcyBiZWxvdzoKCSAgLy8gMSkgU2FmYXJpIHJlcXVpcmVzIGFuIGVtcHR5IGV4dHJhIHBhc3N3b3JkIGZpZWxkIGF0IHRoZSB0b3AsCgkgIC8vICAgIHdoaWNoIGlzICJ2aXNpYmxlIiBhbmQgb24gdGhlIHNjcmVlbi4gV2UgZ2V0IGFyb3VuZCB0aGlzIHdpdGggaW5qZWN0aW5nCgkgIC8vICAgIGVsZW1lbnRzIHdpdGggd2lkdGggYW5kIGhlaWdodCBlcXVhbCB0byB6ZXJvCgkgIC8vIDIpIEZpcmVmb3ggcmVxdWlyZXMgZXh0cmEgYm9ndXMgZmlsbGVkIHBhc3N3b3JkIGVsZW1lbnRzCgkgIC8vIDMpIENocm9tZSBsb29rcyBmb3IgYSBwYXNzd29yZCBmaWVsZHMgYW5kIGEgbmVhcmVzdCB0ZXh0CgkgIC8vICAgIGZpZWxkIHRvIGRldGVjdCB1c2VybmFtZS1wYXNzd29yZCBwYWlyLiBXZSBnZXQKCSAgLy8gICAgYXJvdW5kIHRoaXMgYnkgYWRkaW5nIGFkZGl0aW9uYWwgdXNlcm5hbWUtcGFzc3dvcmQgcGFpcnMKCSAgLy8gICAgdG8gdHJpY2sgdGhlIGJyb3dzZXIuCgkgIC8vICAgIEFkZGl0aW9uYWxseSwgY2hyb21lIHJlcXVpcmVzIHRoZSBhZGRpdGlvbmFsIGVsZW1lbnRzIHRvCgkgIC8vICAgIGJlIHByZXBlbmRlZAoJICAvLyA0KSBUT0RPOiBPdGhlciBicm93c2VycyAoSUUpCgoJICBpZiAoY29uZmlnLnByZXZlbnRCcm93c2VyRnJvbVNhdmluZ09rdGFQYXNzd29yZCkgewoJICAgIG9rdGFTaWduSW4ub24oJ3BhZ2VSZW5kZXJlZCcsIGZ1bmN0aW9uICgpIHsKCSAgICAgIC8vIE9uY2UgcGFnZSBpcyByZW5kZXJlZCwgYWRkIHBhc3N3b3JkIGphbW1lcnMgaWYgcGFzc3dvcmQgaW5wdXRzCgkgICAgICAvLyBhcmUgcHJlc2VudCBvbiB0aGUgcmVuZGVyZWQgcGFnZQoJICAgICAgdmFyIHBhc3N3b3JkRmllbGRzID0gJCgnI29rdGEtc2lnbi1pbiA6cGFzc3dvcmQnKTsKCSAgICAgIGlmIChwYXNzd29yZEZpZWxkcy5sZW5ndGggPiAwKSB7CgkgICAgICAgIFV0aWwuYWRkUGFzc3dvcmRKYW1tZXJzKCQoJyNva3RhLXNpZ24taW4gZm9ybScpKTsKCSAgICAgIH0KCSAgICB9KTsKCSAgfQoJfTsKCi8qKiovIH0sCi8qIDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyohCgkgKiBDb3B5cmlnaHQgKGMpIDIwMTUtMjAxNiwgT2t0YSwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCgkgKiBUaGUgT2t0YSBzb2Z0d2FyZSBhY2NvbXBhbmllZCBieSB0aGlzIG5vdGljZSBpcyBwcm92aWRlZCBwdXJzdWFudCB0byB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UuIikKCSAqIAoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMC4KCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQKCSAqIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIAoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqIAoJICovCgkhZnVuY3Rpb24odCxlKXsgdHJ1ZT9tb2R1bGUuZXhwb3J0cz1lKF9fd2VicGFja19yZXF1aXJlX18oMikpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsianF1ZXJ5Il0sZSk6Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuT2t0YVNpZ25Jbj1lKHJlcXVpcmUoImpxdWVyeSIpKTp0Lk9rdGFTaWduSW49ZSh0LmpRdWVyeSl9KHRoaXMsZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV82X18pe3JldHVybiBmdW5jdGlvbih0KXtmdW5jdGlvbiBlKG4pe2lmKGlbbl0pcmV0dXJuIGlbbl0uZXhwb3J0czt2YXIgcj1pW25dPXtleHBvcnRzOnt9LGlkOm4sbG9hZGVkOiExfTtyZXR1cm4gdFtuXS5jYWxsKHIuZXhwb3J0cyxyLHIuZXhwb3J0cyxlKSxyLmxvYWRlZD0hMCxyLmV4cG9ydHN9dmFyIGk9e307cmV0dXJuIGUubT10LGUuYz1pLGUucD0iIixlKDApfShbZnVuY3Rpb24odCxlLGkpe3ZhciBuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxuKXtmdW5jdGlvbiBzKGUpe3Quc2Vzc2lvbi5leGlzdHMoKS50aGVuKGUpfWZ1bmN0aW9uIG8oZSl7dC5zZXNzaW9uLmNsb3NlKCkudGhlbihlKS5mYWlsKGZ1bmN0aW9uKCl7ZSgiVGhlcmUgd2FzIGEgcHJvYmxlbSBjbG9zaW5nIHRoZSBzZXNzaW9uIil9KX1mdW5jdGlvbiBhKGUpe3Quc2Vzc2lvbi5yZWZyZXNoKCkudGhlbihlKS5mYWlsKGZ1bmN0aW9uKCl7ZSh7c3RhdHVzOiJJTkFDVElWRSJ9KX0pfWZ1bmN0aW9uIGwoZSxpLG4pe3QuaWRUb2tlbi5yZWZyZXNoKG4pLnRoZW4oaSkuZmFpbChmdW5jdGlvbigpe2koIlRoZXJlIHdhcyBhIHByb2JsZW0gcmVmcmVzaGluZyB0aGUgaWRfdG9rZW4iKX0pfWZ1bmN0aW9uIGMoZSl7dC5zZXNzaW9uLmdldCgpLnRoZW4oZnVuY3Rpb24odCl7IkFDVElWRSI9PT10LnN0YXR1cyYmdC51c2VyJiYodC51c2VyPXIucGljayh0LnVzZXIsImlkIiwicHJvZmlsZSIsInBhc3N3b3JkQ2hhbmdlZCIpKSxlKHQpfSl9ZnVuY3Rpb24gdShpLHMsbyl7aWYoXyl0aHJvdyJBbiBpbnN0YW5jZSBvZiB0aGUgd2lkZ2V0IGhhcyBhbHJlYWR5IGJlZW4gcmVuZGVyZWQuIENhbGwgcmVtb3ZlKCkgZmlyc3QuIjtfPW5ldyBlKHIuZXh0ZW5kKHt9LG4saSx7YXV0aENsaWVudDp0LGdsb2JhbFN1Y2Nlc3NGbjpzLGdsb2JhbEVycm9yRm46b30pKSxfLnN0YXJ0KCl9ZnVuY3Rpb24gZCgpe18mJl8uaGlkZSgpfWZ1bmN0aW9uIGgoKXtfJiZfLnNob3coKX1mdW5jdGlvbiBwKCl7XyYmKF8ucmVtb3ZlKCksXz12b2lkIDApfWZ1bmN0aW9uIGYoKXtyZXR1cm4gaS5oYXNUb2tlbnNJbkhhc2god2luZG93LmxvY2F0aW9uLmhhc2gpfWZ1bmN0aW9uIG0oZSxpKXt0LnRva2VuLnBhcnNlRnJvbVVybCgpLnRoZW4oZSkuZmFpbChpKX12YXIgXztyZXR1cm57cmVuZGVyRWw6dSxzaWduT3V0Om8saWRUb2tlbjp7cmVmcmVzaDpsfSxzZXNzaW9uOntjbG9zZTpvLGV4aXN0czpzLGdldDpjLHJlZnJlc2g6YX0sdG9rZW46e2hhc1Rva2Vuc0luVXJsOmYscGFyc2VUb2tlbnNGcm9tVXJsOm19LHRva2VuTWFuYWdlcjp0LnRva2VuTWFuYWdlcixoaWRlOmQsc2hvdzpoLHJlbW92ZTpwfX1mdW5jdGlvbiBlKGUpe3ZhciBzLG8sYSxsO2koMiksaSg0KSxpKDUpLHM9aSg4KSxvPWkoMzEpLGw9aSgyOTApLGE9bmV3IHMoe3VybDplLmJhc2VVcmwsdHJhbnNmb3JtRXJyb3JYSFI6by50cmFuc2Zvcm1FcnJvclhIUixoZWFkZXJzOnsiWC1Pa3RhLVVzZXItQWdlbnQtRXh0ZW5kZWQiOiJva3RhLXNpZ25pbi13aWRnZXQtIituLnZlcnNpb259LGNsaWVudElkOmUuY2xpZW50SWQscmVkaXJlY3RVcmk6ZS5yZWRpcmVjdFVyaX0pLHIuZXh0ZW5kKHRoaXMsbC5wcm90b3R5cGUuRXZlbnRzLHQoYSxsLG8sZSkpLHRoaXMubGlzdGVuVG8obC5wcm90b3R5cGUsImFsbCIsdGhpcy50cmlnZ2VyKX12YXIgbj1pKDEpLHI9aSgyKTtyZXR1cm4gZX0oKTt0LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9e3ZlcnNpb246IjIuMS4wIixzdXBwb3J0ZWRMYW5ndWFnZXM6WyJlbiIsImNzIiwiZGEiLCJkZSIsImVzIiwiZmkiLCJmciIsImh1IiwiaWQiLCJpbiIsIml0IiwiamEiLCJrbyIsIm1zIiwibmwtTkwiLCJwbCIsInB0LUJSIiwicm8iLCJydSIsInN2IiwidGgiLCJ1ayIsInpoLUNOIiwiemgtVFciXX19LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMyksaSg0KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXQubm9Db25mbGljdCgpO3JldHVybiBpLm1peGluKHtyZXN1bHRDdHg6ZnVuY3Rpb24odCxlLG4scil7dmFyIHM9aS5pc09iamVjdCh0KT90W2VdOnZvaWQgMDtyZXR1cm4gaS5pc0Z1bmN0aW9uKHMpJiYocz1zLmNhbGwobnx8dCkpLHM/czppLmlzVW5kZWZpbmVkKHIpP3M6cn0saXNJbnRlZ2VyOmZ1bmN0aW9uKHQpe3JldHVybiBpLmlzTnVtYmVyKHQpJiZ0JTE9PT0wfSx0ZW1wbGF0ZTpmdW5jdGlvbih0LGkpe3ZhciBuPWUuY29tcGlsZSh0KTtyZXR1cm4gaT9uKGkpOmZ1bmN0aW9uKHQpe3JldHVybiBuKHQpfX19KSxpfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyOy8vICAgICBVbmRlcnNjb3JlLmpzIDEuOC4zCgkvLyAgICAgKGMpIDIwMDktMjAxNSBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9ycwoJLy8gICAgIFVuZGVyc2NvcmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCgkoZnVuY3Rpb24oKXtmdW5jdGlvbiBpKHQpe2Z1bmN0aW9uIGUoZSxpLG4scixzLG8pe2Zvcig7cz49MCYmczxvO3MrPXQpe3ZhciBhPXI/cltzXTpzO249aShuLGVbYV0sYSxlKX1yZXR1cm4gbn1yZXR1cm4gZnVuY3Rpb24oaSxuLHIscyl7bj1rKG4scyw0KTt2YXIgbz0hWShpKSYmTS5rZXlzKGkpLGE9KG98fGkpLmxlbmd0aCxsPXQ+MD8wOmEtMTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwzJiYocj1pW28/b1tsXTpsXSxsKz10KSxlKGksbixyLG8sbCxhKX19ZnVuY3Rpb24gcyh0KXtyZXR1cm4gZnVuY3Rpb24oZSxpLG4pe2k9VChpLG4pO2Zvcih2YXIgcj1EKGUpLHM9dD4wPzA6ci0xO3M+PTAmJnM8cjtzKz10KWlmKGkoZVtzXSxzLGUpKXJldHVybiBzO3JldHVybi0xfX1mdW5jdGlvbiBvKHQsZSxpKXtyZXR1cm4gZnVuY3Rpb24obixyLHMpe3ZhciBvPTAsYT1EKG4pO2lmKCJudW1iZXIiPT10eXBlb2Ygcyl0PjA/bz1zPj0wP3M6TWF0aC5tYXgocythLG8pOmE9cz49MD9NYXRoLm1pbihzKzEsYSk6cythKzE7ZWxzZSBpZihpJiZzJiZhKXJldHVybiBzPWkobixyKSxuW3NdPT09cj9zOi0xO2lmKHIhPT1yKXJldHVybiBzPWUoZi5jYWxsKG4sbyxhKSxNLmlzTmFOKSxzPj0wP3MrbzotMTtmb3Iocz10PjA/bzphLTE7cz49MCYmczxhO3MrPXQpaWYobltzXT09PXIpcmV0dXJuIHM7cmV0dXJuLTF9fWZ1bmN0aW9uIGEodCxlKXt2YXIgaT1JLmxlbmd0aCxuPXQuY29uc3RydWN0b3Iscj1NLmlzRnVuY3Rpb24obikmJm4ucHJvdG90eXBlfHxkLHM9ImNvbnN0cnVjdG9yIjtmb3IoTS5oYXModCxzKSYmIU0uY29udGFpbnMoZSxzKSYmZS5wdXNoKHMpO2ktLTspcz1JW2ldLHMgaW4gdCYmdFtzXSE9PXJbc10mJiFNLmNvbnRhaW5zKGUscykmJmUucHVzaChzKX12YXIgbD10aGlzLGM9bC5fLHU9QXJyYXkucHJvdG90eXBlLGQ9T2JqZWN0LnByb3RvdHlwZSxoPUZ1bmN0aW9uLnByb3RvdHlwZSxwPXUucHVzaCxmPXUuc2xpY2UsbT1kLnRvU3RyaW5nLF89ZC5oYXNPd25Qcm9wZXJ0eSxnPUFycmF5LmlzQXJyYXksdj1PYmplY3Qua2V5cyx5PWguYmluZCxiPU9iamVjdC5jcmVhdGUsdz1mdW5jdGlvbigpe30sTT1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIE0/dDp0aGlzIGluc3RhbmNlb2YgTT92b2lkKHRoaXMuX3dyYXBwZWQ9dCk6bmV3IE0odCl9OyJ1bmRlZmluZWQiIT10eXBlb2YgdCYmdC5leHBvcnRzJiYoZT10LmV4cG9ydHM9TSksZS5fPU0sTS5WRVJTSU9OPSIxLjguMyI7dmFyIGs9ZnVuY3Rpb24odCxlLGkpe2lmKHZvaWQgMD09PWUpcmV0dXJuIHQ7c3dpdGNoKG51bGw9PWk/MzppKXtjYXNlIDE6cmV0dXJuIGZ1bmN0aW9uKGkpe3JldHVybiB0LmNhbGwoZSxpKX07Y2FzZSAyOnJldHVybiBmdW5jdGlvbihpLG4pe3JldHVybiB0LmNhbGwoZSxpLG4pfTtjYXNlIDM6cmV0dXJuIGZ1bmN0aW9uKGksbixyKXtyZXR1cm4gdC5jYWxsKGUsaSxuLHIpfTtjYXNlIDQ6cmV0dXJuIGZ1bmN0aW9uKGksbixyLHMpe3JldHVybiB0LmNhbGwoZSxpLG4scixzKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX0sVD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG51bGw9PXQ/TS5pZGVudGl0eTpNLmlzRnVuY3Rpb24odCk/ayh0LGUsaSk6TS5pc09iamVjdCh0KT9NLm1hdGNoZXIodCk6TS5wcm9wZXJ0eSh0KX07TS5pdGVyYXRlZT1mdW5jdGlvbih0LGUpe3JldHVybiBUKHQsZSwxLzApfTt2YXIgUz1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbihpKXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoO2lmKG48Mnx8bnVsbD09aSlyZXR1cm4gaTtmb3IodmFyIHI9MTtyPG47cisrKWZvcih2YXIgcz1hcmd1bWVudHNbcl0sbz10KHMpLGE9by5sZW5ndGgsbD0wO2w8YTtsKyspe3ZhciBjPW9bbF07ZSYmdm9pZCAwIT09aVtjXXx8KGlbY109c1tjXSl9cmV0dXJuIGl9fSxMPWZ1bmN0aW9uKHQpe2lmKCFNLmlzT2JqZWN0KHQpKXJldHVybnt9O2lmKGIpcmV0dXJuIGIodCk7dy5wcm90b3R5cGU9dDt2YXIgZT1uZXcgdztyZXR1cm4gdy5wcm90b3R5cGU9bnVsbCxlfSx4PWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT92b2lkIDA6ZVt0XX19LEU9TWF0aC5wb3coMiw1MyktMSxEPXgoImxlbmd0aCIpLFk9ZnVuY3Rpb24odCl7dmFyIGU9RCh0KTtyZXR1cm4ibnVtYmVyIj09dHlwZW9mIGUmJmU+PTAmJmU8PUV9O00uZWFjaD1NLmZvckVhY2g9ZnVuY3Rpb24odCxlLGkpe2U9ayhlLGkpO3ZhciBuLHI7aWYoWSh0KSlmb3Iobj0wLHI9dC5sZW5ndGg7bjxyO24rKyllKHRbbl0sbix0KTtlbHNle3ZhciBzPU0ua2V5cyh0KTtmb3Iobj0wLHI9cy5sZW5ndGg7bjxyO24rKyllKHRbc1tuXV0sc1tuXSx0KX1yZXR1cm4gdH0sTS5tYXA9TS5jb2xsZWN0PWZ1bmN0aW9uKHQsZSxpKXtlPVQoZSxpKTtmb3IodmFyIG49IVkodCkmJk0ua2V5cyh0KSxyPShufHx0KS5sZW5ndGgscz1BcnJheShyKSxvPTA7bzxyO28rKyl7dmFyIGE9bj9uW29dOm87c1tvXT1lKHRbYV0sYSx0KX1yZXR1cm4gc30sTS5yZWR1Y2U9TS5mb2xkbD1NLmluamVjdD1pKDEpLE0ucmVkdWNlUmlnaHQ9TS5mb2xkcj1pKC0xKSxNLmZpbmQ9TS5kZXRlY3Q9ZnVuY3Rpb24odCxlLGkpe3ZhciBuO2lmKG49WSh0KT9NLmZpbmRJbmRleCh0LGUsaSk6TS5maW5kS2V5KHQsZSxpKSx2b2lkIDAhPT1uJiZuIT09LTEpcmV0dXJuIHRbbl19LE0uZmlsdGVyPU0uc2VsZWN0PWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1bXTtyZXR1cm4gZT1UKGUsaSksTS5lYWNoKHQsZnVuY3Rpb24odCxpLHIpe2UodCxpLHIpJiZuLnB1c2godCl9KSxufSxNLnJlamVjdD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIE0uZmlsdGVyKHQsTS5uZWdhdGUoVChlKSksaSl9LE0uZXZlcnk9TS5hbGw9ZnVuY3Rpb24odCxlLGkpe2U9VChlLGkpO2Zvcih2YXIgbj0hWSh0KSYmTS5rZXlzKHQpLHI9KG58fHQpLmxlbmd0aCxzPTA7czxyO3MrKyl7dmFyIG89bj9uW3NdOnM7aWYoIWUodFtvXSxvLHQpKXJldHVybiExfXJldHVybiEwfSxNLnNvbWU9TS5hbnk9ZnVuY3Rpb24odCxlLGkpe2U9VChlLGkpO2Zvcih2YXIgbj0hWSh0KSYmTS5rZXlzKHQpLHI9KG58fHQpLmxlbmd0aCxzPTA7czxyO3MrKyl7dmFyIG89bj9uW3NdOnM7aWYoZSh0W29dLG8sdCkpcmV0dXJuITB9cmV0dXJuITF9LE0uY29udGFpbnM9TS5pbmNsdWRlcz1NLmluY2x1ZGU9ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIFkodCl8fCh0PU0udmFsdWVzKHQpKSwoIm51bWJlciIhPXR5cGVvZiBpfHxuKSYmKGk9MCksTS5pbmRleE9mKHQsZSxpKT49MH0sTS5pbnZva2U9ZnVuY3Rpb24odCxlKXt2YXIgaT1mLmNhbGwoYXJndW1lbnRzLDIpLG49TS5pc0Z1bmN0aW9uKGUpO3JldHVybiBNLm1hcCh0LGZ1bmN0aW9uKHQpe3ZhciByPW4/ZTp0W2VdO3JldHVybiBudWxsPT1yP3I6ci5hcHBseSh0LGkpfSl9LE0ucGx1Y2s9ZnVuY3Rpb24odCxlKXtyZXR1cm4gTS5tYXAodCxNLnByb3BlcnR5KGUpKX0sTS53aGVyZT1mdW5jdGlvbih0LGUpe3JldHVybiBNLmZpbHRlcih0LE0ubWF0Y2hlcihlKSl9LE0uZmluZFdoZXJlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE0uZmluZCh0LE0ubWF0Y2hlcihlKSl9LE0ubWF4PWZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM9LSgxLzApLG89LSgxLzApO2lmKG51bGw9PWUmJm51bGwhPXQpe3Q9WSh0KT90Ok0udmFsdWVzKHQpO2Zvcih2YXIgYT0wLGw9dC5sZW5ndGg7YTxsO2ErKyluPXRbYV0sbj5zJiYocz1uKX1lbHNlIGU9VChlLGkpLE0uZWFjaCh0LGZ1bmN0aW9uKHQsaSxuKXtyPWUodCxpLG4pLChyPm98fHI9PT0tKDEvMCkmJnM9PT0tKDEvMCkpJiYocz10LG89cil9KTtyZXR1cm4gc30sTS5taW49ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIscz0xLzAsbz0xLzA7aWYobnVsbD09ZSYmbnVsbCE9dCl7dD1ZKHQpP3Q6TS52YWx1ZXModCk7Zm9yKHZhciBhPTAsbD10Lmxlbmd0aDthPGw7YSsrKW49dFthXSxuPHMmJihzPW4pfWVsc2UgZT1UKGUsaSksTS5lYWNoKHQsZnVuY3Rpb24odCxpLG4pe3I9ZSh0LGksbiksKHI8b3x8cj09PTEvMCYmcz09PTEvMCkmJihzPXQsbz1yKX0pO3JldHVybiBzfSxNLnNodWZmbGU9ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9WSh0KT90Ok0udmFsdWVzKHQpLG49aS5sZW5ndGgscj1BcnJheShuKSxzPTA7czxuO3MrKyllPU0ucmFuZG9tKDAscyksZSE9PXMmJihyW3NdPXJbZV0pLHJbZV09aVtzXTtyZXR1cm4gcn0sTS5zYW1wbGU9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBudWxsPT1lfHxpPyhZKHQpfHwodD1NLnZhbHVlcyh0KSksdFtNLnJhbmRvbSh0Lmxlbmd0aC0xKV0pOk0uc2h1ZmZsZSh0KS5zbGljZSgwLE1hdGgubWF4KDAsZSkpfSxNLnNvcnRCeT1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGU9VChlLGkpLE0ucGx1Y2soTS5tYXAodCxmdW5jdGlvbih0LGksbil7cmV0dXJue3ZhbHVlOnQsaW5kZXg6aSxjcml0ZXJpYTplKHQsaSxuKX19KS5zb3J0KGZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5jcml0ZXJpYSxuPWUuY3JpdGVyaWE7aWYoaSE9PW4pe2lmKGk+bnx8dm9pZCAwPT09aSlyZXR1cm4gMTtpZihpPG58fHZvaWQgMD09PW4pcmV0dXJuLTF9cmV0dXJuIHQuaW5kZXgtZS5pbmRleH0pLCJ2YWx1ZSIpfTt2YXIgQz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxpLG4pe3ZhciByPXt9O3JldHVybiBpPVQoaSxuKSxNLmVhY2goZSxmdW5jdGlvbihuLHMpe3ZhciBvPWkobixzLGUpO3QocixuLG8pfSkscn19O00uZ3JvdXBCeT1DKGZ1bmN0aW9uKHQsZSxpKXtNLmhhcyh0LGkpP3RbaV0ucHVzaChlKTp0W2ldPVtlXX0pLE0uaW5kZXhCeT1DKGZ1bmN0aW9uKHQsZSxpKXt0W2ldPWV9KSxNLmNvdW50Qnk9QyhmdW5jdGlvbih0LGUsaSl7TS5oYXModCxpKT90W2ldKys6dFtpXT0xfSksTS50b0FycmF5PWZ1bmN0aW9uKHQpe3JldHVybiB0P00uaXNBcnJheSh0KT9mLmNhbGwodCk6WSh0KT9NLm1hcCh0LE0uaWRlbnRpdHkpOk0udmFsdWVzKHQpOltdfSxNLnNpemU9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/MDpZKHQpP3QubGVuZ3RoOk0ua2V5cyh0KS5sZW5ndGh9LE0ucGFydGl0aW9uPWZ1bmN0aW9uKHQsZSxpKXtlPVQoZSxpKTt2YXIgbj1bXSxyPVtdO3JldHVybiBNLmVhY2godCxmdW5jdGlvbih0LGkscyl7KGUodCxpLHMpP246cikucHVzaCh0KX0pLFtuLHJdfSxNLmZpcnN0PU0uaGVhZD1NLnRha2U9ZnVuY3Rpb24odCxlLGkpe2lmKG51bGwhPXQpcmV0dXJuIG51bGw9PWV8fGk/dFswXTpNLmluaXRpYWwodCx0Lmxlbmd0aC1lKX0sTS5pbml0aWFsPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZi5jYWxsKHQsMCxNYXRoLm1heCgwLHQubGVuZ3RoLShudWxsPT1lfHxpPzE6ZSkpKX0sTS5sYXN0PWZ1bmN0aW9uKHQsZSxpKXtpZihudWxsIT10KXJldHVybiBudWxsPT1lfHxpP3RbdC5sZW5ndGgtMV06TS5yZXN0KHQsTWF0aC5tYXgoMCx0Lmxlbmd0aC1lKSl9LE0ucmVzdD1NLnRhaWw9TS5kcm9wPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZi5jYWxsKHQsbnVsbD09ZXx8aT8xOmUpfSxNLmNvbXBhY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIE0uZmlsdGVyKHQsTS5pZGVudGl0eSl9O3ZhciBBPWZ1bmN0aW9uKHQsZSxpLG4pe2Zvcih2YXIgcj1bXSxzPTAsbz1ufHwwLGE9RCh0KTtvPGE7bysrKXt2YXIgbD10W29dO2lmKFkobCkmJihNLmlzQXJyYXkobCl8fE0uaXNBcmd1bWVudHMobCkpKXtlfHwobD1BKGwsZSxpKSk7dmFyIGM9MCx1PWwubGVuZ3RoO2ZvcihyLmxlbmd0aCs9dTtjPHU7KXJbcysrXT1sW2MrK119ZWxzZSBpfHwocltzKytdPWwpfXJldHVybiByfTtNLmZsYXR0ZW49ZnVuY3Rpb24odCxlKXtyZXR1cm4gQSh0LGUsITEpfSxNLndpdGhvdXQ9ZnVuY3Rpb24odCl7cmV0dXJuIE0uZGlmZmVyZW5jZSh0LGYuY2FsbChhcmd1bWVudHMsMSkpfSxNLnVuaXE9TS51bmlxdWU9ZnVuY3Rpb24odCxlLGksbil7TS5pc0Jvb2xlYW4oZSl8fChuPWksaT1lLGU9ITEpLG51bGwhPWkmJihpPVQoaSxuKSk7Zm9yKHZhciByPVtdLHM9W10sbz0wLGE9RCh0KTtvPGE7bysrKXt2YXIgbD10W29dLGM9aT9pKGwsbyx0KTpsO2U/KG8mJnM9PT1jfHxyLnB1c2gobCkscz1jKTppP00uY29udGFpbnMocyxjKXx8KHMucHVzaChjKSxyLnB1c2gobCkpOk0uY29udGFpbnMocixsKXx8ci5wdXNoKGwpfXJldHVybiByfSxNLnVuaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIE0udW5pcShBKGFyZ3VtZW50cywhMCwhMCkpfSxNLmludGVyc2VjdGlvbj1mdW5jdGlvbih0KXtmb3IodmFyIGU9W10saT1hcmd1bWVudHMubGVuZ3RoLG49MCxyPUQodCk7bjxyO24rKyl7dmFyIHM9dFtuXTtpZighTS5jb250YWlucyhlLHMpKXtmb3IodmFyIG89MTtvPGkmJk0uY29udGFpbnMoYXJndW1lbnRzW29dLHMpO28rKyk7bz09PWkmJmUucHVzaChzKX19cmV0dXJuIGV9LE0uZGlmZmVyZW5jZT1mdW5jdGlvbih0KXt2YXIgZT1BKGFyZ3VtZW50cywhMCwhMCwxKTtyZXR1cm4gTS5maWx0ZXIodCxmdW5jdGlvbih0KXtyZXR1cm4hTS5jb250YWlucyhlLHQpfSl9LE0uemlwPWZ1bmN0aW9uKCl7cmV0dXJuIE0udW56aXAoYXJndW1lbnRzKX0sTS51bnppcD1mdW5jdGlvbih0KXtmb3IodmFyIGU9dCYmTS5tYXgodCxEKS5sZW5ndGh8fDAsaT1BcnJheShlKSxuPTA7bjxlO24rKylpW25dPU0ucGx1Y2sodCxuKTtyZXR1cm4gaX0sTS5vYmplY3Q9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9e30sbj0wLHI9RCh0KTtuPHI7bisrKWU/aVt0W25dXT1lW25dOmlbdFtuXVswXV09dFtuXVsxXTtyZXR1cm4gaX0sTS5maW5kSW5kZXg9cygxKSxNLmZpbmRMYXN0SW5kZXg9cygtMSksTS5zb3J0ZWRJbmRleD1mdW5jdGlvbih0LGUsaSxuKXtpPVQoaSxuLDEpO2Zvcih2YXIgcj1pKGUpLHM9MCxvPUQodCk7czxvOyl7dmFyIGE9TWF0aC5mbG9vcigocytvKS8yKTtpKHRbYV0pPHI/cz1hKzE6bz1hfXJldHVybiBzfSxNLmluZGV4T2Y9bygxLE0uZmluZEluZGV4LE0uc29ydGVkSW5kZXgpLE0ubGFzdEluZGV4T2Y9bygtMSxNLmZpbmRMYXN0SW5kZXgpLE0ucmFuZ2U9ZnVuY3Rpb24odCxlLGkpe251bGw9PWUmJihlPXR8fDAsdD0wKSxpPWl8fDE7Zm9yKHZhciBuPU1hdGgubWF4KE1hdGguY2VpbCgoZS10KS9pKSwwKSxyPUFycmF5KG4pLHM9MDtzPG47cysrLHQrPWkpcltzXT10O3JldHVybiByfTt2YXIgTz1mdW5jdGlvbih0LGUsaSxuLHIpe2lmKCEobiBpbnN0YW5jZW9mIGUpKXJldHVybiB0LmFwcGx5KGkscik7dmFyIHM9TCh0LnByb3RvdHlwZSksbz10LmFwcGx5KHMscik7cmV0dXJuIE0uaXNPYmplY3Qobyk/bzpzfTtNLmJpbmQ9ZnVuY3Rpb24odCxlKXtpZih5JiZ0LmJpbmQ9PT15KXJldHVybiB5LmFwcGx5KHQsZi5jYWxsKGFyZ3VtZW50cywxKSk7aWYoIU0uaXNGdW5jdGlvbih0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJCaW5kIG11c3QgYmUgY2FsbGVkIG9uIGEgZnVuY3Rpb24iKTt2YXIgaT1mLmNhbGwoYXJndW1lbnRzLDIpLG49ZnVuY3Rpb24oKXtyZXR1cm4gTyh0LG4sZSx0aGlzLGkuY29uY2F0KGYuY2FsbChhcmd1bWVudHMpKSl9O3JldHVybiBufSxNLnBhcnRpYWw9ZnVuY3Rpb24odCl7dmFyIGU9Zi5jYWxsKGFyZ3VtZW50cywxKSxpPWZ1bmN0aW9uKCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aCxzPUFycmF5KHIpLG89MDtvPHI7bysrKXNbb109ZVtvXT09PU0/YXJndW1lbnRzW24rK106ZVtvXTtmb3IoO248YXJndW1lbnRzLmxlbmd0aDspcy5wdXNoKGFyZ3VtZW50c1tuKytdKTtyZXR1cm4gTyh0LGksdGhpcyx0aGlzLHMpfTtyZXR1cm4gaX0sTS5iaW5kQWxsPWZ1bmN0aW9uKHQpe3ZhciBlLGksbj1hcmd1bWVudHMubGVuZ3RoO2lmKG48PTEpdGhyb3cgbmV3IEVycm9yKCJiaW5kQWxsIG11c3QgYmUgcGFzc2VkIGZ1bmN0aW9uIG5hbWVzIik7Zm9yKGU9MTtlPG47ZSsrKWk9YXJndW1lbnRzW2VdLHRbaV09TS5iaW5kKHRbaV0sdCk7cmV0dXJuIHR9LE0ubWVtb2l6ZT1mdW5jdGlvbih0LGUpe3ZhciBpPWZ1bmN0aW9uKG4pe3ZhciByPWkuY2FjaGUscz0iIisoZT9lLmFwcGx5KHRoaXMsYXJndW1lbnRzKTpuKTtyZXR1cm4gTS5oYXMocixzKXx8KHJbc109dC5hcHBseSh0aGlzLGFyZ3VtZW50cykpLHJbc119O3JldHVybiBpLmNhY2hlPXt9LGl9LE0uZGVsYXk9ZnVuY3Rpb24odCxlKXt2YXIgaT1mLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkobnVsbCxpKX0sZSl9LE0uZGVmZXI9TS5wYXJ0aWFsKE0uZGVsYXksTSwxKSxNLnRocm90dGxlPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHMsbz1udWxsLGE9MDtpfHwoaT17fSk7dmFyIGw9ZnVuY3Rpb24oKXthPWkubGVhZGluZz09PSExPzA6TS5ub3coKSxvPW51bGwscz10LmFwcGx5KG4sciksb3x8KG49cj1udWxsKX07cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9TS5ub3coKTthfHxpLmxlYWRpbmchPT0hMXx8KGE9Yyk7dmFyIHU9ZS0oYy1hKTtyZXR1cm4gbj10aGlzLHI9YXJndW1lbnRzLHU8PTB8fHU+ZT8obyYmKGNsZWFyVGltZW91dChvKSxvPW51bGwpLGE9YyxzPXQuYXBwbHkobixyKSxvfHwobj1yPW51bGwpKTpvfHxpLnRyYWlsaW5nPT09ITF8fChvPXNldFRpbWVvdXQobCx1KSksc319LE0uZGVib3VuY2U9ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIscyxvLGEsbD1mdW5jdGlvbigpe3ZhciBjPU0ubm93KCktbztjPGUmJmM+PTA/bj1zZXRUaW1lb3V0KGwsZS1jKToobj1udWxsLGl8fChhPXQuYXBwbHkocyxyKSxufHwocz1yPW51bGwpKSl9O3JldHVybiBmdW5jdGlvbigpe3M9dGhpcyxyPWFyZ3VtZW50cyxvPU0ubm93KCk7dmFyIGM9aSYmIW47cmV0dXJuIG58fChuPXNldFRpbWVvdXQobCxlKSksYyYmKGE9dC5hcHBseShzLHIpLHM9cj1udWxsKSxhfX0sTS53cmFwPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE0ucGFydGlhbChlLHQpfSxNLm5lZ2F0ZT1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4hdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSxNLmNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMsZT10Lmxlbmd0aC0xO3JldHVybiBmdW5jdGlvbigpe2Zvcih2YXIgaT1lLG49dFtlXS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aS0tOyluPXRbaV0uY2FsbCh0aGlzLG4pO3JldHVybiBufX0sTS5hZnRlcj1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbigpe2lmKC0tdDwxKXJldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LE0uYmVmb3JlPWZ1bmN0aW9uKHQsZSl7dmFyIGk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuLS10PjAmJihpPWUuYXBwbHkodGhpcyxhcmd1bWVudHMpKSx0PD0xJiYoZT1udWxsKSxpfX0sTS5vbmNlPU0ucGFydGlhbChNLmJlZm9yZSwyKTt2YXIgTj0he3RvU3RyaW5nOm51bGx9LnByb3BlcnR5SXNFbnVtZXJhYmxlKCJ0b1N0cmluZyIpLEk9WyJ2YWx1ZU9mIiwiaXNQcm90b3R5cGVPZiIsInRvU3RyaW5nIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJoYXNPd25Qcm9wZXJ0eSIsInRvTG9jYWxlU3RyaW5nIl07TS5rZXlzPWZ1bmN0aW9uKHQpe2lmKCFNLmlzT2JqZWN0KHQpKXJldHVybltdO2lmKHYpcmV0dXJuIHYodCk7dmFyIGU9W107Zm9yKHZhciBpIGluIHQpTS5oYXModCxpKSYmZS5wdXNoKGkpO3JldHVybiBOJiZhKHQsZSksZX0sTS5hbGxLZXlzPWZ1bmN0aW9uKHQpe2lmKCFNLmlzT2JqZWN0KHQpKXJldHVybltdO3ZhciBlPVtdO2Zvcih2YXIgaSBpbiB0KWUucHVzaChpKTtyZXR1cm4gTiYmYSh0LGUpLGV9LE0udmFsdWVzPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1NLmtleXModCksaT1lLmxlbmd0aCxuPUFycmF5KGkpLHI9MDtyPGk7cisrKW5bcl09dFtlW3JdXTtyZXR1cm4gbn0sTS5tYXBPYmplY3Q9ZnVuY3Rpb24odCxlLGkpe2U9VChlLGkpO2Zvcih2YXIgbixyPU0ua2V5cyh0KSxzPXIubGVuZ3RoLG89e30sYT0wO2E8czthKyspbj1yW2FdLG9bbl09ZSh0W25dLG4sdCk7cmV0dXJuIG99LE0ucGFpcnM9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPU0ua2V5cyh0KSxpPWUubGVuZ3RoLG49QXJyYXkoaSkscj0wO3I8aTtyKyspbltyXT1bZVtyXSx0W2Vbcl1dXTtyZXR1cm4gbn0sTS5pbnZlcnQ9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXt9LGk9TS5rZXlzKHQpLG49MCxyPWkubGVuZ3RoO248cjtuKyspZVt0W2lbbl1dXT1pW25dO3JldHVybiBlfSxNLmZ1bmN0aW9ucz1NLm1ldGhvZHM9ZnVuY3Rpb24odCl7dmFyIGU9W107Zm9yKHZhciBpIGluIHQpTS5pc0Z1bmN0aW9uKHRbaV0pJiZlLnB1c2goaSk7cmV0dXJuIGUuc29ydCgpfSxNLmV4dGVuZD1TKE0uYWxsS2V5cyksTS5leHRlbmRPd249TS5hc3NpZ249UyhNLmtleXMpLE0uZmluZEtleT1mdW5jdGlvbih0LGUsaSl7ZT1UKGUsaSk7Zm9yKHZhciBuLHI9TS5rZXlzKHQpLHM9MCxvPXIubGVuZ3RoO3M8bztzKyspaWYobj1yW3NdLGUodFtuXSxuLHQpKXJldHVybiBufSxNLnBpY2s9ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIscz17fSxvPXQ7aWYobnVsbD09bylyZXR1cm4gcztNLmlzRnVuY3Rpb24oZSk/KHI9TS5hbGxLZXlzKG8pLG49ayhlLGkpKToocj1BKGFyZ3VtZW50cywhMSwhMSwxKSxuPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZSBpbiBpfSxvPU9iamVjdChvKSk7Zm9yKHZhciBhPTAsbD1yLmxlbmd0aDthPGw7YSsrKXt2YXIgYz1yW2FdLHU9b1tjXTtuKHUsYyxvKSYmKHNbY109dSl9cmV0dXJuIHN9LE0ub21pdD1mdW5jdGlvbih0LGUsaSl7aWYoTS5pc0Z1bmN0aW9uKGUpKWU9TS5uZWdhdGUoZSk7ZWxzZXt2YXIgbj1NLm1hcChBKGFyZ3VtZW50cywhMSwhMSwxKSxTdHJpbmcpO2U9ZnVuY3Rpb24odCxlKXtyZXR1cm4hTS5jb250YWlucyhuLGUpfX1yZXR1cm4gTS5waWNrKHQsZSxpKX0sTS5kZWZhdWx0cz1TKE0uYWxsS2V5cywhMCksTS5jcmVhdGU9ZnVuY3Rpb24odCxlKXt2YXIgaT1MKHQpO3JldHVybiBlJiZNLmV4dGVuZE93bihpLGUpLGl9LE0uY2xvbmU9ZnVuY3Rpb24odCl7cmV0dXJuIE0uaXNPYmplY3QodCk/TS5pc0FycmF5KHQpP3Quc2xpY2UoKTpNLmV4dGVuZCh7fSx0KTp0fSxNLnRhcD1mdW5jdGlvbih0LGUpe3JldHVybiBlKHQpLHR9LE0uaXNNYXRjaD1mdW5jdGlvbih0LGUpe3ZhciBpPU0ua2V5cyhlKSxuPWkubGVuZ3RoO2lmKG51bGw9PXQpcmV0dXJuIW47Zm9yKHZhciByPU9iamVjdCh0KSxzPTA7czxuO3MrKyl7dmFyIG89aVtzXTtpZihlW29dIT09cltvXXx8IShvIGluIHIpKXJldHVybiExfXJldHVybiEwfTt2YXIgUD1mdW5jdGlvbih0LGUsaSxuKXtpZih0PT09ZSlyZXR1cm4gMCE9PXR8fDEvdD09PTEvZTtpZihudWxsPT10fHxudWxsPT1lKXJldHVybiB0PT09ZTt0IGluc3RhbmNlb2YgTSYmKHQ9dC5fd3JhcHBlZCksZSBpbnN0YW5jZW9mIE0mJihlPWUuX3dyYXBwZWQpO3ZhciByPW0uY2FsbCh0KTtpZihyIT09bS5jYWxsKGUpKXJldHVybiExO3N3aXRjaChyKXtjYXNlIltvYmplY3QgUmVnRXhwXSI6Y2FzZSJbb2JqZWN0IFN0cmluZ10iOnJldHVybiIiK3Q9PSIiK2U7Y2FzZSJbb2JqZWN0IE51bWJlcl0iOnJldHVybit0IT09K3Q/K2UhPT0rZTowPT09K3Q/MS8rdD09PTEvZTordD09PStlO2Nhc2UiW29iamVjdCBEYXRlXSI6Y2FzZSJbb2JqZWN0IEJvb2xlYW5dIjpyZXR1cm4rdD09PStlfXZhciBzPSJbb2JqZWN0IEFycmF5XSI9PT1yO2lmKCFzKXtpZigib2JqZWN0IiE9dHlwZW9mIHR8fCJvYmplY3QiIT10eXBlb2YgZSlyZXR1cm4hMTt2YXIgbz10LmNvbnN0cnVjdG9yLGE9ZS5jb25zdHJ1Y3RvcjtpZihvIT09YSYmIShNLmlzRnVuY3Rpb24obykmJm8gaW5zdGFuY2VvZiBvJiZNLmlzRnVuY3Rpb24oYSkmJmEgaW5zdGFuY2VvZiBhKSYmImNvbnN0cnVjdG9yImluIHQmJiJjb25zdHJ1Y3RvciJpbiBlKXJldHVybiExfWk9aXx8W10sbj1ufHxbXTtmb3IodmFyIGw9aS5sZW5ndGg7bC0tOylpZihpW2xdPT09dClyZXR1cm4gbltsXT09PWU7aWYoaS5wdXNoKHQpLG4ucHVzaChlKSxzKXtpZihsPXQubGVuZ3RoLGwhPT1lLmxlbmd0aClyZXR1cm4hMTtmb3IoO2wtLTspaWYoIVAodFtsXSxlW2xdLGksbikpcmV0dXJuITF9ZWxzZXt2YXIgYyx1PU0ua2V5cyh0KTtpZihsPXUubGVuZ3RoLE0ua2V5cyhlKS5sZW5ndGghPT1sKXJldHVybiExO2Zvcig7bC0tOylpZihjPXVbbF0sIU0uaGFzKGUsYyl8fCFQKHRbY10sZVtjXSxpLG4pKXJldHVybiExfXJldHVybiBpLnBvcCgpLG4ucG9wKCksITB9O00uaXNFcXVhbD1mdW5jdGlvbih0LGUpe3JldHVybiBQKHQsZSl9LE0uaXNFbXB0eT1mdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dHx8KFkodCkmJihNLmlzQXJyYXkodCl8fE0uaXNTdHJpbmcodCl8fE0uaXNBcmd1bWVudHModCkpPzA9PT10Lmxlbmd0aDowPT09TS5rZXlzKHQpLmxlbmd0aCl9LE0uaXNFbGVtZW50PWZ1bmN0aW9uKHQpe3JldHVybiEoIXR8fDEhPT10Lm5vZGVUeXBlKX0sTS5pc0FycmF5PWd8fGZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PT1tLmNhbGwodCl9LE0uaXNPYmplY3Q9ZnVuY3Rpb24odCl7dmFyIGU9dHlwZW9mIHQ7cmV0dXJuImZ1bmN0aW9uIj09PWV8fCJvYmplY3QiPT09ZSYmISF0fSxNLmVhY2goWyJBcmd1bWVudHMiLCJGdW5jdGlvbiIsIlN0cmluZyIsIk51bWJlciIsIkRhdGUiLCJSZWdFeHAiLCJFcnJvciJdLGZ1bmN0aW9uKHQpe01bImlzIit0XT1mdW5jdGlvbihlKXtyZXR1cm4gbS5jYWxsKGUpPT09IltvYmplY3QgIit0KyJdIn19KSxNLmlzQXJndW1lbnRzKGFyZ3VtZW50cyl8fChNLmlzQXJndW1lbnRzPWZ1bmN0aW9uKHQpe3JldHVybiBNLmhhcyh0LCJjYWxsZWUiKX0pLCJmdW5jdGlvbiIhPXR5cGVvZi8uLyYmIm9iamVjdCIhPXR5cGVvZiBJbnQ4QXJyYXkmJihNLmlzRnVuY3Rpb249ZnVuY3Rpb24odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHR8fCExfSksTS5pc0Zpbml0ZT1mdW5jdGlvbih0KXtyZXR1cm4gaXNGaW5pdGUodCkmJiFpc05hTihwYXJzZUZsb2F0KHQpKX0sTS5pc05hTj1mdW5jdGlvbih0KXtyZXR1cm4gTS5pc051bWJlcih0KSYmdCE9PSt0fSxNLmlzQm9vbGVhbj1mdW5jdGlvbih0KXtyZXR1cm4gdD09PSEwfHx0PT09ITF8fCJbb2JqZWN0IEJvb2xlYW5dIj09PW0uY2FsbCh0KX0sTS5pc051bGw9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PT10fSxNLmlzVW5kZWZpbmVkPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10fSxNLmhhcz1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsIT10JiZfLmNhbGwodCxlKX0sTS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIGwuXz1jLHRoaXN9LE0uaWRlbnRpdHk9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LE0uY29uc3RhbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHR9fSxNLm5vb3A9ZnVuY3Rpb24oKXt9LE0ucHJvcGVydHk9eCxNLnByb3BlcnR5T2Y9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/ZnVuY3Rpb24oKXt9OmZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfX0sTS5tYXRjaGVyPU0ubWF0Y2hlcz1mdW5jdGlvbih0KXtyZXR1cm4gdD1NLmV4dGVuZE93bih7fSx0KSxmdW5jdGlvbihlKXtyZXR1cm4gTS5pc01hdGNoKGUsdCl9fSxNLnRpbWVzPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1BcnJheShNYXRoLm1heCgwLHQpKTtlPWsoZSxpLDEpO2Zvcih2YXIgcj0wO3I8dDtyKyspbltyXT1lKHIpO3JldHVybiBufSxNLnJhbmRvbT1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsPT1lJiYoZT10LHQ9MCksdCtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtdCsxKSl9LE0ubm93PURhdGUubm93fHxmdW5jdGlvbigpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfTt2YXIgUj17IiYiOiImYW1wOyIsIjwiOiImbHQ7IiwiPiI6IiZndDsiLCciJzoiJnF1b3Q7IiwiJyI6IiYjeDI3OyIsImAiOiImI3g2MDsifSxIPU0uaW52ZXJ0KFIpLGo9ZnVuY3Rpb24odCl7dmFyIGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV19LGk9Iig/OiIrTS5rZXlzKHQpLmpvaW4oInwiKSsiKSIsbj1SZWdFeHAoaSkscj1SZWdFeHAoaSwiZyIpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gdD1udWxsPT10PyIiOiIiK3Qsbi50ZXN0KHQpP3QucmVwbGFjZShyLGUpOnR9fTtNLmVzY2FwZT1qKFIpLE0udW5lc2NhcGU9aihIKSxNLnJlc3VsdD1mdW5jdGlvbih0LGUsaSl7dmFyIG49bnVsbD09dD92b2lkIDA6dFtlXTtyZXR1cm4gdm9pZCAwPT09biYmKG49aSksTS5pc0Z1bmN0aW9uKG4pP24uY2FsbCh0KTpufTt2YXIgRj0wO00udW5pcXVlSWQ9ZnVuY3Rpb24odCl7dmFyIGU9KytGKyIiO3JldHVybiB0P3QrZTplfSxNLnRlbXBsYXRlU2V0dGluZ3M9e2V2YWx1YXRlOi88JShbXHNcU10rPyklPi9nLGludGVycG9sYXRlOi88JT0oW1xzXFNdKz8pJT4vZyxlc2NhcGU6LzwlLShbXHNcU10rPyklPi9nfTt2YXIgVT0vKC4pXi8sVz17IiciOiInIiwiXFwiOiJcXCIsIlxyIjoiciIsIlxuIjoibiIsIlx1MjAyOCI6InUyMDI4IiwiXHUyMDI5IjoidTIwMjkifSxCPS9cXHwnfFxyfFxufFx1MjAyOHxcdTIwMjkvZyx6PWZ1bmN0aW9uKHQpe3JldHVybiJcXCIrV1t0XX07TS50ZW1wbGF0ZT1mdW5jdGlvbih0LGUsaSl7IWUmJmkmJihlPWkpLGU9TS5kZWZhdWx0cyh7fSxlLE0udGVtcGxhdGVTZXR0aW5ncyk7dmFyIG49UmVnRXhwKFsoZS5lc2NhcGV8fFUpLnNvdXJjZSwoZS5pbnRlcnBvbGF0ZXx8VSkuc291cmNlLChlLmV2YWx1YXRlfHxVKS5zb3VyY2VdLmpvaW4oInwiKSsifCQiLCJnIikscj0wLHM9Il9fcCs9JyI7dC5yZXBsYWNlKG4sZnVuY3Rpb24oZSxpLG4sbyxhKXtyZXR1cm4gcys9dC5zbGljZShyLGEpLnJlcGxhY2UoQix6KSxyPWErZS5sZW5ndGgsaT9zKz0iJytcbigoX190PSgiK2krIikpPT1udWxsPycnOl8uZXNjYXBlKF9fdCkpK1xuJyI6bj9zKz0iJytcbigoX190PSgiK24rIikpPT1udWxsPycnOl9fdCkrXG4nIjpvJiYocys9Iic7XG4iK28rIlxuX19wKz0nIiksZX0pLHMrPSInO1xuIixlLnZhcmlhYmxlfHwocz0id2l0aChvYmp8fHt9KXtcbiIrcysifVxuIikscz0idmFyIF9fdCxfX3A9JycsX19qPUFycmF5LnByb3RvdHlwZS5qb2luLHByaW50PWZ1bmN0aW9uKCl7X19wKz1fX2ouY2FsbChhcmd1bWVudHMsJycpO307XG4iK3MrInJldHVybiBfX3A7XG4iO3RyeXt2YXIgbz1uZXcgRnVuY3Rpb24oZS52YXJpYWJsZXx8Im9iaiIsIl8iLHMpfWNhdGNoKGEpe3Rocm93IGEuc291cmNlPXMsYX12YXIgbD1mdW5jdGlvbih0KXtyZXR1cm4gby5jYWxsKHRoaXMsdCxNKX0sYz1lLnZhcmlhYmxlfHwib2JqIjtyZXR1cm4gbC5zb3VyY2U9ImZ1bmN0aW9uKCIrYysiKXtcbiIrcysifSIsbH0sTS5jaGFpbj1mdW5jdGlvbih0KXt2YXIgZT1NKHQpO3JldHVybiBlLl9jaGFpbj0hMCxlfTt2YXIgVj1mdW5jdGlvbih0LGUpe3JldHVybiB0Ll9jaGFpbj9NKGUpLmNoYWluKCk6ZX07TS5taXhpbj1mdW5jdGlvbih0KXtNLmVhY2goTS5mdW5jdGlvbnModCksZnVuY3Rpb24oZSl7dmFyIGk9TVtlXT10W2VdO00ucHJvdG90eXBlW2VdPWZ1bmN0aW9uKCl7dmFyIHQ9W3RoaXMuX3dyYXBwZWRdO3JldHVybiBwLmFwcGx5KHQsYXJndW1lbnRzKSxWKHRoaXMsaS5hcHBseShNLHQpKX19KX0sTS5taXhpbihNKSxNLmVhY2goWyJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic29ydCIsInNwbGljZSIsInVuc2hpZnQiXSxmdW5jdGlvbih0KXt2YXIgZT11W3RdO00ucHJvdG90eXBlW3RdPWZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5fd3JhcHBlZDtyZXR1cm4gZS5hcHBseShpLGFyZ3VtZW50cyksInNoaWZ0IiE9PXQmJiJzcGxpY2UiIT09dHx8MCE9PWkubGVuZ3RofHxkZWxldGUgaVswXSxWKHRoaXMsaSl9fSksTS5lYWNoKFsiY29uY2F0Iiwiam9pbiIsInNsaWNlIl0sZnVuY3Rpb24odCl7dmFyIGU9dVt0XTtNLnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3JldHVybiBWKHRoaXMsZS5hcHBseSh0aGlzLl93cmFwcGVkLGFyZ3VtZW50cykpfX0pLE0ucHJvdG90eXBlLnZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dyYXBwZWR9LE0ucHJvdG90eXBlLnZhbHVlT2Y9TS5wcm90b3R5cGUudG9KU09OPU0ucHJvdG90eXBlLnZhbHVlLE0ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy5fd3JhcHBlZH0sbj1bXSxyPWZ1bmN0aW9uKCl7cmV0dXJuIE19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0pLmNhbGwodGhpcyl9LGZ1bmN0aW9uKHQsZSxpKXsvKiEKCgkJIGhhbmRsZWJhcnMgdjQuMC41CgoJCUNvcHlyaWdodCAoQykgMjAxMS0yMDE1IGJ5IFllaHVkYSBLYXR6CgoJCVBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKCQlvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoJCWluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKCQl0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCgkJY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCgkJZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKCgkJVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KCQlhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCgkJVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKCQlJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKCQlGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKCQlBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCgkJTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKCQlPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCgkJVEhFIFNPRlRXQVJFLgoKCQlAbGljZW5zZQoJCSovCgkhZnVuY3Rpb24oZSxpKXt0LmV4cG9ydHM9aSgpfSh0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUobil7aWYoaVtuXSlyZXR1cm4gaVtuXS5leHBvcnRzO3ZhciByPWlbbl09e2V4cG9ydHM6e30saWQ6bixsb2FkZWQ6ITF9O3JldHVybiB0W25dLmNhbGwoci5leHBvcnRzLHIsci5leHBvcnRzLGUpLHIubG9hZGVkPSEwLHIuZXhwb3J0c312YXIgaT17fTtyZXR1cm4gZS5tPXQsZS5jPWksZS5wPSIiLGUoMCl9KFtmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oKXt2YXIgdD1nKCk7cmV0dXJuIHQuY29tcGlsZT1mdW5jdGlvbihlLGkpe3JldHVybiB1LmNvbXBpbGUoZSxpLHQpfSx0LnByZWNvbXBpbGU9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdS5wcmVjb21waWxlKGUsaSx0KX0sdC5BU1Q9bFsiZGVmYXVsdCJdLHQuQ29tcGlsZXI9dS5Db21waWxlcix0LkphdmFTY3JpcHRDb21waWxlcj1oWyJkZWZhdWx0Il0sdC5QYXJzZXI9Yy5wYXJzZXIsdC5wYXJzZT1jLnBhcnNlLHR9dmFyIHI9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMDt2YXIgcz1pKDIpLG89cihzKSxhPWkoMjEpLGw9cihhKSxjPWkoMjIpLHU9aSgyNyksZD1pKDI4KSxoPXIoZCkscD1pKDI1KSxmPXIocCksbT1pKDIwKSxfPXIobSksZz1vWyJkZWZhdWx0Il0uY3JlYXRlLHY9bigpO3YuY3JlYXRlPW4sX1siZGVmYXVsdCJdKHYpLHYuVmlzaXRvcj1mWyJkZWZhdWx0Il0sdlsiZGVmYXVsdCJdPXYsZVsiZGVmYXVsdCJdPXYsdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ImRlZmF1bHQiOnR9fSxlLl9fZXNNb2R1bGU9ITB9LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbigpe3ZhciB0PW5ldyBhLkhhbmRsZWJhcnNFbnZpcm9ubWVudDtyZXR1cm4gcC5leHRlbmQodCxhKSx0LlNhZmVTdHJpbmc9Y1siZGVmYXVsdCJdLHQuRXhjZXB0aW9uPWRbImRlZmF1bHQiXSx0LlV0aWxzPXAsdC5lc2NhcGVFeHByZXNzaW9uPXAuZXNjYXBlRXhwcmVzc2lvbix0LlZNPW0sdC50ZW1wbGF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gbS50ZW1wbGF0ZShlLHQpfSx0fXZhciByPWkoMylbImRlZmF1bHQiXSxzPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIG89aSg0KSxhPXIobyksbD1pKDE4KSxjPXMobCksdT1pKDYpLGQ9cyh1KSxoPWkoNSkscD1yKGgpLGY9aSgxOSksbT1yKGYpLF89aSgyMCksZz1zKF8pLHY9bigpO3YuY3JlYXRlPW4sZ1siZGVmYXVsdCJdKHYpLHZbImRlZmF1bHQiXT12LGVbImRlZmF1bHQiXT12LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2VbImRlZmF1bHQiXT1mdW5jdGlvbih0KXtpZih0JiZ0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIGU9e307aWYobnVsbCE9dClmb3IodmFyIGkgaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxpKSYmKGVbaV09dFtpXSk7cmV0dXJuIGVbImRlZmF1bHQiXT10LGV9LGUuX19lc01vZHVsZT0hMH0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQsZSxpKXt0aGlzLmhlbHBlcnM9dHx8e30sdGhpcy5wYXJ0aWFscz1lfHx7fSx0aGlzLmRlY29yYXRvcnM9aXx8e30sbC5yZWdpc3RlckRlZmF1bHRIZWxwZXJzKHRoaXMpLGMucmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9ycyh0aGlzKX12YXIgcj1pKDEpWyJkZWZhdWx0Il07ZS5fX2VzTW9kdWxlPSEwLGUuSGFuZGxlYmFyc0Vudmlyb25tZW50PW47dmFyIHM9aSg1KSxvPWkoNiksYT1yKG8pLGw9aSg3KSxjPWkoMTUpLHU9aSgxNyksZD1yKHUpLGg9IjQuMC41IjtlLlZFUlNJT049aDt2YXIgcD03O2UuQ09NUElMRVJfUkVWSVNJT049cDt2YXIgZj17MToiPD0gMS4wLnJjLjIiLDI6Ij09IDEuMC4wLXJjLjMiLDM6Ij09IDEuMC4wLXJjLjQiLDQ6Ij09IDEueC54Iiw1OiI9PSAyLjAuMC1hbHBoYS54Iiw2OiI+PSAyLjAuMC1iZXRhLjEiLDc6Ij49IDQuMC4wIn07ZS5SRVZJU0lPTl9DSEFOR0VTPWY7dmFyIG09IltvYmplY3QgT2JqZWN0XSI7bi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOm4sbG9nZ2VyOmRbImRlZmF1bHQiXSxsb2c6ZFsiZGVmYXVsdCJdLmxvZyxyZWdpc3RlckhlbHBlcjpmdW5jdGlvbih0LGUpe2lmKHMudG9TdHJpbmcuY2FsbCh0KT09PW0pe2lmKGUpdGhyb3cgbmV3IGFbImRlZmF1bHQiXSgiQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBoZWxwZXJzIik7cy5leHRlbmQodGhpcy5oZWxwZXJzLHQpfWVsc2UgdGhpcy5oZWxwZXJzW3RdPWV9LHVucmVnaXN0ZXJIZWxwZXI6ZnVuY3Rpb24odCl7ZGVsZXRlIHRoaXMuaGVscGVyc1t0XX0scmVnaXN0ZXJQYXJ0aWFsOmZ1bmN0aW9uKHQsZSl7aWYocy50b1N0cmluZy5jYWxsKHQpPT09bSlzLmV4dGVuZCh0aGlzLnBhcnRpYWxzLHQpO2Vsc2V7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBlKXRocm93IG5ldyBhWyJkZWZhdWx0Il0oJ0F0dGVtcHRpbmcgdG8gcmVnaXN0ZXIgYSBwYXJ0aWFsIGNhbGxlZCAiJyt0KyciIGFzIHVuZGVmaW5lZCcpO3RoaXMucGFydGlhbHNbdF09ZX19LHVucmVnaXN0ZXJQYXJ0aWFsOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0aGlzLnBhcnRpYWxzW3RdfSxyZWdpc3RlckRlY29yYXRvcjpmdW5jdGlvbih0LGUpe2lmKHMudG9TdHJpbmcuY2FsbCh0KT09PW0pe2lmKGUpdGhyb3cgbmV3IGFbImRlZmF1bHQiXSgiQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBkZWNvcmF0b3JzIik7cy5leHRlbmQodGhpcy5kZWNvcmF0b3JzLHQpfWVsc2UgdGhpcy5kZWNvcmF0b3JzW3RdPWV9LHVucmVnaXN0ZXJEZWNvcmF0b3I6ZnVuY3Rpb24odCl7ZGVsZXRlIHRoaXMuZGVjb3JhdG9yc1t0XX19O3ZhciBfPWRbImRlZmF1bHQiXS5sb2c7ZS5sb2c9XyxlLmNyZWF0ZUZyYW1lPXMuY3JlYXRlRnJhbWUsZS5sb2dnZXI9ZFsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBpKHQpe3JldHVybiB1W3RdfWZ1bmN0aW9uIG4odCl7Zm9yKHZhciBlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKylmb3IodmFyIGkgaW4gYXJndW1lbnRzW2VdKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhcmd1bWVudHNbZV0saSkmJih0W2ldPWFyZ3VtZW50c1tlXVtpXSk7cmV0dXJuIHR9ZnVuY3Rpb24gcih0LGUpe2Zvcih2YXIgaT0wLG49dC5sZW5ndGg7aTxuO2krKylpZih0W2ldPT09ZSlyZXR1cm4gaTtyZXR1cm4tMX1mdW5jdGlvbiBzKHQpe2lmKCJzdHJpbmciIT10eXBlb2YgdCl7aWYodCYmdC50b0hUTUwpcmV0dXJuIHQudG9IVE1MKCk7aWYobnVsbD09dClyZXR1cm4iIjtpZighdClyZXR1cm4gdCsiIjt0PSIiK3R9cmV0dXJuIGgudGVzdCh0KT90LnJlcGxhY2UoZCxpKTp0fWZ1bmN0aW9uIG8odCl7cmV0dXJuIXQmJjAhPT10fHwhKCFtKHQpfHwwIT09dC5sZW5ndGgpfWZ1bmN0aW9uIGEodCl7dmFyIGU9bih7fSx0KTtyZXR1cm4gZS5fcGFyZW50PXQsZX1mdW5jdGlvbiBsKHQsZSl7cmV0dXJuIHQucGF0aD1lLHR9ZnVuY3Rpb24gYyh0LGUpe3JldHVybih0P3QrIi4iOiIiKStlfWUuX19lc01vZHVsZT0hMCxlLmV4dGVuZD1uLGUuaW5kZXhPZj1yLGUuZXNjYXBlRXhwcmVzc2lvbj1zLGUuaXNFbXB0eT1vLGUuY3JlYXRlRnJhbWU9YSxlLmJsb2NrUGFyYW1zPWwsZS5hcHBlbmRDb250ZXh0UGF0aD1jO3ZhciB1PXsiJiI6IiZhbXA7IiwiPCI6IiZsdDsiLCI+IjoiJmd0OyIsJyInOiImcXVvdDsiLCInIjoiJiN4Mjc7IiwiYCI6IiYjeDYwOyIsIj0iOiImI3gzRDsifSxkPS9bJjw+IidgPV0vZyxoPS9bJjw+IidgPV0vLHA9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztlLnRvU3RyaW5nPXA7dmFyIGY9ZnVuY3Rpb24odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHR9O2YoL3gvKSYmKGUuaXNGdW5jdGlvbj1mPWZ1bmN0aW9uKHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0JiYiW29iamVjdCBGdW5jdGlvbl0iPT09cC5jYWxsKHQpfSksZS5pc0Z1bmN0aW9uPWY7dmFyIG09QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24odCl7cmV0dXJuISghdHx8Im9iamVjdCIhPXR5cGVvZiB0KSYmIltvYmplY3QgQXJyYXldIj09PXAuY2FsbCh0KX07ZS5pc0FycmF5PW19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGkodCxlKXt2YXIgcj1lJiZlLmxvYyxzPXZvaWQgMCxvPXZvaWQgMDtyJiYocz1yLnN0YXJ0LmxpbmUsbz1yLnN0YXJ0LmNvbHVtbix0Kz0iIC0gIitzKyI6IitvKTtmb3IodmFyIGE9RXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNhbGwodGhpcyx0KSxsPTA7bDxuLmxlbmd0aDtsKyspdGhpc1tuW2xdXT1hW25bbF1dO0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlJiZFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLGkpLHImJih0aGlzLmxpbmVOdW1iZXI9cyx0aGlzLmNvbHVtbj1vKX1lLl9fZXNNb2R1bGU9ITA7dmFyIG49WyJkZXNjcmlwdGlvbiIsImZpbGVOYW1lIiwibGluZU51bWJlciIsIm1lc3NhZ2UiLCJuYW1lIiwibnVtYmVyIiwic3RhY2siXTtpLnByb3RvdHlwZT1uZXcgRXJyb3IsZVsiZGVmYXVsdCJdPWksdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQpe29bImRlZmF1bHQiXSh0KSxsWyJkZWZhdWx0Il0odCksdVsiZGVmYXVsdCJdKHQpLGhbImRlZmF1bHQiXSh0KSxmWyJkZWZhdWx0Il0odCksX1siZGVmYXVsdCJdKHQpLHZbImRlZmF1bHQiXSh0KX12YXIgcj1pKDEpWyJkZWZhdWx0Il07ZS5fX2VzTW9kdWxlPSEwLGUucmVnaXN0ZXJEZWZhdWx0SGVscGVycz1uO3ZhciBzPWkoOCksbz1yKHMpLGE9aSg5KSxsPXIoYSksYz1pKDEwKSx1PXIoYyksZD1pKDExKSxoPXIoZCkscD1pKDEyKSxmPXIocCksbT1pKDEzKSxfPXIobSksZz1pKDE0KSx2PXIoZyl9LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBuPWkoNSk7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJIZWxwZXIoImJsb2NrSGVscGVyTWlzc2luZyIsZnVuY3Rpb24oZSxpKXt2YXIgcj1pLmludmVyc2Uscz1pLmZuO2lmKGU9PT0hMClyZXR1cm4gcyh0aGlzKTtpZihlPT09ITF8fG51bGw9PWUpcmV0dXJuIHIodGhpcyk7aWYobi5pc0FycmF5KGUpKXJldHVybiBlLmxlbmd0aD4wPyhpLmlkcyYmKGkuaWRzPVtpLm5hbWVdKSx0LmhlbHBlcnMuZWFjaChlLGkpKTpyKHRoaXMpO2lmKGkuZGF0YSYmaS5pZHMpe3ZhciBvPW4uY3JlYXRlRnJhbWUoaS5kYXRhKTtvLmNvbnRleHRQYXRoPW4uYXBwZW5kQ29udGV4dFBhdGgoaS5kYXRhLmNvbnRleHRQYXRoLGkubmFtZSksaT17ZGF0YTpvfX1yZXR1cm4gcyhlLGkpfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7dmFyIG49aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMDt2YXIgcj1pKDUpLHM9aSg2KSxvPW4ocyk7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJIZWxwZXIoImVhY2giLGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShlLGkscyl7YyYmKGMua2V5PWUsYy5pbmRleD1pLGMuZmlyc3Q9MD09PWksYy5sYXN0PSEhcyx1JiYoYy5jb250ZXh0UGF0aD11K2UpKSxsKz1uKHRbZV0se2RhdGE6YyxibG9ja1BhcmFtczpyLmJsb2NrUGFyYW1zKFt0W2VdLGVdLFt1K2UsbnVsbF0pfSl9aWYoIWUpdGhyb3cgbmV3IG9bImRlZmF1bHQiXSgiTXVzdCBwYXNzIGl0ZXJhdG9yIHRvICNlYWNoIik7dmFyIG49ZS5mbixzPWUuaW52ZXJzZSxhPTAsbD0iIixjPXZvaWQgMCx1PXZvaWQgMDtpZihlLmRhdGEmJmUuaWRzJiYodT1yLmFwcGVuZENvbnRleHRQYXRoKGUuZGF0YS5jb250ZXh0UGF0aCxlLmlkc1swXSkrIi4iKSxyLmlzRnVuY3Rpb24odCkmJih0PXQuY2FsbCh0aGlzKSksZS5kYXRhJiYoYz1yLmNyZWF0ZUZyYW1lKGUuZGF0YSkpLHQmJiJvYmplY3QiPT10eXBlb2YgdClpZihyLmlzQXJyYXkodCkpZm9yKHZhciBkPXQubGVuZ3RoO2E8ZDthKyspYSBpbiB0JiZpKGEsYSxhPT09dC5sZW5ndGgtMSk7ZWxzZXt2YXIgaD12b2lkIDA7Zm9yKHZhciBwIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShwKSYmKHZvaWQgMCE9PWgmJmkoaCxhLTEpLGg9cCxhKyspO3ZvaWQgMCE9PWgmJmkoaCxhLTEsITApfXJldHVybiAwPT09YSYmKGw9cyh0aGlzKSksbH0pfSx0LmV4cG9ydHM9ZVsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO3ZhciBuPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIHI9aSg2KSxzPW4ocik7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJIZWxwZXIoImhlbHBlck1pc3NpbmciLGZ1bmN0aW9uKCl7aWYoMSE9PWFyZ3VtZW50cy5sZW5ndGgpdGhyb3cgbmV3IHNbImRlZmF1bHQiXSgnTWlzc2luZyBoZWxwZXI6ICInK2FyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoLTFdLm5hbWUrJyInKX0pfSx0LmV4cG9ydHM9ZVsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO2UuX19lc01vZHVsZT0hMDt2YXIgbj1pKDUpO2VbImRlZmF1bHQiXT1mdW5jdGlvbih0KXt0LnJlZ2lzdGVySGVscGVyKCJpZiIsZnVuY3Rpb24odCxlKXtyZXR1cm4gbi5pc0Z1bmN0aW9uKHQpJiYodD10LmNhbGwodGhpcykpLCFlLmhhc2guaW5jbHVkZVplcm8mJiF0fHxuLmlzRW1wdHkodCk/ZS5pbnZlcnNlKHRoaXMpOmUuZm4odGhpcyl9KSx0LnJlZ2lzdGVySGVscGVyKCJ1bmxlc3MiLGZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQuaGVscGVyc1siaWYiXS5jYWxsKHRoaXMsZSx7Zm46aS5pbnZlcnNlLGludmVyc2U6aS5mbixoYXNoOmkuaGFzaH0pfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2UuX19lc01vZHVsZT0hMCxlWyJkZWZhdWx0Il09ZnVuY3Rpb24odCl7dC5yZWdpc3RlckhlbHBlcigibG9nIixmdW5jdGlvbigpe2Zvcih2YXIgZT1bdm9pZCAwXSxpPWFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoLTFdLG49MDtuPGFyZ3VtZW50cy5sZW5ndGgtMTtuKyspZS5wdXNoKGFyZ3VtZW50c1tuXSk7dmFyIHI9MTtudWxsIT1pLmhhc2gubGV2ZWw/cj1pLmhhc2gubGV2ZWw6aS5kYXRhJiZudWxsIT1pLmRhdGEubGV2ZWwmJihyPWkuZGF0YS5sZXZlbCksZVswXT1yLHQubG9nLmFwcGx5KHQsZSl9KX0sdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwLGVbImRlZmF1bHQiXT1mdW5jdGlvbih0KXt0LnJlZ2lzdGVySGVscGVyKCJsb29rdXAiLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQmJnRbZV19KX0sdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtlLl9fZXNNb2R1bGU9ITA7dmFyIG49aSg1KTtlWyJkZWZhdWx0Il09ZnVuY3Rpb24odCl7dC5yZWdpc3RlckhlbHBlcigid2l0aCIsZnVuY3Rpb24odCxlKXtuLmlzRnVuY3Rpb24odCkmJih0PXQuY2FsbCh0aGlzKSk7dmFyIGk9ZS5mbjtpZihuLmlzRW1wdHkodCkpcmV0dXJuIGUuaW52ZXJzZSh0aGlzKTt2YXIgcj1lLmRhdGE7cmV0dXJuIGUuZGF0YSYmZS5pZHMmJihyPW4uY3JlYXRlRnJhbWUoZS5kYXRhKSxyLmNvbnRleHRQYXRoPW4uYXBwZW5kQ29udGV4dFBhdGgoZS5kYXRhLmNvbnRleHRQYXRoLGUuaWRzWzBdKSksaSh0LHtkYXRhOnIsYmxvY2tQYXJhbXM6bi5ibG9ja1BhcmFtcyhbdF0sW3ImJnIuY29udGV4dFBhdGhdKX0pfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0KXtvWyJkZWZhdWx0Il0odCl9dmFyIHI9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMCxlLnJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnM9bjt2YXIgcz1pKDE2KSxvPXIocyl9LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBuPWkoNSk7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJEZWNvcmF0b3IoImlubGluZSIsZnVuY3Rpb24odCxlLGkscil7dmFyIHM9dDtyZXR1cm4gZS5wYXJ0aWFsc3x8KGUucGFydGlhbHM9e30scz1mdW5jdGlvbihyLHMpe3ZhciBvPWkucGFydGlhbHM7aS5wYXJ0aWFscz1uLmV4dGVuZCh7fSxvLGUucGFydGlhbHMpO3ZhciBhPXQocixzKTtyZXR1cm4gaS5wYXJ0aWFscz1vLGF9KSxlLnBhcnRpYWxzW3IuYXJnc1swXV09ci5mbixzfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBuPWkoNSkscj17bWV0aG9kTWFwOlsiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIl0sbGV2ZWw6ImluZm8iLGxvb2t1cExldmVsOmZ1bmN0aW9uKHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdCl7dmFyIGU9bi5pbmRleE9mKHIubWV0aG9kTWFwLHQudG9Mb3dlckNhc2UoKSk7dD1lPj0wP2U6cGFyc2VJbnQodCwxMCl9cmV0dXJuIHR9LGxvZzpmdW5jdGlvbih0KXtpZih0PXIubG9va3VwTGV2ZWwodCksInVuZGVmaW5lZCIhPXR5cGVvZiBjb25zb2xlJiZyLmxvb2t1cExldmVsKHIubGV2ZWwpPD10KXt2YXIgZT1yLm1ldGhvZE1hcFt0XTtjb25zb2xlW2VdfHwoZT0ibG9nIik7Zm9yKHZhciBpPWFyZ3VtZW50cy5sZW5ndGgsbj1BcnJheShpPjE/aS0xOjApLHM9MTtzPGk7cysrKW5bcy0xXT1hcmd1bWVudHNbc107Y29uc29sZVtlXS5hcHBseShjb25zb2xlLG4pfX19O2VbImRlZmF1bHQiXT1yLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGkodCl7dGhpcy5zdHJpbmc9dH1lLl9fZXNNb2R1bGU9ITAsaS5wcm90b3R5cGUudG9TdHJpbmc9aS5wcm90b3R5cGUudG9IVE1MPWZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy5zdHJpbmd9LGVbImRlZmF1bHQiXT1pLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0KXt2YXIgZT10JiZ0WzBdfHwxLGk9Zy5DT01QSUxFUl9SRVZJU0lPTjtpZihlIT09aSl7aWYoZTxpKXt2YXIgbj1nLlJFVklTSU9OX0NIQU5HRVNbaV0scj1nLlJFVklTSU9OX0NIQU5HRVNbZV07dGhyb3cgbmV3IF9bImRlZmF1bHQiXSgiVGVtcGxhdGUgd2FzIHByZWNvbXBpbGVkIHdpdGggYW4gb2xkZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gUGxlYXNlIHVwZGF0ZSB5b3VyIHByZWNvbXBpbGVyIHRvIGEgbmV3ZXIgdmVyc2lvbiAoIituKyIpIG9yIGRvd25ncmFkZSB5b3VyIHJ1bnRpbWUgdG8gYW4gb2xkZXIgdmVyc2lvbiAoIityKyIpLiIpfXRocm93IG5ldyBfWyJkZWZhdWx0Il0oIlRlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGEgbmV3ZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gUGxlYXNlIHVwZGF0ZSB5b3VyIHJ1bnRpbWUgdG8gYSBuZXdlciB2ZXJzaW9uICgiK3RbMV0rIikuIil9fWZ1bmN0aW9uIHIodCxlKXtmdW5jdGlvbiBpKGksbixyKXtyLmhhc2gmJihuPWYuZXh0ZW5kKHt9LG4sci5oYXNoKSxyLmlkcyYmKHIuaWRzWzBdPSEwKSksaT1lLlZNLnJlc29sdmVQYXJ0aWFsLmNhbGwodGhpcyxpLG4scik7dmFyIHM9ZS5WTS5pbnZva2VQYXJ0aWFsLmNhbGwodGhpcyxpLG4scik7aWYobnVsbD09cyYmZS5jb21waWxlJiYoci5wYXJ0aWFsc1tyLm5hbWVdPWUuY29tcGlsZShpLHQuY29tcGlsZXJPcHRpb25zLGUpLHM9ci5wYXJ0aWFsc1tyLm5hbWVdKG4scikpLG51bGwhPXMpe2lmKHIuaW5kZW50KXtmb3IodmFyIG89cy5zcGxpdCgiXG4iKSxhPTAsbD1vLmxlbmd0aDthPGwmJihvW2FdfHxhKzEhPT1sKTthKyspb1thXT1yLmluZGVudCtvW2FdO3M9by5qb2luKCJcbiIpfXJldHVybiBzfXRocm93IG5ldyBfWyJkZWZhdWx0Il0oIlRoZSBwYXJ0aWFsICIrci5uYW1lKyIgY291bGQgbm90IGJlIGNvbXBpbGVkIHdoZW4gcnVubmluZyBpbiBydW50aW1lLW9ubHkgbW9kZSIpfWZ1bmN0aW9uIG4oZSl7ZnVuY3Rpb24gaShlKXtyZXR1cm4iIit0Lm1haW4ocixlLHIuaGVscGVycyxyLnBhcnRpYWxzLG8sbCxhKX12YXIgcz1hcmd1bWVudHMubGVuZ3RoPD0xfHx2b2lkIDA9PT1hcmd1bWVudHNbMV0/e306YXJndW1lbnRzWzFdLG89cy5kYXRhO24uX3NldHVwKHMpLCFzLnBhcnRpYWwmJnQudXNlRGF0YSYmKG89YyhlLG8pKTt2YXIgYT12b2lkIDAsbD10LnVzZUJsb2NrUGFyYW1zP1tdOnZvaWQgMDtyZXR1cm4gdC51c2VEZXB0aHMmJihhPXMuZGVwdGhzP2UhPT1zLmRlcHRoc1swXT9bZV0uY29uY2F0KHMuZGVwdGhzKTpzLmRlcHRoczpbZV0pLChpPXUodC5tYWluLGkscixzLmRlcHRoc3x8W10sbyxsKSkoZSxzKX1pZighZSl0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCJObyBlbnZpcm9ubWVudCBwYXNzZWQgdG8gdGVtcGxhdGUiKTtpZighdHx8IXQubWFpbil0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCJVbmtub3duIHRlbXBsYXRlIG9iamVjdDogIit0eXBlb2YgdCk7dC5tYWluLmRlY29yYXRvcj10Lm1haW5fZCxlLlZNLmNoZWNrUmV2aXNpb24odC5jb21waWxlcik7dmFyIHI9e3N0cmljdDpmdW5jdGlvbih0LGUpe2lmKCEoZSBpbiB0KSl0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCciJytlKyciIG5vdCBkZWZpbmVkIGluICcrdCk7cmV0dXJuIHRbZV19LGxvb2t1cDpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10Lmxlbmd0aCxuPTA7bjxpO24rKylpZih0W25dJiZudWxsIT10W25dW2VdKXJldHVybiB0W25dW2VdfSxsYW1iZGE6ZnVuY3Rpb24odCxlKXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90LmNhbGwoZSk6dH0sZXNjYXBlRXhwcmVzc2lvbjpmLmVzY2FwZUV4cHJlc3Npb24saW52b2tlUGFydGlhbDppLGZuOmZ1bmN0aW9uKGUpe3ZhciBpPXRbZV07cmV0dXJuIGkuZGVjb3JhdG9yPXRbZSsiX2QiXSxpfSxwcm9ncmFtczpbXSxwcm9ncmFtOmZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIG89dGhpcy5wcm9ncmFtc1t0XSxhPXRoaXMuZm4odCk7cmV0dXJuIGV8fHJ8fG58fGk/bz1zKHRoaXMsdCxhLGUsaSxuLHIpOm98fChvPXRoaXMucHJvZ3JhbXNbdF09cyh0aGlzLHQsYSkpLG99LGRhdGE6ZnVuY3Rpb24odCxlKXtmb3IoO3QmJmUtLTspdD10Ll9wYXJlbnQ7cmV0dXJuIHR9LG1lcmdlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dHx8ZTtyZXR1cm4gdCYmZSYmdCE9PWUmJihpPWYuZXh0ZW5kKHt9LGUsdCkpLGl9LG5vb3A6ZS5WTS5ub29wLGNvbXBpbGVySW5mbzp0LmNvbXBpbGVyfTtyZXR1cm4gbi5pc1RvcD0hMCxuLl9zZXR1cD1mdW5jdGlvbihpKXtpLnBhcnRpYWw/KHIuaGVscGVycz1pLmhlbHBlcnMsci5wYXJ0aWFscz1pLnBhcnRpYWxzLHIuZGVjb3JhdG9ycz1pLmRlY29yYXRvcnMpOihyLmhlbHBlcnM9ci5tZXJnZShpLmhlbHBlcnMsZS5oZWxwZXJzKSx0LnVzZVBhcnRpYWwmJihyLnBhcnRpYWxzPXIubWVyZ2UoaS5wYXJ0aWFscyxlLnBhcnRpYWxzKSksKHQudXNlUGFydGlhbHx8dC51c2VEZWNvcmF0b3JzKSYmKHIuZGVjb3JhdG9ycz1yLm1lcmdlKGkuZGVjb3JhdG9ycyxlLmRlY29yYXRvcnMpKSl9LG4uX2NoaWxkPWZ1bmN0aW9uKGUsaSxuLG8pe2lmKHQudXNlQmxvY2tQYXJhbXMmJiFuKXRocm93IG5ldyBfWyJkZWZhdWx0Il0oIm11c3QgcGFzcyBibG9jayBwYXJhbXMiKTtpZih0LnVzZURlcHRocyYmIW8pdGhyb3cgbmV3IF9bImRlZmF1bHQiXSgibXVzdCBwYXNzIHBhcmVudCBkZXB0aHMiKTtyZXR1cm4gcyhyLGUsdFtlXSxpLDAsbixvKX0sbn1mdW5jdGlvbiBzKHQsZSxpLG4scixzLG8pe2Z1bmN0aW9uIGEoZSl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aDw9MXx8dm9pZCAwPT09YXJndW1lbnRzWzFdP3t9OmFyZ3VtZW50c1sxXSxhPW87cmV0dXJuIG8mJmUhPT1vWzBdJiYoYT1bZV0uY29uY2F0KG8pKSxpKHQsZSx0LmhlbHBlcnMsdC5wYXJ0aWFscyxyLmRhdGF8fG4scyYmW3IuYmxvY2tQYXJhbXNdLmNvbmNhdChzKSxhKX1yZXR1cm4gYT11KGksYSx0LG8sbixzKSxhLnByb2dyYW09ZSxhLmRlcHRoPW8/by5sZW5ndGg6MCxhLmJsb2NrUGFyYW1zPXJ8fDAsYX1mdW5jdGlvbiBvKHQsZSxpKXtyZXR1cm4gdD90LmNhbGx8fGkubmFtZXx8KGkubmFtZT10LHQ9aS5wYXJ0aWFsc1t0XSk6dD0iQHBhcnRpYWwtYmxvY2siPT09aS5uYW1lP2kuZGF0YVsicGFydGlhbC1ibG9jayJdOmkucGFydGlhbHNbaS5uYW1lXSx0fWZ1bmN0aW9uIGEodCxlLGkpe2kucGFydGlhbD0hMCxpLmlkcyYmKGkuZGF0YS5jb250ZXh0UGF0aD1pLmlkc1swXXx8aS5kYXRhLmNvbnRleHRQYXRoKTt2YXIgbj12b2lkIDA7aWYoaS5mbiYmaS5mbiE9PWwmJihpLmRhdGE9Zy5jcmVhdGVGcmFtZShpLmRhdGEpLG49aS5kYXRhWyJwYXJ0aWFsLWJsb2NrIl09aS5mbixuLnBhcnRpYWxzJiYoaS5wYXJ0aWFscz1mLmV4dGVuZCh7fSxpLnBhcnRpYWxzLG4ucGFydGlhbHMpKSksdm9pZCAwPT09dCYmbiYmKHQ9biksdm9pZCAwPT09dCl0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCJUaGUgcGFydGlhbCAiK2kubmFtZSsiIGNvdWxkIG5vdCBiZSBmb3VuZCIpO2lmKHQgaW5zdGFuY2VvZiBGdW5jdGlvbilyZXR1cm4gdChlLGkpfWZ1bmN0aW9uIGwoKXtyZXR1cm4iIn1mdW5jdGlvbiBjKHQsZSl7cmV0dXJuIGUmJiJyb290ImluIGV8fChlPWU/Zy5jcmVhdGVGcmFtZShlKTp7fSxlLnJvb3Q9dCksZX1mdW5jdGlvbiB1KHQsZSxpLG4scixzKXtpZih0LmRlY29yYXRvcil7dmFyIG89e307ZT10LmRlY29yYXRvcihlLG8saSxuJiZuWzBdLHIscyxuKSxmLmV4dGVuZChlLG8pfXJldHVybiBlfXZhciBkPWkoMylbImRlZmF1bHQiXSxoPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITAsZS5jaGVja1JldmlzaW9uPW4sZS50ZW1wbGF0ZT1yLGUud3JhcFByb2dyYW09cyxlLnJlc29sdmVQYXJ0aWFsPW8sZS5pbnZva2VQYXJ0aWFsPWEsZS5ub29wPWw7dmFyIHA9aSg1KSxmPWQocCksbT1pKDYpLF89aChtKSxnPWkoNCl9LGZ1bmN0aW9uKHQsZSl7KGZ1bmN0aW9uKGkpeyJ1c2Ugc3RyaWN0IjtlLl9fZXNNb2R1bGU9ITAsZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3ZhciBlPSJ1bmRlZmluZWQiIT10eXBlb2YgaT9pOndpbmRvdyxuPWUuSGFuZGxlYmFyczt0Lm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gZS5IYW5kbGViYXJzPT09dCYmKGUuSGFuZGxlYmFycz1uKSx0fX0sdC5leHBvcnRzPWVbImRlZmF1bHQiXX0pLmNhbGwoZSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSgpKX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBpPXtoZWxwZXJzOntoZWxwZXJFeHByZXNzaW9uOmZ1bmN0aW9uKHQpe3JldHVybiJTdWJFeHByZXNzaW9uIj09PXQudHlwZXx8KCJNdXN0YWNoZVN0YXRlbWVudCI9PT10LnR5cGV8fCJCbG9ja1N0YXRlbWVudCI9PT10LnR5cGUpJiYhISh0LnBhcmFtcyYmdC5wYXJhbXMubGVuZ3RofHx0Lmhhc2gpfSxzY29wZWRJZDpmdW5jdGlvbih0KXtyZXR1cm4vXlwufHRoaXNcYi8udGVzdCh0Lm9yaWdpbmFsKX0sc2ltcGxlSWQ6ZnVuY3Rpb24odCl7cmV0dXJuIDE9PT10LnBhcnRzLmxlbmd0aCYmIWkuaGVscGVycy5zY29wZWRJZCh0KSYmIXQuZGVwdGh9fX07ZVsiZGVmYXVsdCJdPWksdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQsZSl7aWYoIlByb2dyYW0iPT09dC50eXBlKXJldHVybiB0O2FbImRlZmF1bHQiXS55eT1wLHAubG9jSW5mbz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHAuU291cmNlTG9jYXRpb24oZSYmZS5zcmNOYW1lLHQpfTt2YXIgaT1uZXcgY1siZGVmYXVsdCJdKGUpO3JldHVybiBpLmFjY2VwdChhWyJkZWZhdWx0Il0ucGFyc2UodCkpfXZhciByPWkoMSlbImRlZmF1bHQiXSxzPWkoMylbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITAsZS5wYXJzZT1uO3ZhciBvPWkoMjMpLGE9cihvKSxsPWkoMjQpLGM9cihsKSx1PWkoMjYpLGQ9cyh1KSxoPWkoNSk7ZS5wYXJzZXI9YVsiZGVmYXVsdCJdO3ZhciBwPXt9O2guZXh0ZW5kKHAsZCl9LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMueXk9e319dmFyIGU9e3RyYWNlOmZ1bmN0aW9uKCl7fSx5eTp7fSxzeW1ib2xzXzp7ZXJyb3I6Mixyb290OjMscHJvZ3JhbTo0LEVPRjo1LHByb2dyYW1fcmVwZXRpdGlvbjA6NixzdGF0ZW1lbnQ6NyxtdXN0YWNoZTo4LGJsb2NrOjkscmF3QmxvY2s6MTAscGFydGlhbDoxMSxwYXJ0aWFsQmxvY2s6MTIsY29udGVudDoxMyxDT01NRU5UOjE0LENPTlRFTlQ6MTUsb3BlblJhd0Jsb2NrOjE2LHJhd0Jsb2NrX3JlcGV0aXRpb25fcGx1czA6MTcsRU5EX1JBV19CTE9DSzoxOCxPUEVOX1JBV19CTE9DSzoxOSxoZWxwZXJOYW1lOjIwLG9wZW5SYXdCbG9ja19yZXBldGl0aW9uMDoyMSxvcGVuUmF3QmxvY2tfb3B0aW9uMDoyMixDTE9TRV9SQVdfQkxPQ0s6MjMsb3BlbkJsb2NrOjI0LGJsb2NrX29wdGlvbjA6MjUsY2xvc2VCbG9jazoyNixvcGVuSW52ZXJzZToyNyxibG9ja19vcHRpb24xOjI4LE9QRU5fQkxPQ0s6Mjksb3BlbkJsb2NrX3JlcGV0aXRpb24wOjMwLG9wZW5CbG9ja19vcHRpb24wOjMxLG9wZW5CbG9ja19vcHRpb24xOjMyLENMT1NFOjMzLE9QRU5fSU5WRVJTRTozNCxvcGVuSW52ZXJzZV9yZXBldGl0aW9uMDozNSxvcGVuSW52ZXJzZV9vcHRpb24wOjM2LG9wZW5JbnZlcnNlX29wdGlvbjE6Mzcsb3BlbkludmVyc2VDaGFpbjozOCxPUEVOX0lOVkVSU0VfQ0hBSU46Mzksb3BlbkludmVyc2VDaGFpbl9yZXBldGl0aW9uMDo0MCxvcGVuSW52ZXJzZUNoYWluX29wdGlvbjA6NDEsb3BlbkludmVyc2VDaGFpbl9vcHRpb24xOjQyLGludmVyc2VBbmRQcm9ncmFtOjQzLElOVkVSU0U6NDQsaW52ZXJzZUNoYWluOjQ1LGludmVyc2VDaGFpbl9vcHRpb24wOjQ2LE9QRU5fRU5EQkxPQ0s6NDcsT1BFTjo0OCxtdXN0YWNoZV9yZXBldGl0aW9uMDo0OSxtdXN0YWNoZV9vcHRpb24wOjUwLE9QRU5fVU5FU0NBUEVEOjUxLG11c3RhY2hlX3JlcGV0aXRpb24xOjUyLG11c3RhY2hlX29wdGlvbjE6NTMsQ0xPU0VfVU5FU0NBUEVEOjU0LE9QRU5fUEFSVElBTDo1NSxwYXJ0aWFsTmFtZTo1NixwYXJ0aWFsX3JlcGV0aXRpb24wOjU3LHBhcnRpYWxfb3B0aW9uMDo1OCxvcGVuUGFydGlhbEJsb2NrOjU5LE9QRU5fUEFSVElBTF9CTE9DSzo2MCxvcGVuUGFydGlhbEJsb2NrX3JlcGV0aXRpb24wOjYxLG9wZW5QYXJ0aWFsQmxvY2tfb3B0aW9uMDo2MixwYXJhbTo2MyxzZXhwcjo2NCxPUEVOX1NFWFBSOjY1LHNleHByX3JlcGV0aXRpb24wOjY2LHNleHByX29wdGlvbjA6NjcsQ0xPU0VfU0VYUFI6NjgsaGFzaDo2OSxoYXNoX3JlcGV0aXRpb25fcGx1czA6NzAsaGFzaFNlZ21lbnQ6NzEsSUQ6NzIsRVFVQUxTOjczLGJsb2NrUGFyYW1zOjc0LE9QRU5fQkxPQ0tfUEFSQU1TOjc1LGJsb2NrUGFyYW1zX3JlcGV0aXRpb25fcGx1czA6NzYsQ0xPU0VfQkxPQ0tfUEFSQU1TOjc3LHBhdGg6NzgsZGF0YU5hbWU6NzksU1RSSU5HOjgwLE5VTUJFUjo4MSxCT09MRUFOOjgyLFVOREVGSU5FRDo4MyxOVUxMOjg0LERBVEE6ODUscGF0aFNlZ21lbnRzOjg2LFNFUDo4NywkYWNjZXB0OjAsJGVuZDoxfSx0ZXJtaW5hbHNfOnsyOiJlcnJvciIsNToiRU9GIiwxNDoiQ09NTUVOVCIsMTU6IkNPTlRFTlQiLDE4OiJFTkRfUkFXX0JMT0NLIiwxOToiT1BFTl9SQVdfQkxPQ0siLDIzOiJDTE9TRV9SQVdfQkxPQ0siLDI5OiJPUEVOX0JMT0NLIiwzMzoiQ0xPU0UiLDM0OiJPUEVOX0lOVkVSU0UiLDM5OiJPUEVOX0lOVkVSU0VfQ0hBSU4iLDQ0OiJJTlZFUlNFIiw0NzoiT1BFTl9FTkRCTE9DSyIsNDg6Ik9QRU4iLDUxOiJPUEVOX1VORVNDQVBFRCIsNTQ6IkNMT1NFX1VORVNDQVBFRCIsNTU6Ik9QRU5fUEFSVElBTCIsNjA6Ik9QRU5fUEFSVElBTF9CTE9DSyIsNjU6Ik9QRU5fU0VYUFIiLDY4OiJDTE9TRV9TRVhQUiIsNzI6IklEIiw3MzoiRVFVQUxTIiw3NToiT1BFTl9CTE9DS19QQVJBTVMiLDc3OiJDTE9TRV9CTE9DS19QQVJBTVMiLDgwOiJTVFJJTkciLDgxOiJOVU1CRVIiLDgyOiJCT09MRUFOIiw4MzoiVU5ERUZJTkVEIiw4NDoiTlVMTCIsODU6IkRBVEEiLDg3OiJTRVAifSxwcm9kdWN0aW9uc186WzAsWzMsMl0sWzQsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzEzLDFdLFsxMCwzXSxbMTYsNV0sWzksNF0sWzksNF0sWzI0LDZdLFsyNyw2XSxbMzgsNl0sWzQzLDJdLFs0NSwzXSxbNDUsMV0sWzI2LDNdLFs4LDVdLFs4LDVdLFsxMSw1XSxbMTIsM10sWzU5LDVdLFs2MywxXSxbNjMsMV0sWzY0LDVdLFs2OSwxXSxbNzEsM10sWzc0LDNdLFsyMCwxXSxbMjAsMV0sWzIwLDFdLFsyMCwxXSxbMjAsMV0sWzIwLDFdLFsyMCwxXSxbNTYsMV0sWzU2LDFdLFs3OSwyXSxbNzgsMV0sWzg2LDNdLFs4NiwxXSxbNiwwXSxbNiwyXSxbMTcsMV0sWzE3LDJdLFsyMSwwXSxbMjEsMl0sWzIyLDBdLFsyMiwxXSxbMjUsMF0sWzI1LDFdLFsyOCwwXSxbMjgsMV0sWzMwLDBdLFszMCwyXSxbMzEsMF0sWzMxLDFdLFszMiwwXSxbMzIsMV0sWzM1LDBdLFszNSwyXSxbMzYsMF0sWzM2LDFdLFszNywwXSxbMzcsMV0sWzQwLDBdLFs0MCwyXSxbNDEsMF0sWzQxLDFdLFs0MiwwXSxbNDIsMV0sWzQ2LDBdLFs0NiwxXSxbNDksMF0sWzQ5LDJdLFs1MCwwXSxbNTAsMV0sWzUyLDBdLFs1MiwyXSxbNTMsMF0sWzUzLDFdLFs1NywwXSxbNTcsMl0sWzU4LDBdLFs1OCwxXSxbNjEsMF0sWzYxLDJdLFs2MiwwXSxbNjIsMV0sWzY2LDBdLFs2NiwyXSxbNjcsMF0sWzY3LDFdLFs3MCwxXSxbNzAsMl0sWzc2LDFdLFs3NiwyXV0scGVyZm9ybUFjdGlvbjpmdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT1zLmxlbmd0aC0xO3N3aXRjaChyKXtjYXNlIDE6cmV0dXJuIHNbYS0xXTtjYXNlIDI6dGhpcy4kPW4ucHJlcGFyZVByb2dyYW0oc1thXSk7YnJlYWs7Y2FzZSAzOnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgNDp0aGlzLiQ9c1thXTticmVhaztjYXNlIDU6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSA2OnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgNzp0aGlzLiQ9c1thXTticmVhaztjYXNlIDg6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSA5OnRoaXMuJD17dHlwZToiQ29tbWVudFN0YXRlbWVudCIsdmFsdWU6bi5zdHJpcENvbW1lbnQoc1thXSksc3RyaXA6bi5zdHJpcEZsYWdzKHNbYV0sc1thXSksbG9jOm4ubG9jSW5mbyh0aGlzLl8kKX07YnJlYWs7Y2FzZSAxMDp0aGlzLiQ9e3R5cGU6IkNvbnRlbnRTdGF0ZW1lbnQiLG9yaWdpbmFsOnNbYV0sdmFsdWU6c1thXSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDExOnRoaXMuJD1uLnByZXBhcmVSYXdCbG9jayhzW2EtMl0sc1thLTFdLHNbYV0sdGhpcy5fJCk7YnJlYWs7Y2FzZSAxMjp0aGlzLiQ9e3BhdGg6c1thLTNdLHBhcmFtczpzW2EtMl0saGFzaDpzW2EtMV19O2JyZWFrO2Nhc2UgMTM6dGhpcy4kPW4ucHJlcGFyZUJsb2NrKHNbYS0zXSxzW2EtMl0sc1thLTFdLHNbYV0sITEsdGhpcy5fJCk7YnJlYWs7Y2FzZSAxNDp0aGlzLiQ9bi5wcmVwYXJlQmxvY2soc1thLTNdLHNbYS0yXSxzW2EtMV0sc1thXSwhMCx0aGlzLl8kKTticmVhaztjYXNlIDE1OnRoaXMuJD17b3BlbjpzW2EtNV0scGF0aDpzW2EtNF0scGFyYW1zOnNbYS0zXSxoYXNoOnNbYS0yXSxibG9ja1BhcmFtczpzW2EtMV0sc3RyaXA6bi5zdHJpcEZsYWdzKHNbYS01XSxzW2FdKX07YnJlYWs7Y2FzZSAxNjp0aGlzLiQ9e3BhdGg6c1thLTRdLHBhcmFtczpzW2EtM10saGFzaDpzW2EtMl0sYmxvY2tQYXJhbXM6c1thLTFdLHN0cmlwOm4uc3RyaXBGbGFncyhzW2EtNV0sc1thXSl9O2JyZWFrO2Nhc2UgMTc6dGhpcy4kPXtwYXRoOnNbYS00XSxwYXJhbXM6c1thLTNdLGhhc2g6c1thLTJdLGJsb2NrUGFyYW1zOnNbYS0xXSxzdHJpcDpuLnN0cmlwRmxhZ3Moc1thLTVdLHNbYV0pfTticmVhaztjYXNlIDE4OnRoaXMuJD17c3RyaXA6bi5zdHJpcEZsYWdzKHNbYS0xXSxzW2EtMV0pLHByb2dyYW06c1thXX07YnJlYWs7Y2FzZSAxOTp2YXIgbD1uLnByZXBhcmVCbG9jayhzW2EtMl0sc1thLTFdLHNbYV0sc1thXSwhMSx0aGlzLl8kKSxjPW4ucHJlcGFyZVByb2dyYW0oW2xdLHNbYS0xXS5sb2MpO2MuY2hhaW5lZD0hMCx0aGlzLiQ9e3N0cmlwOnNbYS0yXS5zdHJpcCxwcm9ncmFtOmMsY2hhaW46ITB9O2JyZWFrO2Nhc2UgMjA6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSAyMTp0aGlzLiQ9e3BhdGg6c1thLTFdLHN0cmlwOm4uc3RyaXBGbGFncyhzW2EtMl0sc1thXSl9O2JyZWFrO2Nhc2UgMjI6dGhpcy4kPW4ucHJlcGFyZU11c3RhY2hlKHNbYS0zXSxzW2EtMl0sc1thLTFdLHNbYS00XSxuLnN0cmlwRmxhZ3Moc1thLTRdLHNbYV0pLHRoaXMuXyQpO2JyZWFrO2Nhc2UgMjM6dGhpcy4kPW4ucHJlcGFyZU11c3RhY2hlKHNbYS0zXSxzW2EtMl0sc1thLTFdLHNbYS00XSxuLnN0cmlwRmxhZ3Moc1thLTRdLHNbYV0pLHRoaXMuXyQpO2JyZWFrO2Nhc2UgMjQ6dGhpcy4kPXt0eXBlOiJQYXJ0aWFsU3RhdGVtZW50IixuYW1lOnNbYS0zXSxwYXJhbXM6c1thLTJdLGhhc2g6c1thLTFdLGluZGVudDoiIixzdHJpcDpuLnN0cmlwRmxhZ3Moc1thLTRdLHNbYV0pLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMjU6dGhpcy4kPW4ucHJlcGFyZVBhcnRpYWxCbG9jayhzW2EtMl0sc1thLTFdLHNbYV0sdGhpcy5fJCk7YnJlYWs7Y2FzZSAyNjp0aGlzLiQ9e3BhdGg6c1thLTNdLHBhcmFtczpzW2EtMl0saGFzaDpzW2EtMV0sc3RyaXA6bi5zdHJpcEZsYWdzKHNbYS00XSxzW2FdKX07YnJlYWs7Y2FzZSAyNzp0aGlzLiQ9c1thXTticmVhaztjYXNlIDI4OnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgMjk6dGhpcy4kPXt0eXBlOiJTdWJFeHByZXNzaW9uIixwYXRoOnNbYS0zXSxwYXJhbXM6c1thLTJdLGhhc2g6c1thLTFdLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMzA6dGhpcy4kPXt0eXBlOiJIYXNoIixwYWlyczpzW2FdLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMzE6dGhpcy4kPXt0eXBlOiJIYXNoUGFpciIsa2V5Om4uaWQoc1thLTJdKSx2YWx1ZTpzW2FdLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMzI6dGhpcy4kPW4uaWQoc1thLTFdKTticmVhaztjYXNlIDMzOnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgMzQ6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSAzNTp0aGlzLiQ9e3R5cGU6IlN0cmluZ0xpdGVyYWwiLHZhbHVlOnNbYV0sb3JpZ2luYWw6c1thXSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM2OnRoaXMuJD17dHlwZToiTnVtYmVyTGl0ZXJhbCIsdmFsdWU6TnVtYmVyKHNbYV0pLG9yaWdpbmFsOk51bWJlcihzW2FdKSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM3OnRoaXMuJD17dHlwZToiQm9vbGVhbkxpdGVyYWwiLHZhbHVlOiJ0cnVlIj09PXNbYV0sb3JpZ2luYWw6InRydWUiPT09c1thXSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM4OnRoaXMuJD17dHlwZToiVW5kZWZpbmVkTGl0ZXJhbCIsb3JpZ2luYWw6dm9pZCAwLHZhbHVlOnZvaWQgMCxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM5OnRoaXMuJD17dHlwZToiTnVsbExpdGVyYWwiLG9yaWdpbmFsOm51bGwsdmFsdWU6bnVsbCxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDQwOnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgNDE6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSA0Mjp0aGlzLiQ9bi5wcmVwYXJlUGF0aCghMCxzW2FdLHRoaXMuXyQpO2JyZWFrO2Nhc2UgNDM6dGhpcy4kPW4ucHJlcGFyZVBhdGgoITEsc1thXSx0aGlzLl8kKTticmVhaztjYXNlIDQ0OnNbYS0yXS5wdXNoKHtwYXJ0Om4uaWQoc1thXSksb3JpZ2luYWw6c1thXSxzZXBhcmF0b3I6c1thLTFdfSksdGhpcy4kPXNbYS0yXTticmVhaztjYXNlIDQ1OnRoaXMuJD1be3BhcnQ6bi5pZChzW2FdKSxvcmlnaW5hbDpzW2FdfV07YnJlYWs7Y2FzZSA0Njp0aGlzLiQ9W107YnJlYWs7Y2FzZSA0NzpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDQ4OnRoaXMuJD1bc1thXV07YnJlYWs7Y2FzZSA0OTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDUwOnRoaXMuJD1bXTticmVhaztjYXNlIDUxOnNbYS0xXS5wdXNoKHNbYV0pO2JyZWFrO2Nhc2UgNTg6dGhpcy4kPVtdO2JyZWFrO2Nhc2UgNTk6c1thLTFdLnB1c2goc1thXSk7YnJlYWs7Y2FzZSA2NDp0aGlzLiQ9W107YnJlYWs7Y2FzZSA2NTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDcwOnRoaXMuJD1bXTticmVhaztjYXNlIDcxOnNbYS0xXS5wdXNoKHNbYV0pO2JyZWFrO2Nhc2UgNzg6dGhpcy4kPVtdO2JyZWFrO2Nhc2UgNzk6c1thLTFdLnB1c2goc1thXSk7YnJlYWs7Y2FzZSA4Mjp0aGlzLiQ9W107YnJlYWs7Y2FzZSA4MzpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDg2OnRoaXMuJD1bXTticmVhaztjYXNlIDg3OnNbYS0xXS5wdXNoKHNbYV0pO2JyZWFrO2Nhc2UgOTA6dGhpcy4kPVtdO2JyZWFrO2Nhc2UgOTE6c1thLTFdLnB1c2goc1thXSk7YnJlYWs7Y2FzZSA5NDp0aGlzLiQ9W107YnJlYWs7Y2FzZSA5NTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDk4OnRoaXMuJD1bc1thXV07YnJlYWs7Y2FzZSA5OTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDEwMDp0aGlzLiQ9W3NbYV1dO2JyZWFrO2Nhc2UgMTAxOnNbYS0xXS5wdXNoKHNbYV0pfX0sdGFibGU6W3szOjEsNDoyLDU6WzIsNDZdLDY6MywxNDpbMiw0Nl0sMTU6WzIsNDZdLDE5OlsyLDQ2XSwyOTpbMiw0Nl0sMzQ6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezE6WzNdfSx7NTpbMSw0XX0sezU6WzIsMl0sNzo1LDg6Niw5OjcsMTA6OCwxMTo5LDEyOjEwLDEzOjExLDE0OlsxLDEyXSwxNTpbMSwyMF0sMTY6MTcsMTk6WzEsMjNdLDI0OjE1LDI3OjE2LDI5OlsxLDIxXSwzNDpbMSwyMl0sMzk6WzIsMl0sNDQ6WzIsMl0sNDc6WzIsMl0sNDg6WzEsMTNdLDUxOlsxLDE0XSw1NTpbMSwxOF0sNTk6MTksNjA6WzEsMjRdfSx7MTpbMiwxXX0sezU6WzIsNDddLDE0OlsyLDQ3XSwxNTpbMiw0N10sMTk6WzIsNDddLDI5OlsyLDQ3XSwzNDpbMiw0N10sMzk6WzIsNDddLDQ0OlsyLDQ3XSw0NzpbMiw0N10sNDg6WzIsNDddLDUxOlsyLDQ3XSw1NTpbMiw0N10sNjA6WzIsNDddfSx7NTpbMiwzXSwxNDpbMiwzXSwxNTpbMiwzXSwxOTpbMiwzXSwyOTpbMiwzXSwzNDpbMiwzXSwzOTpbMiwzXSw0NDpbMiwzXSw0NzpbMiwzXSw0ODpbMiwzXSw1MTpbMiwzXSw1NTpbMiwzXSw2MDpbMiwzXX0sezU6WzIsNF0sMTQ6WzIsNF0sMTU6WzIsNF0sMTk6WzIsNF0sMjk6WzIsNF0sMzQ6WzIsNF0sMzk6WzIsNF0sNDQ6WzIsNF0sNDc6WzIsNF0sNDg6WzIsNF0sNTE6WzIsNF0sNTU6WzIsNF0sNjA6WzIsNF19LHs1OlsyLDVdLDE0OlsyLDVdLDE1OlsyLDVdLDE5OlsyLDVdLDI5OlsyLDVdLDM0OlsyLDVdLDM5OlsyLDVdLDQ0OlsyLDVdLDQ3OlsyLDVdLDQ4OlsyLDVdLDUxOlsyLDVdLDU1OlsyLDVdLDYwOlsyLDVdfSx7NTpbMiw2XSwxNDpbMiw2XSwxNTpbMiw2XSwxOTpbMiw2XSwyOTpbMiw2XSwzNDpbMiw2XSwzOTpbMiw2XSw0NDpbMiw2XSw0NzpbMiw2XSw0ODpbMiw2XSw1MTpbMiw2XSw1NTpbMiw2XSw2MDpbMiw2XX0sezU6WzIsN10sMTQ6WzIsN10sMTU6WzIsN10sMTk6WzIsN10sMjk6WzIsN10sMzQ6WzIsN10sMzk6WzIsN10sNDQ6WzIsN10sNDc6WzIsN10sNDg6WzIsN10sNTE6WzIsN10sNTU6WzIsN10sNjA6WzIsN119LHs1OlsyLDhdLDE0OlsyLDhdLDE1OlsyLDhdLDE5OlsyLDhdLDI5OlsyLDhdLDM0OlsyLDhdLDM5OlsyLDhdLDQ0OlsyLDhdLDQ3OlsyLDhdLDQ4OlsyLDhdLDUxOlsyLDhdLDU1OlsyLDhdLDYwOlsyLDhdfSx7NTpbMiw5XSwxNDpbMiw5XSwxNTpbMiw5XSwxOTpbMiw5XSwyOTpbMiw5XSwzNDpbMiw5XSwzOTpbMiw5XSw0NDpbMiw5XSw0NzpbMiw5XSw0ODpbMiw5XSw1MTpbMiw5XSw1NTpbMiw5XSw2MDpbMiw5XX0sezIwOjI1LDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjM2LDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezQ6MzcsNjozLDE0OlsyLDQ2XSwxNTpbMiw0Nl0sMTk6WzIsNDZdLDI5OlsyLDQ2XSwzNDpbMiw0Nl0sMzk6WzIsNDZdLDQ0OlsyLDQ2XSw0NzpbMiw0Nl0sNDg6WzIsNDZdLDUxOlsyLDQ2XSw1NTpbMiw0Nl0sNjA6WzIsNDZdfSx7NDozOCw2OjMsMTQ6WzIsNDZdLDE1OlsyLDQ2XSwxOTpbMiw0Nl0sMjk6WzIsNDZdLDM0OlsyLDQ2XSw0NDpbMiw0Nl0sNDc6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezEzOjQwLDE1OlsxLDIwXSwxNzozOX0sezIwOjQyLDU2OjQxLDY0OjQzLDY1OlsxLDQ0XSw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHs0OjQ1LDY6MywxNDpbMiw0Nl0sMTU6WzIsNDZdLDE5OlsyLDQ2XSwyOTpbMiw0Nl0sMzQ6WzIsNDZdLDQ3OlsyLDQ2XSw0ODpbMiw0Nl0sNTE6WzIsNDZdLDU1OlsyLDQ2XSw2MDpbMiw0Nl19LHs1OlsyLDEwXSwxNDpbMiwxMF0sMTU6WzIsMTBdLDE4OlsyLDEwXSwxOTpbMiwxMF0sMjk6WzIsMTBdLDM0OlsyLDEwXSwzOTpbMiwxMF0sNDQ6WzIsMTBdLDQ3OlsyLDEwXSw0ODpbMiwxMF0sNTE6WzIsMTBdLDU1OlsyLDEwXSw2MDpbMiwxMF19LHsyMDo0Niw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyMDo0Nyw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyMDo0OCw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyMDo0Miw1Njo0OSw2NDo0Myw2NTpbMSw0NF0sNzI6WzEsMzVdLDc4OjI2LDc5OjI3LDgwOlsxLDI4XSw4MTpbMSwyOV0sODI6WzEsMzBdLDgzOlsxLDMxXSw4NDpbMSwzMl0sODU6WzEsMzRdLDg2OjMzfSx7MzM6WzIsNzhdLDQ5OjUwLDY1OlsyLDc4XSw3MjpbMiw3OF0sODA6WzIsNzhdLDgxOlsyLDc4XSw4MjpbMiw3OF0sODM6WzIsNzhdLDg0OlsyLDc4XSw4NTpbMiw3OF19LHsyMzpbMiwzM10sMzM6WzIsMzNdLDU0OlsyLDMzXSw2NTpbMiwzM10sNjg6WzIsMzNdLDcyOlsyLDMzXSw3NTpbMiwzM10sODA6WzIsMzNdLDgxOlsyLDMzXSw4MjpbMiwzM10sODM6WzIsMzNdLDg0OlsyLDMzXSw4NTpbMiwzM119LHsyMzpbMiwzNF0sMzM6WzIsMzRdLDU0OlsyLDM0XSw2NTpbMiwzNF0sNjg6WzIsMzRdLDcyOlsyLDM0XSw3NTpbMiwzNF0sODA6WzIsMzRdLDgxOlsyLDM0XSw4MjpbMiwzNF0sODM6WzIsMzRdLDg0OlsyLDM0XSw4NTpbMiwzNF19LHsyMzpbMiwzNV0sMzM6WzIsMzVdLDU0OlsyLDM1XSw2NTpbMiwzNV0sNjg6WzIsMzVdLDcyOlsyLDM1XSw3NTpbMiwzNV0sODA6WzIsMzVdLDgxOlsyLDM1XSw4MjpbMiwzNV0sODM6WzIsMzVdLDg0OlsyLDM1XSw4NTpbMiwzNV19LHsyMzpbMiwzNl0sMzM6WzIsMzZdLDU0OlsyLDM2XSw2NTpbMiwzNl0sNjg6WzIsMzZdLDcyOlsyLDM2XSw3NTpbMiwzNl0sODA6WzIsMzZdLDgxOlsyLDM2XSw4MjpbMiwzNl0sODM6WzIsMzZdLDg0OlsyLDM2XSw4NTpbMiwzNl19LHsyMzpbMiwzN10sMzM6WzIsMzddLDU0OlsyLDM3XSw2NTpbMiwzN10sNjg6WzIsMzddLDcyOlsyLDM3XSw3NTpbMiwzN10sODA6WzIsMzddLDgxOlsyLDM3XSw4MjpbMiwzN10sODM6WzIsMzddLDg0OlsyLDM3XSw4NTpbMiwzN119LHsyMzpbMiwzOF0sMzM6WzIsMzhdLDU0OlsyLDM4XSw2NTpbMiwzOF0sNjg6WzIsMzhdLDcyOlsyLDM4XSw3NTpbMiwzOF0sODA6WzIsMzhdLDgxOlsyLDM4XSw4MjpbMiwzOF0sODM6WzIsMzhdLDg0OlsyLDM4XSw4NTpbMiwzOF19LHsyMzpbMiwzOV0sMzM6WzIsMzldLDU0OlsyLDM5XSw2NTpbMiwzOV0sNjg6WzIsMzldLDcyOlsyLDM5XSw3NTpbMiwzOV0sODA6WzIsMzldLDgxOlsyLDM5XSw4MjpbMiwzOV0sODM6WzIsMzldLDg0OlsyLDM5XSw4NTpbMiwzOV19LHsyMzpbMiw0M10sMzM6WzIsNDNdLDU0OlsyLDQzXSw2NTpbMiw0M10sNjg6WzIsNDNdLDcyOlsyLDQzXSw3NTpbMiw0M10sODA6WzIsNDNdLDgxOlsyLDQzXSw4MjpbMiw0M10sODM6WzIsNDNdLDg0OlsyLDQzXSw4NTpbMiw0M10sODc6WzEsNTFdfSx7NzI6WzEsMzVdLDg2OjUyfSx7MjM6WzIsNDVdLDMzOlsyLDQ1XSw1NDpbMiw0NV0sNjU6WzIsNDVdLDY4OlsyLDQ1XSw3MjpbMiw0NV0sNzU6WzIsNDVdLDgwOlsyLDQ1XSw4MTpbMiw0NV0sODI6WzIsNDVdLDgzOlsyLDQ1XSw4NDpbMiw0NV0sODU6WzIsNDVdLDg3OlsyLDQ1XX0sezUyOjUzLDU0OlsyLDgyXSw2NTpbMiw4Ml0sNzI6WzIsODJdLDgwOlsyLDgyXSw4MTpbMiw4Ml0sODI6WzIsODJdLDgzOlsyLDgyXSw4NDpbMiw4Ml0sODU6WzIsODJdfSx7MjU6NTQsMzg6NTYsMzk6WzEsNThdLDQzOjU3LDQ0OlsxLDU5XSw0NTo1NSw0NzpbMiw1NF19LHsyODo2MCw0Mzo2MSw0NDpbMSw1OV0sNDc6WzIsNTZdfSx7MTM6NjMsMTU6WzEsMjBdLDE4OlsxLDYyXX0sezE1OlsyLDQ4XSwxODpbMiw0OF19LHszMzpbMiw4Nl0sNTc6NjQsNjU6WzIsODZdLDcyOlsyLDg2XSw4MDpbMiw4Nl0sODE6WzIsODZdLDgyOlsyLDg2XSw4MzpbMiw4Nl0sODQ6WzIsODZdLDg1OlsyLDg2XX0sezMzOlsyLDQwXSw2NTpbMiw0MF0sNzI6WzIsNDBdLDgwOlsyLDQwXSw4MTpbMiw0MF0sODI6WzIsNDBdLDgzOlsyLDQwXSw4NDpbMiw0MF0sODU6WzIsNDBdfSx7MzM6WzIsNDFdLDY1OlsyLDQxXSw3MjpbMiw0MV0sODA6WzIsNDFdLDgxOlsyLDQxXSw4MjpbMiw0MV0sODM6WzIsNDFdLDg0OlsyLDQxXSw4NTpbMiw0MV19LHsyMDo2NSw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyNjo2Niw0NzpbMSw2N119LHszMDo2OCwzMzpbMiw1OF0sNjU6WzIsNThdLDcyOlsyLDU4XSw3NTpbMiw1OF0sODA6WzIsNThdLDgxOlsyLDU4XSw4MjpbMiw1OF0sODM6WzIsNThdLDg0OlsyLDU4XSw4NTpbMiw1OF19LHszMzpbMiw2NF0sMzU6NjksNjU6WzIsNjRdLDcyOlsyLDY0XSw3NTpbMiw2NF0sODA6WzIsNjRdLDgxOlsyLDY0XSw4MjpbMiw2NF0sODM6WzIsNjRdLDg0OlsyLDY0XSw4NTpbMiw2NF19LHsyMTo3MCwyMzpbMiw1MF0sNjU6WzIsNTBdLDcyOlsyLDUwXSw4MDpbMiw1MF0sODE6WzIsNTBdLDgyOlsyLDUwXSw4MzpbMiw1MF0sODQ6WzIsNTBdLDg1OlsyLDUwXX0sezMzOlsyLDkwXSw2MTo3MSw2NTpbMiw5MF0sNzI6WzIsOTBdLDgwOlsyLDkwXSw4MTpbMiw5MF0sODI6WzIsOTBdLDgzOlsyLDkwXSw4NDpbMiw5MF0sODU6WzIsOTBdfSx7MjA6NzUsMzM6WzIsODBdLDUwOjcyLDYzOjczLDY0Ojc2LDY1OlsxLDQ0XSw2OTo3NCw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHs3MjpbMSw4MF19LHsyMzpbMiw0Ml0sMzM6WzIsNDJdLDU0OlsyLDQyXSw2NTpbMiw0Ml0sNjg6WzIsNDJdLDcyOlsyLDQyXSw3NTpbMiw0Ml0sODA6WzIsNDJdLDgxOlsyLDQyXSw4MjpbMiw0Ml0sODM6WzIsNDJdLDg0OlsyLDQyXSw4NTpbMiw0Ml0sODc6WzEsNTFdfSx7MjA6NzUsNTM6ODEsNTQ6WzIsODRdLDYzOjgyLDY0Ojc2LDY1OlsxLDQ0XSw2OTo4Myw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyNjo4NCw0NzpbMSw2N119LHs0NzpbMiw1NV19LHs0Ojg1LDY6MywxNDpbMiw0Nl0sMTU6WzIsNDZdLDE5OlsyLDQ2XSwyOTpbMiw0Nl0sMzQ6WzIsNDZdLDM5OlsyLDQ2XSw0NDpbMiw0Nl0sNDc6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezQ3OlsyLDIwXX0sezIwOjg2LDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezQ6ODcsNjozLDE0OlsyLDQ2XSwxNTpbMiw0Nl0sMTk6WzIsNDZdLDI5OlsyLDQ2XSwzNDpbMiw0Nl0sNDc6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezI2Ojg4LDQ3OlsxLDY3XX0sezQ3OlsyLDU3XX0sezU6WzIsMTFdLDE0OlsyLDExXSwxNTpbMiwxMV0sMTk6WzIsMTFdLDI5OlsyLDExXSwzNDpbMiwxMV0sMzk6WzIsMTFdLDQ0OlsyLDExXSw0NzpbMiwxMV0sNDg6WzIsMTFdLDUxOlsyLDExXSw1NTpbMiwxMV0sNjA6WzIsMTFdfSx7MTU6WzIsNDldLDE4OlsyLDQ5XX0sezIwOjc1LDMzOlsyLDg4XSw1ODo4OSw2Mzo5MCw2NDo3Niw2NTpbMSw0NF0sNjk6OTEsNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc4OjI2LDc5OjI3LDgwOlsxLDI4XSw4MTpbMSwyOV0sODI6WzEsMzBdLDgzOlsxLDMxXSw4NDpbMSwzMl0sODU6WzEsMzRdLDg2OjMzfSx7NjU6WzIsOTRdLDY2OjkyLDY4OlsyLDk0XSw3MjpbMiw5NF0sODA6WzIsOTRdLDgxOlsyLDk0XSw4MjpbMiw5NF0sODM6WzIsOTRdLDg0OlsyLDk0XSw4NTpbMiw5NF19LHs1OlsyLDI1XSwxNDpbMiwyNV0sMTU6WzIsMjVdLDE5OlsyLDI1XSwyOTpbMiwyNV0sMzQ6WzIsMjVdLDM5OlsyLDI1XSw0NDpbMiwyNV0sNDc6WzIsMjVdLDQ4OlsyLDI1XSw1MTpbMiwyNV0sNTU6WzIsMjVdLDYwOlsyLDI1XX0sezIwOjkzLDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjc1LDMxOjk0LDMzOlsyLDYwXSw2Mzo5NSw2NDo3Niw2NTpbMSw0NF0sNjk6OTYsNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc1OlsyLDYwXSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjc1LDMzOlsyLDY2XSwzNjo5Nyw2Mzo5OCw2NDo3Niw2NTpbMSw0NF0sNjk6OTksNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc1OlsyLDY2XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjc1LDIyOjEwMCwyMzpbMiw1Ml0sNjM6MTAxLDY0Ojc2LDY1OlsxLDQ0XSw2OToxMDIsNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc4OjI2LDc5OjI3LDgwOlsxLDI4XSw4MTpbMSwyOV0sODI6WzEsMzBdLDgzOlsxLDMxXSw4NDpbMSwzMl0sODU6WzEsMzRdLDg2OjMzfSx7MjA6NzUsMzM6WzIsOTJdLDYyOjEwMyw2MzoxMDQsNjQ6NzYsNjU6WzEsNDRdLDY5OjEwNSw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHszMzpbMSwxMDZdfSx7MzM6WzIsNzldLDY1OlsyLDc5XSw3MjpbMiw3OV0sODA6WzIsNzldLDgxOlsyLDc5XSw4MjpbMiw3OV0sODM6WzIsNzldLDg0OlsyLDc5XSw4NTpbMiw3OV19LHszMzpbMiw4MV19LHsyMzpbMiwyN10sMzM6WzIsMjddLDU0OlsyLDI3XSw2NTpbMiwyN10sNjg6WzIsMjddLDcyOlsyLDI3XSw3NTpbMiwyN10sODA6WzIsMjddLDgxOlsyLDI3XSw4MjpbMiwyN10sODM6WzIsMjddLDg0OlsyLDI3XSw4NTpbMiwyN119LHsyMzpbMiwyOF0sMzM6WzIsMjhdLDU0OlsyLDI4XSw2NTpbMiwyOF0sNjg6WzIsMjhdLDcyOlsyLDI4XSw3NTpbMiwyOF0sODA6WzIsMjhdLDgxOlsyLDI4XSw4MjpbMiwyOF0sODM6WzIsMjhdLDg0OlsyLDI4XSw4NTpbMiwyOF19LHsyMzpbMiwzMF0sMzM6WzIsMzBdLDU0OlsyLDMwXSw2ODpbMiwzMF0sNzE6MTA3LDcyOlsxLDEwOF0sNzU6WzIsMzBdfSx7MjM6WzIsOThdLDMzOlsyLDk4XSw1NDpbMiw5OF0sNjg6WzIsOThdLDcyOlsyLDk4XSw3NTpbMiw5OF19LHsyMzpbMiw0NV0sMzM6WzIsNDVdLDU0OlsyLDQ1XSw2NTpbMiw0NV0sNjg6WzIsNDVdLDcyOlsyLDQ1XSw3MzpbMSwxMDldLDc1OlsyLDQ1XSw4MDpbMiw0NV0sODE6WzIsNDVdLDgyOlsyLDQ1XSw4MzpbMiw0NV0sODQ6WzIsNDVdLDg1OlsyLDQ1XSw4NzpbMiw0NV19LHsyMzpbMiw0NF0sMzM6WzIsNDRdLDU0OlsyLDQ0XSw2NTpbMiw0NF0sNjg6WzIsNDRdLDcyOlsyLDQ0XSw3NTpbMiw0NF0sODA6WzIsNDRdLDgxOlsyLDQ0XSw4MjpbMiw0NF0sODM6WzIsNDRdLDg0OlsyLDQ0XSw4NTpbMiw0NF0sODc6WzIsNDRdfSx7NTQ6WzEsMTEwXX0sezU0OlsyLDgzXSw2NTpbMiw4M10sNzI6WzIsODNdLDgwOlsyLDgzXSw4MTpbMiw4M10sODI6WzIsODNdLDgzOlsyLDgzXSw4NDpbMiw4M10sODU6WzIsODNdfSx7NTQ6WzIsODVdfSx7NTpbMiwxM10sMTQ6WzIsMTNdLDE1OlsyLDEzXSwxOTpbMiwxM10sMjk6WzIsMTNdLDM0OlsyLDEzXSwzOTpbMiwxM10sNDQ6WzIsMTNdLDQ3OlsyLDEzXSw0ODpbMiwxM10sNTE6WzIsMTNdLDU1OlsyLDEzXSw2MDpbMiwxM119LHszODo1NiwzOTpbMSw1OF0sNDM6NTcsNDQ6WzEsNTldLDQ1OjExMiw0NjoxMTEsNDc6WzIsNzZdfSx7MzM6WzIsNzBdLDQwOjExMyw2NTpbMiw3MF0sNzI6WzIsNzBdLDc1OlsyLDcwXSw4MDpbMiw3MF0sODE6WzIsNzBdLDgyOlsyLDcwXSw4MzpbMiw3MF0sODQ6WzIsNzBdLDg1OlsyLDcwXX0sezQ3OlsyLDE4XX0sezU6WzIsMTRdLDE0OlsyLDE0XSwxNTpbMiwxNF0sMTk6WzIsMTRdLDI5OlsyLDE0XSwzNDpbMiwxNF0sMzk6WzIsMTRdLDQ0OlsyLDE0XSw0NzpbMiwxNF0sNDg6WzIsMTRdLDUxOlsyLDE0XSw1NTpbMiwxNF0sNjA6WzIsMTRdfSx7MzM6WzEsMTE0XX0sezMzOlsyLDg3XSw2NTpbMiw4N10sNzI6WzIsODddLDgwOlsyLDg3XSw4MTpbMiw4N10sODI6WzIsODddLDgzOlsyLDg3XSw4NDpbMiw4N10sODU6WzIsODddfSx7MzM6WzIsODldfSx7MjA6NzUsNjM6MTE2LDY0Ojc2LDY1OlsxLDQ0XSw2NzoxMTUsNjg6WzIsOTZdLDY5OjExNyw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHszMzpbMSwxMThdfSx7MzI6MTE5LDMzOlsyLDYyXSw3NDoxMjAsNzU6WzEsMTIxXX0sezMzOlsyLDU5XSw2NTpbMiw1OV0sNzI6WzIsNTldLDc1OlsyLDU5XSw4MDpbMiw1OV0sODE6WzIsNTldLDgyOlsyLDU5XSw4MzpbMiw1OV0sODQ6WzIsNTldLDg1OlsyLDU5XX0sezMzOlsyLDYxXSw3NTpbMiw2MV19LHszMzpbMiw2OF0sMzc6MTIyLDc0OjEyMyw3NTpbMSwxMjFdfSx7MzM6WzIsNjVdLDY1OlsyLDY1XSw3MjpbMiw2NV0sNzU6WzIsNjVdLDgwOlsyLDY1XSw4MTpbMiw2NV0sODI6WzIsNjVdLDgzOlsyLDY1XSw4NDpbMiw2NV0sODU6WzIsNjVdfSx7MzM6WzIsNjddLDc1OlsyLDY3XX0sezIzOlsxLDEyNF19LHsyMzpbMiw1MV0sNjU6WzIsNTFdLDcyOlsyLDUxXSw4MDpbMiw1MV0sODE6WzIsNTFdLDgyOlsyLDUxXSw4MzpbMiw1MV0sODQ6WzIsNTFdLDg1OlsyLDUxXX0sezIzOlsyLDUzXX0sezMzOlsxLDEyNV19LHszMzpbMiw5MV0sNjU6WzIsOTFdLDcyOlsyLDkxXSw4MDpbMiw5MV0sODE6WzIsOTFdLDgyOlsyLDkxXSw4MzpbMiw5MV0sODQ6WzIsOTFdLDg1OlsyLDkxXX0sezMzOlsyLDkzXX0sezU6WzIsMjJdLDE0OlsyLDIyXSwxNTpbMiwyMl0sMTk6WzIsMjJdLDI5OlsyLDIyXSwzNDpbMiwyMl0sMzk6WzIsMjJdLDQ0OlsyLDIyXSw0NzpbMiwyMl0sNDg6WzIsMjJdLDUxOlsyLDIyXSw1NTpbMiwyMl0sNjA6WzIsMjJdfSx7MjM6WzIsOTldLDMzOlsyLDk5XSw1NDpbMiw5OV0sNjg6WzIsOTldLDcyOlsyLDk5XSw3NTpbMiw5OV19LHs3MzpbMSwxMDldfSx7MjA6NzUsNjM6MTI2LDY0Ojc2LDY1OlsxLDQ0XSw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHs1OlsyLDIzXSwxNDpbMiwyM10sMTU6WzIsMjNdLDE5OlsyLDIzXSwyOTpbMiwyM10sMzQ6WzIsMjNdLDM5OlsyLDIzXSw0NDpbMiwyM10sNDc6WzIsMjNdLDQ4OlsyLDIzXSw1MTpbMiwyM10sNTU6WzIsMjNdLDYwOlsyLDIzXX0sezQ3OlsyLDE5XX0sezQ3OlsyLDc3XX0sezIwOjc1LDMzOlsyLDcyXSw0MToxMjcsNjM6MTI4LDY0Ojc2LDY1OlsxLDQ0XSw2OToxMjksNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc1OlsyLDcyXSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezU6WzIsMjRdLDE0OlsyLDI0XSwxNTpbMiwyNF0sMTk6WzIsMjRdLDI5OlsyLDI0XSwzNDpbMiwyNF0sMzk6WzIsMjRdLDQ0OlsyLDI0XSw0NzpbMiwyNF0sNDg6WzIsMjRdLDUxOlsyLDI0XSw1NTpbMiwyNF0sNjA6WzIsMjRdfSx7Njg6WzEsMTMwXX0sezY1OlsyLDk1XSw2ODpbMiw5NV0sNzI6WzIsOTVdLDgwOlsyLDk1XSw4MTpbMiw5NV0sODI6WzIsOTVdLDgzOlsyLDk1XSw4NDpbMiw5NV0sODU6WzIsOTVdfSx7Njg6WzIsOTddfSx7NTpbMiwyMV0sMTQ6WzIsMjFdLDE1OlsyLDIxXSwxOTpbMiwyMV0sMjk6WzIsMjFdLDM0OlsyLDIxXSwzOTpbMiwyMV0sNDQ6WzIsMjFdLDQ3OlsyLDIxXSw0ODpbMiwyMV0sNTE6WzIsMjFdLDU1OlsyLDIxXSw2MDpbMiwyMV19LHszMzpbMSwxMzFdfSx7MzM6WzIsNjNdfSx7NzI6WzEsMTMzXSw3NjoxMzJ9LHszMzpbMSwxMzRdfSx7MzM6WzIsNjldfSx7MTU6WzIsMTJdfSx7MTQ6WzIsMjZdLDE1OlsyLDI2XSwxOTpbMiwyNl0sMjk6WzIsMjZdLDM0OlsyLDI2XSw0NzpbMiwyNl0sNDg6WzIsMjZdLDUxOlsyLDI2XSw1NTpbMiwyNl0sNjA6WzIsMjZdfSx7MjM6WzIsMzFdLDMzOlsyLDMxXSw1NDpbMiwzMV0sNjg6WzIsMzFdLDcyOlsyLDMxXSw3NTpbMiwzMV19LHszMzpbMiw3NF0sNDI6MTM1LDc0OjEzNiw3NTpbMSwxMjFdfSx7MzM6WzIsNzFdLDY1OlsyLDcxXSw3MjpbMiw3MV0sNzU6WzIsNzFdLDgwOlsyLDcxXSw4MTpbMiw3MV0sODI6WzIsNzFdLDgzOlsyLDcxXSw4NDpbMiw3MV0sODU6WzIsNzFdfSx7MzM6WzIsNzNdLDc1OlsyLDczXX0sezIzOlsyLDI5XSwzMzpbMiwyOV0sNTQ6WzIsMjldLDY1OlsyLDI5XSw2ODpbMiwyOV0sNzI6WzIsMjldLDc1OlsyLDI5XSw4MDpbMiwyOV0sODE6WzIsMjldLDgyOlsyLDI5XSw4MzpbMiwyOV0sODQ6WzIsMjldLDg1OlsyLDI5XX0sezE0OlsyLDE1XSwxNTpbMiwxNV0sMTk6WzIsMTVdLDI5OlsyLDE1XSwzNDpbMiwxNV0sMzk6WzIsMTVdLDQ0OlsyLDE1XSw0NzpbMiwxNV0sNDg6WzIsMTVdLDUxOlsyLDE1XSw1NTpbMiwxNV0sNjA6WzIsMTVdfSx7NzI6WzEsMTM4XSw3NzpbMSwxMzddfSx7NzI6WzIsMTAwXSw3NzpbMiwxMDBdfSx7MTQ6WzIsMTZdLDE1OlsyLDE2XSwxOTpbMiwxNl0sMjk6WzIsMTZdLDM0OlsyLDE2XSw0NDpbMiwxNl0sNDc6WzIsMTZdLDQ4OlsyLDE2XSw1MTpbMiwxNl0sNTU6WzIsMTZdLDYwOlsyLDE2XX0sezMzOlsxLDEzOV19LHszMzpbMiw3NV19LHszMzpbMiwzMl19LHs3MjpbMiwxMDFdLDc3OlsyLDEwMV19LHsxNDpbMiwxN10sMTU6WzIsMTddLDE5OlsyLDE3XSwyOTpbMiwxN10sMzQ6WzIsMTddLDM5OlsyLDE3XSw0NDpbMiwxN10sCgk0NzpbMiwxN10sNDg6WzIsMTddLDUxOlsyLDE3XSw1NTpbMiwxN10sNjA6WzIsMTddfV0sZGVmYXVsdEFjdGlvbnM6ezQ6WzIsMV0sNTU6WzIsNTVdLDU3OlsyLDIwXSw2MTpbMiw1N10sNzQ6WzIsODFdLDgzOlsyLDg1XSw4NzpbMiwxOF0sOTE6WzIsODldLDEwMjpbMiw1M10sMTA1OlsyLDkzXSwxMTE6WzIsMTldLDExMjpbMiw3N10sMTE3OlsyLDk3XSwxMjA6WzIsNjNdLDEyMzpbMiw2OV0sMTI0OlsyLDEyXSwxMzY6WzIsNzVdLDEzNzpbMiwzMl19LHBhcnNlRXJyb3I6ZnVuY3Rpb24odCxlKXt0aHJvdyBuZXcgRXJyb3IodCl9LHBhcnNlOmZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoKXt2YXIgdDtyZXR1cm4gdD1pLmxleGVyLmxleCgpfHwxLCJudW1iZXIiIT10eXBlb2YgdCYmKHQ9aS5zeW1ib2xzX1t0XXx8dCksdH12YXIgaT10aGlzLG49WzBdLHI9W251bGxdLHM9W10sbz10aGlzLnRhYmxlLGE9IiIsbD0wLGM9MCx1PTA7dGhpcy5sZXhlci5zZXRJbnB1dCh0KSx0aGlzLmxleGVyLnl5PXRoaXMueXksdGhpcy55eS5sZXhlcj10aGlzLmxleGVyLHRoaXMueXkucGFyc2VyPXRoaXMsInVuZGVmaW5lZCI9PXR5cGVvZiB0aGlzLmxleGVyLnl5bGxvYyYmKHRoaXMubGV4ZXIueXlsbG9jPXt9KTt2YXIgZD10aGlzLmxleGVyLnl5bGxvYztzLnB1c2goZCk7dmFyIGg9dGhpcy5sZXhlci5vcHRpb25zJiZ0aGlzLmxleGVyLm9wdGlvbnMucmFuZ2VzOyJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzLnl5LnBhcnNlRXJyb3ImJih0aGlzLnBhcnNlRXJyb3I9dGhpcy55eS5wYXJzZUVycm9yKTtmb3IodmFyIHAsZixtLF8sZyx2LHksYix3LE09e307Oyl7aWYobT1uW24ubGVuZ3RoLTFdLHRoaXMuZGVmYXVsdEFjdGlvbnNbbV0/Xz10aGlzLmRlZmF1bHRBY3Rpb25zW21dOihudWxsIT09cCYmInVuZGVmaW5lZCIhPXR5cGVvZiBwfHwocD1lKCkpLF89b1ttXSYmb1ttXVtwXSksInVuZGVmaW5lZCI9PXR5cGVvZiBffHwhXy5sZW5ndGh8fCFfWzBdKXt2YXIgaz0iIjtpZighdSl7dz1bXTtmb3IodiBpbiBvW21dKXRoaXMudGVybWluYWxzX1t2XSYmdj4yJiZ3LnB1c2goIiciK3RoaXMudGVybWluYWxzX1t2XSsiJyIpO2s9dGhpcy5sZXhlci5zaG93UG9zaXRpb24/IlBhcnNlIGVycm9yIG9uIGxpbmUgIisobCsxKSsiOlxuIit0aGlzLmxleGVyLnNob3dQb3NpdGlvbigpKyJcbkV4cGVjdGluZyAiK3cuam9pbigiLCAiKSsiLCBnb3QgJyIrKHRoaXMudGVybWluYWxzX1twXXx8cCkrIiciOiJQYXJzZSBlcnJvciBvbiBsaW5lICIrKGwrMSkrIjogVW5leHBlY3RlZCAiKygxPT1wPyJlbmQgb2YgaW5wdXQiOiInIisodGhpcy50ZXJtaW5hbHNfW3BdfHxwKSsiJyIpLHRoaXMucGFyc2VFcnJvcihrLHt0ZXh0OnRoaXMubGV4ZXIubWF0Y2gsdG9rZW46dGhpcy50ZXJtaW5hbHNfW3BdfHxwLGxpbmU6dGhpcy5sZXhlci55eWxpbmVubyxsb2M6ZCxleHBlY3RlZDp3fSl9fWlmKF9bMF1pbnN0YW5jZW9mIEFycmF5JiZfLmxlbmd0aD4xKXRocm93IG5ldyBFcnJvcigiUGFyc2UgRXJyb3I6IG11bHRpcGxlIGFjdGlvbnMgcG9zc2libGUgYXQgc3RhdGU6ICIrbSsiLCB0b2tlbjogIitwKTtzd2l0Y2goX1swXSl7Y2FzZSAxOm4ucHVzaChwKSxyLnB1c2godGhpcy5sZXhlci55eXRleHQpLHMucHVzaCh0aGlzLmxleGVyLnl5bGxvYyksbi5wdXNoKF9bMV0pLHA9bnVsbCxmPyhwPWYsZj1udWxsKTooYz10aGlzLmxleGVyLnl5bGVuZyxhPXRoaXMubGV4ZXIueXl0ZXh0LGw9dGhpcy5sZXhlci55eWxpbmVubyxkPXRoaXMubGV4ZXIueXlsbG9jLHU+MCYmdS0tKTticmVhaztjYXNlIDI6aWYoeT10aGlzLnByb2R1Y3Rpb25zX1tfWzFdXVsxXSxNLiQ9cltyLmxlbmd0aC15XSxNLl8kPXtmaXJzdF9saW5lOnNbcy5sZW5ndGgtKHl8fDEpXS5maXJzdF9saW5lLGxhc3RfbGluZTpzW3MubGVuZ3RoLTFdLmxhc3RfbGluZSxmaXJzdF9jb2x1bW46c1tzLmxlbmd0aC0oeXx8MSldLmZpcnN0X2NvbHVtbixsYXN0X2NvbHVtbjpzW3MubGVuZ3RoLTFdLmxhc3RfY29sdW1ufSxoJiYoTS5fJC5yYW5nZT1bc1tzLmxlbmd0aC0oeXx8MSldLnJhbmdlWzBdLHNbcy5sZW5ndGgtMV0ucmFuZ2VbMV1dKSxnPXRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKE0sYSxjLGwsdGhpcy55eSxfWzFdLHIscyksInVuZGVmaW5lZCIhPXR5cGVvZiBnKXJldHVybiBnO3kmJihuPW4uc2xpY2UoMCwtMSp5KjIpLHI9ci5zbGljZSgwLC0xKnkpLHM9cy5zbGljZSgwLC0xKnkpKSxuLnB1c2godGhpcy5wcm9kdWN0aW9uc19bX1sxXV1bMF0pLHIucHVzaChNLiQpLHMucHVzaChNLl8kKSxiPW9bbltuLmxlbmd0aC0yXV1bbltuLmxlbmd0aC0xXV0sbi5wdXNoKGIpO2JyZWFrO2Nhc2UgMzpyZXR1cm4hMH19cmV0dXJuITB9fSxpPWZ1bmN0aW9uKCl7dmFyIHQ9e0VPRjoxLHBhcnNlRXJyb3I6ZnVuY3Rpb24odCxlKXtpZighdGhpcy55eS5wYXJzZXIpdGhyb3cgbmV3IEVycm9yKHQpO3RoaXMueXkucGFyc2VyLnBhcnNlRXJyb3IodCxlKX0sc2V0SW5wdXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2lucHV0PXQsdGhpcy5fbW9yZT10aGlzLl9sZXNzPXRoaXMuZG9uZT0hMSx0aGlzLnl5bGluZW5vPXRoaXMueXlsZW5nPTAsdGhpcy55eXRleHQ9dGhpcy5tYXRjaGVkPXRoaXMubWF0Y2g9IiIsdGhpcy5jb25kaXRpb25TdGFjaz1bIklOSVRJQUwiXSx0aGlzLnl5bGxvYz17Zmlyc3RfbGluZToxLGZpcnN0X2NvbHVtbjowLGxhc3RfbGluZToxLGxhc3RfY29sdW1uOjB9LHRoaXMub3B0aW9ucy5yYW5nZXMmJih0aGlzLnl5bGxvYy5yYW5nZT1bMCwwXSksdGhpcy5vZmZzZXQ9MCx0aGlzfSxpbnB1dDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2lucHV0WzBdO3RoaXMueXl0ZXh0Kz10LHRoaXMueXlsZW5nKyssdGhpcy5vZmZzZXQrKyx0aGlzLm1hdGNoKz10LHRoaXMubWF0Y2hlZCs9dDt2YXIgZT10Lm1hdGNoKC8oPzpcclxuP3xcbikuKi9nKTtyZXR1cm4gZT8odGhpcy55eWxpbmVubysrLHRoaXMueXlsbG9jLmxhc3RfbGluZSsrKTp0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbisrLHRoaXMub3B0aW9ucy5yYW5nZXMmJnRoaXMueXlsbG9jLnJhbmdlWzFdKyssdGhpcy5faW5wdXQ9dGhpcy5faW5wdXQuc2xpY2UoMSksdH0sdW5wdXQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5sZW5ndGgsaT10LnNwbGl0KC8oPzpcclxuP3xcbikvZyk7dGhpcy5faW5wdXQ9dCt0aGlzLl9pbnB1dCx0aGlzLnl5dGV4dD10aGlzLnl5dGV4dC5zdWJzdHIoMCx0aGlzLnl5dGV4dC5sZW5ndGgtZS0xKSx0aGlzLm9mZnNldC09ZTt2YXIgbj10aGlzLm1hdGNoLnNwbGl0KC8oPzpcclxuP3xcbikvZyk7dGhpcy5tYXRjaD10aGlzLm1hdGNoLnN1YnN0cigwLHRoaXMubWF0Y2gubGVuZ3RoLTEpLHRoaXMubWF0Y2hlZD10aGlzLm1hdGNoZWQuc3Vic3RyKDAsdGhpcy5tYXRjaGVkLmxlbmd0aC0xKSxpLmxlbmd0aC0xJiYodGhpcy55eWxpbmVuby09aS5sZW5ndGgtMSk7dmFyIHI9dGhpcy55eWxsb2MucmFuZ2U7cmV0dXJuIHRoaXMueXlsbG9jPXtmaXJzdF9saW5lOnRoaXMueXlsbG9jLmZpcnN0X2xpbmUsbGFzdF9saW5lOnRoaXMueXlsaW5lbm8rMSxmaXJzdF9jb2x1bW46dGhpcy55eWxsb2MuZmlyc3RfY29sdW1uLGxhc3RfY29sdW1uOmk/KGkubGVuZ3RoPT09bi5sZW5ndGg/dGhpcy55eWxsb2MuZmlyc3RfY29sdW1uOjApK25bbi5sZW5ndGgtaS5sZW5ndGhdLmxlbmd0aC1pWzBdLmxlbmd0aDp0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW4tZX0sdGhpcy5vcHRpb25zLnJhbmdlcyYmKHRoaXMueXlsbG9jLnJhbmdlPVtyWzBdLHJbMF0rdGhpcy55eWxlbmctZV0pLHRoaXN9LG1vcmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbW9yZT0hMA==", "base64"));
  res.write(new Buffer("LHRoaXN9LGxlc3M6ZnVuY3Rpb24odCl7dGhpcy51bnB1dCh0aGlzLm1hdGNoLnNsaWNlKHQpKX0scGFzdElucHV0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tYXRjaGVkLnN1YnN0cigwLHRoaXMubWF0Y2hlZC5sZW5ndGgtdGhpcy5tYXRjaC5sZW5ndGgpO3JldHVybih0Lmxlbmd0aD4yMD8iLi4uIjoiIikrdC5zdWJzdHIoLTIwKS5yZXBsYWNlKC9cbi9nLCIiKX0sdXBjb21pbmdJbnB1dDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubWF0Y2g7cmV0dXJuIHQubGVuZ3RoPDIwJiYodCs9dGhpcy5faW5wdXQuc3Vic3RyKDAsMjAtdC5sZW5ndGgpKSwodC5zdWJzdHIoMCwyMCkrKHQubGVuZ3RoPjIwPyIuLi4iOiIiKSkucmVwbGFjZSgvXG4vZywiIil9LHNob3dQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMucGFzdElucHV0KCksZT1uZXcgQXJyYXkodC5sZW5ndGgrMSkuam9pbigiLSIpO3JldHVybiB0K3RoaXMudXBjb21pbmdJbnB1dCgpKyJcbiIrZSsiXiJ9LG5leHQ6ZnVuY3Rpb24oKXtpZih0aGlzLmRvbmUpcmV0dXJuIHRoaXMuRU9GO3RoaXMuX2lucHV0fHwodGhpcy5kb25lPSEwKTt2YXIgdCxlLGksbixyO3RoaXMuX21vcmV8fCh0aGlzLnl5dGV4dD0iIix0aGlzLm1hdGNoPSIiKTtmb3IodmFyIHM9dGhpcy5fY3VycmVudFJ1bGVzKCksbz0wO288cy5sZW5ndGgmJihpPXRoaXMuX2lucHV0Lm1hdGNoKHRoaXMucnVsZXNbc1tvXV0pLCFpfHxlJiYhKGlbMF0ubGVuZ3RoPmVbMF0ubGVuZ3RoKXx8KGU9aSxuPW8sdGhpcy5vcHRpb25zLmZsZXgpKTtvKyspO3JldHVybiBlPyhyPWVbMF0ubWF0Y2goLyg/OlxyXG4/fFxuKS4qL2cpLHImJih0aGlzLnl5bGluZW5vKz1yLmxlbmd0aCksdGhpcy55eWxsb2M9e2ZpcnN0X2xpbmU6dGhpcy55eWxsb2MubGFzdF9saW5lLGxhc3RfbGluZTp0aGlzLnl5bGluZW5vKzEsZmlyc3RfY29sdW1uOnRoaXMueXlsbG9jLmxhc3RfY29sdW1uLGxhc3RfY29sdW1uOnI/cltyLmxlbmd0aC0xXS5sZW5ndGgtcltyLmxlbmd0aC0xXS5tYXRjaCgvXHI/XG4/LylbMF0ubGVuZ3RoOnRoaXMueXlsbG9jLmxhc3RfY29sdW1uK2VbMF0ubGVuZ3RofSx0aGlzLnl5dGV4dCs9ZVswXSx0aGlzLm1hdGNoKz1lWzBdLHRoaXMubWF0Y2hlcz1lLHRoaXMueXlsZW5nPXRoaXMueXl0ZXh0Lmxlbmd0aCx0aGlzLm9wdGlvbnMucmFuZ2VzJiYodGhpcy55eWxsb2MucmFuZ2U9W3RoaXMub2Zmc2V0LHRoaXMub2Zmc2V0Kz10aGlzLnl5bGVuZ10pLHRoaXMuX21vcmU9ITEsdGhpcy5faW5wdXQ9dGhpcy5faW5wdXQuc2xpY2UoZVswXS5sZW5ndGgpLHRoaXMubWF0Y2hlZCs9ZVswXSx0PXRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKHRoaXMsdGhpcy55eSx0aGlzLHNbbl0sdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aC0xXSksdGhpcy5kb25lJiZ0aGlzLl9pbnB1dCYmKHRoaXMuZG9uZT0hMSksdD90OnZvaWQgMCk6IiI9PT10aGlzLl9pbnB1dD90aGlzLkVPRjp0aGlzLnBhcnNlRXJyb3IoIkxleGljYWwgZXJyb3Igb24gbGluZSAiKyh0aGlzLnl5bGluZW5vKzEpKyIuIFVucmVjb2duaXplZCB0ZXh0LlxuIit0aGlzLnNob3dQb3NpdGlvbigpLHt0ZXh0OiIiLHRva2VuOm51bGwsbGluZTp0aGlzLnl5bGluZW5vfSl9LGxleDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubmV4dCgpO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgdD90OnRoaXMubGV4KCl9LGJlZ2luOmZ1bmN0aW9uKHQpe3RoaXMuY29uZGl0aW9uU3RhY2sucHVzaCh0KX0scG9wU3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25kaXRpb25TdGFjay5wb3AoKX0sX2N1cnJlbnRSdWxlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbmRpdGlvbnNbdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aC0xXV0ucnVsZXN9LHRvcFN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGgtMl19LHB1c2hTdGF0ZTpmdW5jdGlvbih0KXt0aGlzLmJlZ2luKHQpfX07cmV0dXJuIHQub3B0aW9ucz17fSx0LnBlcmZvcm1BY3Rpb249ZnVuY3Rpb24odCxlLGksbil7ZnVuY3Rpb24gcih0LGkpe3JldHVybiBlLnl5dGV4dD1lLnl5dGV4dC5zdWJzdHIodCxlLnl5bGVuZy1pKX1zd2l0Y2goaSl7Y2FzZSAwOmlmKCJcXFxcIj09PWUueXl0ZXh0LnNsaWNlKC0yKT8ocigwLDEpLHRoaXMuYmVnaW4oIm11IikpOiJcXCI9PT1lLnl5dGV4dC5zbGljZSgtMSk/KHIoMCwxKSx0aGlzLmJlZ2luKCJlbXUiKSk6dGhpcy5iZWdpbigibXUiKSxlLnl5dGV4dClyZXR1cm4gMTU7YnJlYWs7Y2FzZSAxOnJldHVybiAxNTtjYXNlIDI6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSwxNTtjYXNlIDM6cmV0dXJuIHRoaXMuYmVnaW4oInJhdyIpLDE1O2Nhc2UgNDpyZXR1cm4gdGhpcy5wb3BTdGF0ZSgpLCJyYXciPT09dGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aC0xXT8xNTooZS55eXRleHQ9ZS55eXRleHQuc3Vic3RyKDUsZS55eWxlbmctOSksIkVORF9SQVdfQkxPQ0siKTtjYXNlIDU6cmV0dXJuIDE1O2Nhc2UgNjpyZXR1cm4gdGhpcy5wb3BTdGF0ZSgpLDE0O2Nhc2UgNzpyZXR1cm4gNjU7Y2FzZSA4OnJldHVybiA2ODtjYXNlIDk6cmV0dXJuIDE5O2Nhc2UgMTA6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSx0aGlzLmJlZ2luKCJyYXciKSwyMztjYXNlIDExOnJldHVybiA1NTtjYXNlIDEyOnJldHVybiA2MDtjYXNlIDEzOnJldHVybiAyOTtjYXNlIDE0OnJldHVybiA0NztjYXNlIDE1OnJldHVybiB0aGlzLnBvcFN0YXRlKCksNDQ7Y2FzZSAxNjpyZXR1cm4gdGhpcy5wb3BTdGF0ZSgpLDQ0O2Nhc2UgMTc6cmV0dXJuIDM0O2Nhc2UgMTg6cmV0dXJuIDM5O2Nhc2UgMTk6cmV0dXJuIDUxO2Nhc2UgMjA6cmV0dXJuIDQ4O2Nhc2UgMjE6dGhpcy51bnB1dChlLnl5dGV4dCksdGhpcy5wb3BTdGF0ZSgpLHRoaXMuYmVnaW4oImNvbSIpO2JyZWFrO2Nhc2UgMjI6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSwxNDtjYXNlIDIzOnJldHVybiA0ODtjYXNlIDI0OnJldHVybiA3MztjYXNlIDI1OnJldHVybiA3MjtjYXNlIDI2OnJldHVybiA3MjtjYXNlIDI3OnJldHVybiA4NztjYXNlIDI4OmJyZWFrO2Nhc2UgMjk6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSw1NDtjYXNlIDMwOnJldHVybiB0aGlzLnBvcFN0YXRlKCksMzM7Y2FzZSAzMTpyZXR1cm4gZS55eXRleHQ9cigxLDIpLnJlcGxhY2UoL1xcIi9nLCciJyksODA7Y2FzZSAzMjpyZXR1cm4gZS55eXRleHQ9cigxLDIpLnJlcGxhY2UoL1xcJy9nLCInIiksODA7Y2FzZSAzMzpyZXR1cm4gODU7Y2FzZSAzNDpyZXR1cm4gODI7Y2FzZSAzNTpyZXR1cm4gODI7Y2FzZSAzNjpyZXR1cm4gODM7Y2FzZSAzNzpyZXR1cm4gODQ7Y2FzZSAzODpyZXR1cm4gODE7Y2FzZSAzOTpyZXR1cm4gNzU7Y2FzZSA0MDpyZXR1cm4gNzc7Y2FzZSA0MTpyZXR1cm4gNzI7Y2FzZSA0MjpyZXR1cm4gZS55eXRleHQ9ZS55eXRleHQucmVwbGFjZSgvXFwoW1xcXF1dKS9nLCIkMSIpLDcyO2Nhc2UgNDM6cmV0dXJuIklOVkFMSUQiO2Nhc2UgNDQ6cmV0dXJuIDV9fSx0LnJ1bGVzPVsvXig/OlteXHgwMF0qPyg/PShce1x7KSkpLywvXig/OlteXHgwMF0rKS8sL14oPzpbXlx4MDBdezIsfT8oPz0oXHtce3xcXFx7XHt8XFxcXFx7XHt8JCkpKS8sL14oPzpce1x7XHtceyg/PVteXC9dKSkvLC9eKD86XHtce1x7XHtcL1teXHMhIiMlLSxcLlwvOy0+QFxbLVxeYFx7LX5dKyg/PVs9fVxzXC8uXSlcfVx9XH1cfSkvLC9eKD86W15ceDAwXSo/KD89KFx7XHtce1x7KSkpLywvXig/Oltcc1xTXSo/LS0ofik/XH1cfSkvLC9eKD86XCgpLywvXig/OlwpKS8sL14oPzpce1x7XHtceykvLC9eKD86XH1cfVx9XH0pLywvXig/Olx7XHsofik/PikvLC9eKD86XHtceyh+KT8jPikvLC9eKD86XHtceyh+KT8jXCo/KS8sL14oPzpce1x7KH4pP1wvKS8sL14oPzpce1x7KH4pP1xeXHMqKH4pP1x9XH0pLywvXig/Olx7XHsofik/XHMqZWxzZVxzKih+KT9cfVx9KS8sL14oPzpce1x7KH4pP1xeKS8sL14oPzpce1x7KH4pP1xzKmVsc2VcYikvLC9eKD86XHtceyh+KT9ceykvLC9eKD86XHtceyh+KT8mKS8sL14oPzpce1x7KH4pPyEtLSkvLC9eKD86XHtceyh+KT8hW1xzXFNdKj9cfVx9KS8sL14oPzpce1x7KH4pP1wqPykvLC9eKD86PSkvLC9eKD86XC5cLikvLC9eKD86XC4oPz0oWz1+fVxzXC8uKXxdKSkpLywvXig/OltcLy5dKS8sL14oPzpccyspLywvXig/Olx9KH4pP1x9XH0pLywvXig/Oih+KT9cfVx9KS8sL14oPzoiKFxcWyJdfFteIl0pKiIpLywvXig/OicoXFxbJ118W14nXSkqJykvLC9eKD86QCkvLC9eKD86dHJ1ZSg/PShbfn1ccyldKSkpLywvXig/OmZhbHNlKD89KFt+fVxzKV0pKSkvLC9eKD86dW5kZWZpbmVkKD89KFt+fVxzKV0pKSkvLC9eKD86bnVsbCg/PShbfn1ccyldKSkpLywvXig/Oi0/WzAtOV0rKD86XC5bMC05XSspPyg/PShbfn1ccyldKSkpLywvXig/OmFzXHMrXHwpLywvXig/Olx8KS8sL14oPzooW15ccyEiIyUtLFwuXC87LT5AXFstXF5gXHstfl0rKD89KFs9fn1cc1wvLil8XSkpKSkvLC9eKD86XFsoXFxcXXxbXlxdXSkqXF0pLywvXig/Oi4pLywvXig/OiQpL10sdC5jb25kaXRpb25zPXttdTp7cnVsZXM6WzcsOCw5LDEwLDExLDEyLDEzLDE0LDE1LDE2LDE3LDE4LDE5LDIwLDIxLDIyLDIzLDI0LDI1LDI2LDI3LDI4LDI5LDMwLDMxLDMyLDMzLDM0LDM1LDM2LDM3LDM4LDM5LDQwLDQxLDQyLDQzLDQ0XSxpbmNsdXNpdmU6ITF9LGVtdTp7cnVsZXM6WzJdLGluY2x1c2l2ZTohMX0sY29tOntydWxlczpbNl0saW5jbHVzaXZlOiExfSxyYXc6e3J1bGVzOlszLDQsNV0saW5jbHVzaXZlOiExfSxJTklUSUFMOntydWxlczpbMCwxLDQ0XSxpbmNsdXNpdmU6ITB9fSx0fSgpO3JldHVybiBlLmxleGVyPWksdC5wcm90b3R5cGU9ZSxlLlBhcnNlcj10LG5ldyB0fSgpO2UuX19lc01vZHVsZT0hMCxlWyJkZWZhdWx0Il09aX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKCl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aDw9MHx8dm9pZCAwPT09YXJndW1lbnRzWzBdP3t9OmFyZ3VtZW50c1swXTt0aGlzLm9wdGlvbnM9dH1mdW5jdGlvbiByKHQsZSxpKXt2b2lkIDA9PT1lJiYoZT10Lmxlbmd0aCk7dmFyIG49dFtlLTFdLHI9dFtlLTJdO3JldHVybiBuPyJDb250ZW50U3RhdGVtZW50Ij09PW4udHlwZT8ocnx8IWk/L1xyP1xuXHMqPyQvOi8oXnxccj9cbilccyo/JC8pLnRlc3Qobi5vcmlnaW5hbCk6dm9pZCAwOml9ZnVuY3Rpb24gcyh0LGUsaSl7dm9pZCAwPT09ZSYmKGU9LTEpO3ZhciBuPXRbZSsxXSxyPXRbZSsyXTtyZXR1cm4gbj8iQ29udGVudFN0YXRlbWVudCI9PT1uLnR5cGU/KHJ8fCFpPy9eXHMqP1xyP1xuLzovXlxzKj8oXHI/XG58JCkvKS50ZXN0KG4ub3JpZ2luYWwpOnZvaWQgMDppfWZ1bmN0aW9uIG8odCxlLGkpe3ZhciBuPXRbbnVsbD09ZT8wOmUrMV07aWYobiYmIkNvbnRlbnRTdGF0ZW1lbnQiPT09bi50eXBlJiYoaXx8IW4ucmlnaHRTdHJpcHBlZCkpe3ZhciByPW4udmFsdWU7bi52YWx1ZT1uLnZhbHVlLnJlcGxhY2UoaT8vXlxzKy86L15bIFx0XSpccj9cbj8vLCIiKSxuLnJpZ2h0U3RyaXBwZWQ9bi52YWx1ZSE9PXJ9fWZ1bmN0aW9uIGEodCxlLGkpe3ZhciBuPXRbbnVsbD09ZT90Lmxlbmd0aC0xOmUtMV07aWYobiYmIkNvbnRlbnRTdGF0ZW1lbnQiPT09bi50eXBlJiYoaXx8IW4ubGVmdFN0cmlwcGVkKSl7dmFyIHI9bi52YWx1ZTtyZXR1cm4gbi52YWx1ZT1uLnZhbHVlLnJlcGxhY2UoaT8vXHMrJC86L1sgXHRdKyQvLCIiKSxuLmxlZnRTdHJpcHBlZD1uLnZhbHVlIT09cixuLmxlZnRTdHJpcHBlZH19dmFyIGw9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMDt2YXIgYz1pKDI1KSx1PWwoYyk7bi5wcm90b3R5cGU9bmV3IHVbImRlZmF1bHQiXSxuLnByb3RvdHlwZS5Qcm9ncmFtPWZ1bmN0aW9uKHQpe3ZhciBlPSF0aGlzLm9wdGlvbnMuaWdub3JlU3RhbmRhbG9uZSxpPSF0aGlzLmlzUm9vdFNlZW47dGhpcy5pc1Jvb3RTZWVuPSEwO2Zvcih2YXIgbj10LmJvZHksbD0wLGM9bi5sZW5ndGg7bDxjO2wrKyl7dmFyIHU9bltsXSxkPXRoaXMuYWNjZXB0KHUpO2lmKGQpe3ZhciBoPXIobixsLGkpLHA9cyhuLGwsaSksZj1kLm9wZW5TdGFuZGFsb25lJiZoLG09ZC5jbG9zZVN0YW5kYWxvbmUmJnAsXz1kLmlubGluZVN0YW5kYWxvbmUmJmgmJnA7ZC5jbG9zZSYmbyhuLGwsITApLGQub3BlbiYmYShuLGwsITApLGUmJl8mJihvKG4sbCksYShuLGwpJiYiUGFydGlhbFN0YXRlbWVudCI9PT11LnR5cGUmJih1LmluZGVudD0vKFsgXHRdKyQpLy5leGVjKG5bbC0xXS5vcmlnaW5hbClbMV0pKSxlJiZmJiYobygodS5wcm9ncmFtfHx1LmludmVyc2UpLmJvZHkpLGEobixsKSksZSYmbSYmKG8obixsKSxhKCh1LmludmVyc2V8fHUucHJvZ3JhbSkuYm9keSkpfX1yZXR1cm4gdH0sbi5wcm90b3R5cGUuQmxvY2tTdGF0ZW1lbnQ9bi5wcm90b3R5cGUuRGVjb3JhdG9yQmxvY2s9bi5wcm90b3R5cGUuUGFydGlhbEJsb2NrU3RhdGVtZW50PWZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0KHQucHJvZ3JhbSksdGhpcy5hY2NlcHQodC5pbnZlcnNlKTt2YXIgZT10LnByb2dyYW18fHQuaW52ZXJzZSxpPXQucHJvZ3JhbSYmdC5pbnZlcnNlLG49aSxsPWk7aWYoaSYmaS5jaGFpbmVkKWZvcihuPWkuYm9keVswXS5wcm9ncmFtO2wuY2hhaW5lZDspbD1sLmJvZHlbbC5ib2R5Lmxlbmd0aC0xXS5wcm9ncmFtO3ZhciBjPXtvcGVuOnQub3BlblN0cmlwLm9wZW4sY2xvc2U6dC5jbG9zZVN0cmlwLmNsb3NlLG9wZW5TdGFuZGFsb25lOnMoZS5ib2R5KSxjbG9zZVN0YW5kYWxvbmU6cigobnx8ZSkuYm9keSl9O2lmKHQub3BlblN0cmlwLmNsb3NlJiZvKGUuYm9keSxudWxsLCEwKSxpKXt2YXIgdT10LmludmVyc2VTdHJpcDt1Lm9wZW4mJmEoZS5ib2R5LG51bGwsITApLHUuY2xvc2UmJm8obi5ib2R5LG51bGwsITApLHQuY2xvc2VTdHJpcC5vcGVuJiZhKGwuYm9keSxudWxsLCEwKSwhdGhpcy5vcHRpb25zLmlnbm9yZVN0YW5kYWxvbmUmJnIoZS5ib2R5KSYmcyhuLmJvZHkpJiYoYShlLmJvZHkpLG8obi5ib2R5KSl9ZWxzZSB0LmNsb3NlU3RyaXAub3BlbiYmYShlLmJvZHksbnVsbCwhMCk7cmV0dXJuIGN9LG4ucHJvdG90eXBlLkRlY29yYXRvcj1uLnByb3RvdHlwZS5NdXN0YWNoZVN0YXRlbWVudD1mdW5jdGlvbih0KXtyZXR1cm4gdC5zdHJpcH0sbi5wcm90b3R5cGUuUGFydGlhbFN0YXRlbWVudD1uLnByb3RvdHlwZS5Db21tZW50U3RhdGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlPXQuc3RyaXB8fHt9O3JldHVybntpbmxpbmVTdGFuZGFsb25lOiEwLG9wZW46ZS5vcGVuLGNsb3NlOmUuY2xvc2V9fSxlWyJkZWZhdWx0Il09bix0LmV4cG9ydHM9ZVsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oKXt0aGlzLnBhcmVudHM9W119ZnVuY3Rpb24gcih0KXt0aGlzLmFjY2VwdFJlcXVpcmVkKHQsInBhdGgiKSx0aGlzLmFjY2VwdEFycmF5KHQucGFyYW1zKSx0aGlzLmFjY2VwdEtleSh0LCJoYXNoIil9ZnVuY3Rpb24gcyh0KXtyLmNhbGwodGhpcyx0KSx0aGlzLmFjY2VwdEtleSh0LCJwcm9ncmFtIiksdGhpcy5hY2NlcHRLZXkodCwiaW52ZXJzZSIpfWZ1bmN0aW9uIG8odCl7dGhpcy5hY2NlcHRSZXF1aXJlZCh0LCJuYW1lIiksdGhpcy5hY2NlcHRBcnJheSh0LnBhcmFtcyksdGhpcy5hY2NlcHRLZXkodCwiaGFzaCIpfXZhciBhPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIGw9aSg2KSxjPWEobCk7bi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOm4sbXV0YXRpbmc6ITEsYWNjZXB0S2V5OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5hY2NlcHQodFtlXSk7aWYodGhpcy5tdXRhdGluZyl7aWYoaSYmIW4ucHJvdG90eXBlW2kudHlwZV0pdGhyb3cgbmV3IGNbImRlZmF1bHQiXSgnVW5leHBlY3RlZCBub2RlIHR5cGUgIicraS50eXBlKyciIGZvdW5kIHdoZW4gYWNjZXB0aW5nICcrZSsiIG9uICIrdC50eXBlKTt0W2VdPWl9fSxhY2NlcHRSZXF1aXJlZDpmdW5jdGlvbih0LGUpe2lmKHRoaXMuYWNjZXB0S2V5KHQsZSksIXRbZV0pdGhyb3cgbmV3IGNbImRlZmF1bHQiXSh0LnR5cGUrIiByZXF1aXJlcyAiK2UpfSxhY2NlcHRBcnJheTpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPXQubGVuZ3RoO2U8aTtlKyspdGhpcy5hY2NlcHRLZXkodCxlKSx0W2VdfHwodC5zcGxpY2UoZSwxKSxlLS0saS0tKX0sYWNjZXB0OmZ1bmN0aW9uKHQpe2lmKHQpe2lmKCF0aGlzW3QudHlwZV0pdGhyb3cgbmV3IGNbImRlZmF1bHQiXSgiVW5rbm93biB0eXBlOiAiK3QudHlwZSx0KTt0aGlzLmN1cnJlbnQmJnRoaXMucGFyZW50cy51bnNoaWZ0KHRoaXMuY3VycmVudCksdGhpcy5jdXJyZW50PXQ7dmFyIGU9dGhpc1t0LnR5cGVdKHQpO3JldHVybiB0aGlzLmN1cnJlbnQ9dGhpcy5wYXJlbnRzLnNoaWZ0KCksIXRoaXMubXV0YXRpbmd8fGU/ZTplIT09ITE/dDp2b2lkIDB9fSxQcm9ncmFtOmZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0QXJyYXkodC5ib2R5KX0sTXVzdGFjaGVTdGF0ZW1lbnQ6cixEZWNvcmF0b3I6cixCbG9ja1N0YXRlbWVudDpzLERlY29yYXRvckJsb2NrOnMsUGFydGlhbFN0YXRlbWVudDpvLFBhcnRpYWxCbG9ja1N0YXRlbWVudDpmdW5jdGlvbih0KXtvLmNhbGwodGhpcyx0KSx0aGlzLmFjY2VwdEtleSh0LCJwcm9ncmFtIil9LENvbnRlbnRTdGF0ZW1lbnQ6ZnVuY3Rpb24oKXt9LENvbW1lbnRTdGF0ZW1lbnQ6ZnVuY3Rpb24oKXt9LFN1YkV4cHJlc3Npb246cixQYXRoRXhwcmVzc2lvbjpmdW5jdGlvbigpe30sU3RyaW5nTGl0ZXJhbDpmdW5jdGlvbigpe30sTnVtYmVyTGl0ZXJhbDpmdW5jdGlvbigpe30sQm9vbGVhbkxpdGVyYWw6ZnVuY3Rpb24oKXt9LFVuZGVmaW5lZExpdGVyYWw6ZnVuY3Rpb24oKXt9LE51bGxMaXRlcmFsOmZ1bmN0aW9uKCl7fSxIYXNoOmZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0QXJyYXkodC5wYWlycyl9LEhhc2hQYWlyOmZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0UmVxdWlyZWQodCwidmFsdWUiKX19LGVbImRlZmF1bHQiXT1uLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0LGUpe2lmKGU9ZS5wYXRoP2UucGF0aC5vcmlnaW5hbDplLHQucGF0aC5vcmlnaW5hbCE9PWUpe3ZhciBpPXtsb2M6dC5wYXRoLmxvY307dGhyb3cgbmV3IF9bImRlZmF1bHQiXSh0LnBhdGgub3JpZ2luYWwrIiBkb2Vzbid0IG1hdGNoICIrZSxpKX19ZnVuY3Rpb24gcih0LGUpe3RoaXMuc291cmNlPXQsdGhpcy5zdGFydD17bGluZTplLmZpcnN0X2xpbmUsY29sdW1uOmUuZmlyc3RfY29sdW1ufSx0aGlzLmVuZD17bGluZTplLmxhc3RfbGluZSxjb2x1bW46ZS5sYXN0X2NvbHVtbn19ZnVuY3Rpb24gcyh0KXtyZXR1cm4vXlxbLipcXSQvLnRlc3QodCk/dC5zdWJzdHIoMSx0Lmxlbmd0aC0yKTp0fWZ1bmN0aW9uIG8odCxlKXtyZXR1cm57b3BlbjoifiI9PT10LmNoYXJBdCgyKSxjbG9zZToifiI9PT1lLmNoYXJBdChlLmxlbmd0aC0zKX19ZnVuY3Rpb24gYSh0KXtyZXR1cm4gdC5yZXBsYWNlKC9eXHtce34/XCEtPy0/LywiIikucmVwbGFjZSgvLT8tP34/XH1cfSQvLCIiKX1mdW5jdGlvbiBsKHQsZSxpKXtpPXRoaXMubG9jSW5mbyhpKTtmb3IodmFyIG49dD8iQCI6IiIscj1bXSxzPTAsbz0iIixhPTAsbD1lLmxlbmd0aDthPGw7YSsrKXt2YXIgYz1lW2FdLnBhcnQsdT1lW2FdLm9yaWdpbmFsIT09YztpZihuKz0oZVthXS5zZXBhcmF0b3J8fCIiKStjLHV8fCIuLiIhPT1jJiYiLiIhPT1jJiYidGhpcyIhPT1jKXIucHVzaChjKTtlbHNle2lmKHIubGVuZ3RoPjApdGhyb3cgbmV3IF9bImRlZmF1bHQiXSgiSW52YWxpZCBwYXRoOiAiK24se2xvYzppfSk7Ii4uIj09PWMmJihzKyssbys9Ii4uLyIpfX1yZXR1cm57dHlwZToiUGF0aEV4cHJlc3Npb24iLGRhdGE6dCxkZXB0aDpzLHBhcnRzOnIsb3JpZ2luYWw6bixsb2M6aX19ZnVuY3Rpb24gYyh0LGUsaSxuLHIscyl7dmFyIG89bi5jaGFyQXQoMyl8fG4uY2hhckF0KDIpLGE9InsiIT09byYmIiYiIT09byxsPS9cKi8udGVzdChuKTtyZXR1cm57dHlwZTpsPyJEZWNvcmF0b3IiOiJNdXN0YWNoZVN0YXRlbWVudCIscGF0aDp0LHBhcmFtczplLGhhc2g6aSxlc2NhcGVkOmEsc3RyaXA6cixsb2M6dGhpcy5sb2NJbmZvKHMpfX1mdW5jdGlvbiB1KHQsZSxpLHIpe24odCxpKSxyPXRoaXMubG9jSW5mbyhyKTt2YXIgcz17dHlwZToiUHJvZ3JhbSIsYm9keTplLHN0cmlwOnt9LGxvYzpyfTtyZXR1cm57dHlwZToiQmxvY2tTdGF0ZW1lbnQiLHBhdGg6dC5wYXRoLHBhcmFtczp0LnBhcmFtcyxoYXNoOnQuaGFzaCxwcm9ncmFtOnMsb3BlblN0cmlwOnt9LGludmVyc2VTdHJpcDp7fSxjbG9zZVN0cmlwOnt9LGxvYzpyfX1mdW5jdGlvbiBkKHQsZSxpLHIscyxvKXtyJiZyLnBhdGgmJm4odCxyKTt2YXIgYT0vXCovLnRlc3QodC5vcGVuKTtlLmJsb2NrUGFyYW1zPXQuYmxvY2tQYXJhbXM7dmFyIGw9dm9pZCAwLGM9dm9pZCAwO2lmKGkpe2lmKGEpdGhyb3cgbmV3IF9bImRlZmF1bHQiXSgiVW5leHBlY3RlZCBpbnZlcnNlIGJsb2NrIG9uIGRlY29yYXRvciIsaSk7aS5jaGFpbiYmKGkucHJvZ3JhbS5ib2R5WzBdLmNsb3NlU3RyaXA9ci5zdHJpcCksYz1pLnN0cmlwLGw9aS5wcm9ncmFtfXJldHVybiBzJiYocz1sLGw9ZSxlPXMpLHt0eXBlOmE/IkRlY29yYXRvckJsb2NrIjoiQmxvY2tTdGF0ZW1lbnQiLHBhdGg6dC5wYXRoLHBhcmFtczp0LnBhcmFtcyxoYXNoOnQuaGFzaCxwcm9ncmFtOmUsaW52ZXJzZTpsLG9wZW5TdHJpcDp0LnN0cmlwLGludmVyc2VTdHJpcDpjLGNsb3NlU3RyaXA6ciYmci5zdHJpcCxsb2M6dGhpcy5sb2NJbmZvKG8pfX1mdW5jdGlvbiBoKHQsZSl7aWYoIWUmJnQubGVuZ3RoKXt2YXIgaT10WzBdLmxvYyxuPXRbdC5sZW5ndGgtMV0ubG9jO2kmJm4mJihlPXtzb3VyY2U6aS5zb3VyY2Usc3RhcnQ6e2xpbmU6aS5zdGFydC5saW5lLGNvbHVtbjppLnN0YXJ0LmNvbHVtbn0sZW5kOntsaW5lOm4uZW5kLmxpbmUsY29sdW1uOm4uZW5kLmNvbHVtbn19KX1yZXR1cm57dHlwZToiUHJvZ3JhbSIsYm9keTp0LHN0cmlwOnt9LGxvYzplfX1mdW5jdGlvbiBwKHQsZSxpLHIpe3JldHVybiBuKHQsaSkse3R5cGU6IlBhcnRpYWxCbG9ja1N0YXRlbWVudCIsbmFtZTp0LnBhdGgscGFyYW1zOnQucGFyYW1zLGhhc2g6dC5oYXNoLHByb2dyYW06ZSxvcGVuU3RyaXA6dC5zdHJpcCxjbG9zZVN0cmlwOmkmJmkuc3RyaXAsbG9jOnRoaXMubG9jSW5mbyhyKX19dmFyIGY9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMCxlLlNvdXJjZUxvY2F0aW9uPXIsZS5pZD1zLGUuc3RyaXBGbGFncz1vLGUuc3RyaXBDb21tZW50PWEsZS5wcmVwYXJlUGF0aD1sLGUucHJlcGFyZU11c3RhY2hlPWMsZS5wcmVwYXJlUmF3QmxvY2s9dSxlLnByZXBhcmVCbG9jaz1kLGUucHJlcGFyZVByb2dyYW09aCxlLnByZXBhcmVQYXJ0aWFsQmxvY2s9cDt2YXIgbT1pKDYpLF89ZihtKX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKCl7fWZ1bmN0aW9uIHIodCxlLGkpe2lmKG51bGw9PXR8fCJzdHJpbmciIT10eXBlb2YgdCYmIlByb2dyYW0iIT09dC50eXBlKXRocm93IG5ldyB1WyJkZWZhdWx0Il0oIllvdSBtdXN0IHBhc3MgYSBzdHJpbmcgb3IgSGFuZGxlYmFycyBBU1QgdG8gSGFuZGxlYmFycy5wcmVjb21waWxlLiBZb3UgcGFzc2VkICIrdCk7ZT1lfHx7fSwiZGF0YSJpbiBlfHwoZS5kYXRhPSEwKSxlLmNvbXBhdCYmKGUudXNlRGVwdGhzPSEwKTt2YXIgbj1pLnBhcnNlKHQsZSkscj0obmV3IGkuQ29tcGlsZXIpLmNvbXBpbGUobixlKTtyZXR1cm4obmV3IGkuSmF2YVNjcmlwdENvbXBpbGVyKS5jb21waWxlKHIsZSl9ZnVuY3Rpb24gcyh0LGUsaSl7ZnVuY3Rpb24gbigpe3ZhciBuPWkucGFyc2UodCxlKSxyPShuZXcgaS5Db21waWxlcikuY29tcGlsZShuLGUpLHM9KG5ldyBpLkphdmFTY3JpcHRDb21waWxlcikuY29tcGlsZShyLGUsdm9pZCAwLCEwKTtyZXR1cm4gaS50ZW1wbGF0ZShzKX1mdW5jdGlvbiByKHQsZSl7cmV0dXJuIHN8fChzPW4oKSkscy5jYWxsKHRoaXMsdCxlKX1pZih2b2lkIDA9PT1lJiYoZT17fSksbnVsbD09dHx8InN0cmluZyIhPXR5cGVvZiB0JiYiUHJvZ3JhbSIhPT10LnR5cGUpdGhyb3cgbmV3IHVbImRlZmF1bHQiXSgiWW91IG11c3QgcGFzcyBhIHN0cmluZyBvciBIYW5kbGViYXJzIEFTVCB0byBIYW5kbGViYXJzLmNvbXBpbGUuIFlvdSBwYXNzZWQgIit0KTsiZGF0YSJpbiBlfHwoZS5kYXRhPSEwKSxlLmNvbXBhdCYmKGUudXNlRGVwdGhzPSEwKTt2YXIgcz12b2lkIDA7cmV0dXJuIHIuX3NldHVwPWZ1bmN0aW9uKHQpe3JldHVybiBzfHwocz1uKCkpLHMuX3NldHVwKHQpfSxyLl9jaGlsZD1mdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4gc3x8KHM9bigpKSxzLl9jaGlsZCh0LGUsaSxyKX0scn1mdW5jdGlvbiBvKHQsZSl7aWYodD09PWUpcmV0dXJuITA7aWYoZC5pc0FycmF5KHQpJiZkLmlzQXJyYXkoZSkmJnQubGVuZ3RoPT09ZS5sZW5ndGgpe2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKWlmKCFvKHRbaV0sZVtpXSkpcmV0dXJuITE7cmV0dXJuITB9fWZ1bmN0aW9uIGEodCl7aWYoIXQucGF0aC5wYXJ0cyl7dmFyIGU9dC5wYXRoO3QucGF0aD17dHlwZToiUGF0aEV4cHJlc3Npb24iLGRhdGE6ITEsZGVwdGg6MCxwYXJ0czpbZS5vcmlnaW5hbCsiIl0sb3JpZ2luYWw6ZS5vcmlnaW5hbCsiIixsb2M6ZS5sb2N9fX12YXIgbD1pKDEpWyJkZWZhdWx0Il07ZS5fX2VzTW9kdWxlPSEwLGUuQ29tcGlsZXI9bixlLnByZWNvbXBpbGU9cixlLmNvbXBpbGU9czt2YXIgYz1pKDYpLHU9bChjKSxkPWkoNSksaD1pKDIxKSxwPWwoaCksZj1bXS5zbGljZTtuLnByb3RvdHlwZT17Y29tcGlsZXI6bixlcXVhbHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5vcGNvZGVzLmxlbmd0aDtpZih0Lm9wY29kZXMubGVuZ3RoIT09ZSlyZXR1cm4hMTtmb3IodmFyIGk9MDtpPGU7aSsrKXt2YXIgbj10aGlzLm9wY29kZXNbaV0scj10Lm9wY29kZXNbaV07aWYobi5vcGNvZGUhPT1yLm9wY29kZXx8IW8obi5hcmdzLHIuYXJncykpcmV0dXJuITF9ZT10aGlzLmNoaWxkcmVuLmxlbmd0aDtmb3IodmFyIGk9MDtpPGU7aSsrKWlmKCF0aGlzLmNoaWxkcmVuW2ldLmVxdWFscyh0LmNoaWxkcmVuW2ldKSlyZXR1cm4hMTtyZXR1cm4hMH0sZ3VpZDowLGNvbXBpbGU6ZnVuY3Rpb24odCxlKXt0aGlzLnNvdXJjZU5vZGU9W10sdGhpcy5vcGNvZGVzPVtdLHRoaXMuY2hpbGRyZW49W10sdGhpcy5vcHRpb25zPWUsdGhpcy5zdHJpbmdQYXJhbXM9ZS5zdHJpbmdQYXJhbXMsdGhpcy50cmFja0lkcz1lLnRyYWNrSWRzLGUuYmxvY2tQYXJhbXM9ZS5ibG9ja1BhcmFtc3x8W107dmFyIGk9ZS5rbm93bkhlbHBlcnM7aWYoZS5rbm93bkhlbHBlcnM9e2hlbHBlck1pc3Npbmc6ITAsYmxvY2tIZWxwZXJNaXNzaW5nOiEwLGVhY2g6ITAsImlmIjohMCx1bmxlc3M6ITAsIndpdGgiOiEwLGxvZzohMCxsb29rdXA6ITB9LGkpZm9yKHZhciBuIGluIGkpbiBpbiBpJiYoZS5rbm93bkhlbHBlcnNbbl09aVtuXSk7cmV0dXJuIHRoaXMuYWNjZXB0KHQpfSxjb21waWxlUHJvZ3JhbTpmdW5jdGlvbih0KXt2YXIgZT1uZXcgdGhpcy5jb21waWxlcixpPWUuY29tcGlsZSh0LHRoaXMub3B0aW9ucyksbj10aGlzLmd1aWQrKztyZXR1cm4gdGhpcy51c2VQYXJ0aWFsPXRoaXMudXNlUGFydGlhbHx8aS51c2VQYXJ0aWFsLHRoaXMuY2hpbGRyZW5bbl09aSx0aGlzLnVzZURlcHRocz10aGlzLnVzZURlcHRoc3x8aS51c2VEZXB0aHMsbn0sYWNjZXB0OmZ1bmN0aW9uKHQpe2lmKCF0aGlzW3QudHlwZV0pdGhyb3cgbmV3IHVbImRlZmF1bHQiXSgiVW5rbm93biB0eXBlOiAiK3QudHlwZSx0KTt0aGlzLnNvdXJjZU5vZGUudW5zaGlmdCh0KTt2YXIgZT10aGlzW3QudHlwZV0odCk7cmV0dXJuIHRoaXMuc291cmNlTm9kZS5zaGlmdCgpLGV9LFByb2dyYW06ZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLnVuc2hpZnQodC5ibG9ja1BhcmFtcyk7Zm9yKHZhciBlPXQuYm9keSxpPWUubGVuZ3RoLG49MDtuPGk7bisrKXRoaXMuYWNjZXB0KGVbbl0pO3JldHVybiB0aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXMuc2hpZnQoKSx0aGlzLmlzU2ltcGxlPTE9PT1pLHRoaXMuYmxvY2tQYXJhbXM9dC5ibG9ja1BhcmFtcz90LmJsb2NrUGFyYW1zLmxlbmd0aDowLHRoaXN9LEJsb2NrU3RhdGVtZW50OmZ1bmN0aW9uKHQpe2EodCk7dmFyIGU9dC5wcm9ncmFtLGk9dC5pbnZlcnNlO2U9ZSYmdGhpcy5jb21waWxlUHJvZ3JhbShlKSxpPWkmJnRoaXMuY29tcGlsZVByb2dyYW0oaSk7dmFyIG49dGhpcy5jbGFzc2lmeVNleHByKHQpOyJoZWxwZXIiPT09bj90aGlzLmhlbHBlclNleHByKHQsZSxpKToic2ltcGxlIj09PW4/KHRoaXMuc2ltcGxlU2V4cHIodCksdGhpcy5vcGNvZGUoInB1c2hQcm9ncmFtIixlKSx0aGlzLm9wY29kZSgicHVzaFByb2dyYW0iLGkpLHRoaXMub3Bjb2RlKCJlbXB0eUhhc2giKSx0aGlzLm9wY29kZSgiYmxvY2tWYWx1ZSIsdC5wYXRoLm9yaWdpbmFsKSk6KHRoaXMuYW1iaWd1b3VzU2V4cHIodCxlLGkpLHRoaXMub3Bjb2RlKCJwdXNoUHJvZ3JhbSIsZSksdGhpcy5vcGNvZGUoInB1c2hQcm9ncmFtIixpKSx0aGlzLm9wY29kZSgiZW1wdHlIYXNoIiksdGhpcy5vcGNvZGUoImFtYmlndW91c0Jsb2NrVmFsdWUiKSksdGhpcy5vcGNvZGUoImFwcGVuZCIpfSxEZWNvcmF0b3JCbG9jazpmdW5jdGlvbih0KXt2YXIgZT10LnByb2dyYW0mJnRoaXMuY29tcGlsZVByb2dyYW0odC5wcm9ncmFtKSxpPXRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXModCxlLHZvaWQgMCksbj10LnBhdGg7dGhpcy51c2VEZWNvcmF0b3JzPSEwLHRoaXMub3Bjb2RlKCJyZWdpc3RlckRlY29yYXRvciIsaS5sZW5ndGgsbi5vcmlnaW5hbCl9LFBhcnRpYWxTdGF0ZW1lbnQ6ZnVuY3Rpb24odCl7dGhpcy51c2VQYXJ0aWFsPSEwO3ZhciBlPXQucHJvZ3JhbTtlJiYoZT10aGlzLmNvbXBpbGVQcm9ncmFtKHQucHJvZ3JhbSkpO3ZhciBpPXQucGFyYW1zO2lmKGkubGVuZ3RoPjEpdGhyb3cgbmV3IHVbImRlZmF1bHQiXSgiVW5zdXBwb3J0ZWQgbnVtYmVyIG9mIHBhcnRpYWwgYXJndW1lbnRzOiAiK2kubGVuZ3RoLHQpO2kubGVuZ3RofHwodGhpcy5vcHRpb25zLmV4cGxpY2l0UGFydGlhbENvbnRleHQ/dGhpcy5vcGNvZGUoInB1c2hMaXRlcmFsIiwidW5kZWZpbmVkIik6aS5wdXNoKHt0eXBlOiJQYXRoRXhwcmVzc2lvbiIscGFydHM6W10sZGVwdGg6MH0pKTt2YXIgbj10Lm5hbWUub3JpZ2luYWwscj0iU3ViRXhwcmVzc2lvbiI9PT10Lm5hbWUudHlwZTtyJiZ0aGlzLmFjY2VwdCh0Lm5hbWUpLHRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXModCxlLHZvaWQgMCwhMCk7dmFyIHM9dC5pbmRlbnR8fCIiO3RoaXMub3B0aW9ucy5wcmV2ZW50SW5kZW50JiZzJiYodGhpcy5vcGNvZGUoImFwcGVuZENvbnRlbnQiLHMpLHM9IiIpLHRoaXMub3Bjb2RlKCJpbnZva2VQYXJ0aWFsIixyLG4scyksdGhpcy5vcGNvZGUoImFwcGVuZCIpfSxQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQ6ZnVuY3Rpb24odCl7dGhpcy5QYXJ0aWFsU3RhdGVtZW50KHQpfSxNdXN0YWNoZVN0YXRlbWVudDpmdW5jdGlvbih0KXt0aGlzLlN1YkV4cHJlc3Npb24odCksdC5lc2NhcGVkJiYhdGhpcy5vcHRpb25zLm5vRXNjYXBlP3RoaXMub3Bjb2RlKCJhcHBlbmRFc2NhcGVkIik6dGhpcy5vcGNvZGUoImFwcGVuZCIpfSxEZWNvcmF0b3I6ZnVuY3Rpb24odCl7dGhpcy5EZWNvcmF0b3JCbG9jayh0KX0sQ29udGVudFN0YXRlbWVudDpmdW5jdGlvbih0KXt0LnZhbHVlJiZ0aGlzLm9wY29kZSgiYXBwZW5kQ29udGVudCIsdC52YWx1ZSl9LENvbW1lbnRTdGF0ZW1lbnQ6ZnVuY3Rpb24oKXt9LFN1YkV4cHJlc3Npb246ZnVuY3Rpb24odCl7YSh0KTt2YXIgZT10aGlzLmNsYXNzaWZ5U2V4cHIodCk7InNpbXBsZSI9PT1lP3RoaXMuc2ltcGxlU2V4cHIodCk6ImhlbHBlciI9PT1lP3RoaXMuaGVscGVyU2V4cHIodCk6dGhpcy5hbWJpZ3VvdXNTZXhwcih0KX0sYW1iaWd1b3VzU2V4cHI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQucGF0aCxyPW4ucGFydHNbMF0scz1udWxsIT1lfHxudWxsIT1pO3RoaXMub3Bjb2RlKCJnZXRDb250ZXh0IixuLmRlcHRoKSx0aGlzLm9wY29kZSgicHVzaFByb2dyYW0iLGUpLHRoaXMub3Bjb2RlKCJwdXNoUHJvZ3JhbSIsaSksbi5zdHJpY3Q9ITAsdGhpcy5hY2NlcHQobiksdGhpcy5vcGNvZGUoImludm9rZUFtYmlndW91cyIscixzKX0sc2ltcGxlU2V4cHI6ZnVuY3Rpb24odCl7dmFyIGU9dC5wYXRoO2Uuc3RyaWN0PSEwLHRoaXMuYWNjZXB0KGUpLHRoaXMub3Bjb2RlKCJyZXNvbHZlUG9zc2libGVMYW1iZGEiKX0saGVscGVyU2V4cHI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXModCxlLGkpLHI9dC5wYXRoLHM9ci5wYXJ0c1swXTtpZih0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzW3NdKXRoaXMub3Bjb2RlKCJpbnZva2VLbm93bkhlbHBlciIsbi5sZW5ndGgscyk7ZWxzZXtpZih0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzT25seSl0aHJvdyBuZXcgdVsiZGVmYXVsdCJdKCJZb3Ugc3BlY2lmaWVkIGtub3duSGVscGVyc09ubHksIGJ1dCB1c2VkIHRoZSB1bmtub3duIGhlbHBlciAiK3MsdCk7ci5zdHJpY3Q9ITAsci5mYWxzeT0hMCx0aGlzLmFjY2VwdChyKSx0aGlzLm9wY29kZSgiaW52b2tlSGVscGVyIixuLmxlbmd0aCxyLm9yaWdpbmFsLHBbImRlZmF1bHQiXS5oZWxwZXJzLnNpbXBsZUlkKHIpKX19LFBhdGhFeHByZXNzaW9uOmZ1bmN0aW9uKHQpe3RoaXMuYWRkRGVwdGgodC5kZXB0aCksdGhpcy5vcGNvZGUoImdldENvbnRleHQiLHQuZGVwdGgpO3ZhciBlPXQucGFydHNbMF0saT1wWyJkZWZhdWx0Il0uaGVscGVycy5zY29wZWRJZCh0KSxuPSF0LmRlcHRoJiYhaSYmdGhpcy5ibG9ja1BhcmFtSW5kZXgoZSk7bj90aGlzLm9wY29kZSgibG9va3VwQmxvY2tQYXJhbSIsbix0LnBhcnRzKTplP3QuZGF0YT8odGhpcy5vcHRpb25zLmRhdGE9ITAsdGhpcy5vcGNvZGUoImxvb2t1cERhdGEiLHQuZGVwdGgsdC5wYXJ0cyx0LnN0cmljdCkpOnRoaXMub3Bjb2RlKCJsb29rdXBPbkNvbnRleHQiLHQucGFydHMsdC5mYWxzeSx0LnN0cmljdCxpKTp0aGlzLm9wY29kZSgicHVzaENvbnRleHQiKX0sU3RyaW5nTGl0ZXJhbDpmdW5jdGlvbih0KXt0aGlzLm9wY29kZSgicHVzaFN0cmluZyIsdC52YWx1ZSl9LE51bWJlckxpdGVyYWw6ZnVuY3Rpb24odCl7dGhpcy5vcGNvZGUoInB1c2hMaXRlcmFsIix0LnZhbHVlKX0sQm9vbGVhbkxpdGVyYWw6ZnVuY3Rpb24odCl7dGhpcy5vcGNvZGUoInB1c2hMaXRlcmFsIix0LnZhbHVlKX0sVW5kZWZpbmVkTGl0ZXJhbDpmdW5jdGlvbigpe3RoaXMub3Bjb2RlKCJwdXNoTGl0ZXJhbCIsInVuZGVmaW5lZCIpfSxOdWxsTGl0ZXJhbDpmdW5jdGlvbigpe3RoaXMub3Bjb2RlKCJwdXNoTGl0ZXJhbCIsIm51bGwiKX0sSGFzaDpmdW5jdGlvbih0KXt2YXIgZT10LnBhaXJzLGk9MCxuPWUubGVuZ3RoO2Zvcih0aGlzLm9wY29kZSgicHVzaEhhc2giKTtpPG47aSsrKXRoaXMucHVzaFBhcmFtKGVbaV0udmFsdWUpO2Zvcig7aS0tOyl0aGlzLm9wY29kZSgiYXNzaWduVG9IYXNoIixlW2ldLmtleSk7dGhpcy5vcGNvZGUoInBvcEhhc2giKX0sb3Bjb2RlOmZ1bmN0aW9uKHQpe3RoaXMub3Bjb2Rlcy5wdXNoKHtvcGNvZGU6dCxhcmdzOmYuY2FsbChhcmd1bWVudHMsMSksbG9jOnRoaXMuc291cmNlTm9kZVswXS5sb2N9KX0sYWRkRGVwdGg6ZnVuY3Rpb24odCl7dCYmKHRoaXMudXNlRGVwdGhzPSEwKX0sY2xhc3NpZnlTZXhwcjpmdW5jdGlvbih0KXt2YXIgZT1wWyJkZWZhdWx0Il0uaGVscGVycy5zaW1wbGVJZCh0LnBhdGgpLGk9ZSYmISF0aGlzLmJsb2NrUGFyYW1JbmRleCh0LnBhdGgucGFydHNbMF0pLG49IWkmJnBbImRlZmF1bHQiXS5oZWxwZXJzLmhlbHBlckV4cHJlc3Npb24odCkscj0haSYmKG58fGUpO2lmKHImJiFuKXt2YXIgcz10LnBhdGgucGFydHNbMF0sbz10aGlzLm9wdGlvbnM7by5rbm93bkhlbHBlcnNbc10/bj0hMDpvLmtub3duSGVscGVyc09ubHkmJihyPSExKX1yZXR1cm4gbj8iaGVscGVyIjpyPyJhbWJpZ3VvdXMiOiJzaW1wbGUifSxwdXNoUGFyYW1zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl0aGlzLnB1c2hQYXJhbSh0W2VdKX0scHVzaFBhcmFtOmZ1bmN0aW9uKHQpe3ZhciBlPW51bGwhPXQudmFsdWU/dC52YWx1ZTp0Lm9yaWdpbmFsfHwiIjtpZih0aGlzLnN0cmluZ1BhcmFtcyllLnJlcGxhY2UmJihlPWUucmVwbGFjZSgvXihcLj9cLlwvKSovZywiIikucmVwbGFjZSgvXC8vZywiLiIpKSx0LmRlcHRoJiZ0aGlzLmFkZERlcHRoKHQuZGVwdGgpLHRoaXMub3Bjb2RlKCJnZXRDb250ZXh0Iix0LmRlcHRofHwwKSx0aGlzLm9wY29kZSgicHVzaFN0cmluZ1BhcmFtIixlLHQudHlwZSksIlN1YkV4cHJlc3Npb24iPT09dC50eXBlJiZ0aGlzLmFjY2VwdCh0KTtlbHNle2lmKHRoaXMudHJhY2tJZHMpe3ZhciBpPXZvaWQgMDtpZighdC5wYXJ0c3x8cFsiZGVmYXVsdCJdLmhlbHBlcnMuc2NvcGVkSWQodCl8fHQuZGVwdGh8fChpPXRoaXMuYmxvY2tQYXJhbUluZGV4KHQucGFydHNbMF0pKSxpKXt2YXIgbj10LnBhcnRzLnNsaWNlKDEpLmpvaW4oIi4iKTt0aGlzLm9wY29kZSgicHVzaElkIiwiQmxvY2tQYXJhbSIsaSxuKX1lbHNlIGU9dC5vcmlnaW5hbHx8ZSxlLnJlcGxhY2UmJihlPWUucmVwbGFjZSgvXnRoaXMoPzpcLnwkKS8sIiIpLnJlcGxhY2UoL15cLlwvLywiIikucmVwbGFjZSgvXlwuJC8sIiIpKSx0aGlzLm9wY29kZSgicHVzaElkIix0LnR5cGUsZSl9dGhpcy5hY2NlcHQodCl9fSxzZXR1cEZ1bGxNdXN0YWNoZVBhcmFtczpmdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10LnBhcmFtcztyZXR1cm4gdGhpcy5wdXNoUGFyYW1zKHIpLHRoaXMub3Bjb2RlKCJwdXNoUHJvZ3JhbSIsZSksdGhpcy5vcGNvZGUoInB1c2hQcm9ncmFtIixpKSx0Lmhhc2g/dGhpcy5hY2NlcHQodC5oYXNoKTp0aGlzLm9wY29kZSgiZW1wdHlIYXNoIixuKSxyfSxibG9ja1BhcmFtSW5kZXg6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXMubGVuZ3RoO2U8aTtlKyspe3ZhciBuPXRoaXMub3B0aW9ucy5ibG9ja1BhcmFtc1tlXSxyPW4mJmQuaW5kZXhPZihuLHQpO2lmKG4mJnI+PTApcmV0dXJuW2Uscl19fX19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0KXt0aGlzLnZhbHVlPXR9ZnVuY3Rpb24gcigpe31mdW5jdGlvbiBzKHQsZSxpLG4pe3ZhciByPWUucG9wU3RhY2soKSxzPTAsbz1pLmxlbmd0aDtmb3IodCYmby0tO3M8bztzKyspcj1lLm5hbWVMb29rdXAocixpW3NdLG4pO3JldHVybiB0P1tlLmFsaWFzYWJsZSgiY29udGFpbmVyLnN0cmljdCIpLCIoIixyLCIsICIsZS5xdW90ZWRTdHJpbmcoaVtzXSksIikiXTpyfXZhciBvPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIGE9aSg0KSxsPWkoNiksYz1vKGwpLHU9aSg1KSxkPWkoMjkpLGg9byhkKTtyLnByb3RvdHlwZT17bmFtZUxvb2t1cDpmdW5jdGlvbih0LGUpe3JldHVybiByLmlzVmFsaWRKYXZhU2NyaXB0VmFyaWFibGVOYW1lKGUpP1t0LCIuIixlXTpbdCwiWyIsSlNPTi5zdHJpbmdpZnkoZSksIl0iXX0sZGVwdGhlZExvb2t1cDpmdW5jdGlvbih0KXtyZXR1cm5bdGhpcy5hbGlhc2FibGUoImNvbnRhaW5lci5sb29rdXAiKSwnKGRlcHRocywgIicsdCwnIiknXX0sY29tcGlsZXJJbmZvOmZ1bmN0aW9uKCl7dmFyIHQ9YS5DT01QSUxFUl9SRVZJU0lPTixlPWEuUkVWSVNJT05fQ0hBTkdFU1t0XTtyZXR1cm5bdCxlXX0sYXBwZW5kVG9CdWZmZXI6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1LmlzQXJyYXkodCl8fCh0PVt0XSksdD10aGlzLnNvdXJjZS53cmFwKHQsZSksdGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZT9bInJldHVybiAiLHQsIjsiXTppP1siYnVmZmVyICs9ICIsdCwiOyJdOih0LmFwcGVuZFRvQnVmZmVyPSEwLHQpfSxpbml0aWFsaXplQnVmZmVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucXVvdGVkU3RyaW5nKCIiKX0sY29tcGlsZTpmdW5jdGlvbih0LGUsaSxuKXt0aGlzLmVudmlyb25tZW50PXQsdGhpcy5vcHRpb25zPWUsdGhpcy5zdHJpbmdQYXJhbXM9dGhpcy5vcHRpb25zLnN0cmluZ1BhcmFtcyx0aGlzLnRyYWNrSWRzPXRoaXMub3B0aW9ucy50cmFja0lkcyx0aGlzLnByZWNvbXBpbGU9IW4sdGhpcy5uYW1lPXRoaXMuZW52aXJvbm1lbnQubmFtZSx0aGlzLmlzQ2hpbGQ9ISFpLHRoaXMuY29udGV4dD1pfHx7ZGVjb3JhdG9yczpbXSxwcm9ncmFtczpbXSxlbnZpcm9ubWVudHM6W119LHRoaXMucHJlYW1ibGUoKSx0aGlzLnN0YWNrU2xvdD0wLHRoaXMuc3RhY2tWYXJzPVtdLHRoaXMuYWxpYXNlcz17fSx0aGlzLnJlZ2lzdGVycz17bGlzdDpbXX0sdGhpcy5oYXNoZXM9W10sdGhpcy5jb21waWxlU3RhY2s9W10sdGhpcy5pbmxpbmVTdGFjaz1bXSx0aGlzLmJsb2NrUGFyYW1zPVtdLHRoaXMuY29tcGlsZUNoaWxkcmVuKHQsZSksdGhpcy51c2VEZXB0aHM9dGhpcy51c2VEZXB0aHN8fHQudXNlRGVwdGhzfHx0LnVzZURlY29yYXRvcnN8fHRoaXMub3B0aW9ucy5jb21wYXQsdGhpcy51c2VCbG9ja1BhcmFtcz10aGlzLnVzZUJsb2NrUGFyYW1zfHx0LnVzZUJsb2NrUGFyYW1zO3ZhciByPXQub3Bjb2RlcyxzPXZvaWQgMCxvPXZvaWQgMCxhPXZvaWQgMCxsPXZvaWQgMDtmb3IoYT0wLGw9ci5sZW5ndGg7YTxsO2ErKylzPXJbYV0sdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uPXMubG9jLG89b3x8cy5sb2MsdGhpc1tzLm9wY29kZV0uYXBwbHkodGhpcyxzLmFyZ3MpO2lmKHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbj1vLHRoaXMucHVzaFNvdXJjZSgiIiksdGhpcy5zdGFja1Nsb3R8fHRoaXMuaW5saW5lU3RhY2subGVuZ3RofHx0aGlzLmNvbXBpbGVTdGFjay5sZW5ndGgpdGhyb3cgbmV3IGNbImRlZmF1bHQiXSgiQ29tcGlsZSBjb21wbGV0ZWQgd2l0aCBjb250ZW50IGxlZnQgb24gc3RhY2siKTt0aGlzLmRlY29yYXRvcnMuaXNFbXB0eSgpP3RoaXMuZGVjb3JhdG9ycz12b2lkIDA6KHRoaXMudXNlRGVjb3JhdG9ycz0hMCx0aGlzLmRlY29yYXRvcnMucHJlcGVuZCgidmFyIGRlY29yYXRvcnMgPSBjb250YWluZXIuZGVjb3JhdG9ycztcbiIpLHRoaXMuZGVjb3JhdG9ycy5wdXNoKCJyZXR1cm4gZm47Iiksbj90aGlzLmRlY29yYXRvcnM9RnVuY3Rpb24uYXBwbHkodGhpcyxbImZuIiwicHJvcHMiLCJjb250YWluZXIiLCJkZXB0aDAiLCJkYXRhIiwiYmxvY2tQYXJhbXMiLCJkZXB0aHMiLHRoaXMuZGVjb3JhdG9ycy5tZXJnZSgpXSk6KHRoaXMuZGVjb3JhdG9ycy5wcmVwZW5kKCJmdW5jdGlvbihmbiwgcHJvcHMsIGNvbnRhaW5lciwgZGVwdGgwLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7XG4iKSx0aGlzLmRlY29yYXRvcnMucHVzaCgifVxuIiksdGhpcy5kZWNvcmF0b3JzPXRoaXMuZGVjb3JhdG9ycy5tZXJnZSgpKSk7dmFyIHU9dGhpcy5jcmVhdGVGdW5jdGlvbkNvbnRleHQobik7aWYodGhpcy5pc0NoaWxkKXJldHVybiB1O3ZhciBkPXtjb21waWxlcjp0aGlzLmNvbXBpbGVySW5mbygpLG1haW46dX07dGhpcy5kZWNvcmF0b3JzJiYoZC5tYWluX2Q9dGhpcy5kZWNvcmF0b3JzLGQudXNlRGVjb3JhdG9ycz0hMCk7dmFyIGg9dGhpcy5jb250ZXh0LHA9aC5wcm9ncmFtcyxmPWguZGVjb3JhdG9ycztmb3IoYT0wLGw9cC5sZW5ndGg7YTxsO2ErKylwW2FdJiYoZFthXT1wW2FdLGZbYV0mJihkW2ErIl9kIl09ZlthXSxkLnVzZURlY29yYXRvcnM9ITApKTtyZXR1cm4gdGhpcy5lbnZpcm9ubWVudC51c2VQYXJ0aWFsJiYoZC51c2VQYXJ0aWFsPSEwKSx0aGlzLm9wdGlvbnMuZGF0YSYmKGQudXNlRGF0YT0hMCksdGhpcy51c2VEZXB0aHMmJihkLnVzZURlcHRocz0hMCksdGhpcy51c2VCbG9ja1BhcmFtcyYmKGQudXNlQmxvY2tQYXJhbXM9ITApLHRoaXMub3B0aW9ucy5jb21wYXQmJihkLmNvbXBhdD0hMCksbj9kLmNvbXBpbGVyT3B0aW9ucz10aGlzLm9wdGlvbnM6KGQuY29tcGlsZXI9SlNPTi5zdHJpbmdpZnkoZC5jb21waWxlciksdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uPXtzdGFydDp7bGluZToxLGNvbHVtbjowfX0sZD10aGlzLm9iamVjdExpdGVyYWwoZCksZS5zcmNOYW1lPyhkPWQudG9TdHJpbmdXaXRoU291cmNlTWFwKHtmaWxlOmUuZGVzdE5hbWV9KSxkLm1hcD1kLm1hcCYmZC5tYXAudG9TdHJpbmcoKSk6ZD1kLnRvU3RyaW5nKCkpLGR9LHByZWFtYmxlOmZ1bmN0aW9uKCl7dGhpcy5sYXN0Q29udGV4dD0wLHRoaXMuc291cmNlPW5ldyBoWyJkZWZhdWx0Il0odGhpcy5vcHRpb25zLnNyY05hbWUpLHRoaXMuZGVjb3JhdG9ycz1uZXcgaFsiZGVmYXVsdCJdKHRoaXMub3B0aW9ucy5zcmNOYW1lKX0sY3JlYXRlRnVuY3Rpb25Db250ZXh0OmZ1bmN0aW9uKHQpe3ZhciBlPSIiLGk9dGhpcy5zdGFja1ZhcnMuY29uY2F0KHRoaXMucmVnaXN0ZXJzLmxpc3QpO2kubGVuZ3RoPjAmJihlKz0iLCAiK2kuam9pbigiLCAiKSk7dmFyIG49MDtmb3IodmFyIHIgaW4gdGhpcy5hbGlhc2VzKXt2YXIgcz10aGlzLmFsaWFzZXNbcl07dGhpcy5hbGlhc2VzLmhhc093blByb3BlcnR5KHIpJiZzLmNoaWxkcmVuJiZzLnJlZmVyZW5jZUNvdW50PjEmJihlKz0iLCBhbGlhcyIrICsrbisiPSIrcixzLmNoaWxkcmVuWzBdPSJhbGlhcyIrbil9dmFyIG89WyJjb250YWluZXIiLCJkZXB0aDAiLCJoZWxwZXJzIiwicGFydGlhbHMiLCJkYXRhIl07KHRoaXMudXNlQmxvY2tQYXJhbXN8fHRoaXMudXNlRGVwdGhzKSYmby5wdXNoKCJibG9ja1BhcmFtcyIpLHRoaXMudXNlRGVwdGhzJiZvLnB1c2goImRlcHRocyIpO3ZhciBhPXRoaXMubWVyZ2VTb3VyY2UoZSk7cmV0dXJuIHQ/KG8ucHVzaChhKSxGdW5jdGlvbi5hcHBseSh0aGlzLG8pKTp0aGlzLnNvdXJjZS53cmFwKFsiZnVuY3Rpb24oIixvLmpvaW4oIiwiKSwiKSB7XG4gICIsYSwifSJdKX0sbWVyZ2VTb3VyY2U6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSxpPSF0aGlzLmZvcmNlQnVmZmVyLG49dm9pZCAwLHI9dm9pZCAwLHM9dm9pZCAwLG89dm9pZCAwO3JldHVybiB0aGlzLnNvdXJjZS5lYWNoKGZ1bmN0aW9uKHQpe3QuYXBwZW5kVG9CdWZmZXI/KHM/dC5wcmVwZW5kKCIgICsgIik6cz10LG89dCk6KHMmJihyP3MucHJlcGVuZCgiYnVmZmVyICs9ICIpOm49ITAsby5hZGQoIjsiKSxzPW89dm9pZCAwKSxyPSEwLGV8fChpPSExKSl9KSxpP3M/KHMucHJlcGVuZCgicmV0dXJuICIpLG8uYWRkKCI7IikpOnJ8fHRoaXMuc291cmNlLnB1c2goJ3JldHVybiAiIjsnKToodCs9IiwgYnVmZmVyID0gIisobj8iIjp0aGlzLmluaXRpYWxpemVCdWZmZXIoKSkscz8ocy5wcmVwZW5kKCJyZXR1cm4gYnVmZmVyICsgIiksby5hZGQoIjsiKSk6dGhpcy5zb3VyY2UucHVzaCgicmV0dXJuIGJ1ZmZlcjsiKSksdCYmdGhpcy5zb3VyY2UucHJlcGVuZCgidmFyICIrdC5zdWJzdHJpbmcoMikrKG4/IiI6IjtcbiIpKSx0aGlzLnNvdXJjZS5tZXJnZSgpfSxibG9ja1ZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuYWxpYXNhYmxlKCJoZWxwZXJzLmJsb2NrSGVscGVyTWlzc2luZyIpLGk9W3RoaXMuY29udGV4dE5hbWUoMCldO3RoaXMuc2V0dXBIZWxwZXJBcmdzKHQsMCxpKTt2YXIgbj10aGlzLnBvcFN0YWNrKCk7aS5zcGxpY2UoMSwwLG4pLHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoZSwiY2FsbCIsaSkpfSxhbWJpZ3VvdXNCbG9ja1ZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5hbGlhc2FibGUoImhlbHBlcnMuYmxvY2tIZWxwZXJNaXNzaW5nIiksZT1bdGhpcy5jb250ZXh0TmFtZSgwKV07dGhpcy5zZXR1cEhlbHBlckFyZ3MoIiIsMCxlLCEwKSx0aGlzLmZsdXNoSW5saW5lKCk7dmFyIGk9dGhpcy50b3BTdGFjaygpO2Uuc3BsaWNlKDEsMCxpKSx0aGlzLnB1c2hTb3VyY2UoWyJpZiAoISIsdGhpcy5sYXN0SGVscGVyLCIpIHsgIixpLCIgPSAiLHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCh0LCJjYWxsIixlKSwifSJdKX0sYXBwZW5kQ29udGVudDpmdW5jdGlvbih0KXt0aGlzLnBlbmRpbmdDb250ZW50P3Q9dGhpcy5wZW5kaW5nQ29udGVudCt0OnRoaXMucGVuZGluZ0xvY2F0aW9uPXRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbix0aGlzLnBlbmRpbmdDb250ZW50PXR9LGFwcGVuZDpmdW5jdGlvbigpe2lmKHRoaXMuaXNJbmxpbmUoKSl0aGlzLnJlcGxhY2VTdGFjayhmdW5jdGlvbih0KXtyZXR1cm5bIiAhPSBudWxsID8gIix0LCcgOiAiIiddfSksdGhpcy5wdXNoU291cmNlKHRoaXMuYXBwZW5kVG9CdWZmZXIodGhpcy5wb3BTdGFjaygpKSk7ZWxzZXt2YXIgdD10aGlzLnBvcFN0YWNrKCk7dGhpcy5wdXNoU291cmNlKFsiaWYgKCIsdCwiICE9IG51bGwpIHsgIix0aGlzLmFwcGVuZFRvQnVmZmVyKHQsdm9pZCAwLCEwKSwiIH0iXSksdGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSYmdGhpcy5wdXNoU291cmNlKFsiZWxzZSB7ICIsdGhpcy5hcHBlbmRUb0J1ZmZlcigiJyciLHZvaWQgMCwhMCksIiB9Il0pfX0sYXBwZW5kRXNjYXBlZDpmdW5jdGlvbigpe3RoaXMucHVzaFNvdXJjZSh0aGlzLmFwcGVuZFRvQnVmZmVyKFt0aGlzLmFsaWFzYWJsZSgiY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24iKSwiKCIsdGhpcy5wb3BTdGFjaygpLCIpIl0pKX0sZ2V0Q29udGV4dDpmdW5jdGlvbih0KXt0aGlzLmxhc3RDb250ZXh0PXR9LHB1c2hDb250ZXh0OmZ1bmN0aW9uKCl7dGhpcy5wdXNoU3RhY2tMaXRlcmFsKHRoaXMuY29udGV4dE5hbWUodGhpcy5sYXN0Q29udGV4dCkpfSxsb29rdXBPbkNvbnRleHQ6ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9MDtufHwhdGhpcy5vcHRpb25zLmNvbXBhdHx8dGhpcy5sYXN0Q29udGV4dD90aGlzLnB1c2hDb250ZXh0KCk6dGhpcy5wdXNoKHRoaXMuZGVwdGhlZExvb2t1cCh0W3IrK10pKSx0aGlzLnJlc29sdmVQYXRoKCJjb250ZXh0Iix0LHIsZSxpKX0sbG9va3VwQmxvY2tQYXJhbTpmdW5jdGlvbih0LGUpe3RoaXMudXNlQmxvY2tQYXJhbXM9ITAsdGhpcy5wdXNoKFsiYmxvY2tQYXJhbXNbIix0WzBdLCJdWyIsdFsxXSwiXSJdKSx0aGlzLnJlc29sdmVQYXRoKCJjb250ZXh0IixlLDEpfSxsb29rdXBEYXRhOmZ1bmN0aW9uKHQsZSxpKXt0P3RoaXMucHVzaFN0YWNrTGl0ZXJhbCgiY29udGFpbmVyLmRhdGEoZGF0YSwgIit0KyIpIik6dGhpcy5wdXNoU3RhY2tMaXRlcmFsKCJkYXRhIiksdGhpcy5yZXNvbHZlUGF0aCgiZGF0YSIsZSwwLCEwLGkpfSxyZXNvbHZlUGF0aDpmdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBvPXRoaXM7aWYodGhpcy5vcHRpb25zLnN0cmljdHx8dGhpcy5vcHRpb25zLmFzc3VtZU9iamVjdHMpcmV0dXJuIHZvaWQgdGhpcy5wdXNoKHModGhpcy5vcHRpb25zLnN0cmljdCYmcix0aGlzLGUsdCkpO2Zvcih2YXIgYT1lLmxlbmd0aDtpPGE7aSsrKXRoaXMucmVwbGFjZVN0YWNrKGZ1bmN0aW9uKHIpe3ZhciBzPW8ubmFtZUxvb2t1cChyLGVbaV0sdCk7cmV0dXJuIG4/WyIgJiYgIixzXTpbIiAhPSBudWxsID8gIixzLCIgOiAiLHJdfSl9LHJlc29sdmVQb3NzaWJsZUxhbWJkYTpmdW5jdGlvbigpe3RoaXMucHVzaChbdGhpcy5hbGlhc2FibGUoImNvbnRhaW5lci5sYW1iZGEiKSwiKCIsdGhpcy5wb3BTdGFjaygpLCIsICIsdGhpcy5jb250ZXh0TmFtZSgwKSwiKSJdKX0scHVzaFN0cmluZ1BhcmFtOmZ1bmN0aW9uKHQsZSl7dGhpcy5wdXNoQ29udGV4dCgpLHRoaXMucHVzaFN0cmluZyhlKSwiU3ViRXhwcmVzc2lvbiIhPT1lJiYoInN0cmluZyI9PXR5cGVvZiB0P3RoaXMucHVzaFN0cmluZyh0KTp0aGlzLnB1c2hTdGFja0xpdGVyYWwodCkpfSxlbXB0eUhhc2g6ZnVuY3Rpb24odCl7dGhpcy50cmFja0lkcyYmdGhpcy5wdXNoKCJ7fSIpLHRoaXMuc3RyaW5nUGFyYW1zJiYodGhpcy5wdXNoKCJ7fSIpLHRoaXMucHVzaCgie30iKSksdGhpcy5wdXNoU3RhY2tMaXRlcmFsKHQ/InVuZGVmaW5lZCI6Int9Iil9LHB1c2hIYXNoOmZ1bmN0aW9uKCl7dGhpcy5oYXNoJiZ0aGlzLmhhc2hlcy5wdXNoKHRoaXMuaGFzaCksdGhpcy5oYXNoPXt2YWx1ZXM6W10sdHlwZXM6W10sY29udGV4dHM6W10saWRzOltdfX0scG9wSGFzaDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuaGFzaDt0aGlzLmhhc2g9dGhpcy5oYXNoZXMucG9wKCksdGhpcy50cmFja0lkcyYmdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbCh0LmlkcykpLHRoaXMuc3RyaW5nUGFyYW1zJiYodGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbCh0LmNvbnRleHRzKSksdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbCh0LnR5cGVzKSkpLHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwodC52YWx1ZXMpKX0scHVzaFN0cmluZzpmdW5jdGlvbih0KXt0aGlzLnB1c2hTdGFja0xpdGVyYWwodGhpcy5xdW90ZWRTdHJpbmcodCkpfSxwdXNoTGl0ZXJhbDpmdW5jdGlvbih0KXt0aGlzLnB1c2hTdGFja0xpdGVyYWwodCl9LHB1c2hQcm9ncmFtOmZ1bmN0aW9uKHQpe251bGwhPXQ/dGhpcy5wdXNoU3RhY2tMaXRlcmFsKHRoaXMucHJvZ3JhbUV4cHJlc3Npb24odCkpOnRoaXMucHVzaFN0YWNrTGl0ZXJhbChudWxsKX0scmVnaXN0ZXJEZWNvcmF0b3I6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLm5hbWVMb29rdXAoImRlY29yYXRvcnMiLGUsImRlY29yYXRvciIpLG49dGhpcy5zZXR1cEhlbHBlckFyZ3MoZSx0KTt0aGlzLmRlY29yYXRvcnMucHVzaChbImZuID0gIix0aGlzLmRlY29yYXRvcnMuZnVuY3Rpb25DYWxsKGksIiIsWyJmbiIsInByb3BzIiwiY29udGFpbmVyIixuXSksIiB8fCBmbjsiXSl9LGludm9rZUhlbHBlcjpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy5wb3BTdGFjaygpLHI9dGhpcy5zZXR1cEhlbHBlcih0LGUpLHM9aT9bci5uYW1lLCIgfHwgIl06IiIsbz1bIigiXS5jb25jYXQocyxuKTt0aGlzLm9wdGlvbnMuc3RyaWN0fHxvLnB1c2goIiB8fCAiLHRoaXMuYWxpYXNhYmxlKCJoZWxwZXJzLmhlbHBlck1pc3NpbmciKSksby5wdXNoKCIpIiksdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChvLCJjYWxsIixyLmNhbGxQYXJhbXMpKX0saW52b2tlS25vd25IZWxwZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnNldHVwSGVscGVyKHQsZSk7dGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChpLm5hbWUsImNhbGwiLGkuY2FsbFBhcmFtcykpfSxpbnZva2VBbWJpZ3VvdXM6ZnVuY3Rpb24odCxlKXt0aGlzLnVzZVJlZ2lzdGVyKCJoZWxwZXIiKTt2YXIgaT10aGlzLnBvcFN0YWNrKCk7dGhpcy5lbXB0eUhhc2goKTt2YXIgbj10aGlzLnNldHVwSGVscGVyKDAsdCxlKSxyPXRoaXMubGFzdEhlbHBlcj10aGlzLm5hbWVMb29rdXAoImhlbHBlcnMiLHQsImhlbHBlciIpLHM9WyIoIiwiKGhlbHBlciA9ICIsciwiIHx8ICIsaSwiKSJdO3RoaXMub3B0aW9ucy5zdHJpY3R8fChzWzBdPSIoaGVscGVyID0gIixzLnB1c2goIiAhPSBudWxsID8gaGVscGVyIDogIix0aGlzLmFsaWFzYWJsZSgiaGVscGVycy5oZWxwZXJNaXNzaW5nIikpKSx0aGlzLnB1c2goWyIoIixzLG4ucGFyYW1zSW5pdD9bIiksKCIsbi5wYXJhbXNJbml0XTpbXSwiKSwiLCIodHlwZW9mIGhlbHBlciA9PT0gIix0aGlzLmFsaWFzYWJsZSgnImZ1bmN0aW9uIicpLCIgPyAiLHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCgiaGVscGVyIiwiY2FsbCIsbi5jYWxsUGFyYW1zKSwiIDogaGVscGVyKSkiXSl9LGludm9rZVBhcnRpYWw6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPVtdLHI9dGhpcy5zZXR1cFBhcmFtcyhlLDEsbik7dCYmKGU9dGhpcy5wb3BTdGFjaygpLGRlbGV0ZSByLm5hbWUpLGkmJihyLmluZGVudD1KU09OLnN0cmluZ2lmeShpKSksci5oZWxwZXJzPSJoZWxwZXJzIixyLnBhcnRpYWxzPSJwYXJ0aWFscyIsci5kZWNvcmF0b3JzPSJjb250YWluZXIuZGVjb3JhdG9ycyIsdD9uLnVuc2hpZnQoZSk6bi51bnNoaWZ0KHRoaXMubmFtZUxvb2t1cCgicGFydGlhbHMiLGUsInBhcnRpYWwiKSksdGhpcy5vcHRpb25zLmNvbXBhdCYmKHIuZGVwdGhzPSJkZXB0aHMiKSxyPXRoaXMub2JqZWN0TGl0ZXJhbChyKSxuLnB1c2gociksdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCgiY29udGFpbmVyLmludm9rZVBhcnRpYWwiLCIiLG4pKX0sYXNzaWduVG9IYXNoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMucG9wU3RhY2soKSxpPXZvaWQgMCxuPXZvaWQgMCxyPXZvaWQgMDt0aGlzLnRyYWNrSWRzJiYocj10aGlzLnBvcFN0YWNrKCkpLAoJdGhpcy5zdHJpbmdQYXJhbXMmJihuPXRoaXMucG9wU3RhY2soKSxpPXRoaXMucG9wU3RhY2soKSk7dmFyIHM9dGhpcy5oYXNoO2kmJihzLmNvbnRleHRzW3RdPWkpLG4mJihzLnR5cGVzW3RdPW4pLHImJihzLmlkc1t0XT1yKSxzLnZhbHVlc1t0XT1lfSxwdXNoSWQ6ZnVuY3Rpb24odCxlLGkpeyJCbG9ja1BhcmFtIj09PXQ/dGhpcy5wdXNoU3RhY2tMaXRlcmFsKCJibG9ja1BhcmFtc1siK2VbMF0rIl0ucGF0aFsiK2VbMV0rIl0iKyhpPyIgKyAiK0pTT04uc3RyaW5naWZ5KCIuIitpKToiIikpOiJQYXRoRXhwcmVzc2lvbiI9PT10P3RoaXMucHVzaFN0cmluZyhlKToiU3ViRXhwcmVzc2lvbiI9PT10P3RoaXMucHVzaFN0YWNrTGl0ZXJhbCgidHJ1ZSIpOnRoaXMucHVzaFN0YWNrTGl0ZXJhbCgibnVsbCIpfSxjb21waWxlcjpyLGNvbXBpbGVDaGlsZHJlbjpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10LmNoaWxkcmVuLG49dm9pZCAwLHI9dm9pZCAwLHM9MCxvPWkubGVuZ3RoO3M8bztzKyspe249aVtzXSxyPW5ldyB0aGlzLmNvbXBpbGVyO3ZhciBhPXRoaXMubWF0Y2hFeGlzdGluZ1Byb2dyYW0obik7bnVsbD09YT8odGhpcy5jb250ZXh0LnByb2dyYW1zLnB1c2goIiIpLGE9dGhpcy5jb250ZXh0LnByb2dyYW1zLmxlbmd0aCxuLmluZGV4PWEsbi5uYW1lPSJwcm9ncmFtIithLHRoaXMuY29udGV4dC5wcm9ncmFtc1thXT1yLmNvbXBpbGUobixlLHRoaXMuY29udGV4dCwhdGhpcy5wcmVjb21waWxlKSx0aGlzLmNvbnRleHQuZGVjb3JhdG9yc1thXT1yLmRlY29yYXRvcnMsdGhpcy5jb250ZXh0LmVudmlyb25tZW50c1thXT1uLHRoaXMudXNlRGVwdGhzPXRoaXMudXNlRGVwdGhzfHxyLnVzZURlcHRocyx0aGlzLnVzZUJsb2NrUGFyYW1zPXRoaXMudXNlQmxvY2tQYXJhbXN8fHIudXNlQmxvY2tQYXJhbXMpOihuLmluZGV4PWEsbi5uYW1lPSJwcm9ncmFtIithLHRoaXMudXNlRGVwdGhzPXRoaXMudXNlRGVwdGhzfHxuLnVzZURlcHRocyx0aGlzLnVzZUJsb2NrUGFyYW1zPXRoaXMudXNlQmxvY2tQYXJhbXN8fG4udXNlQmxvY2tQYXJhbXMpfX0sbWF0Y2hFeGlzdGluZ1Byb2dyYW06ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzLmxlbmd0aDtlPGk7ZSsrKXt2YXIgbj10aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzW2VdO2lmKG4mJm4uZXF1YWxzKHQpKXJldHVybiBlfX0scHJvZ3JhbUV4cHJlc3Npb246ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbnZpcm9ubWVudC5jaGlsZHJlblt0XSxpPVtlLmluZGV4LCJkYXRhIixlLmJsb2NrUGFyYW1zXTtyZXR1cm4odGhpcy51c2VCbG9ja1BhcmFtc3x8dGhpcy51c2VEZXB0aHMpJiZpLnB1c2goImJsb2NrUGFyYW1zIiksdGhpcy51c2VEZXB0aHMmJmkucHVzaCgiZGVwdGhzIiksImNvbnRhaW5lci5wcm9ncmFtKCIraS5qb2luKCIsICIpKyIpIn0sdXNlUmVnaXN0ZXI6ZnVuY3Rpb24odCl7dGhpcy5yZWdpc3RlcnNbdF18fCh0aGlzLnJlZ2lzdGVyc1t0XT0hMCx0aGlzLnJlZ2lzdGVycy5saXN0LnB1c2godCkpfSxwdXNoOmZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2Ygbnx8KHQ9dGhpcy5zb3VyY2Uud3JhcCh0KSksdGhpcy5pbmxpbmVTdGFjay5wdXNoKHQpLHR9LHB1c2hTdGFja0xpdGVyYWw6ZnVuY3Rpb24odCl7dGhpcy5wdXNoKG5ldyBuKHQpKX0scHVzaFNvdXJjZTpmdW5jdGlvbih0KXt0aGlzLnBlbmRpbmdDb250ZW50JiYodGhpcy5zb3VyY2UucHVzaCh0aGlzLmFwcGVuZFRvQnVmZmVyKHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyh0aGlzLnBlbmRpbmdDb250ZW50KSx0aGlzLnBlbmRpbmdMb2NhdGlvbikpLHRoaXMucGVuZGluZ0NvbnRlbnQ9dm9pZCAwKSx0JiZ0aGlzLnNvdXJjZS5wdXNoKHQpfSxyZXBsYWNlU3RhY2s6ZnVuY3Rpb24odCl7dmFyIGU9WyIoIl0saT12b2lkIDAscj12b2lkIDAscz12b2lkIDA7aWYoIXRoaXMuaXNJbmxpbmUoKSl0aHJvdyBuZXcgY1siZGVmYXVsdCJdKCJyZXBsYWNlU3RhY2sgb24gbm9uLWlubGluZSIpO3ZhciBvPXRoaXMucG9wU3RhY2soITApO2lmKG8gaW5zdGFuY2VvZiBuKWk9W28udmFsdWVdLGU9WyIoIixpXSxzPSEwO2Vsc2V7cj0hMDt2YXIgYT10aGlzLmluY3JTdGFjaygpO2U9WyIoKCIsdGhpcy5wdXNoKGEpLCIgPSAiLG8sIikiXSxpPXRoaXMudG9wU3RhY2soKX12YXIgbD10LmNhbGwodGhpcyxpKTtzfHx0aGlzLnBvcFN0YWNrKCksciYmdGhpcy5zdGFja1Nsb3QtLSx0aGlzLnB1c2goZS5jb25jYXQobCwiKSIpKX0saW5jclN0YWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhY2tTbG90KyssdGhpcy5zdGFja1Nsb3Q+dGhpcy5zdGFja1ZhcnMubGVuZ3RoJiZ0aGlzLnN0YWNrVmFycy5wdXNoKCJzdGFjayIrdGhpcy5zdGFja1Nsb3QpLHRoaXMudG9wU3RhY2tOYW1lKCl9LHRvcFN0YWNrTmFtZTpmdW5jdGlvbigpe3JldHVybiJzdGFjayIrdGhpcy5zdGFja1Nsb3R9LGZsdXNoSW5saW5lOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5pbmxpbmVTdGFjazt0aGlzLmlubGluZVN0YWNrPVtdO2Zvcih2YXIgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl7dmFyIHI9dFtlXTtpZihyIGluc3RhbmNlb2Ygbil0aGlzLmNvbXBpbGVTdGFjay5wdXNoKHIpO2Vsc2V7dmFyIHM9dGhpcy5pbmNyU3RhY2soKTt0aGlzLnB1c2hTb3VyY2UoW3MsIiA9ICIsciwiOyJdKSx0aGlzLmNvbXBpbGVTdGFjay5wdXNoKHMpfX19LGlzSW5saW5lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5saW5lU3RhY2subGVuZ3RofSxwb3BTdGFjazpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmlzSW5saW5lKCksaT0oZT90aGlzLmlubGluZVN0YWNrOnRoaXMuY29tcGlsZVN0YWNrKS5wb3AoKTtpZighdCYmaSBpbnN0YW5jZW9mIG4pcmV0dXJuIGkudmFsdWU7aWYoIWUpe2lmKCF0aGlzLnN0YWNrU2xvdCl0aHJvdyBuZXcgY1siZGVmYXVsdCJdKCJJbnZhbGlkIHN0YWNrIHBvcCIpO3RoaXMuc3RhY2tTbG90LS19cmV0dXJuIGl9LHRvcFN0YWNrOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5pc0lubGluZSgpP3RoaXMuaW5saW5lU3RhY2s6dGhpcy5jb21waWxlU3RhY2ssZT10W3QubGVuZ3RoLTFdO3JldHVybiBlIGluc3RhbmNlb2Ygbj9lLnZhbHVlOmV9LGNvbnRleHROYW1lOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnVzZURlcHRocyYmdD8iZGVwdGhzWyIrdCsiXSI6ImRlcHRoIit0fSxxdW90ZWRTdHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyh0KX0sb2JqZWN0TGl0ZXJhbDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zb3VyY2Uub2JqZWN0TGl0ZXJhbCh0KX0sYWxpYXNhYmxlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuYWxpYXNlc1t0XTtyZXR1cm4gZT8oZS5yZWZlcmVuY2VDb3VudCsrLGUpOihlPXRoaXMuYWxpYXNlc1t0XT10aGlzLnNvdXJjZS53cmFwKHQpLGUuYWxpYXNhYmxlPSEwLGUucmVmZXJlbmNlQ291bnQ9MSxlKX0sc2V0dXBIZWxwZXI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPVtdLHI9dGhpcy5zZXR1cEhlbHBlckFyZ3MoZSx0LG4saSkscz10aGlzLm5hbWVMb29rdXAoImhlbHBlcnMiLGUsImhlbHBlciIpLG89dGhpcy5hbGlhc2FibGUodGhpcy5jb250ZXh0TmFtZSgwKSsiICE9IG51bGwgPyAiK3RoaXMuY29udGV4dE5hbWUoMCkrIiA6IHt9Iik7cmV0dXJue3BhcmFtczpuLHBhcmFtc0luaXQ6cixuYW1lOnMsY2FsbFBhcmFtczpbb10uY29uY2F0KG4pfX0sc2V0dXBQYXJhbXM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXt9LHI9W10scz1bXSxvPVtdLGE9IWksbD12b2lkIDA7YSYmKGk9W10pLG4ubmFtZT10aGlzLnF1b3RlZFN0cmluZyh0KSxuLmhhc2g9dGhpcy5wb3BTdGFjaygpLHRoaXMudHJhY2tJZHMmJihuLmhhc2hJZHM9dGhpcy5wb3BTdGFjaygpKSx0aGlzLnN0cmluZ1BhcmFtcyYmKG4uaGFzaFR5cGVzPXRoaXMucG9wU3RhY2soKSxuLmhhc2hDb250ZXh0cz10aGlzLnBvcFN0YWNrKCkpO3ZhciBjPXRoaXMucG9wU3RhY2soKSx1PXRoaXMucG9wU3RhY2soKTsodXx8YykmJihuLmZuPXV8fCJjb250YWluZXIubm9vcCIsbi5pbnZlcnNlPWN8fCJjb250YWluZXIubm9vcCIpO2Zvcih2YXIgZD1lO2QtLTspbD10aGlzLnBvcFN0YWNrKCksaVtkXT1sLHRoaXMudHJhY2tJZHMmJihvW2RdPXRoaXMucG9wU3RhY2soKSksdGhpcy5zdHJpbmdQYXJhbXMmJihzW2RdPXRoaXMucG9wU3RhY2soKSxyW2RdPXRoaXMucG9wU3RhY2soKSk7cmV0dXJuIGEmJihuLmFyZ3M9dGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShpKSksdGhpcy50cmFja0lkcyYmKG4uaWRzPXRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkobykpLHRoaXMuc3RyaW5nUGFyYW1zJiYobi50eXBlcz10aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KHMpLG4uY29udGV4dHM9dGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShyKSksdGhpcy5vcHRpb25zLmRhdGEmJihuLmRhdGE9ImRhdGEiKSx0aGlzLnVzZUJsb2NrUGFyYW1zJiYobi5ibG9ja1BhcmFtcz0iYmxvY2tQYXJhbXMiKSxufSxzZXR1cEhlbHBlckFyZ3M6ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dGhpcy5zZXR1cFBhcmFtcyh0LGUsaSk7cmV0dXJuIHI9dGhpcy5vYmplY3RMaXRlcmFsKHIpLG4/KHRoaXMudXNlUmVnaXN0ZXIoIm9wdGlvbnMiKSxpLnB1c2goIm9wdGlvbnMiKSxbIm9wdGlvbnM9IixyXSk6aT8oaS5wdXNoKHIpLCIiKTpyfX0sZnVuY3Rpb24oKXtmb3IodmFyIHQ9ImJyZWFrIGVsc2UgbmV3IHZhciBjYXNlIGZpbmFsbHkgcmV0dXJuIHZvaWQgY2F0Y2ggZm9yIHN3aXRjaCB3aGlsZSBjb250aW51ZSBmdW5jdGlvbiB0aGlzIHdpdGggZGVmYXVsdCBpZiB0aHJvdyBkZWxldGUgaW4gdHJ5IGRvIGluc3RhbmNlb2YgdHlwZW9mIGFic3RyYWN0IGVudW0gaW50IHNob3J0IGJvb2xlYW4gZXhwb3J0IGludGVyZmFjZSBzdGF0aWMgYnl0ZSBleHRlbmRzIGxvbmcgc3VwZXIgY2hhciBmaW5hbCBuYXRpdmUgc3luY2hyb25pemVkIGNsYXNzIGZsb2F0IHBhY2thZ2UgdGhyb3dzIGNvbnN0IGdvdG8gcHJpdmF0ZSB0cmFuc2llbnQgZGVidWdnZXIgaW1wbGVtZW50cyBwcm90ZWN0ZWQgdm9sYXRpbGUgZG91YmxlIGltcG9ydCBwdWJsaWMgbGV0IHlpZWxkIGF3YWl0IG51bGwgdHJ1ZSBmYWxzZSIuc3BsaXQoIiAiKSxlPXIuUkVTRVJWRURfV09SRFM9e30saT0wLG49dC5sZW5ndGg7aTxuO2krKyllW3RbaV1dPSEwfSgpLHIuaXNWYWxpZEphdmFTY3JpcHRWYXJpYWJsZU5hbWU9ZnVuY3Rpb24odCl7cmV0dXJuIXIuUkVTRVJWRURfV09SRFNbdF0mJi9eW2EtekEtWl8kXVswLTlhLXpBLVpfJF0qJC8udGVzdCh0KX0sZVsiZGVmYXVsdCJdPXIsdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQsZSxpKXtpZihzLmlzQXJyYXkodCkpe2Zvcih2YXIgbj1bXSxyPTAsbz10Lmxlbmd0aDtyPG87cisrKW4ucHVzaChlLndyYXAodFtyXSxpKSk7cmV0dXJuIG59cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgdHx8Im51bWJlciI9PXR5cGVvZiB0P3QrIiI6dH1mdW5jdGlvbiByKHQpe3RoaXMuc3JjRmlsZT10LHRoaXMuc291cmNlPVtdfWUuX19lc01vZHVsZT0hMDt2YXIgcz1pKDUpLG89dm9pZCAwO3RyeXt9Y2F0Y2goYSl7fW98fChvPWZ1bmN0aW9uKHQsZSxpLG4pe3RoaXMuc3JjPSIiLG4mJnRoaXMuYWRkKG4pfSxvLnByb3RvdHlwZT17YWRkOmZ1bmN0aW9uKHQpe3MuaXNBcnJheSh0KSYmKHQ9dC5qb2luKCIiKSksdGhpcy5zcmMrPXR9LHByZXBlbmQ6ZnVuY3Rpb24odCl7cy5pc0FycmF5KHQpJiYodD10LmpvaW4oIiIpKSx0aGlzLnNyYz10K3RoaXMuc3JjfSx0b1N0cmluZ1dpdGhTb3VyY2VNYXA6ZnVuY3Rpb24oKXtyZXR1cm57Y29kZTp0aGlzLnRvU3RyaW5nKCl9fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNyY319KSxyLnByb3RvdHlwZT17aXNFbXB0eTpmdW5jdGlvbigpe3JldHVybiF0aGlzLnNvdXJjZS5sZW5ndGh9LHByZXBlbmQ6ZnVuY3Rpb24odCxlKXt0aGlzLnNvdXJjZS51bnNoaWZ0KHRoaXMud3JhcCh0LGUpKX0scHVzaDpmdW5jdGlvbih0LGUpe3RoaXMuc291cmNlLnB1c2godGhpcy53cmFwKHQsZSkpfSxtZXJnZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZW1wdHkoKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGUpe3QuYWRkKFsiICAiLGUsIlxuIl0pfSksdH0sZWFjaDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPXRoaXMuc291cmNlLmxlbmd0aDtlPGk7ZSsrKXQodGhpcy5zb3VyY2VbZV0pfSxlbXB0eTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY3VycmVudExvY2F0aW9ufHx7c3RhcnQ6e319O3JldHVybiBuZXcgbyh0LnN0YXJ0LmxpbmUsdC5zdGFydC5jb2x1bW4sdGhpcy5zcmNGaWxlKX0sd3JhcDpmdW5jdGlvbih0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPD0xfHx2b2lkIDA9PT1hcmd1bWVudHNbMV0/dGhpcy5jdXJyZW50TG9jYXRpb258fHtzdGFydDp7fX06YXJndW1lbnRzWzFdO3JldHVybiB0IGluc3RhbmNlb2Ygbz90Oih0PW4odCx0aGlzLGUpLG5ldyBvKGUuc3RhcnQubGluZSxlLnN0YXJ0LmNvbHVtbix0aGlzLnNyY0ZpbGUsdCkpfSxmdW5jdGlvbkNhbGw6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpPXRoaXMuZ2VuZXJhdGVMaXN0KGkpLHRoaXMud3JhcChbdCxlPyIuIitlKyIoIjoiKCIsaSwiKSJdKX0scXVvdGVkU3RyaW5nOmZ1bmN0aW9uKHQpe3JldHVybiciJysodCsiIikucmVwbGFjZSgvXFwvZywiXFxcXCIpLnJlcGxhY2UoLyIvZywnXFwiJykucmVwbGFjZSgvXG4vZywiXFxuIikucmVwbGFjZSgvXHIvZywiXFxyIikucmVwbGFjZSgvXHUyMDI4L2csIlxcdTIwMjgiKS5yZXBsYWNlKC9cdTIwMjkvZywiXFx1MjAyOSIpKyciJ30sb2JqZWN0TGl0ZXJhbDpmdW5jdGlvbih0KXt2YXIgZT1bXTtmb3IodmFyIGkgaW4gdClpZih0Lmhhc093blByb3BlcnR5KGkpKXt2YXIgcj1uKHRbaV0sdGhpcyk7InVuZGVmaW5lZCIhPT1yJiZlLnB1c2goW3RoaXMucXVvdGVkU3RyaW5nKGkpLCI6IixyXSl9dmFyIHM9dGhpcy5nZW5lcmF0ZUxpc3QoZSk7cmV0dXJuIHMucHJlcGVuZCgieyIpLHMuYWRkKCJ9Iiksc30sZ2VuZXJhdGVMaXN0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLmVtcHR5KCksaT0wLHI9dC5sZW5ndGg7aTxyO2krKylpJiZlLmFkZCgiLCIpLGUuYWRkKG4odFtpXSx0aGlzKSk7cmV0dXJuIGV9LGdlbmVyYXRlQXJyYXk6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZW5lcmF0ZUxpc3QodCk7cmV0dXJuIGUucHJlcGVuZCgiWyIpLGUuYWRkKCJdIiksZX19LGVbImRlZmF1bHQiXT1yLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19XSl9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg2KSxpKDcpXSxyPWZ1bmN0aW9uKHQpe3JldHVybiB0KGZ1bmN0aW9uKCl7dC5hamF4U2V0dXAoe2hlYWRlcnM6eyJYLU9rdGEtWHNyZlRva2VuIjp0KCIjX3hzcmZUb2tlbiIpLnRleHQoKX0sY29udmVydGVyczp7InRleHQgc2VjdXJlSlNPTiI6ZnVuY3Rpb24odCl7cmV0dXJuIndoaWxlKDEpe307Ij09PXQuc3Vic3RyaW5nKDAsMTEpJiYodD10LnN1YnN0cmluZygxMSkpLEpTT04ucGFyc2UodCl9fX0pfSksd2luZG93LmpRdWVyeUNvdXJhZ2U9dCx0fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPV9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9ffSxmdW5jdGlvbihtb2R1bGUsZXhwb3J0cyl7Im9iamVjdCIhPXR5cGVvZiBKU09OJiYoSlNPTj17fSksZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZih0KXtyZXR1cm4gdDwxMD8iMCIrdDp0fWZ1bmN0aW9uIHF1b3RlKHQpe3JldHVybiBlc2NhcGFibGUubGFzdEluZGV4PTAsZXNjYXBhYmxlLnRlc3QodCk/JyInK3QucmVwbGFjZShlc2NhcGFibGUsZnVuY3Rpb24odCl7dmFyIGU9bWV0YVt0XTtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGU/ZToiXFx1IisoIjAwMDAiK3QuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KX0pKyciJzonIicrdCsnIid9ZnVuY3Rpb24gc3RyKHQsZSl7dmFyIGksbixyLHMsbyxhPWdhcCxsPWVbdF07c3dpdGNoKGwmJiJvYmplY3QiPT10eXBlb2YgbCYmImZ1bmN0aW9uIj09dHlwZW9mIGwudG9KU09OJiYobD1sLnRvSlNPTih0KSksImZ1bmN0aW9uIj09dHlwZW9mIHJlcCYmKGw9cmVwLmNhbGwoZSx0LGwpKSx0eXBlb2YgbCl7Y2FzZSJzdHJpbmciOnJldHVybiBxdW90ZShsKTtjYXNlIm51bWJlciI6cmV0dXJuIGlzRmluaXRlKGwpP1N0cmluZyhsKToibnVsbCI7Y2FzZSJib29sZWFuIjpjYXNlIm51bGwiOnJldHVybiBTdHJpbmcobCk7Y2FzZSJvYmplY3QiOmlmKCFsKXJldHVybiJudWxsIjtpZihnYXArPWluZGVudCxvPVtdLCJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KGwpKXtmb3Iocz1sLmxlbmd0aCxpPTA7aTxzO2krPTEpb1tpXT1zdHIoaSxsKXx8Im51bGwiO3JldHVybiByPTA9PT1vLmxlbmd0aD8iW10iOmdhcD8iW1xuIitnYXArby5qb2luKCIsXG4iK2dhcCkrIlxuIithKyJdIjoiWyIrby5qb2luKCIsIikrIl0iLGdhcD1hLHJ9aWYocmVwJiYib2JqZWN0Ij09dHlwZW9mIHJlcClmb3Iocz1yZXAubGVuZ3RoLGk9MDtpPHM7aSs9MSkic3RyaW5nIj09dHlwZW9mIHJlcFtpXSYmKG49cmVwW2ldLHI9c3RyKG4sbCksciYmby5wdXNoKHF1b3RlKG4pKyhnYXA/IjogIjoiOiIpK3IpKTtlbHNlIGZvcihuIGluIGwpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGwsbikmJihyPXN0cihuLGwpLHImJm8ucHVzaChxdW90ZShuKSsoZ2FwPyI6ICI6IjoiKStyKSk7cmV0dXJuIHI9MD09PW8ubGVuZ3RoPyJ7fSI6Z2FwPyJ7XG4iK2dhcCtvLmpvaW4oIixcbiIrZ2FwKSsiXG4iK2ErIn0iOiJ7IitvLmpvaW4oIiwiKSsifSIsZ2FwPWEscn19ImZ1bmN0aW9uIiE9dHlwZW9mIERhdGUucHJvdG90eXBlLnRvSlNPTiYmKERhdGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbih0KXtyZXR1cm4gaXNGaW5pdGUodGhpcy52YWx1ZU9mKCkpP3RoaXMuZ2V0VVRDRnVsbFllYXIoKSsiLSIrZih0aGlzLmdldFVUQ01vbnRoKCkrMSkrIi0iK2YodGhpcy5nZXRVVENEYXRlKCkpKyJUIitmKHRoaXMuZ2V0VVRDSG91cnMoKSkrIjoiK2YodGhpcy5nZXRVVENNaW51dGVzKCkpKyI6IitmKHRoaXMuZ2V0VVRDU2Vjb25kcygpKSsiWiI6bnVsbH0sU3RyaW5nLnByb3RvdHlwZS50b0pTT049TnVtYmVyLnByb3RvdHlwZS50b0pTT049Qm9vbGVhbi5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnZhbHVlT2YoKX0pO3ZhciBjeD0vW1x1MDAwMFx1MDBhZFx1MDYwMC1cdTA2MDRcdTA3MGZcdTE3YjRcdTE3YjVcdTIwMGMtXHUyMDBmXHUyMDI4LVx1MjAyZlx1MjA2MC1cdTIwNmZcdWZlZmZcdWZmZjAtXHVmZmZmXS9nLGVzY2FwYWJsZT0vW1xcXCJceDAwLVx4MWZceDdmLVx4OWZcdTAwYWRcdTA2MDAtXHUwNjA0XHUwNzBmXHUxN2I0XHUxN2I1XHUyMDBjLVx1MjAwZlx1MjAyOC1cdTIwMmZcdTIwNjAtXHUyMDZmXHVmZWZmXHVmZmYwLVx1ZmZmZl0vZyxnYXAsaW5kZW50LG1ldGE9eyJcYiI6IlxcYiIsIlx0IjoiXFx0IiwiXG4iOiJcXG4iLCJcZiI6IlxcZiIsIlxyIjoiXFxyIiwnIic6J1xcIicsIlxcIjoiXFxcXCJ9LHJlcDsiZnVuY3Rpb24iIT10eXBlb2YgSlNPTi5zdHJpbmdpZnkmJihKU09OLnN0cmluZ2lmeT1mdW5jdGlvbih0LGUsaSl7dmFyIG47aWYoZ2FwPSIiLGluZGVudD0iIiwibnVtYmVyIj09dHlwZW9mIGkpZm9yKG49MDtuPGk7bis9MSlpbmRlbnQrPSIgIjtlbHNlInN0cmluZyI9PXR5cGVvZiBpJiYoaW5kZW50PWkpO2lmKHJlcD1lLGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlJiYoIm9iamVjdCIhPXR5cGVvZiBlfHwibnVtYmVyIiE9dHlwZW9mIGUubGVuZ3RoKSl0aHJvdyBuZXcgRXJyb3IoIkpTT04uc3RyaW5naWZ5Iik7cmV0dXJuIHN0cigiIix7IiI6dH0pfSksImZ1bmN0aW9uIiE9dHlwZW9mIEpTT04ucGFyc2UmJihKU09OLnBhcnNlPWZ1bmN0aW9uKHRleHQscmV2aXZlcil7ZnVuY3Rpb24gd2Fsayh0LGUpe3ZhciBpLG4scj10W2VdO2lmKHImJiJvYmplY3QiPT10eXBlb2Ygcilmb3IoaSBpbiByKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyLGkpJiYobj13YWxrKHIsaSksdm9pZCAwIT09bj9yW2ldPW46ZGVsZXRlIHJbaV0pO3JldHVybiByZXZpdmVyLmNhbGwodCxlLHIpfXZhciBqO2lmKHRleHQ9U3RyaW5nKHRleHQpLGN4Lmxhc3RJbmRleD0wLGN4LnRlc3QodGV4dCkmJih0ZXh0PXRleHQucmVwbGFjZShjeCxmdW5jdGlvbih0KXtyZXR1cm4iXFx1IisoIjAwMDAiK3QuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KX0pKSwvXltcXSw6e31cc10qJC8udGVzdCh0ZXh0LnJlcGxhY2UoL1xcKD86WyJcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZywiQCIpLnJlcGxhY2UoLyJbXiJcXFxuXHJdKiJ8dHJ1ZXxmYWxzZXxudWxsfC0/XGQrKD86XC5cZCopPyg/OltlRV1bK1wtXT9cZCspPy9nLCJdIikucmVwbGFjZSgvKD86Xnw6fCwpKD86XHMqXFspKy9nLCIiKSkpcmV0dXJuIGo9ZXZhbCgiKCIrdGV4dCsiKSIpLCJmdW5jdGlvbiI9PXR5cGVvZiByZXZpdmVyP3dhbGsoeyIiOmp9LCIiKTpqO3Rocm93IG5ldyBTeW50YXhFcnJvcigiSlNPTi5wYXJzZSIpfSl9KCl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pKDkpO3QuZXhwb3J0cz1pKDEwKShuKX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlLGkpe3ZhciBuPXIuRGVmZXJyZWQoKTtyZXR1cm4gci5hamF4KHt0eXBlOnQsdXJsOmUsaGVhZGVyczppLmhlYWRlcnMsZGF0YTpKU09OLnN0cmluZ2lmeShpLmRhdGEpLHhockZpZWxkczp7d2l0aENyZWRlbnRpYWxzOiEwfX0pLnRoZW4oZnVuY3Rpb24odCxlLGkpe2RlbGV0ZSBpLnRoZW4sbi5yZXNvbHZlKGkpfSxmdW5jdGlvbih0KXtkZWxldGUgdC50aGVuLG4ucmVqZWN0KHQpfSksbn12YXIgcj1pKDYpO3QuZXhwb3J0cz1ufSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0KXt2YXIgZT10aGlzO2lmKCF0KXRocm93IG5ldyBjKCJObyBhcmd1bWVudHMgcGFzc2VkIHRvIGNvbnN0cnVjdG9yLiBSZXF1aXJlZCB1c2FnZTogbmV3IE9rdGFBdXRoKGFyZ3MpIik7aWYoIXQudXJsKXRocm93IG5ldyBjKCdObyB1cmwgcGFzc2VkIHRvIGNvbnN0cnVjdG9yLiBSZXF1aXJlZCB1c2FnZTogbmV3IE9rdGFBdXRoKHt1cmw6ICJodHRwczovL3NhbXBsZS5va3RhLmNvbSJ9KScpO3RoaXMub3B0aW9ucz17dXJsOnIucmVtb3ZlVHJhaWxpbmdTbGFzaCh0LnVybCksY2xpZW50SWQ6dC5jbGllbnRJZCxpc3N1ZXI6ci5yZW1vdmVUcmFpbGluZ1NsYXNoKHQuaXNzdWVyKSxhdXRob3JpemVVcmw6ci5yZW1vdmVUcmFpbGluZ1NsYXNoKHQuYXV0aG9yaXplVXJsKSx1c2VyaW5mb1VybDpyLnJlbW92ZVRyYWlsaW5nU2xhc2godC51c2VyaW5mb1VybCkscmVkaXJlY3RVcmk6dC5yZWRpcmVjdFVyaSxhamF4UmVxdWVzdDp0LmFqYXhSZXF1ZXN0LHRyYW5zZm9ybUVycm9yWEhSOnQudHJhbnNmb3JtRXJyb3JYSFIsaGVhZGVyczp0LmhlYWRlcnN9LHQubWF4Q2xvY2tTa2V3fHwwPT09dC5tYXhDbG9ja1NrZXc/dGhpcy5vcHRpb25zLm1heENsb2NrU2tldz10Lm1heENsb2NrU2tldzp0aGlzLm9wdGlvbnMubWF4Q2xvY2tTa2V3PXUuREVGQVVMVF9NQVhfQ0xPQ0tfU0tFVyxlLnNlc3Npb249e2Nsb3NlOnIuYmluZChvLmNsb3NlU2Vzc2lvbixudWxsLGUpLGV4aXN0czpyLmJpbmQoby5zZXNzaW9uRXhpc3RzLG51bGwsZSksZ2V0OnIuYmluZChvLmdldFNlc3Npb24sbnVsbCxlKSxyZWZyZXNoOnIuYmluZChvLnJlZnJlc2hTZXNzaW9uLG51bGwsZSksc2V0Q29va2llQW5kUmVkaXJlY3Q6ci5iaW5kKG8uc2V0Q29va2llQW5kUmVkaXJlY3QsbnVsbCxlKX0sZS50eD17c3RhdHVzOnIuYmluZChzLnRyYW5zYWN0aW9uU3RhdHVzLG51bGwsZSkscmVzdW1lOnIuYmluZChzLnJlc3VtZVRyYW5zYWN0aW9uLG51bGwsZSksZXhpc3RzOnIuYmluZChzLnRyYW5zYWN0aW9uRXhpc3RzLG51bGwsZSl9LGUudHguZXhpc3RzLl9nZXRDb29raWU9ZnVuY3Rpb24odCl7cmV0dXJuIGEuZ2V0Q29va2llKHQpfSxlLmlkVG9rZW49e2F1dGhvcml6ZTpyLmRlcHJlY2F0ZVdyYXAoIlVzZSB0b2tlbi5nZXRXaXRob3V0UHJvbXB0LCB0b2tlbi5nZXRXaXRoUG9wdXAsIG9yIHRva2VuLmdldFdpdGhSZWRpcmVjdCBpbnN0ZWFkIG9mIGlkVG9rZW4uYXV0aG9yaXplLiIsci5iaW5kKGwuZ2V0VG9rZW4sbnVsbCxlKSksdmVyaWZ5OnIuZGVwcmVjYXRlV3JhcCgiVXNlIHRva2VuLnZlcmlmeSBpbnN0ZWFkIG9mIGlkVG9rZW4udmVyaWZ5IixyLmJpbmQobC52ZXJpZnlJZFRva2VuLG51bGwsZSkpLHJlZnJlc2g6ci5kZXByZWNhdGVXcmFwKCJVc2UgdG9rZW4ucmVmcmVzaCBpbnN0ZWFkIG9mIGlkVG9rZW4ucmVmcmVzaCIsci5iaW5kKGwucmVmcmVzaElkVG9rZW4sbnVsbCxlKSksZGVjb2RlOnIuZGVwcmVjYXRlV3JhcCgiVXNlIHRva2VuLmRlY29kZSBpbnN0ZWFkIG9mIGlkVG9rZW4uZGVjb2RlIixsLmRlY29kZVRva2VuKX0sZS5pZFRva2VuLmF1dGhvcml6ZS5fZ2V0TG9jYXRpb25IcmVmPWZ1bmN0aW9uKCl7cmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmfSxlLnRva2VuPXtnZXRXaXRob3V0UHJvbXB0OnIuYmluZChsLmdldFdpdGhvdXRQcm9tcHQsbnVsbCxlKSxnZXRXaXRoUG9wdXA6ci5iaW5kKGwuZ2V0V2l0aFBvcHVwLG51bGwsZSksZ2V0V2l0aFJlZGlyZWN0OnIuYmluZChsLmdldFdpdGhSZWRpcmVjdCxudWxsLGUpLHBhcnNlRnJvbVVybDpyLmJpbmQobC5wYXJzZUZyb21VcmwsbnVsbCxlKSxkZWNvZGU6bC5kZWNvZGVUb2tlbixyZWZyZXNoOnIuYmluZChsLnJlZnJlc2hUb2tlbixudWxsLGUpLGdldFVzZXJJbmZvOnIuYmluZChsLmdldFVzZXJJbmZvLG51bGwsZSksdmVyaWZ5OnIuYmluZChsLnZlcmlmeVRva2VuLG51bGwsZSl9LGUudG9rZW4uZ2V0V2l0aFJlZGlyZWN0Ll9zZXRMb2NhdGlvbj1mdW5jdGlvbih0KXt3aW5kb3cubG9jYXRpb249dH0sZS50b2tlbi5wYXJzZUZyb21VcmwuX2dldExvY2F0aW9uSGFzaD1mdW5jdGlvbih0KXtyZXR1cm4gd2luZG93LmxvY2F0aW9uLmhhc2h9LGUudG9rZW5NYW5hZ2VyPW5ldyBkKGUsdC50b2tlbk1hbmFnZXIpfWkoMTEpO3ZhciByPWkoMTMpLHM9aSgxNCksbz1pKDI0KSxhPWkoMTYpLGw9aSgyNSksYz1pKDE5KSx1PWkoMjApLGQ9aSgyOSksaD1uLnByb3RvdHlwZTtoLmZlYXR1cmVzPXt9LGguZmVhdHVyZXMuaXNQb3B1cFBvc3RNZXNzYWdlU3VwcG9ydGVkPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuZG9jdW1lbnRNb2RlJiZkb2N1bWVudC5kb2N1bWVudE1vZGU8MTA7cmV0dXJuISghd2luZG93LnBvc3RNZXNzYWdlfHx0KX0saC5mZWF0dXJlcy5pc1Rva2VuVmVyaWZ5U3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBjcnlwdG8mJmNyeXB0by5zdWJ0bGUmJiJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheX0saC5zaWduSW49ZnVuY3Rpb24odCl7cmV0dXJuIHMucG9zdFRvVHJhbnNhY3Rpb24odGhpcywiL2FwaS92MS9hdXRobiIsdCl9LGguc2lnbk91dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlc3Npb24uY2xvc2UoKX0saC5mb3Jnb3RQYXNzd29yZD1mdW5jdGlvbih0KXtyZXR1cm4gcy5wb3N0VG9UcmFuc2FjdGlvbih0aGlzLCIvYXBpL3YxL2F1dGhuL3JlY292ZXJ5L3Bhc3N3b3JkIix0KX0saC51bmxvY2tBY2NvdW50PWZ1bmN0aW9uKHQpe3JldHVybiBzLnBvc3RUb1RyYW5zYWN0aW9uKHRoaXMsIi9hcGkvdjEvYXV0aG4vcmVjb3ZlcnkvdW5sb2NrIix0KX0saC52ZXJpZnlSZWNvdmVyeVRva2VuPWZ1bmN0aW9uKHQpe3JldHVybiBzLnBvc3RUb1RyYW5zYWN0aW9uKHRoaXMsIi9hcGkvdjEvYXV0aG4vcmVjb3ZlcnkvdG9rZW4iLHQpfSx0LmV4cG9ydHM9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShpKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIGU/KGkmJiFpLmFqYXhSZXF1ZXN0JiYoaS5hamF4UmVxdWVzdD10KSx2b2lkIHIuYmluZChuLHRoaXMpKGkpKTpuZXcgZShpKX1yZXR1cm4gZS5wcm90b3R5cGU9bi5wcm90b3R5cGUsZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlfX0sZnVuY3Rpb24odCxlLGkpe2koMTIpLEFycmF5LnByb3RvdHlwZS5pbmRleE9mfHwoQXJyYXkucHJvdG90eXBlLmluZGV4T2Y9ZnVuY3Rpb24odCxlKXt2YXIgaTtpZihudWxsPT10aGlzKXRocm93IG5ldyBUeXBlRXJyb3IoJyJ0aGlzIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7dmFyIG49T2JqZWN0KHRoaXMpLHI9bi5sZW5ndGg+Pj4wO2lmKDA9PT1yKXJldHVybi0xO3ZhciBzPStlfHwwO2lmKE1hdGguYWJzKHMpPT09MS8wJiYocz0wKSxzPj1yKXJldHVybi0xO2ZvcihpPU1hdGgubWF4KHM+PTA/czpyLU1hdGguYWJzKHMpLDApO2k8cjspe2lmKGkgaW4gbiYmbltpXT09PXQpcmV0dXJuIGk7aSsrfXJldHVybi0xfSksQXJyYXkuaXNBcnJheXx8KEFycmF5LmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLm1lc3NhZ2U9dH12YXIgaT1lLG49IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89Ijt0LnByb3RvdHlwZT1uZXcgRXJyb3IsdC5wcm90b3R5cGUubmFtZT0iSW52YWxpZENoYXJhY3RlckVycm9yIixpLmJ0b2F8fChpLmJ0b2E9ZnVuY3Rpb24oZSl7Zm9yKHZhciBpLHIscz1TdHJpbmcoZSksbz0wLGE9bixsPSIiO3MuY2hhckF0KDB8byl8fChhPSI9IixvJTEpO2wrPWEuY2hhckF0KDYzJmk+PjgtbyUxKjgpKXtpZihyPXMuY2hhckNvZGVBdChvKz0uNzUpLHI+MjU1KXRocm93IG5ldyB0KCInYnRvYScgZmFpbGVkOiBUaGUgc3RyaW5nIHRvIGJlIGVuY29kZWQgY29udGFpbnMgY2hhcmFjdGVycyBvdXRzaWRlIG9mIHRoZSBMYXRpbjEgcmFuZ2UuIik7aT1pPDw4fHJ9cmV0dXJuIGx9KSxpLmF0b2J8fChpLmF0b2I9ZnVuY3Rpb24oZSl7dmFyIGk9U3RyaW5nKGUpLnJlcGxhY2UoLz0rJC8sIiIpO2lmKGkubGVuZ3RoJTQ9PTEpdGhyb3cgbmV3IHQoIidhdG9iJyBmYWlsZWQ6IFRoZSBzdHJpbmcgdG8gYmUgZGVjb2RlZCBpcyBub3QgY29ycmVjdGx5IGVuY29kZWQuIik7Zm9yKHZhciByLHMsbz0wLGE9MCxsPSIiO3M9aS5jaGFyQXQoYSsrKTt+cyYmKHI9byU0PzY0KnIrczpzLG8rKyU0KT9sKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDI1NSZyPj4oLTIqbyY2KSk6MClzPW4uaW5kZXhPZihzKTtyZXR1cm4gbH0pfSgpfSxmdW5jdGlvbih0LGUpe3ZhciBpPXQuZXhwb3J0cztpLmJhc2U2NFVybFRvQmFzZTY0PWZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1wtL2csIisiKS5yZXBsYWNlKC9fL2csIi8iKX0saS5iYXNlNjRVcmxUb1N0cmluZz1mdW5jdGlvbih0KXt2YXIgZT1pLmJhc2U2NFVybFRvQmFzZTY0KHQpO3N3aXRjaChlLmxlbmd0aCU0KXtjYXNlIDA6YnJlYWs7Y2FzZSAyOmUrPSI9PSI7YnJlYWs7Y2FzZSAzOmUrPSI9IjticmVhaztkZWZhdWx0OnRocm93Ik5vdCBhIHZhbGlkIEJhc2U2NFVybCJ9dmFyIG49YXRvYihlKTt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUobikpfWNhdGNoKHIpe3JldHVybiBufX0saS5zdHJpbmdUb0J1ZmZlcj1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpLGk9MDtpPHQubGVuZ3RoO2krKyllW2ldPXQuY2hhckNvZGVBdChpKTtyZXR1cm4gZX0saS5iYXNlNjRVcmxEZWNvZGU9ZnVuY3Rpb24odCl7cmV0dXJuIGF0b2IoaS5iYXNlNjRVcmxUb0Jhc2U2NCh0KSl9LGkuYmluZD1mdW5jdGlvbih0LGUpe3ZhciBpPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgbj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO3JldHVybiBuPWkuY29uY2F0KG4pLHQuYXBwbHkoZSxuKX19LGkuaXNBYnNvbHV0ZVVybD1mdW5jdGlvbih0KXtyZXR1cm4vXig/OlthLXpdKzopP1wvXC8vaS50ZXN0KHQpfSxpLmlzU3RyaW5nPWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IFN0cmluZ10iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpLmlzT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE9iamVjdF0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpLmlzTnVtYmVyPWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE51bWJlcl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpLmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0saS5pc29Ub1VUQ1N0cmluZz1mdW5jdGlvbih0KXt2YXIgZT10Lm1hdGNoKC9cZCsvZyksaT1EYXRlLlVUQyhlWzBdLGVbMV0tMSxlWzJdLGVbM10sZVs0XSxlWzVdKSxuPW5ldyBEYXRlKGkpO3JldHVybiBuLnRvVVRDU3RyaW5nKCl9LGkudG9RdWVyeVBhcmFtcz1mdW5jdGlvbih0KXt2YXIgZT1bXTtpZihudWxsIT09dClmb3IodmFyIGkgaW4gdCl0Lmhhc093blByb3BlcnR5KGkpJiZ2b2lkIDAhPT10W2ldJiZudWxsIT09dFtpXSYmZS5wdXNoKGkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh0W2ldKSk7cmV0dXJuIGUubGVuZ3RoPyI/IitlLmpvaW4oIiYiKToiIn0saS5nZW5SYW5kb21TdHJpbmc9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPSJhYmNkZWZnaGlqa2xub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IixpPSIiLG49MCxyPWUubGVuZ3RoO248dDsrK24paSs9ZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqcildO3JldHVybiBpfSxpLmV4dGVuZD1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaSBpbiBlKWUuaGFzT3duUHJvcGVydHkoaSkmJih0W2ldPWVbaV0pfSxpLnJlbW92ZU5pbHM9ZnVuY3Rpb24odCl7dmFyIGU9e307Zm9yKHZhciBpIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShpKSl7dmFyIG49dFtpXTtudWxsIT09biYmdm9pZCAwIT09biYmKGVbaV09bil9cmV0dXJuIGV9LGkuY2xvbmU9ZnVuY3Rpb24odCl7aWYodCl7dmFyIGU9SlNPTi5zdHJpbmdpZnkodCk7aWYoZSlyZXR1cm4gSlNPTi5wYXJzZShlKX1yZXR1cm4gdH0saS5vbWl0PWZ1bmN0aW9uKHQpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxuPXt9O2Zvcih2YXIgciBpbiB0KXQuaGFzT3duUHJvcGVydHkocikmJmUuaW5kZXhPZihyKT09LTEmJihuW3JdPXRbcl0pO3JldHVybiBpLmNsb25lKG4pfSxpLmZpbmQ9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dC5sZW5ndGg7aS0tOyl7dmFyIG49dFtpXSxyPSEwO2Zvcih2YXIgcyBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkocykmJm5bc10hPT1lW3NdKXtyPSExO2JyZWFrfWlmKHIpcmV0dXJuIG59fSxpLmdldExpbms9ZnVuY3Rpb24odCxlLG4pe2lmKHQmJnQuX2xpbmtzKXt2YXIgcj1pLmNsb25lKHQuX2xpbmtzW2VdKTtyZXR1cm4gciYmci5uYW1lJiZuP3IubmFtZT09PW4/cjp2b2lkIDA6cn19LGkuZ2V0TmF0aXZlQ29uc29sZT1mdW5jdGlvbigpe3JldHVybiB3aW5kb3cuY29uc29sZX0saS5nZXRDb25zb2xlPWZ1bmN0aW9uKCl7dmFyIHQ9aS5nZXROYXRpdmVDb25zb2xlKCk7cmV0dXJuIHQmJnQubG9nP3Q6e2xvZzpmdW5jdGlvbigpe319fSxpLndhcm49ZnVuY3Rpb24odCl7aS5nZXRDb25zb2xlKCkubG9nKCJbb2t0YS1hdXRoLXNka10gV0FSTjogIit0KX0saS5kZXByZWNhdGU9ZnVuY3Rpb24odCl7aS5nZXRDb25zb2xlKCkubG9nKCJbb2t0YS1hdXRoLXNka10gREVQUkVDQVRJT046ICIrdCl9LGkuZGVwcmVjYXRlV3JhcD1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBpLmRlcHJlY2F0ZSh0KSxlLmFwcGx5KG51bGwsYXJndW1lbnRzKX19LGkucmVtb3ZlVHJhaWxpbmdTbGFzaD1mdW5jdGlvbih0KXtpZih0KXJldHVybiIvIj09PXQuc2xpY2UoLTEpP3Quc2xpY2UoMCwtMSk6dH19LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSl7dmFyIGk9bS5jbG9uZShlKXx8e307cmV0dXJuIWkuc3RhdGVUb2tlbiYmdC5zdGF0ZVRva2VuJiYoaS5zdGF0ZVRva2VuPXQuc3RhdGVUb2tlbiksaX1mdW5jdGlvbiByKHQpe3JldHVybiBuKHQpfWZ1bmN0aW9uIHModCxlKXtyZXR1cm4gZT1uKHQsZSksZi5wb3N0KHQsdC5vcHRpb25zLnVybCsiL2FwaS92MS9hdXRobiIsZSl9ZnVuY3Rpb24gbyh0LGUpe2lmKCFlfHwhZS5zdGF0ZVRva2VuKXt2YXIgaT10LnR4LmV4aXN0cy5fZ2V0Q29va2llKHkuU1RBVEVfVE9LRU5fQ09PS0lFX05BTUUpO2lmKCFpKXJldHVybiBfLnJlamVjdChuZXcgZygiTm8gdHJhbnNhY3Rpb24gdG8gcmVzdW1lIikpO2U9e3N0YXRlVG9rZW46aX19cmV0dXJuIHQudHguc3RhdHVzKGUpLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBwKHQsZSl9KX1mdW5jdGlvbiBhKHQpe3JldHVybiEhdC50eC5leGlzdHMuX2dldENvb2tpZSh5LlNUQVRFX1RPS0VOX0NPT0tJRV9OQU1FKX1mdW5jdGlvbiBsKHQsZSxpKXtyZXR1cm4gZi5wb3N0KHQsZSxpKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBuZXcgcCh0LGUpfSl9ZnVuY3Rpb24gYyh0LGUsaSl7cmV0dXJuIGZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHMoKXt2YXIgaT1sLmhyZWY7cmV0dXJuIGEmJihpKz0iP3JlbWVtYmVyRGV2aWNlPXRydWUiKSxmLnBvc3QodCxpLHIoZSkse3NhdmVBdXRoblN0YXRlOiExfSl9dmFyIG8sYTttLmlzTnVtYmVyKG4pP289bjptLmlzT2JqZWN0KG4pJiYobz1uLmRlbGF5LGE9bi5yZW1lbWJlckRldmljZSksb3x8MD09PW98fChvPXkuREVGQVVMVF9QT0xMSU5HX0RFTEFZKTt2YXIgbD1tLmdldExpbmsoZSwibmV4dCIsInBvbGwiKTtpLmlzUG9sbGluZz0hMDt2YXIgYz0wLHU9ZnVuY3Rpb24oKXtyZXR1cm4gaS5pc1BvbGxpbmc/cygpLnRoZW4oZnVuY3Rpb24oZSl7aWYoYz0wLGUuZmFjdG9yUmVzdWx0JiYiV0FJVElORyI9PT1lLmZhY3RvclJlc3VsdCl7aWYoIWkuaXNQb2xsaW5nKXRocm93IG5ldyB2O3JldHVybiBfLmRlbGF5KG8pLnRoZW4odSl9cmV0dXJuIGkuaXNQb2xsaW5nPSExLG5ldyBwKHQsZSl9KS5mYWlsKGZ1bmN0aW9uKHQpe2lmKHQueGhyJiYoMD09PXQueGhyLnN0YXR1c3x8NDI5PT09dC54aHIuc3RhdHVzKSYmYzw9NCl7dmFyIGU9MWUzKk1hdGgucG93KDIsYyk7cmV0dXJuIGMrKyxfLmRlbGF5KGUpLnRoZW4odSl9dGhyb3cgdH0pOl8ucmVqZWN0KG5ldyB2KX07cmV0dXJuIHUoKS5mYWlsKGZ1bmN0aW9uKHQpe3Rocm93IGkuaXNQb2xsaW5nPSExLHR9KX19ZnVuY3Rpb24gdSh0LGUsaSxyLHMpe2lmKEFycmF5LmlzQXJyYXkocikpcmV0dXJuIGZ1bmN0aW9uKG4sbyl7aWYoIW4pdGhyb3cgbmV3IGcoIk11c3QgcHJvdmlkZSBhIGxpbmsgbmFtZSIpO3ZhciBhPW0uZmluZChyLHtuYW1lOm59KTtpZighYSl0aHJvdyBuZXcgZygiTm8gbGluayBmb3VuZCBmb3IgdGhhdCBuYW1lIik7cmV0dXJuIHUodCxlLGksYSxzKShvKX07aWYoci5oaW50cyYmci5oaW50cy5hbGxvdyYmMT09PXIuaGludHMuYWxsb3cubGVuZ3RoKXt2YXIgbz1yLmhpbnRzLmFsbG93WzBdO3N3aXRjaChvKXtjYXNlIkdFVCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGYuZ2V0KHQsci5ocmVmKX07Y2FzZSJQT1NUIjpyZXR1cm4gZnVuY3Rpb24obyl7cyYmcy5pc1BvbGxpbmcmJihzLmlzUG9sbGluZz0hMSk7dmFyIGE9bihlLG8pOyJNRkFfRU5ST0xMIj09PWUuc3RhdHVzJiZtLmV4dGVuZChhLHtmYWN0b3JUeXBlOmkuZmFjdG9yVHlwZSxwcm92aWRlcjppLnByb3ZpZGVyfSk7dmFyIGM9ci5ocmVmO3JldHVybiB2b2lkIDAhPT1hLnJlbWVtYmVyRGV2aWNlPyhhLnJlbWVtYmVyRGV2aWNlJiYoYys9Ij9yZW1lbWJlckRldmljZT10cnVlIiksYT1tLm9taXQoYSwicmVtZW1iZXJEZXZpY2UiKSk6YS5wcm9maWxlJiZ2b2lkIDAhPT1hLnByb2ZpbGUudXBkYXRlUGhvbmUmJihhLnByb2ZpbGUudXBkYXRlUGhvbmUmJihjKz0iP3VwZGF0ZVBob25lPXRydWUiKSxhLnByb2ZpbGU9bS5vbWl0KGEucHJvZmlsZSwidXBkYXRlUGhvbmUiKSksbCh0LGMsYSl9fX19ZnVuY3Rpb24gZCh0LGUsaSxuKXt2YXIgcj17fTtmb3IodmFyIHMgaW4gaS5fbGlua3MpaWYoaS5fbGlua3MuaGFzT3duUHJvcGVydHkocykpe3ZhciBvPWkuX2xpbmtzW3NdO2lmKCJuZXh0Ij09PXMmJihzPW8ubmFtZSksby50eXBlKXJbc109bztlbHNlIHN3aXRjaChzKXtjYXNlInBvbGwiOnIucG9sbD1jKHQsZSxuKTticmVhaztkZWZhdWx0OnZhciBhPXUodCxlLGksbyxuKTthJiYocltzXT1hKX19cmV0dXJuIHJ9ZnVuY3Rpb24gaCh0LGUsaSxuKXtpZihpPWl8fGUsaT1tLmNsb25lKGkpLEFycmF5LmlzQXJyYXkoaSkpe2Zvcih2YXIgcj1bXSxzPTAsbz1pLmxlbmd0aDtzPG87cysrKXIucHVzaChoKHQsZSxpW3NdLG4pKTtyZXR1cm4gcn12YXIgYT1pLl9lbWJlZGRlZHx8e307Zm9yKHZhciBsIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShsKSYmKG0uaXNPYmplY3QoYVtsXSl8fEFycmF5LmlzQXJyYXkoYVtsXSkpJiYoYVtsXT1oKHQsZSxhW2xdLG4pKTt2YXIgYz1kKHQsZSxpLG4pO3JldHVybiBtLmV4dGVuZChhLGMpLGk9bS5vbWl0KGksIl9lbWJlZGRlZCIsIl9saW5rcyIpLG0uZXh0ZW5kKGksYSksaX1mdW5jdGlvbiBwKHQsZSl7ZSYmKHRoaXMuZGF0YT1lLG0uZXh0ZW5kKHRoaXMsaCh0LGUsZSx7fSkpLGRlbGV0ZSB0aGlzLnN0YXRlVG9rZW4sIlJFQ09WRVJZX0NIQUxMRU5HRSIhPT1lLnN0YXR1c3x8ZS5fbGlua3N8fCh0aGlzLmNhbmNlbD1mdW5jdGlvbigpe3JldHVybiBuZXcgXyhuZXcgcCh0KSl9KSl9dmFyIGY9aSgxNSksbT1pKDEzKSxfPWkoMjEpLGc9aSgxOSksdj1pKDIzKSx5PWkoMjApO3QuZXhwb3J0cz17dHJhbnNhY3Rpb25TdGF0dXM6cyxyZXN1bWVUcmFuc2FjdGlvbjpvLHRyYW5zYWN0aW9uRXhpc3RzOmEscG9zdFRvVHJhbnNhY3Rpb246bH19LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSl7ZT1lfHx7fTt2YXIgaT1lLnVybCxuPWUubWV0aG9kLHI9ZS5hcmdzLHM9ZS5zYXZlQXV0aG5TdGF0ZSxoPWUuYWNjZXNzVG9rZW4scD1sLmdldEh0dHBDYWNoZSgpO2lmKGUuY2FjaGVSZXNwb25zZSl7dmFyIGY9cC5nZXRTdG9yYWdlKCksbT1mW2ldO2lmKG0mJkRhdGUubm93KCkvMWUzPG0uZXhwaXJlc0F0KXJldHVybiBjLnJlc29sdmUobS5yZXNwb25zZSl9dmFyIF89e0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiIsIkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL2pzb24iLCJYLU9rdGEtVXNlci1BZ2VudC1FeHRlbmRlZCI6Im9rdGEtYXV0aC1qcy0iK2QuU0RLX1ZFUlNJT059O28uZXh0ZW5kKF8sdC5vcHRpb25zLmhlYWRlcnN8fHt9KSxoJiZvLmlzU3RyaW5nKGgpJiYoXy5BdXRob3JpemF0aW9uPSJCZWFyZXIgIitoKTt2YXIgZyx2LHk9e2hlYWRlcnM6XyxkYXRhOnJ8fHZvaWQgMH07cmV0dXJuIG5ldyBjKHQub3B0aW9ucy5hamF4UmVxdWVzdChuLGkseSkpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHY9dC5yZXNwb25zZVRleHQsdiYmby5pc1N0cmluZyh2KSYmKHY9SlNPTi5wYXJzZSh2KSkscyYmKHYuc3RhdGVUb2tlbnx8YS5kZWxldGVDb29raWUoZC5TVEFURV9UT0tFTl9DT09LSUVfTkFNRSkpLHYmJnYuc3RhdGVUb2tlbiYmdi5leHBpcmVzQXQmJmEuc2V0Q29va2llKGQuU1RBVEVfVE9LRU5fQ09PS0lFX05BTUUsdi5zdGF0ZVRva2VuLHYuZXhwaXJlc0F0KSx2JiZlLmNhY2hlUmVzcG9uc2UmJnAudXBkYXRlU3RvcmFnZShpLHtleHBpcmVzQXQ6TWF0aC5mbG9vcihEYXRlLm5vdygpLzFlMykrZC5ERUZBVUxUX0NBQ0hFX0RVUkFUSU9OLHJlc3BvbnNlOnZ9KSx2fSkuZmFpbChmdW5jdGlvbihlKXt2YXIgaT1lLnJlc3BvbnNlVGV4dHx8e307aWYoby5pc1N0cmluZyhpKSl0cnl7aT1KU09OLnBhcnNlKGkpfWNhdGNoKG4pe2k9e2Vycm9yU3VtbWFyeToiVW5rbm93biBlcnJvciJ9fXRocm93IGUuc3RhdHVzPj01MDAmJihpLmVycm9yU3VtbWFyeT0iVW5rbm93biBlcnJvciIpLHQub3B0aW9ucy50cmFuc2Zvcm1FcnJvclhIUiYmKGU9dC5vcHRpb25zLnRyYW5zZm9ybUVycm9yWEhSKG8uY2xvbmUoZSkpKSxnPW5ldyB1KGksZSksIkUwMDAwMDExIj09PWcuZXJyb3JDb2RlJiZhLmRlbGV0ZUNvb2tpZShkLlNUQVRFX1RPS0VOX0NPT0tJRV9OQU1FKSxnfSl9ZnVuY3Rpb24gcih0LGUsaSl7ZT1vLmlzQWJzb2x1dGVVcmwoZSk/ZTp0Lm9wdGlvbnMudXJsK2U7dmFyIHI9e3VybDplLG1ldGhvZDoiR0VUIn07cmV0dXJuIG8uZXh0ZW5kKHIsaSksbih0LHIpfWZ1bmN0aW9uIHModCxlLGkscil7ZT1vLmlzQWJzb2x1dGVVcmwoZSk/ZTp0Lm9wdGlvbnMudXJsK2U7dmFyIHM9e3VybDplLG1ldGhvZDoiUE9TVCIsYXJnczppLHNhdmVBdXRoblN0YXRlOiEwfTtyZXR1cm4gby5leHRlbmQocyxyKSxuKHQscyl9dmFyIG89aSgxMyksYT1pKDE2KSxsPWkoMTcpLGM9aSgyMSksdT1pKDIyKSxkPWkoMjApO3QuZXhwb3J0cz17Z2V0OnIscG9zdDpzLGh0dHBSZXF1ZXN0Om59fSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0LGUsaSl7dmFyIHI9IiI7aSYmKHI9IiBleHBpcmVzPSIrby5pc29Ub1VUQ1N0cmluZyhpKSsiOyIpO3ZhciBzPXQrIj0iK2UrIjsgcGF0aD0vOyIrcjtyZXR1cm4gbi5fc2V0RG9jdW1lbnRDb29raWUocyksc31mdW5jdGlvbiByKHQpe3ZhciBlPW5ldyBSZWdFeHAodCsiPShbXjtdKikiKSxpPXIuX2dldERvY3VtZW50Q29va2llKCkubWF0Y2goZSk7aWYoaSl7dmFyIG49aVsxXTtyZXR1cm4gbn19ZnVuY3Rpb24gcyh0KXtuKHQsIiIsIjE5NzAtMDEtMDFUMDA6MDA6MDBaIil9dmFyIG89aSgxMyk7bi5fc2V0RG9jdW1lbnRDb29raWU9ZnVuY3Rpb24odCl7ZG9jdW1lbnQuY29va2llPXR9LHIuX2dldERvY3VtZW50Q29va2llPWZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LmNvb2tpZX0sdC5leHBvcnRzPXtzZXRDb29raWU6bixnZXRDb29raWU6cixkZWxldGVDb29raWU6c319LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pKDE2KSxyPWkoMTgpLHM9aSgyMCksbz17fTtvLmJyb3dzZXJIYXNMb2NhbFN0b3JhZ2U9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuISFvLmdldExvY2FsU3RvcmFnZSgpfWNhdGNoKHQpe3JldHVybiExfX0sby5icm93c2VySGFzU2Vzc2lvblN0b3JhZ2U9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuISFvLmdldFNlc3Npb25TdG9yYWdlKCl9Y2F0Y2godCl7cmV0dXJuITF9fSxvLmdldEh0dHBDYWNoZT1mdW5jdGlvbigpe3JldHVybiBvLmJyb3dzZXJIYXNMb2NhbFN0b3JhZ2UoKT9yKG8uZ2V0TG9jYWxTdG9yYWdlKCkscy5DQUNIRV9TVE9SQUdFX05BTUUpOm8uYnJvd3Nlckhhc1Nlc3Npb25TdG9yYWdlKCk/cihvLmdldFNlc3Npb25TdG9yYWdlKCkscy5DQUNIRV9TVE9SQUdFX05BTUUpOnIoby5nZXRDb29raWVTdG9yYWdlKCkscy5DQUNIRV9TVE9SQUdFX05BTUUpfSxvLmdldExvY2FsU3RvcmFnZT1mdW5jdGlvbigpe3JldHVybiBsb2NhbFN0b3JhZ2V9LG8uZ2V0U2Vzc2lvblN0b3JhZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gc2Vzc2lvblN0b3JhZ2V9LG8uZ2V0Q29va2llU3RvcmFnZT1mdW5jdGlvbigpe3JldHVybntnZXRJdGVtOm4uZ2V0Q29va2llLHNldEl0ZW06ZnVuY3Rpb24odCxlKXtuLnNldENvb2tpZSh0LGUsIjIwMzgtMDEtMTlUMDM6MTQ6MDcuMDAwWiIpfX19LHQuZXhwb3J0cz1vfSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0LGUpe2Z1bmN0aW9uIGkoKXt2YXIgaT10LmdldEl0ZW0oZSk7aT1pfHwie30iO3RyeXtyZXR1cm4gSlNPTi5wYXJzZShpKX1jYXRjaChuKXt0aHJvdyBuZXcgcigiVW5hYmxlIHRvIHBhcnNlIHN0b3JhZ2Ugc3RyaW5nOiAiK2UpfX1mdW5jdGlvbiBuKGkpe3RyeXt2YXIgbj1KU09OLnN0cmluZ2lmeShpKTt0LnNldEl0ZW0oZSxuKX1jYXRjaChzKXt0aHJvdyBuZXcgcigiVW5hYmxlIHRvIHNldCBzdG9yYWdlOiAiK2UpfX1mdW5jdGlvbiBzKHQpe3R8fG4oe30pO3ZhciBlPWkoKTtkZWxldGUgZVt0XSxuKGUpfWZ1bmN0aW9uIG8odCxlKXt2YXIgcj1pKCk7clt0XT1lLG4ocil9cmV0dXJue2dldFN0b3JhZ2U6aSxzZXRTdG9yYWdlOm4sY2xlYXJTdG9yYWdlOnMsdXBkYXRlU3RvcmFnZTpvfX12YXIgcj1pKDE5KTt0LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7dGhpcy5uYW1lPSJBdXRoU2RrRXJyb3IiLHRoaXMubWVzc2FnZT10LHRoaXMuZXJyb3JDb2RlPSJJTlRFUk5BTCIsdGhpcy5lcnJvclN1bW1hcnk9dCx0aGlzLmVycm9yTGluaz0iSU5URVJOQUwiLHRoaXMuZXJyb3JJZD0iSU5URVJOQUwiLHRoaXMuZXJyb3JDYXVzZXM9W10sZSYmKHRoaXMueGhyPWUpfWkucHJvdG90eXBlPW5ldyBFcnJvcix0LmV4cG9ydHM9aX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9e1NUQVRFX1RPS0VOX0NPT0tJRV9OQU1FOiJva3RhU3RhdGVUb2tlbiIsREVGQVVMVF9QT0xMSU5HX0RFTEFZOjUwMCxERUZBVUxUX01BWF9DTE9DS19TS0VXOjMwMCxERUZBVUxUX0NBQ0hFX0RVUkFUSU9OOjg2NDAwLEZSQU1FX0lEOiJva3RhLW9hdXRoLWhlbHBlci1mcmFtZSIsUkVESVJFQ1RfT0FVVEhfUEFSQU1TX0NPT0tJRV9OQU1FOiJva3RhLW9hdXRoLXJlZGlyZWN0LXBhcmFtcyIsUkVESVJFQ1RfU1RBVEVfQ09PS0lFX05BTUU6Im9rdGEtb2F1dGgtc3RhdGUiLFJFRElSRUNUX05PTkNFX0NPT0tJRV9OQU1FOiJva3RhLW9hdXRoLW5vbmNlIixUT0tFTl9TVE9SQUdFX05BTUU6Im9rdGEtdG9rZW4tc3RvcmFnZSIsQ0FDSEVfU1RPUkFHRV9OQU1FOiJva3RhLWNhY2hlLXN0b3JhZ2UiLFNES19WRVJTSU9OOiIxLjguMCJ9fSxmdW5jdGlvbih0LGUsaSl7LyohCgkJICoKCQkgKiBDb3B5cmlnaHQgMjAwOS0yMDEyIEtyaXMgS293YWwgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNSVQKCQkgKiBsaWNlbnNlIGZvdW5kIGF0IGh0dHA6Ly9naXRodWIuY29tL2tyaXNrb3dhbC9xL3Jhdy9tYXN0ZXIvTElDRU5TRQoJCSAqCgkJICogV2l0aCBwYXJ0cyBieSBUeWxlciBDbG9zZQoJCSAqIENvcHlyaWdodCAyMDA3LTIwMDkgVHlsZXIgQ2xvc2UgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNSVQgWCBsaWNlbnNlIGZvdW5kCgkJICogYXQgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5odG1sCgkJICogRm9ya2VkIGF0IHJlZl9zZW5kLmpzIHZlcnNpb246IDIwMDktMDUtMTEKCQkgKgoJCSAqIFdpdGggcGFydHMgYnkgTWFyayBNaWxsZXIKCQkgKiBDb3B5cmlnaHQgKEMpIDIwMTEgR29vZ2xlIEluYy4KCQkgKgoJCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCQkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCQkgKgoJCSAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJCSAqCgkJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJCSAqCgkJICovCgkhZnVuY3Rpb24oZSl7InVzZSBzdHJpY3QiO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBib290c3RyYXApYm9vdHN0cmFwKCJwcm9taXNlIixlKTtlbHNle3QuZXhwb3J0cz1lKCl9fShmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiB0KHQpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBHLmFwcGx5KHQsYXJndW1lbnRzKX19ZnVuY3Rpb24gZSh0KXtyZXR1cm4gdD09PU9iamVjdCh0KX1mdW5jdGlvbiBpKHQpe3JldHVybiJbb2JqZWN0IFN0b3BJdGVyYXRpb25dIj09PWl0KHQpfHx0IGluc3RhbmNlb2Ygen1mdW5jdGlvbiBuKHQsZSl7aWYoVSYmZS5zdGFjayYmIm9iamVjdCI9PXR5cGVvZiB0JiZudWxsIT09dCYmdC5zdGFjayYmdC5zdGFjay5pbmRleE9mKG50KT09PS0xKXtmb3IodmFyIGk9W10sbj1lO247bj1uLnNvdXJjZSluLnN0YWNrJiZpLnVuc2hpZnQobi5zdGFjayk7aS51bnNoaWZ0KHQuc3RhY2spO3ZhciBzPWkuam9pbigiXG4iK250KyJcbiIpO3Quc3RhY2s9cihzKX19ZnVuY3Rpb24gcih0KXtmb3IodmFyIGU9dC5zcGxpdCgiXG4iKSxpPVtdLG49MDtuPGUubGVuZ3RoOysrbil7dmFyIHI9ZVtuXTthKHIpfHxzKHIpfHwhcnx8aS5wdXNoKHIpfXJldHVybiBpLmpvaW4oIlxuIil9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gdC5pbmRleE9mKCIobW9kdWxlLmpzOiIpIT09LTF8fHQuaW5kZXhPZigiKG5vZGUuanM6IikhPT0tMX1mdW5jdGlvbiBvKHQpe3ZhciBlPS9hdCAuKyBcKCguKyk6KFxkKyk6KD86XGQrKVwpJC8uZXhlYyh0KTtpZihlKXJldHVybltlWzFdLE51bWJlcihlWzJdKV07dmFyIGk9L2F0IChbXiBdKyk6KFxkKyk6KD86XGQrKSQvLmV4ZWModCk7aWYoaSlyZXR1cm5baVsxXSxOdW1iZXIoaVsyXSldO3ZhciBuPS8uKkAoLispOihcZCspJC8uZXhlYyh0KTtyZXR1cm4gbj9bblsxXSxOdW1iZXIoblsyXSldOnZvaWQgMH1mdW5jdGlvbiBhKHQpe3ZhciBlPW8odCk7aWYoIWUpcmV0dXJuITE7dmFyIGk9ZVswXSxuPWVbMV07cmV0dXJuIGk9PT1CJiZuPj1WJiZuPD1sdH1mdW5jdGlvbiBsKCl7aWYoVSl0cnl7dGhyb3cgbmV3IEVycm9yfWNhdGNoKHQpe3ZhciBlPXQuc3RhY2suc3BsaXQoIlxuIiksaT1lWzBdLmluZGV4T2YoIkAiKT4wP2VbMV06ZVsyXSxuPW8oaSk7aWYoIW4pcmV0dXJuO3JldHVybiBCPW5bMF0sblsxXX19ZnVuY3Rpb24gYyh0LGUsaSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBjb25zb2xlJiYiZnVuY3Rpb24iPT10eXBlb2YgY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oZSsiIGlzIGRlcHJlY2F0ZWQsIHVzZSAiK2krIiBpbnN0ZWFkLiIsbmV3IEVycm9yKCIiKS5zdGFjayksdC5hcHBseSh0LGFyZ3VtZW50cyl9fWZ1bmN0aW9uIHUodCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBmP3Q6dih0KT94KHQpOkwodCl9ZnVuY3Rpb24gZCgpe2Z1bmN0aW9uIHQodCl7ZT10LHMuc291cmNlPXQsSyhpLGZ1bmN0aW9uKGUsaSl7dS5uZXh0VGljayhmdW5jdGlvbigpe3QucHJvbWlzZURpc3BhdGNoLmFwcGx5KHQsaSl9KX0sdm9pZCAwKSxpPXZvaWQgMCxuPXZvaWQgMH12YXIgZSxpPVtdLG49W10scj1aKGQucHJvdG90eXBlKSxzPVooZi5wcm90b3R5cGUpO2lmKHMucHJvbWlzZURpc3BhdGNoPWZ1bmN0aW9uKHQscixzKXt2YXIgbz1KKGFyZ3VtZW50cyk7aT8oaS5wdXNoKG8pLCJ3aGVuIj09PXImJnNbMV0mJm4ucHVzaChzWzFdKSk6dS5uZXh0VGljayhmdW5jdGlvbigpe2UucHJvbWlzZURpc3BhdGNoLmFwcGx5KGUsbyl9KX0scy52YWx1ZU9mPWZ1bmN0aW9uKCl7aWYoaSlyZXR1cm4gczt2YXIgdD1fKGUpO3JldHVybiBnKHQpJiYoZT10KSx0fSxzLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gZT9lLmluc3BlY3QoKTp7c3RhdGU6InBlbmRpbmcifX0sdS5sb25nU3RhY2tTdXBwb3J0JiZVKXRyeXt0aHJvdyBuZXcgRXJyb3J9Y2F0Y2gobyl7cy5zdGFjaz1vLnN0YWNrLnN1YnN0cmluZyhvLnN0YWNrLmluZGV4T2YoIlxuIikrMSl9cmV0dXJuIHIucHJvbWlzZT1zLHIucmVzb2x2ZT1mdW5jdGlvbihpKXtlfHx0KHUoaSkpfSxyLmZ1bGZpbGw9ZnVuY3Rpb24oaSl7ZXx8dChMKGkpKX0sci5yZWplY3Q9ZnVuY3Rpb24oaSl7ZXx8dChTKGkpKX0sci5ub3RpZnk9ZnVuY3Rpb24odCl7ZXx8SyhuLGZ1bmN0aW9uKGUsaSl7dS5uZXh0VGljayhmdW5jdGlvbigpe2kodCl9KX0sdm9pZCAwKX0scn1mdW5jdGlvbiBoKHQpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0KXRocm93IG5ldyBUeXBlRXJyb3IoInJlc29sdmVyIG11c3QgYmUgYSBmdW5jdGlvbi4iKTt2YXIgZT1kKCk7dHJ5e3QoZS5yZXNvbHZlLGUucmVqZWN0LGUubm90aWZ5KX1jYXRjaChpKXtlLnJlamVjdChpKX1yZXR1cm4gZS5wcm9taXNlfWZ1bmN0aW9uIHAodCl7cmV0dXJuIGgoZnVuY3Rpb24oZSxpKXtmb3IodmFyIG49MCxyPXQubGVuZ3RoO248cjtuKyspdSh0W25dKS50aGVuKGUsaSl9KX1mdW5jdGlvbiBmKHQsZSxpKXt2b2lkIDA9PT1lJiYoZT1mdW5jdGlvbih0KXtyZXR1cm4gUyhuZXcgRXJyb3IoIlByb21pc2UgZG9lcyBub3Qgc3VwcG9ydCBvcGVyYXRpb246ICIrdCkpfSksdm9pZCAwPT09aSYmKGk9ZnVuY3Rpb24oKXtyZXR1cm57c3RhdGU6InVua25vd24ifX0pO3ZhciBuPVooZi5wcm90b3R5cGUpO2lmKG4ucHJvbWlzZURpc3BhdGNoPWZ1bmN0aW9uKGkscixzKXt2YXIgbzt0cnl7bz10W3JdP3Rbcl0uYXBwbHkobixzKTplLmNhbGwobixyLHMpfWNhdGNoKGEpe289UyhhKX1pJiZpKG8pfSxuLmluc3BlY3Q9aSxpKXt2YXIgcj1pKCk7InJlamVjdGVkIj09PXIuc3RhdGUmJihuLmV4Y2VwdGlvbj1yLnJlYXNvbiksbi52YWx1ZU9mPWZ1bmN0aW9uKCl7dmFyIHQ9aSgpO3JldHVybiJwZW5kaW5nIj09PXQuc3RhdGV8fCJyZWplY3RlZCI9PT10LnN0YXRlP246dC52YWx1ZX19cmV0dXJuIG59ZnVuY3Rpb24gbSh0LGUsaSxuKXtyZXR1cm4gdSh0KS50aGVuKGUsaSxuKX1mdW5jdGlvbiBfKHQpe2lmKGcodCkpe3ZhciBlPXQuaW5zcGVjdCgpO2lmKCJmdWxmaWxsZWQiPT09ZS5zdGF0ZSlyZXR1cm4gZS52YWx1ZX1yZXR1cm4gdH1mdW5jdGlvbiBnKHQpe3JldHVybiB0IGluc3RhbmNlb2YgZn1mdW5jdGlvbiB2KHQpe3JldHVybiBlKHQpJiYiZnVuY3Rpb24iPT10eXBlb2YgdC50aGVufWZ1bmN0aW9uIHkodCl7cmV0dXJuIGcodCkmJiJwZW5kaW5nIj09PXQuaW5zcGVjdCgpLnN0YXRlfWZ1bmN0aW9uIGIodCl7cmV0dXJuIWcodCl8fCJmdWxmaWxsZWQiPT09dC5pbnNwZWN0KCkuc3RhdGV9ZnVuY3Rpb24gdyh0KXtyZXR1cm4gZyh0KSYmInJlamVjdGVkIj09PXQuaW5zcGVjdCgpLnN0YXRlfWZ1bmN0aW9uIE0oKXtydC5sZW5ndGg9MCxzdC5sZW5ndGg9MCxhdHx8KGF0PSEwKX1mdW5jdGlvbiBrKHQsZSl7YXQmJigib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MmJiJmdW5jdGlvbiI9PXR5cGVvZiBwcm9jZXNzLmVtaXQmJnUubmV4dFRpY2sucnVuQWZ0ZXIoZnVuY3Rpb24oKXtRKHN0LHQpIT09LTEmJihwcm9jZXNzLmVtaXQoInVuaGFuZGxlZFJlamVjdGlvbiIsZSx0KSxvdC5wdXNoKHQpKX0pLHN0LnB1c2godCksZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlLnN0YWNrP3J0LnB1c2goZS5zdGFjayk6cnQucHVzaCgiKG5vIHN0YWNrKSAiK2UpKX1mdW5jdGlvbiBUKHQpe2lmKGF0KXt2YXIgZT1RKHN0LHQpO2UhPT0tMSYmKCJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmImZ1bmN0aW9uIj09dHlwZW9mIHByb2Nlc3MuZW1pdCYmdS5uZXh0VGljay5ydW5BZnRlcihmdW5jdGlvbigpe3ZhciBpPVEob3QsdCk7aSE9PS0xJiYocHJvY2Vzcy5lbWl0KCJyZWplY3Rpb25IYW5kbGVkIixydFtlXSx0KSxvdC5zcGxpY2UoaSwxKSl9KSxzdC5zcGxpY2UoZSwxKSxydC5zcGxpY2UoZSwxKSl9fWZ1bmN0aW9uIFModCl7dmFyIGU9Zih7d2hlbjpmdW5jdGlvbihlKXtyZXR1cm4gZSYmVCh0aGlzKSxlP2UodCk6dGhpc319LGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LGZ1bmN0aW9uKCl7cmV0dXJue3N0YXRlOiJyZWplY3RlZCIscmVhc29uOnR9fSk7cmV0dXJuIGsoZSx0KSxlfWZ1bmN0aW9uIEwodCl7cmV0dXJuIGYoe3doZW46ZnVuY3Rpb24oKXtyZXR1cm4gdH0sZ2V0OmZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfSxzZXQ6ZnVuY3Rpb24oZSxpKXt0W2VdPWl9LCJkZWxldGUiOmZ1bmN0aW9uKGUpe2RlbGV0ZSB0W2VdfSxwb3N0OmZ1bmN0aW9uKGUsaSl7cmV0dXJuIG51bGw9PT1lfHx2b2lkIDA9PT1lP3QuYXBwbHkodm9pZCAwLGkpOnRbZV0uYXBwbHkodCxpKX0sYXBwbHk6ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdC5hcHBseShlLGkpfSxrZXlzOmZ1bmN0aW9uKCl7cmV0dXJuIGV0KHQpfX0sdm9pZCAwLGZ1bmN0aW9uKCl7cmV0dXJue3N0YXRlOiJmdWxmaWxsZWQiLHZhbHVlOnR9fSl9ZnVuY3Rpb24geCh0KXt2YXIgZT1kKCk7cmV0dXJuIHUubmV4dFRpY2soZnVuY3Rpb24oKXt0cnl7dC50aGVuKGUucmVzb2x2ZSxlLnJlamVjdCxlLm5vdGlmeSl9Y2F0Y2goaSl7ZS5yZWplY3QoaSl9fSksZS5wcm9taXNlfWZ1bmN0aW9uIEUodCl7cmV0dXJuIGYoe2lzRGVmOmZ1bmN0aW9uKCl7fX0sZnVuY3Rpb24oZSxpKXtyZXR1cm4gTih0LGUsaSl9LGZ1bmN0aW9uKCl7cmV0dXJuIHUodCkuaW5zcGVjdCgpfSl9ZnVuY3Rpb24gRCh0LGUsaSl7cmV0dXJuIHUodCkuc3ByZWFkKGUsaSl9ZnVuY3Rpb24gWSh0KXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsZSl7dmFyIG87aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBTdG9wSXRlcmF0aW9uKXt0cnl7bz1uW3RdKGUpfWNhdGNoKGEpe3JldHVybiBTKGEpfXJldHVybiBvLmRvbmU/dShvLnZhbHVlKTptKG8udmFsdWUscixzKX10cnl7bz1uW3RdKGUpfWNhdGNoKGEpe3JldHVybiBpKGEpP3UoYS52YWx1ZSk6UyhhKX1yZXR1cm4gbShvLHIscyl9dmFyIG49dC5hcHBseSh0aGlzLGFyZ3VtZW50cykscj1lLmJpbmQoZSwibmV4dCIpLHM9ZS5iaW5kKGUsInRocm93Iik7cmV0dXJuIHIoKX19ZnVuY3Rpb24gQyh0KXt1LmRvbmUodS5hc3luYyh0KSgpKX1mdW5jdGlvbiBBKHQpe3Rocm93IG5ldyB6KHQpfWZ1bmN0aW9uIE8odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIEQoW3RoaXMsSShhcmd1bWVudHMpXSxmdW5jdGlvbihlLGkpe3JldHVybiB0LmFwcGx5KGUsaSl9KX19ZnVuY3Rpb24gTih0LGUsaSl7cmV0dXJuIHUodCkuZGlzcGF0Y2goZSxpKX1mdW5jdGlvbiBJKHQpe3JldHVybiBtKHQsZnVuY3Rpb24odCl7dmFyIGU9MCxpPWQoKTtyZXR1cm4gSyh0LGZ1bmN0aW9uKG4scixzKXt2YXIgbztnKHIpJiYiZnVsZmlsbGVkIj09PShvPXIuaW5zcGVjdCgpKS5zdGF0ZT90W3NdPW8udmFsdWU6KCsrZSxtKHIsZnVuY3Rpb24obil7dFtzXT1uLDA9PT0tLWUmJmkucmVzb2x2ZSh0KX0saS5yZWplY3QsZnVuY3Rpb24odCl7aS5ub3RpZnkoe2luZGV4OnMsdmFsdWU6dH0pfSkpfSx2b2lkIDApLDA9PT1lJiZpLnJlc29sdmUodCksaS5wcm9taXNlfSl9ZnVuY3Rpb24gUCh0KXtpZigwPT09dC5sZW5ndGgpcmV0dXJuIHUucmVzb2x2ZSgpO3ZhciBlPXUuZGVmZXIoKSxpPTA7cmV0dXJuIEsodCxmdW5jdGlvbihuLHIscyl7ZnVuY3Rpb24gbyh0KXtlLnJlc29sdmUodCl9ZnVuY3Rpb24gYSgpe2ktLSwwPT09aSYmZS5yZWplY3QobmV3IEVycm9yKCJDYW4ndCBnZXQgZnVsZmlsbG1lbnQgdmFsdWUgZnJvbSBhbnkgcHJvbWlzZSwgYWxsIHByb21pc2VzIHdlcmUgcmVqZWN0ZWQuIikpfWZ1bmN0aW9uIGwodCl7ZS5ub3RpZnkoe2luZGV4OnMsdmFsdWU6dH0pfXZhciBjPXRbc107aSsrLG0oYyxvLGEsbCl9LHZvaWQgMCksZS5wcm9taXNlfWZ1bmN0aW9uIFIodCl7cmV0dXJuIG0odCxmdW5jdGlvbih0KXtyZXR1cm4gdD1YKHQsdSksbShJKFgodCxmdW5jdGlvbih0KXtyZXR1cm4gbSh0LCQsJCl9KSksZnVuY3Rpb24oKXtyZXR1cm4gdH0pfSl9ZnVuY3Rpb24gSCh0KXtyZXR1cm4gdSh0KS5hbGxTZXR0bGVkKCl9ZnVuY3Rpb24gaih0LGUpe3JldHVybiB1KHQpLnRoZW4odm9pZCAwLHZvaWQgMCxlKX1mdW5jdGlvbiBGKHQsZSl7cmV0dXJuIHUodCkubm9kZWlmeShlKX12YXIgVT0hMTt0cnl7dGhyb3cgbmV3IEVycm9yfWNhdGNoKFcpe1U9ISFXLnN0YWNrfXZhciBCLHosVj1sKCksJD1mdW5jdGlvbigpe30scT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXtmb3IodmFyIHQsbjtpLm5leHQ7KWk9aS5uZXh0LHQ9aS50YXNrLGkudGFzaz12b2lkIDAsbj1pLmRvbWFpbixuJiYoaS5kb21haW49dm9pZCAwLG4uZW50ZXIoKSksZSh0LG4pO2Zvcig7YS5sZW5ndGg7KXQ9YS5wb3AoKSxlKHQpO3I9ITF9ZnVuY3Rpb24gZShlLGkpe3RyeXtlKCl9Y2F0Y2gobil7aWYobyl0aHJvdyBpJiZpLmV4aXQoKSxzZXRUaW1lb3V0KHQsMCksaSYmaS5lbnRlcigpLG47c2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IG59LDApfWkmJmkuZXhpdCgpfXZhciBpPXt0YXNrOnZvaWQgMCxuZXh0Om51bGx9LG49aSxyPSExLHM9dm9pZCAwLG89ITEsYT1bXTtpZihxPWZ1bmN0aW9uKHQpe249bi5uZXh0PXt0YXNrOnQsZG9tYWluOm8mJnByb2Nlc3MuZG9tYWluLG5leHQ6bnVsbH0scnx8KHI9ITAscygpKX0sIm9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiYiW29iamVjdCBwcm9jZXNzXSI9PT1wcm9jZXNzLnRvU3RyaW5nKCkmJnByb2Nlc3MubmV4dFRpY2spbz0hMCxzPWZ1bmN0aW9uKCl7cHJvY2Vzcy5uZXh0VGljayh0KX07ZWxzZSBpZigiZnVuY3Rpb24iPT10eXBlb2Ygc2V0SW1tZWRpYXRlKXM9InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/c2V0SW1tZWRpYXRlLmJpbmQod2luZG93LHQpOmZ1bmN0aW9uKCl7c2V0SW1tZWRpYXRlKHQpfTtlbHNlIGlmKCJ1bmRlZmluZWQiIT10eXBlb2YgTWVzc2FnZUNoYW5uZWwpe3ZhciBsPW5ldyBNZXNzYWdlQ2hhbm5lbDtsLnBvcnQxLm9ubWVzc2FnZT1mdW5jdGlvbigpe3M9YyxsLnBvcnQxLm9ubWVzc2FnZT10LHQoKX07dmFyIGM9ZnVuY3Rpb24oKXtsLnBvcnQyLnBvc3RNZXNzYWdlKDApfTtzPWZ1bmN0aW9uKCl7c2V0VGltZW91dCh0LDApLGMoKX19ZWxzZSBzPWZ1bmN0aW9uKCl7c2V0VGltZW91dCh0LDApfTtyZXR1cm4gcS5ydW5BZnRlcj1mdW5jdGlvbih0KXthLnB1c2godCkscnx8KHI9ITAscygpKX0scX0oKSxHPUZ1bmN0aW9uLmNhbGwsSj10KEFycmF5LnByb3RvdHlwZS5zbGljZSksSz10KEFycmF5LnByb3RvdHlwZS5yZWR1Y2V8fGZ1bmN0aW9uKHQsZSl7dmFyIGk9MCxuPXRoaXMubGVuZ3RoO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWZvcig7Oyl7aWYoaSBpbiB0aGlzKXtlPXRoaXNbaSsrXTticmVha31pZigrK2k+PW4pdGhyb3cgbmV3IFR5cGVFcnJvcn1mb3IoO2k8bjtpKyspaSBpbiB0aGlzJiYoZT10KGUsdGhpc1tpXSxpKSk7cmV0dXJuIGV9KSxRPXQoQXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wO2U8dGhpcy5sZW5ndGg7ZSsrKWlmKHRoaXNbZV09PT10KXJldHVybiBlO3JldHVybi0xfSksWD10KEFycmF5LnByb3RvdHlwZS5tYXB8fGZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcyxuPVtdO3JldHVybiBLKGksZnVuY3Rpb24ocixzLG8pe24ucHVzaCh0LmNhbGwoZSxzLG8saSkpfSx2b2lkIDApLG59KSxaPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGUucHJvdG90eXBlPXQsbmV3IGV9LHR0PXQoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSksZXQ9T2JqZWN0LmtleXN8fGZ1bmN0aW9uKHQpe3ZhciBlPVtdO2Zvcih2YXIgaSBpbiB0KXR0KHQsaSkmJmUucHVzaChpKTtyZXR1cm4gZX0saXQ9dChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKTt6PSJ1bmRlZmluZWQiIT10eXBlb2YgUmV0dXJuVmFsdWU/UmV0dXJuVmFsdWU6ZnVuY3Rpb24odCl7dGhpcy52YWx1ZT10fTt2YXIgbnQ9IkZyb20gcHJldmlvdXMgZXZlbnQ6Ijt1LnJlc29sdmU9dSx1Lm5leHRUaWNrPXEsdS5sb25nU3RhY2tTdXBwb3J0PSExLCJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmcHJvY2VzcyYmcHJvY2Vzcy5lbnYmJnByb2Nlc3MuZW52LlFfREVCVUcmJih1LmxvbmdTdGFja1N1cHBvcnQ9ITApLHUuZGVmZXI9ZCxkLnByb3RvdHlwZS5tYWtlTm9kZVJlc29sdmVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gZnVuY3Rpb24oZSxpKXtlP3QucmVqZWN0KGUpOmFyZ3VtZW50cy5sZW5ndGg+Mj90LnJlc29sdmUoSihhcmd1bWVudHMsMSkpOnQucmVzb2x2ZShpKX19LHUuUHJvbWlzZT1oLHUucHJvbWlzZT1oLGgucmFjZT1wLGguYWxsPUksaC5yZWplY3Q9UyxoLnJlc29sdmU9dSx1LnBhc3NCeUNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LGYucHJvdG90eXBlLnBhc3NCeUNvcHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sdS5qb2luPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCkuam9pbihlKX0sZi5wcm90b3R5cGUuam9pbj1mdW5jdGlvbih0KXtyZXR1cm4gdShbdGhpcyx0XSkuc3ByZWFkKGZ1bmN0aW9uKHQsZSl7aWYodD09PWUpcmV0dXJuIHQ7dGhyb3cgbmV3IEVycm9yKCJDYW4ndCBqb2luOiBub3QgdGhlIHNhbWU6ICIrdCsiICIrZSl9KX0sdS5yYWNlPXAsZi5wcm90b3R5cGUucmFjZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRoZW4odS5yYWNlKX0sdS5tYWtlUHJvbWlzZT1mLGYucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIltvYmplY3QgUHJvbWlzZV0ifSxmLnByb3RvdHlwZS50aGVuPWZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiByKGUpe3RyeXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90KGUpOmV9Y2F0Y2goaSl7cmV0dXJuIFMoaSl9fWZ1bmN0aW9uIHModCl7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGUpe24odCxhKTt0cnl7cmV0dXJuIGUodCl9Y2F0Y2goaSl7cmV0dXJuIFMoaSl9fXJldHVybiBTKHQpfWZ1bmN0aW9uIG8odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIGk/aSh0KTp0fXZhciBhPXRoaXMsbD1kKCksYz0hMTtyZXR1cm4gdS5uZXh0VGljayhmdW5jdGlvbigpe2EucHJvbWlzZURpc3BhdGNoKGZ1bmN0aW9uKHQpe2N8fChjPSEwLGwucmVzb2x2ZShyKHQpKSl9LCJ3aGVuIixbZnVuY3Rpb24odCl7Y3x8KGM9ITAsbC5yZXNvbHZlKHModCkpKX1dKX0pLGEucHJvbWlzZURpc3BhdGNoKHZvaWQgMCwid2hlbiIsW3ZvaWQgMCxmdW5jdGlvbih0KXt2YXIgZSxpPSExO3RyeXtlPW8odCl9Y2F0Y2gobil7aWYoaT0hMCwhdS5vbmVycm9yKXRocm93IG47dS5vbmVycm9yKG4pfWl8fGwubm90aWZ5KGUpfV0pLGwucHJvbWlzZX0sdS50YXA9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdSh0KS50YXAoZSl9LGYucHJvdG90eXBlLnRhcD1mdW5jdGlvbih0KXtyZXR1cm4gdD11KHQpLHRoaXMudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdC5mY2FsbChlKS50aGVuUmVzb2x2ZShlKX0pfSx1LndoZW49bSxmLnByb3RvdHlwZS50aGVuUmVzb2x2ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHR9KX0sdS50aGVuUmVzb2x2ZT1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLnRoZW5SZXNvbHZlKGUpfSxmLnByb3RvdHlwZS50aGVuUmVqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24oKXt0aHJvdyB0fSl9LHUudGhlblJlamVjdD1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLnRoZW5SZWplY3QoZSl9LHUubmVhcmVyPV8sdS5pc1Byb21pc2U9Zyx1LmlzUHJvbWlzZUFsaWtlPXYsdS5pc1BlbmRpbmc9eSxmLnByb3RvdHlwZS5pc1BlbmRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4icGVuZGluZyI9PT10aGlzLmluc3BlY3QoKS5zdGF0ZX0sdS5pc0Z1bGZpbGxlZD1iLGYucHJvdG90eXBlLmlzRnVsZmlsbGVkPWZ1bmN0aW9uKCl7cmV0dXJuImZ1bGZpbGxlZCI9PT10aGlzLmluc3BlY3QoKS5zdGF0ZX0sdS5pc1JlamVjdGVkPXcsZi5wcm90b3R5cGUuaXNSZWplY3RlZD1mdW5jdGlvbigpe3JldHVybiJyZWplY3RlZCI9PT10aGlzLmluc3BlY3QoKS5zdGF0ZX07dmFyIHJ0PVtdLHN0PVtdLG90PVtdLGF0PSEwO3UucmVzZXRVbmhhbmRsZWRSZWplY3Rpb25zPU0sdS5nZXRVbmhhbmRsZWRSZWFzb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHJ0LnNsaWNlKCl9LHUuc3RvcFVuaGFuZGxlZFJlamVjdGlvblRyYWNraW5nPWZ1bmN0aW9uKCl7TSgpLGF0PSExfSxNKCksdS5yZWplY3Q9Uyx1LmZ1bGZpbGw9TCx1Lm1hc3Rlcj1FLHUuc3ByZWFkPUQsZi5wcm90b3R5cGUuc3ByZWFkPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWxsKCkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdC5hcHBseSh2b2lkIDAsZSl9LGUpfSx1LmFzeW5jPVksdS5zcGF3bj1DLHVbInJldHVybiJdPUEsdS5wcm9taXNlZD1PLHUuZGlzcGF0Y2g9TixmLnByb3RvdHlwZS5kaXNwYXRjaD1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMsbj1kKCk7cmV0dXJuIHUubmV4dFRpY2soZnVuY3Rpb24oKXtpLnByb21pc2VEaXNwYXRjaChuLnJlc29sdmUsdCxlKX0pLG4ucHJvbWlzZX0sdS5nZXQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdSh0KS5kaXNwYXRjaCgiZ2V0IixbZV0pfSxmLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImdldCIsW3RdKX0sdS5zZXQ9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1KHQpLmRpc3BhdGNoKCJzZXQiLFtlLGldKX0sZi5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goInNldCIsW3QsZV0pfSx1LmRlbD11WyJkZWxldGUiXT1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLmRpc3BhdGNoKCJkZWxldGUiLFtlXSl9LGYucHJvdG90eXBlLmRlbD1mLnByb3RvdHlwZVsiZGVsZXRlIl09ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImRlbGV0ZSIsW3RdKX0sdS5tYXBwbHk9dS5wb3N0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdSh0KS5kaXNwYXRjaCgicG9zdCIsW2UsaV0pfSxmLnByb3RvdHlwZS5tYXBwbHk9Zi5wcm90b3R5cGUucG9zdD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmRpc3BhdGNoKCJwb3N0IixbdCxlXSl9LHUuc2VuZD11Lm1jYWxsPXUuaW52b2tlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCkuZGlzcGF0Y2goInBvc3QiLFtlLEooYXJndW1lbnRzLDIpXSl9LGYucHJvdG90eXBlLnNlbmQ9Zi5wcm90b3R5cGUubWNhbGw9Zi5wcm90b3R5cGUuaW52b2tlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRpc3BhdGNoKCJwb3N0IixbdCxKKGFyZ3VtZW50cywxKV0pfSx1LmZhcHBseT1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLmRpc3BhdGNoKCJhcHBseSIsW3ZvaWQgMCxlXSl9LGYucHJvdG90eXBlLmZhcHBseT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5kaXNwYXRjaCgiYXBwbHkiLFt2b2lkIDAsdF0pfSx1WyJ0cnkiXT11LmZjYWxsPWZ1bmN0aW9uKHQpe3JldA==", "base64"));
  res.write(new Buffer("dXJuIHUodCkuZGlzcGF0Y2goImFwcGx5Iixbdm9pZCAwLEooYXJndW1lbnRzLDEpXSl9LGYucHJvdG90eXBlLmZjYWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImFwcGx5Iixbdm9pZCAwLEooYXJndW1lbnRzKV0pfSx1LmZiaW5kPWZ1bmN0aW9uKHQpe3ZhciBlPXUodCksaT1KKGFyZ3VtZW50cywxKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5kaXNwYXRjaCgiYXBwbHkiLFt0aGlzLGkuY29uY2F0KEooYXJndW1lbnRzKSldKX19LGYucHJvdG90eXBlLmZiaW5kPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPUooYXJndW1lbnRzKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5kaXNwYXRjaCgiYXBwbHkiLFt0aGlzLGUuY29uY2F0KEooYXJndW1lbnRzKSldKX19LHUua2V5cz1mdW5jdGlvbih0KXtyZXR1cm4gdSh0KS5kaXNwYXRjaCgia2V5cyIsW10pfSxmLnByb3RvdHlwZS5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImtleXMiLFtdKX0sdS5hbGw9SSxmLnByb3RvdHlwZS5hbGw9ZnVuY3Rpb24oKXtyZXR1cm4gSSh0aGlzKX0sdS5hbnk9UCxmLnByb3RvdHlwZS5hbnk9ZnVuY3Rpb24oKXtyZXR1cm4gUCh0aGlzKX0sdS5hbGxSZXNvbHZlZD1jKFIsImFsbFJlc29sdmVkIiwiYWxsU2V0dGxlZCIpLGYucHJvdG90eXBlLmFsbFJlc29sdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIFIodGhpcyl9LHUuYWxsU2V0dGxlZD1ILGYucHJvdG90eXBlLmFsbFNldHRsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBJKFgodCxmdW5jdGlvbih0KXtmdW5jdGlvbiBlKCl7cmV0dXJuIHQuaW5zcGVjdCgpfXJldHVybiB0PXUodCksdC50aGVuKGUsZSl9KSl9KX0sdS5mYWlsPXVbImNhdGNoIl09ZnVuY3Rpb24odCxlKXtyZXR1cm4gdSh0KS50aGVuKHZvaWQgMCxlKX0sZi5wcm90b3R5cGUuZmFpbD1mLnByb3RvdHlwZVsiY2F0Y2giXT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKHZvaWQgMCx0KX0sdS5wcm9ncmVzcz1qLGYucHJvdG90eXBlLnByb2dyZXNzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLHZvaWQgMCx0KX0sdS5maW49dVsiZmluYWxseSJdPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodClbImZpbmFsbHkiXShlKX0sZi5wcm90b3R5cGUuZmluPWYucHJvdG90eXBlWyJmaW5hbGx5Il09ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dSh0KSx0aGlzLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIHQuZmNhbGwoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGV9KX0sZnVuY3Rpb24oZSl7cmV0dXJuIHQuZmNhbGwoKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgZX0pfSl9LHUuZG9uZT1mdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gdSh0KS5kb25lKGUsaSxuKX0sZi5wcm90b3R5cGUuZG9uZT1mdW5jdGlvbih0LGUsaSl7dmFyIHI9ZnVuY3Rpb24odCl7dS5uZXh0VGljayhmdW5jdGlvbigpe2lmKG4odCxzKSwhdS5vbmVycm9yKXRocm93IHQ7dS5vbmVycm9yKHQpfSl9LHM9dHx8ZXx8aT90aGlzLnRoZW4odCxlLGkpOnRoaXM7Im9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiZwcm9jZXNzJiZwcm9jZXNzLmRvbWFpbiYmKHI9cHJvY2Vzcy5kb21haW4uYmluZChyKSkscy50aGVuKHZvaWQgMCxyKX0sdS50aW1lb3V0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdSh0KS50aW1lb3V0KGUsaSl9LGYucHJvdG90eXBlLnRpbWVvdXQ9ZnVuY3Rpb24odCxlKXt2YXIgaT1kKCksbj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZSYmInN0cmluZyIhPXR5cGVvZiBlfHwoZT1uZXcgRXJyb3IoZXx8IlRpbWVkIG91dCBhZnRlciAiK3QrIiBtcyIpLGUuY29kZT0iRVRJTUVET1VUIiksaS5yZWplY3QoZSl9LHQpO3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24odCl7Y2xlYXJUaW1lb3V0KG4pLGkucmVzb2x2ZSh0KX0sZnVuY3Rpb24odCl7Y2xlYXJUaW1lb3V0KG4pLGkucmVqZWN0KHQpfSxpLm5vdGlmeSksaS5wcm9taXNlfSx1LmRlbGF5PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPXQsdD12b2lkIDApLHUodCkuZGVsYXkoZSl9LGYucHJvdG90eXBlLmRlbGF5PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9ZCgpO3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aS5yZXNvbHZlKGUpfSx0KSxpLnByb21pc2V9KX0sdS5uZmFwcGx5PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCkubmZhcHBseShlKX0sZi5wcm90b3R5cGUubmZhcHBseT1mdW5jdGlvbih0KXt2YXIgZT1kKCksaT1KKHQpO3JldHVybiBpLnB1c2goZS5tYWtlTm9kZVJlc29sdmVyKCkpLHRoaXMuZmFwcGx5KGkpLmZhaWwoZS5yZWplY3QpLGUucHJvbWlzZX0sdS5uZmNhbGw9ZnVuY3Rpb24odCl7dmFyIGU9Sihhcmd1bWVudHMsMSk7cmV0dXJuIHUodCkubmZhcHBseShlKX0sZi5wcm90b3R5cGUubmZjYWxsPWZ1bmN0aW9uKCl7dmFyIHQ9Sihhcmd1bWVudHMpLGU9ZCgpO3JldHVybiB0LnB1c2goZS5tYWtlTm9kZVJlc29sdmVyKCkpLHRoaXMuZmFwcGx5KHQpLmZhaWwoZS5yZWplY3QpLGUucHJvbWlzZX0sdS5uZmJpbmQ9dS5kZW5vZGVpZnk9ZnVuY3Rpb24odCl7dmFyIGU9Sihhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGk9ZS5jb25jYXQoSihhcmd1bWVudHMpKSxuPWQoKTtyZXR1cm4gaS5wdXNoKG4ubWFrZU5vZGVSZXNvbHZlcigpKSx1KHQpLmZhcHBseShpKS5mYWlsKG4ucmVqZWN0KSxuLnByb21pc2V9fSxmLnByb3RvdHlwZS5uZmJpbmQ9Zi5wcm90b3R5cGUuZGVub2RlaWZ5PWZ1bmN0aW9uKCl7dmFyIHQ9Sihhcmd1bWVudHMpO3JldHVybiB0LnVuc2hpZnQodGhpcyksdS5kZW5vZGVpZnkuYXBwbHkodm9pZCAwLHQpfSx1Lm5iaW5kPWZ1bmN0aW9uKHQsZSl7dmFyIGk9Sihhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gbigpe3JldHVybiB0LmFwcGx5KGUsYXJndW1lbnRzKX12YXIgcj1pLmNvbmNhdChKKGFyZ3VtZW50cykpLHM9ZCgpO3JldHVybiByLnB1c2gocy5tYWtlTm9kZVJlc29sdmVyKCkpLHUobikuZmFwcGx5KHIpLmZhaWwocy5yZWplY3QpLHMucHJvbWlzZX19LGYucHJvdG90eXBlLm5iaW5kPWZ1bmN0aW9uKCl7dmFyIHQ9Sihhcmd1bWVudHMsMCk7cmV0dXJuIHQudW5zaGlmdCh0aGlzKSx1Lm5iaW5kLmFwcGx5KHZvaWQgMCx0KX0sdS5ubWFwcGx5PXUubnBvc3Q9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1KHQpLm5wb3N0KGUsaSl9LGYucHJvdG90eXBlLm5tYXBwbHk9Zi5wcm90b3R5cGUubnBvc3Q9ZnVuY3Rpb24odCxlKXt2YXIgaT1KKGV8fFtdKSxuPWQoKTtyZXR1cm4gaS5wdXNoKG4ubWFrZU5vZGVSZXNvbHZlcigpKSx0aGlzLmRpc3BhdGNoKCJwb3N0IixbdCxpXSkuZmFpbChuLnJlamVjdCksbi5wcm9taXNlfSx1Lm5zZW5kPXUubm1jYWxsPXUubmludm9rZT1mdW5jdGlvbih0LGUpe3ZhciBpPUooYXJndW1lbnRzLDIpLG49ZCgpO3JldHVybiBpLnB1c2gobi5tYWtlTm9kZVJlc29sdmVyKCkpLHUodCkuZGlzcGF0Y2goInBvc3QiLFtlLGldKS5mYWlsKG4ucmVqZWN0KSxuLnByb21pc2V9LGYucHJvdG90eXBlLm5zZW5kPWYucHJvdG90eXBlLm5tY2FsbD1mLnByb3RvdHlwZS5uaW52b2tlPWZ1bmN0aW9uKHQpe3ZhciBlPUooYXJndW1lbnRzLDEpLGk9ZCgpO3JldHVybiBlLnB1c2goaS5tYWtlTm9kZVJlc29sdmVyKCkpLHRoaXMuZGlzcGF0Y2goInBvc3QiLFt0LGVdKS5mYWlsKGkucmVqZWN0KSxpLnByb21pc2V9LHUubm9kZWlmeT1GLGYucHJvdG90eXBlLm5vZGVpZnk9ZnVuY3Rpb24odCl7cmV0dXJuIHQ/dm9pZCB0aGlzLnRoZW4oZnVuY3Rpb24oZSl7dS5uZXh0VGljayhmdW5jdGlvbigpe3QobnVsbCxlKX0pfSxmdW5jdGlvbihlKXt1Lm5leHRUaWNrKGZ1bmN0aW9uKCl7dChlKX0pfSk6dGhpc30sdS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJRLm5vQ29uZmxpY3Qgb25seSB3b3JrcyB3aGVuIFEgaXMgdXNlZCBhcyBhIGdsb2JhbCIpfTt2YXIgbHQ9bCgpO3JldHVybiB1fSl9LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0LGUpe3RoaXMubmFtZT0iQXV0aEFwaUVycm9yIix0aGlzLm1lc3NhZ2U9dC5lcnJvclN1bW1hcnksdGhpcy5lcnJvclN1bW1hcnk9dC5lcnJvclN1bW1hcnksdGhpcy5lcnJvckNvZGU9dC5lcnJvckNvZGUsdGhpcy5lcnJvckxpbms9dC5lcnJvckxpbmssdGhpcy5lcnJvcklkPXQuZXJyb3JJZCx0aGlzLmVycm9yQ2F1c2VzPXQuZXJyb3JDYXVzZXMsZSYmKHRoaXMueGhyPWUpfWkucHJvdG90eXBlPW5ldyBFcnJvcix0LmV4cG9ydHM9aX0sZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKCl7dGhpcy5uYW1lPSJBdXRoUG9sbFN0b3BFcnJvciIsdGhpcy5tZXNzYWdlPSJUaGUgcG9sbCB3YXMgc3RvcHBlZCBieSB0aGUgc2RrIn1pLnByb3RvdHlwZT1uZXcgRXJyb3IsdC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQpe3JldHVybiB0LnNlc3Npb24uZ2V0KCkudGhlbihmdW5jdGlvbih0KXtyZXR1cm4iQUNUSVZFIj09PXQuc3RhdHVzfSkuZmFpbChmdW5jdGlvbigpe3JldHVybiExfSl9ZnVuY3Rpb24gcih0KXtyZXR1cm4gYy5nZXQodCwiL2FwaS92MS9zZXNzaW9ucy9tZSIpLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9bC5vbWl0KGUsIl9saW5rcyIpO3JldHVybiBpLnJlZnJlc2g9ZnVuY3Rpb24oKXtyZXR1cm4gYy5wb3N0KHQsbC5nZXRMaW5rKGUsInJlZnJlc2giKS5ocmVmKX0saS51c2VyPWZ1bmN0aW9uKCl7cmV0dXJuIGMuZ2V0KHQsbC5nZXRMaW5rKGUsInVzZXIiKS5ocmVmKX0saX0pLmZhaWwoZnVuY3Rpb24oKXtyZXR1cm57c3RhdHVzOiJJTkFDVElWRSJ9fSl9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gYy5odHRwUmVxdWVzdCh0LHt1cmw6dC5vcHRpb25zLnVybCsiL2FwaS92MS9zZXNzaW9ucy9tZSIsbWV0aG9kOiJERUxFVEUifSl9ZnVuY3Rpb24gbyh0KXtyZXR1cm4gYy5wb3N0KHQsIi9hcGkvdjEvc2Vzc2lvbnMvbWUvbGlmZWN5Y2xlL3JlZnJlc2giKX1mdW5jdGlvbiBhKHQsZSxpKXtpPWl8fHdpbmRvdy5sb2NhdGlvbi5ocmVmLHdpbmRvdy5sb2NhdGlvbj10Lm9wdGlvbnMudXJsKyIvbG9naW4vc2Vzc2lvbkNvb2tpZVJlZGlyZWN0IitsLnRvUXVlcnlQYXJhbXMoe2NoZWNrQWNjb3VudFNldHVwQ29tcGxldGU6ITAsdG9rZW46ZSxyZWRpcmVjdFVybDppfSl9dmFyIGw9aSgxMyksYz1pKDE1KTt0LmV4cG9ydHM9e3Nlc3Npb25FeGlzdHM6bixnZXRTZXNzaW9uOnIsY2xvc2VTZXNzaW9uOnMscmVmcmVzaFNlc3Npb246byxzZXRDb29raWVBbmRSZWRpcmVjdDphfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7dmFyIGUsaT10LnNwbGl0KCIuIik7dHJ5e2U9e2hlYWRlcjpKU09OLnBhcnNlKHcuYmFzZTY0VXJsVG9TdHJpbmcoaVswXSkpLHBheWxvYWQ6SlNPTi5wYXJzZSh3LmJhc2U2NFVybFRvU3RyaW5nKGlbMV0pKSxzaWduYXR1cmU6aVsyXX19Y2F0Y2gobil7dGhyb3cgbmV3IFMoIk1hbGZvcm1lZCB0b2tlbiIpfXJldHVybiBlfWZ1bmN0aW9uIHIodCxlLGkpe2Z1bmN0aW9uIG4odCl7dmFyIGU7aWYoZT1pLmV4cGlyYXRpb25UaW1lfHwwPT09aS5leHBpcmF0aW9uVGltZT9pLmV4cGlyYXRpb25UaW1lOk1hdGguZmxvb3IoRGF0ZS5ub3coKS8xZTMpLHQmJnQ+ZSlyZXR1cm4hMH1mdW5jdGlvbiByKHQpe2lmKCFpLmF1ZGllbmNlKXJldHVybiEwO2Zvcih2YXIgZT1BcnJheS5pc0FycmF5KGkuYXVkaWVuY2UpP2kuYXVkaWVuY2U6W2kuYXVkaWVuY2VdLG49QXJyYXkuaXNBcnJheSh0KT90Olt0XSxyPWUubGVuZ3RoO3ItLTspe3ZhciBzPWVbcl07aWYobi5pbmRleE9mKHMpIT09LTEpcmV0dXJuITB9fXJldHVybiBpPWl8fHt9LHQuZmVhdHVyZXMuaXNUb2tlblZlcmlmeVN1cHBvcnRlZCgpP00uZ2V0V2VsbEtub3duKHQpLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGIuZ2V0KHQsZS5qd2tzX3VyaSl9KS50aGVuKGZ1bmN0aW9uKHQpe3ZhciBpPXQua2V5c1swXTtyZXR1cm4gVC52ZXJpZnlUb2tlbihlLGkpfSkudGhlbihmdW5jdGlvbihzKXtpZighcylyZXR1cm4hMTt2YXIgbz10LnRva2VuLmRlY29kZShlKTtyZXR1cm4hbihvLnBheWxvYWQuZXhwKSYmKCEhcihvLnBheWxvYWQuYXVkKSYmKCFpLmlzc3Vlcnx8aS5pc3N1ZXI9PT1vLnBheWxvYWQuaXNzKSl9KTprLnJlamVjdChuZXcgUygiVGhpcyBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBjcnlwdG8uc3VidGxlIikpfWZ1bmN0aW9uIHModCxlLGkscil7cmV0dXJuKG5ldyBrKS50aGVuKGZ1bmN0aW9uKCl7aWYoIWV8fCFlLmlkVG9rZW4pdGhyb3cgbmV3IFMoIk9ubHkgaWRUb2tlbnMgbWF5IGJlIHZlcmlmaWVkIik7dmFyIHM9bihlLmlkVG9rZW4pO3JldHVybiBNLnZhbGlkYXRlQ2xhaW1zKHQscy5wYXlsb2FkLGUuY2xpZW50SWQsZS5pc3N1ZXIsaSkscnx8IXQuZmVhdHVyZXMuaXNUb2tlblZlcmlmeVN1cHBvcnRlZCgpP2U6TS5nZXRLZXkodCxlLmlzc3VlcixzLmhlYWRlci5raWQpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIFQudmVyaWZ5VG9rZW4oZS5pZFRva2VuLHQpfSkudGhlbihmdW5jdGlvbih0KXtpZighdCl0aHJvdyBuZXcgUygiVGhlIHRva2VuIHNpZ25hdHVyZSBpcyBub3QgdmFsaWQiKTtyZXR1cm4gZX0pfSl9ZnVuY3Rpb24gbyh0LGUpe3JldHVybiBlPWV8fHt9LGUuZGlzcGxheT1udWxsLGUucHJvbXB0PSJub25lIixwKHQsZSl9ZnVuY3Rpb24gYSh0LGUsaSl7ZnVuY3Rpb24gbihlKXshZS5kYXRhfHxlLm9yaWdpbiE9PXQub3B0aW9ucy51cmx8fGUuZGF0YSYmdy5pc1N0cmluZyhpKSYmZS5kYXRhLnN0YXRlIT09aXx8ci5yZXNvbHZlKGUuZGF0YSl9dmFyIHI9ay5kZWZlcigpO3JldHVybiBNLmFkZExpc3RlbmVyKHdpbmRvdywibWVzc2FnZSIsbiksci5wcm9taXNlLnRpbWVvdXQoZXx8MTJlNCxuZXcgUygiT0F1dGggZmxvdyB0aW1lZCBvdXQiKSkuZmluKGZ1bmN0aW9uKCl7TS5yZW1vdmVMaXN0ZW5lcih3aW5kb3csIm1lc3NhZ2UiLG4pfSl9ZnVuY3Rpb24gbCh0LGUsaSl7ZnVuY3Rpb24gbigpe3RyeXtlJiZlLmxvY2F0aW9uJiZlLmxvY2F0aW9uLmhhc2g/ci5yZXNvbHZlKE0uaGFzaFRvT2JqZWN0KGUubG9jYXRpb24uaGFzaCkpOmUmJiFlLmNsb3NlZCYmc2V0VGltZW91dChuLDUwMCl9Y2F0Y2godCl7c2V0VGltZW91dChuLDUwMCl9fXZhciByPWsuZGVmZXIoKTtyZXR1cm4gbigpLHIucHJvbWlzZS50aW1lb3V0KGl8fDEyZTQsbmV3IFMoIk9BdXRoIGZsb3cgdGltZWQgb3V0IikpfWZ1bmN0aW9uIGModCxlLGksbil7bj1ufHx7fTt2YXIgcj1lLnJlc3BvbnNlVHlwZSxvPXcuY2xvbmUoZS5zY29wZXMpLGE9ZS5jbGllbnRJZHx8dC5vcHRpb25zLmNsaWVudElkO3JldHVybihuZXcgaykudGhlbihmdW5jdGlvbigpe2lmKGkuZXJyb3J8fGkuZXJyb3JfZGVzY3JpcHRpb24pdGhyb3cgbmV3IEwoaS5lcnJvcixpLmVycm9yX2Rlc2NyaXB0aW9uKTtpZihpLnN0YXRlIT09ZS5zdGF0ZSl0aHJvdyBuZXcgUygiT0F1dGggZmxvdyByZXNwb25zZSBzdGF0ZSBkb2Vzbid0IG1hdGNoIHJlcXVlc3Qgc3RhdGUiKTt2YXIgcj17fTtpZihpLmFjY2Vzc190b2tlbiYmKHIudG9rZW49e2FjY2Vzc1Rva2VuOmkuYWNjZXNzX3Rva2VuLGV4cGlyZXNBdDpOdW1iZXIoaS5leHBpcmVzX2luKStNYXRoLmZsb29yKERhdGUubm93KCkvMWUzKSx0b2tlblR5cGU6aS50b2tlbl90eXBlLHNjb3BlczpvLGF1dGhvcml6ZVVybDpuLmF1dGhvcml6ZVVybCx1c2VyaW5mb1VybDpuLnVzZXJpbmZvVXJsfSksaS5jb2RlJiYoci5jb2RlPXthdXRob3JpemF0aW9uQ29kZTppLmNvZGV9KSxpLmlkX3Rva2VuKXt2YXIgbD10LnRva2VuLmRlY29kZShpLmlkX3Rva2VuKSxjPXtpZFRva2VuOmkuaWRfdG9rZW4sY2xhaW1zOmwucGF5bG9hZCxleHBpcmVzQXQ6bC5wYXlsb2FkLmV4cCxzY29wZXM6byxhdXRob3JpemVVcmw6bi5hdXRob3JpemVVcmwsaXNzdWVyOm4uaXNzdWVyLGNsaWVudElkOmF9O3JldHVybiBzKHQsYyxlLm5vbmNlLCEwKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiByLmlkX3Rva2VuPWMscn0pfXJldHVybiByfSkudGhlbihmdW5jdGlvbih0KXtpZighQXJyYXkuaXNBcnJheShyKSlyZXR1cm4gdFtyXTtpZighdC50b2tlbiYmIXQuaWRfdG9rZW4pdGhyb3cgbmV3IFMoIlVuYWJsZSB0byBwYXJzZSBPQXV0aCBmbG93IHJlc3BvbnNlIik7cmV0dXJuIHIubWFwKGZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfSl9KX1mdW5jdGlvbiB1KHQsZSl7ZT13LmNsb25lKGUpfHx7fSxlLnNjb3BlJiYody5kZXByZWNhdGUoJ1RoZSBwYXJhbSAic2NvcGUiIGlzIGVxdWl2YWxlbnQgdG8gInNjb3BlcyIuIFVzZSAic2NvcGVzIiBpbnN0ZWFkLicpLGUuc2NvcGVzPWUuc2NvcGUsZGVsZXRlIGUuc2NvcGUpO3ZhciBpPXtjbGllbnRJZDp0Lm9wdGlvbnMuY2xpZW50SWQscmVkaXJlY3RVcmk6dC5vcHRpb25zLnJlZGlyZWN0VXJpfHx3aW5kb3cubG9jYXRpb24uaHJlZixyZXNwb25zZVR5cGU6ImlkX3Rva2VuIixyZXNwb25zZU1vZGU6Im9rdGFfcG9zdF9tZXNzYWdlIixzdGF0ZTp3LmdlblJhbmRvbVN0cmluZyg2NCksbm9uY2U6dy5nZW5SYW5kb21TdHJpbmcoNjQpLHNjb3BlczpbIm9wZW5pZCIsImVtYWlsIl19O3JldHVybiB3LmV4dGVuZChpLGUpLGl9ZnVuY3Rpb24gZCh0KXtpZighdC5jbGllbnRJZCl0aHJvdyBuZXcgUygiQSBjbGllbnRJZCBtdXN0IGJlIHNwZWNpZmllZCBpbiB0aGUgT2t0YUF1dGggY29uc3RydWN0b3IgdG8gZ2V0IGEgdG9rZW4iKTtpZih3LmlzU3RyaW5nKHQucmVzcG9uc2VUeXBlKSYmdC5yZXNwb25zZVR5cGUuaW5kZXhPZigiICIpIT09LTEpdGhyb3cgbmV3IFMoIk11bHRpcGxlIE9BdXRoIHJlc3BvbnNlVHlwZXMgbXVzdCBiZSBkZWZpbmVkIGFzIGFuIGFycmF5Iik7dmFyIGU9dy5yZW1vdmVOaWxzKHtjbGllbnRfaWQ6dC5jbGllbnRJZCxyZWRpcmVjdF91cmk6dC5yZWRpcmVjdFVyaSxyZXNwb25zZV90eXBlOnQucmVzcG9uc2VUeXBlLHJlc3BvbnNlX21vZGU6dC5yZXNwb25zZU1vZGUsc3RhdGU6dC5zdGF0ZSxub25jZTp0Lm5vbmNlLHByb21wdDp0LnByb21wdCxkaXNwbGF5OnQuZGlzcGxheSxzZXNzaW9uVG9rZW46dC5zZXNzaW9uVG9rZW4saWRwOnQuaWRwLG1heF9hZ2U6dC5tYXhBZ2V9KTtpZihBcnJheS5pc0FycmF5KGUucmVzcG9uc2VfdHlwZSkmJihlLnJlc3BvbnNlX3R5cGU9ZS5yZXNwb25zZV90eXBlLmpvaW4oIiAiKSksdC5yZXNwb25zZVR5cGUuaW5kZXhPZigiaWRfdG9rZW4iKSE9PS0xJiZ0LnNjb3Blcy5pbmRleE9mKCJvcGVuaWQiKT09PS0xKXRocm93IG5ldyBTKCJvcGVuaWQgc2NvcGUgbXVzdCBiZSBzcGVjaWZpZWQgaW4gdGhlIHNjb3BlcyBhcmd1bWVudCB3aGVuIHJlcXVlc3RpbmcgYW4gaWRfdG9rZW4iKTtyZXR1cm4gZS5zY29wZT10LnNjb3Blcy5qb2luKCIgIiksZX1mdW5jdGlvbiBoKHQpe3ZhciBlPWQodCk7cmV0dXJuIHcudG9RdWVyeVBhcmFtcyhlKX1mdW5jdGlvbiBwKHQsZSxpKXtmdW5jdGlvbiBuKHQpe3ZhciBlPS9eKGh0dHBzP1w6XC9cLyk/KFteOlwvPyNdKig/Olw6WzAtOV0rKT8pLztyZXR1cm4gZS5leGVjKHQpWzBdfWZ1bmN0aW9uIHIodCl7dC5jbG9zZWQmJkUucmVqZWN0KG5ldyBTKCJVbmFibGUgdG8gcGFyc2UgT0F1dGggZmxvdyByZXNwb25zZSIpKX1lPWV8fHt9LGk9aXx8e307dmFyIHM9dSh0LGUpLG89e3Byb21wdDoibm9uZSIscmVzcG9uc2VNb2RlOiJva3RhX3Bvc3RfbWVzc2FnZSIsZGlzcGxheTpudWxsfSxkPXtkaXNwbGF5OiJwb3B1cCJ9O2Uuc2Vzc2lvblRva2VuP3cuZXh0ZW5kKHMsbyk6ZS5pZHAmJncuZXh0ZW5kKHMsZCk7dmFyIHAsZjt0cnl7Zj1NLmdldE9BdXRoVXJscyh0LHMsaSkscD1mLmF1dGhvcml6ZVVybCtoKHMpfWNhdGNoKG0pe3JldHVybiBrLnJlamVjdChtKX12YXIgXztzd2l0Y2goXz1zLnNlc3Npb25Ub2tlbnx8bnVsbD09PXMuZGlzcGxheT8iSUZSQU1FIjoicG9wdXAiPT09cy5kaXNwbGF5PyJQT1BVUCI6IklNUExJQ0lUIil7Y2FzZSJJRlJBTUUiOnZhciBnPWEodCxpLnRpbWVvdXQscy5zdGF0ZSksdj1NLmxvYWRGcmFtZShwKTtyZXR1cm4gZy50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBjKHQscyxlLGYpfSkuZmluKGZ1bmN0aW9uKCl7ZG9jdW1lbnQuYm9keS5jb250YWlucyh2KSYmdi5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHYpfSk7Y2FzZSJQT1BVUCI6dmFyIHk7aWYoIm9rdGFfcG9zdF9tZXNzYWdlIj09PXMucmVzcG9uc2VNb2RlKXtpZighdC5mZWF0dXJlcy5pc1BvcHVwUG9zdE1lc3NhZ2VTdXBwb3J0ZWQoKSlyZXR1cm4gay5yZWplY3QobmV3IFMoIlRoaXMgYnJvd3NlciBkb2Vzbid0IGhhdmUgZnVsbCBwb3N0TWVzc2FnZSBzdXBwb3J0IikpO3k9YSh0LGkudGltZW91dCxzLnN0YXRlKX12YXIgYj17cG9wdXBUaXRsZTppLnBvcHVwVGl0bGV9LFQ9TS5sb2FkUG9wdXAocCxiKTtpZigiZnJhZ21lbnQiPT09cy5yZXNwb25zZU1vZGUpe3ZhciBMPW4odC5pZFRva2VuLmF1dGhvcml6ZS5fZ2V0TG9jYXRpb25IcmVmKCkpLHg9bihzLnJlZGlyZWN0VXJpKTtpZihMIT09eClyZXR1cm4gay5yZWplY3QobmV3IFMoIlVzaW5nIGZyYWdtZW50LCB0aGUgcmVkaXJlY3RVcmkgb3JpZ2luICgiK3grIikgbXVzdCBtYXRjaCB0aGUgb3JpZ2luIG9mIHRoaXMgcGFnZSAoIitMKyIpIikpO3k9bCh0LFQsaS50aW1lb3V0KX12YXIgRT1rLmRlZmVyKCksRD1zZXRJbnRlcnZhbChmdW5jdGlvbigpe3IoVCl9LDUwMCk7cmV0dXJuIHkudGhlbihmdW5jdGlvbih0KXtFLnJlc29sdmUodCl9KS5mYWlsKGZ1bmN0aW9uKHQpe0UucmVqZWN0KHQpfSksRS5wcm9taXNlLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGModCxzLGUsZil9KS5maW4oZnVuY3Rpb24oKXtULmNsb3NlZHx8KGNsZWFySW50ZXJ2YWwoRCksVC5jbG9zZSgpKX0pO2RlZmF1bHQ6cmV0dXJuIGsucmVqZWN0KG5ldyBTKCJUaGUgZnVsbCBwYWdlIHJlZGlyZWN0IGZsb3cgaXMgbm90IHN1cHBvcnRlZCIpKX19ZnVuY3Rpb24gZih0LGUsaSl7dmFyIG49dy5jbG9uZShlKXx8e307cmV0dXJuIHcuZXh0ZW5kKG4se3Byb21wdDoibm9uZSIscmVzcG9uc2VNb2RlOiJva3RhX3Bvc3RfbWVzc2FnZSIsZGlzcGxheTpudWxsfSkscCh0LG4saSl9ZnVuY3Rpb24gbSh0LGUsaSl7dmFyIG49dy5jbG9uZShlKXx8e307cmV0dXJuIHcuZXh0ZW5kKG4se2Rpc3BsYXk6InBvcHVwIn0pLHAodCxuLGkpfWZ1bmN0aW9uIF8odCxlLGkpe2U9dy5jbG9uZShlKXx8e307dmFyIG49dSh0LGUpO2lmKCFlLnJlc3BvbnNlTW9kZSl7dmFyIHI9bi5yZXNwb25zZVR5cGU7ci5pbmRleE9mKCJjb2RlIikhPT0tMSYmKHcuaXNTdHJpbmcocil8fEFycmF5LmlzQXJyYXkocikmJjE9PT1yLmxlbmd0aCk/dy5leHRlbmQobix7cmVzcG9uc2VNb2RlOiJxdWVyeSJ9KTp3LmV4dGVuZChuLHtyZXNwb25zZU1vZGU6ImZyYWdtZW50In0pfXZhciBzPU0uZ2V0T0F1dGhVcmxzKHQsbixpKSxvPXMuYXV0aG9yaXplVXJsK2gobik7RS5zZXRDb29raWUoeC5SRURJUkVDVF9PQVVUSF9QQVJBTVNfQ09PS0lFX05BTUUsSlNPTi5zdHJpbmdpZnkoe3Jlc3BvbnNlVHlwZTpuLnJlc3BvbnNlVHlwZSxzdGF0ZTpuLnN0YXRlLG5vbmNlOm4ubm9uY2Usc2NvcGVzOm4uc2NvcGVzLHVybHM6c30pKSxFLnNldENvb2tpZSh4LlJFRElSRUNUX05PTkNFX0NPT0tJRV9OQU1FLG4ubm9uY2UpLEUuc2V0Q29va2llKHguUkVESVJFQ1RfU1RBVEVfQ09PS0lFX05BTUUsbi5zdGF0ZSksdC50b2tlbi5nZXRXaXRoUmVkaXJlY3QuX3NldExvY2F0aW9uKG8pfWZ1bmN0aW9uIGcodCxlKXtpZighTS5pc1Rva2VuKGUpKXJldHVybiBrLnJlamVjdChuZXcgUygiUmVmcmVzaCBtdXN0IGJlIHBhc3NlZCBhIHRva2VuIHdpdGggYW4gYXJyYXkgb2Ygc2NvcGVzIGFuZCBhbiBhY2Nlc3NUb2tlbiBvciBpZFRva2VuIikpO3ZhciBpO3JldHVybiBpPWUuYWNjZXNzVG9rZW4/InRva2VuIjoiaWRfdG9rZW4iLHQudG9rZW4uZ2V0V2l0aG91dFByb21wdCh7cmVzcG9uc2VUeXBlOmksc2NvcGVzOmUuc2NvcGVzfSx7YXV0aG9yaXplVXJsOmUuYXV0aG9yaXplVXJsLHVzZXJpbmZvVXJsOmUudXNlcmluZm9VcmwsaXNzdWVyOmUuaXNzdWVyfSl9ZnVuY3Rpb24gdih0LGUpe3ZhciBpPXQudG9rZW4ucGFyc2VGcm9tVXJsLl9nZXRMb2NhdGlvbkhhc2goKTtlJiYoaT1lLnN1YnN0cmluZyhlLmluZGV4T2YoIiMiKSkpO3ZhciBuPUUuZ2V0Q29va2llKHguUkVESVJFQ1RfT0FVVEhfUEFSQU1TX0NPT0tJRV9OQU1FKTtpZighaXx8IW4pcmV0dXJuIGsucmVqZWN0KG5ldyBTKCJVbmFibGUgdG8gcGFyc2UgYSB0b2tlbiBmcm9tIHRoZSB1cmwiKSk7dHJ5e3ZhciByPUpTT04ucGFyc2Uobikscz1yLnVybHM7ZGVsZXRlIHIudXJscyxFLmRlbGV0ZUNvb2tpZSh4LlJFRElSRUNUX09BVVRIX1BBUkFNU19DT09LSUVfTkFNRSl9Y2F0Y2gobyl7cmV0dXJuIGsucmVqZWN0KG5ldyBTKCJVbmFibGUgdG8gcGFyc2UgdGhlICIreC5SRURJUkVDVF9PQVVUSF9QQVJBTVNfQ09PS0lFX05BTUUrIiBjb29raWU6ICIrby5tZXNzYWdlKSl9cmV0dXJuIGsucmVzb2x2ZShNLmhhc2hUb09iamVjdChpKSkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gYyh0LHIsZSxzKX0pfWZ1bmN0aW9uIHkodCxlKXtyZXR1cm4gZSYmKE0uaXNUb2tlbihlKXx8ZS5hY2Nlc3NUb2tlbnx8ZS51c2VyaW5mb1VybCk/Yi5odHRwUmVxdWVzdCh0LHt1cmw6ZS51c2VyaW5mb1VybCxtZXRob2Q6IkdFVCIsYWNjZXNzVG9rZW46ZS5hY2Nlc3NUb2tlbn0pLmZhaWwoZnVuY3Rpb24odCl7aWYodC54aHImJig0MDE9PT10Lnhoci5zdGF0dXN8fDQwMz09PXQueGhyLnN0YXR1cykpe3ZhciBlPXQueGhyLmdldFJlc3BvbnNlSGVhZGVyKCJXV1ctQXV0aGVudGljYXRlIik7aWYoZSl7dmFyIGk9ZS5tYXRjaCgvZXJyb3I9IiguKj8pIi8pfHxbXSxuPWUubWF0Y2goL2Vycm9yX2Rlc2NyaXB0aW9uPSIoLio/KSIvKXx8W10scj1pWzFdLHM9blsxXTtyJiZzJiYodD1uZXcgTChyLHMpKX19dGhyb3cgdH0pOmsucmVqZWN0KG5ldyBTKCJnZXRVc2VySW5mbyByZXF1aXJlcyBhbiBhY2Nlc3MgdG9rZW4gb2JqZWN0IikpfXZhciBiPWkoMTUpLHc9aSgxMyksTT1pKDI2KSxrPWkoMjEpLFQ9aSgyNyksUz1pKDE5KSxMPWkoMjgpLHg9aSgyMCksRT1pKDE2KTt0LmV4cG9ydHM9e2dldFRva2VuOnAsZ2V0V2l0aG91dFByb21wdDpmLGdldFdpdGhQb3B1cDptLGdldFdpdGhSZWRpcmVjdDpfLHBhcnNlRnJvbVVybDp2LHJlZnJlc2hJZFRva2VuOm8sZGVjb2RlVG9rZW46bix2ZXJpZnlJZFRva2VuOnIscmVmcmVzaFRva2VuOmcsZ2V0VXNlckluZm86eSx2ZXJpZnlUb2tlbjpzfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7cmV0dXJuISghdHx8IXQuYWNjZXNzVG9rZW4mJiF0LmlkVG9rZW58fCFBcnJheS5pc0FycmF5KHQuc2NvcGVzKSl9ZnVuY3Rpb24gcih0LGUsaSl7dC5hZGRFdmVudExpc3RlbmVyP3QuYWRkRXZlbnRMaXN0ZW5lcihlLGkpOnQuYXR0YWNoRXZlbnQoIm9uIitlLGkpfWZ1bmN0aW9uIHModCxlLGkpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcj90LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpKTp0LmRldGFjaEV2ZW50KCJvbiIrZSxpKX1mdW5jdGlvbiBvKHQpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpO3JldHVybiBlLnN0eWxlLmRpc3BsYXk9Im5vbmUiLGUuc3JjPXQsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKX1mdW5jdGlvbiBhKHQsZSl7dmFyIGk9ZS5wb3B1cFRpdGxlfHwiRXh0ZXJuYWwgSWRlbnRpdHkgUHJvdmlkZXIgVXNlciBBdXRoZW50aWNhdGlvbiIsbj0idG9vbGJhcj1ubywgc2Nyb2xsYmFycz15ZXMsIHJlc2l6YWJsZT15ZXMsIHRvcD0xMDAsIGxlZnQ9NTAwLCB3aWR0aD02MDAsIGhlaWdodD02MDAiO3JldHVybiB3aW5kb3cub3Blbih0LGksbil9ZnVuY3Rpb24gbCh0LGUpe3JldHVybiBwLmdldCh0LChlfHx0Lm9wdGlvbnMudXJsKSsiLy53ZWxsLWtub3duL29wZW5pZC1jb25maWd1cmF0aW9uIix7Y2FjaGVSZXNwb25zZTohMH0pfWZ1bmN0aW9uIGModCxlLGkpe3JldHVybiBsKHQsZSkudGhlbihmdW5jdGlvbihlKXt2YXIgbj1lLmp3a3NfdXJpLHI9Zy5nZXRTdG9yYWdlKCkscz1yW25dO2lmKHMmJkRhdGUubm93KCkvMWUzPHMuZXhwaXJlc0F0KXt2YXIgbz1mLmZpbmQocy5yZXNwb25zZS5rZXlzLHtraWQ6aX0pO2lmKG8pcmV0dXJuIG99cmV0dXJuIGcuY2xlYXJTdG9yYWdlKG4pLHAuZ2V0KHQsbix7Y2FjaGVSZXNwb25zZTohMH0pLnRoZW4oZnVuY3Rpb24odCl7dmFyIGU9Zi5maW5kKHQua2V5cyx7a2lkOml9KTtpZihlKXJldHVybiBlO3Rocm93IG5ldyBfKCJUaGUga2V5IGlkLCAiK2krIiwgd2FzIG5vdCBmb3VuZCBpbiB0aGUgc2VydmVyJ3Mga2V5cyIpfSl9KX1mdW5jdGlvbiB1KHQsZSxpLG4scil7aWYoIWV8fCFufHwhaSl0aHJvdyBuZXcgXygiVGhlIGp3dCwgaXNzLCBhbmQgYXVkIGFyZ3VtZW50cyBhcmUgYWxsIHJlcXVpcmVkIik7aWYociYmZS5ub25jZSE9PXIpdGhyb3cgbmV3IF8oIk9BdXRoIGZsb3cgcmVzcG9uc2Ugbm9uY2UgZG9lc24ndCBtYXRjaCByZXF1ZXN0IG5vbmNlIik7dmFyIHM9TWF0aC5mbG9vcigobmV3IERhdGUpLmdldFRpbWUoKS8xZTMpO2lmKGUuaXNzIT09bil0aHJvdyBuZXcgXygiVGhlIGlzc3VlciBbIitlLmlzcysiXSBkb2VzIG5vdCBtYXRjaCBbIituKyJdIik7aWYoZS5hdWQhPT1pKXRocm93IG5ldyBfKCJUaGUgYXVkaWVuY2UgWyIrZS5hdWQrIl0gZG9lcyBub3QgbWF0Y2ggWyIraSsiXSIpO2lmKGUuaWF0PmUuZXhwKXRocm93IG5ldyBfKCJUaGUgSldUIGV4cGlyZWQgYmVmb3JlIGl0IHdhcyBpc3N1ZWQiKTtpZihzLXQub3B0aW9ucy5tYXhDbG9ja1NrZXc+ZS5leHApdGhyb3cgbmV3IF8oIlRoZSBKV1QgZXhwaXJlZCBhbmQgaXMgbm8gbG9uZ2VyIHZhbGlkIik7aWYoZS5pYXQ+cyt0Lm9wdGlvbnMubWF4Q2xvY2tTa2V3KXRocm93IG5ldyBfKCJUaGUgSldUIHdhcyBpc3N1ZWQgaW4gdGhlIGZ1dHVyZSIpfWZ1bmN0aW9uIGQodCxlLGkpe2k9aXx8e307dmFyIG49Zi5yZW1vdmVUcmFpbGluZ1NsYXNoKGkuYXV0aG9yaXplVXJsKXx8dC5vcHRpb25zLmF1dGhvcml6ZVVybCxyPWYucmVtb3ZlVHJhaWxpbmdTbGFzaChpLmlzc3Vlcil8fHQub3B0aW9ucy5pc3N1ZXIscz1mLnJlbW92ZVRyYWlsaW5nU2xhc2goaS51c2VyaW5mb1VybCl8fHQub3B0aW9ucy51c2VyaW5mb1VybDtpZihyJiYhL15odHRwcz86Ly50ZXN0KHIpJiYocj10Lm9wdGlvbnMudXJsKyIvb2F1dGgyLyIrciksIXImJm4mJmUucmVzcG9uc2VUeXBlLmluZGV4T2YoImlkX3Rva2VuIikhPT0tMSl0aHJvdyBuZXcgXygiQ2Fubm90IHJlcXVlc3QgaWRUb2tlbiB3aXRoIGFuIGF1dGhvcml6ZVVybCB3aXRob3V0IGFuIGlzc3VlciIpO2lmKCFyJiZlLnJlc3BvbnNlVHlwZS5pbmRleE9mKCJ0b2tlbiIpIT09LTEpe2lmKG4mJiFzKXRocm93IG5ldyBfKCJDYW5ub3QgcmVxdWVzdCBhY2Nlc3NUb2tlbiB3aXRoIGFuIGF1dGhvcml6ZVVybCB3aXRob3V0IGFuIGlzc3VlciBvciB1c2VyaW5mb1VybCIpO2lmKHMmJiFuKXRocm93IG5ldyBfKCJDYW5ub3QgcmVxdWVzdCB0b2tlbiB3aXRoIGFuIHVzZXJpbmZvVXJsIHdpdGhvdXQgYW4gaXNzdWVyIG9yIGF1dGhvcml6ZVVybCIpfXZhciBvPW5ldyBSZWdFeHAoIl5odHRwcz86Ly8uKj8vb2F1dGgyLy4rIik7cmV0dXJuIHI9cnx8dC5vcHRpb25zLnVybCxvLnRlc3Qocik/KG49bnx8cisiL3YxL2F1dGhvcml6ZSIscz1zfHxyKyIvdjEvdXNlcmluZm8iKToobj1ufHxyKyIvb2F1dGgyL3YxL2F1dGhvcml6ZSIscz1zfHxyKyIvb2F1dGgyL3YxL3VzZXJpbmZvIikse2lzc3VlcjpyLGF1dGhvcml6ZVVybDpuLHVzZXJpbmZvVXJsOnN9fWZ1bmN0aW9uIGgodCl7Zm9yKHZhciBlLGk9L1wrL2csbj0vKFteJj1dKyk9PyhbXiZdKikvZyxyPXQuc3Vic3RyaW5nKDEpLHM9e307Oyl7aWYoZT1uLmV4ZWMociksIWUpYnJlYWs7dmFyIG89ZVsxXSxhPWVbMl07ImlkX3Rva2VuIj09PW98fCJhY2Nlc3NfdG9rZW4iPT09b3x8ImNvZGUiPT09bz9zW29dPWE6c1tvXT1kZWNvZGVVUklDb21wb25lbnQoYS5yZXBsYWNlKGksIiAiKSl9cmV0dXJuIHN9dmFyIHA9aSgxNSksZj1pKDEzKSxtPWkoMTcpLF89aSgxOSksZz1tLmdldEh0dHBDYWNoZSgpO3QuZXhwb3J0cz17Z2V0V2VsbEtub3duOmwsZ2V0S2V5OmMsdmFsaWRhdGVDbGFpbXM6dSxnZXRPQXV0aFVybHM6ZCxsb2FkRnJhbWU6byxsb2FkUG9wdXA6YSxoYXNoVG9PYmplY3Q6aCxpc1Rva2VuOm4sYWRkTGlzdGVuZXI6cixyZW1vdmVMaXN0ZW5lcjpzfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlKXtlPXIuY2xvbmUoZSk7dmFyIGk9Imp3ayIsbj17bmFtZToiUlNBU1NBLVBLQ1MxLXYxXzUiLGhhc2g6e25hbWU6IlNIQS0yNTYifX0scz0hMCxvPVsidmVyaWZ5Il07cmV0dXJuIGRlbGV0ZSBlLnVzZSxjcnlwdG8uc3VidGxlLmltcG9ydEtleShpLGUsbixzLG8pLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9dC5zcGxpdCgiLiIpLHM9ci5zdHJpbmdUb0J1ZmZlcihpWzBdKyIuIitpWzFdKSxvPXIuYmFzZTY0VXJsRGVjb2RlKGlbMl0pLGE9ci5zdHJpbmdUb0J1ZmZlcihvKTtyZXR1cm4gY3J5cHRvLnN1YnRsZS52ZXJpZnkobixlLGEscyl9KX12YXIgcj1pKDEzKTt0LmV4cG9ydHM9e3ZlcmlmeVRva2VuOm59fSxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCxlKXt0aGlzLm5hbWU9Ik9BdXRoRXJyb3IiLHRoaXMubWVzc2FnZT1lLHRoaXMuZXJyb3JDb2RlPXQsdGhpcy5lcnJvclN1bW1hcnk9ZX1pLnByb3RvdHlwZT1uZXcgRXJyb3IsdC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSxpKXt0LmVtaXR0ZXIuZW1pdCgiZXhwaXJlZCIsZSxpKX1mdW5jdGlvbiByKHQsZSl7Y2xlYXJUaW1lb3V0KHQucmVmcmVzaFRpbWVvdXRzW2VdKSxkZWxldGUgdC5yZWZyZXNoVGltZW91dHNbZV19ZnVuY3Rpb24gcyh0KXt2YXIgZT10LnJlZnJlc2hUaW1lb3V0cztmb3IodmFyIGkgaW4gZSllLmhhc093blByb3BlcnR5KGkpJiZyKHQsaSk7dC5yZWZyZXNoVGltZW91dHM9e319ZnVuY3Rpb24gbyh0LGUsaSxzLG8pe3ZhciBhPTFlMypvLmV4cGlyZXNBdC1EYXRlLm5vdygpO2E8MCYmKGE9MCk7dmFyIGw9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBlLmF1dG9SZWZyZXNoP2QodCxlLGkscyk6dm9pZCgxZTMqby5leHBpcmVzQXQ8PURhdGUubm93KCkmJih1KGUsaSxzKSxuKGUscyxvKSkpfSxhKTtyKGUscyksZS5yZWZyZXNoVGltZW91dHNbc109bH1mdW5jdGlvbiBhKHQsZSxpKXt0cnl7dmFyIG49aS5nZXRTdG9yYWdlKCl9Y2F0Y2gocil7cmV0dXJuIHZvaWQgZS5lbWl0dGVyLmVtaXQoImVycm9yIixyKX1mb3IodmFyIHMgaW4gbilpZihuLmhhc093blByb3BlcnR5KHMpKXt2YXIgYT1uW3NdO28odCxlLGkscyxhKX19ZnVuY3Rpb24gbCh0LGUsaSxuLHIpe3ZhciBzPWkuZ2V0U3RvcmFnZSgpO2lmKCFmLmlzT2JqZWN0KHIpfHwhci5zY29wZXN8fCFyLmV4cGlyZXNBdCYmMCE9PXIuZXhwaXJlc0F0fHwhci5pZFRva2VuJiYhci5hY2Nlc3NUb2tlbil0aHJvdyBuZXcgbSgiVG9rZW4gbXVzdCBiZSBhbiBPYmplY3Qgd2l0aCBzY29wZXMsIGV4cGlyZXNBdCwgYW5kIGFuIGlkVG9rZW4gb3IgYWNjZXNzVG9rZW4gcHJvcGVydGllcyIpO3Nbbl09cixpLnNldFN0b3JhZ2Uocyksbyh0LGUsaSxuLHIpfWZ1bmN0aW9uIGModCxlKXt2YXIgaT10LmdldFN0b3JhZ2UoKTtyZXR1cm4gaVtlXX1mdW5jdGlvbiB1KHQsZSxpKXtyKHQsaSk7dmFyIG49ZS5nZXRTdG9yYWdlKCk7ZGVsZXRlIG5baV0sZS5zZXRTdG9yYWdlKG4pfWZ1bmN0aW9uIGQodCxlLGkscyl7dHJ5e3ZhciBvPWMoaSxzKTtpZighbyl0aHJvdyBuZXcgbSgiVGhlIHRva2VuTWFuYWdlciBoYXMgbm8gdG9rZW4gZm9yIHRoZSBrZXk6ICIrcyl9Y2F0Y2goYSl7cmV0dXJuIGcucmVqZWN0KGEpfXJldHVybiByKGUscyksdC50b2tlbi5yZWZyZXNoKG8pLnRoZW4oZnVuY3Rpb24obil7cmV0dXJuIGwodCxlLGkscyxuKSxlLmVtaXR0ZXIuZW1pdCgicmVmcmVzaGVkIixzLG4sbyksbn0pLmZhaWwoZnVuY3Rpb24odCl7dGhyb3ciT0F1dGhFcnJvciI9PT10Lm5hbWUmJih1KGUsaSxzKSxuKGUscyxvKSksdH0pfWZ1bmN0aW9uIGgodCxlKXtzKHQpLGUuY2xlYXJTdG9yYWdlKCl9ZnVuY3Rpb24gcCh0LGUpe2U9ZXx8e30sZS5zdG9yYWdlPWUuc3RvcmFnZXx8ImxvY2FsU3RvcmFnZSIsZS5hdXRvUmVmcmVzaHx8ZS5hdXRvUmVmcmVzaD09PSExfHwoZS5hdXRvUmVmcmVzaD0hMCksImxvY2FsU3RvcmFnZSIhPT1lLnN0b3JhZ2V8fF8uYnJvd3Nlckhhc0xvY2FsU3RvcmFnZSgpfHwoZi53YXJuKCJUaGlzIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGxvY2FsU3RvcmFnZS4gU3dpdGNoaW5nIHRvIHNlc3Npb25TdG9yYWdlLiIpLGUuc3RvcmFnZT0ic2Vzc2lvblN0b3JhZ2UiKSwic2Vzc2lvblN0b3JhZ2UiIT09ZS5zdG9yYWdlfHxfLmJyb3dzZXJIYXNTZXNzaW9uU3RvcmFnZSgpfHwoZi53YXJuKCJUaGlzIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IHNlc3Npb25TdG9yYWdlLiBTd2l0Y2hpbmcgdG8gY29va2llLWJhc2VkIHN0b3JhZ2UuIiksZS5zdG9yYWdlPSJjb29raWUiKTt2YXIgaTtzd2l0Y2goZS5zdG9yYWdlKXtjYXNlImxvY2FsU3RvcmFnZSI6aT1iKGxvY2FsU3RvcmFnZSx5LlRPS0VOX1NUT1JBR0VfTkFNRSk7YnJlYWs7Y2FzZSJzZXNzaW9uU3RvcmFnZSI6aT1iKHNlc3Npb25TdG9yYWdlLHkuVE9LRU5fU1RPUkFHRV9OQU1FKTticmVhaztjYXNlImNvb2tpZSI6aT1iKF8uZ2V0Q29va2llU3RvcmFnZSgpLHkuVE9LRU5fU1RPUkFHRV9OQU1FKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBtKCJVbnJlY29nbml6ZWQgc3RvcmFnZSBvcHRpb24iKX12YXIgbj17ZW1pdHRlcjpuZXcgdixhdXRvUmVmcmVzaDplLmF1dG9SZWZyZXNoLHJlZnJlc2hUaW1lb3V0czp7fX07dGhpcy5hZGQ9Zi5iaW5kKGwsdGhpcyx0LG4saSksdGhpcy5nZXQ9Zi5iaW5kKGMsdGhpcyxpKSx0aGlzLnJlbW92ZT1mLmJpbmQodSx0aGlzLG4saSksdGhpcy5jbGVhcj1mLmJpbmQoaCx0aGlzLG4saSksdGhpcy5yZWZyZXNoPWYuYmluZChkLHRoaXMsdCxuLGkpLHRoaXMub249Zi5iaW5kKG4uZW1pdHRlci5vbixuLmVtaXR0ZXIpLHRoaXMub2ZmPWYuYmluZChuLmVtaXR0ZXIub2ZmLG4uZW1pdHRlciksYSh0LG4saSl9dmFyIGY9aSgxMyksbT1pKDE5KSxfPWkoMTcpLGc9aSgyMSksdj1pKDMwKSx5PWkoMjApLGI9aSgxOCk7dC5leHBvcnRzPXB9LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSgpe31pLnByb3RvdHlwZT17b246ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuZXx8KHRoaXMuZT17fSk7cmV0dXJuKG5bdF18fChuW3RdPVtdKSkucHVzaCh7Zm46ZSxjdHg6aX0pLHRoaXN9LG9uY2U6ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4oKXtyLm9mZih0LG4pLGUuYXBwbHkoaSxhcmd1bWVudHMpfXZhciByPXRoaXM7cmV0dXJuIG4uXz1lLHRoaXMub24odCxuLGkpfSxlbWl0OmZ1bmN0aW9uKHQpe3ZhciBlPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLGk9KCh0aGlzLmV8fCh0aGlzLmU9e30pKVt0XXx8W10pLnNsaWNlKCksbj0wLHI9aS5sZW5ndGg7Zm9yKG47bjxyO24rKylpW25dLmZuLmFwcGx5KGlbbl0uY3R4LGUpO3JldHVybiB0aGlzfSxvZmY6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmV8fCh0aGlzLmU9e30pLG49aVt0XSxyPVtdO2lmKG4mJmUpZm9yKHZhciBzPTAsbz1uLmxlbmd0aDtzPG87cysrKW5bc10uZm4hPT1lJiZuW3NdLmZuLl8hPT1lJiZyLnB1c2gobltzXSk7cmV0dXJuIHIubGVuZ3RoP2lbdF09cjpkZWxldGUgaVt0XSx0aGlzfX0sdC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpXSxyPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCl7Zm9yKHZhciBlPVt0XSxpPXQuc3BsaXQoIi0iKTtpLnBvcCgpJiZpLmxlbmd0aD4wOyllLnB1c2goaS5qb2luKCItIikpO3JldHVybiBlfXZhciBpPXt9LG49dC5fO3JldHVybiBpLmhhc1Rva2Vuc0luSGFzaD1mdW5jdGlvbih0KXtyZXR1cm4vKChpZHxhY2Nlc3MpX3Rva2VuPSkvaS50ZXN0KHQpfSxpLnRyYW5zZm9ybUVycm9yWEhSPWZ1bmN0aW9uKGUpe2lmKDA9PT1lLnN0YXR1cyYmbi5pc0VtcHR5KGUucmVzcG9uc2VKU09OKSlyZXR1cm4gZS5yZXNwb25zZUpTT049e2Vycm9yU3VtbWFyeTp0LmxvYygiZXJyb3IubmV0d29yay5jb25uZWN0aW9uIiwibG9naW4iKX0sZTtpZighZS5yZXNwb25zZUpTT04pdHJ5e2UucmVzcG9uc2VKU09OPUpTT04ucGFyc2UoZS5yZXNwb25zZVRleHQpfWNhdGNoKGkpe3JldHVybiBlLnJlc3BvbnNlSlNPTj17ZXJyb3JTdW1tYXJ5OnQubG9jKCJvZm9ybS5lcnJvci51bmV4cGVjdGVkIiwibG9naW4iKX0sZX1pZihlLnJlc3BvbnNlSlNPTiYmZS5yZXNwb25zZUpTT04uZXJyb3JDYXVzZXMmJmUucmVzcG9uc2VKU09OLmVycm9yQ2F1c2VzLmxlbmd0aCYmKGUucmVzcG9uc2VKU09OLmVycm9yU3VtbWFyeT1lLnJlc3BvbnNlSlNPTi5lcnJvckNhdXNlc1swXS5lcnJvclN1bW1hcnkpLCFuLmlzRW1wdHkoZS5yZXNwb25zZUpTT04pKXt2YXIgcj10LmxvYygiZXJyb3JzLiIrZS5yZXNwb25zZUpTT04uZXJyb3JDb2RlLCJsb2dpbiIpO3IuaW5kZXhPZigiTDEwTl9FUlJPUlsiKT09PS0xJiYoZS5yZXNwb25zZUpTT04uZXJyb3JTdW1tYXJ5PXIpOwoJfXJldHVybiBlfSxpLnRvTG93ZXI9ZnVuY3Rpb24odCl7cmV0dXJuIG4ubWFwKHQsZnVuY3Rpb24odCl7cmV0dXJuIHQudG9Mb3dlckNhc2UoKX0pfSxpLmV4cGFuZExhbmd1YWdlcz1mdW5jdGlvbih0KXtyZXR1cm4gbi5jaGFpbih0KS5tYXAoZSkuZmxhdHRlbigpLnVuaXEoKS52YWx1ZSgpfSxpLmNhbGxBZnRlclRpbWVvdXQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gc2V0VGltZW91dCh0LGUpfSxpfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDQpLGkoMzYpLGkoMTM2KSxpKDEzOCksaSgzMyksaSgxMzkpLGkoMTQwKSxpKDE0MyksaSgxOTEpLGkoMTM5KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjLHUpe3ZhciBkPWwsaD1jLHA9dTtyZXR1cm57JDp0LF86ZSxtb21lbnQ6bixIYW5kbGViYXJzOmksbG9jOmguU3RyaW5nVXRpbC5sb2NhbGl6ZSxjcmVhdGVCdXR0b246aC5CdXR0b25GYWN0b3J5LmNyZWF0ZSxjcmVhdGVDYWxsb3V0OnAuY29tcG9uZW50cy5DYWxsb3V0LmNyZWF0ZSx0cGw6aC5UZW1wbGF0ZVV0aWwudHBsLE1vZGVsOnIsQmFzZU1vZGVsOnMsQ29sbGVjdGlvbjpvLFZpZXc6cC5CYXNlVmlldyxMaXN0VmlldzpwLkxpc3RWaWV3LFRhYmxlVmlldzpwLlRhYmxlVmlldyxSb3V0ZXI6aC5CYXNlUm91dGVyLFRhYmJlZFJvdXRlcjpoLlRhYmJlZFJvdXRlcixDb250cm9sbGVyOmguQmFzZUNvbnRyb2xsZXIsRGF0YUxpc3RDb250cm9sbGVyOmguRGF0YUxpc3RDb250cm9sbGVyLERhdGFMaXN0OnAuZGF0YWxpc3QuRGVhZFNpbXBsZURhdGFMaXN0LE1vZGFsRGlhbG9nOnAuY29tcG9uZW50cy5CYXNlTW9kYWxEaWFsb2csTXVsdGlWaWV3TW9kYWxEaWFsb2c6cC5jb21wb25lbnRzLk11bHRpVmlld01vZGFsRGlhbG9nLEZvcm06cC5mb3Jtcy5CYXNlRm9ybSxGb3JtRGlhbG9nOnAuY29tcG9uZW50cy5CYXNlRm9ybURpYWxvZyxEcm9wRG93bjpwLmNvbXBvbmVudHMuRHJvcERvd24sV2l6YXJkOmEsTG9nZ2VyOmguTG9nZ2VyLE1ldHJpY3M6aC5NZXRyaWNzLGludGVybmFsOntmcmFtZXdvcms6ZCx1dGlsOmgsdmlld3M6cH19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgzNCldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe3NlY3VyZUpTT046ITEsY29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0LnJlc3VsdCh0aGlzLCJzZWN1cmVKU09OIikmJih0aGlzLnN5bmM9dC53cmFwKHRoaXMuc3luYyxmdW5jdGlvbihlLGksbixyKXtyZXR1cm4gZS5jYWxsKHRoaXMsaSxuLHQuZXh0ZW5kKHtkYXRhVHlwZToic2VjdXJlSlNPTiJ9LHIpKX0pKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOyFmdW5jdGlvbihvLGEpe3I9W2koMiksaSgzNSldLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7dHJ5e3ZhciBpPXMoZS5nZXRSZXNwb25zZUhlYWRlcigibGluayIpKTt0W29dLnNldCh1LCEwKSx0LnNldFBhZ2luYXRpb24oaS5uZXh0LmhyZWYpfWNhdGNoKG4pe3Rbb10uZ2V0KHUpJiZ0LnNldFBhZ2luYXRpb24obnVsbCl9fWZ1bmN0aW9uIG4odCl7Zm9yKHZhciBlPXt9LGk9dCYmdC5zcGxpdCgiPyIpWzFdLG49aSYmZGVjb2RlVVJJQ29tcG9uZW50KGkuc3BsaXQoIiMiKVswXSkucmVwbGFjZSgvXCsvZywiICIpLHI9bj9uLnNwbGl0KCImIik6W10scz0wO3M8ci5sZW5ndGg7cysrKXt2YXIgbz1yW3NdLnNwbGl0KCI9Iik7ZVtvLnNoaWZ0KCldPW8uam9pbigiPSIpfXJldHVybiBlfWZ1bmN0aW9uIHIodCl7cmV0dXJuJyInPT10LmNoYXJBdCgwKSYmJyInPT10LmNoYXJBdCh0Lmxlbmd0aC0xKT90LnN1YnN0cmluZygxLHQubGVuZ3RoLTEpOnR9ZnVuY3Rpb24gcyh0KXtmb3IodmFyIGU9LzxbXj5dKj5ccyooXHMqO1xzKlteXChcKTw+QCw7OiJcL1xbXF1cPz17fSBcdF0rPSgoW15cKFwpPD5ALDs6IlwvXFtcXVw/PXt9IFx0XSspfCgiW14iXSoiKSkpKigsfCQpL2csaT0vW15cKFwpPD5ALDs6IlwvXFtcXVw/PXt9IFx0XSs9KChbXlwoXCk8PkAsOzoiXC9cW1xdXD89e30gXHRdKyl8KCJbXiJdKiIpKS9nLG49dC5tYXRjaChlKSxzPXt9LG89MDtvPG4ubGVuZ3RoO28rKyl7dmFyIGE9bltvXS5zcGxpdCgiPiIpLGw9YVswXS5zdWJzdHJpbmcoMSksYz17fTtjLmhyZWY9bDtmb3IodmFyIHU9YVsxXS5tYXRjaChpKSxkPTA7ZDx1Lmxlbmd0aDtkKyspe3ZhciBoPXVbZF0uc3BsaXQoIj0iKSxwPWhbMF07Y1twXT1yKGhbMV0pfXZvaWQgMCE9PWMucmVsJiYoc1tjLnJlbF09Yyl9cmV0dXJuIHN9dmFyIG89Il9fU1RBVEVfXyIsYT0iRkVUQ0hfREFUQSIsbD0iUEFHSU5BVElPTl9EQVRBIixjPSJERUZBVUxUX1BBUkFNUyIsdT0iTElOS19CWV9IRUFERVIiLGQ9IlhIUiI7cmV0dXJuIGUuQ29sbGVjdGlvbi5leHRlbmQoe3BhcmFtczp7fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihpLG4pe3ZhciByPXRoaXNbb109bmV3IGUuTW9kZWw7ci5zZXQoYyx0LmRlZmF1bHRzKG4mJm4ucGFyYW1zfHx7fSx0aGlzLnBhcmFtc3x8e30pKSxlLkNvbGxlY3Rpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzeW5jOmZ1bmN0aW9uKHQsbixyKXt2YXIgcz10aGlzLG89ci5zdWNjZXNzO3JldHVybiByLnN1Y2Nlc3M9ZnVuY3Rpb24odCxlLG4pe2kocyxuKSxvLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5zeW5jLmNhbGwodGhpcyx0LG4scil9LGZldGNoOmZ1bmN0aW9uKGkpe2l8fChpPXt9KTt2YXIgbj10aGlzW29dLHI9bi5nZXQoZCk7cmV0dXJuIGkuZGF0YT10LmV4dGVuZCh7fSxuLmdldChjKSxpLmRhdGF8fHt9KSxpLmZyb21GZXRjaD0hMCxuLnNldChhLGkuZGF0YSksciYmci5hYm9ydCYmaS5hYm9ydCE9PSExJiZyLmFib3J0KCkscj1lLkNvbGxlY3Rpb24ucHJvdG90eXBlLmZldGNoLmNhbGwodGhpcyxpKSxuLnNldChkLHIpLHJ9LHNldFBhZ2luYXRpb246ZnVuY3Rpb24oZSxpKXt0LmlzU3RyaW5nKGUpJiZlJiYoZT1uKGUpKSx0LmlzT2JqZWN0KGUpJiYhdC5pc0FycmF5KGUpJiZ0LnNpemUoZSk/aSYmaS5mcm9tRmV0Y2gmJihlPXQuZXh0ZW5kKHt9LHRoaXMuZ2V0RmV0Y2hEYXRhKCksZSkpOmU9bnVsbCx0aGlzW29dLnNldChsLGUpfSxnZXRGZXRjaERhdGE6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tvXS5nZXQoYSl8fHt9fSxnZXRQYWdpbmF0aW9uRGF0YTpmdW5jdGlvbigpe3JldHVybiB0aGlzW29dLmdldChsKXx8e319LGhhc01vcmU6ZnVuY3Rpb24oKXtyZXR1cm4gdC5zaXplKHRoaXMuZ2V0UGFnaW5hdGlvbkRhdGEoKSk+MH0sZmV0Y2hNb3JlOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaGFzTW9yZSgpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBSZXF1ZXN0Iik7cmV0dXJuIHRoaXMuZmV0Y2goe2RhdGE6dGhpcy5nZXRQYWdpbmF0aW9uRGF0YSgpLGFkZDohMCxyZW1vdmU6ITEsdXBkYXRlOiEwfSl9LHJlc2V0OmZ1bmN0aW9uKHQsaSl7cmV0dXJuIGl8fChpPXt9KSxpLmZyb21GZXRjaHx8dGhpcy5zZXRQYWdpbmF0aW9uKG51bGwpLGUuQ29sbGVjdGlvbi5wcm90b3R5cGUucmVzZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSx3aGVyZTpmdW5jdGlvbihlLGkpe3JldHVybiB0LmlzRW1wdHkoZSk/aT92b2lkIDA6W106dGhpc1tpPyJmaW5kIjoiZmlsdGVyIl0oZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIGUpaWYoZVtpXSE9PXQuZ2V0KGkpKXJldHVybiExO3JldHVybiEwfSl9LGNyZWF0ZTpmdW5jdGlvbihpLG4pe3JldHVybiBufHwobj17fSksdC5yZXN1bHQoaSwidXJsUm9vdCIpfHwobi51cmw9dC5yZXN1bHQodGhpcywidXJsIikpLGUuQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlLmNhbGwodGhpcyxpLG4pfX0pfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyOyhmdW5jdGlvbihzKXsKCS8vICAgICAoYykgMjAxMC0yMDE1IEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBhbmQgSW52ZXN0aWdhdGl2ZSBSZXBvcnRlcnMgJiBFZGl0b3JzCgkvLyAgICAgQmFja2JvbmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCgkhZnVuY3Rpb24obyl7dmFyIGE9Im9iamVjdCI9PXR5cGVvZiBzZWxmJiZzZWxmLnNlbGY9PXNlbGYmJnNlbGZ8fCJvYmplY3QiPT10eXBlb2YgcyYmcy5nbG9iYWw9PXMmJnM7bj1baSgzKSxpKDYpLGVdLHI9ZnVuY3Rpb24odCxlLGkpe2EuQmFja2JvbmU9byhhLGksdCxlKX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfShmdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10LkJhY2tib25lLHM9W10uc2xpY2U7ZS5WRVJTSU9OPSIxLjIuMSIsZS4kPW4sZS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHQuQmFja2JvbmU9cix0aGlzfSxlLmVtdWxhdGVIVFRQPSExLGUuZW11bGF0ZUpTT049ITE7dmFyIG89ZnVuY3Rpb24odCxlLG4pe3N3aXRjaCh0KXtjYXNlIDE6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGlbZV0odGhpc1tuXSl9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGlbZV0odGhpc1tuXSx0KX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbih0LHIpe3JldHVybiBpW2VdKHRoaXNbbl0sdCxyKX07Y2FzZSA0OnJldHVybiBmdW5jdGlvbih0LHIscyl7cmV0dXJuIGlbZV0odGhpc1tuXSx0LHIscyl9O2RlZmF1bHQ6cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9cy5jYWxsKGFyZ3VtZW50cyk7cmV0dXJuIHQudW5zaGlmdCh0aGlzW25dKSxpW2VdLmFwcGx5KGksdCl9fX0sYT1mdW5jdGlvbih0LGUsbil7aS5lYWNoKGUsZnVuY3Rpb24oZSxyKXtpW3JdJiYodC5wcm90b3R5cGVbcl09byhlLHIsbikpfSl9LGw9ZS5FdmVudHM9e30sYz0vXHMrLyx1PWZ1bmN0aW9uKHQsZSxuLHIscyl7dmFyIG8sYT0wO2lmKG4mJiJvYmplY3QiPT10eXBlb2Ygbil7dm9pZCAwIT09ciYmImNvbnRleHQiaW4gcyYmdm9pZCAwPT09cy5jb250ZXh0JiYocy5jb250ZXh0PXIpO2ZvcihvPWkua2V5cyhuKTthPG8ubGVuZ3RoO2ErKyllPXQoZSxvW2FdLG5bb1thXV0scyl9ZWxzZSBpZihuJiZjLnRlc3QobikpZm9yKG89bi5zcGxpdChjKTthPG8ubGVuZ3RoO2ErKyllPXQoZSxvW2FdLHIscyk7ZWxzZSBlPXQoZSxuLHIscyk7cmV0dXJuIGV9O2wub249ZnVuY3Rpb24odCxlLGkpe3JldHVybiBkKHRoaXMsdCxlLGkpfTt2YXIgZD1mdW5jdGlvbih0LGUsaSxuLHIpe2lmKHQuX2V2ZW50cz11KGgsdC5fZXZlbnRzfHx7fSxlLGkse2NvbnRleHQ6bixjdHg6dCxsaXN0ZW5pbmc6cn0pLHIpe3ZhciBzPXQuX2xpc3RlbmVyc3x8KHQuX2xpc3RlbmVycz17fSk7c1tyLmlkXT1yfXJldHVybiB0fTtsLmxpc3RlblRvPWZ1bmN0aW9uKHQsZSxuKXtpZighdClyZXR1cm4gdGhpczt2YXIgcj10Ll9saXN0ZW5JZHx8KHQuX2xpc3RlbklkPWkudW5pcXVlSWQoImwiKSkscz10aGlzLl9saXN0ZW5pbmdUb3x8KHRoaXMuX2xpc3RlbmluZ1RvPXt9KSxvPXNbcl07aWYoIW8pe3ZhciBhPXRoaXMuX2xpc3RlbklkfHwodGhpcy5fbGlzdGVuSWQ9aS51bmlxdWVJZCgibCIpKTtvPXNbcl09e29iajp0LG9iaklkOnIsaWQ6YSxsaXN0ZW5pbmdUbzpzLGNvdW50OjB9fXJldHVybiBkKHQsZSxuLHRoaXMsbyksdGhpc307dmFyIGg9ZnVuY3Rpb24odCxlLGksbil7aWYoaSl7dmFyIHI9dFtlXXx8KHRbZV09W10pLHM9bi5jb250ZXh0LG89bi5jdHgsYT1uLmxpc3RlbmluZzthJiZhLmNvdW50Kyssci5wdXNoKHtjYWxsYmFjazppLGNvbnRleHQ6cyxjdHg6c3x8byxsaXN0ZW5pbmc6YX0pfXJldHVybiB0fTtsLm9mZj1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX2V2ZW50cz8odGhpcy5fZXZlbnRzPXUocCx0aGlzLl9ldmVudHMsdCxlLHtjb250ZXh0OmksbGlzdGVuZXJzOnRoaXMuX2xpc3RlbmVyc30pLHRoaXMpOnRoaXN9LGwuc3RvcExpc3RlbmluZz1mdW5jdGlvbih0LGUsbil7dmFyIHI9dGhpcy5fbGlzdGVuaW5nVG87aWYoIXIpcmV0dXJuIHRoaXM7Zm9yKHZhciBzPXQ/W3QuX2xpc3RlbklkXTppLmtleXMociksbz0wO288cy5sZW5ndGg7bysrKXt2YXIgYT1yW3Nbb11dO2lmKCFhKWJyZWFrO2Eub2JqLm9mZihlLG4sdGhpcyl9cmV0dXJuIGkuaXNFbXB0eShyKSYmKHRoaXMuX2xpc3RlbmluZ1RvPXZvaWQgMCksdGhpc307dmFyIHA9ZnVuY3Rpb24odCxlLG4scil7aWYodCl7dmFyIHMsbz0wLGE9ci5jb250ZXh0LGw9ci5saXN0ZW5lcnM7aWYoZXx8bnx8YSl7Zm9yKHZhciBjPWU/W2VdOmkua2V5cyh0KTtvPGMubGVuZ3RoO28rKyl7ZT1jW29dO3ZhciB1PXRbZV07aWYoIXUpYnJlYWs7Zm9yKHZhciBkPVtdLGg9MDtoPHUubGVuZ3RoO2grKyl7dmFyIHA9dVtoXTtuJiZuIT09cC5jYWxsYmFjayYmbiE9PXAuY2FsbGJhY2suX2NhbGxiYWNrfHxhJiZhIT09cC5jb250ZXh0P2QucHVzaChwKToocz1wLmxpc3RlbmluZyxzJiYwPT09LS1zLmNvdW50JiYoZGVsZXRlIGxbcy5pZF0sZGVsZXRlIHMubGlzdGVuaW5nVG9bcy5vYmpJZF0pKX1kLmxlbmd0aD90W2VdPWQ6ZGVsZXRlIHRbZV19cmV0dXJuIGkuc2l6ZSh0KT90OnZvaWQgMH1mb3IodmFyIGY9aS5rZXlzKGwpO288Zi5sZW5ndGg7bysrKXM9bFtmW29dXSxkZWxldGUgbFtzLmlkXSxkZWxldGUgcy5saXN0ZW5pbmdUb1tzLm9iaklkXX19O2wub25jZT1mdW5jdGlvbih0LGUsbil7dmFyIHI9dShmLHt9LHQsZSxpLmJpbmQodGhpcy5vZmYsdGhpcykpO3JldHVybiB0aGlzLm9uKHIsdm9pZCAwLG4pfSxsLmxpc3RlblRvT25jZT1mdW5jdGlvbih0LGUsbil7dmFyIHI9dShmLHt9LGUsbixpLmJpbmQodGhpcy5zdG9wTGlzdGVuaW5nLHRoaXMsdCkpO3JldHVybiB0aGlzLmxpc3RlblRvKHQscil9O3ZhciBmPWZ1bmN0aW9uKHQsZSxuLHIpe2lmKG4pe3ZhciBzPXRbZV09aS5vbmNlKGZ1bmN0aW9uKCl7cihlLHMpLG4uYXBwbHkodGhpcyxhcmd1bWVudHMpfSk7cy5fY2FsbGJhY2s9bn1yZXR1cm4gdH07bC50cmlnZ2VyPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLl9ldmVudHMpcmV0dXJuIHRoaXM7Zm9yKHZhciBlPU1hdGgubWF4KDAsYXJndW1lbnRzLmxlbmd0aC0xKSxpPUFycmF5KGUpLG49MDtuPGU7bisrKWlbbl09YXJndW1lbnRzW24rMV07cmV0dXJuIHUobSx0aGlzLl9ldmVudHMsdCx2b2lkIDAsaSksdGhpc307dmFyIG09ZnVuY3Rpb24odCxlLGksbil7aWYodCl7dmFyIHI9dFtlXSxzPXQuYWxsO3ImJnMmJihzPXMuc2xpY2UoKSksciYmXyhyLG4pLHMmJl8ocyxbZV0uY29uY2F0KG4pKX1yZXR1cm4gdH0sXz1mdW5jdGlvbih0LGUpe3ZhciBpLG49LTEscj10Lmxlbmd0aCxzPWVbMF0sbz1lWzFdLGE9ZVsyXTtzd2l0Y2goZS5sZW5ndGgpe2Nhc2UgMDpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5jYWxsKGkuY3R4KTtyZXR1cm47Y2FzZSAxOmZvcig7KytuPHI7KShpPXRbbl0pLmNhbGxiYWNrLmNhbGwoaS5jdHgscyk7cmV0dXJuO2Nhc2UgMjpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5jYWxsKGkuY3R4LHMsbyk7cmV0dXJuO2Nhc2UgMzpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5jYWxsKGkuY3R4LHMsbyxhKTtyZXR1cm47ZGVmYXVsdDpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5hcHBseShpLmN0eCxlKTtyZXR1cm59fTtsLmJpbmQ9bC5vbixsLnVuYmluZD1sLm9mZixpLmV4dGVuZChlLGwpO3ZhciBnPWUuTW9kZWw9ZnVuY3Rpb24odCxlKXt2YXIgbj10fHx7fTtlfHwoZT17fSksdGhpcy5jaWQ9aS51bmlxdWVJZCh0aGlzLmNpZFByZWZpeCksdGhpcy5hdHRyaWJ1dGVzPXt9LGUuY29sbGVjdGlvbiYmKHRoaXMuY29sbGVjdGlvbj1lLmNvbGxlY3Rpb24pLGUucGFyc2UmJihuPXRoaXMucGFyc2UobixlKXx8e30pLG49aS5kZWZhdWx0cyh7fSxuLGkucmVzdWx0KHRoaXMsImRlZmF1bHRzIikpLHRoaXMuc2V0KG4sZSksdGhpcy5jaGFuZ2VkPXt9LHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2kuZXh0ZW5kKGcucHJvdG90eXBlLGwse2NoYW5nZWQ6bnVsbCx2YWxpZGF0aW9uRXJyb3I6bnVsbCxpZEF0dHJpYnV0ZToiaWQiLGNpZFByZWZpeDoiYyIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiBpLmNsb25lKHRoaXMuYXR0cmlidXRlcyl9LHN5bmM6ZnVuY3Rpb24oKXtyZXR1cm4gZS5zeW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbdF19LGVzY2FwZTpmdW5jdGlvbih0KXtyZXR1cm4gaS5lc2NhcGUodGhpcy5nZXQodCkpfSxoYXM6ZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPXRoaXMuZ2V0KHQpfSxtYXRjaGVzOmZ1bmN0aW9uKHQpe3JldHVybiEhaS5pdGVyYXRlZSh0LHRoaXMpKHRoaXMuYXR0cmlidXRlcyl9LHNldDpmdW5jdGlvbih0LGUsbil7aWYobnVsbD09dClyZXR1cm4gdGhpczt2YXIgcjtpZigib2JqZWN0Ij09dHlwZW9mIHQ/KHI9dCxuPWUpOihyPXt9KVt0XT1lLG58fChuPXt9KSwhdGhpcy5fdmFsaWRhdGUocixuKSlyZXR1cm4hMTt2YXIgcz1uLnVuc2V0LG89bi5zaWxlbnQsYT1bXSxsPXRoaXMuX2NoYW5naW5nO3RoaXMuX2NoYW5naW5nPSEwLGx8fCh0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM9aS5jbG9uZSh0aGlzLmF0dHJpYnV0ZXMpLHRoaXMuY2hhbmdlZD17fSk7dmFyIGM9dGhpcy5hdHRyaWJ1dGVzLHU9dGhpcy5jaGFuZ2VkLGQ9dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzO3RoaXMuaWRBdHRyaWJ1dGUgaW4gciYmKHRoaXMuaWQ9clt0aGlzLmlkQXR0cmlidXRlXSk7Zm9yKHZhciBoIGluIHIpZT1yW2hdLGkuaXNFcXVhbChjW2hdLGUpfHxhLnB1c2goaCksaS5pc0VxdWFsKGRbaF0sZSk/ZGVsZXRlIHVbaF06dVtoXT1lLHM/ZGVsZXRlIGNbaF06Y1toXT1lO2lmKCFvKXthLmxlbmd0aCYmKHRoaXMuX3BlbmRpbmc9bik7Zm9yKHZhciBwPTA7cDxhLmxlbmd0aDtwKyspdGhpcy50cmlnZ2VyKCJjaGFuZ2U6IithW3BdLHRoaXMsY1thW3BdXSxuKX1pZihsKXJldHVybiB0aGlzO2lmKCFvKWZvcig7dGhpcy5fcGVuZGluZzspbj10aGlzLl9wZW5kaW5nLHRoaXMuX3BlbmRpbmc9ITEsdGhpcy50cmlnZ2VyKCJjaGFuZ2UiLHRoaXMsbik7cmV0dXJuIHRoaXMuX3BlbmRpbmc9ITEsdGhpcy5fY2hhbmdpbmc9ITEsdGhpc30sdW5zZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXQodCx2b2lkIDAsaS5leHRlbmQoe30sZSx7dW5zZXQ6ITB9KSl9LGNsZWFyOmZ1bmN0aW9uKHQpe3ZhciBlPXt9O2Zvcih2YXIgbiBpbiB0aGlzLmF0dHJpYnV0ZXMpZVtuXT12b2lkIDA7cmV0dXJuIHRoaXMuc2V0KGUsaS5leHRlbmQoe30sdCx7dW5zZXQ6ITB9KSl9LGhhc0NoYW5nZWQ6ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/IWkuaXNFbXB0eSh0aGlzLmNoYW5nZWQpOmkuaGFzKHRoaXMuY2hhbmdlZCx0KX0sY2hhbmdlZEF0dHJpYnV0ZXM6ZnVuY3Rpb24odCl7aWYoIXQpcmV0dXJuISF0aGlzLmhhc0NoYW5nZWQoKSYmaS5jbG9uZSh0aGlzLmNoYW5nZWQpO3ZhciBlPXRoaXMuX2NoYW5naW5nP3RoaXMuX3ByZXZpb3VzQXR0cmlidXRlczp0aGlzLmF0dHJpYnV0ZXMsbj17fTtmb3IodmFyIHIgaW4gdCl7dmFyIHM9dFtyXTtpLmlzRXF1YWwoZVtyXSxzKXx8KG5bcl09cyl9cmV0dXJuISFpLnNpemUobikmJm59LHByZXZpb3VzOmZ1bmN0aW9uKHQpe3JldHVybiBudWxsIT10JiZ0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM/dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzW3RdOm51bGx9LHByZXZpb3VzQXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybiBpLmNsb25lKHRoaXMuX3ByZXZpb3VzQXR0cmlidXRlcyl9LGZldGNoOmZ1bmN0aW9uKHQpe3Q9aS5leHRlbmQoe3BhcnNlOiEwfSx0KTt2YXIgZT10aGlzLG49dC5zdWNjZXNzO3JldHVybiB0LnN1Y2Nlc3M9ZnVuY3Rpb24oaSl7dmFyIHI9dC5wYXJzZT9lLnBhcnNlKGksdCk6aTtyZXR1cm4hIWUuc2V0KHIsdCkmJihuJiZuLmNhbGwodC5jb250ZXh0LGUsaSx0KSx2b2lkIGUudHJpZ2dlcigic3luYyIsZSxpLHQpKX0saih0aGlzLHQpLHRoaXMuc3luYygicmVhZCIsdGhpcyx0KX0sc2F2ZTpmdW5jdGlvbih0LGUsbil7dmFyIHI7bnVsbD09dHx8Im9iamVjdCI9PXR5cGVvZiB0PyhyPXQsbj1lKToocj17fSlbdF09ZSxuPWkuZXh0ZW5kKHt2YWxpZGF0ZTohMCxwYXJzZTohMH0sbik7dmFyIHM9bi53YWl0O2lmKHImJiFzKXtpZighdGhpcy5zZXQocixuKSlyZXR1cm4hMX1lbHNlIGlmKCF0aGlzLl92YWxpZGF0ZShyLG4pKXJldHVybiExO3ZhciBvPXRoaXMsYT1uLnN1Y2Nlc3MsbD10aGlzLmF0dHJpYnV0ZXM7bi5zdWNjZXNzPWZ1bmN0aW9uKHQpe28uYXR0cmlidXRlcz1sO3ZhciBlPW4ucGFyc2U/by5wYXJzZSh0LG4pOnQ7cmV0dXJuIHMmJihlPWkuZXh0ZW5kKHt9LHIsZSkpLCEoZSYmIW8uc2V0KGUsbikpJiYoYSYmYS5jYWxsKG4uY29udGV4dCxvLHQsbiksdm9pZCBvLnRyaWdnZXIoInN5bmMiLG8sdCxuKSl9LGoodGhpcyxuKSxyJiZzJiYodGhpcy5hdHRyaWJ1dGVzPWkuZXh0ZW5kKHt9LGwscikpO3ZhciBjPXRoaXMuaXNOZXcoKT8iY3JlYXRlIjpuLnBhdGNoPyJwYXRjaCI6InVwZGF0ZSI7InBhdGNoIiE9PWN8fG4uYXR0cnN8fChuLmF0dHJzPXIpO3ZhciB1PXRoaXMuc3luYyhjLHRoaXMsbik7cmV0dXJuIHRoaXMuYXR0cmlidXRlcz1sLHV9LGRlc3Ryb3k6ZnVuY3Rpb24odCl7dD10P2kuY2xvbmUodCk6e307dmFyIGU9dGhpcyxuPXQuc3VjY2VzcyxyPXQud2FpdCxzPWZ1bmN0aW9uKCl7ZS5zdG9wTGlzdGVuaW5nKCksZS50cmlnZ2VyKCJkZXN0cm95IixlLGUuY29sbGVjdGlvbix0KX07dC5zdWNjZXNzPWZ1bmN0aW9uKGkpe3ImJnMoKSxuJiZuLmNhbGwodC5jb250ZXh0LGUsaSx0KSxlLmlzTmV3KCl8fGUudHJpZ2dlcigic3luYyIsZSxpLHQpfTt2YXIgbz0hMTtyZXR1cm4gdGhpcy5pc05ldygpP2kuZGVmZXIodC5zdWNjZXNzKTooaih0aGlzLHQpLG89dGhpcy5zeW5jKCJkZWxldGUiLHRoaXMsdCkpLHJ8fHMoKSxvfSx1cmw6ZnVuY3Rpb24oKXt2YXIgdD1pLnJlc3VsdCh0aGlzLCJ1cmxSb290Iil8fGkucmVzdWx0KHRoaXMuY29sbGVjdGlvbiwidXJsIil8fEgoKTtpZih0aGlzLmlzTmV3KCkpcmV0dXJuIHQ7dmFyIGU9dGhpcy5nZXQodGhpcy5pZEF0dHJpYnV0ZSk7cmV0dXJuIHQucmVwbGFjZSgvW15cL10kLywiJCYvIikrZW5jb2RlVVJJQ29tcG9uZW50KGUpfSxwYXJzZTpmdW5jdGlvbih0LGUpe3JldHVybiB0fSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmF0dHJpYnV0ZXMpfSxpc05ldzpmdW5jdGlvbigpe3JldHVybiF0aGlzLmhhcyh0aGlzLmlkQXR0cmlidXRlKX0saXNWYWxpZDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fdmFsaWRhdGUoe30saS5kZWZhdWx0cyh7dmFsaWRhdGU6ITB9LHQpKX0sX3ZhbGlkYXRlOmZ1bmN0aW9uKHQsZSl7aWYoIWUudmFsaWRhdGV8fCF0aGlzLnZhbGlkYXRlKXJldHVybiEwO3Q9aS5leHRlbmQoe30sdGhpcy5hdHRyaWJ1dGVzLHQpO3ZhciBuPXRoaXMudmFsaWRhdGlvbkVycm9yPXRoaXMudmFsaWRhdGUodCxlKXx8bnVsbDtyZXR1cm4hbnx8KHRoaXMudHJpZ2dlcigiaW52YWxpZCIsdGhpcyxuLGkuZXh0ZW5kKGUse3ZhbGlkYXRpb25FcnJvcjpufSkpLCExKX19KTt2YXIgdj17a2V5czoxLHZhbHVlczoxLHBhaXJzOjEsaW52ZXJ0OjEscGljazowLG9taXQ6MCxjaGFpbjoxLGlzRW1wdHk6MX07YShnLHYsImF0dHJpYnV0ZXMiKTt2YXIgeT1lLkNvbGxlY3Rpb249ZnVuY3Rpb24odCxlKXtlfHwoZT17fSksZS5tb2RlbCYmKHRoaXMubW9kZWw9ZS5tb2RlbCksdm9pZCAwIT09ZS5jb21wYXJhdG9yJiYodGhpcy5jb21wYXJhdG9yPWUuY29tcGFyYXRvciksdGhpcy5fcmVzZXQoKSx0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQmJnRoaXMucmVzZXQodCxpLmV4dGVuZCh7c2lsZW50OiEwfSxlKSl9LGI9e2FkZDohMCxyZW1vdmU6ITAsbWVyZ2U6ITB9LHc9e2FkZDohMCxyZW1vdmU6ITF9O2kuZXh0ZW5kKHkucHJvdG90eXBlLGwse21vZGVsOmcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZS50b0pTT04odCl9KX0sc3luYzpmdW5jdGlvbigpe3JldHVybiBlLnN5bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxhZGQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXQodCxpLmV4dGVuZCh7bWVyZ2U6ITF9LGUsdykpfSxyZW1vdmU6ZnVuY3Rpb24odCxlKXtlPWkuZXh0ZW5kKHt9LGUpO3ZhciBuPSFpLmlzQXJyYXkodCk7dD1uP1t0XTppLmNsb25lKHQpO3ZhciByPXRoaXMuX3JlbW92ZU1vZGVscyh0LGUpO3JldHVybiFlLnNpbGVudCYmciYmdGhpcy50cmlnZ2VyKCJ1cGRhdGUiLHRoaXMsZSksbj9yWzBdOnJ9LHNldDpmdW5jdGlvbih0LGUpe2U9aS5kZWZhdWx0cyh7fSxlLGIpLGUucGFyc2UmJiF0aGlzLl9pc01vZGVsKHQpJiYodD10aGlzLnBhcnNlKHQsZSkpO3ZhciBuPSFpLmlzQXJyYXkodCk7dD1uP3Q/W3RdOltdOnQuc2xpY2UoKTt2YXIgcixzLG8sYSxsLGM9ZS5hdDtudWxsIT1jJiYoYz0rYyksYzwwJiYoYys9dGhpcy5sZW5ndGgrMSk7Zm9yKHZhciB1PXRoaXMuY29tcGFyYXRvciYmbnVsbD09YyYmZS5zb3J0IT09ITEsZD1pLmlzU3RyaW5nKHRoaXMuY29tcGFyYXRvcik/dGhpcy5jb21wYXJhdG9yOm51bGwsaD1bXSxwPVtdLGY9e30sbT1lLmFkZCxfPWUubWVyZ2UsZz1lLnJlbW92ZSx2PSEodXx8IW18fCFnKSYmW10seT0hMSx3PTA7dzx0Lmxlbmd0aDt3Kyspe2lmKG89dFt3XSxhPXRoaXMuZ2V0KG8pKWcmJihmW2EuY2lkXT0hMCksXyYmbyE9PWEmJihvPXRoaXMuX2lzTW9kZWwobyk/by5hdHRyaWJ1dGVzOm8sZS5wYXJzZSYmKG89YS5wYXJzZShvLGUpKSxhLnNldChvLGUpLHUmJiFsJiZhLmhhc0NoYW5nZWQoZCkmJihsPSEwKSksdFt3XT1hO2Vsc2UgaWYobSl7aWYocz10W3ddPXRoaXMuX3ByZXBhcmVNb2RlbChvLGUpLCFzKWNvbnRpbnVlO2gucHVzaChzKSx0aGlzLl9hZGRSZWZlcmVuY2UocyxlKX1zPWF8fHMscyYmKHI9dGhpcy5tb2RlbElkKHMuYXR0cmlidXRlcyksIXZ8fCFzLmlzTmV3KCkmJmZbcl18fCh2LnB1c2gocykseT15fHwhdGhpcy5tb2RlbHNbd118fHMuY2lkIT09dGhpcy5tb2RlbHNbd10uY2lkKSxmW3JdPSEwKX1pZihnKXtmb3IodmFyIHc9MDt3PHRoaXMubGVuZ3RoO3crKylmWyhzPXRoaXMubW9kZWxzW3ddKS5jaWRdfHxwLnB1c2gocyk7cC5sZW5ndGgmJnRoaXMuX3JlbW92ZU1vZGVscyhwLGUpfWlmKGgubGVuZ3RofHx5KWlmKHUmJihsPSEwKSx0aGlzLmxlbmd0aCs9aC5sZW5ndGgsbnVsbCE9Yylmb3IodmFyIHc9MDt3PGgubGVuZ3RoO3crKyl0aGlzLm1vZGVscy5zcGxpY2UoYyt3LDAsaFt3XSk7ZWxzZXt2JiYodGhpcy5tb2RlbHMubGVuZ3RoPTApO2Zvcih2YXIgTT12fHxoLHc9MDt3PE0ubGVuZ3RoO3crKyl0aGlzLm1vZGVscy5wdXNoKE1bd10pfWlmKGwmJnRoaXMuc29ydCh7c2lsZW50OiEwfSksIWUuc2lsZW50KXtmb3IodmFyIGs9bnVsbCE9Yz9pLmNsb25lKGUpOmUsdz0wO3c8aC5sZW5ndGg7dysrKW51bGwhPWMmJihrLmluZGV4PWMrdyksKHM9aFt3XSkudHJpZ2dlcigiYWRkIixzLHRoaXMsayk7KGx8fHkpJiZ0aGlzLnRyaWdnZXIoInNvcnQiLHRoaXMsZSksKGgubGVuZ3RofHxwLmxlbmd0aCkmJnRoaXMudHJpZ2dlcigidXBkYXRlIix0aGlzLGUpfXJldHVybiBuP3RbMF06dH0scmVzZXQ6ZnVuY3Rpb24odCxlKXtlPWU/aS5jbG9uZShlKTp7fTtmb3IodmFyIG49MDtuPHRoaXMubW9kZWxzLmxlbmd0aDtuKyspdGhpcy5fcmVtb3ZlUmVmZXJlbmNlKHRoaXMubW9kZWxzW25dLGUpO3JldHVybiBlLnByZXZpb3VzTW9kZWxzPXRoaXMubW9kZWxzLHRoaXMuX3Jlc2V0KCksdD10aGlzLmFkZCh0LGkuZXh0ZW5kKHtzaWxlbnQ6ITB9LGUpKSxlLnNpbGVudHx8dGhpcy50cmlnZ2VyKCJyZXNldCIsdGhpcyxlKSx0fSxwdXNoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkKHQsaS5leHRlbmQoe2F0OnRoaXMubGVuZ3RofSxlKSl9LHBvcDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmF0KHRoaXMubGVuZ3RoLTEpO3JldHVybiB0aGlzLnJlbW92ZShlLHQpfSx1bnNoaWZ0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkKHQsaS5leHRlbmQoe2F0OjB9LGUpKX0sc2hpZnQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hdCgwKTtyZXR1cm4gdGhpcy5yZW1vdmUoZSx0KX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gcy5hcHBseSh0aGlzLm1vZGVscyxhcmd1bWVudHMpfSxnZXQ6ZnVuY3Rpb24odCl7aWYobnVsbCE9dCl7dmFyIGU9dGhpcy5tb2RlbElkKHRoaXMuX2lzTW9kZWwodCk/dC5hdHRyaWJ1dGVzOnQpO3JldHVybiB0aGlzLl9ieUlkW3RdfHx0aGlzLl9ieUlkW2VdfHx0aGlzLl9ieUlkW3QuY2lkXX19LGF0OmZ1bmN0aW9uKHQpe3JldHVybiB0PDAmJih0Kz10aGlzLmxlbmd0aCksdGhpcy5tb2RlbHNbdF19LHdoZXJlOmZ1bmN0aW9uKHQsZSl7dmFyIG49aS5tYXRjaGVzKHQpO3JldHVybiB0aGlzW2U/ImZpbmQiOiJmaWx0ZXIiXShmdW5jdGlvbih0KXtyZXR1cm4gbih0LmF0dHJpYnV0ZXMpfSl9LGZpbmRXaGVyZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy53aGVyZSh0LCEwKX0sc29ydDpmdW5jdGlvbih0KXtpZighdGhpcy5jb21wYXJhdG9yKXRocm93IG5ldyBFcnJvcigiQ2Fubm90IHNvcnQgYSBzZXQgd2l0aG91dCBhIGNvbXBhcmF0b3IiKTtyZXR1cm4gdHx8KHQ9e30pLGkuaXNTdHJpbmcodGhpcy5jb21wYXJhdG9yKXx8MT09PXRoaXMuY29tcGFyYXRvci5sZW5ndGg/dGhpcy5tb2RlbHM9dGhpcy5zb3J0QnkodGhpcy5jb21wYXJhdG9yLHRoaXMpOnRoaXMubW9kZWxzLnNvcnQoaS5iaW5kKHRoaXMuY29tcGFyYXRvcix0aGlzKSksdC5zaWxlbnR8fHRoaXMudHJpZ2dlcigic29ydCIsdGhpcyx0KSx0aGlzfSxwbHVjazpmdW5jdGlvbih0KXtyZXR1cm4gaS5pbnZva2UodGhpcy5tb2RlbHMsImdldCIsdCl9LGZldGNoOmZ1bmN0aW9uKHQpe3Q9aS5leHRlbmQoe3BhcnNlOiEwfSx0KTt2YXIgZT10LnN1Y2Nlc3Msbj10aGlzO3JldHVybiB0LnN1Y2Nlc3M9ZnVuY3Rpb24oaSl7dmFyIHI9dC5yZXNldD8icmVzZXQiOiJzZXQiO25bcl0oaSx0KSxlJiZlLmNhbGwodC5jb250ZXh0LG4saSx0KSxuLnRyaWdnZXIoInN5bmMiLG4saSx0KX0saih0aGlzLHQpLHRoaXMuc3luYygicmVhZCIsdGhpcyx0KX0sY3JlYXRlOmZ1bmN0aW9uKHQsZSl7ZT1lP2kuY2xvbmUoZSk6e307dmFyIG49ZS53YWl0O2lmKHQ9dGhpcy5fcHJlcGFyZU1vZGVsKHQsZSksIXQpcmV0dXJuITE7bnx8dGhpcy5hZGQodCxlKTt2YXIgcj10aGlzLHM9ZS5zdWNjZXNzO3JldHVybiBlLnN1Y2Nlc3M9ZnVuY3Rpb24odCxlLGkpe24mJnIuYWRkKHQsaSkscyYmcy5jYWxsKGkuY29udGV4dCx0LGUsaSl9LHQuc2F2ZShudWxsLGUpLHR9LHBhcnNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHR9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMubW9kZWxzLHttb2RlbDp0aGlzLm1vZGVsLGNvbXBhcmF0b3I6dGhpcy5jb21wYXJhdG9yfSl9LG1vZGVsSWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRbdGhpcy5tb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGV8fCJpZCJdfSxfcmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLmxlbmd0aD0wLHRoaXMubW9kZWxzPVtdLHRoaXMuX2J5SWQ9e319LF9wcmVwYXJlTW9kZWw6ZnVuY3Rpb24odCxlKXtpZih0aGlzLl9pc01vZGVsKHQpKXJldHVybiB0LmNvbGxlY3Rpb258fCh0LmNvbGxlY3Rpb249dGhpcyksdDtlPWU/aS5jbG9uZShlKTp7fSxlLmNvbGxlY3Rpb249dGhpczt2YXIgbj1uZXcgdGhpcy5tb2RlbCh0LGUpO3JldHVybiBuLnZhbGlkYXRpb25FcnJvcj8odGhpcy50cmlnZ2VyKCJpbnZhbGlkIix0aGlzLG4udmFsaWRhdGlvbkVycm9yLGUpLCExKTpufSxfcmVtb3ZlTW9kZWxzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPVtdLG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dGhpcy5nZXQodFtuXSk7aWYocil7dmFyIHM9dGhpcy5pbmRleE9mKHIpO3RoaXMubW9kZWxzLnNwbGljZShzLDEpLHRoaXMubGVuZ3RoLS0sZS5zaWxlbnR8fChlLmluZGV4PXMsci50cmlnZ2VyKCJyZW1vdmUiLHIsdGhpcyxlKSksaS5wdXNoKHIpLHRoaXMuX3JlbW92ZVJlZmVyZW5jZShyLGUpfX1yZXR1cm4hIWkubGVuZ3RoJiZpfSxfaXNNb2RlbDpmdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIGd9LF9hZGRSZWZlcmVuY2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9ieUlkW3QuY2lkXT10O3ZhciBpPXRoaXMubW9kZWxJZCh0LmF0dHJpYnV0ZXMpO251bGwhPWkmJih0aGlzLl9ieUlkW2ldPXQpLHQub24oImFsbCIsdGhpcy5fb25Nb2RlbEV2ZW50LHRoaXMpfSxfcmVtb3ZlUmVmZXJlbmNlOmZ1bmN0aW9uKHQsZSl7ZGVsZXRlIHRoaXMuX2J5SWRbdC5jaWRdO3ZhciBpPXRoaXMubW9kZWxJZCh0LmF0dHJpYnV0ZXMpO251bGwhPWkmJmRlbGV0ZSB0aGlzLl9ieUlkW2ldLHRoaXM9PT10LmNvbGxlY3Rpb24mJmRlbGV0ZSB0LmNvbGxlY3Rpb24sdC5vZmYoImFsbCIsdGhpcy5fb25Nb2RlbEV2ZW50LHRoaXMpfSxfb25Nb2RlbEV2ZW50OmZ1bmN0aW9uKHQsZSxpLG4pe2lmKCJhZGQiIT09dCYmInJlbW92ZSIhPT10fHxpPT09dGhpcyl7aWYoImRlc3Ryb3kiPT09dCYmdGhpcy5yZW1vdmUoZSxuKSwiY2hhbmdlIj09PXQpe3ZhciByPXRoaXMubW9kZWxJZChlLnByZXZpb3VzQXR0cmlidXRlcygpKSxzPXRoaXMubW9kZWxJZChlLmF0dHJpYnV0ZXMpO3IhPT1zJiYobnVsbCE9ciYmZGVsZXRlIHRoaXMuX2J5SWRbcl0sbnVsbCE9cyYmKHRoaXMuX2J5SWRbc109ZSkpfXRoaXMudHJpZ2dlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX0pO3ZhciBNPXtmb3JFYWNoOjMsZWFjaDozLG1hcDozLGNvbGxlY3Q6MyxyZWR1Y2U6NCxmb2xkbDo0LGluamVjdDo0LHJlZHVjZVJpZ2h0OjQsZm9sZHI6NCxmaW5kOjMsZGV0ZWN0OjMsZmlsdGVyOjMsc2VsZWN0OjMscmVqZWN0OjMsZXZlcnk6MyxhbGw6Myxzb21lOjMsYW55OjMsaW5jbHVkZToyLGNvbnRhaW5zOjIsaW52b2tlOjAsbWF4OjMsbWluOjMsdG9BcnJheToxLHNpemU6MSxmaXJzdDozLGhlYWQ6Myx0YWtlOjMsaW5pdGlhbDozLHJlc3Q6Myx0YWlsOjMsZHJvcDozLGxhc3Q6Myx3aXRob3V0OjAsZGlmZmVyZW5jZTowLGluZGV4T2Y6MyxzaHVmZmxlOjEsbGFzdEluZGV4T2Y6Myxpc0VtcHR5OjEsY2hhaW46MSxzYW1wbGU6MyxwYXJ0aXRpb246M307YSh5LE0sIm1vZGVscyIpO3ZhciBrPVsiZ3JvdXBCeSIsImNvdW50QnkiLCJzb3J0QnkiLCJpbmRleEJ5Il07aS5lYWNoKGssZnVuY3Rpb24odCl7aVt0XSYmKHkucHJvdG90eXBlW3RdPWZ1bmN0aW9uKGUsbil7dmFyIHI9aS5pc0Z1bmN0aW9uKGUpP2U6ZnVuY3Rpb24odCl7cmV0dXJuIHQuZ2V0KGUpfTtyZXR1cm4gaVt0XSh0aGlzLm1vZGVscyxyLG4pfSl9KTt2YXIgVD1lLlZpZXc9ZnVuY3Rpb24odCl7dGhpcy5jaWQ9aS51bmlxdWVJZCgidmlldyIpLGkuZXh0ZW5kKHRoaXMsaS5waWNrKHQsTCkpLHRoaXMuX2Vuc3VyZUVsZW1lbnQoKSx0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxTPS9eKFxTKylccyooLiopJC8sTD1bIm1vZGVsIiwiY29sbGVjdGlvbiIsImVsIiwiaWQiLCJhdHRyaWJ1dGVzIiwiY2xhc3NOYW1lIiwidGFnTmFtZSIsImV2ZW50cyJdO2kuZXh0ZW5kKFQucHJvdG90eXBlLGwse3RhZ05hbWU6ImRpdiIsJDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy4kZWwuZmluZCh0KX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe30scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW1vdmVFbGVtZW50KCksdGhpcy5zdG9wTGlzdGVuaW5nKCksdGhpc30sX3JlbW92ZUVsZW1lbnQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmUoKX0sc2V0RWxlbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy51bmRlbGVnYXRlRXZlbnRzKCksdGhpcy5fc2V0RWxlbWVudCh0KSx0aGlzLmRlbGVnYXRlRXZlbnRzKCksdGhpc30sX3NldEVsZW1lbnQ6ZnVuY3Rpb24odCl7dGhpcy4kZWw9dCBpbnN0YW5jZW9mIGUuJD90OmUuJCh0KSx0aGlzLmVsPXRoaXMuJGVsWzBdfSxkZWxlZ2F0ZUV2ZW50czpmdW5jdGlvbih0KXtpZih0fHwodD1pLnJlc3VsdCh0aGlzLCJldmVudHMiKSksIXQpcmV0dXJuIHRoaXM7dGhpcy51bmRlbGVnYXRlRXZlbnRzKCk7Zm9yKHZhciBlIGluIHQpe3ZhciBuPXRbZV07aWYoaS5pc0Z1bmN0aW9uKG4pfHwobj10aGlzW25dKSxuKXt2YXIgcj1lLm1hdGNoKFMpO3RoaXMuZGVsZWdhdGUoclsxXSxyWzJdLGkuYmluZChuLHRoaXMpKX19cmV0dXJuIHRoaXN9LGRlbGVnYXRlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy4kZWwub24odCsiLmRlbGVnYXRlRXZlbnRzIit0aGlzLmNpZCxlLGkpLHRoaXN9LHVuZGVsZWdhdGVFdmVudHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kZWwmJnRoaXMuJGVsLm9mZigiLmRlbGVnYXRlRXZlbnRzIit0aGlzLmNpZCksdGhpc30sdW5kZWxlZ2F0ZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuJGVsLm9mZih0KyIuZGVsZWdhdGVFdmVudHMiK3RoaXMuY2lkLGUsaSksdGhpc30sX2NyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCl9LF9lbnN1cmVFbGVtZW50OmZ1bmN0aW9uKCl7aWYodGhpcy5lbCl0aGlzLnNldEVsZW1lbnQoaS5yZXN1bHQodGhpcywiZWwiKSk7ZWxzZXt2YXIgdD1pLmV4dGVuZCh7fSxpLnJlc3VsdCh0aGlzLCJhdHRyaWJ1dGVzIikpO3RoaXMuaWQmJih0LmlkPWkucmVzdWx0KHRoaXMsImlkIikpLHRoaXMuY2xhc3NOYW1lJiYodFsiY2xhc3MiXT1pLnJlc3VsdCh0aGlzLCJjbGFzc05hbWUiKSksdGhpcy5zZXRFbGVtZW50KHRoaXMuX2NyZWF0ZUVsZW1lbnQoaS5yZXN1bHQodGhpcywidGFnTmFtZSIpKSksdGhpcy5fc2V0QXR0cmlidXRlcyh0KX19LF9zZXRBdHRyaWJ1dGVzOmZ1bmN0aW9uKHQpe3RoaXMuJGVsLmF0dHIodCl9fSksZS5zeW5jPWZ1bmN0aW9uKHQsbixyKXt2YXIgcz14W3RdO2kuZGVmYXVsdHMocnx8KHI9e30pLHtlbXVsYXRlSFRUUDplLmVtdWxhdGVIVFRQLGVtdWxhdGVKU09OOmUuZW11bGF0ZUpTT059KTt2YXIgbz17dHlwZTpzLGRhdGFUeXBlOiJqc29uIn07aWYoci51cmx8fChvLnVybD1pLnJlc3VsdChuLCJ1cmwiKXx8SCgpKSxudWxsIT1yLmRhdGF8fCFufHwiY3JlYXRlIiE9PXQmJiJ1cGRhdGUiIT09dCYmInBhdGNoIiE9PXR8fChvLmNvbnRlbnRUeXBlPSJhcHBsaWNhdGlvbi9qc29uIixvLmRhdGE9SlNPTi5zdHJpbmdpZnkoci5hdHRyc3x8bi50b0pTT04ocikpKSxyLmVtdWxhdGVKU09OJiYoby5jb250ZW50VHlwZT0iYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixvLmRhdGE9by5kYXRhP3ttb2RlbDpvLmRhdGF9Ont9KSxyLmVtdWxhdGVIVFRQJiYoIlBVVCI9PT1zfHwiREVMRVRFIj09PXN8fCJQQVRDSCI9PT1zKSl7by50eXBlPSJQT1NUIixyLmVtdWxhdGVKU09OJiYoby5kYXRhLl9tZXRob2Q9cyk7dmFyIGE9ci5iZWZvcmVTZW5kO3IuYmVmb3JlU2VuZD1mdW5jdGlvbih0KXtpZih0LnNldFJlcXVlc3RIZWFkZXIoIlgtSFRUUC1NZXRob2QtT3ZlcnJpZGUiLHMpLGEpcmV0dXJuIGEuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0iR0VUIj09PW8udHlwZXx8ci5lbXVsYXRlSlNPTnx8KG8ucHJvY2Vzc0RhdGE9ITEpO3ZhciBsPXIuZXJyb3I7ci5lcnJvcj1mdW5jdGlvbih0LGUsaSl7ci50ZXh0U3RhdHVzPWUsci5lcnJvclRocm93bj1pLGwmJmwuY2FsbChyLmNvbnRleHQsdCxlLGkpfTt2YXIgYz1yLnhocj1lLmFqYXgoaS5leHRlbmQobyxyKSk7cmV0dXJuIG4udHJpZ2dlcigicmVxdWVzdCIsbixjLHIpLGN9O3ZhciB4PXtjcmVhdGU6IlBPU1QiLHVwZGF0ZToiUFVUIixwYXRjaDoiUEFUQ0giLCJkZWxldGUiOiJERUxFVEUiLHJlYWQ6IkdFVCJ9O2UuYWpheD1mdW5jdGlvbigpe3JldHVybiBlLiQuYWpheC5hcHBseShlLiQsYXJndW1lbnRzKX07dmFyIEU9ZS5Sb3V0ZXI9ZnVuY3Rpb24odCl7dHx8KHQ9e30pLHQucm91dGVzJiYodGhpcy5yb3V0ZXM9dC5yb3V0ZXMpLHRoaXMuX2JpbmRSb3V0ZXMoKSx0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxEPS9cKCguKj8pXCkvZyxZPS8oXChcPyk/Olx3Ky9nLEM9L1wqXHcrL2csQT0vW1wte31cW1xdKz8uLFxcXF4kfCNcc10vZztpLmV4dGVuZChFLnByb3RvdHlwZSxsLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyb3V0ZTpmdW5jdGlvbih0LG4scil7aS5pc1JlZ0V4cCh0KXx8KHQ9dGhpcy5fcm91dGVUb1JlZ0V4cCh0KSksaS5pc0Z1bmN0aW9uKG4pJiYocj1uLG49IiIpLHJ8fChyPXRoaXNbbl0pO3ZhciBzPXRoaXM7cmV0dXJuIGUuaGlzdG9yeS5yb3V0ZSh0LGZ1bmN0aW9uKGkpe3ZhciBvPXMuX2V4dHJhY3RQYXJhbWV0ZXJzKHQsaSk7cy5leGVjdXRlKHIsbyxuKSE9PSExJiYocy50cmlnZ2VyLmFwcGx5KHMsWyJyb3V0ZToiK25dLmNvbmNhdChvKSkscy50cmlnZ2VyKCJyb3V0ZSIsbixvKSxlLmhpc3RvcnkudHJpZ2dlcigicm91dGUiLHMsbixvKSl9KSx0aGlzfSxleGVjdXRlOmZ1bmN0aW9uKHQsZSxpKXt0JiZ0LmFwcGx5KHRoaXMsZSl9LG5hdmlnYXRlOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIGUuaGlzdG9yeS5uYXZpZ2F0ZSh0LGkpLHRoaXN9LF9iaW5kUm91dGVzOmZ1bmN0aW9uKCl7aWYodGhpcy5yb3V0ZXMpe3RoaXMucm91dGVzPWkucmVzdWx0KHRoaXMsInJvdXRlcyIpO2Zvcih2YXIgdCxlPWkua2V5cyh0aGlzLnJvdXRlcyk7bnVsbCE9KHQ9ZS5wb3AoKSk7KXRoaXMucm91dGUodCx0aGlzLnJvdXRlc1t0XSl9fSxfcm91dGVUb1JlZ0V4cDpmdW5jdGlvbih0KXtyZXR1cm4gdD10LnJlcGxhY2UoQSwiXFwkJiIpLnJlcGxhY2UoRCwiKD86JDEpPyIpLnJlcGxhY2UoWSxmdW5jdGlvbih0LGUpe3JldHVybiBlP3Q6IihbXi8/XSspIn0pLnJlcGxhY2UoQywiKFteP10qPykiKSxuZXcgUmVnRXhwKCJeIit0KyIoPzpcXD8oW1xcc1xcU10qKSk/JCIpfSxfZXh0cmFjdFBhcmFtZXRlcnM6ZnVuY3Rpb24odCxlKXt2YXIgbj10LmV4ZWMoZSkuc2xpY2UoMSk7cmV0dXJuIGkubWFwKG4sZnVuY3Rpb24odCxlKXtyZXR1cm4gZT09PW4ubGVuZ3RoLTE/dHx8bnVsbDp0P2RlY29kZVVSSUNvbXBvbmVudCh0KTpudWxsfSl9fSk7dmFyIE89ZS5IaXN0b3J5PWZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVycz1bXSxpLmJpbmRBbGwodGhpcywiY2hlY2tVcmwiKSwidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmKHRoaXMubG9jYXRpb249d2luZG93LmxvY2F0aW9uLHRoaXMuaGlzdG9yeT13aW5kb3cuaGlzdG9yeSl9LE49L15bI1wvXXxccyskL2csST0vXlwvK3xcLyskL2csUD0vIy4qJC87Ty5zdGFydGVkPSExLGkuZXh0ZW5kKE8ucHJvdG90eXBlLGwse2ludGVydmFsOjUwLGF0Um9vdDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvW15cL10kLywiJCYvIik7cmV0dXJuIHQ9PT10aGlzLnJvb3QmJiF0aGlzLmdldFNlYXJjaCgpfSxtYXRjaFJvb3Q6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmRlY29kZUZyYWdtZW50KHRoaXMubG9jYXRpb24ucGF0aG5hbWUpLGU9dC5zbGljZSgwLHRoaXMucm9vdC5sZW5ndGgtMSkrIi8iO3JldHVybiBlPT09dGhpcy5yb290fSxkZWNvZGVGcmFnbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gZGVjb2RlVVJJKHQucmVwbGFjZSgvJTI1L2csIiUyNTI1IikpfSxnZXRTZWFyY2g6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qLywiIikubWF0Y2goL1w/LisvKTtyZXR1cm4gdD90WzBdOiIifSxnZXRIYXNoOmZ1bmN0aW9uKHQpe3ZhciBlPSh0fHx0aGlzKS5sb2NhdGlvbi5ocmVmLm1hdGNoKC8jKC4qKSQvKTtyZXR1cm4gZT9lWzFdOiIifSxnZXRQYXRoOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5kZWNvZGVGcmFnbWVudCh0aGlzLmxvY2F0aW9uLnBhdGhuYW1lK3RoaXMuZ2V0U2VhcmNoKCkpLnNsaWNlKHRoaXMucm9vdC5sZW5ndGgtMSk7cmV0dXJuIi8iPT09dC5jaGFyQXQoMCk/dC5zbGljZSgxKTp0fSxnZXRGcmFnbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dCYmKHQ9dGhpcy5fdXNlUHVzaFN0YXRlfHwhdGhpcy5fd2FudHNIYXNoQ2hhbmdlP3RoaXMuZ2V0UGF0aCgpOnRoaXMuZ2V0SGFzaCgpKSx0LnJlcGxhY2UoTiwiIil9LHN0YXJ0OmZ1bmN0aW9uKHQpe2lmKE8uc3RhcnRlZCl0aHJvdyBuZXcgRXJyb3IoIkJhY2tib25lLmhpc3RvcnkgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIik7aWYoTy5zdGFydGVkPSEwLHRoaXMub3B0aW9ucz1pLmV4dGVuZCh7cm9vdDoiLyJ9LHRoaXMub3B0aW9ucyx0KSx0aGlzLnJvb3Q9dGhpcy5vcHRpb25zLnJvb3QsdGhpcy5fd2FudHNIYXNoQ2hhbmdlPXRoaXMub3B0aW9ucy5oYXNoQ2hhbmdlIT09ITEsdGhpcy5faGFzSGFzaENoYW5nZT0ib25oYXNoY2hhbmdlImluIHdpbmRvdyx0aGlzLl91c2VIYXNoQ2hhbmdlPXRoaXMuX3dhbnRzSGFzaENoYW5nZSYmdGhpcy5faGFzSGFzaENoYW5nZSx0aGlzLl93YW50c1B1c2hTdGF0ZT0hIXRoaXMub3B0aW9ucy5wdXNoU3RhdGUsdGhpcy5faGFzUHVzaFN0YXRlPSEoIXRoaXMuaGlzdG9yeXx8IXRoaXMuaGlzdG9yeS5wdXNoU3RhdGUpLHRoaXMuX3VzZVB1c2hTdGF0ZT10aGlzLl93YW50c1B1c2hTdGF0ZSYmdGhpcy5faGFzUHVzaFN0YXRlLHRoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudCgpLHRoaXMucm9vdD0oIi8iK3RoaXMucm9vdCsiLyIpLnJlcGxhY2UoSSwiLyIpLHRoaXMuX3dhbnRzSGFzaENoYW5nZSYmdGhpcy5fd2FudHNQdXNoU3RhdGUpe2lmKCF0aGlzLl9oYXNQdXNoU3RhdGUmJiF0aGlzLmF0Um9vdCgpKXt2YXIgZT10aGlzLnJvb3Quc2xpY2UoMCwtMSl8fCIvIjtyZXR1cm4gdGhpcy5sb2NhdGlvbi5yZXBsYWNlKGUrIiMiK3RoaXMuZ2V0UGF0aCgpKSwhMH10aGlzLl9oYXNQdXNoU3RhdGUmJnRoaXMuYXRSb290KCkmJnRoaXMubmF2aWdhdGUodGhpcy5nZXRIYXNoKCkse3JlcGxhY2U6ITB9KX1pZighdGhpcy5faGFzSGFzaENoYW5nZSYmdGhpcy5fd2FudHNIYXNoQ2hhbmdlJiYhdGhpcy5fdXNlUHVzaFN0YXRlKXt0aGlzLmlmcmFtZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKSx0aGlzLmlmcmFtZS5zcmM9ImphdmFzY3JpcHQ6MCIsdGhpcy5pZnJhbWUuc3R5bGUuZGlzcGxheT0ibm9uZSIsdGhpcy5pZnJhbWUudGFiSW5kZXg9LTE7dmFyIG49ZG9jdW1lbnQuYm9keSxyPW4uaW5zZXJ0QmVmb3JlKHRoaXMuaWZyYW1lLG4uZmlyc3RDaGlsZCkuY29udGVudFdpbmRvdztyLmRvY3VtZW50Lm9wZW4oKSxyLmRvY3VtZW50LmNsb3NlKCksci5sb2NhdGlvbi5oYXNoPSIjIit0aGlzLmZyYWdtZW50fXZhciBzPXdpbmRvdy5hZGRFdmVudExpc3RlbmVyfHxmdW5jdGlvbih0LGUpe3JldHVybiBhdHRhY2hFdmVudCgib24iK3QsZSl9O2lmKHRoaXMuX3VzZVB1c2hTdGF0ZT9zKCJwb3BzdGF0ZSIsdGhpcy5jaGVja1VybCwhMSk6dGhpcy5fdXNlSGFzaENoYW5nZSYmIXRoaXMuaWZyYW1lP3MoImhhc2hjaGFuZ2UiLHRoaXMuY2hlY2tVcmwsITEpOnRoaXMuX3dhbnRzSGFzaENoYW5nZSYmKHRoaXMuX2NoZWNrVXJsSW50ZXJ2YWw9c2V0SW50ZXJ2YWwodGhpcy5jaGVja1VybCx0aGlzLmludGVydmFsKSksIXRoaXMub3B0aW9ucy5zaWxlbnQpcmV0dXJuIHRoaXMubG9hZFVybCgpfSxzdG9wOmZ1bmN0aW9uKCl7dmFyIHQ9d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXJ8fGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGRldGFjaEV2ZW50KCJvbiIrdCxlKX07dGhpcy5fdXNlUHVzaFN0YXRlP3QoInBvcHN0YXRlIix0aGlzLmNoZWNrVXJsLCExKTp0aGlzLl91c2VIYXNoQ2hhbmdlJiYhdGhpcy5pZnJhbWUmJnQoImhhc2hjaGFuZ2UiLHRoaXMuY2hlY2tVcmwsITEpLHRoaXMuaWZyYW1lJiYoZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmlmcmFtZSksdGhpcy5pZnJhbWU9bnVsbCksdGhpcy5fY2hlY2tVcmxJbnRlcnZhbCYmY2xlYXJJbnRlcnZhbCh0aGlzLl9jaGVja1VybEludGVydmFsKSxPLnN0YXJ0ZWQ9ITF9LHJvdXRlOmZ1bmN0aW9uKHQsZSl7dGhpcy5oYW5kbGVycy51bnNoaWZ0KHtyb3V0ZTp0LGNhbGxiYWNrOmV9KX0sY2hlY2tVcmw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRGcmFnbWVudCgpO3JldHVybiBlPT09dGhpcy5mcmFnbWVudCYmdGhpcy5pZnJhbWUmJihlPXRoaXMuZ2V0SGFzaCh0aGlzLmlmcmFtZS5jb250ZW50V2luZG93KSksZSE9PXRoaXMuZnJhZ21lbnQmJih0aGlzLmlmcmFtZSYmdGhpcy5uYXZpZ2F0ZShlKSx2b2lkIHRoaXMubG9hZFVybCgpKX0sbG9hZFVybDpmdW5jdGlvbih0KXtyZXR1cm4hIXRoaXMubWF0Y2hSb290KCkmJih0PXRoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudCh0KSxpLmFueSh0aGlzLmhhbmRsZXJzLGZ1bmN0aW9uKGUpe2lmKGUucm91dGUudGVzdCh0KSlyZXR1cm4gZS5jYWxsYmFjayh0KSwhMH0pKX0sbmF2aWdhdGU6ZnVuY3Rpb24odCxlKXtpZighTy5zdGFydGVkKXJldHVybiExO2UmJmUhPT0hMHx8KGU9e3RyaWdnZXI6ISFlfSksdD10aGlzLmdldEZyYWdtZW50KHR8fCIiKTt2YXIgaT10aGlzLnJvb3Q7IiIhPT10JiYiPyIhPT10LmNoYXJBdCgwKXx8KGk9aS5zbGljZSgwLC0xKXx8Ii8iKTt2YXIgbj1pK3Q7aWYodD10aGlzLmRlY29kZUZyYWdtZW50KHQucmVwbGFjZShQLCIiKSksdGhpcy5mcmFnbWVudCE9PXQpe2lmKHRoaXMuZnJhZ21lbnQ9dCx0aGlzLl91c2VQdXNoU3RhdGUpdGhpcy5oaXN0b3J5W2UucmVwbGFjZT8icmVwbGFjZVN0YXRlIjoicHVzaFN0YXRlIl0oe30sZG9jdW1lbnQudGl0bGUsbik7ZWxzZXtpZighdGhpcy5fd2FudHNIYXNoQ2hhbmdlKXJldHVybiB0aGlzLmxvY2F0aW9uLmFzc2lnbihuKTtpZih0aGlzLl91cGRhdGVIYXNoKHRoaXMubG9jYXRpb24sdCxlLnJlcGxhY2UpLHRoaXMuaWZyYW1lJiZ0IT09dGhpcy5nZXRIYXNoKHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cpKXt2YXIgcj10aGlzLmlmcmFtZS5jb250ZW50V2luZG93O2UucmVwbGFjZXx8KHIuZG9jdW1lbnQub3BlbigpLHIuZG9jdW1lbnQuY2xvc2UoKSksdGhpcy5fdXBkYXRlSGFzaChyLmxvY2F0aW9uLHQsZS5yZXBsYWNlKX19cmV0dXJuIGUudHJpZ2dlcj90aGlzLmxvYWRVcmwodCk6dm9pZCAwfX0sX3VwZGF0ZUhhc2g6ZnVuY3Rpb24odCxlLGkpe2lmKGkpe3ZhciBuPXQuaHJlZi5yZXBsYWNlKC8oamF2YXNjcmlwdDp8IykuKiQvLCIiKTt0LnJlcGxhY2UobisiIyIrZSl9ZWxzZSB0Lmhhc2g9IiMiK2V9fSksZS5oaXN0b3J5PW5ldyBPO3ZhciBSPWZ1bmN0aW9uKHQsZSl7dmFyIG4scj10aGlzO249dCYmaS5oYXModCwiY29uc3RydWN0b3IiKT90LmNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7cmV0dXJuIHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxpLmV4dGVuZChuLHIsZSk7dmFyIHM9ZnVuY3Rpb24oKXt0aGlzLmNvbnN0cnVjdG9yPW59O3JldHVybiBzLnByb3RvdHlwZT1yLnByb3RvdHlwZSxuLnByb3RvdHlwZT1uZXcgcyx0JiZpLmV4dGVuZChuLnByb3RvdHlwZSx0KSxuLl9fc3VwZXJfXz1yLnByb3RvdHlwZSxufTtnLmV4dGVuZD15LmV4dGVuZD1FLmV4dGVuZD1ULmV4dGVuZD1PLmV4dGVuZD1SO3ZhciBIPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCdBICJ1cmwiIHByb3BlcnR5IG9yIGZ1bmN0aW9uIG11c3QgYmUgc3BlY2lmaWVkJyl9LGo9ZnVuY3Rpb24odCxlKXt2YXIgaT1lLmVycm9yO2UuZXJyb3I9ZnVuY3Rpb24obil7aSYmaS5jYWxsKGUuY29udGV4dCx0LG4sZSksdC50cmlnZ2VyKCJlcnJvciIsdCxuLGUpfX07cmV0dXJuIGV9KX0pLmNhbGwoZSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSgpKX0sZnVuY3Rpb24odCxlLGkpeyhmdW5jdGlvbih0KXshZnVuY3Rpb24oZSxpKXt0LmV4cG9ydHM9aSgpfSh0aGlzLGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUoKXtyZXR1cm4gWmkuYXBwbHkobnVsbCxhcmd1bWVudHMpfWZ1bmN0aW9uIG4odCl7Wmk9dH1mdW5jdGlvbiByKHQpe3JldHVybiB0IGluc3RhbmNlb2YgQXJyYXl8fCJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIERhdGV8fCJbb2JqZWN0IERhdGVdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiBvKHQsZSl7dmFyIGksbj1bXTtmb3IoaT0wO2k8dC5sZW5ndGg7KytpKW4ucHVzaChlKHRbaV0saSkpO3JldHVybiBufWZ1bmN0aW9uIGEodCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9ZnVuY3Rpb24gbCh0LGUpe2Zvcih2YXIgaSBpbiBlKWEoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIGEoZSwidG9TdHJpbmciKSYmKHQudG9TdHJpbmc9ZS50b1N0cmluZyksYShlLCJ2YWx1ZU9mIikmJih0LnZhbHVlT2Y9ZS52YWx1ZU9mKSx0fWZ1bmN0aW9uIGModCxlLGksbil7cmV0dXJuIFB0KHQsZSxpLG4sITApLnV0YygpfWZ1bmN0aW9uIHUoKXtyZXR1cm57ZW1wdHk6ITEsdW51c2VkVG9rZW5zOltdLHVudXNlZElucHV0OltdLG92ZXJmbG93Oi0yLGNoYXJzTGVmdE92ZXI6MCxudWxsSW5wdXQ6ITEsaW52YWxpZE1vbnRoOm51bGwsaW52YWxpZEZvcm1hdDohMSx1c2VySW52YWxpZGF0ZWQ6ITEsaXNvOiExfX1mdW5jdGlvbiBkKHQpe3JldHVybiBudWxsPT10Ll9wZiYmKHQuX3BmPXUoKSksdC5fcGZ9ZnVuY3Rpb24gaCh0KXtpZihudWxsPT10Ll9pc1ZhbGlkKXt2YXIgZT1kKHQpO3QuX2lzVmFsaWQ9IShpc05hTih0Ll9kLmdldFRpbWUoKSl8fCEoZS5vdmVyZmxvdzwwKXx8ZS5lbXB0eXx8ZS5pbnZhbGlkTW9udGh8fGUuaW52YWxpZFdlZWtkYXl8fGUubnVsbElucHV0fHxlLmludmFsaWRGb3JtYXR8fGUudXNlckludmFsaWRhdGVkKSx0Ll9zdHJpY3QmJih0Ll9pc1ZhbGlkPXQuX2lzVmFsaWQmJjA9PT1lLmNoYXJzTGVmdE92ZXImJjA9PT1lLnVudXNlZFRva2Vucy5sZW5ndGgmJnZvaWQgMD09PWUuYmlnSG91cil9cmV0dXJuIHQuX2lzVmFsaWR9ZnVuY3Rpb24gcCh0KXt2YXIgZT1jKE5hTik7cmV0dXJuIG51bGwhPXQ/bChkKGUpLHQpOmQoZSkudXNlckludmFsaWRhdGVkPSEwLGV9ZnVuY3Rpb24gZih0KXtyZXR1cm4gdm9pZCAwPT09dH1mdW5jdGlvbiBtKHQsZSl7dmFyIGksbixyO2lmKGYoZS5faXNBTW9tZW50T2JqZWN0KXx8KHQuX2lzQU1vbWVudE9iamVjdD1lLl9pc0FNb21lbnRPYmplY3QpLGYoZS5faSl8fCh0Ll9pPWUuX2kpLGYoZS5fZil8fCh0Ll9mPWUuX2YpLGYoZS5fbCl8fCh0Ll9sPWUuX2wpLGYoZS5fc3RyaWN0KXx8KHQuX3N0cmljdD1lLl9zdHJpY3QpLGYoZS5fdHptKXx8KHQuX3R6bT1lLl90em0pLGYoZS5faXNVVEMpfHwodC5faXNVVEM9ZS5faXNVVEMpLGYoZS5fb2Zmc2V0KXx8KHQuX29mZnNldD1lLl9vZmZzZXQpLGYoZS5fcGYpfHwodC5fcGY9ZChlKSksZihlLl9sb2NhbGUpfHwodC5fbG9jYWxlPWUuX2xvY2FsZSksdG4ubGVuZ3RoPjApZm9yKGkgaW4gdG4pbj10bltpXSxyPWVbbl0sZihyKXx8KHRbbl09cik7cmV0dXJuIHR9ZnVuY3Rpb24gXyh0KXttKHRoaXMsdCksdGhpcy5fZD1uZXcgRGF0ZShudWxsIT10Ll9kP3QuX2QuZ2V0VGltZSgpOk5hTiksZW49PT0hMSYmKGVuPSEwLGUudXBkYXRlT2Zmc2V0KHRoaXMpLGVuPSExKX1mdW5jdGlvbiBnKHQpe3JldHVybiB0IGluc3RhbmNlb2YgX3x8bnVsbCE9dCYmbnVsbCE9dC5faXNBTW9tZW50T2JqZWN0fWZ1bmN0aW9uIHYodCl7cmV0dXJuIHQ8MD9NYXRoLmNlaWwodCk6TWF0aC5mbG9vcih0KX1mdW5jdGlvbiB5KHQpe3ZhciBlPSt0LGk9MDtyZXR1cm4gMCE9PWUmJmlzRmluaXRlKGUpJiYoaT12KGUpKSxpfWZ1bmN0aW9uIGIodCxlLGkpe3ZhciBuLHI9TWF0aC5taW4odC5sZW5ndGgsZS5sZW5ndGgpLHM9TWF0aC5hYnModC5sZW5ndGgtZS5sZW5ndGgpLG89MDtmb3Iobj0wO248cjtuKyspKGkmJnRbbl0hPT1lW25dfHwhaSYmeSh0W25dKSE9PXkoZVtuXSkpJiZvKys7cmV0dXJuIG8rc31mdW5jdGlvbiB3KHQpe2Uuc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzPT09ITEmJiJ1bmRlZmluZWQiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oIkRlcHJlY2F0aW9uIHdhcm5pbmc6ICIrdCl9ZnVuY3Rpb24gTSh0LGUpe3ZhciBpPSEwO3JldHVybiBsKGZ1bmN0aW9uKCl7cmV0dXJuIGkmJih3KHQrIlxuQXJndW1lbnRzOiAiK0FycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuam9pbigiLCAiKSsiXG4iKyhuZXcgRXJyb3IpLnN0YWNrKSxpPSExKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZSl9ZnVuY3Rpb24gayh0LGUpe25uW3RdfHwodyhlKSxublt0XT0hMCl9ZnVuY3Rpb24gVCh0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIEZ1bmN0aW9ufHwiW29iamVjdCBGdW5jdGlvbl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfWZ1bmN0aW9uIFModCl7cmV0dXJuIltvYmplY3QgT2JqZWN0XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gTCh0KXt2YXIgZSxpO2ZvcihpIGluIHQpZT10W2ldLFQoZSk/dGhpc1tpXT1lOnRoaXNbIl8iK2ldPWU7dGhpcy5fY29uZmlnPXQsdGhpcy5fb3JkaW5hbFBhcnNlTGVuaWVudD1uZXcgUmVnRXhwKHRoaXMuX29yZGluYWxQYXJzZS5zb3VyY2UrInwiKy9cZHsxLDJ9Ly5zb3VyY2UpfWZ1bmN0aW9uIHgodCxlKXt2YXIgaSxuPWwoe30sdCk7Zm9yKGkgaW4gZSlhKGUsaSkmJihTKHRbaV0pJiZTKGVbaV0pPyhuW2ldPXt9LGwobltpXSx0W2ldKSxsKG5baV0sZVtpXSkpOm51bGwhPWVbaV0/bltpXT1lW2ldOmRlbGV0ZSBuW2ldKTtyZXR1cm4gbn1mdW5jdGlvbiBFKHQpe251bGwhPXQmJnRoaXMuc2V0KHQpfWZ1bmN0aW9uIEQodCl7cmV0dXJuIHQ/dC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoIl8iLCItIik6dH1mdW5jdGlvbiBZKHQpe2Zvcih2YXIgZSxpLG4scixzPTA7czx0Lmxlbmd0aDspe2ZvcihyPUQodFtzXSkuc3BsaXQoIi0iKSxlPXIubGVuZ3RoLGk9RCh0W3MrMV0pLGk9aT9pLnNwbGl0KCItIik6bnVsbDtlPjA7KXtpZihuPUMoci5zbGljZSgwLGUpLmpvaW4oIi0iKSkpcmV0dXJuIG47aWYoaSYmaS5sZW5ndGg+PWUmJmIocixpLCEwKT49ZS0xKWJyZWFrO2UtLX1zKyt9cmV0dXJuIG51bGx9ZnVuY3Rpb24gQyhlKXt2YXIgbj1udWxsO2lmKCFzbltlXSYmInVuZGVmaW5lZCIhPXR5cGVvZiB0JiZ0JiZ0LmV4cG9ydHMpdHJ5e249cm4uX2FiYnIsaSgzOCkoIi4vIitlKSxBKG4pfWNhdGNoKHIpe31yZXR1cm4gc25bZV19ZnVuY3Rpb24gQSh0LGUpe3ZhciBpO3JldHVybiB0JiYoaT1mKGUpP0kodCk6Tyh0LGUpLGkmJihybj1pKSkscm4uX2FiYnJ9ZnVuY3Rpb24gTyh0LGUpe3JldHVybiBudWxsIT09ZT8oZS5hYmJyPXQsbnVsbCE9c25bdF0/KGsoImRlZmluZUxvY2FsZU92ZXJyaWRlIiwidXNlIG1vbWVudC51cGRhdGVMb2NhbGUobG9jYWxlTmFtZSwgY29uZmlnKSB0byBjaGFuZ2UgYW4gZXhpc3RpbmcgbG9jYWxlLiBtb21lbnQuZGVmaW5lTG9jYWxlKGxvY2FsZU5hbWUsIGNvbmZpZykgc2hvdWxkIG9ubHkgYmUgdXNlZCBmb3IgY3JlYXRpbmcgYSBuZXcgbG9jYWxlIiksZT14KHNuW3RdLl9jb25maWcsZSkpOm51bGwhPWUucGFyZW50TG9jYWxlJiYobnVsbCE9c25bZS5wYXJlbnRMb2NhbGVdP2U9eChzbltlLnBhcmVudExvY2FsZV0uX2NvbmZpZyxlKTprKCJwYXJlbnRMb2NhbGVVbmRlZmluZWQiLCJzcGVjaWZpZWQgcGFyZW50TG9jYWxlIGlzIG5vdCBkZWZpbmVkIHlldCIpKSxzblt0XT1uZXcgRShlKSxBKHQpLHNuW3RdKTooZGVsZXRlIHNuW3RdLG51bGwpfWZ1bmN0aW9uIE4odCxlKXtpZihudWxsIT1lKXt2YXIgaTtudWxsIT1zblt0XSYmKGU9eChzblt0XS5fY29uZmlnLGUpKSxpPW5ldyBFKGUpLGkucGFyZW50TG9jYWxlPXNuW3RdLHNuW3RdPWksQSh0KX1lbHNlIG51bGwhPXNuW3RdJiYobnVsbCE9c25bdF0ucGFyZW50TG9jYWxlP3NuW3RdPXNuW3RdLnBhcmVudExvY2FsZTpudWxsIT1zblt0XSYmZGVsZXRlIHNuW3RdKTtyZXR1cm4gc25bdF19ZnVuY3Rpb24gSSh0KXt2YXIgZTtpZih0JiZ0Ll9sb2NhbGUmJnQuX2xvY2FsZS5fYWJiciYmKHQ9dC5fbG9jYWxlLl9hYmJyKSwhdClyZXR1cm4gcm47aWYoIXIodCkpe2lmKGU9Qyh0KSlyZXR1cm4gZTt0PVt0XX1yZXR1cm4gWSh0KX1mdW5jdGlvbiBQKCl7cmV0dXJuIE9iamVjdC5rZXlzKHNuKX1mdW5jdGlvbiBSKHQsZSl7dmFyIGk9dC50b0xvd2VyQ2FzZSgpO29uW2ldPW9uW2krInMiXT1vbltlXT10fWZ1bmN0aW9uIEgodCl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P29uW3RdfHxvblt0LnRvTG93ZXJDYXNlKCldOnZvaWQgMH1mdW5jdGlvbiBqKHQpe3ZhciBlLGksbj17fTtmb3IoaSBpbiB0KWEodCxpKSYmKGU9SChpKSxlJiYobltlXT10W2ldKSk7cmV0dXJuIG59ZnVuY3Rpb24gRih0LGkpe3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gbnVsbCE9bj8oVyh0aGlzLHQsbiksZS51cGRhdGVPZmZzZXQodGhpcyxpKSx0aGlzKTpVKHRoaXMsdCl9fWZ1bmN0aW9uIFUodCxlKXtyZXR1cm4gdC5pc1ZhbGlkKCk/dC5fZFsiZ2V0IisodC5faXNVVEM/IlVUQyI6IiIpK2VdKCk6TmFOfWZ1bmN0aW9uIFcodCxlLGkpe3QuaXNWYWxpZCgpJiZ0Ll9kWyJzZXQiKyh0Ll9pc1VUQz8iVVRDIjoiIikrZV0oaSl9ZnVuY3Rpb24gQih0LGUpe3ZhciBpO2lmKCJvYmplY3QiPT10eXBlb2YgdClmb3IoaSBpbiB0KXRoaXMuc2V0KGksdFtpXSk7ZWxzZSBpZih0PUgodCksVCh0aGlzW3RdKSlyZXR1cm4gdGhpc1t0XShlKTtyZXR1cm4gdGhpc31mdW5jdGlvbiB6KHQsZSxpKXt2YXIgbj0iIitNYXRoLmFicyh0KSxyPWUtbi5sZW5ndGgscz10Pj0wO3JldHVybihzP2k/IisiOiIiOiItIikrTWF0aC5wb3coMTAsTWF0aC5tYXgoMCxyKSkudG9TdHJpbmcoKS5zdWJzdHIoMSkrbn1mdW5jdGlvbiBWKHQsZSxpLG4pe3ZhciByPW47InN0cmluZyI9PXR5cGVvZiBuJiYocj1mdW5jdGlvbigpe3JldHVybiB0aGlzW25dKCl9KSx0JiYodW5bdF09ciksZSYmKHVuW2VbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIHooci5hcHBseSh0aGlzLGFyZ3VtZW50cyksZVsxXSxlWzJdKX0pLGkmJih1bltpXT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5vcmRpbmFsKHIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQpfSl9ZnVuY3Rpb24gJCh0KXtyZXR1cm4gdC5tYXRjaCgvXFtbXHNcU10vKT90LnJlcGxhY2UoL15cW3xcXSQvZywiIik6dC5yZXBsYWNlKC9cXC9nLCIiKX1mdW5jdGlvbiBxKHQpe3ZhciBlLGksbj10Lm1hdGNoKGFuKTtmb3IoZT0wLGk9bi5sZW5ndGg7ZTxpO2UrKyl1bltuW2VdXT9uW2VdPXVuW25bZV1dOm5bZV09JChuW2VdKTtyZXR1cm4gZnVuY3Rpb24ocil7dmFyIHM9IiI7Zm9yKGU9MDtlPGk7ZSsrKXMrPW5bZV1pbnN0YW5jZW9mIEZ1bmN0aW9uP25bZV0uY2FsbChyLHQpOm5bZV07cmV0dXJuIHN9fWZ1bmN0aW9uIEcodCxlKXtyZXR1cm4gdC5pc1ZhbGlkKCk/KGU9SihlLHQubG9jYWxlRGF0YSgpKSxjbltlXT1jbltlXXx8cShlKSxjbltlXSh0KSk6dC5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKX1mdW5jdGlvbiBKKHQsZSl7ZnVuY3Rpb24gaSh0KXtyZXR1cm4gZS5sb25nRGF0ZUZvcm1hdCh0KXx8dH12YXIgbj01O2Zvcihsbi5sYXN0SW5kZXg9MDtuPj0wJiZsbi50ZXN0KHQpOyl0PXQucmVwbGFjZShsbixpKSxsbi5sYXN0SW5kZXg9MCxuLT0xO3JldHVybiB0fWZ1bmN0aW9uIEsodCxlLGkpe0VuW3RdPVQoZSk/ZTpmdW5jdGlvbih0LG4pe3JldHVybiB0JiZpP2k6ZX19ZnVuY3Rpb24gUSh0LGUpe3JldHVybiBhKEVuLHQpP0VuW3RdKGUuX3N0cmljdCxlLl9sb2NhbGUpOm5ldyBSZWdFeHAoWCh0KSl9ZnVuY3Rpb24gWCh0KXtyZXR1cm4gWih0LnJlcGxhY2UoIlxcIiwiIikucmVwbGFjZSgvXFwoXFspfFxcKFxdKXxcWyhbXlxdXFtdKilcXXxcXCguKS9nLGZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIGV8fGl8fG58fHJ9KSl9ZnVuY3Rpb24gWih0KXtyZXR1cm4gdC5yZXBsYWNlKC9bLVwvXFxeJCorPy4oKXxbXF17fV0vZywiXFwkJiIpfWZ1bmN0aW9uIHR0KHQsZSl7dmFyIGksbj1lO2Zvcigic3RyaW5nIj09dHlwZW9mIHQmJih0PVt0XSksIm51bWJlciI9PXR5cGVvZiBlJiYobj1mdW5jdGlvbih0LGkpe2lbZV09eSh0KX0pLGk9MDtpPHQubGVuZ3RoO2krKylEblt0W2ldXT1ufWZ1bmN0aW9uIGV0KHQsZSl7dHQodCxmdW5jdGlvbih0LGksbixyKXtuLl93PW4uX3d8fHt9LGUodCxuLl93LG4scil9KX1mdW5jdGlvbiBpdCh0LGUsaSl7bnVsbCE9ZSYmYShEbix0KSYmRG5bdF0oZSxpLl9hLGksdCl9ZnVuY3Rpb24gbnQodCxlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEModCxlKzEsMCkpLmdldFVUQ0RhdGUoKX1mdW5jdGlvbiBydCh0LGUpe3JldHVybiByKHRoaXMuX21vbnRocyk/dGhpcy5fbW9udGhzW3QubW9udGgoKV06dGhpcy5fbW9udGhzW2puLnRlc3QoZSk/ImZvcm1hdCI6InN0YW5kYWxvbmUiXVt0Lm1vbnRoKCldfWZ1bmN0aW9uIHN0KHQsZSl7cmV0dXJuIHIodGhpcy5fbW9udGhzU2hvcnQpP3RoaXMuX21vbnRoc1Nob3J0W3QubW9udGgoKV06dGhpcy5fbW9udGhzU2hvcnRbam4udGVzdChlKT8iZm9ybWF0Ijoic3RhbmRhbG9uZSJdW3QubW9udGgoKV19ZnVuY3Rpb24gb3QodCxlLGkpe3ZhciBuLHIscztmb3IodGhpcy5fbW9udGhzUGFyc2V8fCh0aGlzLl9tb250aHNQYXJzZT1bXSx0aGlzLl9sb25nTW9udGhzUGFyc2U9W10sdGhpcy5fc2hvcnRNb250aHNQYXJzZT1bXSksbj0wO248MTI7bisrKXtpZihyPWMoWzJlMyxuXSksaSYmIXRoaXMuX2xvbmdNb250aHNQYXJzZVtuXSYmKHRoaXMuX2xvbmdNb250aHNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLm1vbnRocyhyLCIiKS5yZXBsYWNlKCIuIiwiIikrIiQiLCJpIiksdGhpcy5fc2hvcnRNb250aHNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLm1vbnRoc1Nob3J0KHIsIiIpLnJlcGxhY2UoIi4iLCIiKSsiJCIsImkiKSksaXx8dGhpcy5fbW9udGhzUGFyc2Vbbl18fChzPSJeIit0aGlzLm1vbnRocyhyLCIiKSsifF4iK3RoaXMubW9udGhzU2hvcnQociwiIiksdGhpcy5fbW9udGhzUGFyc2Vbbl09bmV3IFJlZ0V4cChzLnJlcGxhY2UoIi4iLCIiKSwiaSIpKSxpJiYiTU1NTSI9PT1lJiZ0aGlzLl9sb25nTW9udGhzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbjtpZihpJiYiTU1NIj09PWUmJnRoaXMuX3Nob3J0TW9udGhzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbjtpZighaSYmdGhpcy5fbW9udGhzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbn19ZnVuY3Rpb24gYXQodCxlKXt2YXIgaTtpZighdC5pc1ZhbGlkKCkpcmV0dXJuIHQ7aWYoInN0cmluZyI9PXR5cGVvZiBlKWlmKC9eXGQrJC8udGVzdChlKSllPXkoZSk7ZWxzZSBpZihlPXQubG9jYWxlRGF0YSgpLm1vbnRoc1BhcnNlKGUpLCJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4gdDtyZXR1cm4gaT1NYXRoLm1pbih0LmRhdGUoKSxudCh0LnllYXIoKSxlKSksdC5fZFsic2V0IisodC5faXNVVEM/IlVUQyI6IiIpKyJNb250aCJdKGUsaSksdH1mdW5jdGlvbiBsdCh0KXtyZXR1cm4gbnVsbCE9dD8oYXQodGhpcyx0KSxlLnVwZGF0ZU9mZnNldCh0aGlzLCEwKSx0aGlzKTpVKHRoaXMsIk1vbnRoIil9ZnVuY3Rpb24gY3QoKXtyZXR1cm4gbnQodGhpcy55ZWFyKCksdGhpcy5tb250aCgpKX1mdW5jdGlvbiB1dCh0KXtyZXR1cm4gdGhpcy5fbW9udGhzUGFyc2VFeGFjdD8oYSh0aGlzLCJfbW9udGhzUmVnZXgiKXx8aHQuY2FsbCh0aGlzKSx0P3RoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzU2hvcnRSZWdleCk6dGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleCYmdD90aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4OnRoaXMuX21vbnRoc1Nob3J0UmVnZXh9ZnVuY3Rpb24gZHQodCl7cmV0dXJuIHRoaXMuX21vbnRoc1BhcnNlRXhhY3Q/KGEodGhpcywiX21vbnRoc1JlZ2V4Iil8fGh0LmNhbGwodGhpcyksdD90aGlzLl9tb250aHNTdHJpY3RSZWdleDp0aGlzLl9tb250aHNSZWdleCk6dGhpcy5fbW9udGhzU3RyaWN0UmVnZXgmJnQ/dGhpcy5fbW9udGhzU3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzUmVnZXh9ZnVuY3Rpb24gaHQoKXtmdW5jdGlvbiB0KHQsZSl7cmV0dXJuIGUubGVuZ3RoLXQubGVuZ3RofXZhciBlLGksbj1bXSxyPVtdLHM9W107Zm9yKGU9MDtlPDEyO2UrKylpPWMoWzJlMyxlXSksbi5wdXNoKHRoaXMubW9udGhzU2hvcnQoaSwiIikpLHIucHVzaCh0aGlzLm1vbnRocyhpLCIiKSkscy5wdXNoKHRoaXMubW9udGhzKGksIiIpKSxzLnB1c2godGhpcy5tb250aHNTaG9ydChpLCIiKSk7Zm9yKG4uc29ydCh0KSxyLnNvcnQodCkscy5zb3J0KHQpLGU9MDtlPDEyO2UrKyluW2VdPVoobltlXSkscltlXT1aKHJbZV0pLHNbZV09WihzW2VdKTt0aGlzLl9tb250aHNSZWdleD1uZXcgUmVnRXhwKCJeKCIrcy5qb2luKCJ8IikrIikiLCJpIiksdGhpcy5fbW9udGhzU2hvcnRSZWdleD10aGlzLl9tb250aHNSZWdleCx0aGlzLl9tb250aHNTdHJpY3RSZWdleD1uZXcgUmVnRXhwKCJeKCIrci5qb2luKCJ8IikrIikkIiwiaSIpLHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK24uam9pbigifCIpKyIpJCIsImkiKX1mdW5jdGlvbiBwdCh0KXt2YXIgZSxpPXQuX2E7cmV0dXJuIGkmJmQodCkub3ZlcmZsb3c9PT0tMiYmKGU9aVtDbl08MHx8aVtDbl0+MTE/Q246aVtBbl08MXx8aVtBbl0+bnQoaVtZbl0saVtDbl0pP0FuOmlbT25dPDB8fGlbT25dPjI0fHwyND09PWlbT25dJiYoMCE9PWlbTm5dfHwwIT09aVtJbl18fDAhPT1pW1BuXSk/T246aVtObl08MHx8aVtObl0+NTk/Tm46aVtJbl08MHx8aVtJbl0+NTk/SW46aVtQbl08MHx8aVtQbl0+OTk5P1BuOi0xLGQodCkuX292ZXJmbG93RGF5T2ZZZWFyJiYoZTxZbnx8ZT5BbikmJihlPUFuKSxkKHQpLl9vdmVyZmxvd1dlZWtzJiZlPT09LTEmJihlPVJuKSxkKHQpLl9vdmVyZmxvd1dlZWtkYXkmJmU9PT0tMSYmKGU9SG4pLGQodCkub3ZlcmZsb3c9ZSksdH1mdW5jdGlvbiBmdCh0KXt2YXIgZSxpLG4scixzLG8sYT10Ll9pLGw9em4uZXhlYyhhKXx8Vm4uZXhlYyhhKTtpZihsKXtmb3IoZCh0KS5pc289ITAsZT0wLGk9cW4ubGVuZ3RoO2U8aTtlKyspaWYocW5bZV1bMV0uZXhlYyhsWzFdKSl7cj1xbltlXVswXSxuPXFuW2VdWzJdIT09ITE7YnJlYWt9aWYobnVsbD09cilyZXR1cm4gdm9pZCh0Ll9pc1ZhbGlkPSExKTtpZihsWzNdKXtmb3IoZT0wLGk9R24ubGVuZ3RoO2U8aTtlKyspaWYoR25bZV1bMV0uZXhlYyhsWzNdKSl7cz0obFsyXXx8IiAiKStHbltlXVswXTticmVha31pZihudWxsPT1zKXJldHVybiB2b2lkKHQuX2lzVmFsaWQ9ITEpfWlmKCFuJiZudWxsIT1zKXJldHVybiB2b2lkKHQuX2lzVmFsaWQ9ITEpO2lmKGxbNF0pe2lmKCEkbi5leGVjKGxbNF0pKXJldHVybiB2b2lkKHQuX2lzVmFsaWQ9ITEpO289IloifXQuX2Y9cisoc3x8IiIpKyhvfHwiIiksRHQodCl9ZWxzZSB0Ll9pc1ZhbGlkPSExfWZ1bmN0aW9uIG10KHQpe3ZhciBpPUpuLmV4ZWModC5faSk7cmV0dXJuIG51bGwhPT1pP3ZvaWQodC5fZD1uZXcgRGF0ZSgoK2lbMV0pKSk6KGZ0KHQpLHZvaWQodC5faXNWYWxpZD09PSExJiYoZGVsZXRlIHQuX2lzVmFsaWQsZS5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayh0KSkpKX1mdW5jdGlvbiBfdCh0LGUsaSxuLHIscyxvKXt2YXIgYT1uZXcgRGF0ZSh0LGUsaSxuLHIscyxvKTtyZXR1cm4gdDwxMDAmJnQ+PTAmJmlzRmluaXRlKGEuZ2V0RnVsbFllYXIoKSkmJmEuc2V0RnVsbFllYXIodCksYX1mdW5jdGlvbiBndCh0KXt2YXIgZT1uZXcgRGF0ZShEYXRlLlVUQy5hcHBseShudWxsLGFyZ3VtZW50cykpO3JldHVybiB0PDEwMCYmdD49MCYmaXNGaW5pdGUoZS5nZXRVVENGdWxsWWVhcigpKSYmZS5zZXRVVENGdWxsWWVhcih0KSxlfWZ1bmN0aW9uIHZ0KHQpe3JldHVybiB5dCh0KT8zNjY6MzY1fWZ1bmN0aW9uIHl0KHQpewoJcmV0dXJuIHQlND09PTAmJnQlMTAwIT09MHx8dCU0MDA9PT0wfWZ1bmN0aW9uIGJ0KCl7cmV0dXJuIHl0KHRoaXMueWVhcigpKX1mdW5jdGlvbiB3dCh0LGUsaSl7dmFyIG49NytlLWkscj0oNytndCh0LDAsbikuZ2V0VVRDRGF5KCktZSklNztyZXR1cm4tcituLTF9ZnVuY3Rpb24gTXQodCxlLGksbixyKXt2YXIgcyxvLGE9KDcraS1uKSU3LGw9d3QodCxuLHIpLGM9MSs3KihlLTEpK2ErbDtyZXR1cm4gYzw9MD8ocz10LTEsbz12dChzKStjKTpjPnZ0KHQpPyhzPXQrMSxvPWMtdnQodCkpOihzPXQsbz1jKSx7eWVhcjpzLGRheU9mWWVhcjpvfX1mdW5jdGlvbiBrdCh0LGUsaSl7dmFyIG4scixzPXd0KHQueWVhcigpLGUsaSksbz1NYXRoLmZsb29yKCh0LmRheU9mWWVhcigpLXMtMSkvNykrMTtyZXR1cm4gbzwxPyhyPXQueWVhcigpLTEsbj1vK1R0KHIsZSxpKSk6bz5UdCh0LnllYXIoKSxlLGkpPyhuPW8tVHQodC55ZWFyKCksZSxpKSxyPXQueWVhcigpKzEpOihyPXQueWVhcigpLG49bykse3dlZWs6bix5ZWFyOnJ9fWZ1bmN0aW9uIFR0KHQsZSxpKXt2YXIgbj13dCh0LGUsaSkscj13dCh0KzEsZSxpKTtyZXR1cm4odnQodCktbityKS83fWZ1bmN0aW9uIFN0KHQsZSxpKXtyZXR1cm4gbnVsbCE9dD90Om51bGwhPWU/ZTppfWZ1bmN0aW9uIEx0KHQpe3ZhciBpPW5ldyBEYXRlKGUubm93KCkpO3JldHVybiB0Ll91c2VVVEM/W2kuZ2V0VVRDRnVsbFllYXIoKSxpLmdldFVUQ01vbnRoKCksaS5nZXRVVENEYXRlKCldOltpLmdldEZ1bGxZZWFyKCksaS5nZXRNb250aCgpLGkuZ2V0RGF0ZSgpXX1mdW5jdGlvbiB4dCh0KXt2YXIgZSxpLG4scixzPVtdO2lmKCF0Ll9kKXtmb3Iobj1MdCh0KSx0Ll93JiZudWxsPT10Ll9hW0FuXSYmbnVsbD09dC5fYVtDbl0mJkV0KHQpLHQuX2RheU9mWWVhciYmKHI9U3QodC5fYVtZbl0sbltZbl0pLHQuX2RheU9mWWVhcj52dChyKSYmKGQodCkuX292ZXJmbG93RGF5T2ZZZWFyPSEwKSxpPWd0KHIsMCx0Ll9kYXlPZlllYXIpLHQuX2FbQ25dPWkuZ2V0VVRDTW9udGgoKSx0Ll9hW0FuXT1pLmdldFVUQ0RhdGUoKSksZT0wO2U8MyYmbnVsbD09dC5fYVtlXTsrK2UpdC5fYVtlXT1zW2VdPW5bZV07Zm9yKDtlPDc7ZSsrKXQuX2FbZV09c1tlXT1udWxsPT10Ll9hW2VdPzI9PT1lPzE6MDp0Ll9hW2VdOzI0PT09dC5fYVtPbl0mJjA9PT10Ll9hW05uXSYmMD09PXQuX2FbSW5dJiYwPT09dC5fYVtQbl0mJih0Ll9uZXh0RGF5PSEwLHQuX2FbT25dPTApLHQuX2Q9KHQuX3VzZVVUQz9ndDpfdCkuYXBwbHkobnVsbCxzKSxudWxsIT10Ll90em0mJnQuX2Quc2V0VVRDTWludXRlcyh0Ll9kLmdldFVUQ01pbnV0ZXMoKS10Ll90em0pLHQuX25leHREYXkmJih0Ll9hW09uXT0yNCl9fWZ1bmN0aW9uIEV0KHQpe3ZhciBlLGksbixyLHMsbyxhLGw7ZT10Ll93LG51bGwhPWUuR0d8fG51bGwhPWUuV3x8bnVsbCE9ZS5FPyhzPTEsbz00LGk9U3QoZS5HRyx0Ll9hW1luXSxrdChSdCgpLDEsNCkueWVhciksbj1TdChlLlcsMSkscj1TdChlLkUsMSksKHI8MXx8cj43KSYmKGw9ITApKToocz10Ll9sb2NhbGUuX3dlZWsuZG93LG89dC5fbG9jYWxlLl93ZWVrLmRveSxpPVN0KGUuZ2csdC5fYVtZbl0sa3QoUnQoKSxzLG8pLnllYXIpLG49U3QoZS53LDEpLG51bGwhPWUuZD8ocj1lLmQsKHI8MHx8cj42KSYmKGw9ITApKTpudWxsIT1lLmU/KHI9ZS5lK3MsKGUuZTwwfHxlLmU+NikmJihsPSEwKSk6cj1zKSxuPDF8fG4+VHQoaSxzLG8pP2QodCkuX292ZXJmbG93V2Vla3M9ITA6bnVsbCE9bD9kKHQpLl9vdmVyZmxvd1dlZWtkYXk9ITA6KGE9TXQoaSxuLHIscyxvKSx0Ll9hW1luXT1hLnllYXIsdC5fZGF5T2ZZZWFyPWEuZGF5T2ZZZWFyKX1mdW5jdGlvbiBEdCh0KXtpZih0Ll9mPT09ZS5JU09fODYwMSlyZXR1cm4gdm9pZCBmdCh0KTt0Ll9hPVtdLGQodCkuZW1wdHk9ITA7dmFyIGksbixyLHMsbyxhPSIiK3QuX2ksbD1hLmxlbmd0aCxjPTA7Zm9yKHI9Sih0Ll9mLHQuX2xvY2FsZSkubWF0Y2goYW4pfHxbXSxpPTA7aTxyLmxlbmd0aDtpKyspcz1yW2ldLG49KGEubWF0Y2goUShzLHQpKXx8W10pWzBdLG4mJihvPWEuc3Vic3RyKDAsYS5pbmRleE9mKG4pKSxvLmxlbmd0aD4wJiZkKHQpLnVudXNlZElucHV0LnB1c2gobyksYT1hLnNsaWNlKGEuaW5kZXhPZihuKStuLmxlbmd0aCksYys9bi5sZW5ndGgpLHVuW3NdPyhuP2QodCkuZW1wdHk9ITE6ZCh0KS51bnVzZWRUb2tlbnMucHVzaChzKSxpdChzLG4sdCkpOnQuX3N0cmljdCYmIW4mJmQodCkudW51c2VkVG9rZW5zLnB1c2gocyk7ZCh0KS5jaGFyc0xlZnRPdmVyPWwtYyxhLmxlbmd0aD4wJiZkKHQpLnVudXNlZElucHV0LnB1c2goYSksZCh0KS5iaWdIb3VyPT09ITAmJnQuX2FbT25dPD0xMiYmdC5fYVtPbl0+MCYmKGQodCkuYmlnSG91cj12b2lkIDApLHQuX2FbT25dPVl0KHQuX2xvY2FsZSx0Ll9hW09uXSx0Ll9tZXJpZGllbSkseHQodCkscHQodCl9ZnVuY3Rpb24gWXQodCxlLGkpe3ZhciBuO3JldHVybiBudWxsPT1pP2U6bnVsbCE9dC5tZXJpZGllbUhvdXI/dC5tZXJpZGllbUhvdXIoZSxpKTpudWxsIT10LmlzUE0/KG49dC5pc1BNKGkpLG4mJmU8MTImJihlKz0xMiksbnx8MTIhPT1lfHwoZT0wKSxlKTplfWZ1bmN0aW9uIEN0KHQpe3ZhciBlLGksbixyLHM7aWYoMD09PXQuX2YubGVuZ3RoKXJldHVybiBkKHQpLmludmFsaWRGb3JtYXQ9ITAsdm9pZCh0Ll9kPW5ldyBEYXRlKE5hTikpO2ZvcihyPTA7cjx0Ll9mLmxlbmd0aDtyKyspcz0wLGU9bSh7fSx0KSxudWxsIT10Ll91c2VVVEMmJihlLl91c2VVVEM9dC5fdXNlVVRDKSxlLl9mPXQuX2Zbcl0sRHQoZSksaChlKSYmKHMrPWQoZSkuY2hhcnNMZWZ0T3ZlcixzKz0xMCpkKGUpLnVudXNlZFRva2Vucy5sZW5ndGgsZChlKS5zY29yZT1zLChudWxsPT1ufHxzPG4pJiYobj1zLGk9ZSkpO2wodCxpfHxlKX1mdW5jdGlvbiBBdCh0KXtpZighdC5fZCl7dmFyIGU9aih0Ll9pKTt0Ll9hPW8oW2UueWVhcixlLm1vbnRoLGUuZGF5fHxlLmRhdGUsZS5ob3VyLGUubWludXRlLGUuc2Vjb25kLGUubWlsbGlzZWNvbmRdLGZ1bmN0aW9uKHQpe3JldHVybiB0JiZwYXJzZUludCh0LDEwKX0pLHh0KHQpfX1mdW5jdGlvbiBPdCh0KXt2YXIgZT1uZXcgXyhwdChOdCh0KSkpO3JldHVybiBlLl9uZXh0RGF5JiYoZS5hZGQoMSwiZCIpLGUuX25leHREYXk9dm9pZCAwKSxlfWZ1bmN0aW9uIE50KHQpe3ZhciBlPXQuX2ksaT10Ll9mO3JldHVybiB0Ll9sb2NhbGU9dC5fbG9jYWxlfHxJKHQuX2wpLG51bGw9PT1lfHx2b2lkIDA9PT1pJiYiIj09PWU/cCh7bnVsbElucHV0OiEwfSk6KCJzdHJpbmciPT10eXBlb2YgZSYmKHQuX2k9ZT10Ll9sb2NhbGUucHJlcGFyc2UoZSkpLGcoZSk/bmV3IF8ocHQoZSkpOihyKGkpP0N0KHQpOmk/RHQodCk6cyhlKT90Ll9kPWU6SXQodCksaCh0KXx8KHQuX2Q9bnVsbCksdCkpfWZ1bmN0aW9uIEl0KHQpe3ZhciBpPXQuX2k7dm9pZCAwPT09aT90Ll9kPW5ldyBEYXRlKGUubm93KCkpOnMoaSk/dC5fZD1uZXcgRGF0ZSgoK2kpKToic3RyaW5nIj09dHlwZW9mIGk/bXQodCk6cihpKT8odC5fYT1vKGkuc2xpY2UoMCksZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlSW50KHQsMTApfSkseHQodCkpOiJvYmplY3QiPT10eXBlb2YgaT9BdCh0KToibnVtYmVyIj09dHlwZW9mIGk/dC5fZD1uZXcgRGF0ZShpKTplLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrKHQpfWZ1bmN0aW9uIFB0KHQsZSxpLG4scil7dmFyIHM9e307cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgaSYmKG49aSxpPXZvaWQgMCkscy5faXNBTW9tZW50T2JqZWN0PSEwLHMuX3VzZVVUQz1zLl9pc1VUQz1yLHMuX2w9aSxzLl9pPXQscy5fZj1lLHMuX3N0cmljdD1uLE90KHMpfWZ1bmN0aW9uIFJ0KHQsZSxpLG4pe3JldHVybiBQdCh0LGUsaSxuLCExKX1mdW5jdGlvbiBIdCh0LGUpe3ZhciBpLG47aWYoMT09PWUubGVuZ3RoJiZyKGVbMF0pJiYoZT1lWzBdKSwhZS5sZW5ndGgpcmV0dXJuIFJ0KCk7Zm9yKGk9ZVswXSxuPTE7bjxlLmxlbmd0aDsrK24pZVtuXS5pc1ZhbGlkKCkmJiFlW25dW3RdKGkpfHwoaT1lW25dKTtyZXR1cm4gaX1mdW5jdGlvbiBqdCgpe3ZhciB0PVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO3JldHVybiBIdCgiaXNCZWZvcmUiLHQpfWZ1bmN0aW9uIEZ0KCl7dmFyIHQ9W10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7cmV0dXJuIEh0KCJpc0FmdGVyIix0KX1mdW5jdGlvbiBVdCh0KXt2YXIgZT1qKHQpLGk9ZS55ZWFyfHwwLG49ZS5xdWFydGVyfHwwLHI9ZS5tb250aHx8MCxzPWUud2Vla3x8MCxvPWUuZGF5fHwwLGE9ZS5ob3VyfHwwLGw9ZS5taW51dGV8fDAsYz1lLnNlY29uZHx8MCx1PWUubWlsbGlzZWNvbmR8fDA7dGhpcy5fbWlsbGlzZWNvbmRzPSt1KzFlMypjKzZlNCpsKzM2ZTUqYSx0aGlzLl9kYXlzPStvKzcqcyx0aGlzLl9tb250aHM9K3IrMypuKzEyKmksdGhpcy5fZGF0YT17fSx0aGlzLl9sb2NhbGU9SSgpLHRoaXMuX2J1YmJsZSgpfWZ1bmN0aW9uIFd0KHQpe3JldHVybiB0IGluc3RhbmNlb2YgVXR9ZnVuY3Rpb24gQnQodCxlKXtWKHQsMCwwLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy51dGNPZmZzZXQoKSxpPSIrIjtyZXR1cm4gdDwwJiYodD0tdCxpPSItIiksaSt6KH5+KHQvNjApLDIpK2Ureih+fnQlNjAsMil9KX1mdW5jdGlvbiB6dCh0LGUpe3ZhciBpPShlfHwiIikubWF0Y2godCl8fFtdLG49aVtpLmxlbmd0aC0xXXx8W10scj0obisiIikubWF0Y2godHIpfHxbIi0iLDAsMF0scz0rKDYwKnJbMV0pK3koclsyXSk7cmV0dXJuIisiPT09clswXT9zOi1zfWZ1bmN0aW9uIFZ0KHQsaSl7dmFyIG4scjtyZXR1cm4gaS5faXNVVEM/KG49aS5jbG9uZSgpLHI9KGcodCl8fHModCk/K3Q6K1J0KHQpKS0rbixuLl9kLnNldFRpbWUoK24uX2QrciksZS51cGRhdGVPZmZzZXQobiwhMSksbik6UnQodCkubG9jYWwoKX1mdW5jdGlvbiAkdCh0KXtyZXR1cm4gMTUqLU1hdGgucm91bmQodC5fZC5nZXRUaW1lem9uZU9mZnNldCgpLzE1KX1mdW5jdGlvbiBxdCh0LGkpe3ZhciBuLHI9dGhpcy5fb2Zmc2V0fHwwO3JldHVybiB0aGlzLmlzVmFsaWQoKT9udWxsIT10Pygic3RyaW5nIj09dHlwZW9mIHQ/dD16dChTbix0KTpNYXRoLmFicyh0KTwxNiYmKHQ9NjAqdCksIXRoaXMuX2lzVVRDJiZpJiYobj0kdCh0aGlzKSksdGhpcy5fb2Zmc2V0PXQsdGhpcy5faXNVVEM9ITAsbnVsbCE9biYmdGhpcy5hZGQobiwibSIpLHIhPT10JiYoIWl8fHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3M/dWUodGhpcyxyZSh0LXIsIm0iKSwxLCExKTp0aGlzLl9jaGFuZ2VJblByb2dyZXNzfHwodGhpcy5fY2hhbmdlSW5Qcm9ncmVzcz0hMCxlLnVwZGF0ZU9mZnNldCh0aGlzLCEwKSx0aGlzLl9jaGFuZ2VJblByb2dyZXNzPW51bGwpKSx0aGlzKTp0aGlzLl9pc1VUQz9yOiR0KHRoaXMpOm51bGwhPXQ/dGhpczpOYU59ZnVuY3Rpb24gR3QodCxlKXtyZXR1cm4gbnVsbCE9dD8oInN0cmluZyIhPXR5cGVvZiB0JiYodD0tdCksdGhpcy51dGNPZmZzZXQodCxlKSx0aGlzKTotdGhpcy51dGNPZmZzZXQoKX1mdW5jdGlvbiBKdCh0KXtyZXR1cm4gdGhpcy51dGNPZmZzZXQoMCx0KX1mdW5jdGlvbiBLdCh0KXtyZXR1cm4gdGhpcy5faXNVVEMmJih0aGlzLnV0Y09mZnNldCgwLHQpLHRoaXMuX2lzVVRDPSExLHQmJnRoaXMuc3VidHJhY3QoJHQodGhpcyksIm0iKSksdGhpc31mdW5jdGlvbiBRdCgpe3JldHVybiB0aGlzLl90em0/dGhpcy51dGNPZmZzZXQodGhpcy5fdHptKToic3RyaW5nIj09dHlwZW9mIHRoaXMuX2kmJnRoaXMudXRjT2Zmc2V0KHp0KFRuLHRoaXMuX2kpKSx0aGlzfWZ1bmN0aW9uIFh0KHQpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJih0PXQ/UnQodCkudXRjT2Zmc2V0KCk6MCwodGhpcy51dGNPZmZzZXQoKS10KSU2MD09PTApfWZ1bmN0aW9uIFp0KCl7cmV0dXJuIHRoaXMudXRjT2Zmc2V0KCk+dGhpcy5jbG9uZSgpLm1vbnRoKDApLnV0Y09mZnNldCgpfHx0aGlzLnV0Y09mZnNldCgpPnRoaXMuY2xvbmUoKS5tb250aCg1KS51dGNPZmZzZXQoKX1mdW5jdGlvbiB0ZSgpe2lmKCFmKHRoaXMuX2lzRFNUU2hpZnRlZCkpcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDt2YXIgdD17fTtpZihtKHQsdGhpcyksdD1OdCh0KSx0Ll9hKXt2YXIgZT10Ll9pc1VUQz9jKHQuX2EpOlJ0KHQuX2EpO3RoaXMuX2lzRFNUU2hpZnRlZD10aGlzLmlzVmFsaWQoKSYmYih0Ll9hLGUudG9BcnJheSgpKT4wfWVsc2UgdGhpcy5faXNEU1RTaGlmdGVkPSExO3JldHVybiB0aGlzLl9pc0RTVFNoaWZ0ZWR9ZnVuY3Rpb24gZWUoKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiYhdGhpcy5faXNVVEN9ZnVuY3Rpb24gaWUoKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiZ0aGlzLl9pc1VUQ31mdW5jdGlvbiBuZSgpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJih0aGlzLl9pc1VUQyYmMD09PXRoaXMuX29mZnNldCl9ZnVuY3Rpb24gcmUodCxlKXt2YXIgaSxuLHIscz10LG89bnVsbDtyZXR1cm4gV3QodCk/cz17bXM6dC5fbWlsbGlzZWNvbmRzLGQ6dC5fZGF5cyxNOnQuX21vbnRoc306Im51bWJlciI9PXR5cGVvZiB0PyhzPXt9LGU/c1tlXT10OnMubWlsbGlzZWNvbmRzPXQpOihvPWVyLmV4ZWModCkpPyhpPSItIj09PW9bMV0/LTE6MSxzPXt5OjAsZDp5KG9bQW5dKSppLGg6eShvW09uXSkqaSxtOnkob1tObl0pKmksczp5KG9bSW5dKSppLG1zOnkob1tQbl0pKml9KToobz1pci5leGVjKHQpKT8oaT0iLSI9PT1vWzFdPy0xOjEscz17eTpzZShvWzJdLGkpLE06c2Uob1szXSxpKSx3OnNlKG9bNF0saSksZDpzZShvWzVdLGkpLGg6c2Uob1s2XSxpKSxtOnNlKG9bN10saSksczpzZShvWzhdLGkpfSk6bnVsbD09cz9zPXt9OiJvYmplY3QiPT10eXBlb2YgcyYmKCJmcm9tImluIHN8fCJ0byJpbiBzKSYmKHI9YWUoUnQocy5mcm9tKSxSdChzLnRvKSkscz17fSxzLm1zPXIubWlsbGlzZWNvbmRzLHMuTT1yLm1vbnRocyksbj1uZXcgVXQocyksV3QodCkmJmEodCwiX2xvY2FsZSIpJiYobi5fbG9jYWxlPXQuX2xvY2FsZSksbn1mdW5jdGlvbiBzZSh0LGUpe3ZhciBpPXQmJnBhcnNlRmxvYXQodC5yZXBsYWNlKCIsIiwiLiIpKTtyZXR1cm4oaXNOYU4oaSk/MDppKSplfWZ1bmN0aW9uIG9lKHQsZSl7dmFyIGk9e21pbGxpc2Vjb25kczowLG1vbnRoczowfTtyZXR1cm4gaS5tb250aHM9ZS5tb250aCgpLXQubW9udGgoKSsxMiooZS55ZWFyKCktdC55ZWFyKCkpLHQuY2xvbmUoKS5hZGQoaS5tb250aHMsIk0iKS5pc0FmdGVyKGUpJiYtLWkubW9udGhzLGkubWlsbGlzZWNvbmRzPStlLSt0LmNsb25lKCkuYWRkKGkubW9udGhzLCJNIiksaX1mdW5jdGlvbiBhZSh0LGUpe3ZhciBpO3JldHVybiB0LmlzVmFsaWQoKSYmZS5pc1ZhbGlkKCk/KGU9VnQoZSx0KSx0LmlzQmVmb3JlKGUpP2k9b2UodCxlKTooaT1vZShlLHQpLGkubWlsbGlzZWNvbmRzPS1pLm1pbGxpc2Vjb25kcyxpLm1vbnRocz0taS5tb250aHMpLGkpOnttaWxsaXNlY29uZHM6MCxtb250aHM6MH19ZnVuY3Rpb24gbGUodCl7cmV0dXJuIHQ8MD9NYXRoLnJvdW5kKC0xKnQpKi0xOk1hdGgucm91bmQodCl9ZnVuY3Rpb24gY2UodCxlKXtyZXR1cm4gZnVuY3Rpb24oaSxuKXt2YXIgcixzO3JldHVybiBudWxsPT09bnx8aXNOYU4oK24pfHwoayhlLCJtb21lbnQoKS4iK2UrIihwZXJpb2QsIG51bWJlcikgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBtb21lbnQoKS4iK2UrIihudW1iZXIsIHBlcmlvZCkuIikscz1pLGk9bixuPXMpLGk9InN0cmluZyI9PXR5cGVvZiBpPytpOmkscj1yZShpLG4pLHVlKHRoaXMscix0KSx0aGlzfX1mdW5jdGlvbiB1ZSh0LGksbixyKXt2YXIgcz1pLl9taWxsaXNlY29uZHMsbz1sZShpLl9kYXlzKSxhPWxlKGkuX21vbnRocyk7dC5pc1ZhbGlkKCkmJihyPW51bGw9PXJ8fHIscyYmdC5fZC5zZXRUaW1lKCt0Ll9kK3MqbiksbyYmVyh0LCJEYXRlIixVKHQsIkRhdGUiKStvKm4pLGEmJmF0KHQsVSh0LCJNb250aCIpK2EqbiksciYmZS51cGRhdGVPZmZzZXQodCxvfHxhKSl9ZnVuY3Rpb24gZGUodCxlKXt2YXIgaT10fHxSdCgpLG49VnQoaSx0aGlzKS5zdGFydE9mKCJkYXkiKSxyPXRoaXMuZGlmZihuLCJkYXlzIiwhMCkscz1yPC02PyJzYW1lRWxzZSI6cjwtMT8ibGFzdFdlZWsiOnI8MD8ibGFzdERheSI6cjwxPyJzYW1lRGF5IjpyPDI/Im5leHREYXkiOnI8Nz8ibmV4dFdlZWsiOiJzYW1lRWxzZSIsbz1lJiYoVChlW3NdKT9lW3NdKCk6ZVtzXSk7cmV0dXJuIHRoaXMuZm9ybWF0KG98fHRoaXMubG9jYWxlRGF0YSgpLmNhbGVuZGFyKHMsdGhpcyxSdChpKSkpfWZ1bmN0aW9uIGhlKCl7cmV0dXJuIG5ldyBfKHRoaXMpfWZ1bmN0aW9uIHBlKHQsZSl7dmFyIGk9Zyh0KT90OlJ0KHQpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhaS5pc1ZhbGlkKCkpJiYoZT1IKGYoZSk/Im1pbGxpc2Vjb25kIjplKSwibWlsbGlzZWNvbmQiPT09ZT8rdGhpcz4raToraTwrdGhpcy5jbG9uZSgpLnN0YXJ0T2YoZSkpfWZ1bmN0aW9uIGZlKHQsZSl7dmFyIGk9Zyh0KT90OlJ0KHQpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhaS5pc1ZhbGlkKCkpJiYoZT1IKGYoZSk/Im1pbGxpc2Vjb25kIjplKSwibWlsbGlzZWNvbmQiPT09ZT8rdGhpczwraTordGhpcy5jbG9uZSgpLmVuZE9mKGUpPCtpKX1mdW5jdGlvbiBtZSh0LGUsaSl7cmV0dXJuIHRoaXMuaXNBZnRlcih0LGkpJiZ0aGlzLmlzQmVmb3JlKA==", "base64"));
  res.write(new Buffer("ZSxpKX1mdW5jdGlvbiBfZSh0LGUpe3ZhciBpLG49Zyh0KT90OlJ0KHQpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhbi5pc1ZhbGlkKCkpJiYoZT1IKGV8fCJtaWxsaXNlY29uZCIpLCJtaWxsaXNlY29uZCI9PT1lPyt0aGlzPT09K246KGk9K24sK3RoaXMuY2xvbmUoKS5zdGFydE9mKGUpPD1pJiZpPD0rdGhpcy5jbG9uZSgpLmVuZE9mKGUpKSl9ZnVuY3Rpb24gZ2UodCxlKXtyZXR1cm4gdGhpcy5pc1NhbWUodCxlKXx8dGhpcy5pc0FmdGVyKHQsZSl9ZnVuY3Rpb24gdmUodCxlKXtyZXR1cm4gdGhpcy5pc1NhbWUodCxlKXx8dGhpcy5pc0JlZm9yZSh0LGUpfWZ1bmN0aW9uIHllKHQsZSxpKXt2YXIgbixyLHMsbztyZXR1cm4gdGhpcy5pc1ZhbGlkKCk/KG49VnQodCx0aGlzKSxuLmlzVmFsaWQoKT8ocj02ZTQqKG4udXRjT2Zmc2V0KCktdGhpcy51dGNPZmZzZXQoKSksZT1IKGUpLCJ5ZWFyIj09PWV8fCJtb250aCI9PT1lfHwicXVhcnRlciI9PT1lPyhvPWJlKHRoaXMsbiksInF1YXJ0ZXIiPT09ZT9vLz0zOiJ5ZWFyIj09PWUmJihvLz0xMikpOihzPXRoaXMtbixvPSJzZWNvbmQiPT09ZT9zLzFlMzoibWludXRlIj09PWU/cy82ZTQ6ImhvdXIiPT09ZT9zLzM2ZTU6ImRheSI9PT1lPyhzLXIpLzg2NGU1OiJ3ZWVrIj09PWU/KHMtcikvNjA0OGU1OnMpLGk/bzp2KG8pKTpOYU4pOk5hTn1mdW5jdGlvbiBiZSh0LGUpe3ZhciBpLG4scj0xMiooZS55ZWFyKCktdC55ZWFyKCkpKyhlLm1vbnRoKCktdC5tb250aCgpKSxzPXQuY2xvbmUoKS5hZGQociwibW9udGhzIik7cmV0dXJuIGUtczwwPyhpPXQuY2xvbmUoKS5hZGQoci0xLCJtb250aHMiKSxuPShlLXMpLyhzLWkpKTooaT10LmNsb25lKCkuYWRkKHIrMSwibW9udGhzIiksbj0oZS1zKS8oaS1zKSksLShyK24pfWZ1bmN0aW9uIHdlKCl7cmV0dXJuIHRoaXMuY2xvbmUoKS5sb2NhbGUoImVuIikuZm9ybWF0KCJkZGQgTU1NIEREIFlZWVkgSEg6bW06c3MgW0dNVF1aWiIpfWZ1bmN0aW9uIE1lKCl7dmFyIHQ9dGhpcy5jbG9uZSgpLnV0YygpO3JldHVybiAwPHQueWVhcigpJiZ0LnllYXIoKTw9OTk5OT9UKERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nKT90aGlzLnRvRGF0ZSgpLnRvSVNPU3RyaW5nKCk6Ryh0LCJZWVlZLU1NLUREW1RdSEg6bW06c3MuU1NTW1pdIik6Ryh0LCJZWVlZWVktTU0tRERbVF1ISDptbTpzcy5TU1NbWl0iKX1mdW5jdGlvbiBrZSh0KXt2YXIgaT1HKHRoaXMsdHx8ZS5kZWZhdWx0Rm9ybWF0KTtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkucG9zdGZvcm1hdChpKX1mdW5jdGlvbiBUZSh0LGUpe3JldHVybiB0aGlzLmlzVmFsaWQoKSYmKGcodCkmJnQuaXNWYWxpZCgpfHxSdCh0KS5pc1ZhbGlkKCkpP3JlKHt0bzp0aGlzLGZyb206dH0pLmxvY2FsZSh0aGlzLmxvY2FsZSgpKS5odW1hbml6ZSghZSk6dGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKX1mdW5jdGlvbiBTZSh0KXtyZXR1cm4gdGhpcy5mcm9tKFJ0KCksdCl9ZnVuY3Rpb24gTGUodCxlKXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJihnKHQpJiZ0LmlzVmFsaWQoKXx8UnQodCkuaXNWYWxpZCgpKT9yZSh7ZnJvbTp0aGlzLHRvOnR9KS5sb2NhbGUodGhpcy5sb2NhbGUoKSkuaHVtYW5pemUoIWUpOnRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCl9ZnVuY3Rpb24geGUodCl7cmV0dXJuIHRoaXMudG8oUnQoKSx0KX1mdW5jdGlvbiBFZSh0KXt2YXIgZTtyZXR1cm4gdm9pZCAwPT09dD90aGlzLl9sb2NhbGUuX2FiYnI6KGU9SSh0KSxudWxsIT1lJiYodGhpcy5fbG9jYWxlPWUpLHRoaXMpfWZ1bmN0aW9uIERlKCl7cmV0dXJuIHRoaXMuX2xvY2FsZX1mdW5jdGlvbiBZZSh0KXtzd2l0Y2godD1IKHQpKXtjYXNlInllYXIiOnRoaXMubW9udGgoMCk7Y2FzZSJxdWFydGVyIjpjYXNlIm1vbnRoIjp0aGlzLmRhdGUoMSk7Y2FzZSJ3ZWVrIjpjYXNlImlzb1dlZWsiOmNhc2UiZGF5Ijp0aGlzLmhvdXJzKDApO2Nhc2UiaG91ciI6dGhpcy5taW51dGVzKDApO2Nhc2UibWludXRlIjp0aGlzLnNlY29uZHMoMCk7Y2FzZSJzZWNvbmQiOnRoaXMubWlsbGlzZWNvbmRzKDApfXJldHVybiJ3ZWVrIj09PXQmJnRoaXMud2Vla2RheSgwKSwiaXNvV2VlayI9PT10JiZ0aGlzLmlzb1dlZWtkYXkoMSksInF1YXJ0ZXIiPT09dCYmdGhpcy5tb250aCgzKk1hdGguZmxvb3IodGhpcy5tb250aCgpLzMpKSx0aGlzfWZ1bmN0aW9uIENlKHQpe3JldHVybiB0PUgodCksdm9pZCAwPT09dHx8Im1pbGxpc2Vjb25kIj09PXQ/dGhpczp0aGlzLnN0YXJ0T2YodCkuYWRkKDEsImlzb1dlZWsiPT09dD8id2VlayI6dCkuc3VidHJhY3QoMSwibXMiKX1mdW5jdGlvbiBBZSgpe3JldHVybit0aGlzLl9kLTZlNCoodGhpcy5fb2Zmc2V0fHwwKX1mdW5jdGlvbiBPZSgpe3JldHVybiBNYXRoLmZsb29yKCt0aGlzLzFlMyl9ZnVuY3Rpb24gTmUoKXtyZXR1cm4gdGhpcy5fb2Zmc2V0P25ldyBEYXRlKCgrdGhpcykpOnRoaXMuX2R9ZnVuY3Rpb24gSWUoKXt2YXIgdD10aGlzO3JldHVyblt0LnllYXIoKSx0Lm1vbnRoKCksdC5kYXRlKCksdC5ob3VyKCksdC5taW51dGUoKSx0LnNlY29uZCgpLHQubWlsbGlzZWNvbmQoKV19ZnVuY3Rpb24gUGUoKXt2YXIgdD10aGlzO3JldHVybnt5ZWFyczp0LnllYXIoKSxtb250aHM6dC5tb250aCgpLGRhdGU6dC5kYXRlKCksaG91cnM6dC5ob3VycygpLG1pbnV0ZXM6dC5taW51dGVzKCksc2Vjb25kczp0LnNlY29uZHMoKSxtaWxsaXNlY29uZHM6dC5taWxsaXNlY29uZHMoKX19ZnVuY3Rpb24gUmUoKXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCk/dGhpcy50b0lTT1N0cmluZygpOm51bGx9ZnVuY3Rpb24gSGUoKXtyZXR1cm4gaCh0aGlzKX1mdW5jdGlvbiBqZSgpe3JldHVybiBsKHt9LGQodGhpcykpfWZ1bmN0aW9uIEZlKCl7cmV0dXJuIGQodGhpcykub3ZlcmZsb3d9ZnVuY3Rpb24gVWUoKXtyZXR1cm57aW5wdXQ6dGhpcy5faSxmb3JtYXQ6dGhpcy5fZixsb2NhbGU6dGhpcy5fbG9jYWxlLGlzVVRDOnRoaXMuX2lzVVRDLHN0cmljdDp0aGlzLl9zdHJpY3R9fWZ1bmN0aW9uIFdlKHQsZSl7VigwLFt0LHQubGVuZ3RoXSwwLGUpfWZ1bmN0aW9uIEJlKHQpe3JldHVybiBxZS5jYWxsKHRoaXMsdCx0aGlzLndlZWsoKSx0aGlzLndlZWtkYXkoKSx0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3csdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG95KX1mdW5jdGlvbiB6ZSh0KXtyZXR1cm4gcWUuY2FsbCh0aGlzLHQsdGhpcy5pc29XZWVrKCksdGhpcy5pc29XZWVrZGF5KCksMSw0KX1mdW5jdGlvbiBWZSgpe3JldHVybiBUdCh0aGlzLnllYXIoKSwxLDQpfWZ1bmN0aW9uICRlKCl7dmFyIHQ9dGhpcy5sb2NhbGVEYXRhKCkuX3dlZWs7cmV0dXJuIFR0KHRoaXMueWVhcigpLHQuZG93LHQuZG95KX1mdW5jdGlvbiBxZSh0LGUsaSxuLHIpe3ZhciBzO3JldHVybiBudWxsPT10P2t0KHRoaXMsbixyKS55ZWFyOihzPVR0KHQsbixyKSxlPnMmJihlPXMpLEdlLmNhbGwodGhpcyx0LGUsaSxuLHIpKX1mdW5jdGlvbiBHZSh0LGUsaSxuLHIpe3ZhciBzPU10KHQsZSxpLG4sciksbz1ndChzLnllYXIsMCxzLmRheU9mWWVhcik7cmV0dXJuIHRoaXMueWVhcihvLmdldFVUQ0Z1bGxZZWFyKCkpLHRoaXMubW9udGgoby5nZXRVVENNb250aCgpKSx0aGlzLmRhdGUoby5nZXRVVENEYXRlKCkpLHRoaXN9ZnVuY3Rpb24gSmUodCl7cmV0dXJuIG51bGw9PXQ/TWF0aC5jZWlsKCh0aGlzLm1vbnRoKCkrMSkvMyk6dGhpcy5tb250aCgzKih0LTEpK3RoaXMubW9udGgoKSUzKX1mdW5jdGlvbiBLZSh0KXtyZXR1cm4ga3QodCx0aGlzLl93ZWVrLmRvdyx0aGlzLl93ZWVrLmRveSkud2Vla31mdW5jdGlvbiBRZSgpe3JldHVybiB0aGlzLl93ZWVrLmRvd31mdW5jdGlvbiBYZSgpe3JldHVybiB0aGlzLl93ZWVrLmRveX1mdW5jdGlvbiBaZSh0KXt2YXIgZT10aGlzLmxvY2FsZURhdGEoKS53ZWVrKHRoaXMpO3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQoNyoodC1lKSwiZCIpfWZ1bmN0aW9uIHRpKHQpe3ZhciBlPWt0KHRoaXMsMSw0KS53ZWVrO3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQoNyoodC1lKSwiZCIpfWZ1bmN0aW9uIGVpKHQsZSl7cmV0dXJuInN0cmluZyIhPXR5cGVvZiB0P3Q6aXNOYU4odCk/KHQ9ZS53ZWVrZGF5c1BhcnNlKHQpLCJudW1iZXIiPT10eXBlb2YgdD90Om51bGwpOnBhcnNlSW50KHQsMTApfWZ1bmN0aW9uIGlpKHQsZSl7cmV0dXJuIHIodGhpcy5fd2Vla2RheXMpP3RoaXMuX3dlZWtkYXlzW3QuZGF5KCldOnRoaXMuX3dlZWtkYXlzW3RoaXMuX3dlZWtkYXlzLmlzRm9ybWF0LnRlc3QoZSk/ImZvcm1hdCI6InN0YW5kYWxvbmUiXVt0LmRheSgpXX1mdW5jdGlvbiBuaSh0KXtyZXR1cm4gdGhpcy5fd2Vla2RheXNTaG9ydFt0LmRheSgpXX1mdW5jdGlvbiByaSh0KXtyZXR1cm4gdGhpcy5fd2Vla2RheXNNaW5bdC5kYXkoKV19ZnVuY3Rpb24gc2kodCxlLGkpe3ZhciBuLHIscztmb3IodGhpcy5fd2Vla2RheXNQYXJzZXx8KHRoaXMuX3dlZWtkYXlzUGFyc2U9W10sdGhpcy5fbWluV2Vla2RheXNQYXJzZT1bXSx0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2U9W10sdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2U9W10pLG49MDtuPDc7bisrKXtpZihyPVJ0KFsyZTMsMV0pLmRheShuKSxpJiYhdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2Vbbl0mJih0aGlzLl9mdWxsV2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzKHIsIiIpLnJlcGxhY2UoIi4iLCIuPyIpKyIkIiwiaSIpLHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzU2hvcnQociwiIikucmVwbGFjZSgiLiIsIi4/IikrIiQiLCJpIiksdGhpcy5fbWluV2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzTWluKHIsIiIpLnJlcGxhY2UoIi4iLCIuPyIpKyIkIiwiaSIpKSx0aGlzLl93ZWVrZGF5c1BhcnNlW25dfHwocz0iXiIrdGhpcy53ZWVrZGF5cyhyLCIiKSsifF4iK3RoaXMud2Vla2RheXNTaG9ydChyLCIiKSsifF4iK3RoaXMud2Vla2RheXNNaW4ociwiIiksdGhpcy5fd2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKHMucmVwbGFjZSgiLiIsIiIpLCJpIikpLGkmJiJkZGRkIj09PWUmJnRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW25dLnRlc3QodCkpcmV0dXJuIG47aWYoaSYmImRkZCI9PT1lJiZ0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbjtpZihpJiYiZGQiPT09ZSYmdGhpcy5fbWluV2Vla2RheXNQYXJzZVtuXS50ZXN0KHQpKXJldHVybiBuO2lmKCFpJiZ0aGlzLl93ZWVrZGF5c1BhcnNlW25dLnRlc3QodCkpcmV0dXJuIG59fWZ1bmN0aW9uIG9pKHQpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gbnVsbCE9dD90aGlzOk5hTjt2YXIgZT10aGlzLl9pc1VUQz90aGlzLl9kLmdldFVUQ0RheSgpOnRoaXMuX2QuZ2V0RGF5KCk7cmV0dXJuIG51bGwhPXQ/KHQ9ZWkodCx0aGlzLmxvY2FsZURhdGEoKSksdGhpcy5hZGQodC1lLCJkIikpOmV9ZnVuY3Rpb24gYWkodCl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsIT10P3RoaXM6TmFOO3ZhciBlPSh0aGlzLmRheSgpKzctdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG93KSU3O3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQodC1lLCJkIil9ZnVuY3Rpb24gbGkodCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpP251bGw9PXQ/dGhpcy5kYXkoKXx8Nzp0aGlzLmRheSh0aGlzLmRheSgpJTc/dDp0LTcpOm51bGwhPXQ/dGhpczpOYU59ZnVuY3Rpb24gY2kodCl7dmFyIGU9TWF0aC5yb3VuZCgodGhpcy5jbG9uZSgpLnN0YXJ0T2YoImRheSIpLXRoaXMuY2xvbmUoKS5zdGFydE9mKCJ5ZWFyIikpLzg2NGU1KSsxO3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQodC1lLCJkIil9ZnVuY3Rpb24gdWkoKXtyZXR1cm4gdGhpcy5ob3VycygpJTEyfHwxMn1mdW5jdGlvbiBkaSh0LGUpe1YodCwwLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubWVyaWRpZW0odGhpcy5ob3VycygpLHRoaXMubWludXRlcygpLGUpfSl9ZnVuY3Rpb24gaGkodCxlKXtyZXR1cm4gZS5fbWVyaWRpZW1QYXJzZX1mdW5jdGlvbiBwaSh0KXtyZXR1cm4icCI9PT0odCsiIikudG9Mb3dlckNhc2UoKS5jaGFyQXQoMCl9ZnVuY3Rpb24gZmkodCxlLGkpe3JldHVybiB0PjExP2k/InBtIjoiUE0iOmk/ImFtIjoiQU0ifWZ1bmN0aW9uIG1pKHQsZSl7ZVtQbl09eSgxZTMqKCIwLiIrdCkpfWZ1bmN0aW9uIF9pKCl7cmV0dXJuIHRoaXMuX2lzVVRDPyJVVEMiOiIifWZ1bmN0aW9uIGdpKCl7cmV0dXJuIHRoaXMuX2lzVVRDPyJDb29yZGluYXRlZCBVbml2ZXJzYWwgVGltZSI6IiJ9ZnVuY3Rpb24gdmkodCl7cmV0dXJuIFJ0KDFlMyp0KX1mdW5jdGlvbiB5aSgpe3JldHVybiBSdC5hcHBseShudWxsLGFyZ3VtZW50cykucGFyc2Vab25lKCl9ZnVuY3Rpb24gYmkodCxlLGkpe3ZhciBuPXRoaXMuX2NhbGVuZGFyW3RdO3JldHVybiBUKG4pP24uY2FsbChlLGkpOm59ZnVuY3Rpb24gd2kodCl7dmFyIGU9dGhpcy5fbG9uZ0RhdGVGb3JtYXRbdF0saT10aGlzLl9sb25nRGF0ZUZvcm1hdFt0LnRvVXBwZXJDYXNlKCldO3JldHVybiBlfHwhaT9lOih0aGlzLl9sb25nRGF0ZUZvcm1hdFt0XT1pLnJlcGxhY2UoL01NTU18TU18RER8ZGRkZC9nLGZ1bmN0aW9uKHQpe3JldHVybiB0LnNsaWNlKDEpfSksdGhpcy5fbG9uZ0RhdGVGb3JtYXRbdF0pfWZ1bmN0aW9uIE1pKCl7cmV0dXJuIHRoaXMuX2ludmFsaWREYXRlfWZ1bmN0aW9uIGtpKHQpe3JldHVybiB0aGlzLl9vcmRpbmFsLnJlcGxhY2UoIiVkIix0KX1mdW5jdGlvbiBUaSh0KXtyZXR1cm4gdH1mdW5jdGlvbiBTaSh0LGUsaSxuKXt2YXIgcj10aGlzLl9yZWxhdGl2ZVRpbWVbaV07cmV0dXJuIFQocik/cih0LGUsaSxuKTpyLnJlcGxhY2UoLyVkL2ksdCl9ZnVuY3Rpb24gTGkodCxlKXt2YXIgaT10aGlzLl9yZWxhdGl2ZVRpbWVbdD4wPyJmdXR1cmUiOiJwYXN0Il07cmV0dXJuIFQoaSk/aShlKTppLnJlcGxhY2UoLyVzL2ksZSl9ZnVuY3Rpb24geGkodCxlLGksbil7dmFyIHI9SSgpLHM9YygpLnNldChuLGUpO3JldHVybiByW2ldKHMsdCl9ZnVuY3Rpb24gRWkodCxlLGksbixyKXtpZigibnVtYmVyIj09dHlwZW9mIHQmJihlPXQsdD12b2lkIDApLHQ9dHx8IiIsbnVsbCE9ZSlyZXR1cm4geGkodCxlLGkscik7dmFyIHMsbz1bXTtmb3Iocz0wO3M8bjtzKyspb1tzXT14aSh0LHMsaSxyKTtyZXR1cm4gb31mdW5jdGlvbiBEaSh0LGUpe3JldHVybiBFaSh0LGUsIm1vbnRocyIsMTIsIm1vbnRoIil9ZnVuY3Rpb24gWWkodCxlKXtyZXR1cm4gRWkodCxlLCJtb250aHNTaG9ydCIsMTIsIm1vbnRoIil9ZnVuY3Rpb24gQ2kodCxlKXtyZXR1cm4gRWkodCxlLCJ3ZWVrZGF5cyIsNywiZGF5Iil9ZnVuY3Rpb24gQWkodCxlKXtyZXR1cm4gRWkodCxlLCJ3ZWVrZGF5c1Nob3J0Iiw3LCJkYXkiKX1mdW5jdGlvbiBPaSh0LGUpe3JldHVybiBFaSh0LGUsIndlZWtkYXlzTWluIiw3LCJkYXkiKX1mdW5jdGlvbiBOaSgpe3ZhciB0PXRoaXMuX2RhdGE7cmV0dXJuIHRoaXMuX21pbGxpc2Vjb25kcz1Mcih0aGlzLl9taWxsaXNlY29uZHMpLHRoaXMuX2RheXM9THIodGhpcy5fZGF5cyksdGhpcy5fbW9udGhzPUxyKHRoaXMuX21vbnRocyksdC5taWxsaXNlY29uZHM9THIodC5taWxsaXNlY29uZHMpLHQuc2Vjb25kcz1Mcih0LnNlY29uZHMpLHQubWludXRlcz1Mcih0Lm1pbnV0ZXMpLHQuaG91cnM9THIodC5ob3VycyksdC5tb250aHM9THIodC5tb250aHMpLHQueWVhcnM9THIodC55ZWFycyksdGhpc31mdW5jdGlvbiBJaSh0LGUsaSxuKXt2YXIgcj1yZShlLGkpO3JldHVybiB0Ll9taWxsaXNlY29uZHMrPW4qci5fbWlsbGlzZWNvbmRzLHQuX2RheXMrPW4qci5fZGF5cyx0Ll9tb250aHMrPW4qci5fbW9udGhzLHQuX2J1YmJsZSgpfWZ1bmN0aW9uIFBpKHQsZSl7cmV0dXJuIElpKHRoaXMsdCxlLDEpfWZ1bmN0aW9uIFJpKHQsZSl7cmV0dXJuIElpKHRoaXMsdCxlLC0xKX1mdW5jdGlvbiBIaSh0KXtyZXR1cm4gdDwwP01hdGguZmxvb3IodCk6TWF0aC5jZWlsKHQpfWZ1bmN0aW9uIGppKCl7dmFyIHQsZSxpLG4scixzPXRoaXMuX21pbGxpc2Vjb25kcyxvPXRoaXMuX2RheXMsYT10aGlzLl9tb250aHMsbD10aGlzLl9kYXRhO3JldHVybiBzPj0wJiZvPj0wJiZhPj0wfHxzPD0wJiZvPD0wJiZhPD0wfHwocys9ODY0ZTUqSGkoVWkoYSkrbyksbz0wLGE9MCksbC5taWxsaXNlY29uZHM9cyUxZTMsdD12KHMvMWUzKSxsLnNlY29uZHM9dCU2MCxlPXYodC82MCksbC5taW51dGVzPWUlNjAsaT12KGUvNjApLGwuaG91cnM9aSUyNCxvKz12KGkvMjQpLHI9dihGaShvKSksYSs9cixvLT1IaShVaShyKSksbj12KGEvMTIpLGElPTEyLGwuZGF5cz1vLGwubW9udGhzPWEsbC55ZWFycz1uLHRoaXN9ZnVuY3Rpb24gRmkodCl7cmV0dXJuIDQ4MDAqdC8xNDYwOTd9ZnVuY3Rpb24gVWkodCl7cmV0dXJuIDE0NjA5Nyp0LzQ4MDB9ZnVuY3Rpb24gV2kodCl7dmFyIGUsaSxuPXRoaXMuX21pbGxpc2Vjb25kcztpZih0PUgodCksIm1vbnRoIj09PXR8fCJ5ZWFyIj09PXQpcmV0dXJuIGU9dGhpcy5fZGF5cytuLzg2NGU1LGk9dGhpcy5fbW9udGhzK0ZpKGUpLCJtb250aCI9PT10P2k6aS8xMjtzd2l0Y2goZT10aGlzLl9kYXlzK01hdGgucm91bmQoVWkodGhpcy5fbW9udGhzKSksdCl7Y2FzZSJ3ZWVrIjpyZXR1cm4gZS83K24vNjA0OGU1O2Nhc2UiZGF5IjpyZXR1cm4gZStuLzg2NGU1O2Nhc2UiaG91ciI6cmV0dXJuIDI0KmUrbi8zNmU1O2Nhc2UibWludXRlIjpyZXR1cm4gMTQ0MCplK24vNmU0O2Nhc2Uic2Vjb25kIjpyZXR1cm4gODY0MDAqZStuLzFlMztjYXNlIm1pbGxpc2Vjb25kIjpyZXR1cm4gTWF0aC5mbG9vcig4NjRlNSplKStuO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbmtub3duIHVuaXQgIit0KX19ZnVuY3Rpb24gQmkoKXtyZXR1cm4gdGhpcy5fbWlsbGlzZWNvbmRzKzg2NGU1KnRoaXMuX2RheXMrdGhpcy5fbW9udGhzJTEyKjI1OTJlNiszMTUzNmU2KnkodGhpcy5fbW9udGhzLzEyKX1mdW5jdGlvbiB6aSh0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcyh0KX19ZnVuY3Rpb24gVmkodCl7cmV0dXJuIHQ9SCh0KSx0aGlzW3QrInMiXSgpfWZ1bmN0aW9uICRpKHQpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhW3RdfX1mdW5jdGlvbiBxaSgpe3JldHVybiB2KHRoaXMuZGF5cygpLzcpfWZ1bmN0aW9uIEdpKHQsZSxpLG4scil7cmV0dXJuIHIucmVsYXRpdmVUaW1lKGV8fDEsISFpLHQsbil9ZnVuY3Rpb24gSmkodCxlLGkpe3ZhciBuPXJlKHQpLmFicygpLHI9V3Iobi5hcygicyIpKSxzPVdyKG4uYXMoIm0iKSksbz1XcihuLmFzKCJoIikpLGE9V3Iobi5hcygiZCIpKSxsPVdyKG4uYXMoIk0iKSksYz1XcihuLmFzKCJ5IikpLHU9cjxCci5zJiZbInMiLHJdfHxzPD0xJiZbIm0iXXx8czxCci5tJiZbIm1tIixzXXx8bzw9MSYmWyJoIl18fG88QnIuaCYmWyJoaCIsb118fGE8PTEmJlsiZCJdfHxhPEJyLmQmJlsiZGQiLGFdfHxsPD0xJiZbIk0iXXx8bDxCci5NJiZbIk1NIixsXXx8Yzw9MSYmWyJ5Il18fFsieXkiLGNdO3JldHVybiB1WzJdPWUsdVszXT0rdD4wLHVbNF09aSxHaS5hcHBseShudWxsLHUpfWZ1bmN0aW9uIEtpKHQsZSl7cmV0dXJuIHZvaWQgMCE9PUJyW3RdJiYodm9pZCAwPT09ZT9Cclt0XTooQnJbdF09ZSwhMCkpfWZ1bmN0aW9uIFFpKHQpe3ZhciBlPXRoaXMubG9jYWxlRGF0YSgpLGk9SmkodGhpcywhdCxlKTtyZXR1cm4gdCYmKGk9ZS5wYXN0RnV0dXJlKCt0aGlzLGkpKSxlLnBvc3Rmb3JtYXQoaSl9ZnVuY3Rpb24gWGkoKXt2YXIgdCxlLGksbj16cih0aGlzLl9taWxsaXNlY29uZHMpLzFlMyxyPXpyKHRoaXMuX2RheXMpLHM9enIodGhpcy5fbW9udGhzKTt0PXYobi82MCksZT12KHQvNjApLG4lPTYwLHQlPTYwLGk9dihzLzEyKSxzJT0xMjt2YXIgbz1pLGE9cyxsPXIsYz1lLHU9dCxkPW4saD10aGlzLmFzU2Vjb25kcygpO3JldHVybiBoPyhoPDA/Ii0iOiIiKSsiUCIrKG8/bysiWSI6IiIpKyhhP2ErIk0iOiIiKSsobD9sKyJEIjoiIikrKGN8fHV8fGQ/IlQiOiIiKSsoYz9jKyJIIjoiIikrKHU/dSsiTSI6IiIpKyhkP2QrIlMiOiIiKToiUDBEIn12YXIgWmksdG49ZS5tb21lbnRQcm9wZXJ0aWVzPVtdLGVuPSExLG5uPXt9O2Uuc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzPSExO3ZhciBybixzbj17fSxvbj17fSxhbj0vKFxbW15cW10qXF0pfChcXCk/KFtIaF1tbShzcyk/fE1vfE1NP00/TT98RG98REREb3xERD9EP0Q/fGRkZD9kP3xkbz98d1tvfHddP3xXW298V10/fFFvP3xZWVlZWVl8WVlZWVl8WVlZWXxZWXxnZyhnZ2c/KT98R0coR0dHPyk/fGV8RXxhfEF8aGg/fEhIP3xtbT98c3M/fFN7MSw5fXx4fFh8eno/fFpaP3wuKS9nLGxuPS8oXFtbXlxbXSpcXSl8KFxcKT8oTFRTfExUfExMP0w/TD98bHsxLDR9KS9nLGNuPXt9LHVuPXt9LGRuPS9cZC8saG49L1xkXGQvLHBuPS9cZHszfS8sZm49L1xkezR9Lyxtbj0vWystXT9cZHs2fS8sX249L1xkXGQ/Lyxnbj0vXGRcZFxkXGQ/Lyx2bj0vXGRcZFxkXGRcZFxkPy8seW49L1xkezEsM30vLGJuPS9cZHsxLDR9Lyx3bj0vWystXT9cZHsxLDZ9LyxNbj0vXGQrLyxrbj0vWystXT9cZCsvLFRuPS9afFsrLV1cZFxkOj9cZFxkL2dpLFNuPS9afFsrLV1cZFxkKD86Oj9cZFxkKT8vZ2ksTG49L1srLV0/XGQrKFwuXGR7MSwzfSk/Lyx4bj0vWzAtOV0qWydhLXpcdTAwQTAtXHUwNUZGXHUwNzAwLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkVGXSt8W1x1MDYwMC1cdTA2RkZcL10rKFxzKj9bXHUwNjAwLVx1MDZGRl0rKXsxLDJ9L2ksRW49e30sRG49e30sWW49MCxDbj0xLEFuPTIsT249MyxObj00LEluPTUsUG49NixSbj03LEhuPTg7VigiTSIsWyJNTSIsMl0sIk1vIixmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vbnRoKCkrMX0pLFYoIk1NTSIsMCwwLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5tb250aHNTaG9ydCh0aGlzLHQpfSksVigiTU1NTSIsMCwwLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5tb250aHModGhpcyx0KX0pLFIoIm1vbnRoIiwiTSIpLEsoIk0iLF9uKSxLKCJNTSIsX24saG4pLEsoIk1NTSIsZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5tb250aHNTaG9ydFJlZ2V4KHQpfSksSygiTU1NTSIsZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5tb250aHNSZWdleCh0KX0pLHR0KFsiTSIsIk1NIl0sZnVuY3Rpb24odCxlKXtlW0NuXT15KHQpLTF9KSx0dChbIk1NTSIsIk1NTU0iXSxmdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1pLl9sb2NhbGUubW9udGhzUGFyc2UodCxuLGkuX3N0cmljdCk7bnVsbCE9cj9lW0NuXT1yOmQoaSkuaW52YWxpZE1vbnRoPXR9KTt2YXIgam49L0Rbb0RdPyhcW1teXFtcXV0qXF18XHMrKStNTU1NPy8sRm49IkphbnVhcnlfRmVicnVhcnlfTWFyY2hfQXByaWxfTWF5X0p1bmVfSnVseV9BdWd1c3RfU2VwdGVtYmVyX09jdG9iZXJfTm92ZW1iZXJfRGVjZW1iZXIiLnNwbGl0KCJfIiksVW49Ikphbl9GZWJfTWFyX0Fwcl9NYXlfSnVuX0p1bF9BdWdfU2VwX09jdF9Ob3ZfRGVjIi5zcGxpdCgiXyIpLFduPXhuLEJuPXhuLHpuPS9eXHMqKCg/OlsrLV1cZHs2fXxcZHs0fSktKD86XGRcZC1cZFxkfFdcZFxkLVxkfFdcZFxkfFxkXGRcZHxcZFxkKSkoPzooVHwgKShcZFxkKD86OlxkXGQoPzo6XGRcZCg/OlsuLF1cZCspPyk/KT8pKFtcK1wtXVxkXGQoPzo6P1xkXGQpP3xccypaKT8pPy8sVm49L15ccyooKD86WystXVxkezZ9fFxkezR9KSg/OlxkXGRcZFxkfFdcZFxkXGR8V1xkXGR8XGRcZFxkfFxkXGQpKSg/OihUfCApKFxkXGQoPzpcZFxkKD86XGRcZCg/OlsuLF1cZCspPyk/KT8pKFtcK1wtXVxkXGQoPzo6P1xkXGQpP3xccypaKT8pPy8sJG49L1p8WystXVxkXGQoPzo6P1xkXGQpPy8scW49W1siWVlZWVlZLU1NLUREIiwvWystXVxkezZ9LVxkXGQtXGRcZC9dLFsiWVlZWS1NTS1ERCIsL1xkezR9LVxkXGQtXGRcZC9dLFsiR0dHRy1bV11XVy1FIiwvXGR7NH0tV1xkXGQtXGQvXSxbIkdHR0ctW1ddV1ciLC9cZHs0fS1XXGRcZC8sITFdLFsiWVlZWS1EREQiLC9cZHs0fS1cZHszfS9dLFsiWVlZWS1NTSIsL1xkezR9LVxkXGQvLCExXSxbIllZWVlZWU1NREQiLC9bKy1dXGR7MTB9L10sWyJZWVlZTU1ERCIsL1xkezh9L10sWyJHR0dHW1ddV1dFIiwvXGR7NH1XXGR7M30vXSxbIkdHR0dbV11XVyIsL1xkezR9V1xkezJ9LywhMV0sWyJZWVlZREREIiwvXGR7N30vXV0sR249W1siSEg6bW06c3MuU1NTUyIsL1xkXGQ6XGRcZDpcZFxkXC5cZCsvXSxbIkhIOm1tOnNzLFNTU1MiLC9cZFxkOlxkXGQ6XGRcZCxcZCsvXSxbIkhIOm1tOnNzIiwvXGRcZDpcZFxkOlxkXGQvXSxbIkhIOm1tIiwvXGRcZDpcZFxkL10sWyJISG1tc3MuU1NTUyIsL1xkXGRcZFxkXGRcZFwuXGQrL10sWyJISG1tc3MsU1NTUyIsL1xkXGRcZFxkXGRcZCxcZCsvXSxbIkhIbW1zcyIsL1xkXGRcZFxkXGRcZC9dLFsiSEhtbSIsL1xkXGRcZFxkL10sWyJISCIsL1xkXGQvXV0sSm49L15cLz9EYXRlXCgoXC0/XGQrKS9pO2UuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2s9TSgibW9tZW50IGNvbnN0cnVjdGlvbiBmYWxscyBiYWNrIHRvIGpzIERhdGUuIFRoaXMgaXMgZGlzY291cmFnZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB1cGNvbWluZyBtYWpvciByZWxlYXNlLiBQbGVhc2UgcmVmZXIgdG8gaHR0cHM6Ly9naXRodWIuY29tL21vbWVudC9tb21lbnQvaXNzdWVzLzE0MDcgZm9yIG1vcmUgaW5mby4iLGZ1bmN0aW9uKHQpe3QuX2Q9bmV3IERhdGUodC5faSsodC5fdXNlVVRDPyIgVVRDIjoiIikpfSksVigiWSIsMCwwLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy55ZWFyKCk7cmV0dXJuIHQ8PTk5OTk/IiIrdDoiKyIrdH0pLFYoMCxbIllZIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueWVhcigpJTEwMH0pLFYoMCxbIllZWVkiLDRdLDAsInllYXIiKSxWKDAsWyJZWVlZWSIsNV0sMCwieWVhciIpLFYoMCxbIllZWVlZWSIsNiwhMF0sMCwieWVhciIpLFIoInllYXIiLCJ5IiksSygiWSIsa24pLEsoIllZIixfbixobiksSygiWVlZWSIsYm4sZm4pLEsoIllZWVlZIix3bixtbiksSygiWVlZWVlZIix3bixtbiksdHQoWyJZWVlZWSIsIllZWVlZWSJdLFluKSx0dCgiWVlZWSIsZnVuY3Rpb24odCxpKXtpW1luXT0yPT09dC5sZW5ndGg/ZS5wYXJzZVR3b0RpZ2l0WWVhcih0KTp5KHQpfSksdHQoIllZIixmdW5jdGlvbih0LGkpe2lbWW5dPWUucGFyc2VUd29EaWdpdFllYXIodCl9KSx0dCgiWSIsZnVuY3Rpb24odCxlKXtlW1luXT1wYXJzZUludCh0LDEwKX0pLGUucGFyc2VUd29EaWdpdFllYXI9ZnVuY3Rpb24odCl7cmV0dXJuIHkodCkrKHkodCk+Njg/MTkwMDoyZTMpfTt2YXIgS249RigiRnVsbFllYXIiLCExKTtlLklTT184NjAxPWZ1bmN0aW9uKCl7fTt2YXIgUW49TSgibW9tZW50KCkubWluIGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQubWF4IGluc3RlYWQuIGh0dHBzOi8vZ2l0aHViLmNvbS9tb21lbnQvbW9tZW50L2lzc3Vlcy8xNTQ4IixmdW5jdGlvbigpe3ZhciB0PVJ0LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJnQuaXNWYWxpZCgpP3Q8dGhpcz90aGlzOnQ6cCgpfSksWG49TSgibW9tZW50KCkubWF4IGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQubWluIGluc3RlYWQuIGh0dHBzOi8vZ2l0aHViLmNvbS9tb21lbnQvbW9tZW50L2lzc3Vlcy8xNTQ4IixmdW5jdGlvbigpe3ZhciB0PVJ0LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJnQuaXNWYWxpZCgpP3Q+dGhpcz90aGlzOnQ6cCgpfSksWm49ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3c/RGF0ZS5ub3coKTorbmV3IERhdGV9O0J0KCJaIiwiOiIpLEJ0KCJaWiIsIiIpLEsoIloiLFNuKSxLKCJaWiIsU24pLHR0KFsiWiIsIlpaIl0sZnVuY3Rpb24odCxlLGkpe2kuX3VzZVVUQz0hMCxpLl90em09enQoU24sdCl9KTt2YXIgdHI9LyhbXCtcLV18XGRcZCkvZ2k7ZS51cGRhdGVPZmZzZXQ9ZnVuY3Rpb24oKXt9O3ZhciBlcj0vXihcLSk/KD86KFxkKilbLiBdKT8oXGQrKVw6KFxkKykoPzpcOihcZCspXC4/KFxkezN9KT9cZCopPyQvLGlyPS9eKC0pP1AoPzooWzAtOSwuXSopWSk/KD86KFswLTksLl0qKU0pPyg/OihbMC05LC5dKilXKT8oPzooWzAtOSwuXSopRCk/KD86VCg/OihbMC05LC5dKilIKT8oPzooWzAtOSwuXSopTSk/KD86KFswLTksLl0qKVMpPyk/JC87cmUuZm49VXQucHJvdG90eXBlO3ZhciBucj1jZSgxLCJhZGQiKSxycj1jZSgtMSwic3VidHJhY3QiKTtlLmRlZmF1bHRGb3JtYXQ9IllZWVktTU0tRERUSEg6bW06c3NaIjt2YXIgc3I9TSgibW9tZW50KCkubGFuZygpIGlzIGRlcHJlY2F0ZWQuIEluc3RlYWQsIHVzZSBtb21lbnQoKS5sb2NhbGVEYXRhKCkgdG8gZ2V0IHRoZSBsYW5ndWFnZSBjb25maWd1cmF0aW9uLiBVc2UgbW9tZW50KCkubG9jYWxlKCkgdG8gY2hhbmdlIGxhbmd1YWdlcy4iLGZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10P3RoaXMubG9jYWxlRGF0YSgpOnRoaXMubG9jYWxlKHQpfSk7VigwLFsiZ2ciLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53ZWVrWWVhcigpJTEwMH0pLFYoMCxbIkdHIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNvV2Vla1llYXIoKSUxMDB9KSxXZSgiZ2dnZyIsIndlZWtZZWFyIiksV2UoImdnZ2dnIiwid2Vla1llYXIiKSxXZSgiR0dHRyIsImlzb1dlZWtZZWFyIiksV2UoIkdHR0dHIiwiaXNvV2Vla1llYXIiKSxSKCJ3ZWVrWWVhciIsImdnIiksUigiaXNvV2Vla1llYXIiLCJHRyIpLEsoIkciLGtuKSxLKCJnIixrbiksSygiR0ciLF9uLGhuKSxLKCJnZyIsX24saG4pLEsoIkdHR0ciLGJuLGZuKSxLKCJnZ2dnIixibixmbiksSygiR0dHR0ciLHduLG1uKSxLKCJnZ2dnZyIsd24sbW4pLGV0KFsiZ2dnZyIsImdnZ2dnIiwiR0dHRyIsIkdHR0dHIl0sZnVuY3Rpb24odCxlLGksbil7ZVtuLnN1YnN0cigwLDIpXT15KHQpfSksZXQoWyJnZyIsIkdHIl0sZnVuY3Rpb24odCxpLG4scil7aVtyXT1lLnBhcnNlVHdvRGlnaXRZZWFyKHQpfSksVigiUSIsMCwiUW8iLCJxdWFydGVyIiksUigicXVhcnRlciIsIlEiKSxLKCJRIixkbiksdHQoIlEiLGZ1bmN0aW9uKHQsZSl7ZVtDbl09MyooeSh0KS0xKX0pLFYoInciLFsid3ciLDJdLCJ3byIsIndlZWsiKSxWKCJXIixbIldXIiwyXSwiV28iLCJpc29XZWVrIiksUigid2VlayIsInciKSxSKCJpc29XZWVrIiwiVyIpLEsoInciLF9uKSxLKCJ3dyIsX24saG4pLEsoIlciLF9uKSxLKCJXVyIsX24saG4pLGV0KFsidyIsInd3IiwiVyIsIldXIl0sZnVuY3Rpb24odCxlLGksbil7ZVtuLnN1YnN0cigwLDEpXT15KHQpfSk7dmFyIG9yPXtkb3c6MCxkb3k6Nn07VigiRCIsWyJERCIsMl0sIkRvIiwiZGF0ZSIpLFIoImRhdGUiLCJEIiksSygiRCIsX24pLEsoIkREIixfbixobiksSygiRG8iLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ/ZS5fb3JkaW5hbFBhcnNlOmUuX29yZGluYWxQYXJzZUxlbmllbnR9KSx0dChbIkQiLCJERCJdLEFuKSx0dCgiRG8iLGZ1bmN0aW9uKHQsZSl7ZVtBbl09eSh0Lm1hdGNoKF9uKVswXSwxMCl9KTt2YXIgYXI9RigiRGF0ZSIsITApO1YoImQiLDAsImRvIiwiZGF5IiksVigiZGQiLDAsMCxmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXNNaW4odGhpcyx0KX0pLFYoImRkZCIsMCwwLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5c1Nob3J0KHRoaXMsdCl9KSxWKCJkZGRkIiwwLDAsZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzKHRoaXMsdCl9KSxWKCJlIiwwLDAsIndlZWtkYXkiKSxWKCJFIiwwLDAsImlzb1dlZWtkYXkiKSxSKCJkYXkiLCJkIiksUigid2Vla2RheSIsImUiKSxSKCJpc29XZWVrZGF5IiwiRSIpLEsoImQiLF9uKSxLKCJlIixfbiksSygiRSIsX24pLEsoImRkIix4biksSygiZGRkIix4biksSygiZGRkZCIseG4pLGV0KFsiZGQiLCJkZGQiLCJkZGRkIl0sZnVuY3Rpb24odCxlLGksbil7dmFyIHI9aS5fbG9jYWxlLndlZWtkYXlzUGFyc2UodCxuLGkuX3N0cmljdCk7bnVsbCE9cj9lLmQ9cjpkKGkpLmludmFsaWRXZWVrZGF5PXR9KSxldChbImQiLCJlIiwiRSJdLGZ1bmN0aW9uKHQsZSxpLG4pe2Vbbl09eSh0KX0pO3ZhciBscj0iU3VuZGF5X01vbmRheV9UdWVzZGF5X1dlZG5lc2RheV9UaHVyc2RheV9GcmlkYXlfU2F0dXJkYXkiLnNwbGl0KCJfIiksY3I9IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx1cj0iU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIik7VigiREREIixbIkREREQiLDNdLCJERERvIiwiZGF5T2ZZZWFyIiksUigiZGF5T2ZZZWFyIiwiREREIiksSygiREREIix5biksSygiRERERCIscG4pLHR0KFsiREREIiwiRERERCJdLGZ1bmN0aW9uKHQsZSxpKXtpLl9kYXlPZlllYXI9eSh0KX0pLFYoIkgiLFsiSEgiLDJdLDAsImhvdXIiKSxWKCJoIixbImhoIiwyXSwwLHVpKSxWKCJobW0iLDAsMCxmdW5jdGlvbigpe3JldHVybiIiK3VpLmFwcGx5KHRoaXMpK3oodGhpcy5taW51dGVzKCksMil9KSxWKCJobW1zcyIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIiIrdWkuYXBwbHkodGhpcykreih0aGlzLm1pbnV0ZXMoKSwyKSt6KHRoaXMuc2Vjb25kcygpLDIpfSksVigiSG1tIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm4iIit0aGlzLmhvdXJzKCkreih0aGlzLm1pbnV0ZXMoKSwyKX0pLFYoIkhtbXNzIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm4iIit0aGlzLmhvdXJzKCkreih0aGlzLm1pbnV0ZXMoKSwyKSt6KHRoaXMuc2Vjb25kcygpLDIpfSksZGkoImEiLCEwKSxkaSgiQSIsITEpLFIoImhvdXIiLCJoIiksSygiYSIsaGkpLEsoIkEiLGhpKSxLKCJIIixfbiksSygiaCIsX24pLEsoIkhIIixfbixobiksSygiaGgiLF9uLGhuKSxLKCJobW0iLGduKSxLKCJobW1zcyIsdm4pLEsoIkhtbSIsZ24pLEsoIkhtbXNzIix2biksdHQoWyJIIiwiSEgiXSxPbiksdHQoWyJhIiwiQSJdLGZ1bmN0aW9uKHQsZSxpKXtpLl9pc1BtPWkuX2xvY2FsZS5pc1BNKHQpLGkuX21lcmlkaWVtPXR9KSx0dChbImgiLCJoaCJdLGZ1bmN0aW9uKHQsZSxpKXtlW09uXT15KHQpLGQoaSkuYmlnSG91cj0hMH0pLHR0KCJobW0iLGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Lmxlbmd0aC0yO2VbT25dPXkodC5zdWJzdHIoMCxuKSksZVtObl09eSh0LnN1YnN0cihuKSksZChpKS5iaWdIb3VyPSEwfSksdHQoImhtbXNzIixmdW5jdGlvbih0LGUsaSl7dmFyIG49dC5sZW5ndGgtNCxyPXQubGVuZ3RoLTI7ZVtPbl09eSh0LnN1YnN0cigwLG4pKSxlW05uXT15KHQuc3Vic3RyKG4sMikpLGVbSW5dPXkodC5zdWJzdHIocikpLGQoaSkuYmlnSG91cj0hMH0pLHR0KCJIbW0iLGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Lmxlbmd0aC0yO2VbT25dPXkodC5zdWJzdHIoMCxuKSksZVtObl09eSh0LnN1YnN0cihuKSl9KSx0dCgiSG1tc3MiLGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Lmxlbmd0aC00LHI9dC5sZW5ndGgtMjtlW09uXT15KHQuc3Vic3RyKDAsbikpLGVbTm5dPXkodC5zdWJzdHIobiwyKSksZVtJbl09eSh0LnN1YnN0cihyKSl9KTt2YXIgZHI9L1thcF1cLj9tP1wuPy9pLGhyPUYoIkhvdXJzIiwhMCk7VigibSIsWyJtbSIsMl0sMCwibWludXRlIiksUigibWludXRlIiwibSIpLEsoIm0iLF9uKSxLKCJtbSIsX24saG4pLHR0KFsibSIsIm1tIl0sTm4pO3ZhciBwcj1GKCJNaW51dGVzIiwhMSk7VigicyIsWyJzcyIsMl0sMCwic2Vjb25kIiksUigic2Vjb25kIiwicyIpLEsoInMiLF9uKSxLKCJzcyIsX24saG4pLHR0KFsicyIsInNzIl0sSW4pO3ZhciBmcj1GKCJTZWNvbmRzIiwhMSk7VigiUyIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJufn4odGhpcy5taWxsaXNlY29uZCgpLzEwMCl9KSxWKDAsWyJTUyIsMl0sMCxmdW5jdGlvbigpe3JldHVybn5+KHRoaXMubWlsbGlzZWNvbmQoKS8xMCl9KSxWKDAsWyJTU1MiLDNdLDAsIm1pbGxpc2Vjb25kIiksVigwLFsiU1NTUyIsNF0sMCxmdW5jdGlvbigpe3JldHVybiAxMCp0aGlzLm1pbGxpc2Vjb25kKCl9KSxWKDAsWyJTU1NTUyIsNV0sMCxmdW5jdGlvbigpe3JldHVybiAxMDAqdGhpcy5taWxsaXNlY29uZCgpfSksVigwLFsiU1NTU1NTIiw2XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlMyp0aGlzLm1pbGxpc2Vjb25kKCl9KSxWKDAsWyJTU1NTU1NTIiw3XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlNCp0aGlzLm1pbGxpc2Vjb25kKCl9KSxWKDAsWyJTU1NTU1NTUyIsOF0sMCxmdW5jdGlvbigpe3JldHVybiAxZTUqdGhpcy5taWxsaXNlY29uZCgpfSksVigwLFsiU1NTU1NTU1NTIiw5XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlNip0aGlzLm1pbGxpc2Vjb25kKCl9KSxSKCJtaWxsaXNlY29uZCIsIm1zIiksSygiUyIseW4sZG4pLEsoIlNTIix5bixobiksSygiU1NTIix5bixwbik7dmFyIG1yO2Zvcihtcj0iU1NTUyI7bXIubGVuZ3RoPD05O21yKz0iUyIpSyhtcixNbik7Zm9yKG1yPSJTIjttci5sZW5ndGg8PTk7bXIrPSJTIil0dChtcixtaSk7dmFyIF9yPUYoIk1pbGxpc2Vjb25kcyIsITEpO1YoInoiLDAsMCwiem9uZUFiYnIiKSxWKCJ6eiIsMCwwLCJ6b25lTmFtZSIpO3ZhciBncj1fLnByb3RvdHlwZTtnci5hZGQ9bnIsZ3IuY2FsZW5kYXI9ZGUsZ3IuY2xvbmU9aGUsZ3IuZGlmZj15ZSxnci5lbmRPZj1DZSxnci5mb3JtYXQ9a2UsZ3IuZnJvbT1UZSxnci5mcm9tTm93PVNlLGdyLnRvPUxlLGdyLnRvTm93PXhlLGdyLmdldD1CLGdyLmludmFsaWRBdD1GZSxnci5pc0FmdGVyPXBlLGdyLmlzQmVmb3JlPWZlLGdyLmlzQmV0d2Vlbj1tZSxnci5pc1NhbWU9X2UsZ3IuaXNTYW1lT3JBZnRlcj1nZSxnci5pc1NhbWVPckJlZm9yZT12ZSxnci5pc1ZhbGlkPUhlLGdyLmxhbmc9c3IsZ3IubG9jYWxlPUVlLGdyLmxvY2FsZURhdGE9RGUsZ3IubWF4PVhuLGdyLm1pbj1Rbixnci5wYXJzaW5nRmxhZ3M9amUsZ3Iuc2V0PUIsZ3Iuc3RhcnRPZj1ZZSxnci5zdWJ0cmFjdD1ycixnci50b0FycmF5PUllLGdyLnRvT2JqZWN0PVBlLGdyLnRvRGF0ZT1OZSxnci50b0lTT1N0cmluZz1NZSxnci50b0pTT049UmUsZ3IudG9TdHJpbmc9d2UsZ3IudW5peD1PZSxnci52YWx1ZU9mPUFlLGdyLmNyZWF0aW9uRGF0YT1VZSxnci55ZWFyPUtuLGdyLmlzTGVhcFllYXI9YnQsZ3Iud2Vla1llYXI9QmUsZ3IuaXNvV2Vla1llYXI9emUsZ3IucXVhcnRlcj1nci5xdWFydGVycz1KZSxnci5tb250aD1sdCxnci5kYXlzSW5Nb250aD1jdCxnci53ZWVrPWdyLndlZWtzPVplLGdyLmlzb1dlZWs9Z3IuaXNvV2Vla3M9dGksZ3Iud2Vla3NJblllYXI9JGUsZ3IuaXNvV2Vla3NJblllYXI9VmUsZ3IuZGF0ZT1hcixnci5kYXk9Z3IuZGF5cz1vaSxnci53ZWVrZGF5PWFpLGdyLmlzb1dlZWtkYXk9bGksZ3IuZGF5T2ZZZWFyPWNpLGdyLmhvdXI9Z3IuaG91cnM9aHIsZ3IubWludXRlPWdyLm1pbnV0ZXM9cHIsZ3Iuc2Vjb25kPWdyLnNlY29uZHM9ZnIsZ3IubWlsbGlzZWNvbmQ9Z3IubWlsbGlzZWNvbmRzPV9yLGdyLnV0Y09mZnNldD1xdCxnci51dGM9SnQsZ3IubG9jYWw9S3QsZ3IucGFyc2Vab25lPVF0LGdyLmhhc0FsaWduZWRIb3VyT2Zmc2V0PVh0LGdyLmlzRFNUPVp0LGdyLmlzRFNUU2hpZnRlZD10ZSxnci5pc0xvY2FsPWVlLGdyLmlzVXRjT2Zmc2V0PWllLGdyLmlzVXRjPW5lLGdyLmlzVVRDPW5lLGdyLnpvbmVBYmJyPV9pLGdyLnpvbmVOYW1lPWdpLGdyLmRhdGVzPU0oImRhdGVzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSBkYXRlIGluc3RlYWQuIixhciksZ3IubW9udGhzPU0oIm1vbnRocyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgbW9udGggaW5zdGVhZCIsbHQpLGdyLnllYXJzPU0oInllYXJzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSB5ZWFyIGluc3RlYWQiLEtuKSxnci56b25lPU0oIm1vbWVudCgpLnpvbmUgaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudCgpLnV0Y09mZnNldCBpbnN0ZWFkLiBodHRwczovL2dpdGh1Yi5jb20vbW9tZW50L21vbWVudC9pc3N1ZXMvMTc3OSIsR3QpO3ZhciB2cj1ncix5cj17c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LGJyPXtMVFM6Img6bW06c3MgQSIsTFQ6Img6bW0gQSIsTDoiTU0vREQvWVlZWSIsTEw6Ik1NTU0gRCwgWVlZWSIsTExMOiJNTU1NIEQsIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBNTU1NIEQsIFlZWVkgaDptbSBBIn0sd3I9IkludmFsaWQgZGF0ZSIsTXI9IiVkIixrcj0vXGR7MSwyfS8sVHI9e2Z1dHVyZToiaW4gJXMiLHBhc3Q6IiVzIGFnbyIsczoiYSBmZXcgc2Vjb25kcyIsbToiYSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJhbiBob3VyIixoaDoiJWQgaG91cnMiLGQ6ImEgZGF5IixkZDoiJWQgZGF5cyIsTToiYSBtb250aCIsTU06IiVkIG1vbnRocyIseToiYSB5ZWFyIix5eToiJWQgeWVhcnMifSxTcj1FLnByb3RvdHlwZTtTci5fY2FsZW5kYXI9eXIsU3IuY2FsZW5kYXI9YmksU3IuX2xvbmdEYXRlRm9ybWF0PWJyLFNyLmxvbmdEYXRlRm9ybWF0PXdpLFNyLl9pbnZhbGlkRGF0ZT13cixTci5pbnZhbGlkRGF0ZT1NaSxTci5fb3JkaW5hbD1NcixTci5vcmRpbmFsPWtpLFNyLl9vcmRpbmFsUGFyc2U9a3IsU3IucHJlcGFyc2U9VGksU3IucG9zdGZvcm1hdD1UaSxTci5fcmVsYXRpdmVUaW1lPVRyLFNyLnJlbGF0aXZlVGltZT1TaSxTci5wYXN0RnV0dXJlPUxpLFNyLnNldD1MLFNyLm1vbnRocz1ydCxTci5fbW9udGhzPUZuLFNyLm1vbnRoc1Nob3J0PXN0LFNyLl9tb250aHNTaG9ydD1VbixTci5tb250aHNQYXJzZT1vdCxTci5fbW9udGhzUmVnZXg9Qm4sU3IubW9udGhzUmVnZXg9ZHQsU3IuX21vbnRoc1Nob3J0UmVnZXg9V24sU3IubW9udGhzU2hvcnRSZWdleD11dCxTci53ZWVrPUtlLFNyLl93ZWVrPW9yLFNyLmZpcnN0RGF5T2ZZZWFyPVhlLFNyLmZpcnN0RGF5T2ZXZWVrPVFlLFNyLndlZWtkYXlzPWlpLFNyLl93ZWVrZGF5cz1scixTci53ZWVrZGF5c01pbj1yaSxTci5fd2Vla2RheXNNaW49dXIsU3Iud2Vla2RheXNTaG9ydD1uaSxTci5fd2Vla2RheXNTaG9ydD1jcixTci53ZWVrZGF5c1BhcnNlPXNpLFNyLmlzUE09cGksU3IuX21lcmlkaWVtUGFyc2U9ZHIsU3IubWVyaWRpZW09ZmksQSgiZW4iLHtvcmRpbmFsUGFyc2U6L1xkezEsMn0odGh8c3R8bmR8cmQpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT0xPT09eSh0JTEwMC8xMCk/InRoIjoxPT09ZT8ic3QiOjI9PT1lPyJuZCI6Mz09PWU/InJkIjoidGgiO3JldHVybiB0K2l9fSksZS5sYW5nPU0oIm1vbWVudC5sYW5nIGlzIGRlcHJlY2F0ZWQuIFVzZSBtb21lbnQubG9jYWxlIGluc3RlYWQuIixBKSxlLmxhbmdEYXRhPU0oIm1vbWVudC5sYW5nRGF0YSBpcyBkZXByZWNhdGVkLiBVc2UgbW9tZW50LmxvY2FsZURhdGEgaW5zdGVhZC4iLEkpO3ZhciBMcj1NYXRoLmFicyx4cj16aSgibXMiKSxFcj16aSgicyIpLERyPXppKCJtIiksWXI9emkoImgiKSxDcj16aSgiZCIpLEFyPXppKCJ3IiksT3I9emkoIk0iKSxOcj16aSgieSIpLElyPSRpKCJtaWxsaXNlY29uZHMiKSxQcj0kaSgic2Vjb25kcyIpLFJyPSRpKCJtaW51dGVzIiksSHI9JGkoImhvdXJzIiksanI9JGkoImRheXMiKSxGcj0kaSgibW9udGhzIiksVXI9JGkoInllYXJzIiksV3I9TWF0aC5yb3VuZCxCcj17czo0NSxtOjQ1LGg6MjIsZDoyNixNOjExfSx6cj1NYXRoLmFicyxWcj1VdC5wcm90b3R5cGU7VnIuYWJzPU5pLFZyLmFkZD1QaSxWci5zdWJ0cmFjdD1SaSxWci5hcz1XaSxWci5hc01pbGxpc2Vjb25kcz14cixWci5hc1NlY29uZHM9RXIsVnIuYXNNaW51dGVzPURyLFZyLmFzSG91cnM9WXIsVnIuYXNEYXlzPUNyLFZyLmFzV2Vla3M9QXIsVnIuYXNNb250aHM9T3IsVnIuYXNZZWFycz1OcixWci52YWx1ZU9mPUJpLFZyLl9idWJibGU9amksVnIuZ2V0PVZpLFZyLm1pbGxpc2Vjb25kcz1JcixWci5zZWNvbmRzPVByLFZyLm1pbnV0ZXM9UnIsVnIuaG91cnM9SHIsVnIuZGF5cz1qcixWci53ZWVrcz1xaSxWci5tb250aHM9RnIsVnIueWVhcnM9VXIsVnIuaHVtYW5pemU9UWksVnIudG9JU09TdHJpbmc9WGksVnIudG9TdHJpbmc9WGksVnIudG9KU09OPVhpLFZyLmxvY2FsZT1FZSxWci5sb2NhbGVEYXRhPURlLFZyLnRvSXNvU3RyaW5nPU0oInRvSXNvU3RyaW5nKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0b0lTT1N0cmluZygpIGluc3RlYWQgKG5vdGljZSB0aGUgY2FwaXRhbHMpIixYaSksVnIubGFuZz1zcixWKCJYIiwwLDAsInVuaXgiKSxWKCJ4IiwwLDAsInZhbHVlT2YiKSxLKCJ4IixrbiksSygiWCIsTG4pLHR0KCJYIixmdW5jdGlvbih0LGUsaSl7aS5fZD1uZXcgRGF0ZSgxZTMqcGFyc2VGbG9hdCh0LDEwKSl9KSx0dCgieCIsZnVuY3Rpb24odCxlLGkpe2kuX2Q9bmV3IERhdGUoeSh0KSl9KSxlLnZlcnNpb249IjIuMTIuMCIsbihSdCksZS5mbj12cixlLm1pbj1qdCxlLm1heD1GdCxlLm5vdz1abixlLnV0Yz1jLGUudW5peD12aSxlLm1vbnRocz1EaSxlLmlzRGF0ZT1zLGUubG9jYWxlPUEsZS5pbnZhbGlkPXAsZS5kdXJhdGlvbj1yZSxlLmlzTW9tZW50PWcsZS53ZWVrZGF5cz1DaSxlLnBhcnNlWm9uZT15aSxlLmxvY2FsZURhdGE9SSxlLmlzRHVyYXRpb249V3QsZS5tb250aHNTaG9ydD1ZaSxlLndlZWtkYXlzTWluPU9pLGUuZGVmaW5lTG9jYWxlPU8sZS51cGRhdGVMb2NhbGU9TixlLmxvY2FsZXM9UCxlLndlZWtkYXlzU2hvcnQ9QWksZS5ub3JtYWxpemVVbml0cz1ILGUucmVsYXRpdmVUaW1lVGhyZXNob2xkPUtpLGUucHJvdG90eXBlPXZyO3ZhciAkcj1lO3JldHVybiAkcn0pfSkuY2FsbChlLGkoMzcpKHQpKX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIHQud2VicGFja1BvbHlmaWxsfHwodC5kZXByZWNhdGU9ZnVuY3Rpb24oKXt9LHQucGF0aHM9W10sdC5jaGlsZHJlbj1bXSx0LndlYnBhY2tQb2x5ZmlsbD0xKSx0fX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7cmV0dXJuIGkocih0KSl9ZnVuY3Rpb24gcih0KXtyZXR1cm4gc1t0XXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIit0KyInLiIpfSgpfXZhciBzPXsiLi9hZiI6MzksIi4vYWYuanMiOjM5LCIuL2FyIjo0MCwiLi9hci1tYSI6NDEsIi4vYXItbWEuanMiOjQxLCIuL2FyLXNhIjo0MiwiLi9hci1zYS5qcyI6NDIsIi4vYXItdG4iOjQzLCIuL2FyLXRuLmpzIjo0MywiLi9hci5qcyI6NDAsIi4vYXoiOjQ0LCIuL2F6LmpzIjo0NCwiLi9iZSI6NDUsIi4vYmUuanMiOjQ1LCIuL2JnIjo0NiwiLi9iZy5qcyI6NDYsIi4vYm4iOjQ3LCIuL2JuLmpzIjo0NywiLi9ibyI6NDgsIi4vYm8uanMiOjQ4LCIuL2JyIjo0OSwiLi9ici5qcyI6NDksIi4vYnMiOjUwLCIuL2JzLmpzIjo1MCwiLi9jYSI6NTEsIi4vY2EuanMiOjUxLAoJIi4vY3MiOjUyLCIuL2NzLmpzIjo1MiwiLi9jdiI6NTMsIi4vY3YuanMiOjUzLCIuL2N5Ijo1NCwiLi9jeS5qcyI6NTQsIi4vZGEiOjU1LCIuL2RhLmpzIjo1NSwiLi9kZSI6NTYsIi4vZGUtYXQiOjU3LCIuL2RlLWF0LmpzIjo1NywiLi9kZS5qcyI6NTYsIi4vZHYiOjU4LCIuL2R2LmpzIjo1OCwiLi9lbCI6NTksIi4vZWwuanMiOjU5LCIuL2VuLWF1Ijo2MCwiLi9lbi1hdS5qcyI6NjAsIi4vZW4tY2EiOjYxLCIuL2VuLWNhLmpzIjo2MSwiLi9lbi1nYiI6NjIsIi4vZW4tZ2IuanMiOjYyLCIuL2VuLWllIjo2MywiLi9lbi1pZS5qcyI6NjMsIi4vZW4tbnoiOjY0LCIuL2VuLW56LmpzIjo2NCwiLi9lbyI6NjUsIi4vZW8uanMiOjY1LCIuL2VzIjo2NiwiLi9lcy5qcyI6NjYsIi4vZXQiOjY3LCIuL2V0LmpzIjo2NywiLi9ldSI6NjgsIi4vZXUuanMiOjY4LCIuL2ZhIjo2OSwiLi9mYS5qcyI6NjksIi4vZmkiOjcwLCIuL2ZpLmpzIjo3MCwiLi9mbyI6NzEsIi4vZm8uanMiOjcxLCIuL2ZyIjo3MiwiLi9mci1jYSI6NzMsIi4vZnItY2EuanMiOjczLCIuL2ZyLWNoIjo3NCwiLi9mci1jaC5qcyI6NzQsIi4vZnIuanMiOjcyLCIuL2Z5Ijo3NSwiLi9meS5qcyI6NzUsIi4vZ2QiOjc2LCIuL2dkLmpzIjo3NiwiLi9nbCI6NzcsIi4vZ2wuanMiOjc3LCIuL2hlIjo3OCwiLi9oZS5qcyI6NzgsIi4vaGkiOjc5LCIuL2hpLmpzIjo3OSwiLi9ociI6ODAsIi4vaHIuanMiOjgwLCIuL2h1Ijo4MSwiLi9odS5qcyI6ODEsIi4vaHktYW0iOjgyLCIuL2h5LWFtLmpzIjo4MiwiLi9pZCI6ODMsIi4vaWQuanMiOjgzLCIuL2lzIjo4NCwiLi9pcy5qcyI6ODQsIi4vaXQiOjg1LCIuL2l0LmpzIjo4NSwiLi9qYSI6ODYsIi4vamEuanMiOjg2LCIuL2p2Ijo4NywiLi9qdi5qcyI6ODcsIi4va2EiOjg4LCIuL2thLmpzIjo4OCwiLi9rayI6ODksIi4va2suanMiOjg5LCIuL2ttIjo5MCwiLi9rbS5qcyI6OTAsIi4va28iOjkxLCIuL2tvLmpzIjo5MSwiLi9sYiI6OTIsIi4vbGIuanMiOjkyLCIuL2xvIjo5MywiLi9sby5qcyI6OTMsIi4vbHQiOjk0LCIuL2x0LmpzIjo5NCwiLi9sdiI6OTUsIi4vbHYuanMiOjk1LCIuL21lIjo5NiwiLi9tZS5qcyI6OTYsIi4vbWsiOjk3LCIuL21rLmpzIjo5NywiLi9tbCI6OTgsIi4vbWwuanMiOjk4LCIuL21yIjo5OSwiLi9tci5qcyI6OTksIi4vbXMiOjEwMCwiLi9tcy1teSI6MTAxLCIuL21zLW15LmpzIjoxMDEsIi4vbXMuanMiOjEwMCwiLi9teSI6MTAyLCIuL215LmpzIjoxMDIsIi4vbmIiOjEwMywiLi9uYi5qcyI6MTAzLCIuL25lIjoxMDQsIi4vbmUuanMiOjEwNCwiLi9ubCI6MTA1LCIuL25sLmpzIjoxMDUsIi4vbm4iOjEwNiwiLi9ubi5qcyI6MTA2LCIuL3BhLWluIjoxMDcsIi4vcGEtaW4uanMiOjEwNywiLi9wbCI6MTA4LCIuL3BsLmpzIjoxMDgsIi4vcHQiOjEwOSwiLi9wdC1iciI6MTEwLCIuL3B0LWJyLmpzIjoxMTAsIi4vcHQuanMiOjEwOSwiLi9ybyI6MTExLCIuL3JvLmpzIjoxMTEsIi4vcnUiOjExMiwiLi9ydS5qcyI6MTEyLCIuL3NlIjoxMTMsIi4vc2UuanMiOjExMywiLi9zaSI6MTE0LCIuL3NpLmpzIjoxMTQsIi4vc2siOjExNSwiLi9zay5qcyI6MTE1LCIuL3NsIjoxMTYsIi4vc2wuanMiOjExNiwiLi9zcSI6MTE3LCIuL3NxLmpzIjoxMTcsIi4vc3IiOjExOCwiLi9zci1jeXJsIjoxMTksIi4vc3ItY3lybC5qcyI6MTE5LCIuL3NyLmpzIjoxMTgsIi4vc3YiOjEyMCwiLi9zdi5qcyI6MTIwLCIuL3N3IjoxMjEsIi4vc3cuanMiOjEyMSwiLi90YSI6MTIyLCIuL3RhLmpzIjoxMjIsIi4vdGUiOjEyMywiLi90ZS5qcyI6MTIzLCIuL3RoIjoxMjQsIi4vdGguanMiOjEyNCwiLi90bC1waCI6MTI1LCIuL3RsLXBoLmpzIjoxMjUsIi4vdGxoIjoxMjYsIi4vdGxoLmpzIjoxMjYsIi4vdHIiOjEyNywiLi90ci5qcyI6MTI3LCIuL3R6bCI6MTI4LCIuL3R6bC5qcyI6MTI4LCIuL3R6bSI6MTI5LCIuL3R6bS1sYXRuIjoxMzAsIi4vdHptLWxhdG4uanMiOjEzMCwiLi90em0uanMiOjEyOSwiLi91ayI6MTMxLCIuL3VrLmpzIjoxMzEsIi4vdXoiOjEzMiwiLi91ei5qcyI6MTMyLCIuL3ZpIjoxMzMsIi4vdmkuanMiOjEzMywiLi96aC1jbiI6MTM0LCIuL3poLWNuLmpzIjoxMzQsIi4vemgtdHciOjEzNSwiLi96aC10dy5qcyI6MTM1fTtuLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LmtleXMocyl9LG4ucmVzb2x2ZT1yLHQuZXhwb3J0cz1uLG4uaWQ9Mzh9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImFmIix7bW9udGhzOiJKYW51YXJpZV9GZWJydWFyaWVfTWFhcnRfQXByaWxfTWVpX0p1bmllX0p1bGllX0F1Z3VzdHVzX1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWVpX0p1bl9KdWxfQXVnX1NlcF9Pa3RfTm92X0RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU29uZGFnX01hYW5kYWdfRGluc2RhZ19Xb2Vuc2RhZ19Eb25kZXJkYWdfVnJ5ZGFnX1NhdGVyZGFnIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlNvbl9NYWFfRGluX1dvZV9Eb25fVnJ5X1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU29fTWFfRGlfV29fRG9fVnJfU2EiLnNwbGl0KCJfIiksbWVyaWRpZW1QYXJzZTovdm18bm0vaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9ebm0kL2kudGVzdCh0KX0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDEyP2k/InZtIjoiVk0iOmk/Im5tIjoiTk0ifSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltWYW5kYWcgb21dIExUIixuZXh0RGF5OiJbTcO0cmUgb21dIExUIixuZXh0V2VlazoiZGRkZCBbb21dIExUIixsYXN0RGF5OiJbR2lzdGVyIG9tXSBMVCIsbGFzdFdlZWs6IltMYWFzXSBkZGRkIFtvbV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9vciAlcyIscGFzdDoiJXMgZ2VsZWRlIixzOiInbiBwYWFyIHNla29uZGVzIixtOiInbiBtaW51dXQiLG1tOiIlZCBtaW51dGUiLGg6IiduIHV1ciIsaGg6IiVkIHVyZSIsZDoiJ24gZGFnIixkZDoiJWQgZGFlIixNOiInbiBtYWFuZCIsTU06IiVkIG1hYW5kZSIseToiJ24gamFhciIseXk6IiVkIGphYXIifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oc3RlfGRlKS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdCsoMT09PXR8fDg9PT10fHx0Pj0yMD8ic3RlIjoiZGUiKX0sd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi2aEiLDI6ItmiIiwzOiLZoyIsNDoi2aQiLDU6ItmlIiw2OiLZpiIsNzoi2aciLDg6ItmoIiw5OiLZqSIsMDoi2aAifSxpPXsi2aEiOiIxIiwi2aIiOiIyIiwi2aMiOiIzIiwi2aQiOiI0Iiwi2aUiOiI1Iiwi2aYiOiI2Iiwi2aciOiI3Iiwi2agiOiI4Iiwi2akiOiI5Iiwi2aAiOiIwIn0sbj1mdW5jdGlvbih0KXtyZXR1cm4gMD09PXQ/MDoxPT09dD8xOjI9PT10PzI6dCUxMDA+PTMmJnQlMTAwPD0xMD8zOnQlMTAwPj0xMT80OjV9LHI9e3M6WyLYo9mC2YQg2YXZhiDYq9in2YbZitipIiwi2KvYp9mG2YrYqSDZiNin2K3Yr9ipIixbItir2KfZhtmK2KrYp9mGIiwi2KvYp9mG2YrYqtmK2YYiXSwiJWQg2KvZiNin2YYiLCIlZCDYq9in2YbZitipIiwiJWQg2KvYp9mG2YrYqSJdLG06WyLYo9mC2YQg2YXZhiDYr9mC2YrZgtipIiwi2K/ZgtmK2YLYqSDZiNin2K3Yr9ipIixbItiv2YLZitmC2KrYp9mGIiwi2K/ZgtmK2YLYqtmK2YYiXSwiJWQg2K/Zgtin2KbZgiIsIiVkINiv2YLZitmC2KkiLCIlZCDYr9mC2YrZgtipIl0saDpbItij2YLZhCDZhdmGINiz2KfYudipIiwi2LPYp9i52Kkg2YjYp9it2K/YqSIsWyLYs9in2LnYqtin2YYiLCLYs9in2LnYqtmK2YYiXSwiJWQg2LPYp9i52KfYqiIsIiVkINiz2KfYudipIiwiJWQg2LPYp9i52KkiXSxkOlsi2KPZgtmEINmF2YYg2YrZiNmFIiwi2YrZiNmFINmI2KfYrdivIixbItmK2YjZhdin2YYiLCLZitmI2YXZitmGIl0sIiVkINij2YrYp9mFIiwiJWQg2YrZiNmF2YvYpyIsIiVkINmK2YjZhSJdLE06WyLYo9mC2YQg2YXZhiDYtNmH2LEiLCLYtNmH2LEg2YjYp9it2K8iLFsi2LTZh9ix2KfZhiIsIti02YfYsdmK2YYiXSwiJWQg2KPYtNmH2LEiLCIlZCDYtNmH2LHYpyIsIiVkINi02YfYsSJdLHk6WyLYo9mC2YQg2YXZhiDYudin2YUiLCLYudin2YUg2YjYp9it2K8iLFsi2LnYp9mF2KfZhiIsIti52KfZhdmK2YYiXSwiJWQg2KPYudmI2KfZhSIsIiVkINi52KfZhdmL2KciLCIlZCDYudin2YUiXX0scz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxpLHMsbyl7dmFyIGE9bihlKSxsPXJbdF1bbihlKV07cmV0dXJuIDI9PT1hJiYobD1sW2k/MDoxXSksbC5yZXBsYWNlKC8lZC9pLGUpfX0sbz1bItmD2KfZhtmI2YYg2KfZhNir2KfZhtmKINmK2YbYp9mK2LEiLCLYtNio2KfYtyDZgdio2LHYp9mK2LEiLCLYotiw2KfYsSDZhdin2LHYsyIsItmG2YrYs9in2YYg2KPYqNix2YrZhCIsItij2YrYp9ixINmF2KfZitmIIiwi2K3YstmK2LHYp9mGINmK2YjZhtmK2YgiLCLYqtmF2YjYsiDZitmI2YTZitmIIiwi2KLYqCDYo9i62LPYt9izIiwi2KPZitmE2YjZhCDYs9io2KrZhdio2LEiLCLYqti02LHZitmGINin2YTYo9mI2YQg2KPZg9iq2YjYqNixIiwi2KrYtNix2YrZhiDYp9mE2KvYp9mG2Yog2YbZiNmB2YXYqNixIiwi2YPYp9mG2YjZhiDYp9mE2KPZiNmEINiv2YrYs9mF2KjYsSJdLGE9dC5kZWZpbmVMb2NhbGUoImFyIix7bW9udGhzOm8sbW9udGhzU2hvcnQ6byx3ZWVrZGF5czoi2KfZhNij2K3Yr1/Yp9mE2KXYq9mG2YrZhl/Yp9mE2KvZhNin2KvYp9ihX9in2YTYo9ix2KjYudin2KFf2KfZhNiu2YXZitizX9in2YTYrNmF2LnYqV/Yp9mE2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Itij2K3Yr1/Ypdir2YbZitmGX9ir2YTYp9ir2KfYoV/Yo9ix2KjYudin2KFf2K7ZhdmK2LNf2KzZhdi52Klf2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLYrV/Zhl/Yq1/YsV/Yrl/YrF/YsyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJEL+KAj00v4oCPWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sbWVyaWRpZW1QYXJzZTov2LV82YUvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuItmFIj09PXR9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMj8i2LUiOiLZhSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb2KfZhNmK2YjZhSDYudmG2K8g2KfZhNiz2KfYudipXSBMVCIsbmV4dERheToiW9i62K/Zi9inINi52YbYryDYp9mE2LPYp9i52KldIExUIixuZXh0V2VlazoiZGRkZCBb2LnZhtivINin2YTYs9in2LnYqV0gTFQiLGxhc3REYXk6IlvYo9mF2LMg2LnZhtivINin2YTYs9in2LnYqV0gTFQiLGxhc3RXZWVrOiJkZGRkIFvYudmG2K8g2KfZhNiz2KfYudipXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi2KjYudivICVzIixwYXN0OiLZhdmG2LAgJXMiLHM6cygicyIpLG06cygibSIpLG1tOnMoIm0iKSxoOnMoImgiKSxoaDpzKCJoIiksZDpzKCJkIiksZGQ6cygiZCIpLE06cygiTSIpLE1NOnMoIk0iKSx5OnMoInkiKSx5eTpzKCJ5Iil9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1x1MjAwZi9nLCIiKS5yZXBsYWNlKC9b2aHZotmj2aTZpdmm2afZqNmp2aBdL2csZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19KS5yZXBsYWNlKC/YjC9nLCIsIil9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pLnJlcGxhY2UoLywvZywi2IwiKX0sd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBhfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImFyLW1hIix7bW9udGhzOiLZitmG2KfZitixX9mB2KjYsdin2YrYsV/Zhdin2LHYs1/Yo9io2LHZitmEX9mF2KfZil/ZitmI2YbZitmIX9mK2YjZhNmK2YjYsl/Yuti02Kpf2LTYqtmG2KjYsV/Yo9mD2KrZiNio2LFf2YbZiNmG2KjYsV/Yr9is2YbYqNixIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLZitmG2KfZitixX9mB2KjYsdin2YrYsV/Zhdin2LHYs1/Yo9io2LHZitmEX9mF2KfZil/ZitmI2YbZitmIX9mK2YjZhNmK2YjYsl/Yuti02Kpf2LTYqtmG2KjYsV/Yo9mD2KrZiNio2LFf2YbZiNmG2KjYsV/Yr9is2YbYqNixIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLYp9mE2KPYrdivX9in2YTYpdiq2YbZitmGX9in2YTYq9mE2KfYq9in2KFf2KfZhNij2LHYqNi52KfYoV/Yp9mE2K7ZhdmK2LNf2KfZhNis2YXYudipX9in2YTYs9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi2KfYrdivX9in2KrZhtmK2YZf2KvZhNin2KvYp9ihX9in2LHYqNi52KfYoV/YrtmF2YrYs1/YrNmF2LnYqV/Ys9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItitX9mGX9irX9ixX9iuX9isX9izIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb2KfZhNmK2YjZhSDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbmV4dERheToiW9i62K/YpyDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbmV4dFdlZWs6ImRkZGQgW9i52YTZiSDYp9mE2LPYp9i52KldIExUIixsYXN0RGF5OiJb2KPZhdizINi52YTZiSDYp9mE2LPYp9i52KldIExUIixsYXN0V2VlazoiZGRkZCBb2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ItmB2YogJXMiLHBhc3Q6ItmF2YbYsCAlcyIsczoi2KvZiNin2YYiLG06Itiv2YLZitmC2KkiLG1tOiIlZCDYr9mC2KfYptmCIixoOiLYs9in2LnYqSIsaGg6IiVkINiz2KfYudin2KoiLGQ6ItmK2YjZhSIsZGQ6IiVkINij2YrYp9mFIixNOiLYtNmH2LEiLE1NOiIlZCDYo9i02YfYsSIseToi2LPZhtipIix5eToiJWQg2LPZhtmI2KfYqiJ9LHdlZWs6e2Rvdzo2LGRveToxMn19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLZoSIsMjoi2aIiLDM6ItmjIiw0OiLZpCIsNToi2aUiLDY6ItmmIiw3OiLZpyIsODoi2agiLDk6ItmpIiwwOiLZoCJ9LGk9eyLZoSI6IjEiLCLZoiI6IjIiLCLZoyI6IjMiLCLZpCI6IjQiLCLZpSI6IjUiLCLZpiI6IjYiLCLZpyI6IjciLCLZqCI6IjgiLCLZqSI6IjkiLCLZoCI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJhci1zYSIse21vbnRoczoi2YrZhtin2YrYsV/Zgdio2LHYp9mK2LFf2YXYp9ix2LNf2KPYqNix2YrZhF/Zhdin2YrZiF/ZitmI2YbZitmIX9mK2YjZhNmK2Yhf2KPYutiz2LfYs1/Ys9io2KrZhdio2LFf2KPZg9iq2YjYqNixX9mG2YjZgdmF2KjYsV/Yr9mK2LPZhdio2LEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ItmK2YbYp9mK2LFf2YHYqNix2KfZitixX9mF2KfYsdizX9ij2KjYsdmK2YRf2YXYp9mK2Yhf2YrZiNmG2YrZiF/ZitmI2YTZitmIX9ij2LrYs9i32LNf2LPYqNiq2YXYqNixX9ij2YPYqtmI2KjYsV/ZhtmI2YHZhdio2LFf2K/Zitiz2YXYqNixIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLYp9mE2KPYrdivX9in2YTYpdir2YbZitmGX9in2YTYq9mE2KfYq9in2KFf2KfZhNij2LHYqNi52KfYoV/Yp9mE2K7ZhdmK2LNf2KfZhNis2YXYudipX9in2YTYs9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi2KPYrdivX9il2KvZhtmK2YZf2KvZhNin2KvYp9ihX9ij2LHYqNi52KfYoV/YrtmF2YrYs1/YrNmF2LnYqV/Ys9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItitX9mGX9irX9ixX9iuX9isX9izIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LG1lcmlkaWVtUGFyc2U6L9i1fNmFLyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiLZhSI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/Iti1Ijoi2YUifSxjYWxlbmRhcjp7c2FtZURheToiW9in2YTZitmI2YUg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHREYXk6IlvYutiv2Kcg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHRXZWVrOiJkZGRkIFvYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdERheToiW9ij2YXYsyDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdFdlZWs6ImRkZGQgW9i52YTZiSDYp9mE2LPYp9i52KldIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLZgdmKICVzIixwYXN0OiLZhdmG2LAgJXMiLHM6Itir2YjYp9mGIixtOiLYr9mC2YrZgtipIixtbToiJWQg2K/Zgtin2KbZgiIsaDoi2LPYp9i52KkiLGhoOiIlZCDYs9in2LnYp9iqIixkOiLZitmI2YUiLGRkOiIlZCDYo9mK2KfZhSIsTToi2LTZh9ixIixNTToiJWQg2KPYtNmH2LEiLHk6Itiz2YbYqSIseXk6IiVkINiz2YbZiNin2KoifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b2aHZotmj2aTZpdmm2afZqNmp2aBdL2csZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19KS5yZXBsYWNlKC/YjC9nLCIsIil9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pLnJlcGxhY2UoLywvZywi2IwiKX0sd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImFyLXRuIix7bW9udGhzOiLYrNin2YbZgdmKX9mB2YrZgdix2Ypf2YXYp9ix2LNf2KPZgdix2YrZhF/Zhdin2Ypf2KzZiNin2YZf2KzZiNmK2YTZitipX9ij2YjYql/Ys9io2KrZhdio2LFf2KPZg9iq2YjYqNixX9mG2YjZgdmF2KjYsV/Yr9mK2LPZhdio2LEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Itis2KfZhtmB2Ypf2YHZitmB2LHZil/Zhdin2LHYs1/Yo9mB2LHZitmEX9mF2KfZil/YrNmI2KfZhl/YrNmI2YrZhNmK2Klf2KPZiNiqX9iz2KjYqtmF2KjYsV/Yo9mD2KrZiNio2LFf2YbZiNmB2YXYqNixX9iv2YrYs9mF2KjYsSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi2KfZhNij2K3Yr1/Yp9mE2KXYq9mG2YrZhl/Yp9mE2KvZhNin2KvYp9ihX9in2YTYo9ix2KjYudin2KFf2KfZhNiu2YXZitizX9in2YTYrNmF2LnYqV/Yp9mE2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Itij2K3Yr1/Ypdir2YbZitmGX9ir2YTYp9ir2KfYoV/Yo9ix2KjYudin2KFf2K7ZhdmK2LNf2KzZhdi52Klf2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLYrV/Zhl/Yq1/YsV/Yrl/YrF/YsyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9in2YTZitmI2YUg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHREYXk6IlvYutiv2Kcg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHRXZWVrOiJkZGRkIFvYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdERheToiW9ij2YXYsyDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdFdlZWs6ImRkZGQgW9i52YTZiSDYp9mE2LPYp9i52KldIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLZgdmKICVzIixwYXN0OiLZhdmG2LAgJXMiLHM6Itir2YjYp9mGIixtOiLYr9mC2YrZgtipIixtbToiJWQg2K/Zgtin2KbZgiIsaDoi2LPYp9i52KkiLGhoOiIlZCDYs9in2LnYp9iqIixkOiLZitmI2YUiLGRkOiIlZCDYo9mK2KfZhSIsTToi2LTZh9ixIixNTToiJWQg2KPYtNmH2LEiLHk6Itiz2YbYqSIseXk6IiVkINiz2YbZiNin2KoifSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiItaW5jaSIsNToiLWluY2kiLDg6Ii1pbmNpIiw3MDoiLWluY2kiLDgwOiItaW5jaSIsMjoiLW5jaSIsNzoiLW5jaSIsMjA6Ii1uY2kiLDUwOiItbmNpIiwzOiItw7xuY8O8Iiw0OiItw7xuY8O8IiwxMDA6Ii3DvG5jw7wiLDY6Ii1uY8SxIiw5OiItdW5jdSIsMTA6Ii11bmN1IiwzMDoiLXVuY3UiLDYwOiItxLFuY8SxIiw5MDoiLcSxbmPEsSJ9LGk9dC5kZWZpbmVMb2NhbGUoImF6Iix7bW9udGhzOiJ5YW52YXJfZmV2cmFsX21hcnRfYXByZWxfbWF5X2l5dW5faXl1bF9hdnF1c3Rfc2VudHlhYnJfb2t0eWFicl9ub3lhYnJfZGVrYWJyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJ5YW5fZmV2X21hcl9hcHJfbWF5X2l5bl9peWxfYXZxX3Nlbl9va3Rfbm95X2RlayIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiQmF6YXJfQmF6YXIgZXJ0yZlzaV/Dh8mZcsWfyZluYsmZIGF4xZ9hbcSxX8OHyZlyxZ/JmW5iyZlfQ8O8bcmZIGF4xZ9hbcSxX0PDvG3JmV/FnsmZbmLJmSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJCYXpfQnpFX8OHQXhfw4fJmXJfQ0F4X0PDvG1fxZ7JmW4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkJ6X0JFX8OHQV/Dh8mZX0NBX0PDvF/FnsmZIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2J1Z8O8biBzYWF0XSBMVCIsbmV4dERheToiW3NhYmFoIHNhYXRdIExUIixuZXh0V2VlazoiW2fJmWzJmW4gaMmZZnTJmV0gZGRkZCBbc2FhdF0gTFQiLGxhc3REYXk6Iltkw7xuyZluXSBMVCIsbGFzdFdlZWs6IltrZcOnyZluIGjJmWZ0yZldIGRkZGQgW3NhYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyBzb25yYSIscGFzdDoiJXMgyZl2dsmZbCIsczoiYmlybmXDp8mZIHNhbml5ecmZIixtOiJiaXIgZMmZcWlxyZkiLG1tOiIlZCBkyZlxaXHJmSIsaDoiYmlyIHNhYXQiLGhoOiIlZCBzYWF0IixkOiJiaXIgZ8O8biIsZGQ6IiVkIGfDvG4iLE06ImJpciBheSIsTU06IiVkIGF5Iix5OiJiaXIgaWwiLHl5OiIlZCBpbCJ9LG1lcmlkaWVtUGFyc2U6L2dlY8mZfHPJmWjJmXJ8Z8O8bmTDvHp8YXjFn2FtLyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKGfDvG5kw7x6fGF4xZ9hbSkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8iZ2VjyZkiOnQ8MTI/InPJmWjJmXIiOnQ8MTc/ImfDvG5kw7x6IjoiYXjFn2FtIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjEsW5jxLF8aW5jaXxuY2l8w7xuY8O8fG5jxLF8dW5jdSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7aWYoMD09PXQpcmV0dXJuIHQrIi3EsW5jxLEiO3ZhciBpPXQlMTAsbj10JTEwMC1pLHI9dD49MTAwPzEwMDpudWxsO3JldHVybiB0KyhlW2ldfHxlW25dfHxlW3JdKX0sd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSl7dmFyIGk9dC5zcGxpdCgiXyIpO3JldHVybiBlJTEwPT09MSYmZSUxMDAhPT0xMT9pWzBdOmUlMTA+PTImJmUlMTA8PTQmJihlJTEwMDwxMHx8ZSUxMDA+PTIwKT9pWzFdOmlbMl19ZnVuY3Rpb24gaSh0LGksbil7dmFyIHI9e21tOmk/ItGF0LLRltC70ZbQvdCwX9GF0LLRltC70ZbQvdGLX9GF0LLRltC70ZbQvSI6ItGF0LLRltC70ZbQvdGDX9GF0LLRltC70ZbQvdGLX9GF0LLRltC70ZbQvSIsaGg6aT8i0LPQsNC00LfRltC90LBf0LPQsNC00LfRltC90Ytf0LPQsNC00LfRltC9Ijoi0LPQsNC00LfRltC90YNf0LPQsNC00LfRltC90Ytf0LPQsNC00LfRltC9IixkZDoi0LTQt9C10L3RjF/QtNC90ZZf0LTQt9GR0L0iLE1NOiLQvNC10YHRj9GGX9C80LXRgdGP0YbRi1/QvNC10YHRj9GG0LDRniIseXk6ItCz0L7QtF/Qs9Cw0LTRi1/Qs9Cw0LTQvtGeIn07cmV0dXJuIm0iPT09bj9pPyLRhdCy0ZbQu9GW0L3QsCI6ItGF0LLRltC70ZbQvdGDIjoiaCI9PT1uP2k/ItCz0LDQtNC30ZbQvdCwIjoi0LPQsNC00LfRltC90YMiOnQrIiAiK2UocltuXSwrdCl9dmFyIG49dC5kZWZpbmVMb2NhbGUoImJlIix7bW9udGhzOntmb3JtYXQ6ItGB0YLRg9C00LfQtdC90Y9f0LvRjtGC0LDQs9CwX9GB0LDQutCw0LLRltC60LBf0LrRgNCw0YHQsNCy0ZbQutCwX9GC0YDQsNGe0L3Rj1/Rh9GN0YDQstC10L3Rj1/Qu9GW0L/QtdC90Y9f0LbQvdGW0Z7QvdGPX9Cy0LXRgNCw0YHQvdGPX9C60LDRgdGC0YDRi9GH0L3RltC60LBf0LvRltGB0YLQsNC/0LDQtNCwX9GB0L3QtdC20L3RjyIuc3BsaXQoIl8iKSxzdGFuZGFsb25lOiLRgdGC0YPQtNC30LXQvdGMX9C70Y7RgtGLX9GB0LDQutCw0LLRltC6X9C60YDQsNGB0LDQstGW0Lpf0YLRgNCw0LLQtdC90Yxf0YfRjdGA0LLQtdC90Yxf0LvRltC/0LXQvdGMX9C20L3RltCy0LXQvdGMX9Cy0LXRgNCw0YHQtdC90Yxf0LrQsNGB0YLRgNGL0YfQvdGW0Lpf0LvRltGB0YLQsNC/0LDQtF/RgdC90LXQttCw0L3RjCIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6ItGB0YLRg9C0X9C70Y7Rgl/RgdCw0Lpf0LrRgNCw0YFf0YLRgNCw0LJf0YfRjdGA0LJf0LvRltC/X9C20L3RltCyX9Cy0LXRgF/QutCw0YHRgl/Qu9GW0YHRgl/RgdC90LXQtiIuc3BsaXQoIl8iKSx3ZWVrZGF5czp7Zm9ybWF0OiLQvdGP0LTQt9C10LvRjl/Qv9Cw0L3Rj9C00LfQtdC70LDQul/QsNGe0YLQvtGA0LDQul/RgdC10YDQsNC00YNf0YfQsNGG0LLQtdGAX9C/0Y/RgtC90ZbRhtGDX9GB0YPQsdC+0YLRgyIuc3BsaXQoIl8iKSxzdGFuZGFsb25lOiLQvdGP0LTQt9C10LvRj1/Qv9Cw0L3Rj9C00LfQtdC70LDQul/QsNGe0YLQvtGA0LDQul/RgdC10YDQsNC00LBf0YfQsNGG0LLQtdGAX9C/0Y/RgtC90ZbRhtCwX9GB0YPQsdC+0YLQsCIuc3BsaXQoIl8iKSxpc0Zvcm1hdDovXFsgP1vQktCyXSA/KD860LzRltC90YPQu9GD0Y580L3QsNGB0YLRg9C/0L3Rg9GOKT8gP1xdID9kZGRkL30sd2Vla2RheXNTaG9ydDoi0L3QtF/Qv9C9X9Cw0YJf0YHRgF/Rh9GGX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0L3QtF/Qv9C9X9Cw0YJf0YHRgF/Rh9GGX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkg0LMuIixMTEw6IkQgTU1NTSBZWVlZINCzLiwgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZINCzLiwgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9Ch0ZHQvdC90Y8g0Z5dIExUIixuZXh0RGF5OiJb0JfQsNGe0YLRgNCwINGeXSBMVCIsbGFzdERheToiW9Cj0YfQvtGA0LAg0Z5dIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3JldHVybiJb0KNdIGRkZGQgW9GeXSBMVCJ9LGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA1OmNhc2UgNjpyZXR1cm4iW9CjINC80ZbQvdGD0LvRg9GOXSBkZGRkIFvRnl0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OnJldHVybiJb0KMg0LzRltC90YPQu9GLXSBkZGRkIFvRnl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0L/RgNCw0LcgJXMiLHBhc3Q6IiVzINGC0LDQvNGDIixzOiLQvdC10LrQsNC70YzQutGWINGB0LXQutGD0L3QtCIsbTppLG1tOmksaDppLGhoOmksZDoi0LTQt9C10L3RjCIsZGQ6aSxNOiLQvNC10YHRj9GGIixNTTppLHk6ItCz0L7QtCIseXk6aX0sbWVyaWRpZW1QYXJzZTov0L3QvtGH0Yt80YDQsNC90ZbRhtGLfNC00L3Rj3zQstC10YfQsNGA0LAvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuL14o0LTQvdGPfNCy0LXRh9Cw0YDQsCkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i0L3QvtGH0YsiOnQ8MTI/ItGA0LDQvdGW0YbRiyI6dDwxNz8i0LTQvdGPIjoi0LLQtdGH0LDRgNCwIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjRlnzRi3zQs9CwKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3N3aXRjaChlKXtjYXNlIk0iOmNhc2UiZCI6Y2FzZSJEREQiOmNhc2UidyI6Y2FzZSJXIjpyZXR1cm4gdCUxMCE9PTImJnQlMTAhPT0zfHx0JTEwMD09PTEyfHx0JTEwMD09PTEzP3QrIi3RiyI6dCsiLdGWIjtjYXNlIkQiOnJldHVybiB0KyIt0LPQsCI7ZGVmYXVsdDpyZXR1cm4gdH19LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImJnIix7bW9udGhzOiLRj9C90YPQsNGA0Lhf0YTQtdCy0YDRg9Cw0YDQuF/QvNCw0YDRgl/QsNC/0YDQuNC7X9C80LDQuV/RjtC90Lhf0Y7Qu9C4X9Cw0LLQs9GD0YHRgl/RgdC10L/RgtC10LzQstGA0Lhf0L7QutGC0L7QvNCy0YDQuF/QvdC+0LXQvNCy0YDQuF/QtNC10LrQtdC80LLRgNC4Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLRj9C90YBf0YTQtdCyX9C80LDRgF/QsNC/0YBf0LzQsNC5X9GO0L3QuF/RjtC70Lhf0LDQstCzX9GB0LXQv1/QvtC60YJf0L3QvtC1X9C00LXQuiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0L3QtdC00LXQu9GPX9C/0L7QvdC10LTQtdC70L3QuNC6X9Cy0YLQvtGA0L3QuNC6X9GB0YDRj9C00LBf0YfQtdGC0LLRitGA0YLRitC6X9C/0LXRgtGK0Lpf0YHRitCx0L7RgtCwIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ItC90LXQtF/Qv9C+0L1f0LLRgtC+X9GB0YDRj1/Rh9C10YJf0L/QtdGCX9GB0YrQsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0L3QtF/Qv9C9X9Cy0YJf0YHRgF/Rh9GCX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiRC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb0JTQvdC10YEg0LJdIExUIixuZXh0RGF5OiJb0KPRgtGA0LUg0LJdIExUIixuZXh0V2VlazoiZGRkZCBb0LJdIExUIixsYXN0RGF5OiJb0JLRh9C10YDQsCDQsl0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA2OnJldHVybiJb0JIg0LjQt9C80LjQvdCw0LvQsNGC0LBdIGRkZGQgW9CyXSBMVCI7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6Y2FzZSA1OnJldHVybiJb0JIg0LjQt9C80LjQvdCw0LvQuNGPXSBkZGRkIFvQsl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0YHQu9C10LQgJXMiLHBhc3Q6ItC/0YDQtdC00LggJXMiLHM6ItC90Y/QutC+0LvQutC+INGB0LXQutGD0L3QtNC4IixtOiLQvNC40L3Rg9GC0LAiLG1tOiIlZCDQvNC40L3Rg9GC0LgiLGg6ItGH0LDRgSIsaGg6IiVkINGH0LDRgdCwIixkOiLQtNC10L0iLGRkOiIlZCDQtNC90LgiLE06ItC80LXRgdC10YYiLE1NOiIlZCDQvNC10YHQtdGG0LAiLHk6ItCz0L7QtNC40L3QsCIseXk6IiVkINCz0L7QtNC40L3QuCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfS0o0LXQsnzQtdC9fNGC0Lh80LLQuHzRgNC4fNC80LgpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT10JTEwMDtyZXR1cm4gMD09PXQ/dCsiLdC10LIiOjA9PT1pP3QrIi3QtdC9IjppPjEwJiZpPDIwP3QrIi3RgtC4IjoxPT09ZT90KyIt0LLQuCI6Mj09PWU/dCsiLdGA0LgiOjc9PT1lfHw4PT09ZT90KyIt0LzQuCI6dCsiLdGC0LgifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLgp6ciLDI6IuCnqCIsMzoi4KepIiw0OiLgp6oiLDU6IuCnqyIsNjoi4KesIiw3OiLgp60iLDg6IuCnriIsOToi4KevIiwwOiLgp6YifSxpPXsi4KenIjoiMSIsIuCnqCI6IjIiLCLgp6kiOiIzIiwi4KeqIjoiNCIsIuCnqyI6IjUiLCLgp6wiOiI2Iiwi4KetIjoiNyIsIuCnriI6IjgiLCLgp68iOiI5Iiwi4KemIjoiMCJ9LG49dC5kZWZpbmVMb2NhbGUoImJuIix7bW9udGhzOiLgppzgpr7gpqjgp4Hgp5/gpr7gprDgp4Bf4Kar4KeH4Kas4KeB4Kef4Ka+4Kaw4KeAX+CmruCmvuCmsOCnjeCmml/gpo/gpqrgp43gprDgpr/gprJf4Kau4KeHX+CmnOCngeCmqF/gppzgp4HgprLgpr7gpodf4KaF4KaX4Ka+4Ka44KeN4KafX+CmuOCnh+CmquCnjeCmn+Cnh+CmruCnjeCmrOCmsF/gpoXgppXgp43gpp/gp4vgpqzgprBf4Kao4Kat4KeH4Kau4KeN4Kas4KawX+CmoeCmv+CmuOCnh+CmruCnjeCmrOCmsCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4Kac4Ka+4Kao4KeBX+Cmq+Cnh+CmrF/gpq7gpr7gprDgp43gpppf4KaP4Kaq4KawX+CmruCnh1/gppzgp4Hgpqhf4Kac4KeB4KayX+CmheCml1/gprjgp4fgpqrgp43gpp9f4KaF4KaV4KeN4Kaf4KeLX+CmqOCmrV/gpqHgpr/gprjgp4fgpq7gp40iLnNwbGl0KCJfIiksd2Vla2RheXM6IuCmsOCmrOCmv+CmrOCmvuCmsF/gprjgp4vgpq7gpqzgpr7gprBf4Kau4KaZ4KeN4KaX4Kay4Kas4Ka+4KawX+CmrOCngeCmp+CmrOCmvuCmsF/gpqzgp4Pgprngprjgp43gpqrgpqTgp43gpqTgpr/gpqzgpr7gprBf4Ka24KeB4KaV4KeN4Kaw4Kas4Ka+4KawX+CmtuCmqOCmv+CmrOCmvuCmsCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLgprDgpqzgpr9f4Ka44KeL4KauX+CmruCmmeCnjeCml+Cmsl/gpqzgp4Hgpqdf4Kas4KeD4Ka54Ka44KeN4Kaq4Kak4KeN4Kak4Ka/X+CmtuCngeCmleCnjeCmsF/gprbgpqjgpr8iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuCmsOCmrF/gprjgpq5f4Kau4KaZ4KeN4KaXX+CmrOCngV/gpqzgp43gprDgpr/gprlf4Ka24KeBX+CmtuCmqOCmvyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkEgaDptbSDgprjgpq7gp58iLExUUzoiQSBoOm1tOnNzIOCmuOCmruCnnyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZLCBBIGg6bW0g4Ka44Kau4KefIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSwgQSBoOm1tIOCmuOCmruCnnyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4KaG4KacXSBMVCIsbmV4dERheToiW+CmhuCml+CmvuCmruCngOCmleCmvuCmsl0gTFQiLG5leHRXZWVrOiJkZGRkLCBMVCIsbGFzdERheToiW+Cml+CmpOCmleCmvuCmsl0gTFQiLGxhc3RXZWVrOiJb4KaX4KakXSBkZGRkLCBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMg4Kaq4Kaw4KeHIixwYXN0OiIlcyDgpobgppfgp4ciLHM6IuCmleCnn+Cnh+CmlSDgprjgp4fgppXgp4fgpqjgp43gpqEiLG06IuCmj+CmlSDgpq7gpr/gpqjgpr/gpp8iLG1tOiIlZCDgpq7gpr/gpqjgpr/gpp8iLGg6IuCmj+CmlSDgppjgpqjgp43gpp/gpr4iLGhoOiIlZCDgppjgpqjgp43gpp/gpr4iLGQ6IuCmj+CmlSDgpqbgpr/gpqgiLGRkOiIlZCDgpqbgpr/gpqgiLE06IuCmj+CmlSDgpq7gpr7gprgiLE1NOiIlZCDgpq7gpr7gprgiLHk6IuCmj+CmlSDgpqzgppvgprAiLHl5OiIlZCDgpqzgppvgprAifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4Ken4Keo4Kep4Keq4Ker4Kes4Ket4Keu4Kev4KemXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gprDgpr7gpqR84Ka44KaV4Ka+4KayfOCmpuCngeCmquCngeCmsHzgpqzgpr/gppXgpr7gprJ84Kaw4Ka+4KakLyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwi4Kaw4Ka+4KakIj09PWUmJnQ+PTR8fCLgpqbgp4Hgpqrgp4HgprAiPT09ZSYmdDw1fHwi4Kas4Ka/4KaV4Ka+4KayIj09PWU/dCsxMjp0fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4Kaw4Ka+4KakIjp0PDEwPyLgprjgppXgpr7gprIiOnQ8MTc/IuCmpuCngeCmquCngeCmsCI6dDwyMD8i4Kas4Ka/4KaV4Ka+4KayIjoi4Kaw4Ka+4KakIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi4LyhIiwyOiLgvKIiLDM6IuC8oyIsNDoi4LykIiw1OiLgvKUiLDY6IuC8piIsNzoi4LynIiw4OiLgvKgiLDk6IuC8qSIsMDoi4LygIn0saT17IuC8oSI6IjEiLCLgvKIiOiIyIiwi4LyjIjoiMyIsIuC8pCI6IjQiLCLgvKUiOiI1Iiwi4LymIjoiNiIsIuC8pyI6IjciLCLgvKgiOiI4Iiwi4LypIjoiOSIsIuC8oCI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJibyIse21vbnRoczoi4L2f4L6z4LyL4L2W4LyL4L2R4L2E4LyL4L2U4L28X+C9n+C+s+C8i+C9luC8i+C9guC9ieC9suC9puC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvYLgvabgvbTgvZjgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2e4L2y4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9o+C+lOC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZHgvrLgvbTgvYLgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2R4L204L2T4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9ouC+kuC+seC9keC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZHgvYLgvbTgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2F4L204LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9heC9tOC8i+C9guC9heC9suC9guC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZbgvYXgvbTgvIvgvYLgvYngvbLgvabgvIvgvZQiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuC9n+C+s+C8i+C9luC8i+C9keC9hOC8i+C9lOC9vF/gvZ/gvrPgvIvgvZbgvIvgvYLgvYngvbLgvabgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2C4L2m4L204L2Y4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9nuC9suC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvaPgvpTgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2R4L6y4L204L2C4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9keC9tOC9k+C8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZbgvaLgvpLgvrHgvZHgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2R4L2C4L204LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9heC9tOC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZbgvYXgvbTgvIvgvYLgvYXgvbLgvYLgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2F4L204LyL4L2C4L2J4L2y4L2m4LyL4L2UIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgvYLgvZ/gvaDgvIvgvYngvbLgvIvgvZjgvItf4L2C4L2f4L2g4LyL4L2f4L6z4LyL4L2W4LyLX+C9guC9n+C9oOC8i+C9mOC9suC9guC8i+C9keC9mOC9ouC8i1/gvYLgvZ/gvaDgvIvgvaPgvrfgvYLgvIvgvZTgvItf4L2C4L2f4L2g4LyL4L2V4L204L2i4LyL4L2W4L20X+C9guC9n+C9oOC8i+C9lOC8i+C9puC9hOC9puC8i1/gvYLgvZ/gvaDgvIvgvabgvqTgvbrgvZPgvIvgvZTgvIsiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4L2J4L2y4LyL4L2Y4LyLX+C9n+C+s+C8i+C9luC8i1/gvZjgvbLgvYLgvIvgvZHgvZjgvaLgvItf4L2j4L634L2C4LyL4L2U4LyLX+C9leC9tOC9ouC8i+C9luC9tF/gvZTgvIvgvabgvYTgvabgvItf4L2m4L6k4L264L2T4LyL4L2U4LyLIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgvYngvbLgvIvgvZjgvItf4L2f4L6z4LyL4L2W4LyLX+C9mOC9suC9guC8i+C9keC9mOC9ouC8i1/gvaPgvrfgvYLgvIvgvZTgvItf4L2V4L204L2i4LyL4L2W4L20X+C9lOC8i+C9puC9hOC9puC8i1/gvabgvqTgvbrgvZPgvIvgvZTgvIsiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0iLExUUzoiQSBoOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEEgaDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4L2R4L2y4LyL4L2i4L2y4L2EXSBMVCIsbmV4dERheToiW+C9puC9hOC8i+C9ieC9suC9k10gTFQiLG5leHRXZWVrOiJb4L2W4L2R4L204L2T4LyL4L2V4L6y4L2C4LyL4L2i4L6X4L264L2m4LyL4L2YXSwgTFQiLGxhc3REYXk6IlvgvYHgvIvgvabgvYRdIExUIixsYXN0V2VlazoiW+C9luC9keC9tOC9k+C8i+C9leC+suC9guC8i+C9mOC9kOC9oOC8i+C9mF0gZGRkZCwgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzIOC9o+C8iyIscGFzdDoiJXMg4L2m4L6U4L2T4LyL4L2jIixzOiLgvaPgvZjgvIvgvabgvYQiLG06IuC9puC+kOC9ouC8i+C9mOC8i+C9guC9heC9suC9giIsbW06IiVkIOC9puC+kOC9ouC8i+C9mCIsaDoi4L2G4L204LyL4L2a4L284L2R4LyL4L2C4L2F4L2y4L2CIixoaDoiJWQg4L2G4L204LyL4L2a4L284L2RIixkOiLgvYngvbLgvZPgvIvgvYLgvYXgvbLgvYIiLGRkOiIlZCDgvYngvbLgvZPgvIsiLE06IuC9n+C+s+C8i+C9luC8i+C9guC9heC9suC9giIsTU06IiVkIOC9n+C+s+C8i+C9liIseToi4L2j4L284LyL4L2C4L2F4L2y4L2CIix5eToiJWQg4L2j4L28In0scHJlcGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvW+C8oeC8ouC8o+C8pOC8peC8puC8p+C8qOC8qeC8oF0vZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pfSxwb3N0Zm9ybWF0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1xkL2csZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX0sbWVyaWRpZW1QYXJzZTov4L2Y4L2a4L2T4LyL4L2Y4L28fOC9nuC9vOC9guC9puC8i+C9gOC9pnzgvYngvbLgvZPgvIvgvYLgvbTgvYR84L2R4L2C4L284L2E4LyL4L2R4L2CfOC9mOC9muC9k+C8i+C9mOC9vC8sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuC9mOC9muC9k+C8i+C9mOC9vCI9PT1lJiZ0Pj00fHwi4L2J4L2y4L2T4LyL4L2C4L204L2EIj09PWUmJnQ8NXx8IuC9keC9guC9vOC9hOC8i+C9keC9giI9PT1lP3QrMTI6dH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDQ/IuC9mOC9muC9k+C8i+C9mOC9vCI6dDwxMD8i4L2e4L284L2C4L2m4LyL4L2A4L2mIjp0PDE3PyLgvYngvbLgvZPgvIvgvYLgvbTgvYQiOnQ8MjA/IuC9keC9guC9vOC9hOC8i+C9keC9giI6IuC9mOC9muC9k+C8i+C9mOC9vCJ9LHdlZWs6e2RvdzowLGRveTo2fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSl7dmFyIG49e21tOiJtdW51dGVubiIsTU06Im1peiIsZGQ6ImRldmV6aCJ9O3JldHVybiB0KyIgIityKG5baV0sdCl9ZnVuY3Rpb24gaSh0KXtzd2l0Y2gobih0KSl7Y2FzZSAxOmNhc2UgMzpjYXNlIDQ6Y2FzZSA1OmNhc2UgOTpyZXR1cm4gdCsiIGJsb2F6IjtkZWZhdWx0OnJldHVybiB0KyIgdmxvYXoifX1mdW5jdGlvbiBuKHQpe3JldHVybiB0Pjk/bih0JTEwKTp0fWZ1bmN0aW9uIHIodCxlKXtyZXR1cm4gMj09PWU/cyh0KTp0fWZ1bmN0aW9uIHModCl7dmFyIGU9e206InYiLGI6InYiLGQ6InoifTtyZXR1cm4gdm9pZCAwPT09ZVt0LmNoYXJBdCgwKV0/dDplW3QuY2hhckF0KDApXSt0LnN1YnN0cmluZygxKX12YXIgbz10LmRlZmluZUxvY2FsZSgiYnIiLHttb250aHM6IkdlbnZlcl9DJ2h3ZXZyZXJfTWV1cnpoX0VicmVsX01hZV9NZXpoZXZlbl9Hb3VlcmVfRW9zdF9Hd2VuZ29sb19IZXJlX0R1X0tlcnp1Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJHZW5fQydod2VfTWV1X0Vicl9NYWVfRXZlX0dvdV9Fb3NfR3dlX0hlcl9EdV9LZXIiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bF9MdW5fTWV1cnpoX01lcmMnaGVyX1lhb3VfR3dlbmVyX1NhZG9ybiIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJTdWxfTHVuX01ldV9NZXJfWWFvX0d3ZV9TYWQiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlN1X0x1X01lX01lcl9ZYV9Hd19TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6ImhbZV1tbSBBIixMVFM6ImhbZV1tbTpzcyBBIixMOiJERC9NTS9ZWVlZIixMTDoiRCBbYSB2aXpdIE1NTU0gWVlZWSIsTExMOiJEIFthIHZpel0gTU1NTSBZWVlZIGhbZV1tbSBBIixMTExMOiJkZGRkLCBEIFthIHZpel0gTU1NTSBZWVlZIGhbZV1tbSBBIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltIaXppdiBkYV0gTFQiLG5leHREYXk6IltXYXJjJ2hvYXpoIGRhXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2RhXSBMVCIsbGFzdERheToiW0RlYydoIGRhXSBMVCIsbGFzdFdlZWs6ImRkZGQgW3Bhc2V0IGRhXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiYS1iZW5uICVzIixwYXN0OiIlcyAnem8iLHM6InVuIG5lYmV1ZCBzZWdvbmRlbm5vw7kiLG06InVyIHZ1bnV0ZW5uIixtbTplLGg6InVuIGV1ciIsaGg6IiVkIGV1ciIsZDoidW4gZGV2ZXpoIixkZDplLE06InVyIG1peiIsTU06ZSx5OiJ1ciBibG9heiIseXk6aX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KGHDsXx2ZXQpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPTE9PT10PyJhw7EiOiJ2ZXQiO3JldHVybiB0K2V9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBvfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSl7dmFyIG49dCsiICI7c3dpdGNoKGkpe2Nhc2UibSI6cmV0dXJuIGU/ImplZG5hIG1pbnV0YSI6ImplZG5lIG1pbnV0ZSI7Y2FzZSJtbSI6cmV0dXJuIG4rPTE9PT10PyJtaW51dGEiOjI9PT10fHwzPT09dHx8ND09PXQ/Im1pbnV0ZSI6Im1pbnV0YSI7Y2FzZSJoIjpyZXR1cm4gZT8iamVkYW4gc2F0IjoiamVkbm9nIHNhdGEiO2Nhc2UiaGgiOnJldHVybiBuKz0xPT09dD8ic2F0IjoyPT09dHx8Mz09PXR8fDQ9PT10PyJzYXRhIjoic2F0aSI7Y2FzZSJkZCI6cmV0dXJuIG4rPTE9PT10PyJkYW4iOiJkYW5hIjtjYXNlIk1NIjpyZXR1cm4gbis9MT09PXQ/Im1qZXNlYyI6Mj09PXR8fDM9PT10fHw0PT09dD8ibWplc2VjYSI6Im1qZXNlY2kiO2Nhc2UieXkiOnJldHVybiBuKz0xPT09dD8iZ29kaW5hIjoyPT09dHx8Mz09PXR8fDQ9PT10PyJnb2RpbmUiOiJnb2RpbmEifX12YXIgaT10LmRlZmluZUxvY2FsZSgiYnMiLHttb250aHM6ImphbnVhcl9mZWJydWFyX21hcnRfYXByaWxfbWFqX2p1bmlfanVsaV9hdWd1c3Rfc2VwdGVtYmFyX29rdG9iYXJfbm92ZW1iYXJfZGVjZW1iYXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imphbi5fZmViLl9tYXIuX2Fwci5fbWFqLl9qdW4uX2p1bC5fYXVnLl9zZXAuX29rdC5fbm92Ll9kZWMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJuZWRqZWxqYV9wb25lZGplbGpha191dG9yYWtfc3JpamVkYV/EjWV0dnJ0YWtfcGV0YWtfc3Vib3RhIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Im5lZC5fcG9uLl91dG8uX3NyaS5fxI1ldC5fcGV0Ll9zdWIuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJuZV9wb191dF9zcl/EjWVfcGVfc3UiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELiBNTS4gWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2RhbmFzIHVdIExUIixuZXh0RGF5OiJbc3V0cmEgdV0gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW3VdIFtuZWRqZWxqdV0gW3VdIExUIjtjYXNlIDM6cmV0dXJuIlt1XSBbc3JpamVkdV0gW3VdIExUIjtjYXNlIDY6cmV0dXJuIlt1XSBbc3Vib3R1XSBbdV0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3VdIGRkZGQgW3VdIExUIn19LGxhc3REYXk6IltqdcSNZXIgdV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6cmV0dXJuIltwcm/FoWx1XSBkZGRkIFt1XSBMVCI7Y2FzZSA2OnJldHVybiJbcHJvxaFsZV0gW3N1Ym90ZV0gW3VdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIltwcm/FoWxpXSBkZGRkIFt1XSBMVCJ9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ6YSAlcyIscGFzdDoicHJpamUgJXMiLHM6InBhciBzZWt1bmRpIixtOmUsbW06ZSxoOmUsaGg6ZSxkOiJkYW4iLGRkOmUsTToibWplc2VjIixNTTplLHk6ImdvZGludSIseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiY2EiLHttb250aHM6ImdlbmVyX2ZlYnJlcl9tYXLDp19hYnJpbF9tYWlnX2p1bnlfanVsaW9sX2Fnb3N0X3NldGVtYnJlX29jdHVicmVfbm92ZW1icmVfZGVzZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imdlbi5fZmVici5fbWFyLl9hYnIuX21haS5fanVuLl9qdWwuX2FnLl9zZXQuX29jdC5fbm92Ll9kZXMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJkaXVtZW5nZV9kaWxsdW5zX2RpbWFydHNfZGltZWNyZXNfZGlqb3VzX2RpdmVuZHJlc19kaXNzYWJ0ZSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJkZy5fZGwuX2R0Ll9kYy5fZGouX2R2Ll9kcy4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRnX0RsX0R0X0RjX0RqX0R2X0RzIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6ZnVuY3Rpb24oKXtyZXR1cm4iW2F2dWkgYSAiKygxIT09dGhpcy5ob3VycygpPyJsZXMiOiJsYSIpKyJdIExUIn0sbmV4dERheTpmdW5jdGlvbigpe3JldHVybiJbZGVtw6AgYSAiKygxIT09dGhpcy5ob3VycygpPyJsZXMiOiJsYSIpKyJdIExUIn0sbmV4dFdlZWs6ZnVuY3Rpb24oKXtyZXR1cm4iZGRkZCBbYSAiKygxIT09dGhpcy5ob3VycygpPyJsZXMiOiJsYSIpKyJdIExUIn0sbGFzdERheTpmdW5jdGlvbigpe3JldHVybiJbYWhpciBhICIrKDEhPT10aGlzLmhvdXJzKCk/ImxlcyI6ImxhIikrIl0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJbZWxdIGRkZGQgW3Bhc3NhdCBhICIrKDEhPT10aGlzLmhvdXJzKCk/ImxlcyI6ImxhIikrIl0gTFQifSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJlbiAlcyIscGFzdDoiZmEgJXMiLHM6InVucyBzZWdvbnMiLG06InVuIG1pbnV0IixtbToiJWQgbWludXRzIixoOiJ1bmEgaG9yYSIsaGg6IiVkIGhvcmVzIixkOiJ1biBkaWEiLGRkOiIlZCBkaWVzIixNOiJ1biBtZXMiLE1NOiIlZCBtZXNvcyIseToidW4gYW55Iix5eToiJWQgYW55cyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShyfG58dHzDqHxhKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3ZhciBpPTE9PT10PyJyIjoyPT09dD8ibiI6Mz09PXQ/InIiOjQ9PT10PyJ0Ijoiw6giO3JldHVybiJ3IiE9PWUmJiJXIiE9PWV8fChpPSJhIiksdCtpfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQ+MSYmdDw1JiYxIT09fn4odC8xMCl9ZnVuY3Rpb24gaSh0LGksbixyKXt2YXIgcz10KyIgIjtzd2l0Y2gobil7Y2FzZSJzIjpyZXR1cm4gaXx8cj8icMOhciBzZWt1bmQiOiJww6FyIHNla3VuZGFtaSI7Y2FzZSJtIjpyZXR1cm4gaT8ibWludXRhIjpyPyJtaW51dHUiOiJtaW51dG91IjtjYXNlIm1tIjpyZXR1cm4gaXx8cj9zKyhlKHQpPyJtaW51dHkiOiJtaW51dCIpOnMrIm1pbnV0YW1pIjtjYXNlImgiOnJldHVybiBpPyJob2RpbmEiOnI/ImhvZGludSI6ImhvZGlub3UiO2Nhc2UiaGgiOnJldHVybiBpfHxyP3MrKGUodCk/ImhvZGlueSI6ImhvZGluIik6cysiaG9kaW5hbWkiO2Nhc2UiZCI6cmV0dXJuIGl8fHI/ImRlbiI6ImRuZW0iO2Nhc2UiZGQiOnJldHVybiBpfHxyP3MrKGUodCk/ImRueSI6ImRuw60iKTpzKyJkbnkiO2Nhc2UiTSI6cmV0dXJuIGl8fHI/Im3Em3PDrWMiOiJtxJtzw61jZW0iO2Nhc2UiTU0iOnJldHVybiBpfHxyP3MrKGUodCk/Im3Em3PDrWNlIjoibcSbc8OtY8WvIik6cysibcSbc8OtY2kiO2Nhc2UieSI6cmV0dXJuIGl8fHI/InJvayI6InJva2VtIjtjYXNlInl5IjpyZXR1cm4gaXx8cj9zKyhlKHQpPyJyb2t5IjoibGV0Iik6cysibGV0eSJ9fXZhciBuPSJsZWRlbl/Dum5vcl9ixZllemVuX2R1YmVuX2t2xJt0ZW5fxI1lcnZlbl/EjWVydmVuZWNfc3JwZW5fesOhxZnDrV/FmcOtamVuX2xpc3RvcGFkX3Byb3NpbmVjIi5zcGxpdCgiXyIpLHI9ImxlZF/Dum5vX2LFmWVfZHViX2t2xJtfxI12bl/EjXZjX3NycF96w6HFmV/FmcOtal9saXNfcHJvIi5zcGxpdCgiXyIpLHM9dC5kZWZpbmVMb2NhbGUoImNzIix7bW9udGhzOm4sbW9udGhzU2hvcnQ6cixtb250aHNQYXJzZTpmdW5jdGlvbih0LGUpe3ZhciBpLG49W107Zm9yKGk9MDtpPDEyO2krKyluW2ldPW5ldyBSZWdFeHAoIl4iK3RbaV0rIiR8XiIrZVtpXSsiJCIsImkiKTtyZXR1cm4gbn0obixyKSxzaG9ydE1vbnRoc1BhcnNlOmZ1bmN0aW9uKHQpe3ZhciBlLGk9W107Zm9yKGU9MDtlPDEyO2UrKylpW2VdPW5ldyBSZWdFeHAoIl4iK3RbZV0rIiQiLCJpIik7cmV0dXJuIGl9KHIpLGxvbmdNb250aHNQYXJzZTpmdW5jdGlvbih0KXt2YXIgZSxpPVtdO2ZvcihlPTA7ZTwxMjtlKyspaVtlXT1uZXcgUmVnRXhwKCJeIit0W2VdKyIkIiwiaSIpO3JldHVybiBpfShuKSx3ZWVrZGF5czoibmVkxJtsZV9wb25kxJtsw61fw7p0ZXLDvV9zdMWZZWRhX8SNdHZydGVrX3DDoXRla19zb2JvdGEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoibmVfcG9fw7p0X3N0X8SNdF9ww6Ffc28iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Im5lX3BvX8O6dF9zdF/EjXRfcMOhX3NvIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltkbmVzIHZdIExUIixuZXh0RGF5OiJbesOtdHJhIHZdIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt2IG5lZMSbbGkgdl0gTFQiO2Nhc2UgMTpjYXNlIDI6cmV0dXJuIlt2XSBkZGRkIFt2XSBMVCI7Y2FzZSAzOnJldHVybiJbdmUgc3TFmWVkdSB2XSBMVCI7Y2FzZSA0OnJldHVybiJbdmUgxI10dnJ0ZWsgdl0gTFQiO2Nhc2UgNTpyZXR1cm4iW3YgcMOhdGVrIHZdIExUIjtjYXNlIDY6cmV0dXJuIlt2IHNvYm90dSB2XSBMVCJ9fSxsYXN0RGF5OiJbdsSNZXJhIHZdIExUIixsYXN0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlttaW51bG91IG5lZMSbbGkgdl0gTFQiO2Nhc2UgMTpjYXNlIDI6cmV0dXJuIlttaW51bMOpXSBkZGRkIFt2XSBMVCI7Y2FzZSAzOnJldHVybiJbbWludWxvdSBzdMWZZWR1IHZdIExUIjtjYXNlIDQ6Y2FzZSA1OnJldHVybiJbbWludWzDvV0gZGRkZCBbdl0gTFQiO2Nhc2UgNjpyZXR1cm4iW21pbnVsb3Ugc29ib3R1IHZdIExUIn19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InphICVzIixwYXN0OiJwxZllZCAlcyIsczppLG06aSxtbTppLGg6aSxoaDppLGQ6aSxkZDppLE06aSxNTTppLHk6aSx5eTppfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gc30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJjdiIse21vbnRoczoi0LrTkdGA0LvQsNGHX9C90LDRgNOR0YFf0L/Rg9GIX9Cw0LrQsF/QvNCw0Llf0qvTl9GA0YLQvNC1X9GD0YLTkV/Sq9GD0YDQu9CwX9Cw0LLTkdC9X9GO0L/QsF/Rh9Oz0Lpf0YDQsNGI0YLQsNCyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLQutOR0YBf0L3QsNGAX9C/0YPRiF/QsNC60LBf0LzQsNC5X9Kr05fRgF/Rg9GC05Ff0qvRg9GAX9Cw0LLQvV/RjtC/0LBf0YfTs9C6X9GA0LDRiCIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0LLRi9GA0YHQsNGA0L3QuNC60YPQvV/RgtGD0L3RgtC40LrRg9C9X9GL0YLQu9Cw0YDQuNC60YPQvV/RjtC90LrRg9C9X9C605fSq9C90LXRgNC90LjQutGD0L1f0Y3RgNC90LXQutGD0L1f0YjTkdC80LDRgtC60YPQvSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLQstGL0YBf0YLRg9C9X9GL0YLQu1/RjtC9X9C605fSq1/RjdGA0L1f0YjTkdC8Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLQstGAX9GC0L1f0YvRgl/RjtC9X9C60qtf0Y3RgF/RiNC8Ii5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELU1NLVlZWVkiLExMOiJZWVlZIFvSq9GD0LvRhdC4XSBNTU1NIFvRg9C505HRhdOX0L1dIERbLdC805fRiNOXXSIsTExMOiJZWVlZIFvSq9GD0LvRhdC4XSBNTU1NIFvRg9C505HRhdOX0L1dIERbLdC805fRiNOXXSwgSEg6bW0iLExMTEw6ImRkZGQsIFlZWVkgW9Kr0YPQu9GF0LhdIE1NTU0gW9GD0LnTkdGF05fQvV0gRFst0LzTl9GI05ddLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb0J/QsNGP0L1dIExUIFvRgdC10YXQtdGC0YDQtV0iLG5leHREYXk6IlvQq9GA0LDQvV0gTFQgW9GB0LXRhdC10YLRgNC1XSIsbGFzdERheToiW9OW0L3QtdGAXSBMVCBb0YHQtdGF0LXRgtGA0LVdIixuZXh0V2VlazoiW9Kq0LjRgtC10YFdIGRkZGQgTFQgW9GB0LXRhdC10YLRgNC1XSIsbGFzdFdlZWs6IlvQmNGA0YLQvdOXXSBkZGRkIExUIFvRgdC10YXQtdGC0YDQtV0iLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZnVuY3Rpb24odCl7dmFyIGU9L9GB0LXRhdC10YIkL2kuZXhlYyh0KT8i0YDQtdC9Ijov0qvRg9C7JC9pLmV4ZWModCk/ItGC0LDQvSI6ItGA0LDQvSI7cmV0dXJuIHQrZX0scGFzdDoiJXMg0LrQsNGP0LvQu9CwIixzOiLQv9OX0YAt0LjQuiDSq9C10LrQutGD0L3RgiIsbToi0L/Tl9GAINC80LjQvdGD0YIiLG1tOiIlZCDQvNC40L3Rg9GCIixoOiLQv9OX0YAg0YHQtdGF0LXRgiIsaGg6IiVkINGB0LXRhdC10YIiLGQ6ItC/05fRgCDQutGD0L0iLGRkOiIlZCDQutGD0L0iLE06ItC/05fRgCDRg9C505HRhSIsTU06IiVkINGD0LnTkdGFIix5OiLQv9OX0YAg0qvRg9C7Iix5eToiJWQg0qvRg9C7In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LdC805fRiC8sb3JkaW5hbDoiJWQt0LzTl9GIIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJjeSIse21vbnRoczoiSW9uYXdyX0Nod2Vmcm9yX01hd3J0aF9FYnJpbGxfTWFpX01laGVmaW5fR29yZmZlbm5hZl9Bd3N0X01lZGlfSHlkcmVmX1RhY2h3ZWRkX1JoYWdmeXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Iklvbl9DaHdlX01hd19FYnJfTWFpX01laF9Hb3JfQXdzX01lZF9IeWRfVGFjaF9SaGFnIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJEeWRkIFN1bF9EeWRkIExsdW5fRHlkZCBNYXdydGhfRHlkZCBNZXJjaGVyX0R5ZGQgSWF1X0R5ZGQgR3dlbmVyX0R5ZGQgU2Fkd3JuIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bF9MbHVuX01hd19NZXJfSWF1X0d3ZV9TYWQiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlN1X0xsX01hX01lX0lhX0d3X1NhIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0hlZGRpdyBhbV0gTFQiLG5leHREYXk6IltZZm9yeSBhbV0gTFQiLG5leHRXZWVrOiJkZGRkIFthbV0gTFQiLGxhc3REYXk6IltEZG9lIGFtXSBMVCIsbGFzdFdlZWs6ImRkZGQgW2Rpd2V0aGFmIGFtXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToibWV3biAlcyIscGFzdDoiJXMgeW4gw7RsIixzOiJ5Y2h5ZGlnIGVpbGlhZGF1IixtOiJtdW51ZCIsbW06IiVkIG11bnVkIixoOiJhd3IiLGhoOiIlZCBhd3IiLGQ6ImRpd3Jub2QiLGRkOiIlZCBkaXdybm9kIixNOiJtaXMiLE1NOiIlZCBtaXMiLHk6ImJsd3lkZHluIix5eToiJWQgZmx5bmVkZCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShmZWR8YWlufGFmfGlsfHlkZHxlZHxlZykvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCxpPSIiLG49WyIiLCJhZiIsImlsIiwieWRkIiwieWRkIiwiZWQiLCJlZCIsImVkIiwiZmVkIiwiZmVkIiwiZmVkIiwiZWciLCJmZWQiLCJlZyIsImVnIiwiZmVkIiwiZWciLCJlZyIsImZlZCIsImVnIiwiZmVkIl07cmV0dXJuIGU+MjA/aT00MD09PWV8fDUwPT09ZXx8NjA9PT1lfHw4MD09PWV8fDEwMD09PWU/ImZlZCI6ImFpbiI6ZT4wJiYoaT1uW2VdKSx0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImRhIix7bW9udGhzOiJqYW51YXJfZmVicnVhcl9tYXJ0c19hcHJpbF9tYWpfanVuaV9qdWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuX2ZlYl9tYXJfYXByX21hal9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6InPDuG5kYWdfbWFuZGFnX3RpcnNkYWdfb25zZGFnX3RvcnNkYWdfZnJlZGFnX2zDuHJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic8O4bl9tYW5fdGlyX29uc190b3JfZnJlX2zDuHIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46InPDuF9tYV90aV9vbl90b19mcl9sw7giLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQgW2QuXSBELiBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0kgZGFnIGtsLl0gTFQiLG5leHREYXk6IltJIG1vcmdlbiBrbC5dIExUIixuZXh0V2VlazoiZGRkZCBba2wuXSBMVCIsbGFzdERheToiW0kgZ8OlciBrbC5dIExUIixsYXN0V2VlazoiW3NpZHN0ZV0gZGRkZCBba2xdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvbSAlcyIscGFzdDoiJXMgc2lkZW4iLHM6ImbDpSBzZWt1bmRlciIsbToiZXQgbWludXQiLG1tOiIlZCBtaW51dHRlciIsaDoiZW4gdGltZSIsaGg6IiVkIHRpbWVyIixkOiJlbiBkYWciLGRkOiIlZCBkYWdlIixNOiJlbiBtw6VuZWQiLE1NOiIlZCBtw6VuZWRlciIseToiZXQgw6VyIix5eToiJWQgw6VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpLG4pe3ZhciByPXttOlsiZWluZSBNaW51dGUiLCJlaW5lciBNaW51dGUiXSxoOlsiZWluZSBTdHVuZGUiLCJlaW5lciBTdHVuZGUiXSxkOlsiZWluIFRhZyIsImVpbmVtIFRhZyJdLGRkOlt0KyIgVGFnZSIsdCsiIFRhZ2VuIl0sTTpbImVpbiBNb25hdCIsImVpbmVtIE1vbmF0Il0sTU06W3QrIiBNb25hdGUiLHQrIiBNb25hdGVuIl0seTpbImVpbiBKYWhyIiwiZWluZW0gSmFociJdLHl5Olt0KyIgSmFocmUiLHQrIiBKYWhyZW4iXX07cmV0dXJuIGU/cltpXVswXTpyW2ldWzFdfXZhciBpPXQuZGVmaW5lTG9jYWxlKCJkZSIse21vbnRoczoiSmFudWFyX0ZlYnJ1YXJfTcOkcnpfQXByaWxfTWFpX0p1bmlfSnVsaV9BdWd1c3RfU2VwdGVtYmVyX09rdG9iZXJfTm92ZW1iZXJfRGV6ZW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbi5fRmVici5fTXJ6Ll9BcHIuX01haV9KdW4uX0p1bC5fQXVnLl9TZXB0Ll9Pa3QuX05vdi5fRGV6LiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU29ubnRhZ19Nb250YWdfRGllbnN0YWdfTWl0dHdvY2hfRG9ubmVyc3RhZ19GcmVpdGFnX1NhbXN0YWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU28uX01vLl9EaS5fTWkuX0RvLl9Gci5fU2EuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTb19Nb19EaV9NaV9Eb19Gcl9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltoZXV0ZSB1bV0gTFQgW1Vocl0iLHNhbWVFbHNlOiJMIixuZXh0RGF5OiJbbW9yZ2VuIHVtXSBMVCBbVWhyXSIsbmV4dFdlZWs6ImRkZGQgW3VtXSBMVCBbVWhyXSIsbGFzdERheToiW2dlc3Rlcm4gdW1dIExUIFtVaHJdIixsYXN0V2VlazoiW2xldHp0ZW5dIGRkZGQgW3VtXSBMVCBbVWhyXSJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoidm9yICVzIixzOiJlaW4gcGFhciBTZWt1bmRlbiIsbTplLG1tOiIlZCBNaW51dGVuIixoOmUsaGg6IiVkIFN0dW5kZW4iLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9e206WyJlaW5lIE1pbnV0ZSIsImVpbmVyIE1pbnV0ZSJdLGg6WyJlaW5lIFN0dW5kZSIsImVpbmVyIFN0dW5kZSJdLGQ6WyJlaW4gVGFnIiwiZWluZW0gVGFnIl0sZGQ6W3QrIiBUYWdlIix0KyIgVGFnZW4iXSxNOlsiZWluIE1vbmF0IiwiZWluZW0gTW9uYXQiXSxNTTpbdCsiIE1vbmF0ZSIsdCsiIE1vbmF0ZW4iXSx5OlsiZWluIEphaHIiLCJlaW5lbSBKYWhyIl0seXk6W3QrIiBKYWhyZSIsdCsiIEphaHJlbiJdfTtyZXR1cm4gZT9yW2ldWzBdOnJbaV1bMV19dmFyIGk9dC5kZWZpbmVMb2NhbGUoImRlLWF0Iix7bW9udGhzOiJKw6RubmVyX0ZlYnJ1YXJfTcOkcnpfQXByaWxfTWFpX0p1bmlfSnVsaV9BdWd1c3RfU2VwdGVtYmVyX09rdG9iZXJfTm92ZW1iZXJfRGV6ZW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IkrDpG4uX0ZlYnIuX01yei5fQXByLl9NYWlfSnVuLl9KdWwuX0F1Zy5fU2VwdC5fT2t0Ll9Ob3YuX0Rlei4iLnNwbGl0KCJfIiksd2Vla2RheXM6IlNvbm50YWdfTW9udGFnX0RpZW5zdGFnX01pdHR3b2NoX0Rvbm5lcnN0YWdfRnJlaXRhZ19TYW1zdGFnIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlNvLl9Nby5fRGkuX01pLl9Eby5fRnIuX1NhLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU29fTW9fRGlfTWlfRG9fRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbaGV1dGUgdW1dIExUIFtVaHJdIixzYW1lRWxzZToiTCIsbmV4dERheToiW21vcmdlbiB1bV0gTFQgW1Vocl0iLG5leHRXZWVrOiJkZGRkIFt1bV0gTFQgW1Vocl0iLGxhc3REYXk6IltnZXN0ZXJuIHVtXSBMVCBbVWhyXSIsbGFzdFdlZWs6IltsZXR6dGVuXSBkZGRkIFt1bV0gTFQgW1Vocl0ifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiaW4gJXMiLHBhc3Q6InZvciAlcyIsczoiZWluIHBhYXIgU2VrdW5kZW4iLG06ZSxtbToiJWQgTWludXRlbiIsaDplLGhoOiIlZCBTdHVuZGVuIixkOmUsZGQ6ZSxNOmUsTU06ZSx5OmUseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT1bIt6W3qzegt6q3ofept6D3qkiLCLeit6s3oTesN6D3qreh96m3oPeqSIsIt6J3qfeg96o3pfeqiIsIt6H3q3eld6w3oPeqd6N3qoiLCLeid6tIiwi3pbeq96C3rAiLCLelt6q3o3ept6H3qgiLCLeh96v3o7ept6Q3rDek96qIiwi3pDerN6V3rDek96s3onesN6E3qbeg96qIiwi3ofert6G3rDek96v3oTept6D3qoiLCLegt6u3ojerN6J3rDehN6m3oPeqiIsIt6R3qjekN6s3onesN6E3qbeg96qIl0saT1bIt6H3qfei96o3ofesN6M3qYiLCLegN6v3onepiIsIt6H3qbegt6w3o7ep96D3qYiLCLehN6q3ovepiIsIt6E3qreg96n3pDesN6K3qbejN6oIiwi3oDeqt6G3qreg96qIiwi3oDert6C3qjegN6o3oPeqiJdLG49dC5kZWZpbmVMb2NhbGUoImR2Iix7bW9udGhzOmUsbW9udGhzU2hvcnQ6ZSx3ZWVrZGF5czppLHdlZWtkYXlzU2hvcnQ6aSx3ZWVrZGF5c01pbjoi3ofep96L3qhf3oDer96J3qZf3ofept6C3rBf3oTeqt6L3qZf3oTeqt6D3qdf3oDeqt6G3qpf3oDert6C3qgiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiRC9NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LG1lcmlkaWVtUGFyc2U6L96J3oZ83oneii8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4i3oneiiI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/It6J3oYiOiLeid6KIn0sY2FsZW5kYXI6e3NhbWVEYXk6Ilveid6o3ofept6L3qpdIExUIixuZXh0RGF5OiJb3onep96L3qbeid6nXSBMVCIsbmV4dFdlZWs6ImRkZGQgTFQiLGxhc3REYXk6Ilveh96o3ofesN6U3qxdIExUIixsYXN0V2VlazoiW96K3qfeh96o3ozeqt6I3qhdIGRkZGQgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6It6M3qzeg96t3o7ept6H3qggJXMiLHBhc3Q6It6G3qreg96o3oLesCAlcyIsczoi3pDeqN6G3qregt6w3ozeqt6G3q7ehd6s3ofesCIsbToi3oneqN6C3qjek96s3ofesCIsbW06It6J3qjegt6o3pPeqiAlZCIsaDoi3o7ept6R3qjeh96o3oPerN6H3rAiLGhoOiLejt6m3pHeqN6H3qjeg96qICVkIixkOiLei96q3ojept6A3qzeh96wIixkZDoi3oveqt6I3qbekN6wICVkIixNOiLeid6m3oDerN6H3rAiLE1NOiLeid6m3pDesCAlZCIseToi3ofept6A3qbeg96s3ofesCIseXk6It6H3qbegN6m3oPeqiAlZCJ9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL9iML2csIiwiKX0scG9zdGZvcm1hdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC8sL2csItiMIil9LHdlZWs6e2Rvdzo3LGRveToxMn19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBGdW5jdGlvbnx8IltvYmplY3QgRnVuY3Rpb25dIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX12YXIgaT10LmRlZmluZUxvY2FsZSgiZWwiLHttb250aHNOb21pbmF0aXZlRWw6Is6ZzrHOvc6/z4XOrM+BzrnOv8+CX86mzrXOss+Bzr/Phc6sz4HOuc6/z4JfzpzOrM+Bz4TOuc6/z4JfzpHPgM+Bzq/Ou865zr/Pgl/OnM6szrnOv8+CX86Zzr/Pjc69zrnOv8+CX86Zzr/Pjc67zrnOv8+CX86Rz43Os86/z4XPg8+Ezr/Pgl/Oo861z4DPhM6tzrzOss+BzrnOv8+CX86fzrrPhM+OzrLPgc65zr/Pgl/Onc6/zq3OvM6yz4HOuc6/z4JfzpTOtc66zq3OvM6yz4HOuc6/z4IiLnNwbGl0KCJfIiksbW9udGhzR2VuaXRpdmVFbDoizpnOsc69zr/Phc6xz4HOr86/z4VfzqbOtc6yz4HOv8+FzrHPgc6vzr/PhV/OnM6xz4HPhM6vzr/PhV/Okc+Az4HOuc67zq/Ov8+FX86czrHOkM6/z4VfzpnOv8+Fzr3Or86/z4VfzpnOv8+FzrvOr86/z4VfzpHPhc6zzr/Pjc+Dz4TOv8+FX86jzrXPgM+EzrXOvM6yz4HOr86/z4Vfzp/Ous+Ez4nOss+Bzq/Ov8+FX86dzr/Otc68zrLPgc6vzr/PhV/OlM61zrrOtc68zrLPgc6vzr/PhSIuc3BsaXQoIl8iKSxtb250aHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4vRC8udGVzdChlLnN1YnN0cmluZygwLGUuaW5kZXhPZigiTU1NTSIpKSk/dGhpcy5fbW9udGhzR2VuaXRpdmVFbFt0Lm1vbnRoKCldOnRoaXMuX21vbnRoc05vbWluYXRpdmVFbFt0Lm1vbnRoKCldfSxtb250aHNTaG9ydDoizpnOsc69X86mzrXOsl/OnM6xz4FfzpHPgM+BX86czrHPil/Omc6/z4XOvV/Omc6/z4XOu1/Okc+FzrNfzqPOtc+AX86fzrrPhF/Onc6/zrVfzpTOtc66Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiLOms+Fz4HOuc6xzrrOrl/OlM61z4XPhM6tz4HOsV/OpM+Bzq/PhM63X86kzrXPhM6sz4HPhM63X86gzq3OvM+Az4TOt1/OoM6xz4HOsc+DzrrOtc+Fzq5fzqPOrM6yzrLOsc+Ezr8iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoizprPhc+BX86UzrXPhV/OpM+BzrlfzqTOtc+EX86gzrXOvF/OoM6xz4FfzqPOsc6yIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLOms+FX86UzrVfzqTPgV/OpM61X86gzrVfzqDOsV/Oo86xIi5zcGxpdCgiXyIpLG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdD4xMT9pPyLOvM68IjoizpzOnCI6aT8iz4DOvCI6Is6gzpwifSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiLOvCI9PT0odCsiIikudG9Mb3dlckNhc2UoKVswXX0sbWVyaWRpZW1QYXJzZTovW86gzpxdXC4/zpw/XC4/L2ksCglsb25nRGF0ZUZvcm1hdDp7TFQ6Img6bW0gQSIsTFRTOiJoOm1tOnNzIEEiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBoOm1tIEEiLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIGg6bW0gQSJ9LGNhbGVuZGFyRWw6e3NhbWVEYXk6IlvOo86uzrzOtc+BzrEge31dIExUIixuZXh0RGF5OiJbzpHPjc+BzrnOvyB7fV0gTFQiLG5leHRXZWVrOiJkZGRkIFt7fV0gTFQiLGxhc3REYXk6IlvOp864zrXPgiB7fV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgNjpyZXR1cm4iW8+Ezr8gz4DPgc6/zrfOs86/z43OvM61zr3Ov10gZGRkZCBbe31dIExUIjtkZWZhdWx0OnJldHVybiJbz4TOt869IM+Az4HOv863zrPOv8+NzrzOtc69zrddIGRkZGQgW3t9XSBMVCJ9fSxzYW1lRWxzZToiTCJ9LGNhbGVuZGFyOmZ1bmN0aW9uKHQsaSl7dmFyIG49dGhpcy5fY2FsZW5kYXJFbFt0XSxyPWkmJmkuaG91cnMoKTtyZXR1cm4gZShuKSYmKG49bi5hcHBseShpKSksbi5yZXBsYWNlKCJ7fSIsciUxMj09PTE/Is+Dz4TOtyI6Is+Dz4TOuc+CIil9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLPg861ICVzIixwYXN0OiIlcyDPgM+BzrnOvSIsczoizrvOr86zzrEgzrTOtc+Fz4TOtc+Bz4zOu861z4DPhM6xIixtOiLOrc69zrEgzrvOtc+Az4TPjCIsbW06IiVkIM67zrXPgM+EzqwiLGg6Is68zq/OsSDPjs+BzrEiLGhoOiIlZCDPjs+BzrXPgiIsZDoizrzOr86xIM68zq3Pgc6xIixkZDoiJWQgzrzOrc+BzrXPgiIsTToizq3Ovc6xz4IgzrzOrs69zrHPgiIsTU06IiVkIM68zq7Ovc61z4IiLHk6Is6tzr3Osc+CIM+Hz4HPjM69zr/PgiIseXk6IiVkIM+Hz4HPjM69zrnOsSJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfc63LyxvcmRpbmFsOiIlZM63Iix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1hdSIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJoOm1tIEEiLExUUzoiaDptbTpzcyBBIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBoOm1tIEEifSxjYWxlbmRhcjp7c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoiJXMgYWdvIixzOiJhIGZldyBzZWNvbmRzIixtOiJhIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6ImFuIGhvdXIiLGhoOiIlZCBob3VycyIsZDoiYSBkYXkiLGRkOiIlZCBkYXlzIixNOiJhIG1vbnRoIixNTToiJWQgbW9udGhzIix5OiJhIHllYXIiLHl5OiIlZCB5ZWFycyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShzdHxuZHxyZHx0aCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPTE9PT1+fih0JTEwMC8xMCk/InRoIjoxPT09ZT8ic3QiOjI9PT1lPyJuZCI6Mz09PWU/InJkIjoidGgiO3JldHVybiB0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImVuLWNhIix7bW9udGhzOiJKYW51YXJ5X0ZlYnJ1YXJ5X01hcmNoX0FwcmlsX01heV9KdW5lX0p1bHlfQXVndXN0X1NlcHRlbWJlcl9PY3RvYmVyX05vdmVtYmVyX0RlY2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWF5X0p1bl9KdWxfQXVnX1NlcF9PY3RfTm92X0RlYyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU3VuZGF5X01vbmRheV9UdWVzZGF5X1dlZG5lc2RheV9UaHVyc2RheV9GcmlkYXlfU2F0dXJkYXkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU3VuX01vbl9UdWVfV2VkX1RodV9GcmlfU2F0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTdV9Nb19UdV9XZV9UaF9Gcl9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Img6bW0gQSIsTFRTOiJoOm1tOnNzIEEiLEw6IllZWVktTU0tREQiLExMOiJNTU1NIEQsIFlZWVkiLExMTDoiTU1NTSBELCBZWVlZIGg6bW0gQSIsTExMTDoiZGRkZCwgTU1NTSBELCBZWVlZIGg6bW0gQSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbVG9kYXkgYXRdIExUIixuZXh0RGF5OiJbVG9tb3Jyb3cgYXRdIExUIixuZXh0V2VlazoiZGRkZCBbYXRdIExUIixsYXN0RGF5OiJbWWVzdGVyZGF5IGF0XSBMVCIsbGFzdFdlZWs6IltMYXN0XSBkZGRkIFthdF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImluICVzIixwYXN0OiIlcyBhZ28iLHM6ImEgZmV3IHNlY29uZHMiLG06ImEgbWludXRlIixtbToiJWQgbWludXRlcyIsaDoiYW4gaG91ciIsaGg6IiVkIGhvdXJzIixkOiJhIGRheSIsZGQ6IiVkIGRheXMiLE06ImEgbW9udGgiLE1NOiIlZCBtb250aHMiLHk6ImEgeWVhciIseXk6IiVkIHllYXJzIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHN0fG5kfHJkfHRoKS8sb3JkaW5hbDpmdW5jdGlvbih0KXt2YXIgZT10JTEwLGk9MT09PX5+KHQlMTAwLzEwKT8idGgiOjE9PT1lPyJzdCI6Mj09PWU/Im5kIjozPT09ZT8icmQiOiJ0aCI7cmV0dXJuIHQraX19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1nYiIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbVG9kYXkgYXRdIExUIixuZXh0RGF5OiJbVG9tb3Jyb3cgYXRdIExUIixuZXh0V2VlazoiZGRkZCBbYXRdIExUIixsYXN0RGF5OiJbWWVzdGVyZGF5IGF0XSBMVCIsbGFzdFdlZWs6IltMYXN0XSBkZGRkIFthdF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImluICVzIixwYXN0OiIlcyBhZ28iLHM6ImEgZmV3IHNlY29uZHMiLG06ImEgbWludXRlIixtbToiJWQgbWludXRlcyIsaDoiYW4gaG91ciIsaGg6IiVkIGhvdXJzIixkOiJhIGRheSIsZGQ6IiVkIGRheXMiLE06ImEgbW9udGgiLE1NOiIlZCBtb250aHMiLHk6ImEgeWVhciIseXk6IiVkIHllYXJzIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHN0fG5kfHJkfHRoKS8sb3JkaW5hbDpmdW5jdGlvbih0KXt2YXIgZT10JTEwLGk9MT09PX5+KHQlMTAwLzEwKT8idGgiOjE9PT1lPyJzdCI6Mj09PWU/Im5kIjozPT09ZT8icmQiOiJ0aCI7cmV0dXJuIHQraX0sd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odA==", "base64"));
  res.write(new Buffer("LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1pZSIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQtTU0tWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltUb2RheSBhdF0gTFQiLG5leHREYXk6IltUb21vcnJvdyBhdF0gTFQiLG5leHRXZWVrOiJkZGRkIFthdF0gTFQiLGxhc3REYXk6IltZZXN0ZXJkYXkgYXRdIExUIixsYXN0V2VlazoiW0xhc3RdIGRkZGQgW2F0XSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiaW4gJXMiLHBhc3Q6IiVzIGFnbyIsczoiYSBmZXcgc2Vjb25kcyIsbToiYSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJhbiBob3VyIixoaDoiJWQgaG91cnMiLGQ6ImEgZGF5IixkZDoiJWQgZGF5cyIsTToiYSBtb250aCIsTU06IiVkIG1vbnRocyIseToiYSB5ZWFyIix5eToiJWQgeWVhcnMifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oc3R8bmR8cmR8dGgpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT0xPT09fn4odCUxMDAvMTApPyJ0aCI6MT09PWU/InN0IjoyPT09ZT8ibmQiOjM9PT1lPyJyZCI6InRoIjtyZXR1cm4gdCtpfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1ueiIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJoOm1tIEEiLExUUzoiaDptbTpzcyBBIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBoOm1tIEEifSxjYWxlbmRhcjp7c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoiJXMgYWdvIixzOiJhIGZldyBzZWNvbmRzIixtOiJhIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6ImFuIGhvdXIiLGhoOiIlZCBob3VycyIsZDoiYSBkYXkiLGRkOiIlZCBkYXlzIixNOiJhIG1vbnRoIixNTToiJWQgbW9udGhzIix5OiJhIHllYXIiLHl5OiIlZCB5ZWFycyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShzdHxuZHxyZHx0aCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPTE9PT1+fih0JTEwMC8xMCk/InRoIjoxPT09ZT8ic3QiOjI9PT1lPyJuZCI6Mz09PWU/InJkIjoidGgiO3JldHVybiB0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImVvIix7bW9udGhzOiJqYW51YXJvX2ZlYnJ1YXJvX21hcnRvX2Fwcmlsb19tYWpvX2p1bmlvX2p1bGlvX2HFrWd1c3RvX3NlcHRlbWJyb19va3RvYnJvX25vdmVtYnJvX2RlY2VtYnJvIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX21hcl9hcHJfbWFqX2p1bl9qdWxfYcWtZ19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IkRpbWFuxIlvX0x1bmRvX01hcmRvX01lcmtyZWRvX8S0YcWtZG9fVmVuZHJlZG9fU2FiYXRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRpbV9MdW5fTWFyZF9NZXJrX8S0YcWtX1Zlbl9TYWIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRpX0x1X01hX01lX8S0YV9WZV9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJZWVlZLU1NLUREIixMTDoiRFstYW4gZGVdIE1NTU0sIFlZWVkiLExMTDoiRFstYW4gZGVdIE1NTU0sIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIFtsYV0gRFstYW4gZGVdIE1NTU0sIFlZWVkgSEg6bW0ifSxtZXJpZGllbVBhcnNlOi9bYXBdXC50XC5tL2ksaXNQTTpmdW5jdGlvbih0KXtyZXR1cm4icCI9PT10LmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ+MTE/aT8icC50Lm0uIjoiUC5ULk0uIjppPyJhLnQubS4iOiJBLlQuTS4ifSxjYWxlbmRhcjp7c2FtZURheToiW0hvZGlhxa0gamVdIExUIixuZXh0RGF5OiJbTW9yZ2HFrSBqZV0gTFQiLG5leHRXZWVrOiJkZGRkIFtqZV0gTFQiLGxhc3REYXk6IltIaWVyYcWtIGplXSBMVCIsbGFzdFdlZWs6IltwYXNpbnRhXSBkZGRkIFtqZV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImplICVzIixwYXN0OiJhbnRhxa0gJXMiLHM6InNla3VuZG9qIixtOiJtaW51dG8iLG1tOiIlZCBtaW51dG9qIixoOiJob3JvIixoaDoiJWQgaG9yb2oiLGQ6InRhZ28iLGRkOiIlZCB0YWdvaiIsTToibW9uYXRvIixNTToiJWQgbW9uYXRvaiIseToiamFybyIseXk6IiVkIGphcm9qIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9YS8sb3JkaW5hbDoiJWRhIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPSJlbmUuX2ZlYi5fbWFyLl9hYnIuX21heS5fanVuLl9qdWwuX2Fnby5fc2VwLl9vY3QuX25vdi5fZGljLiIuc3BsaXQoIl8iKSxpPSJlbmVfZmViX21hcl9hYnJfbWF5X2p1bl9qdWxfYWdvX3NlcF9vY3Rfbm92X2RpYyIuc3BsaXQoIl8iKSxuPXQuZGVmaW5lTG9jYWxlKCJlcyIse21vbnRoczoiZW5lcm9fZmVicmVyb19tYXJ6b19hYnJpbF9tYXlvX2p1bmlvX2p1bGlvX2Fnb3N0b19zZXB0aWVtYnJlX29jdHVicmVfbm92aWVtYnJlX2RpY2llbWJyZSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDpmdW5jdGlvbih0LG4pe3JldHVybi8tTU1NLS8udGVzdChuKT9pW3QubW9udGgoKV06ZVt0Lm1vbnRoKCldfSx3ZWVrZGF5czoiZG9taW5nb19sdW5lc19tYXJ0ZXNfbWnDqXJjb2xlc19qdWV2ZXNfdmllcm5lc19zw6FiYWRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImRvbS5fbHVuLl9tYXIuX21pw6kuX2p1ZS5fdmllLl9zw6FiLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiZG9fbHVfbWFfbWlfanVfdmlfc8OhIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBbZGVdIE1NTU0gW2RlXSBZWVlZIixMTEw6IkQgW2RlXSBNTU1NIFtkZV0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBEIFtkZV0gTU1NTSBbZGVdIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OmZ1bmN0aW9uKCl7cmV0dXJuIltob3kgYSBsYSIrKDEhPT10aGlzLmhvdXJzKCk/InMiOiIiKSsiXSBMVCJ9LG5leHREYXk6ZnVuY3Rpb24oKXtyZXR1cm4iW21hw7FhbmEgYSBsYSIrKDEhPT10aGlzLmhvdXJzKCk/InMiOiIiKSsiXSBMVCJ9LG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuImRkZGQgW2EgbGEiKygxIT09dGhpcy5ob3VycygpPyJzIjoiIikrIl0gTFQifSxsYXN0RGF5OmZ1bmN0aW9uKCl7cmV0dXJuIltheWVyIGEgbGEiKygxIT09dGhpcy5ob3VycygpPyJzIjoiIikrIl0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJbZWxdIGRkZGQgW3Bhc2FkbyBhIGxhIisoMSE9PXRoaXMuaG91cnMoKT8icyI6IiIpKyJdIExUIn0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZW4gJXMiLHBhc3Q6ImhhY2UgJXMiLHM6InVub3Mgc2VndW5kb3MiLG06InVuIG1pbnV0byIsbW06IiVkIG1pbnV0b3MiLGg6InVuYSBob3JhIixoaDoiJWQgaG9yYXMiLGQ6InVuIGTDrWEiLGRkOiIlZCBkw61hcyIsTToidW4gbWVzIixNTToiJWQgbWVzZXMiLHk6InVuIGHDsW8iLHl5OiIlZCBhw7FvcyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfcK6LyxvcmRpbmFsOiIlZMK6Iix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9e3M6WyJtw7VuZSBzZWt1bmRpIiwibcO1bmkgc2VrdW5kIiwicGFhciBzZWt1bmRpdCJdLG06WyLDvGhlIG1pbnV0aSIsIsO8a3MgbWludXQiXSxtbTpbdCsiIG1pbnV0aSIsdCsiIG1pbnV0aXQiXSxoOlsiw7xoZSB0dW5uaSIsInR1bmQgYWVnYSIsIsO8a3MgdHVuZCJdLGhoOlt0KyIgdHVubmkiLHQrIiB0dW5kaSJdLGQ6WyLDvGhlIHDDpGV2YSIsIsO8a3MgcMOkZXYiXSxNOlsia3V1IGFqYSIsImt1dSBhZWdhIiwiw7xrcyBrdXUiXSxNTTpbdCsiIGt1dSIsdCsiIGt1dWQiXSx5Olsiw7xoZSBhYXN0YSIsImFhc3RhIiwiw7xrcyBhYXN0YSJdLHl5Olt0KyIgYWFzdGEiLHQrIiBhYXN0YXQiXX07cmV0dXJuIGU/cltpXVsyXT9yW2ldWzJdOnJbaV1bMV06bj9yW2ldWzBdOnJbaV1bMV19dmFyIGk9dC5kZWZpbmVMb2NhbGUoImV0Iix7bW9udGhzOiJqYWFudWFyX3ZlZWJydWFyX23DpHJ0c19hcHJpbGxfbWFpX2p1dW5pX2p1dWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b29iZXJfbm92ZW1iZXJfZGV0c2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYWFuX3ZlZWJyX23DpHJ0c19hcHJfbWFpX2p1dW5pX2p1dWxpX2F1Z19zZXB0X29rdF9ub3ZfZGV0cyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoicMO8aGFww6Rldl9lc21hc3DDpGV2X3RlaXNpcMOkZXZfa29sbWFww6Rldl9uZWxqYXDDpGV2X3JlZWRlX2xhdXDDpGV2Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlBfRV9UX0tfTl9SX0wiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlBfRV9UX0tfTl9SX0wiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltUw6RuYSxdIExUIixuZXh0RGF5OiJbSG9tbWUsXSBMVCIsbmV4dFdlZWs6IltKw6RyZ21pbmVdIGRkZGQgTFQiLGxhc3REYXk6IltFaWxlLF0gTFQiLGxhc3RXZWVrOiJbRWVsbWluZV0gZGRkZCBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgcMOkcmFzdCIscGFzdDoiJXMgdGFnYXNpIixzOmUsbTplLG1tOmUsaDplLGhoOmUsZDplLGRkOiIlZCBww6RldmEiLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJldSIse21vbnRoczoidXJ0YXJyaWxhX290c2FpbGFfbWFydHhvYV9hcGlyaWxhX21haWF0emFfZWthaW5hX3V6dGFpbGFfYWJ1enR1YV9pcmFpbGFfdXJyaWFfYXphcm9hX2FiZW5kdWEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6InVydC5fb3RzLl9tYXIuX2FwaS5fbWFpLl9la2EuX3V6dC5fYWJ1Ll9pcmEuX3Vyci5fYXphLl9hYmUuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJpZ2FuZGVhX2FzdGVsZWhlbmFfYXN0ZWFydGVhX2FzdGVhemtlbmFfb3N0ZWd1bmFfb3N0aXJhbGFfbGFydW5iYXRhIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImlnLl9hbC5fYXIuX2F6Ll9vZy5fb2wuX2xyLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiaWdfYWxfYXJfYXpfb2dfb2xfbHIiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiWVlZWS1NTS1ERCIsTEw6IllZWVlba29dIE1NTU1bcmVuXSBEW2FdIixMTEw6IllZWVlba29dIE1NTU1bcmVuXSBEW2FdIEhIOm1tIixMTExMOiJkZGRkLCBZWVlZW2tvXSBNTU1NW3Jlbl0gRFthXSBISDptbSIsbDoiWVlZWS1NLUQiLGxsOiJZWVlZW2tvXSBNTU0gRFthXSIsbGxsOiJZWVlZW2tvXSBNTU0gRFthXSBISDptbSIsbGxsbDoiZGRkLCBZWVlZW2tvXSBNTU0gRFthXSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbZ2F1cl0gTFRbZXRhbl0iLG5leHREYXk6IltiaWhhcl0gTFRbZXRhbl0iLG5leHRXZWVrOiJkZGRkIExUW2V0YW5dIixsYXN0RGF5OiJbYXR6b10gTFRbZXRhbl0iLGxhc3RXZWVrOiJbYXVycmVrb10gZGRkZCBMVFtldGFuXSIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgYmFycnUiLHBhc3Q6ImR1ZWxhICVzIixzOiJzZWd1bmRvIGJhdHp1ayIsbToibWludXR1IGJhdCIsbW06IiVkIG1pbnV0dSIsaDoib3JkdSBiYXQiLGhoOiIlZCBvcmR1IixkOiJlZ3VuIGJhdCIsZGQ6IiVkIGVndW4iLE06ImhpbGFiZXRlIGJhdCIsTU06IiVkIGhpbGFiZXRlIix5OiJ1cnRlIGJhdCIseXk6IiVkIHVydGUifSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLbsSIsMjoi27IiLDM6ItuzIiw0OiLbtCIsNToi27UiLDY6Itu2Iiw3OiLbtyIsODoi27giLDk6Itu5IiwwOiLbsCJ9LGk9eyLbsSI6IjEiLCLbsiI6IjIiLCLbsyI6IjMiLCLbtCI6IjQiLCLbtSI6IjUiLCLbtiI6IjYiLCLbtyI6IjciLCLbuCI6IjgiLCLbuSI6IjkiLCLbsCI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJmYSIse21vbnRoczoi2pjYp9mG2YjbjNmHX9mB2YjYsduM2Ydf2YXYp9ix2LNf2KLZiNix24zZhF/ZhdmHX9qY2YjYptmGX9qY2YjYptuM2Ydf2KfZiNiqX9iz2b7Yqtin2YXYqNixX9in2qnYqtio2LFf2YbZiNin2YXYqNixX9iv2LPYp9mF2KjYsSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi2pjYp9mG2YjbjNmHX9mB2YjYsduM2Ydf2YXYp9ix2LNf2KLZiNix24zZhF/ZhdmHX9qY2YjYptmGX9qY2YjYptuM2Ydf2KfZiNiqX9iz2b7Yqtin2YXYqNixX9in2qnYqtio2LFf2YbZiNin2YXYqNixX9iv2LPYp9mF2KjYsSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi24zaqeKAjNi02YbYqNmHX9iv2YjYtNmG2KjZh1/Ys9mH4oCM2LTZhtio2Ydf2obZh9in2LHYtNmG2KjZh1/ZvtmG2KzigIzYtNmG2KjZh1/YrNmF2LnZh1/YtNmG2KjZhyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLbjNqp4oCM2LTZhtio2Ydf2K/ZiNi02YbYqNmHX9iz2YfigIzYtNmG2KjZh1/ahtmH2KfYsdi02YbYqNmHX9m+2YbYrOKAjNi02YbYqNmHX9is2YXYudmHX9i02YbYqNmHIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLbjF/Yr1/Ys1/ahl/Zvl/YrF/YtCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sbWVyaWRpZW1QYXJzZTov2YLYqNmEINin2LIg2LjZh9ixfNio2LnYryDYp9iyINi42YfYsS8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4v2KjYudivINin2LIg2LjZh9ixLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/ItmC2KjZhCDYp9iyINi42YfYsSI6Itio2LnYryDYp9iyINi42YfYsSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb2KfZhdix2YjYsiDYs9in2LnYql0gTFQiLG5leHREYXk6IlvZgdix2K/YpyDYs9in2LnYql0gTFQiLG5leHRXZWVrOiJkZGRkIFvYs9in2LnYql0gTFQiLGxhc3REYXk6IlvYr9uM2LHZiNiyINiz2KfYudiqXSBMVCIsbGFzdFdlZWs6ImRkZGQgW9m+24zYtF0gW9iz2KfYudiqXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi2K/YsSAlcyIscGFzdDoiJXMg2b7bjNi0IixzOiLahtmG2K/bjNmGINir2KfZhtuM2YciLG06ItuM2qkg2K/ZgtuM2YLZhyIsbW06IiVkINiv2YLbjNmC2YciLGg6ItuM2qkg2LPYp9i52KoiLGhoOiIlZCDYs9in2LnYqiIsZDoi24zaqSDYsdmI2LIiLGRkOiIlZCDYsdmI2LIiLE06ItuM2qkg2YXYp9mHIixNTToiJWQg2YXYp9mHIix5OiLbjNqpINiz2KfZhCIseXk6IiVkINiz2KfZhCJ9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1vbsC3buV0vZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pLnJlcGxhY2UoL9iML2csIiwiKX0scG9zdGZvcm1hdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9cZC9nLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfSkucmVwbGFjZSgvLC9nLCLYjCIpfSxvcmRpbmFsUGFyc2U6L1xkezEsMn3ZhS8sb3JkaW5hbDoiJWTZhSIsd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsbixyKXt2YXIgcz0iIjtzd2l0Y2gobil7Y2FzZSJzIjpyZXR1cm4gcj8ibXV1dGFtYW4gc2VrdW5uaW4iOiJtdXV0YW1hIHNla3VudGkiO2Nhc2UibSI6cmV0dXJuIHI/Im1pbnV1dGluIjoibWludXV0dGkiO2Nhc2UibW0iOnM9cj8ibWludXV0aW4iOiJtaW51dXR0aWEiO2JyZWFrO2Nhc2UiaCI6cmV0dXJuIHI/InR1bm5pbiI6InR1bnRpIjtjYXNlImhoIjpzPXI/InR1bm5pbiI6InR1bnRpYSI7YnJlYWs7Y2FzZSJkIjpyZXR1cm4gcj8icMOkaXbDpG4iOiJww6RpdsOkIjtjYXNlImRkIjpzPXI/InDDpGl2w6RuIjoicMOkaXbDpMOkIjticmVhaztjYXNlIk0iOnJldHVybiByPyJrdXVrYXVkZW4iOiJrdXVrYXVzaSI7Y2FzZSJNTSI6cz1yPyJrdXVrYXVkZW4iOiJrdXVrYXV0dGEiO2JyZWFrO2Nhc2UieSI6cmV0dXJuIHI/InZ1b2RlbiI6InZ1b3NpIjtjYXNlInl5IjpzPXI/InZ1b2RlbiI6InZ1b3R0YSJ9cmV0dXJuIHM9aSh0LHIpKyIgIitzfWZ1bmN0aW9uIGkodCxlKXtyZXR1cm4gdDwxMD9lP3JbdF06blt0XTp0fXZhciBuPSJub2xsYSB5a3NpIGtha3NpIGtvbG1lIG5lbGrDpCB2aWlzaSBrdXVzaSBzZWl0c2Vtw6RuIGthaGRla3NhbiB5aGRla3PDpG4iLnNwbGl0KCIgIikscj1bIm5vbGxhIiwieWhkZW4iLCJrYWhkZW4iLCJrb2xtZW4iLCJuZWxqw6RuIiwidmlpZGVuIiwia3V1ZGVuIixuWzddLG5bOF0sbls5XV0scz10LmRlZmluZUxvY2FsZSgiZmkiLHttb250aHM6InRhbW1pa3V1X2hlbG1pa3V1X21hYWxpc2t1dV9odWh0aWt1dV90b3Vrb2t1dV9rZXPDpGt1dV9oZWluw6RrdXVfZWxva3V1X3N5eXNrdXVfbG9rYWt1dV9tYXJyYXNrdXVfam91bHVrdXUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6InRhbW1pX2hlbG1pX21hYWxpc19odWh0aV90b3Vrb19rZXPDpF9oZWluw6RfZWxvX3N5eXNfbG9rYV9tYXJyYXNfam91bHUiLnNwbGl0KCJfIiksd2Vla2RheXM6InN1bm51bnRhaV9tYWFuYW50YWlfdGlpc3RhaV9rZXNraXZpaWtrb190b3JzdGFpX3BlcmphbnRhaV9sYXVhbnRhaSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJzdV9tYV90aV9rZV90b19wZV9sYSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoic3VfbWFfdGlfa2VfdG9fcGVfbGEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQuTU0uWVlZWSIsTEw6IkRvIE1NTU1bdGFdIFlZWVkiLExMTDoiRG8gTU1NTVt0YV0gWVlZWSwgW2tsb10gSEgubW0iLExMTEw6ImRkZGQsIERvIE1NTU1bdGFdIFlZWVksIFtrbG9dIEhILm1tIixsOiJELk0uWVlZWSIsbGw6IkRvIE1NTSBZWVlZIixsbGw6IkRvIE1NTSBZWVlZLCBba2xvXSBISC5tbSIsbGxsbDoiZGRkLCBEbyBNTU0gWVlZWSwgW2tsb10gSEgubW0ifSxjYWxlbmRhcjp7c2FtZURheToiW3TDpG7DpMOkbl0gW2tsb10gTFQiLG5leHREYXk6IltodW9tZW5uYV0gW2tsb10gTFQiLG5leHRXZWVrOiJkZGRkIFtrbG9dIExUIixsYXN0RGF5OiJbZWlsZW5dIFtrbG9dIExUIixsYXN0V2VlazoiW3ZpaW1lXSBkZGRkW25hXSBba2xvXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgcMOkw6RzdMOkIixwYXN0OiIlcyBzaXR0ZW4iLHM6ZSxtOmUsbW06ZSxoOmUsaGg6ZSxkOmUsZGQ6ZSxNOmUsTU06ZSx5OmUseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIHN9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiZm8iLHttb250aHM6ImphbnVhcl9mZWJydWFyX21hcnNfYXByw61sX21haV9qdW5pX2p1bGlfYXVndXN0X3NlcHRlbWJlcl9va3RvYmVyX25vdmVtYmVyX2Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX21hcl9hcHJfbWFpX2p1bl9qdWxfYXVnX3NlcF9va3Rfbm92X2RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoic3VubnVkYWd1cl9tw6FuYWRhZ3VyX3TDvXNkYWd1cl9taWt1ZGFndXJfaMOzc2RhZ3VyX2Zyw61nZ2phZGFndXJfbGV5Z2FyZGFndXIiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic3VuX23DoW5fdMO9c19taWtfaMOzc19mcsOtX2xleSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoic3VfbcOhX3TDvV9taV9ow7NfZnJfbGUiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQuIE1NTU0sIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW8ONIGRhZyBrbC5dIExUIixuZXh0RGF5OiJbw40gbW9yZ2luIGtsLl0gTFQiLG5leHRXZWVrOiJkZGRkIFtrbC5dIExUIixsYXN0RGF5OiJbw40gZ2rDoXIga2wuXSBMVCIsbGFzdFdlZWs6Iltzw63DsHN0dV0gZGRkZCBba2xdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ1bSAlcyIscGFzdDoiJXMgc8Otw7BhbmkiLHM6ImbDoSBzZWt1bmQiLG06ImVpbiBtaW51dHQiLG1tOiIlZCBtaW51dHRpciIsaDoiZWluIHTDrW1pIixoaDoiJWQgdMOtbWFyIixkOiJlaW4gZGFndXIiLGRkOiIlZCBkYWdhciIsTToiZWluIG3DoW5hw7BpIixNTToiJWQgbcOhbmHDsGlyIix5OiJlaXR0IMOhciIseXk6IiVkIMOhciJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImZyIix7bW9udGhzOiJqYW52aWVyX2bDqXZyaWVyX21hcnNfYXZyaWxfbWFpX2p1aW5fanVpbGxldF9hb8O7dF9zZXB0ZW1icmVfb2N0b2JyZV9ub3ZlbWJyZV9kw6ljZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ImphbnYuX2bDqXZyLl9tYXJzX2F2ci5fbWFpX2p1aW5fanVpbC5fYW/Du3Rfc2VwdC5fb2N0Ll9ub3YuX2TDqWMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJkaW1hbmNoZV9sdW5kaV9tYXJkaV9tZXJjcmVkaV9qZXVkaV92ZW5kcmVkaV9zYW1lZGkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiZGltLl9sdW4uX21hci5fbWVyLl9qZXUuX3Zlbi5fc2FtLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRGlfTHVfTWFfTWVfSmVfVmVfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltBdWpvdXJkJ2h1aSDDoF0gTFQiLG5leHREYXk6IltEZW1haW4gw6BdIExUIixuZXh0V2VlazoiZGRkZCBbw6BdIExUIixsYXN0RGF5OiJbSGllciDDoF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtkZXJuaWVyIMOgXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFucyAlcyIscGFzdDoiaWwgeSBhICVzIixzOiJxdWVscXVlcyBzZWNvbmRlcyIsbToidW5lIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6InVuZSBoZXVyZSIsaGg6IiVkIGhldXJlcyIsZDoidW4gam91ciIsZGQ6IiVkIGpvdXJzIixNOiJ1biBtb2lzIixNTToiJWQgbW9pcyIseToidW4gYW4iLHl5OiIlZCBhbnMifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oZXJ8KS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdCsoMT09PXQ/ImVyIjoiIil9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImZyLWNhIix7bW9udGhzOiJqYW52aWVyX2bDqXZyaWVyX21hcnNfYXZyaWxfbWFpX2p1aW5fanVpbGxldF9hb8O7dF9zZXB0ZW1icmVfb2N0b2JyZV9ub3ZlbWJyZV9kw6ljZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ImphbnYuX2bDqXZyLl9tYXJzX2F2ci5fbWFpX2p1aW5fanVpbC5fYW/Du3Rfc2VwdC5fb2N0Ll9ub3YuX2TDqWMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJkaW1hbmNoZV9sdW5kaV9tYXJkaV9tZXJjcmVkaV9qZXVkaV92ZW5kcmVkaV9zYW1lZGkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiZGltLl9sdW4uX21hci5fbWVyLl9qZXUuX3Zlbi5fc2FtLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRGlfTHVfTWFfTWVfSmVfVmVfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiWVlZWS1NTS1ERCIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltBdWpvdXJkJ2h1aSDDoF0gTFQiLG5leHREYXk6IltEZW1haW4gw6BdIExUIixuZXh0V2VlazoiZGRkZCBbw6BdIExUIixsYXN0RGF5OiJbSGllciDDoF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtkZXJuaWVyIMOgXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFucyAlcyIscGFzdDoiaWwgeSBhICVzIixzOiJxdWVscXVlcyBzZWNvbmRlcyIsbToidW5lIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6InVuZSBoZXVyZSIsaGg6IiVkIGhldXJlcyIsZDoidW4gam91ciIsZGQ6IiVkIGpvdXJzIixNOiJ1biBtb2lzIixNTToiJWQgbW9pcyIseToidW4gYW4iLHl5OiIlZCBhbnMifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oZXJ8ZSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrKDE9PT10PyJlciI6ImUiKX19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJmci1jaCIse21vbnRoczoiamFudmllcl9mw6l2cmllcl9tYXJzX2F2cmlsX21haV9qdWluX2p1aWxsZXRfYW/Du3Rfc2VwdGVtYnJlX29jdG9icmVfbm92ZW1icmVfZMOpY2VtYnJlIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW52Ll9mw6l2ci5fbWFyc19hdnIuX21haV9qdWluX2p1aWwuX2Fvw7t0X3NlcHQuX29jdC5fbm92Ll9kw6ljLiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiZGltYW5jaGVfbHVuZGlfbWFyZGlfbWVyY3JlZGlfamV1ZGlfdmVuZHJlZGlfc2FtZWRpIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImRpbS5fbHVuLl9tYXIuX21lci5famV1Ll92ZW4uX3NhbS4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRpX0x1X01hX01lX0plX1ZlX1NhIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbQXVqb3VyZCdodWkgw6BdIExUIixuZXh0RGF5OiJbRGVtYWluIMOgXSBMVCIsbmV4dFdlZWs6ImRkZGQgW8OgXSBMVCIsbGFzdERheToiW0hpZXIgw6BdIExUIixsYXN0V2VlazoiZGRkZCBbZGVybmllciDDoF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImRhbnMgJXMiLHBhc3Q6ImlsIHkgYSAlcyIsczoicXVlbHF1ZXMgc2Vjb25kZXMiLG06InVuZSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJ1bmUgaGV1cmUiLGhoOiIlZCBoZXVyZXMiLGQ6InVuIGpvdXIiLGRkOiIlZCBqb3VycyIsTToidW4gbW9pcyIsTU06IiVkIG1vaXMiLHk6InVuIGFuIix5eToiJWQgYW5zIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KGVyfGUpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0KygxPT09dD8iZXIiOiJlIil9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9Imphbi5fZmViLl9tcnQuX2Fwci5fbWFpX2p1bi5fanVsLl9hdWcuX3NlcC5fb2t0Ll9ub3YuX2Rlcy4iLnNwbGl0KCJfIiksaT0iamFuX2ZlYl9tcnRfYXByX21haV9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZXMiLnNwbGl0KCJfIiksbj10LmRlZmluZUxvY2FsZSgiZnkiLHttb250aHM6Imphbm5ld2FyaXNfZmVicmV3YXJpc19tYWFydF9hcHJpbF9tYWFpZV9qdW55X2p1bHlfYXVndXN0dXNfc2VwdGltYmVyX29rdG9iZXJfbm92aW1iZXJfZGVzaW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ZnVuY3Rpb24odCxuKXtyZXR1cm4vLU1NTS0vLnRlc3Qobik/aVt0Lm1vbnRoKCldOmVbdC5tb250aCgpXX0sd2Vla2RheXM6InNuZWluX21vYW5kZWlfdGlpc2RlaV93b2Fuc2RlaV90b25nZXJzZGVpX2ZyZWVkX3NuZW9uIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6InNpLl9tby5fdGkuX3dvLl90by5fZnIuX3NvLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU2lfTW9fVGlfV29fVG9fRnJfU28iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQtTU0tWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6Iltoam9lZCBvbV0gTFQiLG5leHREYXk6Ilttb2FybiBvbV0gTFQiLG5leHRXZWVrOiJkZGRkIFtvbV0gTFQiLGxhc3REYXk6IltqdXN0ZXIgb21dIExUIixsYXN0V2VlazoiW8O0ZnLDu25lXSBkZGRkIFtvbV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9lciAlcyIscGFzdDoiJXMgbHluIixzOiJpbiBwZWFyIHNla29uZGVuIixtOiJpZW4gbWluw7p0IixtbToiJWQgbWludXRlbiIsaDoiaWVuIG9lcmUiLGhoOiIlZCBvZXJlbiIsZDoiaWVuIGRlaSIsZGQ6IiVkIGRhZ2VuIixNOiJpZW4gbW9hbm5lIixNTToiJWQgbW9hbm5lbiIseToiaWVuIGppZXIiLHl5OiIlZCBqaWVycmVuIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHN0ZXxkZSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrKDE9PT10fHw4PT09dHx8dD49MjA/InN0ZSI6ImRlIil9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9WyJBbSBGYW9pbGxlYWNoIiwiQW4gR2VhcnJhbiIsIkFtIE3DoHJ0IiwiQW4gR2libGVhbiIsIkFuIEPDqGl0ZWFuIiwiQW4gdC3DkmdtaGlvcyIsIkFuIHQtSXVjaGFyIiwiQW4gTMO5bmFzdGFsIiwiQW4gdC1TdWx0YWluIiwiQW4gRMOgbWhhaXIiLCJBbiB0LVNhbWhhaW4iLCJBbiBEw7liaGxhY2hkIl0saT1bIkZhb2kiLCJHZWFyIiwiTcOgcnQiLCJHaWJsIiwiQ8OoaXQiLCLDkmdtaCIsIkl1Y2giLCJMw7luIiwiU3VsdCIsIkTDoG1oIiwiU2FtaCIsIkTDuWJoIl0sbj1bIkRpZMOybWhuYWljaCIsIkRpbHVhaW4iLCJEaW3DoGlydCIsIkRpY2lhZGFpbiIsIkRpYXJkYW9pbiIsIkRpaGFvaW5lIiwiRGlzYXRoYWlybmUiXSxyPVsiRGlkIiwiRGlsIiwiRGltIiwiRGljIiwiRGlhIiwiRGloIiwiRGlzIl0scz1bIkTDsiIsIkx1IiwiTcOgIiwiQ2kiLCJBciIsIkhhIiwiU2EiXSxvPXQuZGVmaW5lTG9jYWxlKCJnZCIse21vbnRoczplLG1vbnRoc1Nob3J0OmksbW9udGhzUGFyc2VFeGFjdDohMCx3ZWVrZGF5czpuLHdlZWtkYXlzU2hvcnQ6cix3ZWVrZGF5c01pbjpzLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0FuLWRpdWdoIGFpZ10gTFQiLG5leHREYXk6IltBLW3DoGlyZWFjaCBhaWddIExUIixuZXh0V2VlazoiZGRkZCBbYWlnXSBMVCIsbGFzdERheToiW0FuLWTDqCBhaWddIExUIixsYXN0V2VlazoiZGRkZCBbc2VvIGNoYWlkaF0gW2FpZ10gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImFubiBhbiAlcyIscGFzdDoiYmhvIGNoaW9ubiAlcyIsczoiYmVhZ2FuIGRpb2dhbiIsbToibWlvbmFpZCIsbW06IiVkIG1pb25haWRlYW4iLGg6InVhaXIiLGhoOiIlZCB1YWlyZWFuIixkOiJsYXRoYSIsZGQ6IiVkIGxhdGhhIixNOiJtw6xvcyIsTU06IiVkIG3DrG9zYW4iLHk6ImJsaWFkaG5hIix5eToiJWQgYmxpYWRobmEifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oZHxuYXxtaCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9MT09PXQ/ImQiOnQlMTA9PT0yPyJuYSI6Im1oIjtyZXR1cm4gdCtlfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gb30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJnbCIse21vbnRoczoiWGFuZWlyb19GZWJyZWlyb19NYXJ6b19BYnJpbF9NYWlvX1h1w7FvX1h1bGxvX0Fnb3N0b19TZXRlbWJyb19PdXR1YnJvX05vdmVtYnJvX0RlY2VtYnJvIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJYYW4uX0ZlYi5fTWFyLl9BYnIuX01haS5fWHXDsS5fWHVsLl9BZ28uX1NldC5fT3V0Ll9Ob3YuX0RlYy4iLnNwbGl0KCJfIiksd2Vla2RheXM6IkRvbWluZ29fTHVuc19NYXJ0ZXNfTcOpcmNvcmVzX1hvdmVzX1ZlbnJlc19Tw6FiYWRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRvbS5fTHVuLl9NYXIuX03DqXIuX1hvdi5fVmVuLl9Tw6FiLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRG9fTHVfTWFfTcOpX1hvX1ZlX1PDoSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQgRCBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OmZ1bmN0aW9uKCl7cmV0dXJuIltob3hlICIrKDEhPT10aGlzLmhvdXJzKCk/IsOhcyI6IsOhIikrIl0gTFQifSxuZXh0RGF5OmZ1bmN0aW9uKCl7cmV0dXJuIlttYcOxw6EgIisoMSE9PXRoaXMuaG91cnMoKT8iw6FzIjoiw6EiKSsiXSBMVCJ9LG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuImRkZGQgWyIrKDEhPT10aGlzLmhvdXJzKCk/IsOhcyI6ImEiKSsiXSBMVCJ9LGxhc3REYXk6ZnVuY3Rpb24oKXtyZXR1cm4iW29udGUgIisoMSE9PXRoaXMuaG91cnMoKT8iw6EiOiJhIikrIl0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJbb10gZGRkZCBbcGFzYWRvICIrKDEhPT10aGlzLmhvdXJzKCk/IsOhcyI6ImEiKSsiXSBMVCJ9LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZnVuY3Rpb24odCl7cmV0dXJuInVucyBzZWd1bmRvcyI9PT10PyJudW5zIHNlZ3VuZG9zIjoiZW4gIit0fSxwYXN0OiJoYWkgJXMiLHM6InVucyBzZWd1bmRvcyIsbToidW4gbWludXRvIixtbToiJWQgbWludXRvcyIsaDoidW5oYSBob3JhIixoaDoiJWQgaG9yYXMiLGQ6InVuIGTDrWEiLGRkOiIlZCBkw61hcyIsTToidW4gbWVzIixNTToiJWQgbWVzZXMiLHk6InVuIGFubyIseXk6IiVkIGFub3MifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3Cui8sb3JkaW5hbDoiJWTCuiIsd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiaGUiLHttb250aHM6IteZ16DXldeQ16hf16TXkdeo15XXkNeoX9ee16jXpV/XkNek16jXmdecX9ee15DXmV/XmdeV16DXmV/XmdeV15zXmV/XkNeV15LXldeh15hf16HXpNeY157XkdeoX9eQ15XXp9eY15XXkdeoX9eg15XXkdee15HXqF/Xk9em157XkdeoIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLXmdeg15XXs1/XpNeR16jXs1/Xnteo16Vf15DXpNeo17Nf157XkNeZX9eZ15XXoNeZX9eZ15XXnNeZX9eQ15XXktezX9eh16TXmNezX9eQ15XXp9ezX9eg15XXkdezX9eT16bXntezIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLXqNeQ16nXldefX9ep16DXmV/Xqdec15nXqdeZX9eo15HXmdei15lf15fXnteZ16nXmV/XqdeZ16nXmV/XqdeR16oiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi15DXs1/XkdezX9eS17Nf15PXs1/XlNezX9eV17Nf16nXsyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi15Bf15Ff15Jf15Nf15Rf15Vf16kiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgW9eRXU1NTU0gWVlZWSIsTExMOiJEIFvXkV1NTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgW9eRXU1NTU0gWVlZWSBISDptbSIsbDoiRC9NL1lZWVkiLGxsOiJEIE1NTSBZWVlZIixsbGw6IkQgTU1NIFlZWVkgSEg6bW0iLGxsbGw6ImRkZCwgRCBNTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb15TXmdeV150g15HWvl1MVCIsbmV4dERheToiW9ee15fXqCDXkda+XUxUIixuZXh0V2VlazoiZGRkZCBb15HXqdei15RdIExUIixsYXN0RGF5OiJb15DXqtee15XXnCDXkda+XUxUIixsYXN0V2VlazoiW9eR15nXldedXSBkZGRkIFvXlNeQ15fXqNeV158g15HXqdei15RdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLXkdei15XXkyAlcyIscGFzdDoi15zXpNeg15kgJXMiLHM6Itee16HXpNeoINep16DXmdeV16oiLG06IteT16fXlCIsbW06IiVkINeT16fXldeqIixoOiLXqdei15QiLGhoOmZ1bmN0aW9uKHQpe3JldHVybiAyPT09dD8i16nXoteq15nXmdedIjp0KyIg16nXoteV16oifSxkOiLXmdeV150iLGRkOmZ1bmN0aW9uKHQpe3JldHVybiAyPT09dD8i15nXldee15nXmdedIjp0KyIg15nXnteZ150ifSxNOiLXl9eV15PXqSIsTU06ZnVuY3Rpb24odCl7cmV0dXJuIDI9PT10PyLXl9eV15PXqdeZ15nXnSI6dCsiINeX15XXk9ep15nXnSJ9LHk6Itep16DXlCIseXk6ZnVuY3Rpb24odCl7cmV0dXJuIDI9PT10PyLXqdeg16rXmdeZ150iOnQlMTA9PT0wJiYxMCE9PXQ/dCsiINep16DXlCI6dCsiINep16DXmdedIn19LG1lcmlkaWVtUGFyc2U6L9eQ15fXlCLXpnzXnNek16DXlCLXpnzXkNeX16jXmSDXlNem15TXqNeZ15nXnXzXnNek16DXmSDXlNem15TXqNeZ15nXnXzXnNek16DXldeqINeR15XXp9eofNeR15HXlden16h815HXoteo15EvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKNeQ15fXlCLXpnzXkNeX16jXmSDXlNem15TXqNeZ15nXnXzXkdei16jXkSkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8NT8i15zXpNeg15XXqiDXkdeV16fXqCI6dDwxMD8i15HXkdeV16fXqCI6dDwxMj9pPyfXnNek16DXlCLXpic6Itec16TXoNeZINeU16bXlNeo15nXmdedIjp0PDE4P2k/J9eQ15fXlCLXpic6IteQ15fXqNeZINeU16bXlNeo15nXmdedIjoi15HXoteo15EifX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezE6IuClpyIsMjoi4KWoIiwzOiLgpakiLDQ6IuClqiIsNToi4KWrIiw2OiLgpawiLDc6IuClrSIsODoi4KWuIiw5OiLgpa8iLDA6IuClpiJ9LGk9eyLgpaciOiIxIiwi4KWoIjoiMiIsIuClqSI6IjMiLCLgpaoiOiI0Iiwi4KWrIjoiNSIsIuClrCI6IjYiLCLgpa0iOiI3Iiwi4KWuIjoiOCIsIuClryI6IjkiLCLgpaYiOiIwIn0sbj10LmRlZmluZUxvY2FsZSgiaGkiLHttb250aHM6IuCknOCkqOCkteCksOClgF/gpKvgpLzgpLDgpLXgpLDgpYBf4KSu4KS+4KSw4KWN4KSaX+CkheCkquCljeCksOCliOCksl/gpK7gpIhf4KSc4KWC4KSoX+CknOClgeCksuCkvuCkiF/gpIXgpJfgpLjgpY3gpKRf4KS44KS/4KSk4KSu4KWN4KSs4KSwX+CkheCkleCljeCkn+ClguCkrOCksF/gpKjgpLXgpK7gpY3gpKzgpLBf4KSm4KS/4KS44KSu4KWN4KSs4KSwIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLgpJzgpKguX+Ckq+CkvOCksC5f4KSu4KS+4KSw4KWN4KSaX+CkheCkquCljeCksOCliC5f4KSu4KSIX+CknOClguCkqF/gpJzgpYHgpLIuX+CkheCkly5f4KS44KS/4KSkLl/gpIXgpJXgpY3gpJ/gpYIuX+CkqOCktS5f4KSm4KS/4KS4LiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4KSw4KS14KS/4KS14KS+4KSwX+CkuOCli+CkruCkteCkvuCksF/gpK7gpILgpJfgpLLgpLXgpL7gpLBf4KSs4KWB4KSn4KS14KS+4KSwX+Ckl+ClgeCksOClguCkteCkvuCksF/gpLbgpYHgpJXgpY3gpLDgpLXgpL7gpLBf4KS24KSo4KS/4KS14KS+4KSwIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuCksOCkteCkv1/gpLjgpYvgpK5f4KSu4KSC4KSX4KSyX+CkrOClgeCkp1/gpJfgpYHgpLDgpYJf4KS24KWB4KSV4KWN4KSwX+CktuCkqOCkvyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4KSwX+CkuOCli1/gpK7gpIJf4KSs4KWBX+Ckl+ClgV/gpLbgpYFf4KS2Ii5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiQSBoOm1tIOCkrOCknOClhyIsTFRTOiJBIGg6bW06c3Mg4KSs4KSc4KWHIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEEgaDptbSDgpKzgpJzgpYciLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZLCBBIGg6bW0g4KSs4KSc4KWHIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgpIbgpJxdIExUIixuZXh0RGF5OiJb4KSV4KSyXSBMVCIsbmV4dFdlZWs6ImRkZGQsIExUIixsYXN0RGF5OiJb4KSV4KSyXSBMVCIsbGFzdFdlZWs6IlvgpKrgpL/gpJvgpLLgpYddIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgpK7gpYfgpIIiLHBhc3Q6IiVzIOCkquCkueCksuClhyIsczoi4KSV4KWB4KSbIOCkueClgCDgpJXgpY3gpLfgpKMiLG06IuCkj+CklSDgpK7gpL/gpKjgpJ8iLG1tOiIlZCDgpK7gpL/gpKjgpJ8iLGg6IuCkj+CklSDgpJjgpILgpJ/gpL4iLGhoOiIlZCDgpJjgpILgpJ/gpYciLGQ6IuCkj+CklSDgpKbgpL/gpKgiLGRkOiIlZCDgpKbgpL/gpKgiLE06IuCkj+CklSDgpK7gpLngpYDgpKjgpYciLE1NOiIlZCDgpK7gpLngpYDgpKjgpYciLHk6IuCkj+CklSDgpLXgpLDgpY3gpLciLHl5OiIlZCDgpLXgpLDgpY3gpLcifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4KWn4KWo4KWp4KWq4KWr4KWs4KWt4KWu4KWv4KWmXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gpLDgpL7gpKR84KS44KWB4KSs4KS5fOCkpuCli+CkquCkueCksHzgpLbgpL7gpK4vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgpLDgpL7gpKQiPT09ZT90PDQ/dDp0KzEyOiLgpLjgpYHgpKzgpLkiPT09ZT90OiLgpKbgpYvgpKrgpLngpLAiPT09ZT90Pj0xMD90OnQrMTI6IuCktuCkvuCkriI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4KSw4KS+4KSkIjp0PDEwPyLgpLjgpYHgpKzgpLkiOnQ8MTc/IuCkpuCli+CkquCkueCksCI6dDwyMD8i4KS24KS+4KSuIjoi4KSw4KS+4KSkIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpKXt2YXIgbj10KyIgIjtzd2l0Y2goaSl7Y2FzZSJtIjpyZXR1cm4gZT8iamVkbmEgbWludXRhIjoiamVkbmUgbWludXRlIjtjYXNlIm1tIjpyZXR1cm4gbis9MT09PXQ/Im1pbnV0YSI6Mj09PXR8fDM9PT10fHw0PT09dD8ibWludXRlIjoibWludXRhIjtjYXNlImgiOnJldHVybiBlPyJqZWRhbiBzYXQiOiJqZWRub2cgc2F0YSI7Y2FzZSJoaCI6cmV0dXJuIG4rPTE9PT10PyJzYXQiOjI9PT10fHwzPT09dHx8ND09PXQ/InNhdGEiOiJzYXRpIjtjYXNlImRkIjpyZXR1cm4gbis9MT09PXQ/ImRhbiI6ImRhbmEiO2Nhc2UiTU0iOnJldHVybiBuKz0xPT09dD8ibWplc2VjIjoyPT09dHx8Mz09PXR8fDQ9PT10PyJtamVzZWNhIjoibWplc2VjaSI7Y2FzZSJ5eSI6cmV0dXJuIG4rPTE9PT10PyJnb2RpbmEiOjI9PT10fHwzPT09dHx8ND09PXQ/ImdvZGluZSI6ImdvZGluYSJ9fXZhciBpPXQuZGVmaW5lTG9jYWxlKCJociIse21vbnRoczp7Zm9ybWF0OiJzaWplxI1uamFfdmVsamHEjWVfb8W+dWprYV90cmF2bmphX3N2aWJuamFfbGlwbmphX3NycG5qYV9rb2xvdm96YV9ydWpuYV9saXN0b3BhZGFfc3R1ZGVub2dhX3Byb3NpbmNhIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6InNpamXEjWFual92ZWxqYcSNYV9vxb51amFrX3RyYXZhbmpfc3ZpYmFual9saXBhbmpfc3JwYW5qX2tvbG92b3pfcnVqYW5fbGlzdG9wYWRfc3R1ZGVuaV9wcm9zaW5hYyIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6InNpai5fdmVsai5fb8W+dS5fdHJhLl9zdmkuX2xpcC5fc3JwLl9rb2wuX3J1ai5fbGlzLl9zdHUuX3Byby4iLnNwbGl0KCJfIiksd2Vla2RheXM6Im5lZGplbGphX3BvbmVkamVsamFrX3V0b3Jha19zcmlqZWRhX8SNZXR2cnRha19wZXRha19zdWJvdGEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoibmVkLl9wb24uX3V0by5fc3JpLl/EjWV0Ll9wZXQuX3N1Yi4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Im5lX3BvX3V0X3NyX8SNZV9wZV9zdSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQuIE1NLiBZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBELiBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbZGFuYXMgdV0gTFQiLG5leHREYXk6IltzdXRyYSB1XSBMVCIsbmV4dFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbdV0gW25lZGplbGp1XSBbdV0gTFQiO2Nhc2UgMzpyZXR1cm4iW3VdIFtzcmlqZWR1XSBbdV0gTFQiO2Nhc2UgNjpyZXR1cm4iW3VdIFtzdWJvdHVdIFt1XSBMVCI7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6Y2FzZSA1OnJldHVybiJbdV0gZGRkZCBbdV0gTFQifX0sbGFzdERheToiW2p1xI1lciB1XSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOmNhc2UgMzpyZXR1cm4iW3Byb8WhbHVdIGRkZGQgW3VdIExUIjtjYXNlIDY6cmV0dXJuIltwcm/FoWxlXSBbc3Vib3RlXSBbdV0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3Byb8WhbGldIGRkZGQgW3VdIExUIn19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InphICVzIixwYXN0OiJwcmlqZSAlcyIsczoicGFyIHNla3VuZGkiLG06ZSxtbTplLGg6ZSxoaDplLGQ6ImRhbiIsZGQ6ZSxNOiJtamVzZWMiLE1NOmUseToiZ29kaW51Iix5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9dDtzd2l0Y2goaSl7Y2FzZSJzIjpyZXR1cm4gbnx8ZT8ibsOpaMOhbnkgbcOhc29kcGVyYyI6Im7DqWjDoW55IG3DoXNvZHBlcmNlIjtjYXNlIm0iOnJldHVybiJlZ3kiKyhufHxlPyIgcGVyYyI6IiBwZXJjZSIpO2Nhc2UibW0iOnJldHVybiByKyhufHxlPyIgcGVyYyI6IiBwZXJjZSIpO2Nhc2UiaCI6cmV0dXJuImVneSIrKG58fGU/IiDDs3JhIjoiIMOzcsOhamEiKTtjYXNlImhoIjpyZXR1cm4gcisobnx8ZT8iIMOzcmEiOiIgw7Nyw6FqYSIpO2Nhc2UiZCI6cmV0dXJuImVneSIrKG58fGU/IiBuYXAiOiIgbmFwamEiKTtjYXNlImRkIjpyZXR1cm4gcisobnx8ZT8iIG5hcCI6IiBuYXBqYSIpO2Nhc2UiTSI6cmV0dXJuImVneSIrKG58fGU/IiBow7NuYXAiOiIgaMOzbmFwamEiKTtjYXNlIk1NIjpyZXR1cm4gcisobnx8ZT8iIGjDs25hcCI6IiBow7NuYXBqYSIpO2Nhc2UieSI6cmV0dXJuImVneSIrKG58fGU/IiDDqXYiOiIgw6l2ZSIpO2Nhc2UieXkiOnJldHVybiByKyhufHxlPyIgw6l2IjoiIMOpdmUiKX1yZXR1cm4iIn1mdW5jdGlvbiBpKHQpe3JldHVybih0PyIiOiJbbcO6bHRdICIpKyJbIituW3RoaXMuZGF5KCldKyJdIExUWy1rb3JdIn12YXIgbj0idmFzw6FybmFwIGjDqXRmxZFuIGtlZGRlbiBzemVyZMOhbiBjc8O8dMO2cnTDtmvDtm4gcMOpbnRla2VuIHN6b21iYXRvbiIuc3BsaXQoIiAiKSxyPXQuZGVmaW5lTG9jYWxlKCJodSIse21vbnRoczoiamFudcOhcl9mZWJydcOhcl9tw6FyY2l1c1/DoXByaWxpc19tw6FqdXNfasO6bml1c19qw7psaXVzX2F1Z3VzenR1c19zemVwdGVtYmVyX29rdMOzYmVyX25vdmVtYmVyX2RlY2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX23DoXJjX8OhcHJfbcOhal9qw7puX2rDumxfYXVnX3N6ZXB0X29rdF9ub3ZfZGVjIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJ2YXPDoXJuYXBfaMOpdGbFkV9rZWRkX3N6ZXJkYV9jc8O8dMO2cnTDtmtfcMOpbnRla19zem9tYmF0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6InZhc19ow6l0X2tlZGRfc3plX2Nzw7x0X3DDqW5fc3pvIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJ2X2hfa19zemVfY3NfcF9zem8iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IllZWVkuTU0uREQuIixMTDoiWVlZWS4gTU1NTSBELiIsTExMOiJZWVlZLiBNTU1NIEQuIEg6bW0iLExMTEw6IllZWVkuIE1NTU0gRC4sIGRkZGQgSDptbSJ9LG1lcmlkaWVtUGFyc2U6L2RlfGR1L2ksaXNQTTpmdW5jdGlvbih0KXtyZXR1cm4idSI9PT10LmNoYXJBdCgxKS50b0xvd2VyQ2FzZSgpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/aT09PSEwPyJkZSI6IkRFIjppPT09ITA/ImR1IjoiRFUifSxjYWxlbmRhcjp7c2FtZURheToiW21hXSBMVFsta29yXSIsbmV4dERheToiW2hvbG5hcF0gTFRbLWtvcl0iLG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY2FsbCh0aGlzLCEwKX0sbGFzdERheToiW3RlZ25hcF0gTFRbLWtvcl0iLGxhc3RXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY2FsbCh0aGlzLCExKX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgbcO6bHZhIixwYXN0OiIlcyIsczplLG06ZSxtbTplLGg6ZSxoaDplLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gcn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJoeS1hbSIse21vbnRoczp7Zm9ybWF0OiLVsNW41oLVttW+1aHWgNWrX9aD1aXVv9aA1b7VodaA1atf1bTVodaA1b/Vq1/VodW61oDVq9Ws1atf1bTVodW11avVvdWrX9Ww1bjWgtW21avVvdWrX9Ww1bjWgtWs1avVvdWrX9aF1aPVuNW91b/VuNW91atf1b3VpdW61b/VpdW01aLVpdaA1atf1bDVuNWv1b/VpdW01aLVpdaA1atf1bbVuNW11aXVtNWi1aXWgNWrX9Wk1aXVr9W/1aXVtNWi1aXWgNWrIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6ItWw1bjWgtW21b7VodaAX9aD1aXVv9aA1b7VodaAX9W01aHWgNW/X9Wh1brWgNWr1axf1bTVodW11avVvV/VsNW41oLVttWr1b1f1bDVuNaC1azVq9W9X9aF1aPVuNW91b/VuNW9X9W91aXVutW/1aXVtNWi1aXWgF/VsNW41a/Vv9Wl1bTVotWl1oBf1bbVuNW11aXVtNWi1aXWgF/VpNWl1a/Vv9Wl1bTVotWl1oAiLnNwbGl0KCJfIil9LG1vbnRoc1Nob3J0OiLVsNW21b5f1oPVv9aAX9W01oDVv1/VodW61oBf1bTVtdW9X9Ww1bbVvV/VsNWs1b1f1oXVo9W9X9W91brVv1/VsNWv1b9f1bbVtNWiX9Wk1a/VvyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi1a/Vq9aA1aHVr9WrX9Wl1oDVr9W41oLVt9Wh1aLVqdWrX9Wl1oDVpdaE1bfVodWi1anVq1/VudW41oDVpdaE1bfVodWi1anVq1/VsNWr1bbVo9W31aHVotWp1atf1bjWgtaA1aLVodWpX9W31aHVotWh1akiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi1a/WgNWvX9Wl1oDVr1/VpdaA1oRf1bnWgNaEX9Ww1bbVo1/VuNaC1oDVol/Vt9Wi1akiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItWv1oDVr1/VpdaA1a9f1aXWgNaEX9W51oDWhF/VsNW21aNf1bjWgtaA1aJf1bfVotWpIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSDVqS4iLExMTDoiRCBNTU1NIFlZWVkg1akuLCBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkg1akuLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb1aHVtdW91oXWgF0gTFQiLG5leHREYXk6IlvVvtWh1bLVqF0gTFQiLGxhc3REYXk6IlvVpdaA1aXVr10gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuImRkZGQgW9aF1oDVqCDVqtWh1bTVqF0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJb1aHVttaB1aHVrl0gZGRkZCBb1oXWgNWoINWq1aHVtNWoXSBMVCJ9LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzINWw1aXVv9W4IixwYXN0OiIlcyDVodW81aHVuyIsczoi1bTVqyDWhNWh1bbVqyDVvtWh1bXWgNWv1bXVodW2IixtOiLWgNW41brVpSIsbW06IiVkINaA1bjVutWlIixoOiLVqtWh1bQiLGhoOiIlZCDVqtWh1bQiLGQ6ItaF1oAiLGRkOiIlZCDWhdaAIixNOiLVodW01avVvSIsTU06IiVkINWh1bTVq9W9Iix5OiLVv9Wh1oDVqyIseXk6IiVkINW/1aHWgNWrIn0sbWVyaWRpZW1QYXJzZTov1aPVq9W31aXWgNW+1aF81aHVvNWh1b7VuNW/1b7VoXzWgdWl1oDVpdWv1b7VoXzVpdaA1aXVr9W41bXVodW2Lyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKNaB1aXWgNWl1a/VvtWhfNWl1oDVpdWv1bjVtdWh1bYpJC8udGVzdCh0KX0sbWVyaWRpZW06ZnVuY3Rpb24odCl7cmV0dXJuIHQ8ND8i1aPVq9W31aXWgNW+1aEiOnQ8MTI/ItWh1bzVodW+1bjVv9W+1aEiOnQ8MTc/ItaB1aXWgNWl1a/VvtWhIjoi1aXWgNWl1a/VuNW11aHVtiJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfXxcZHsxLDJ9LSjVq9W2fNaA1aQpLyxvcmRpbmFsOmZ1bmN0aW9uKHQsZSl7c3dpdGNoKGUpe2Nhc2UiREREIjpjYXNlInciOmNhc2UiVyI6Y2FzZSJERERvIjpyZXR1cm4gMT09PXQ/dCsiLdWr1bYiOnQrIi3WgNWkIjtkZWZhdWx0OnJldHVybiB0fX0sd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiaWQiLHttb250aHM6IkphbnVhcmlfRmVicnVhcmlfTWFyZXRfQXByaWxfTWVpX0p1bmlfSnVsaV9BZ3VzdHVzX1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWVpX0p1bl9KdWxfQWdzX1NlcF9Pa3RfTm92X0RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiTWluZ2d1X1NlbmluX1NlbGFzYV9SYWJ1X0thbWlzX0p1bWF0X1NhYnR1Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Ik1pbl9TZW5fU2VsX1JhYl9LYW1fSnVtX1NhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiTWdfU25fU2xfUmJfS21fSm1fU2IiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0ifSxtZXJpZGllbVBhcnNlOi9wYWdpfHNpYW5nfHNvcmV8bWFsYW0vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCJwYWdpIj09PWU/dDoic2lhbmciPT09ZT90Pj0xMT90OnQrMTI6InNvcmUiPT09ZXx8Im1hbGFtIj09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMT8icGFnaSI6dDwxNT8ic2lhbmciOnQ8MTk/InNvcmUiOiJtYWxhbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSGFyaSBpbmkgcHVrdWxdIExUIixuZXh0RGF5OiJbQmVzb2sgcHVrdWxdIExUIixuZXh0V2VlazoiZGRkZCBbcHVrdWxdIExUIixsYXN0RGF5OiJbS2VtYXJpbiBwdWt1bF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtsYWx1IHB1a3VsXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFsYW0gJXMiLHBhc3Q6IiVzIHlhbmcgbGFsdSIsczoiYmViZXJhcGEgZGV0aWsiLG06InNlbWVuaXQiLG1tOiIlZCBtZW5pdCIsaDoic2VqYW0iLGhoOiIlZCBqYW0iLGQ6InNlaGFyaSIsZGQ6IiVkIGhhcmkiLE06InNlYnVsYW4iLAoJTU06IiVkIGJ1bGFuIix5OiJzZXRhaHVuIix5eToiJWQgdGFodW4ifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQlMTAwPT09MTF8fHQlMTAhPT0xfWZ1bmN0aW9uIGkodCxpLG4scil7dmFyIHM9dCsiICI7c3dpdGNoKG4pe2Nhc2UicyI6cmV0dXJuIGl8fHI/Im5va2tyYXIgc2Vrw7puZHVyIjoibm9ra3J1bSBzZWvDum5kdW0iO2Nhc2UibSI6cmV0dXJuIGk/Im3DrW7DunRhIjoibcOtbsO6dHUiO2Nhc2UibW0iOnJldHVybiBlKHQpP3MrKGl8fHI/Im3DrW7DunR1ciI6Im3DrW7DunR1bSIpOmk/cysibcOtbsO6dGEiOnMrIm3DrW7DunR1IjtjYXNlImhoIjpyZXR1cm4gZSh0KT9zKyhpfHxyPyJrbHVra3VzdHVuZGlyIjoia2x1a2t1c3R1bmR1bSIpOnMrImtsdWtrdXN0dW5kIjtjYXNlImQiOnJldHVybiBpPyJkYWd1ciI6cj8iZGFnIjoiZGVnaSI7Y2FzZSJkZCI6cmV0dXJuIGUodCk/aT9zKyJkYWdhciI6cysocj8iZGFnYSI6ImTDtmd1bSIpOmk/cysiZGFndXIiOnMrKHI/ImRhZyI6ImRlZ2kiKTtjYXNlIk0iOnJldHVybiBpPyJtw6FudcOwdXIiOnI/Im3DoW51w7AiOiJtw6FudcOwaSI7Y2FzZSJNTSI6cmV0dXJuIGUodCk/aT9zKyJtw6FudcOwaXIiOnMrKHI/Im3DoW51w7BpIjoibcOhbnXDsHVtIik6aT9zKyJtw6FudcOwdXIiOnMrKHI/Im3DoW51w7AiOiJtw6FudcOwaSIpO2Nhc2UieSI6cmV0dXJuIGl8fHI/IsOhciI6IsOhcmkiO2Nhc2UieXkiOnJldHVybiBlKHQpP3MrKGl8fHI/IsOhciI6IsOhcnVtIik6cysoaXx8cj8iw6FyIjoiw6FyaSIpfX12YXIgbj10LmRlZmluZUxvY2FsZSgiaXMiLHttb250aHM6ImphbsO6YXJfZmVicsO6YXJfbWFyc19hcHLDrWxfbWHDrV9qw7puw61fasO6bMOtX8OhZ8O6c3Rfc2VwdGVtYmVyX29rdMOzYmVyX27Ds3ZlbWJlcl9kZXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuX2ZlYl9tYXJfYXByX21hw61fasO6bl9qw7psX8OhZ8O6X3NlcF9va3RfbsOzdl9kZXMiLnNwbGl0KCJfIiksd2Vla2RheXM6InN1bm51ZGFndXJfbcOhbnVkYWd1cl/DvnJpw7BqdWRhZ3VyX21pw7B2aWt1ZGFndXJfZmltbXR1ZGFndXJfZsO2c3R1ZGFndXJfbGF1Z2FyZGFndXIiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic3VuX23DoW5fw75yaV9tacOwX2ZpbV9mw7ZzX2xhdSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTcOhX8Oecl9NaV9GaV9Gw7ZfTGEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIFtrbC5dIEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBba2wuXSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvDrSBkYWcga2wuXSBMVCIsbmV4dERheToiW8OhIG1vcmd1biBrbC5dIExUIixuZXh0V2VlazoiZGRkZCBba2wuXSBMVCIsbGFzdERheToiW8OtIGfDpnIga2wuXSBMVCIsbGFzdFdlZWs6Iltzw63DsGFzdGFdIGRkZGQgW2tsLl0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImVmdGlyICVzIixwYXN0OiJmeXJpciAlcyBzw63DsGFuIixzOmksbTppLG1tOmksaDoia2x1a2t1c3R1bmQiLGhoOmksZDppLGRkOmksTTppLE1NOmkseTppLHl5Oml9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoIml0Iix7bW9udGhzOiJnZW5uYWlvX2ZlYmJyYWlvX21hcnpvX2FwcmlsZV9tYWdnaW9fZ2l1Z25vX2x1Z2xpb19hZ29zdG9fc2V0dGVtYnJlX290dG9icmVfbm92ZW1icmVfZGljZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imdlbl9mZWJfbWFyX2Fwcl9tYWdfZ2l1X2x1Z19hZ29fc2V0X290dF9ub3ZfZGljIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJEb21lbmljYV9MdW5lZMOsX01hcnRlZMOsX01lcmNvbGVkw6xfR2lvdmVkw6xfVmVuZXJkw6xfU2FiYXRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRvbV9MdW5fTWFyX01lcl9HaW9fVmVuX1NhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRG9fTHVfTWFfTWVfR2lfVmVfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbT2dnaSBhbGxlXSBMVCIsbmV4dERheToiW0RvbWFuaSBhbGxlXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2FsbGVdIExUIixsYXN0RGF5OiJbSWVyaSBhbGxlXSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbbGEgc2NvcnNhXSBkZGRkIFthbGxlXSBMVCI7ZGVmYXVsdDpyZXR1cm4iW2xvIHNjb3Jzb10gZGRkZCBbYWxsZV0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZTpmdW5jdGlvbih0KXtyZXR1cm4oL15bMC05XS4rJC8udGVzdCh0KT8idHJhIjoiaW4iKSsiICIrdH0scGFzdDoiJXMgZmEiLHM6ImFsY3VuaSBzZWNvbmRpIixtOiJ1biBtaW51dG8iLG1tOiIlZCBtaW51dGkiLGg6InVuJ29yYSIsaGg6IiVkIG9yZSIsZDoidW4gZ2lvcm5vIixkZDoiJWQgZ2lvcm5pIixNOiJ1biBtZXNlIixNTToiJWQgbWVzaSIseToidW4gYW5ubyIseXk6IiVkIGFubmkifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3Cui8sb3JkaW5hbDoiJWTCuiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiamEiLHttb250aHM6IjHmnIhfMuaciF8z5pyIXzTmnIhfNeaciF825pyIXzfmnIhfOOaciF855pyIXzEw5pyIXzEx5pyIXzEy5pyIIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiIx5pyIXzLmnIhfM+aciF805pyIXzXmnIhfNuaciF835pyIXzjmnIhfOeaciF8xMOaciF8xMeaciF8xMuaciCIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi5pel5puc5pelX+aciOabnOaXpV/ngavmm5zml6Vf5rC05puc5pelX+acqOabnOaXpV/ph5Hmm5zml6Vf5Zyf5puc5pelIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuaXpV/mnIhf54GrX+awtF/mnKhf6YeRX+WcnyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi5pelX+aciF/ngatf5rC0X+acqF/ph5Ff5ZyfIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiQWjmmYJt5YiGIixMVFM6IkFo5pmCbeWIhnPnp5IiLEw6IllZWVkvTU0vREQiLExMOiJZWVlZ5bm0TeaciETml6UiLExMTDoiWVlZWeW5tE3mnIhE5pelQWjmmYJt5YiGIixMTExMOiJZWVlZ5bm0TeaciETml6VBaOaZgm3liIYgZGRkZCJ9LG1lcmlkaWVtUGFyc2U6L+WNiOWJjXzljYjlvowvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiLljYjlvowiPT09dH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDEyPyLljYjliY0iOiLljYjlvowifSxjYWxlbmRhcjp7c2FtZURheToiW+S7iuaXpV0gTFQiLG5leHREYXk6IlvmmI7ml6VdIExUIixuZXh0V2VlazoiW+adpemAsV1kZGRkIExUIixsYXN0RGF5OiJb5pio5pelXSBMVCIsbGFzdFdlZWs6IlvliY3pgLFdZGRkZCBMVCIsc2FtZUVsc2U6IkwifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3ml6UvLG9yZGluYWw6ZnVuY3Rpb24odCxlKXtzd2l0Y2goZSl7Y2FzZSJkIjpjYXNlIkQiOmNhc2UiREREIjpyZXR1cm4gdCsi5pelIjtkZWZhdWx0OnJldHVybiB0fX0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz5b6MIixwYXN0OiIlc+WJjSIsczoi5pWw56eSIixtOiIx5YiGIixtbToiJWTliIYiLGg6IjHmmYLplpMiLGhoOiIlZOaZgumWkyIsZDoiMeaXpSIsZGQ6IiVk5pelIixNOiIx44O25pyIIixNTToiJWTjg7bmnIgiLHk6IjHlubQiLHl5OiIlZOW5tCJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgianYiLHttb250aHM6IkphbnVhcmlfRmVicnVhcmlfTWFyZXRfQXByaWxfTWVpX0p1bmlfSnVsaV9BZ3VzdHVzX1NlcHRlbWJlcl9Pa3RvYmVyX05vcGVtYmVyX0Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWVpX0p1bl9KdWxfQWdzX1NlcF9Pa3RfTm9wX0RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiTWluZ2d1X1NlbmVuX1NlbG9zb19SZWJ1X0tlbWlzX0plbXV3YWhfU2VwdHUiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiTWluX1Nlbl9TZWxfUmViX0tlbV9KZW1fU2VwIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJNZ19Tbl9TbF9SYl9LbV9KbV9TcCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhILm1tIixMVFM6IkhILm1tLnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgW3B1a3VsXSBISC5tbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgW3B1a3VsXSBISC5tbSJ9LG1lcmlkaWVtUGFyc2U6L2VuamluZ3xzaXlhbmd8c29udGVufG5kYWx1LyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwiZW5qaW5nIj09PWU/dDoic2l5YW5nIj09PWU/dD49MTE/dDp0KzEyOiJzb250ZW4iPT09ZXx8Im5kYWx1Ij09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMT8iZW5qaW5nIjp0PDE1PyJzaXlhbmciOnQ8MTk/InNvbnRlbiI6Im5kYWx1In0sY2FsZW5kYXI6e3NhbWVEYXk6IltEaW50ZW4gcHVuaWtvIHB1a3VsXSBMVCIsbmV4dERheToiW01iZW5qYW5nIHB1a3VsXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3B1a3VsXSBMVCIsbGFzdERheToiW0thbGEgd2luZ2kgcHVrdWxdIExUIixsYXN0V2VlazoiZGRkZCBba2VwZW5na2VyIHB1a3VsXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToid29udGVuIGluZyAlcyIscGFzdDoiJXMgaW5na2FuZyBrZXBlbmdrZXIiLHM6InNhd2V0YXdpcyBkZXRpayIsbToic2V0dW5nZ2FsIG1lbml0IixtbToiJWQgbWVuaXQiLGg6InNldHVuZ2dhbCBqYW0iLGhoOiIlZCBqYW0iLGQ6InNlZGludGVuIixkZDoiJWQgZGludGVuIixNOiJzZXd1bGFuIixNTToiJWQgd3VsYW4iLHk6InNldGF1biIseXk6IiVkIHRhdW4ifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJrYSIse21vbnRoczp7c3RhbmRhbG9uZToi4YOY4YOQ4YOc4YOV4YOQ4YOg4YOYX+GDl+GDlOGDkeGDlOGDoOGDleGDkOGDmuGDmF/hg5vhg5Dhg6Dhg6Lhg5hf4YOQ4YOe4YOg4YOY4YOa4YOYX+GDm+GDkOGDmOGDoeGDmF/hg5jhg5Xhg5zhg5jhg6Hhg5hf4YOY4YOV4YOa4YOY4YOh4YOYX+GDkOGDkuGDleGDmOGDoeGDouGDnV/hg6Hhg5Thg6Xhg6Lhg5Thg5vhg5Hhg5Thg6Dhg5hf4YOd4YOl4YOi4YOd4YOb4YOR4YOU4YOg4YOYX+GDnOGDneGDlOGDm+GDkeGDlOGDoOGDmF/hg5Phg5Thg5nhg5Thg5vhg5Hhg5Thg6Dhg5giLnNwbGl0KCJfIiksZm9ybWF0OiLhg5jhg5Dhg5zhg5Xhg5Dhg6Dhg6Ff4YOX4YOU4YOR4YOU4YOg4YOV4YOQ4YOa4YOhX+GDm+GDkOGDoOGDouGDoV/hg5Dhg57hg6Dhg5jhg5rhg5jhg6Ff4YOb4YOQ4YOY4YOh4YOhX+GDmOGDleGDnOGDmOGDoeGDoV/hg5jhg5Xhg5rhg5jhg6Hhg6Ff4YOQ4YOS4YOV4YOY4YOh4YOi4YOhX+GDoeGDlOGDpeGDouGDlOGDm+GDkeGDlOGDoOGDoV/hg53hg6Xhg6Lhg53hg5vhg5Hhg5Thg6Dhg6Ff4YOc4YOd4YOU4YOb4YOR4YOU4YOg4YOhX+GDk+GDlOGDmeGDlOGDm+GDkeGDlOGDoOGDoSIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6IuGDmOGDkOGDnF/hg5fhg5Thg5Ff4YOb4YOQ4YOgX+GDkOGDnuGDoF/hg5vhg5Dhg5hf4YOY4YOV4YOcX+GDmOGDleGDml/hg5Dhg5Lhg5Vf4YOh4YOU4YOlX+GDneGDpeGDol/hg5zhg53hg5Rf4YOT4YOU4YOZIi5zcGxpdCgiXyIpLHdlZWtkYXlzOntzdGFuZGFsb25lOiLhg5nhg5Xhg5jhg6Dhg5Bf4YOd4YOg4YOo4YOQ4YOR4YOQ4YOX4YOYX+GDoeGDkOGDm+GDqOGDkOGDkeGDkOGDl+GDmF/hg53hg5fhg67hg6jhg5Dhg5Hhg5Dhg5fhg5hf4YOu4YOj4YOX4YOo4YOQ4YOR4YOQ4YOX4YOYX+GDnuGDkOGDoOGDkOGDoeGDmeGDlOGDleGDmF/hg6jhg5Dhg5Hhg5Dhg5fhg5giLnNwbGl0KCJfIiksZm9ybWF0OiLhg5nhg5Xhg5jhg6Dhg5Dhg6Ff4YOd4YOg4YOo4YOQ4YOR4YOQ4YOX4YOhX+GDoeGDkOGDm+GDqOGDkOGDkeGDkOGDl+GDoV/hg53hg5fhg67hg6jhg5Dhg5Hhg5Dhg5fhg6Ff4YOu4YOj4YOX4YOo4YOQ4YOR4YOQ4YOX4YOhX+GDnuGDkOGDoOGDkOGDoeGDmeGDlOGDleGDoV/hg6jhg5Dhg5Hhg5Dhg5fhg6EiLnNwbGl0KCJfIiksaXNGb3JtYXQ6Lyjhg6zhg5jhg5zhg5B84YOo4YOU4YOb4YOT4YOU4YOSKS99LHdlZWtkYXlzU2hvcnQ6IuGDmeGDleGDmF/hg53hg6Dhg6hf4YOh4YOQ4YObX+GDneGDl+GDrl/hg67hg6Phg5df4YOe4YOQ4YOgX+GDqOGDkOGDkSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4YOZ4YOVX+GDneGDoF/hg6Hhg5Bf4YOd4YOXX+GDruGDo1/hg57hg5Bf4YOo4YOQIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiaDptbSBBIixMVFM6Img6bW06c3MgQSIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIGg6bW0gQSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgaDptbSBBIn0sY2FsZW5kYXI6e3NhbWVEYXk6Ilvhg5Phg6bhg5Thg6FdIExUWy3hg5bhg5RdIixuZXh0RGF5OiJb4YOu4YOV4YOQ4YOaXSBMVFst4YOW4YOUXSIsbGFzdERheToiW+GDkuGDo+GDqOGDmOGDnF0gTFRbLeGDluGDlF0iLG5leHRXZWVrOiJb4YOo4YOU4YOb4YOT4YOU4YOSXSBkZGRkIExUWy3hg5bhg5RdIixsYXN0V2VlazoiW+GDrOGDmOGDnOGDkF0gZGRkZCBMVC3hg5bhg5QiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZnVuY3Rpb24odCl7cmV0dXJuLyjhg6zhg5Dhg5vhg5h84YOs4YOj4YOX4YOYfOGDoeGDkOGDkOGDl+GDmHzhg6zhg5Thg5rhg5gpLy50ZXN0KHQpP3QucmVwbGFjZSgv4YOYJC8sIuGDqOGDmCIpOnQrIuGDqOGDmCJ9LHBhc3Q6ZnVuY3Rpb24odCl7cmV0dXJuLyjhg6zhg5Dhg5vhg5h84YOs4YOj4YOX4YOYfOGDoeGDkOGDkOGDl+GDmHzhg5Phg6bhg5R84YOX4YOV4YOUKS8udGVzdCh0KT90LnJlcGxhY2UoLyjhg5h84YOUKSQvLCLhg5jhg6Eg4YOs4YOY4YOcIik6L+GDrOGDlOGDmuGDmC8udGVzdCh0KT90LnJlcGxhY2UoL+GDrOGDlOGDmuGDmCQvLCLhg6zhg5rhg5jhg6Eg4YOs4YOY4YOcIik6dm9pZCAwfSxzOiLhg6Dhg5Dhg5vhg5Phg5Thg5zhg5jhg5vhg5Qg4YOs4YOQ4YOb4YOYIixtOiLhg6zhg6Phg5fhg5giLG1tOiIlZCDhg6zhg6Phg5fhg5giLGg6IuGDoeGDkOGDkOGDl+GDmCIsaGg6IiVkIOGDoeGDkOGDkOGDl+GDmCIsZDoi4YOT4YOm4YOUIixkZDoiJWQg4YOT4YOm4YOUIixNOiLhg5fhg5Xhg5QiLE1NOiIlZCDhg5fhg5Xhg5QiLHk6IuGDrOGDlOGDmuGDmCIseXk6IiVkIOGDrOGDlOGDmuGDmCJ9LG9yZGluYWxQYXJzZTovMHwxLeGDmuGDmHzhg5vhg5QtXGR7MSwyfXxcZHsxLDJ9LeGDlC8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gMD09PXQ/dDoxPT09dD90KyIt4YOa4YOYIjp0PDIwfHx0PD0xMDAmJnQlMjA9PT0wfHx0JTEwMD09PTA/IuGDm+GDlC0iK3Q6dCsiLeGDlCJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezA6Ii3RiNGWIiwxOiIt0YjRliIsMjoiLdGI0ZYiLDM6Ii3RiNGWIiw0OiIt0YjRliIsNToiLdGI0ZYiLDY6Ii3RiNGLIiw3OiIt0YjRliIsODoiLdGI0ZYiLDk6Ii3RiNGLIiwxMDoiLdGI0YsiLDIwOiIt0YjRiyIsMzA6Ii3RiNGLIiw0MDoiLdGI0YsiLDUwOiIt0YjRliIsNjA6Ii3RiNGLIiw3MDoiLdGI0ZYiLDgwOiIt0YjRliIsOTA6Ii3RiNGLIiwxMDA6Ii3RiNGWIn0saT10LmRlZmluZUxvY2FsZSgia2siLHttb250aHM6ItKa0LDSo9GC0LDRgF/QkNKb0L/QsNC9X9Cd0LDRg9GA0YvQt1/QodOZ0YPRltGAX9Cc0LDQvNGL0YBf0JzQsNGD0YHRi9C8X9Co0ZbQu9C00LVf0KLQsNC80YvQt1/SmtGL0YDQutKv0LnQtdC6X9Ka0LDQt9Cw0L1f0prQsNGA0LDRiNCwX9CW0LXQu9GC0L7Sm9GB0LDQvSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi0prQsNKjX9CQ0pvQv1/QndCw0YNf0KHTmdGDX9Cc0LDQvF/QnNCw0YNf0KjRltC7X9Ci0LDQvF/SmtGL0YBf0prQsNC3X9Ka0LDRgF/QltC10LsiLnNwbGl0KCJfIiksd2Vla2RheXM6ItCW0LXQutGB0LXQvdCx0ZZf0JTSr9C50YHQtdC90LHRll/QodC10LnRgdC10L3QsdGWX9Ch05nRgNGB0LXQvdCx0ZZf0JHQtdC50YHQtdC90LHRll/QltKx0LzQsF/QodC10L3QsdGWIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ItCW0LXQul/QlNKv0Llf0KHQtdC5X9Ch05nRgF/QkdC10Llf0JbSsdC8X9Ch0LXQvSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0JbQul/QlNC5X9Ch0Llf0KHRgF/QkdC5X9CW0Lxf0KHQvSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvQkdKv0LPRltC9INGB0LDSk9Cw0YJdIExUIixuZXh0RGF5OiJb0JXRgNGC0LXSoyDRgdCw0pPQsNGCXSBMVCIsbmV4dFdlZWs6ImRkZGQgW9GB0LDSk9Cw0YJdIExUIixsYXN0RGF5OiJb0JrQtdGI0LUg0YHQsNKT0LDRgl0gTFQiLGxhc3RXZWVrOiJb06jRgtC60LXQvSDQsNC/0YLQsNC90YvSo10gZGRkZCBb0YHQsNKT0LDRgl0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzINGW0YjRltC90LTQtSIscGFzdDoiJXMg0LHSsdGA0YvQvSIsczoi0LHRltGA0L3QtdGI0LUg0YHQtdC60YPQvdC0IixtOiLQsdGW0YAg0LzQuNC90YPRgiIsbW06IiVkINC80LjQvdGD0YIiLGg6ItCx0ZbRgCDRgdCw0pPQsNGCIixoaDoiJWQg0YHQsNKT0LDRgiIsZDoi0LHRltGAINC60q/QvSIsZGQ6IiVkINC60q/QvSIsTToi0LHRltGAINCw0LkiLE1NOiIlZCDQsNC5Iix5OiLQsdGW0YAg0LbRi9C7Iix5eToiJWQg0LbRi9C7In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjRiNGWfNGI0YspLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBpPXQlMTAsbj10Pj0xMDA/MTAwOm51bGw7cmV0dXJuIHQrKGVbdF18fGVbaV18fGVbbl0pfSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJrbSIse21vbnRoczoi4Z6Y4Z6A4Z6a4Z62X+GegOGeu+GemOGfkuGel+GfiF/hnpjhnrfhnpPhnrZf4Z6Y4Z+B4Z6f4Z62X+Gep+Gen+Gel+Getl/hnpjhnrfhnpDhnrvhnpPhnrZf4Z6A4Z6A4Z+S4Z6A4Z6K4Z62X+Gen+GeuOGeoOGetl/hnoDhnonhn5LhnonhnrZf4Z6P4Z674Z6b4Z62X+GenOGet+GeheGfkuGehuGet+GegOGetl/hnpLhn5LhnpPhnrwiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuGemOGegOGemuGetl/hnoDhnrvhnpjhn5Lhnpfhn4hf4Z6Y4Z634Z6T4Z62X+GemOGfgeGen+Getl/hnqfhnp/hnpfhnrZf4Z6Y4Z634Z6Q4Z674Z6T4Z62X+GegOGegOGfkuGegOGeiuGetl/hnp/hnrjhnqDhnrZf4Z6A4Z6J4Z+S4Z6J4Z62X+Gej+Geu+Gem+Getl/hnpzhnrfhnoXhn5LhnobhnrfhnoDhnrZf4Z6S4Z+S4Z6T4Z68Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiLhnqLhnrbhnpHhnrfhno/hn5Lhnplf4Z6F4Z+Q4Z6T4Z+S4Z6RX+GeouGehOGfkuGeguGetuGeml/hnpbhnrvhnpJf4Z6W4Z+S4Z6a4Z6g4Z6f4Z+S4Z6U4Z6P4Z634Z+NX+Gen+Geu+GegOGfkuGeml/hnp/hn4Xhnprhn40iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4Z6i4Z624Z6R4Z634Z6P4Z+S4Z6ZX+GeheGfkOGek+GfkuGekV/hnqLhnoThn5LhnoLhnrbhnppf4Z6W4Z674Z6SX+GeluGfkuGemuGeoOGen+GfkuGelOGej+Get+GfjV/hnp/hnrvhnoDhn5Lhnppf4Z6f4Z+F4Z6a4Z+NIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLhnqLhnrbhnpHhnrfhno/hn5Lhnplf4Z6F4Z+Q4Z6T4Z+S4Z6RX+GeouGehOGfkuGeguGetuGeml/hnpbhnrvhnpJf4Z6W4Z+S4Z6a4Z6g4Z6f4Z+S4Z6U4Z6P4Z634Z+NX+Gen+Geu+GegOGfkuGeml/hnp/hn4Xhnprhn40iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4Z6Q4Z+S4Z6E4Z+D4Z6T4Z+B4Z+HIOGemOGfieGfhOGehF0gTFQiLG5leHREYXk6Ilvhnp/hn5LhnqLhn4LhnoAg4Z6Y4Z+J4Z+E4Z6EXSBMVCIsbmV4dFdlZWs6ImRkZGQgW+GemOGfieGfhOGehF0gTFQiLGxhc3REYXk6Ilvhnpjhn5Lhnp/hnrfhnpvhnpjhnrfhnokg4Z6Y4Z+J4Z+E4Z6EXSBMVCIsbGFzdFdlZWs6ImRkZGQgW+Gen+GelOGfkuGej+GetuGeoOGfjeGemOGeu+Gek10gW+GemOGfieGfhOGehF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz4Z6R4Z+A4Z6PIixwYXN0OiIlc+GemOGeu+GekyIsczoi4Z6U4Z+J4Z674Z6T4Z+S4Z6Y4Z624Z6T4Z6c4Z634Z6T4Z624Z6R4Z64IixtOiLhnpjhnr3hnpnhnpPhnrbhnpHhnrgiLG1tOiIlZCDhnpPhnrbhnpHhnrgiLGg6IuGemOGeveGemeGemOGfieGfhOGehCIsaGg6IiVkIOGemOGfieGfhOGehCIsZDoi4Z6Y4Z694Z6Z4Z6Q4Z+S4Z6E4Z+DIixkZDoiJWQg4Z6Q4Z+S4Z6E4Z+DIixNOiLhnpjhnr3hnpnhnoHhn4IiLE1NOiIlZCDhnoHhn4IiLHk6IuGemOGeveGemeGehuGfkuGek+GetuGfhiIseXk6IiVkIOGehuGfkuGek+GetuGfhiJ9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImtvIix7bW9udGhzOiIx7JuUXzLsm5RfM+yblF807JuUXzXsm5RfNuyblF837JuUXzjsm5RfOeyblF8xMOyblF8xMeyblF8xMuyblCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiMeyblF8y7JuUXzPsm5RfNOyblF817JuUXzbsm5RfN+yblF847JuUXznsm5RfMTDsm5RfMTHsm5RfMTLsm5QiLnNwbGl0KCJfIiksd2Vla2RheXM6IuydvOyalOydvF/sm5TsmpTsnbxf7ZmU7JqU7J28X+yImOyalOydvF/rqqnsmpTsnbxf6riI7JqU7J28X+2GoOyalOydvCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLsnbxf7JuUX+2ZlF/siJhf66qpX+q4iF/thqAiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuydvF/sm5Rf7ZmUX+yImF/rqqlf6riIX+2GoCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkEgaOyLnCBt67aEIixMVFM6IkEgaOyLnCBt67aEIHPstIgiLEw6IllZWVkuTU0uREQiLExMOiJZWVlZ64WEIE1NTU0gROydvCIsTExMOiJZWVlZ64WEIE1NTU0gROydvCBBIGjsi5wgbeu2hCIsTExMTDoiWVlZWeuFhCBNTU1NIETsnbwgZGRkZCBBIGjsi5wgbeu2hCJ9LGNhbGVuZGFyOntzYW1lRGF5OiLsmKTripggTFQiLG5leHREYXk6IuuCtOydvCBMVCIsbmV4dFdlZWs6ImRkZGQgTFQiLGxhc3REYXk6IuyWtOygnCBMVCIsbGFzdFdlZWs6IuyngOuCnOyjvCBkZGRkIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDtm4QiLHBhc3Q6IiVzIOyghCIsczoi66qH7LSIIixzczoiJWTstIgiLG06IuydvOu2hCIsbW06IiVk67aEIixoOiLtlZzsi5zqsIQiLGhoOiIlZOyLnOqwhCIsZDoi7ZWY66OoIixkZDoiJWTsnbwiLE06Iu2VnOuLrCIsTU06IiVk64usIix5OiLsnbzrhYQiLHl5OiIlZOuFhCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfeydvC8sb3JkaW5hbDoiJWTsnbwiLG1lcmlkaWVtUGFyc2U6L+yYpOyghHzsmKTtm4QvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuIuyYpO2bhCI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/IuyYpOyghCI6IuyYpO2bhCJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpLG4pe3ZhciByPXttOlsiZW5nIE1pbnV0dCIsImVuZ2VyIE1pbnV0dCJdLGg6WyJlbmcgU3Rvbm4iLCJlbmdlciBTdG9ubiJdLGQ6WyJlZW4gRGFnIiwiZW5nZW0gRGFnIl0sTTpbImVlIE1vdW50IiwiZW5nZW0gTW91bnQiXSx5OlsiZWUgSm9lciIsImVuZ2VtIEpvZXIiXX07cmV0dXJuIGU/cltpXVswXTpyW2ldWzFdfWZ1bmN0aW9uIGkodCl7dmFyIGU9dC5zdWJzdHIoMCx0LmluZGV4T2YoIiAiKSk7cmV0dXJuIHIoZSk/ImEgIit0OiJhbiAiK3R9ZnVuY3Rpb24gbih0KXt2YXIgZT10LnN1YnN0cigwLHQuaW5kZXhPZigiICIpKTtyZXR1cm4gcihlKT8idmlydSAiK3Q6InZpcnVuICIrdH1mdW5jdGlvbiByKHQpe2lmKHQ9cGFyc2VJbnQodCwxMCksaXNOYU4odCkpcmV0dXJuITE7aWYodDwwKXJldHVybiEwO2lmKHQ8MTApcmV0dXJuIDQ8PXQmJnQ8PTc7aWYodDwxMDApe3ZhciBlPXQlMTAsaT10LzEwO3JldHVybiByKDA9PT1lP2k6ZSl9aWYodDwxZTQpe2Zvcig7dD49MTA7KXQvPTEwO3JldHVybiByKHQpfXJldHVybiB0Lz0xZTMscih0KX12YXIgcz10LmRlZmluZUxvY2FsZSgibGIiLHttb250aHM6IkphbnVhcl9GZWJydWFyX03DpGVyel9BYnLDq2xsX01lZV9KdW5pX0p1bGlfQXVndXN0X1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0RlemVtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW4uX0ZlYnIuX01yei5fQWJyLl9NZWVfSnVuLl9KdWwuX0F1Zy5fU2VwdC5fT2t0Ll9Ob3YuX0Rlei4iLnNwbGl0KCJfIiksd2Vla2RheXM6IlNvbm5kZWdfTcOpaW5kZWdfRMOrbnNjaGRlZ19Nw6t0dHdvY2hfRG9ubmVzY2hkZWdfRnJlaWRlZ19TYW1zY2hkZWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU28uX03DqS5fRMOrLl9Nw6suX0RvLl9Gci5fU2EuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTb19Nw6lfRMOrX03Dq19Eb19Gcl9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0gW0F1ZXJdIixMVFM6Ikg6bW06c3MgW0F1ZXJdIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIFtBdWVyXSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0gW0F1ZXJdIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltIYXV0IHVtXSBMVCIsc2FtZUVsc2U6IkwiLG5leHREYXk6IltNdWVyIHVtXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3VtXSBMVCIsbGFzdERheToiW0fDq3NjaHRlciB1bV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMjpjYXNlIDQ6cmV0dXJuIltMZXNjaHRlbl0gZGRkZCBbdW1dIExUIjtkZWZhdWx0OnJldHVybiJbTGVzY2h0ZV0gZGRkZCBbdW1dIExUIn19fSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZTppLHBhc3Q6bixzOiJlIHB1ZXIgU2Vrb25uZW4iLG06ZSxtbToiJWQgTWludXR0ZW4iLGg6ZSxoaDoiJWQgU3Rvbm5lbiIsZDplLGRkOiIlZCBEZWVnIixNOmUsTU06IiVkIE3DqWludCIseTplLHl5OiIlZCBKb2VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIHN9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgibG8iLHttb250aHM6IuC6oeC6seC6h+C6geC6reC6mV/guoHgurjguqHgup7gurJf4Lqh4Lq14LqZ4LqyX+C7gOC6oeC6quC6sl/gup7gurbgupTguqrgurDgup7gurJf4Lqh4Lq04LqW4Lq44LqZ4LqyX+C6geC7jeC6peC6sOC6geC6u+C6lF/guqrgurTguofguqvgurJf4LqB4Lqx4LqZ4LqN4LqyX+C6leC6uOC6peC6sl/gup7gurDguojgurTguoFf4LqX4Lqx4LqZ4Lqn4LqyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLguqHgurHguofguoHguq3guplf4LqB4Lq44Lqh4Lqe4LqyX+C6oeC6teC6meC6sl/gu4DguqHguqrgurJf4Lqe4Lq24LqU4Lqq4Lqw4Lqe4LqyX+C6oeC6tOC6luC6uOC6meC6sl/guoHgu43guqXgurDguoHgurvgupRf4Lqq4Lq04LqH4Lqr4LqyX+C6geC6seC6meC6jeC6sl/gupXgurjguqXgurJf4Lqe4Lqw4LqI4Lq04LqBX+C6l+C6seC6meC6p+C6siIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4Lqt4Lqy4LqX4Lq04LqUX+C6iOC6seC6mV/guq3gurHguofguoTgurLguplf4Lqe4Lq44LqUX+C6nuC6sOC6q+C6seC6lF/guqrgurjguoFf4LuA4Lqq4Lq74LqyIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuC6l+C6tOC6lF/guojgurHguplf4Lqt4Lqx4LqH4LqE4Lqy4LqZX+C6nuC6uOC6lF/gup7gurDguqvgurHgupRf4Lqq4Lq44LqBX+C7gOC6quC6u+C6siIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4LqXX+C6iF/guq3guoRf4LqeX+C6nuC6q1/guqrguoFf4LqqIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoi4Lqn4Lqx4LqZZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LG1lcmlkaWVtUGFyc2U6L+C6leC6reC6meC7gOC6iuC6u+C7ieC6snzgupXguq3gupngu4HguqXguocvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuIuC6leC6reC6meC7geC6peC6hyI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/IuC6leC6reC6meC7gOC6iuC6u+C7ieC6siI6IuC6leC6reC6meC7geC6peC6hyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4Lqh4Lq34LuJ4LqZ4Lq14LuJ4LuA4Lqn4Lql4LqyXSBMVCIsbmV4dERheToiW+C6oeC6t+C7ieC6reC6t+C7iOC6meC7gOC6p+C6peC6sl0gTFQiLG5leHRXZWVrOiJb4Lqn4Lqx4LqZXWRkZGRb4Luc4LuJ4Lqy4LuA4Lqn4Lql4LqyXSBMVCIsbGFzdERheToiW+C6oeC6t+C7ieC6p+C6suC6meC6meC6teC7ieC7gOC6p+C6peC6sl0gTFQiLGxhc3RXZWVrOiJb4Lqn4Lqx4LqZXWRkZGRb4LuB4Lql4LuJ4Lqn4LqZ4Lq14LuJ4LuA4Lqn4Lql4LqyXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi4Lqt4Lq14LqBICVzIixwYXN0OiIlc+C6nOC7iOC6suC6meC6oeC6siIsczoi4Lqa4LuN4LuI4LuA4LqX4Lq74LuI4Lqy4LuD4LqU4Lqn4Lq04LqZ4Lqy4LqX4Lq1IixtOiIxIOC6meC6suC6l+C6tSIsbW06IiVkIOC6meC6suC6l+C6tSIsaDoiMSDguorgurvgu4jguqfgu4LguqHguociLGhoOiIlZCDguorgurvgu4jguqfgu4LguqHguociLGQ6IjEg4Lqh4Lq34LuJIixkZDoiJWQg4Lqh4Lq34LuJIixNOiIxIOC7gOC6lOC6t+C6reC6mSIsTU06IiVkIOC7gOC6lOC6t+C6reC6mSIseToiMSDgupvgurUiLHl5OiIlZCDgupvgurUifSxvcmRpbmFsUGFyc2U6LyjgupfgurXgu4gpXGR7MSwyfS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4i4LqX4Lq14LuIIit0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSxuKXtyZXR1cm4gZT8ia2VsaW9zIHNla3VuZMSXcyI6bj8ia2VsacWzIHNla3VuZMW+acWzIjoia2VsaWFzIHNla3VuZGVzIn1mdW5jdGlvbiBpKHQsZSxpLG4pe3JldHVybiBlP3IoaSlbMF06bj9yKGkpWzFdOnIoaSlbMl19ZnVuY3Rpb24gbih0KXtyZXR1cm4gdCUxMD09PTB8fHQ+MTAmJnQ8MjB9ZnVuY3Rpb24gcih0KXtyZXR1cm4gb1t0XS5zcGxpdCgiXyIpfWZ1bmN0aW9uIHModCxlLHMsbyl7dmFyIGE9dCsiICI7cmV0dXJuIDE9PT10P2EraSh0LGUsc1swXSxvKTplP2ErKG4odCk/cihzKVsxXTpyKHMpWzBdKTpvP2ErcihzKVsxXTphKyhuKHQpP3IocylbMV06cihzKVsyXSl9dmFyIG89e206Im1pbnV0xJdfbWludXTEl3NfbWludXTEmSIsbW06Im1pbnV0xJdzX21pbnXEjWnFs19taW51dGVzIixoOiJ2YWxhbmRhX3ZhbGFuZG9zX3ZhbGFuZMSFIixoaDoidmFsYW5kb3NfdmFsYW5kxbNfdmFsYW5kYXMiLGQ6ImRpZW5hX2RpZW5vc19kaWVuxIUiLGRkOiJkaWVub3NfZGllbsWzX2RpZW5hcyIsTToibcSXbnVvX23El25lc2lvX23El25lc8SvIixNTToibcSXbmVzaWFpX23El25lc2nFs19txJduZXNpdXMiLHk6Im1ldGFpX21ldMWzX21ldHVzIix5eToibWV0YWlfbWV0xbNfbWV0dXMifSxhPXQuZGVmaW5lTG9jYWxlKCJsdCIse21vbnRoczp7Zm9ybWF0OiJzYXVzaW9fdmFzYXJpb19rb3ZvX2JhbGFuZMW+aW9fZ2VndcW+xJdzX2JpcsW+ZWxpb19saWVwb3NfcnVncGrFq8SNaW9fcnVnc8SXam9fc3BhbGlvX2xhcGtyacSNaW9fZ3J1b2TFvmlvIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6InNhdXNpc192YXNhcmlzX2tvdmFzX2JhbGFuZGlzX2dlZ3XFvsSXX2JpcsW+ZWxpc19saWVwYV9ydWdwasWrdGlzX3J1Z3PEl2ppc19zcGFsaXNfbGFwa3JpdGlzX2dydW9kaXMiLnNwbGl0KCJfIil9LG1vbnRoc1Nob3J0OiJzYXVfdmFzX2tvdl9iYWxfZ2VnX2Jpcl9saWVfcmdwX3Jnc19zcGFfbGFwX2dyZCIuc3BsaXQoIl8iKSx3ZWVrZGF5czp7Zm9ybWF0OiJzZWttYWRpZW7Er19waXJtYWRpZW7Er19hbnRyYWRpZW7Er190cmXEjWlhZGllbsSvX2tldHZpcnRhZGllbsSvX3Blbmt0YWRpZW7Er1/FoWXFoXRhZGllbsSvIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6InNla21hZGllbmlzX3Bpcm1hZGllbmlzX2FudHJhZGllbmlzX3RyZcSNaWFkaWVuaXNfa2V0dmlydGFkaWVuaXNfcGVua3RhZGllbmlzX8WhZcWhdGFkaWVuaXMiLnNwbGl0KCJfIiksaXNGb3JtYXQ6L2RkZGQgSEg6bW0vfSx3ZWVrZGF5c1Nob3J0OiJTZWtfUGlyX0FudF9UcmVfS2V0X1Blbl/FoGXFoSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU19QX0FfVF9LX1BuX8WgIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IllZWVktTU0tREQiLExMOiJZWVlZIFttLl0gTU1NTSBEIFtkLl0iLExMTDoiWVlZWSBbbS5dIE1NTU0gRCBbZC5dLCBISDptbSBbdmFsLl0iLExMTEw6IllZWVkgW20uXSBNTU1NIEQgW2QuXSwgZGRkZCwgSEg6bW0gW3ZhbC5dIixsOiJZWVlZLU1NLUREIixsbDoiWVlZWSBbbS5dIE1NTU0gRCBbZC5dIixsbGw6IllZWVkgW20uXSBNTU1NIEQgW2QuXSwgSEg6bW0gW3ZhbC5dIixsbGxsOiJZWVlZIFttLl0gTU1NTSBEIFtkLl0sIGRkZCwgSEg6bW0gW3ZhbC5dIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvFoGlhbmRpZW5dIExUIixuZXh0RGF5OiJbUnl0b2pdIExUIixuZXh0V2VlazoiZGRkZCBMVCIsbGFzdERheToiW1Zha2FyXSBMVCIsbGFzdFdlZWs6IltQcmHEl2p1c8SvXSBkZGRkIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJwbyAlcyIscGFzdDoicHJpZcWhICVzIixzOmUsbTppLG1tOnMsaDppLGhoOnMsZDppLGRkOnMsTTppLE1NOnMseTppLHl5OnN9LG9yZGluYWxQYXJzZTovXGR7MSwyfS1vamkvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrIi1vamkifSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gYX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGkpe3JldHVybiBpP2UlMTA9PT0xJiYxMSE9PWU/dFsyXTp0WzNdOmUlMTA9PT0xJiYxMSE9PWU/dFswXTp0WzFdfWZ1bmN0aW9uIGkodCxpLG4pe3JldHVybiB0KyIgIitlKHNbbl0sdCxpKX1mdW5jdGlvbiBuKHQsaSxuKXtyZXR1cm4gZShzW25dLHQsaSl9ZnVuY3Rpb24gcih0LGUpe3JldHVybiBlPyJkYcW+YXMgc2VrdW5kZXMiOiJkYcW+xIFtIHNla3VuZMSTbSJ9dmFyIHM9e206Im1pbsWrdGVzX21pbsWrdMSTbV9taW7Fq3RlX21pbsWrdGVzIi5zcGxpdCgiXyIpLG1tOiJtaW7Fq3Rlc19taW7Fq3TEk21fbWluxat0ZV9taW7Fq3RlcyIuc3BsaXQoIl8iKSxoOiJzdHVuZGFzX3N0dW5kxIFtX3N0dW5kYV9zdHVuZGFzIi5zcGxpdCgiXyIpLGhoOiJzdHVuZGFzX3N0dW5kxIFtX3N0dW5kYV9zdHVuZGFzIi5zcGxpdCgiXyIpLGQ6ImRpZW5hc19kaWVuxIFtX2RpZW5hX2RpZW5hcyIuc3BsaXQoIl8iKSxkZDoiZGllbmFzX2RpZW7EgW1fZGllbmFfZGllbmFzIi5zcGxpdCgiXyIpLE06Im3Ek25lxaFhX23Ek25lxaFpZW1fbcSTbmVzaXNfbcSTbmXFoWkiLnNwbGl0KCJfIiksTU06Im3Ek25lxaFhX23Ek25lxaFpZW1fbcSTbmVzaXNfbcSTbmXFoWkiLnNwbGl0KCJfIikseToiZ2FkYV9nYWRpZW1fZ2Fkc19nYWRpIi5zcGxpdCgiXyIpLHl5OiJnYWRhX2dhZGllbV9nYWRzX2dhZGkiLnNwbGl0KCJfIil9LG89dC5kZWZpbmVMb2NhbGUoImx2Iix7bW9udGhzOiJqYW52xIFyaXNfZmVicnXEgXJpc19tYXJ0c19hcHLEq2xpc19tYWlqc19qxatuaWpzX2rFq2xpanNfYXVndXN0c19zZXB0ZW1icmlzX29rdG9icmlzX25vdmVtYnJpc19kZWNlbWJyaXMiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imphbl9mZWJfbWFyX2Fwcl9tYWlfasWrbl9qxatsX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6InN2xJN0ZGllbmFfcGlybWRpZW5hX290cmRpZW5hX3RyZcWhZGllbmFfY2V0dXJ0ZGllbmFfcGlla3RkaWVuYV9zZXN0ZGllbmEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU3ZfUF9PX1RfQ19Qa19TIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTdl9QX09fVF9DX1BrX1MiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWS4iLExMOiJZWVlZLiBbZ2FkYV0gRC4gTU1NTSIsTExMOiJZWVlZLiBbZ2FkYV0gRC4gTU1NTSwgSEg6bW0iLExMTEw6IllZWVkuIFtnYWRhXSBELiBNTU1NLCBkZGRkLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbxaBvZGllbiBwdWxrc3Rlbl0gTFQiLG5leHREYXk6IltSxKt0IHB1bGtzdGVuXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3B1bGtzdGVuXSBMVCIsbGFzdERheToiW1Zha2FyIHB1bGtzdGVuXSBMVCIsbGFzdFdlZWs6IltQYWfEgWp1xaHEgV0gZGRkZCBbcHVsa3N0ZW5dIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJwxJNjICVzIixwYXN0OiJwaXJtcyAlcyIsczpyLG06bixtbTppLGg6bixoaDppLGQ6bixkZDppLE06bixNTTppLHk6bix5eTppfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gb30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXt3b3Jkczp7bTpbImplZGFuIG1pbnV0IiwiamVkbm9nIG1pbnV0YSJdLG1tOlsibWludXQiLCJtaW51dGEiLCJtaW51dGEiXSxoOlsiamVkYW4gc2F0IiwiamVkbm9nIHNhdGEiXSxoaDpbInNhdCIsInNhdGEiLCJzYXRpIl0sZGQ6WyJkYW4iLCJkYW5hIiwiZGFuYSJdLE1NOlsibWplc2VjIiwibWplc2VjYSIsIm1qZXNlY2kiXSx5eTpbImdvZGluYSIsImdvZGluZSIsImdvZGluYSJdfSxjb3JyZWN0R3JhbW1hdGljYWxDYXNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDE9PT10P2VbMF06dD49MiYmdDw9ND9lWzFdOmVbMl19LHRyYW5zbGF0ZTpmdW5jdGlvbih0LGksbil7dmFyIHI9ZS53b3Jkc1tuXTtyZXR1cm4gMT09PW4ubGVuZ3RoP2k/clswXTpyWzFdOnQrIiAiK2UuY29ycmVjdEdyYW1tYXRpY2FsQ2FzZSh0LHIpfX0saT10LmRlZmluZUxvY2FsZSgibWUiLHttb250aHM6WyJqYW51YXIiLCJmZWJydWFyIiwibWFydCIsImFwcmlsIiwibWFqIiwianVuIiwianVsIiwiYXZndXN0Iiwic2VwdGVtYmFyIiwib2t0b2JhciIsIm5vdmVtYmFyIiwiZGVjZW1iYXIiXSxtb250aHNTaG9ydDpbImphbi4iLCJmZWIuIiwibWFyLiIsImFwci4iLCJtYWoiLCJqdW4iLCJqdWwiLCJhdmcuIiwic2VwLiIsIm9rdC4iLCJub3YuIiwiZGVjLiJdLHdlZWtkYXlzOlsibmVkamVsamEiLCJwb25lZGplbGphayIsInV0b3JhayIsInNyaWplZGEiLCLEjWV0dnJ0YWsiLCJwZXRhayIsInN1Ym90YSJdLHdlZWtkYXlzU2hvcnQ6WyJuZWQuIiwicG9uLiIsInV0by4iLCJzcmkuIiwixI1ldC4iLCJwZXQuIiwic3ViLiJdLHdlZWtkYXlzTWluOlsibmUiLCJwbyIsInV0Iiwic3IiLCLEjWUiLCJwZSIsInN1Il0sbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELiBNTS4gWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2RhbmFzIHVdIExUIixuZXh0RGF5OiJbc2p1dHJhIHVdIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt1XSBbbmVkamVsanVdIFt1XSBMVCI7Y2FzZSAzOnJldHVybiJbdV0gW3NyaWplZHVdIFt1XSBMVCI7Y2FzZSA2OnJldHVybiJbdV0gW3N1Ym90dV0gW3VdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlt1XSBkZGRkIFt1XSBMVCJ9fSxsYXN0RGF5OiJbanXEjWUgdV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7dmFyIHQ9WyJbcHJvxaFsZV0gW25lZGplbGplXSBbdV0gTFQiLCJbcHJvxaFsb2ddIFtwb25lZGplbGprYV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbdXRvcmthXSBbdV0gTFQiLCJbcHJvxaFsZV0gW3NyaWplZGVdIFt1XSBMVCIsIltwcm/FoWxvZ10gW8SNZXR2cnRrYV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbcGV0a2FdIFt1XSBMVCIsIltwcm/FoWxlXSBbc3Vib3RlXSBbdV0gTFQiXTtyZXR1cm4gdFt0aGlzLmRheSgpXX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiemEgJXMiLHBhc3Q6InByaWplICVzIixzOiJuZWtvbGlrbyBzZWt1bmRpIixtOmUudHJhbnNsYXRlLG1tOmUudHJhbnNsYXRlLGg6ZS50cmFuc2xhdGUsaGg6ZS50cmFuc2xhdGUsZDoiZGFuIixkZDplLnRyYW5zbGF0ZSxNOiJtamVzZWMiLE1NOmUudHJhbnNsYXRlLHk6ImdvZGludSIseXk6ZS50cmFuc2xhdGV9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoIm1rIix7bW9udGhzOiLRmNCw0L3Rg9Cw0YDQuF/RhNC10LLRgNGD0LDRgNC4X9C80LDRgNGCX9Cw0L/RgNC40Ltf0LzQsNGYX9GY0YPQvdC4X9GY0YPQu9C4X9Cw0LLQs9GD0YHRgl/RgdC10L/RgtC10LzQstGA0Lhf0L7QutGC0L7QvNCy0YDQuF/QvdC+0LXQvNCy0YDQuF/QtNC10LrQtdC80LLRgNC4Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLRmNCw0L1f0YTQtdCyX9C80LDRgF/QsNC/0YBf0LzQsNGYX9GY0YPQvV/RmNGD0Ltf0LDQstCzX9GB0LXQv1/QvtC60YJf0L3QvtC1X9C00LXQuiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0L3QtdC00LXQu9CwX9C/0L7QvdC10LTQtdC70L3QuNC6X9Cy0YLQvtGA0L3QuNC6X9GB0YDQtdC00LBf0YfQtdGC0LLRgNGC0L7Qul/Qv9C10YLQvtC6X9GB0LDQsdC+0YLQsCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLQvdC10LRf0L/QvtC9X9Cy0YLQvl/RgdGA0LVf0YfQtdGCX9C/0LXRgl/RgdCw0LEiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItC9ZV/Qv29f0LLRgl/RgdGAX9GH0LVf0L/QtV/RgWEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkQuTU0uWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9CU0LXQvdC10YEg0LLQvl0gTFQiLG5leHREYXk6IlvQo9GC0YDQtSDQstC+XSBMVCIsbmV4dFdlZWs6IlvQktC+XSBkZGRkIFvQstC+XSBMVCIsbGFzdERheToiW9CS0YfQtdGA0LAg0LLQvl0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA2OnJldHVybiJb0JjQt9C80LjQvdCw0YLQsNGC0LBdIGRkZGQgW9Cy0L5dIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlvQmNC30LzQuNC90LDRgtC40L7Rgl0gZGRkZCBb0LLQvl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0L/QvtGB0LvQtSAlcyIscGFzdDoi0L/RgNC10LQgJXMiLHM6ItC90LXQutC+0LvQutGDINGB0LXQutGD0L3QtNC4IixtOiLQvNC40L3Rg9GC0LAiLG1tOiIlZCDQvNC40L3Rg9GC0LgiLGg6ItGH0LDRgSIsaGg6IiVkINGH0LDRgdCwIixkOiLQtNC10L0iLGRkOiIlZCDQtNC10L3QsCIsTToi0LzQtdGB0LXRhiIsTU06IiVkINC80LXRgdC10YbQuCIseToi0LPQvtC00LjQvdCwIix5eToiJWQg0LPQvtC00LjQvdC4In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjQtdCyfNC10L180YLQuHzQstC4fNGA0Lh80LzQuCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPXQlMTAwO3JldHVybiAwPT09dD90KyIt0LXQsiI6MD09PWk/dCsiLdC10L0iOmk+MTAmJmk8MjA/dCsiLdGC0LgiOjE9PT1lP3QrIi3QstC4IjoyPT09ZT90KyIt0YDQuCI6Nz09PWV8fDg9PT1lP3QrIi3QvNC4Ijp0KyIt0YLQuCJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoIm1sIix7bW9udGhzOiLgtJzgtKjgtYHgtLXgtLDgtL9f4LSr4LWG4LSs4LWN4LSw4LWB4LS14LSw4LS/X+C0ruC0vuC1vOC0muC1jeC0muC1jV/gtI/gtKrgtY3gtLDgtL/gtb1f4LSu4LWH4LSv4LWNX+C0nOC1guC1ul/gtJzgtYLgtLLgtYhf4LST4LSX4LS44LWN4LSx4LWN4LSx4LWNX+C0uOC1huC0quC1jeC0seC1jeC0seC0guC0rOC1vF/gtJLgtJXgtY3gtJ/gtYvgtKzgtbxf4LSo4LS14LSC4LSs4LW8X+C0oeC0v+C0uOC0guC0rOC1vCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4LSc4LSo4LWBLl/gtKvgtYbgtKzgtY3gtLDgtYEuX+C0ruC0vuC1vC5f4LSP4LSq4LWN4LSw4LS/Ll/gtK7gtYfgtK/gtY1f4LSc4LWC4LW6X+C0nOC1guC0suC1iC5f4LST4LSXLl/gtLjgtYbgtKrgtY3gtLHgtY3gtLEuX+C0kuC0leC1jeC0n+C1iy5f4LSo4LS14LSCLl/gtKHgtL/gtLjgtIIuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgtJ7gtL7gtK/gtLHgtL7gtLTgtY3gtJpf4LSk4LS/4LSZ4LWN4LSV4LSz4LS+4LS04LWN4LSaX+C0muC1iuC0teC1jeC0teC0vuC0tOC1jeC0ml/gtKzgtYHgtKfgtKjgtL7gtLTgtY3gtJpf4LS14LWN4LSv4LS+4LS04LS+4LS04LWN4LSaX+C0teC1huC0s+C1jeC0s+C0v+C0r+C0vuC0tOC1jeC0ml/gtLbgtKjgtL/gtK/gtL7gtLTgtY3gtJoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4LSe4LS+4LSv4LW8X+C0pOC0v+C0meC1jeC0leC1vl/gtJrgtYrgtLXgtY3gtLVf4LSs4LWB4LSn4LW7X+C0teC1jeC0r+C0vuC0tOC0gl/gtLXgtYbgtLPgtY3gtLPgtL9f4LS24LSo4LS/Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgtJ7gtL5f4LSk4LS/X+C0muC1il/gtKzgtYFf4LS14LWN4LSv4LS+X+C0teC1hl/gtLYiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0gLeC0qOC1gSIsTFRTOiJBIGg6bW06c3MgLeC0qOC1gSIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZLCBBIGg6bW0gLeC0qOC1gSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSAt4LSo4LWBIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgtIfgtKjgtY3gtKjgtY1dIExUIixuZXh0RGF5OiJb4LSo4LS+4LSz4LWGXSBMVCIsbmV4dFdlZWs6ImRkZGQsIExUIixsYXN0RGF5OiJb4LSH4LSo4LWN4LSo4LSy4LWGXSBMVCIsbGFzdFdlZWs6IlvgtJXgtLTgtL/gtJ7gtY3gtJ5dIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgtJXgtLTgtL/gtJ7gtY3gtJ7gtY0iLHBhc3Q6IiVzIOC0ruC1geC1u+C0quC1jSIsczoi4LSF4LW94LSqIOC0qOC0v+C0ruC0v+C0t+C0meC1jeC0meC1viIsbToi4LSS4LSw4LWBIOC0ruC0v+C0qOC0v+C0seC1jeC0seC1jSIsbW06IiVkIOC0ruC0v+C0qOC0v+C0seC1jeC0seC1jSIsaDoi4LSS4LSw4LWBIOC0ruC0o+C0v+C0leC1jeC0leC1guC1vCIsaGg6IiVkIOC0ruC0o+C0v+C0leC1jeC0leC1guC1vCIsZDoi4LSS4LSw4LWBIOC0puC0v+C0teC0uOC0giIsZGQ6IiVkIOC0puC0v+C0teC0uOC0giIsTToi4LSS4LSw4LWBIOC0ruC0vuC0uOC0giIsTU06IiVkIOC0ruC0vuC0uOC0giIseToi4LSS4LSw4LWBIOC0teC1vOC0t+C0giIseXk6IiVkIOC0teC1vOC0t+C0giJ9LG1lcmlkaWVtUGFyc2U6L+C0sOC0vuC0pOC1jeC0sOC0v3zgtLDgtL7gtLXgtL/gtLLgtYZ84LSJ4LSa4LWN4LSaIOC0leC0tOC0v+C0nuC1jeC0nuC1jXzgtLXgtYjgtJXgtYHgtKjgtY3gtKjgtYfgtLDgtIJ84LSw4LS+4LSk4LWN4LSw4LS/L2ksbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuC0sOC0vuC0pOC1jeC0sOC0vyI9PT1lJiZ0Pj00fHwi4LSJ4LSa4LWN4LSaIOC0leC0tOC0v+C0nuC1jeC0nuC1jSI9PT1lfHwi4LS14LWI4LSV4LWB4LSo4LWN4LSo4LWH4LSw4LSCIj09PWU/dCsxMjp0fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4LSw4LS+4LSk4LWN4LSw4LS/Ijp0PDEyPyLgtLDgtL7gtLXgtL/gtLLgtYYiOnQ8MTc/IuC0ieC0muC1jeC0miDgtJXgtLTgtL/gtJ7gtY3gtJ7gtY0iOnQ8MjA/IuC0teC1iOC0leC1geC0qOC1jeC0qOC1h+C0sOC0giI6IuC0sOC0vuC0pOC1jeC0sOC0vyJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpLG4pe3ZhciByPSIiO2lmKGUpc3dpdGNoKGkpe2Nhc2UicyI6cj0i4KSV4KS+4KS54KWAIOCkuOClh+CkleCkguCkpiI7YnJlYWs7Y2FzZSJtIjpyPSLgpI/gpJUg4KSu4KS/4KSo4KS/4KSfIjticmVhaztjYXNlIm1tIjpyPSIlZCDgpK7gpL/gpKjgpL/gpJ/gpYciO2JyZWFrO2Nhc2UiaCI6cj0i4KSP4KSVIOCkpOCkvuCkuCI7YnJlYWs7Y2FzZSJoaCI6cj0iJWQg4KSk4KS+4KS4IjticmVhaztjYXNlImQiOnI9IuCkj+CklSDgpKbgpL/gpLXgpLgiO2JyZWFrO2Nhc2UiZGQiOnI9IiVkIOCkpuCkv+CkteCkuCI7YnJlYWs7Y2FzZSJNIjpyPSLgpI/gpJUg4KSu4KS54KS/4KSo4KS+IjticmVhaztjYXNlIk1NIjpyPSIlZCDgpK7gpLngpL/gpKjgpYciO2JyZWFrO2Nhc2UieSI6cj0i4KSP4KSVIOCkteCksOCljeCktyI7YnJlYWs7Y2FzZSJ5eSI6cj0iJWQg4KS14KSw4KWN4KS34KWHIn1lbHNlIHN3aXRjaChpKXtjYXNlInMiOnI9IuCkleCkvuCkueClgCDgpLjgpYfgpJXgpILgpKbgpL7gpIIiO2JyZWFrO2Nhc2UibSI6cj0i4KSP4KSV4KS+IOCkruCkv+CkqOCkv+Ckn+CkviI7YnJlYWs7Y2FzZSJtbSI6cj0iJWQg4KSu4KS/4KSo4KS/4KSf4KS+4KSCIjticmVhaztjYXNlImgiOnI9IuCkj+CkleCkviDgpKTgpL7gpLjgpL4iO2JyZWFrO2Nhc2UiaGgiOnI9IiVkIOCkpOCkvuCkuOCkvuCkgiI7YnJlYWs7Y2FzZSJkIjpyPSLgpI/gpJXgpL4g4KSm4KS/4KS14KS44KS+IjticmVhaztjYXNlImRkIjpyPSIlZCDgpKbgpL/gpLXgpLjgpL7gpIIiO2JyZWFrO2Nhc2UiTSI6cj0i4KSP4KSV4KS+IOCkruCkueCkv+CkqOCljeCkr+CkviI7YnJlYWs7Y2FzZSJNTSI6cj0iJWQg4KSu4KS54KS/4KSo4KWN4KSv4KS+4KSCIjticmVhaztjYXNlInkiOnI9IuCkj+CkleCkviDgpLXgpLDgpY3gpLfgpL4iO2JyZWFrO2Nhc2UieXkiOnI9IiVkIOCkteCksOCljeCkt+CkvuCkgiJ9cmV0dXJuIHIucmVwbGFjZSgvJWQvaSx0KX12YXIgaT17MToi4KWnIiwyOiLgpagiLDM6IuClqSIsNDoi4KWqIiw1OiLgpasiLDY6IuClrCIsNzoi4KWtIiw4OiLgpa4iLDk6IuClryIsMDoi4KWmIn0sbj17IuClpyI6IjEiLCLgpagiOiIyIiwi4KWpIjoiMyIsIuClqiI6IjQiLCLgpasiOiI1Iiwi4KWsIjoiNiIsIuClrSI6IjciLCLgpa4iOiI4Iiwi4KWvIjoiOSIsIuClpiI6IjAifSxyPXQuZGVmaW5lTG9jYWxlKCJtciIse21vbnRoczoi4KSc4KS+4KSo4KWH4KS14KS+4KSw4KWAX+Ckq+Clh+CkrOCljeCksOClgeCkteCkvuCksOClgF/gpK7gpL7gpLDgpY3gpJpf4KSP4KSq4KWN4KSw4KS/4KSyX+CkruClh1/gpJzgpYLgpKhf4KSc4KWB4KSy4KWIX+CkkeCkl+CkuOCljeCkn1/gpLjgpKrgpY3gpJ/gpYfgpILgpKzgpLBf4KSR4KSV4KWN4KSf4KWL4KSs4KSwX+CkqOCli+CkteCljeCkueClh+CkguCkrOCksF/gpKHgpL/gpLjgpYfgpILgpKzgpLAiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuCknOCkvuCkqOClhy5f4KSr4KWH4KSs4KWN4KSw4KWBLl/gpK7gpL7gpLDgpY3gpJouX+Ckj+CkquCljeCksOCkvy5f4KSu4KWHLl/gpJzgpYLgpKguX+CknOClgeCksuCliC5f4KSR4KSXLl/gpLjgpKrgpY3gpJ/gpYfgpIIuX+CkkeCkleCljeCkn+Cliy5f4KSo4KWL4KS14KWN4KS54KWH4KSCLl/gpKHgpL/gpLjgpYfgpIIuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgpLDgpLXgpL/gpLXgpL7gpLBf4KS44KWL4KSu4KS14KS+4KSwX+CkruCkguCkl+Cks+CkteCkvuCksF/gpKzgpYHgpKfgpLXgpL7gpLBf4KSX4KWB4KSw4KWC4KS14KS+4KSwX+CktuClgeCkleCljeCksOCkteCkvuCksF/gpLbgpKjgpL/gpLXgpL7gpLAiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4KSw4KS14KS/X+CkuOCli+Ckrl/gpK7gpILgpJfgpLNf4KSs4KWB4KSnX+Ckl+ClgeCksOClgl/gpLbgpYHgpJXgpY3gpLBf4KS24KSo4KS/Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgpLBf4KS44KWLX+CkruCkgl/gpKzgpYFf4KSX4KWBX+CktuClgV/gpLYiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0g4KS14KS+4KSc4KSk4KS+IixMVFM6IkEgaDptbTpzcyDgpLXgpL7gpJzgpKTgpL4iLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSwgQSBoOm1tIOCkteCkvuCknOCkpOCkviIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSDgpLXgpL7gpJzgpKTgpL4ifSxjYWxlbmRhcjp7c2FtZURheToiW+CkhuCknF0gTFQiLG5leHREYXk6IlvgpIngpKbgpY3gpK/gpL5dIExUIixuZXh0V2VlazoiZGRkZCwgTFQiLGxhc3REYXk6IlvgpJXgpL7gpLJdIExUIixsYXN0V2VlazoiW+CkruCkvuCkl+ClgOCksl0gZGRkZCwgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz4KSu4KSn4KWN4KSv4KWHIixwYXN0OiIlc+CkquClguCksOCljeCkteClgCIsczplLG06ZSxtbTplLGg6ZSxoaDplLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4KWn4KWo4KWp4KWq4KWr4KWs4KWt4KWu4KWv4KWmXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBuW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gpLDgpL7gpKTgpY3gpLDgpYB84KS44KSV4KS+4KSz4KWAfOCkpuClgeCkquCkvuCksOClgHzgpLjgpL7gpK/gpILgpJXgpL7gpLPgpYAvLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgpLDgpL7gpKTgpY3gpLDgpYAiPT09ZT90PDQ/dDp0KzEyOiLgpLjgpJXgpL7gpLPgpYAiPT09ZT90OiLgpKbgpYHgpKrgpL7gpLDgpYAiPT09ZT90Pj0xMD90OnQrMTI6IuCkuOCkvuCkr+CkguCkleCkvuCks+ClgCI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4KSw4KS+4KSk4KWN4KSw4KWAIjp0PDEwPyLgpLjgpJXgpL7gpLPgpYAiOnQ8MTc/IuCkpuClgeCkquCkvuCksOClgCI6dDwyMD8i4KS44KS+4KSv4KSC4KSV4KS+4KSz4KWAIjoi4KSw4KS+4KSk4KWN4KSw4KWAIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIHJ9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgibXMiLHttb250aHM6IkphbnVhcmlfRmVicnVhcmlfTWFjX0FwcmlsX01laV9KdW5fSnVsYWlfT2dvc19TZXB0ZW1iZXJfT2t0b2Jlcl9Ob3ZlbWJlcl9EaXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYWNfQXByX01laV9KdW5fSnVsX09nc19TZXBfT2t0X05vdl9EaXMiLnNwbGl0KCJfIiksd2Vla2RheXM6IkFoYWRfSXNuaW5fU2VsYXNhX1JhYnVfS2hhbWlzX0p1bWFhdF9TYWJ0dSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJBaGRfSXNuX1NlbF9SYWJfS2hhX0p1bV9TYWIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkFoX0lzX1NsX1JiX0ttX0ptX1NiIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEgubW0iLExUUzoiSEgubW0uc3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBbcHVrdWxdIEhILm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBbcHVrdWxdIEhILm1tIn0sbWVyaWRpZW1QYXJzZTovcGFnaXx0ZW5nYWhhcml8cGV0YW5nfG1hbGFtLyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwicGFnaSI9PT1lP3Q6InRlbmdhaGFyaSI9PT1lP3Q+PTExP3Q6dCsxMjoicGV0YW5nIj09PWV8fCJtYWxhbSI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTE/InBhZ2kiOnQ8MTU/InRlbmdhaGFyaSI6dDwxOT8icGV0YW5nIjoibWFsYW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0hhcmkgaW5pIHB1a3VsXSBMVCIsbmV4dERheToiW0Vzb2sgcHVrdWxdIExUIixuZXh0V2VlazoiZGRkZCBbcHVrdWxdIExUIixsYXN0RGF5OiJbS2VsbWFyaW4gcHVrdWxdIExUIixsYXN0V2VlazoiZGRkZCBbbGVwYXMgcHVrdWxdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJkYWxhbSAlcyIscGFzdDoiJXMgeWFuZyBsZXBhcyIsczoiYmViZXJhcGEgc2FhdCIsbToic2VtaW5pdCIsbW06IiVkIG1pbml0IixoOiJzZWphbSIsaGg6IiVkIGphbSIsZDoic2VoYXJpIixkZDoiJWQgaGFyaSIsTToic2VidWxhbiIsTU06IiVkIGJ1bGFuIix5OiJzZXRhaHVuIix5eToiJWQgdGFodW4ifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJtcy1teSIse21vbnRoczoiSmFudWFyaV9GZWJydWFyaV9NYWNfQXByaWxfTWVpX0p1bl9KdWxhaV9PZ29zX1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0Rpc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hY19BcHJfTWVpX0p1bl9KdWxfT2dzX1NlcF9Pa3RfTm92X0RpcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiQWhhZF9Jc25pbl9TZWxhc2FfUmFidV9LaGFtaXNfSnVtYWF0X1NhYnR1Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkFoZF9Jc25fU2VsX1JhYl9LaGFfSnVtX1NhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiQWhfSXNfU2xfUmJfS21fSm1fU2IiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0ifSxtZXJpZGllbVBhcnNlOi9wYWdpfHRlbmdhaGFyaXxwZXRhbmd8bWFsYW0vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCJwYWdpIj09PWU/dDoidGVuZ2FoYXJpIj09PWU/dD49MTE/dDp0KzEyOiJwZXRhbmciPT09ZXx8Im1hbGFtIj09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMT8icGFnaSI6dDwxNT8idGVuZ2FoYXJpIjp0PDE5PyJwZXRhbmciOiJtYWxhbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSGFyaSBpbmkgcHVrdWxdIExUIixuZXh0RGF5OiJbRXNvayBwdWt1bF0gTFQiLG5leHRXZWVrOiJkZGRkIFtwdWt1bF0gTFQiLGxhc3REYXk6IltLZWxtYXJpbiBwdWt1bF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtsZXBhcyBwdWt1bF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImRhbGFtICVzIixwYXN0OiIlcyB5YW5nIGxlcGFzIixzOiJiZWJlcmFwYSBzYWF0IixtOiJzZW1pbml0IixtbToiJWQgbWluaXQiLGg6InNlamFtIixoaDoiJWQgamFtIixkOiJzZWhhcmkiLGRkOiIlZCBoYXJpIixNOiJzZWJ1bGFuIixNTToiJWQgYnVsYW4iLHk6InNldGFodW4iLHl5OiIlZCB0YWh1biJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezE6IuGBgSIsMjoi4YGCIiwzOiLhgYMiLDQ6IuGBhCIsNToi4YGFIiw2OiLhgYYiLDc6IuGBhyIsODoi4YGIIiw5OiLhgYkiLDA6IuGBgCJ9LGk9eyLhgYEiOiIxIiwi4YGCIjoiMiIsIuGBgyI6IjMiLCLhgYQiOiI0Iiwi4YGFIjoiNSIsIuGBhiI6IjYiLCLhgYciOiI3Iiwi4YGIIjoiOCIsIuGBiSI6IjkiLCLhgYAiOiIwIn0sbj10LmRlZmluZUxvY2FsZSgibXkiLHttb250aHM6IuGAh+GAlOGAuuGAlOGAneGAq+GAm+GArl/hgJbhgLHhgJbhgLHhgKzhgLrhgJ3hgKvhgJvhgK5f4YCZ4YCQ4YC6X+GAp+GAleGAvOGArl/hgJnhgLFf4YCH4YC94YCU4YC6X+GAh+GAsOGAnOGAreGAr+GAhOGAul/hgJ7hgLzhgILhgK/hgJDhgLpf4YCF4YCA4YC64YCQ4YCE4YC64YCY4YCsX+GAoeGAseGArOGAgOGAuuGAkOGAreGAr+GAmOGArF/hgJThgK3hgK/hgJ3hgIThgLrhgJjhgKxf4YCS4YCu4YCH4YCE4YC64YCY4YCsIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLhgIfhgJThgLpf4YCW4YCxX+GAmeGAkOGAul/hgJXhgLzhgK5f4YCZ4YCxX+GAh+GAveGAlOGAul/hgJzhgK3hgK/hgIThgLpf4YCe4YC8X+GAheGAgOGAul/hgKHhgLHhgKzhgIDhgLpf4YCU4YCt4YCvX+GAkuGAriIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4YCQ4YCU4YCE4YC64YC54YCC4YCU4YC94YCxX+GAkOGAlOGAhOGAuuGAueGAnOGArF/hgKHhgIThgLrhgLnhgILhgKtf4YCX4YCv4YCS4YC54YCT4YCf4YCw4YC4X+GAgOGAvOGArOGAnuGAleGAkOGAseGAuF/hgJ7hgLHhgKzhgIDhgLzhgKxf4YCF4YCU4YCxIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuGAlOGAveGAsV/hgJzhgKxf4YCC4YCrX+GAn+GAsOGAuF/hgIDhgLzhgKxf4YCe4YCx4YCsX+GAlOGAsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4YCU4YC94YCxX+GAnOGArF/hgILhgKtf4YCf4YCw4YC4X+GAgOGAvOGArF/hgJ7hgLHhgKxf4YCU4YCxIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4YCa4YCU4YCxLl0gTFQgW+GAmeGAvuGArF0iLG5leHREYXk6IlvhgJnhgJThgIDhgLrhgJbhgLzhgJThgLpdIExUIFvhgJnhgL7hgKxdIixuZXh0V2VlazoiZGRkZCBMVCBb4YCZ4YC+4YCsXSIsbGFzdERheToiW+GAmeGAlOGAsS7hgIBdIExUIFvhgJnhgL7hgKxdIixsYXN0V2VlazoiW+GAleGAvOGAruGAuOGAgeGAsuGAt+GAnuGAseGArF0gZGRkZCBMVCBb4YCZ4YC+4YCsXSIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi4YCc4YCs4YCZ4YCK4YC64YC3ICVzIOGAmeGAvuGArCIscGFzdDoi4YCc4YC94YCU4YC64YCB4YCy4YC34YCe4YCx4YCsICVzIOGAgCIsczoi4YCF4YCA4YC54YCA4YCU4YC6LuGAoeGAlOGAiuGAuuGAuOGAhOGAmuGAuiIsbToi4YCQ4YCF4YC64YCZ4YCt4YCU4YCF4YC6IixtbToiJWQg4YCZ4YCt4YCU4YCF4YC6IixoOiLhgJDhgIXhgLrhgJThgKzhgJvhgK4iLGhoOiIlZCDhgJThgKzhgJvhgK4iLGQ6IuGAkOGAheGAuuGAm+GAgOGAuiIsZGQ6IiVkIOGAm+GAgOGAuiIsTToi4YCQ4YCF4YC64YCcIixNTToiJWQg4YCcIix5OiLhgJDhgIXhgLrhgJThgL7hgIXhgLoiLHl5OiIlZCDhgJThgL7hgIXhgLoifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4YGB4YGC4YGD4YGE4YGF4YGG4YGH4YGI4YGJ4YGAXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJuYiIse21vbnRoczoiamFudWFyX2ZlYnJ1YXJfbWFyc19hcHJpbF9tYWlfanVuaV9qdWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuLl9mZWIuX21hcnNfYXByaWxfbWFpX2p1bmlfanVsaV9hdWcuX3NlcC5fb2t0Ll9ub3YuX2Rlcy4iLnNwbGl0KCJfIiksd2Vla2RheXM6InPDuG5kYWdfbWFuZGFnX3RpcnNkYWdfb25zZGFnX3RvcnNkYWdfZnJlZGFnX2zDuHJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic8O4Ll9tYS5fdGkuX29uLl90by5fZnIuX2zDuC4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46InPDuF9tYV90aV9vbl90b19mcl9sw7giLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgW2tsLl0gSEg6bW0iLExMTEw6ImRkZGQgRC4gTU1NTSBZWVlZIFtrbC5dIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltpIGRhZyBrbC5dIExUIixuZXh0RGF5OiJbaSBtb3JnZW4ga2wuXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2tsLl0gTFQiLGxhc3REYXk6IltpIGfDpXIga2wuXSBMVCIsbGFzdFdlZWs6Iltmb3JyaWdlXSBkZGRkIFtrbC5dIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvbSAlcyIscGFzdDoiZm9yICVzIHNpZGVuIixzOiJub2VuIHNla3VuZGVyIixtOiJldHQgbWludXR0IixtbToiJWQgbWludXR0ZXIiLGg6ImVuIHRpbWUiLGhoOiIlZCB0aW1lciIsZDoiZW4gZGFnIixkZDoiJWQgZGFnZXIiLE06ImVuIG3DpW5lZCIsTU06IiVkIG3DpW5lZGVyIix5OiJldHQgw6VyIix5eToiJWQgw6VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi4KWnIiwyOiLgpagiLDM6IuClqSIsNDoi4KWqIiw1OiLgpasiLDY6IuClrCIsNzoi4KWtIiw4OiLgpa4iLDk6IuClryIsMDoi4KWmIn0saT17IuClpyI6IjEiLCLgpagiOiIyIiwi4KWpIjoiMyIsIuClqiI6IjQiLCLgpasiOiI1Iiwi4KWsIjoiNiIsIuClrSI6IjciLCLgpa4iOiI4Iiwi4KWvIjoiOSIsIuClpiI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJuZSIse21vbnRoczoi4KSc4KSo4KS14KSw4KWAX+Ckq+Clh+CkrOCljeCksOClgeCkteCksOClgF/gpK7gpL7gpLDgpY3gpJpf4KSF4KSq4KWN4KSw4KS/4KSyX+CkruCkiF/gpJzgpYHgpKhf4KSc4KWB4KSy4KS+4KSIX+CkheCkl+Ckt+CljeCkn1/gpLjgpYfgpKrgpY3gpJ/gpYfgpK7gpY3gpKzgpLBf4KSF4KSV4KWN4KSf4KWL4KSs4KSwX+CkqOCli+CkreClh+CkruCljeCkrOCksF/gpKHgpL/gpLjgpYfgpK7gpY3gpKzgpLAiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuCknOCkqC5f4KSr4KWH4KSs4KWN4KSw4KWBLl/gpK7gpL7gpLDgpY3gpJpf4KSF4KSq4KWN4KSw4KS/Ll/gpK7gpIhf4KSc4KWB4KSoX+CknOClgeCksuCkvuCkiC5f4KSF4KSXLl/gpLjgpYfgpKrgpY3gpJ8uX+CkheCkleCljeCkn+Cliy5f4KSo4KWL4KSt4KWHLl/gpKHgpL/gpLjgpYcuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgpIbgpIfgpKTgpKzgpL7gpLBf4KS44KWL4KSu4KSs4KS+4KSwX+CkruCkmeCljeCkl+CksuCkrOCkvuCksF/gpKzgpYHgpKfgpKzgpL7gpLBf4KSs4KS/4KS54KS/4KSs4KS+4KSwX+CktuClgeCkleCljeCksOCkrOCkvuCksF/gpLbgpKjgpL/gpKzgpL7gpLAiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4KSG4KSH4KSkLl/gpLjgpYvgpK4uX+CkruCkmeCljeCkl+Cksi5f4KSs4KWB4KSnLl/gpKzgpL/gpLngpL8uX+CktuClgeCkleCljeCksC5f4KS24KSo4KS/LiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4KSGLl/gpLjgpYsuX+CkruCkgi5f4KSs4KWBLl/gpKzgpL8uX+CktuClgS5f4KS2LiIuc3BsaXQoIl8iKSxsb25nRGF0ZQ==", "base64"));
  res.write(new Buffer("Rm9ybWF0OntMVDoiQeCkleCliyBoOm1tIOCkrOCknOClhyIsTFRTOiJB4KSV4KWLIGg6bW06c3Mg4KSs4KSc4KWHIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEHgpJXgpYsgaDptbSDgpKzgpJzgpYciLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZLCBB4KSV4KWLIGg6bW0g4KSs4KSc4KWHIn0scHJlcGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvW+Clp+ClqOClqeClquClq+ClrOClreClruClr+Clpl0vZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pfSxwb3N0Zm9ybWF0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1xkL2csZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX0sbWVyaWRpZW1QYXJzZTov4KSw4KS+4KSk4KS/fOCkrOCkv+CkueCkvuCkqHzgpKbgpL/gpIngpIHgpLjgpYt84KS44KS+4KSB4KSdLyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwi4KSw4KS+4KSk4KS/Ij09PWU/dDw0P3Q6dCsxMjoi4KSs4KS/4KS54KS+4KSoIj09PWU/dDoi4KSm4KS/4KSJ4KSB4KS44KWLIj09PWU/dD49MTA/dDp0KzEyOiLgpLjgpL7gpIHgpJ0iPT09ZT90KzEyOnZvaWQgMH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDM/IuCksOCkvuCkpOCkvyI6dDwxMj8i4KSs4KS/4KS54KS+4KSoIjp0PDE2PyLgpKbgpL/gpIngpIHgpLjgpYsiOnQ8MjA/IuCkuOCkvuCkgeCknSI6IuCksOCkvuCkpOCkvyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4KSG4KScXSBMVCIsbmV4dERheToiW+CkreCli+CksuCkv10gTFQiLG5leHRXZWVrOiJb4KSG4KSJ4KSB4KSm4KWLXSBkZGRkWyxdIExUIixsYXN0RGF5OiJb4KS54KS/4KSc4KWLXSBMVCIsbGFzdFdlZWs6IlvgpJfgpI/gpJXgpYtdIGRkZGRbLF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz4KSu4KS+IixwYXN0OiIlcyDgpIXgpJfgpL7gpKHgpL8iLHM6IuCkleClh+CkueClgCDgpJXgpY3gpLfgpKMiLG06IuCkj+CklSDgpK7gpL/gpKjgpYfgpJ8iLG1tOiIlZCDgpK7gpL/gpKjgpYfgpJ8iLGg6IuCkj+CklSDgpJjgpKPgpY3gpJ/gpL4iLGhoOiIlZCDgpJjgpKPgpY3gpJ/gpL4iLGQ6IuCkj+CklSDgpKbgpL/gpKgiLGRkOiIlZCDgpKbgpL/gpKgiLE06IuCkj+CklSDgpK7gpLngpL/gpKjgpL4iLE1NOiIlZCDgpK7gpLngpL/gpKjgpL4iLHk6IuCkj+CklSDgpKzgpLDgpY3gpLciLHl5OiIlZCDgpKzgpLDgpY3gpLcifSx3ZWVrOntkb3c6MCxkb3k6Nn19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPSJqYW4uX2ZlYi5fbXJ0Ll9hcHIuX21laV9qdW4uX2p1bC5fYXVnLl9zZXAuX29rdC5fbm92Ll9kZWMuIi5zcGxpdCgiXyIpLGk9Imphbl9mZWJfbXJ0X2Fwcl9tZWlfanVuX2p1bF9hdWdfc2VwX29rdF9ub3ZfZGVjIi5zcGxpdCgiXyIpLG49dC5kZWZpbmVMb2NhbGUoIm5sIix7bW9udGhzOiJqYW51YXJpX2ZlYnJ1YXJpX21hYXJ0X2FwcmlsX21laV9qdW5pX2p1bGlfYXVndXN0dXNfc2VwdGVtYmVyX29rdG9iZXJfbm92ZW1iZXJfZGVjZW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ZnVuY3Rpb24odCxuKXtyZXR1cm4vLU1NTS0vLnRlc3Qobik/aVt0Lm1vbnRoKCldOmVbdC5tb250aCgpXX0sd2Vla2RheXM6InpvbmRhZ19tYWFuZGFnX2RpbnNkYWdfd29lbnNkYWdfZG9uZGVyZGFnX3ZyaWpkYWdfemF0ZXJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiem8uX21hLl9kaS5fd28uX2RvLl92ci5femEuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJab19NYV9EaV9Xb19Eb19Wcl9aYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC1NTS1ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW3ZhbmRhYWcgb21dIExUIixuZXh0RGF5OiJbbW9yZ2VuIG9tXSBMVCIsbmV4dFdlZWs6ImRkZGQgW29tXSBMVCIsbGFzdERheToiW2dpc3RlcmVuIG9tXSBMVCIsbGFzdFdlZWs6IlthZmdlbG9wZW5dIGRkZGQgW29tXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToib3ZlciAlcyIscGFzdDoiJXMgZ2VsZWRlbiIsczoiZWVuIHBhYXIgc2Vjb25kZW4iLG06IsOpw6luIG1pbnV1dCIsbW06IiVkIG1pbnV0ZW4iLGg6IsOpw6luIHV1ciIsaGg6IiVkIHV1ciIsZDoiw6nDqW4gZGFnIixkZDoiJWQgZGFnZW4iLE06IsOpw6luIG1hYW5kIixNTToiJWQgbWFhbmRlbiIseToiw6nDqW4gamFhciIseXk6IiVkIGphYXIifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oc3RlfGRlKS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdCsoMT09PXR8fDg9PT10fHx0Pj0yMD8ic3RlIjoiZGUiKX0sd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgibm4iLHttb250aHM6ImphbnVhcl9mZWJydWFyX21hcnNfYXByaWxfbWFpX2p1bmlfanVsaV9hdWd1c3Rfc2VwdGVtYmVyX29rdG9iZXJfbm92ZW1iZXJfZGVzZW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imphbl9mZWJfbWFyX2Fwcl9tYWlfanVuX2p1bF9hdWdfc2VwX29rdF9ub3ZfZGVzIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJzdW5kYWdfbcOlbmRhZ190eXNkYWdfb25zZGFnX3RvcnNkYWdfZnJlZGFnX2xhdXJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic3VuX23DpW5fdHlzX29uc190b3JfZnJlX2xhdSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoic3VfbcOlX3R5X29uX3RvX2ZyX2zDuCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBba2wuXSBIOm1tIixMTExMOiJkZGRkIEQuIE1NTU0gWVlZWSBba2wuXSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSSBkYWcga2xva2thXSBMVCIsbmV4dERheToiW0kgbW9yZ29uIGtsb2trYV0gTFQiLG5leHRXZWVrOiJkZGRkIFtrbG9ra2FdIExUIixsYXN0RGF5OiJbSSBnw6VyIGtsb2trYV0gTFQiLGxhc3RXZWVrOiJbRsO4cmVnw6VhbmRlXSBkZGRkIFtrbG9ra2FdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvbSAlcyIscGFzdDoiZm9yICVzIHNpZGFuIixzOiJub2tyZSBzZWt1bmQiLG06ImVpdCBtaW51dHQiLG1tOiIlZCBtaW51dHQiLGg6ImVpbiB0aW1lIixoaDoiJWQgdGltYXIiLGQ6ImVpbiBkYWciLGRkOiIlZCBkYWdhciIsTToiZWluIG3DpW5hZCIsTU06IiVkIG3DpW5hZGVyIix5OiJlaXQgw6VyIix5eToiJWQgw6VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi4KmnIiwyOiLgqagiLDM6IuCpqSIsNDoi4KmqIiw1OiLgqasiLDY6IuCprCIsNzoi4KmtIiw4OiLgqa4iLDk6IuCpryIsMDoi4KmmIn0saT17IuCppyI6IjEiLCLgqagiOiIyIiwi4KmpIjoiMyIsIuCpqiI6IjQiLCLgqasiOiI1Iiwi4KmsIjoiNiIsIuCprSI6IjciLCLgqa4iOiI4Iiwi4KmvIjoiOSIsIuCppiI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJwYS1pbiIse21vbnRoczoi4Kic4Kio4Ki14Kiw4KmAX+Coq+CovOCosOCoteCosOCpgF/gqK7gqL7gqLDgqJpf4KiF4Kiq4KmN4Kiw4KmI4KiyX+CoruCoiF/gqJzgqYLgqKhf4Kic4KmB4Kiy4Ki+4KiIX+CoheCol+CouOCopF/gqLjgqKTgqbDgqKzgqLBf4KiF4KiV4Kik4KmC4Kis4KiwX+CoqOCoteCpsOCorOCosF/gqKbgqLjgqbDgqKzgqLAiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuConOCoqOCoteCosOCpgF/gqKvgqLzgqLDgqLXgqLDgqYBf4Kiu4Ki+4Kiw4KiaX+CoheCoquCpjeCosOCpiOCosl/gqK7gqIhf4Kic4KmC4KioX+ConOCpgeCosuCovuCoiF/gqIXgqJfgqLjgqKRf4Ki44Kik4Kmw4Kis4KiwX+CoheColeCopOCpguCorOCosF/gqKjgqLXgqbDgqKzgqLBf4Kim4Ki44Kmw4Kis4KiwIi5zcGxpdCgiXyIpLAoJd2Vla2RheXM6IuCokOCopOCoteCovuCosF/gqLjgqYvgqK7gqLXgqL7gqLBf4Kiu4Kmw4KiX4Kiy4Ki14Ki+4KiwX+CorOCpgeCop+CoteCovuCosF/gqLXgqYDgqLDgqLXgqL7gqLBf4Ki44Ki84KmB4Kmx4KiV4Kiw4Ki14Ki+4KiwX+CouOCovOCoqOCpgOComuCosOCoteCovuCosCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLgqJDgqKRf4Ki44KmL4KiuX+CoruCpsOCol+Cosl/gqKzgqYHgqKdf4Ki14KmA4KiwX+CouOCovOCpgeColeCosF/gqLjgqLzgqKjgqYAiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuCokOCopF/gqLjgqYvgqK5f4Kiu4Kmw4KiX4KiyX+CorOCpgeCop1/gqLXgqYDgqLBf4Ki44Ki84KmB4KiV4KiwX+CouOCovOCoqOCpgCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkEgaDptbSDgqLXgqJzgqYciLExUUzoiQSBoOm1tOnNzIOCoteConOCphyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZLCBBIGg6bW0g4Ki14Kic4KmHIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSwgQSBoOm1tIOCoteConOCphyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4KiF4KicXSBMVCIsbmV4dERheToiW+ColeCosl0gTFQiLG5leHRXZWVrOiJkZGRkLCBMVCIsbGFzdERheToiW+ColeCosl0gTFQiLGxhc3RXZWVrOiJb4Kiq4Ki/4Kib4Kiy4KmHXSBkZGRkLCBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMg4Ki14Ki/4Kmx4KiaIixwYXN0OiIlcyDgqKrgqL/gqJvgqLLgqYciLHM6IuColeCpgeConSDgqLjgqJXgqL/gqbDgqJ8iLG06IuCoh+ColSDgqK7gqL/gqbDgqJ8iLG1tOiIlZCDgqK7gqL/gqbDgqJ8iLGg6IuCoh+CpseColSDgqJjgqbDgqJ/gqL4iLGhoOiIlZCDgqJjgqbDgqJ/gqYciLGQ6IuCoh+CpseColSDgqKbgqL/gqKgiLGRkOiIlZCDgqKbgqL/gqKgiLE06IuCoh+CpseColSDgqK7gqLngqYDgqKjgqL4iLE1NOiIlZCDgqK7gqLngqYDgqKjgqYciLHk6IuCoh+CpseColSDgqLjgqL7gqLIiLHl5OiIlZCDgqLjgqL7gqLIifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4Kmn4Kmo4Kmp4Kmq4Kmr4Kms4Kmt4Kmu4Kmv4KmmXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gqLDgqL7gqKR84Ki44Ki14KmH4KiwfOCopuCpgeCoquCoueCov+CosHzgqLjgqLzgqL7gqK4vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgqLDgqL7gqKQiPT09ZT90PDQ/dDp0KzEyOiLgqLjgqLXgqYfgqLAiPT09ZT90OiLgqKbgqYHgqKrgqLngqL/gqLAiPT09ZT90Pj0xMD90OnQrMTI6IuCouOCovOCovuCoriI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4Kiw4Ki+4KikIjp0PDEwPyLgqLjgqLXgqYfgqLAiOnQ8MTc/IuCopuCpgeCoquCoueCov+CosCI6dDwyMD8i4Ki44Ki84Ki+4KiuIjoi4Kiw4Ki+4KikIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQpe3JldHVybiB0JTEwPDUmJnQlMTA+MSYmfn4odC8xMCklMTAhPT0xfWZ1bmN0aW9uIGkodCxpLG4pe3ZhciByPXQrIiAiO3N3aXRjaChuKXtjYXNlIm0iOnJldHVybiBpPyJtaW51dGEiOiJtaW51dMSZIjtjYXNlIm1tIjpyZXR1cm4gcisoZSh0KT8ibWludXR5IjoibWludXQiKTtjYXNlImgiOnJldHVybiBpPyJnb2R6aW5hIjoiZ29kemluxJkiO2Nhc2UiaGgiOnJldHVybiByKyhlKHQpPyJnb2R6aW55IjoiZ29kemluIik7Y2FzZSJNTSI6cmV0dXJuIHIrKGUodCk/Im1pZXNpxIVjZSI6Im1pZXNpxJljeSIpO2Nhc2UieXkiOnJldHVybiByKyhlKHQpPyJsYXRhIjoibGF0Iil9fXZhciBuPSJzdHljemXFhF9sdXR5X21hcnplY19rd2llY2llxYRfbWFqX2N6ZXJ3aWVjX2xpcGllY19zaWVycGllxYRfd3J6ZXNpZcWEX3Bhxbpkemllcm5pa19saXN0b3BhZF9ncnVkemllxYQiLnNwbGl0KCJfIikscj0ic3R5Y3puaWFfbHV0ZWdvX21hcmNhX2t3aWV0bmlhX21hamFfY3plcndjYV9saXBjYV9zaWVycG5pYV93cnplxZtuaWFfcGHFumR6aWVybmlrYV9saXN0b3BhZGFfZ3J1ZG5pYSIuc3BsaXQoIl8iKSxzPXQuZGVmaW5lTG9jYWxlKCJwbCIse21vbnRoczpmdW5jdGlvbih0LGUpe3JldHVybiIiPT09ZT8iKCIrclt0Lm1vbnRoKCldKyJ8IituW3QubW9udGgoKV0rIikiOi9EIE1NTU0vLnRlc3QoZSk/clt0Lm1vbnRoKCldOm5bdC5tb250aCgpXX0sbW9udGhzU2hvcnQ6InN0eV9sdXRfbWFyX2t3aV9tYWpfY3plX2xpcF9zaWVfd3J6X3BhxbpfbGlzX2dydSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoibmllZHppZWxhX3BvbmllZHppYcWCZWtfd3RvcmVrX8Wbcm9kYV9jendhcnRla19wacSFdGVrX3NvYm90YSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJuaWVfcG9uX3d0X8Wbcl9jendfcHRfc2IiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Ik5kX1BuX1d0X8Wacl9Del9QdF9TbyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltEemnFmyBvXSBMVCIsbmV4dERheToiW0p1dHJvIG9dIExUIixuZXh0V2VlazoiW1ddIGRkZGQgW29dIExUIixsYXN0RGF5OiJbV2N6b3JhaiBvXSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbVyB6ZXN6xYLEhSBuaWVkemllbMSZIG9dIExUIjtjYXNlIDM6cmV0dXJuIltXIHplc3rFgsSFIMWbcm9kxJkgb10gTFQiO2Nhc2UgNjpyZXR1cm4iW1cgemVzesWCxIUgc29ib3TEmSBvXSBMVCI7ZGVmYXVsdDpyZXR1cm4iW1cgemVzesWCeV0gZGRkZCBbb10gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiemEgJXMiLHBhc3Q6IiVzIHRlbXUiLHM6ImtpbGthIHNla3VuZCIsbTppLG1tOmksaDppLGhoOmksZDoiMSBkemllxYQiLGRkOiIlZCBkbmkiLE06Im1pZXNpxIVjIixNTTppLHk6InJvayIseXk6aX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIHN9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgicHQiLHttb250aHM6IkphbmVpcm9fRmV2ZXJlaXJvX01hcsOnb19BYnJpbF9NYWlvX0p1bmhvX0p1bGhvX0Fnb3N0b19TZXRlbWJyb19PdXR1YnJvX05vdmVtYnJvX0RlemVtYnJvIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmV2X01hcl9BYnJfTWFpX0p1bl9KdWxfQWdvX1NldF9PdXRfTm92X0RleiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiRG9taW5nb19TZWd1bmRhLUZlaXJhX1RlcsOnYS1GZWlyYV9RdWFydGEtRmVpcmFfUXVpbnRhLUZlaXJhX1NleHRhLUZlaXJhX1PDoWJhZG8iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiRG9tX1NlZ19UZXJfUXVhX1F1aV9TZXhfU8OhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRG9tXzLCql8zwqpfNMKqXzXCql82wqpfU8OhYiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBbZGVdIE1NTU0gW2RlXSBZWVlZIixMTEw6IkQgW2RlXSBNTU1NIFtkZV0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBbZGVdIE1NTU0gW2RlXSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltIb2plIMOgc10gTFQiLG5leHREYXk6IltBbWFuaMOjIMOgc10gTFQiLG5leHRXZWVrOiJkZGRkIFvDoHNdIExUIixsYXN0RGF5OiJbT250ZW0gw6BzXSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuZGF5KCl8fDY9PT10aGlzLmRheSgpPyJbw5psdGltb10gZGRkZCBbw6BzXSBMVCI6IlvDmmx0aW1hXSBkZGRkIFvDoHNdIExUIn0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZW0gJXMiLHBhc3Q6ImjDoSAlcyIsczoic2VndW5kb3MiLG06InVtIG1pbnV0byIsbW06IiVkIG1pbnV0b3MiLGg6InVtYSBob3JhIixoaDoiJWQgaG9yYXMiLGQ6InVtIGRpYSIsZGQ6IiVkIGRpYXMiLE06InVtIG3DqnMiLE1NOiIlZCBtZXNlcyIseToidW0gYW5vIix5eToiJWQgYW5vcyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfcK6LyxvcmRpbmFsOiIlZMK6Iix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJwdC1iciIse21vbnRoczoiSmFuZWlyb19GZXZlcmVpcm9fTWFyw6dvX0FicmlsX01haW9fSnVuaG9fSnVsaG9fQWdvc3RvX1NldGVtYnJvX091dHVicm9fTm92ZW1icm9fRGV6ZW1icm8iLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbl9GZXZfTWFyX0Ficl9NYWlfSnVuX0p1bF9BZ29fU2V0X091dF9Ob3ZfRGV6Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiJEb21pbmdvX1NlZ3VuZGEtZmVpcmFfVGVyw6dhLWZlaXJhX1F1YXJ0YS1mZWlyYV9RdWludGEtZmVpcmFfU2V4dGEtZmVpcmFfU8OhYmFkbyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJEb21fU2VnX1Rlcl9RdWFfUXVpX1NleF9Tw6FiIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJEb21fMsKqXzPCql80wqpfNcKqXzbCql9Tw6FiIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIFtkZV0gTU1NTSBbZGVdIFlZWVkiLExMTDoiRCBbZGVdIE1NTU0gW2RlXSBZWVlZIFvDoHNdIEhIOm1tIixMTExMOiJkZGRkLCBEIFtkZV0gTU1NTSBbZGVdIFlZWVkgW8Ogc10gSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0hvamUgw6BzXSBMVCIsbmV4dERheToiW0FtYW5ow6Mgw6BzXSBMVCIsbmV4dFdlZWs6ImRkZGQgW8Ogc10gTFQiLGxhc3REYXk6IltPbnRlbSDDoHNdIExUIixsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5kYXkoKXx8Nj09PXRoaXMuZGF5KCk/IlvDmmx0aW1vXSBkZGRkIFvDoHNdIExUIjoiW8OabHRpbWFdIGRkZGQgW8Ogc10gTFQifSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJlbSAlcyIscGFzdDoiJXMgYXRyw6FzIixzOiJwb3Vjb3Mgc2VndW5kb3MiLG06InVtIG1pbnV0byIsbW06IiVkIG1pbnV0b3MiLGg6InVtYSBob3JhIixoaDoiJWQgaG9yYXMiLGQ6InVtIGRpYSIsZGQ6IiVkIGRpYXMiLE06InVtIG3DqnMiLE1NOiIlZCBtZXNlcyIseToidW0gYW5vIix5eToiJWQgYW5vcyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfcK6LyxvcmRpbmFsOiIlZMK6In0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSl7dmFyIG49e21tOiJtaW51dGUiLGhoOiJvcmUiLGRkOiJ6aWxlIixNTToibHVuaSIseXk6ImFuaSJ9LHI9IiAiO3JldHVybih0JTEwMD49MjB8fHQ+PTEwMCYmdCUxMDA9PT0wKSYmKHI9IiBkZSAiKSx0K3IrbltpXX12YXIgaT10LmRlZmluZUxvY2FsZSgicm8iLHttb250aHM6ImlhbnVhcmllX2ZlYnJ1YXJpZV9tYXJ0aWVfYXByaWxpZV9tYWlfaXVuaWVfaXVsaWVfYXVndXN0X3NlcHRlbWJyaWVfb2N0b21icmllX25vaWVtYnJpZV9kZWNlbWJyaWUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imlhbi5fZmVici5fbWFydC5fYXByLl9tYWlfaXVuLl9pdWwuX2F1Zy5fc2VwdC5fb2N0Ll9ub3YuX2RlYy4iLnNwbGl0KCJfIiksd2Vla2RheXM6ImR1bWluaWPEg19sdW5pX21hcsibaV9taWVyY3VyaV9qb2lfdmluZXJpX3PDom1ixIN0xIMiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiRHVtX0x1bl9NYXJfTWllX0pvaV9WaW5fU8OibSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRHVfTHVfTWFfTWlfSm9fVmlfU8OiIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbYXppIGxhXSBMVCIsbmV4dERheToiW23DomluZSBsYV0gTFQiLG5leHRXZWVrOiJkZGRkIFtsYV0gTFQiLGxhc3REYXk6IltpZXJpIGxhXSBMVCIsbGFzdFdlZWs6Iltmb3N0YV0gZGRkZCBbbGFdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJwZXN0ZSAlcyIscGFzdDoiJXMgw65uIHVybcSDIixzOiJjw6J0ZXZhIHNlY3VuZGUiLG06InVuIG1pbnV0IixtbTplLGg6Im8gb3LEgyIsaGg6ZSxkOiJvIHppIixkZDplLE06Im8gbHVuxIMiLE1NOmUseToidW4gYW4iLHl5OmV9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUpe3ZhciBpPXQuc3BsaXQoIl8iKTtyZXR1cm4gZSUxMD09PTEmJmUlMTAwIT09MTE/aVswXTplJTEwPj0yJiZlJTEwPD00JiYoZSUxMDA8MTB8fGUlMTAwPj0yMCk/aVsxXTppWzJdfWZ1bmN0aW9uIGkodCxpLG4pe3ZhciByPXttbTppPyLQvNC40L3Rg9GC0LBf0LzQuNC90YPRgtGLX9C80LjQvdGD0YIiOiLQvNC40L3Rg9GC0YNf0LzQuNC90YPRgtGLX9C80LjQvdGD0YIiLGhoOiLRh9Cw0YFf0YfQsNGB0LBf0YfQsNGB0L7QsiIsZGQ6ItC00LXQvdGMX9C00L3Rj1/QtNC90LXQuSIsTU06ItC80LXRgdGP0YZf0LzQtdGB0Y/RhtCwX9C80LXRgdGP0YbQtdCyIix5eToi0LPQvtC0X9Cz0L7QtNCwX9C70LXRgiJ9O3JldHVybiJtIj09PW4/aT8i0LzQuNC90YPRgtCwIjoi0LzQuNC90YPRgtGDIjp0KyIgIitlKHJbbl0sK3QpfXZhciBuPVsvXtGP0L3Qsi9pLC9e0YTQtdCyL2ksL17QvNCw0YAvaSwvXtCw0L/RgC9pLC9e0LzQsFvQuXzRj10vaSwvXtC40Y7QvS9pLC9e0LjRjtC7L2ksL17QsNCy0LMvaSwvXtGB0LXQvS9pLC9e0L7QutGCL2ksL17QvdC+0Y8vaSwvXtC00LXQui9pXSxyPXQuZGVmaW5lTG9jYWxlKCJydSIse21vbnRoczp7Zm9ybWF0OiLRj9C90LLQsNGA0Y9f0YTQtdCy0YDQsNC70Y9f0LzQsNGA0YLQsF/QsNC/0YDQtdC70Y9f0LzQsNGPX9C40Y7QvdGPX9C40Y7Qu9GPX9Cw0LLQs9GD0YHRgtCwX9GB0LXQvdGC0Y/QsdGA0Y9f0L7QutGC0Y/QsdGA0Y9f0L3QvtGP0LHRgNGPX9C00LXQutCw0LHRgNGPIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6ItGP0L3QstCw0YDRjF/RhNC10LLRgNCw0LvRjF/QvNCw0YDRgl/QsNC/0YDQtdC70Yxf0LzQsNC5X9C40Y7QvdGMX9C40Y7Qu9GMX9Cw0LLQs9GD0YHRgl/RgdC10L3RgtGP0LHRgNGMX9C+0LrRgtGP0LHRgNGMX9C90L7Rj9Cx0YDRjF/QtNC10LrQsNCx0YDRjCIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6e2Zvcm1hdDoi0Y/QvdCyX9GE0LXQsl/QvNCw0YBf0LDQv9GAX9C80LDRj1/QuNGO0L3Rj1/QuNGO0LvRj1/QsNCy0LNf0YHQtdC9X9C+0LrRgl/QvdC+0Y9f0LTQtdC6Ii5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6ItGP0L3Qsl/RhNC10LJf0LzQsNGA0YJf0LDQv9GAX9C80LDQuV/QuNGO0L3RjF/QuNGO0LvRjF/QsNCy0LNf0YHQtdC9X9C+0LrRgl/QvdC+0Y9f0LTQtdC6Ii5zcGxpdCgiXyIpfSx3ZWVrZGF5czp7c3RhbmRhbG9uZToi0LLQvtGB0LrRgNC10YHQtdC90YzQtV/Qv9C+0L3QtdC00LXQu9GM0L3QuNC6X9Cy0YLQvtGA0L3QuNC6X9GB0YDQtdC00LBf0YfQtdGC0LLQtdGA0LNf0L/Rj9GC0L3QuNGG0LBf0YHRg9Cx0LHQvtGC0LAiLnNwbGl0KCJfIiksZm9ybWF0OiLQstC+0YHQutGA0LXRgdC10L3RjNC1X9C/0L7QvdC10LTQtdC70YzQvdC40Lpf0LLRgtC+0YDQvdC40Lpf0YHRgNC10LTRg1/Rh9C10YLQstC10YDQs1/Qv9GP0YLQvdC40YbRg1/RgdGD0LHQsdC+0YLRgyIuc3BsaXQoIl8iKSxpc0Zvcm1hdDovXFsgP1vQktCyXSA/KD860L/RgNC+0YjQu9GD0Y580YHQu9C10LTRg9GO0YnRg9GOfNGN0YLRgyk/ID9cXSA/ZGRkZC99LHdlZWtkYXlzU2hvcnQ6ItCy0YFf0L/QvV/QstGCX9GB0YBf0YfRgl/Qv9GCX9GB0LEiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItCy0YFf0L/QvV/QstGCX9GB0YBf0YfRgl/Qv9GCX9GB0LEiLnNwbGl0KCJfIiksbW9udGhzUGFyc2U6bixsb25nTW9udGhzUGFyc2U6bixzaG9ydE1vbnRoc1BhcnNlOm4sbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQgTU1NTSBZWVlZINCzLiIsTExMOiJEIE1NTU0gWVlZWSDQsy4sIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSDQsy4sIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvQodC10LPQvtC00L3RjyDQsl0gTFQiLG5leHREYXk6IlvQl9Cw0LLRgtGA0LAg0LJdIExUIixsYXN0RGF5OiJb0JLRh9C10YDQsCDQsl0gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKHQpe2lmKHQud2VlaygpPT09dGhpcy53ZWVrKCkpcmV0dXJuIDI9PT10aGlzLmRheSgpPyJb0JLQvl0gZGRkZCBb0LJdIExUIjoiW9CSXSBkZGRkIFvQsl0gTFQiO3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlvQkiDRgdC70LXQtNGD0Y7RidC10LVdIGRkZGQgW9CyXSBMVCI7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6cmV0dXJuIlvQkiDRgdC70LXQtNGD0Y7RidC40LldIGRkZGQgW9CyXSBMVCI7Y2FzZSAzOmNhc2UgNTpjYXNlIDY6cmV0dXJuIlvQkiDRgdC70LXQtNGD0Y7RidGD0Y5dIGRkZGQgW9CyXSBMVCJ9fSxsYXN0V2VlazpmdW5jdGlvbih0KXtpZih0LndlZWsoKT09PXRoaXMud2VlaygpKXJldHVybiAyPT09dGhpcy5kYXkoKT8iW9CS0L5dIGRkZGQgW9CyXSBMVCI6IlvQkl0gZGRkZCBb0LJdIExUIjtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJb0JIg0L/RgNC+0YjQu9C+0LVdIGRkZGQgW9CyXSBMVCI7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6cmV0dXJuIlvQkiDQv9GA0L7RiNC70YvQuV0gZGRkZCBb0LJdIExUIjtjYXNlIDM6Y2FzZSA1OmNhc2UgNjpyZXR1cm4iW9CSINC/0YDQvtGI0LvRg9GOXSBkZGRkIFvQsl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0YfQtdGA0LXQtyAlcyIscGFzdDoiJXMg0L3QsNC30LDQtCIsczoi0L3QtdGB0LrQvtC70YzQutC+INGB0LXQutGD0L3QtCIsbTppLG1tOmksaDoi0YfQsNGBIixoaDppLGQ6ItC00LXQvdGMIixkZDppLE06ItC80LXRgdGP0YYiLE1NOmkseToi0LPQvtC0Iix5eTppfSxtZXJpZGllbVBhcnNlOi/QvdC+0YfQuHzRg9GC0YDQsHzQtNC90Y980LLQtdGH0LXRgNCwL2ksaXNQTTpmdW5jdGlvbih0KXtyZXR1cm4vXijQtNC90Y980LLQtdGH0LXRgNCwKSQvLnRlc3QodCl9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDw0PyLQvdC+0YfQuCI6dDwxMj8i0YPRgtGA0LAiOnQ8MTc/ItC00L3RjyI6ItCy0LXRh9C10YDQsCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfS0o0Ll80LPQvnzRjykvLG9yZGluYWw6ZnVuY3Rpb24odCxlKXtzd2l0Y2goZSl7Y2FzZSJNIjpjYXNlImQiOmNhc2UiREREIjpyZXR1cm4gdCsiLdC5IjtjYXNlIkQiOnJldHVybiB0KyIt0LPQviI7Y2FzZSJ3IjpjYXNlIlciOnJldHVybiB0KyIt0Y8iO2RlZmF1bHQ6cmV0dXJuIHR9fSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gcn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJzZSIse21vbnRoczoib8SRxJFhamFnZW3DoW5udV9ndW92dmFtw6FubnVfbmp1a8SNYW3DoW5udV9jdW/Fi29tw6FubnVfbWllc3NlbcOhbm51X2dlYXNzZW3DoW5udV9zdW9pZG5lbcOhbm51X2JvcmdlbcOhbm51X8SNYWvEjWFtw6FubnVfZ29sZ2dvdG3DoW5udV9za8OhYm1hbcOhbm51X2p1b3ZsYW3DoW5udSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoib8SRxJFqX2d1b3Zfbmp1a19jdW9fbWllc19nZWFzX3N1b2lfYm9yZ1/EjWFrxI1fZ29sZ19za8OhYl9qdW92Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiJzb3RuYWJlYWl2aV92dW9zc8OhcmdhX21hxYvFi2Viw6FyZ2FfZ2Fza2F2YWhra3VfZHVvcmFzdGF0X2JlYXJqYWRhdF9sw6F2dmFyZGF0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6InNvdG5fdnVvc19tYcWLX2dhc2tfZHVvcl9iZWFyX2zDoXYiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46InNfdl9tX2dfZF9iX0wiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6Ik1NTU0gRC4gW2IuXSBZWVlZIixMTEw6Ik1NTU0gRC4gW2IuXSBZWVlZIFt0aS5dIEhIOm1tIixMTExMOiJkZGRkLCBNTU1NIEQuIFtiLl0gWVlZWSBbdGkuXSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbb3RuZSB0aV0gTFQiLG5leHREYXk6IltpaHR0aW4gdGldIExUIixuZXh0V2VlazoiZGRkZCBbdGldIExUIixsYXN0RGF5OiJbaWt0ZSB0aV0gTFQiLGxhc3RXZWVrOiJbb3ZkZGl0XSBkZGRkIFt0aV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzIGdlYcW+ZXMiLHBhc3Q6Im1hxYtpdCAlcyIsczoibW9hZGRlIHNla3VuZGRhdCIsbToib2t0YSBtaW51aHRhIixtbToiJWQgbWludWh0YXQiLGg6Im9rdGEgZGlpbW11IixoaDoiJWQgZGlpbW11dCIsZDoib2t0YSBiZWFpdmkiLGRkOiIlZCBiZWFpdnZpdCIsTToib2t0YSBtw6FubnUiLE1NOiIlZCBtw6FudXQiLHk6Im9rdGEgamFoa2kiLHl5OiIlZCBqYWdpdCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInNpIix7bW9udGhzOiLgtqLgtrHgt4Dgt4/gtrvgt5Jf4La04LeZ4La24La74LeA4LeP4La74LeSX+C2uOC3j+C2u+C3iuC2reC3lF/gtoXgtrTgt4rigI3gtrvgt5rgtr3gt4pf4La44LeQ4La64LeSX+C2ouC3luC2seC3kl/gtqLgt5bgtr3gt5Jf4LaF4Lac4Led4LeD4LeK4Lat4LeUX+C3g+C3kOC2tOC3iuC2reC3kOC2uOC3iuC2tuC2u+C3il/gtpTgtprgt4rgtq3gt53gtrbgtrvgt4pf4Lax4Lec4LeA4LeQ4La44LeK4La24La74LeKX+C2r+C3meC3g+C3kOC2uOC3iuC2tuC2u+C3iiIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4Lai4LaxX+C2tOC3meC2tl/gtrjgt4/gtrvgt4pf4LaF4La04LeKX+C2uOC3kOC2uuC3kl/gtqLgt5bgtrHgt5Jf4Lai4LeW4La94LeSX+C2heC2nOC3nV/gt4Pgt5DgtrTgt4pf4LaU4Laa4LeKX+C2seC3nOC3gOC3kF/gtq/gt5ngt4Pgt5AiLnNwbGl0KCJfIiksd2Vla2RheXM6IuC2ieC2u+C3kuC2r+C3j1/gt4PgtrPgt5Tgtq/gt49f4LaF4Laf4LeE4La74LeU4LeA4LeP4Lav4LePX+C2tuC2r+C3j+C2r+C3j1/gtrbgt4rigI3gtrvgt4Tgt4Pgt4rgtrTgtq3gt5LgtrHgt4rgtq/gt49f4LeD4LeS4Laa4LeU4La74LeP4Lav4LePX+C3g+C3meC2seC3g+C3lOC2u+C3j+C2r+C3jyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLgtongtrvgt5Jf4LeD4Laz4LeUX+C2heC2n1/gtrbgtq/gt49f4La24LeK4oCN4La74LeEX+C3g+C3kuC2muC3lF/gt4Pgt5ngtrEiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuC2iV/gt4Nf4LaFX+C2tl/gtrbgt4rigI3gtrtf4LeD4LeSX+C3g+C3mSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6ImEgaDptbSIsTFRTOiJhIGg6bW06c3MiLEw6IllZWVkvTU0vREQiLExMOiJZWVlZIE1NTU0gRCIsTExMOiJZWVlZIE1NTU0gRCwgYSBoOm1tIixMTExMOiJZWVlZIE1NTU0gRCBb4LeA4LeQ4Lax4LeSXSBkZGRkLCBhIGg6bW06c3MifSxjYWxlbmRhcjp7c2FtZURheToiW+C2heC2r10gTFRb4LanXSIsbmV4dERheToiW+C3hOC3meC2p10gTFRb4LanXSIsbmV4dFdlZWs6ImRkZGQgTFRb4LanXSIsbGFzdERheToiW+C2iuC2uuC3ml0gTFRb4LanXSIsbGFzdFdlZWs6IlvgtrTgt4Pgt5Tgtpzgt5LgtrpdIGRkZGQgTFRb4LanXSIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXPgtprgt5LgtrHgt4oiLHBhc3Q6IiVz4Laa4LanIOC2tOC3meC2uyIsczoi4Lat4Lat4LeK4La04La7IOC2muC3kuC3hOC3kuC2tOC2uiIsbToi4La44LeS4Lax4LeS4Lat4LeK4Lat4LeU4LeAIixtbToi4La44LeS4Lax4LeS4Lat4LeK4Lat4LeUICVkIixoOiLgtrTgt5DgtroiLGhoOiLgtrTgt5DgtrogJWQiLGQ6IuC2r+C3kuC2seC2uiIsZGQ6IuC2r+C3kuC2sSAlZCIsTToi4La44LeP4LeD4La6IixNTToi4La44LeP4LeDICVkIix5OiLgt4Dgt4PgtrsiLHl5OiLgt4Dgt4PgtrsgJWQifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0g4LeA4LeQ4Lax4LeSLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0KyIg4LeA4LeQ4Lax4LeSIn0sbWVyaWRpZW1QYXJzZTov4La04LeZ4La7IOC3gOC2u+C3lHzgtrTgt4Pgt4og4LeA4La74LeUfOC2tOC3mS7gt4B84La0LuC3gC4vLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuIuC2tC7gt4AuIj09PXR8fCLgtrTgt4Pgt4og4LeA4La74LeUIj09PXR9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdD4xMT9pPyLgtrQu4LeALiI6IuC2tOC3g+C3iiDgt4Dgtrvgt5QiOmk/IuC2tOC3mS7gt4AuIjoi4La04LeZ4La7IOC3gOC2u+C3lCJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQpe3JldHVybiB0PjEmJnQ8NX1mdW5jdGlvbiBpKHQsaSxuLHIpe3ZhciBzPXQrIiAiO3N3aXRjaChuKXtjYXNlInMiOnJldHVybiBpfHxyPyJww6FyIHNla8O6bmQiOiJww6FyIHNla3VuZGFtaSI7Y2FzZSJtIjpyZXR1cm4gaT8ibWluw7p0YSI6cj8ibWluw7p0dSI6Im1pbsO6dG91IjtjYXNlIm1tIjpyZXR1cm4gaXx8cj9zKyhlKHQpPyJtaW7DunR5IjoibWluw7p0Iik6cysibWluw7p0YW1pIjtjYXNlImgiOnJldHVybiBpPyJob2RpbmEiOnI/ImhvZGludSI6ImhvZGlub3UiO2Nhc2UiaGgiOnJldHVybiBpfHxyP3MrKGUodCk/ImhvZGlueSI6ImhvZMOtbiIpOnMrImhvZGluYW1pIjtjYXNlImQiOnJldHVybiBpfHxyPyJkZcWIIjoiZMWIb20iO2Nhc2UiZGQiOnJldHVybiBpfHxyP3MrKGUodCk/ImRuaSI6ImRuw60iKTpzKyJkxYhhbWkiO2Nhc2UiTSI6cmV0dXJuIGl8fHI/Im1lc2lhYyI6Im1lc2lhY29tIjtjYXNlIk1NIjpyZXR1cm4gaXx8cj9zKyhlKHQpPyJtZXNpYWNlIjoibWVzaWFjb3YiKTpzKyJtZXNpYWNtaSI7Y2FzZSJ5IjpyZXR1cm4gaXx8cj8icm9rIjoicm9rb20iO2Nhc2UieXkiOnJldHVybiBpfHxyP3MrKGUodCk/InJva3kiOiJyb2tvdiIpOnMrInJva21pIn19dmFyIG49ImphbnXDoXJfZmVicnXDoXJfbWFyZWNfYXByw61sX23DoWpfasO6bl9qw7psX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0w7NiZXJfbm92ZW1iZXJfZGVjZW1iZXIiLnNwbGl0KCJfIikscj0iamFuX2ZlYl9tYXJfYXByX23DoWpfasO6bl9qw7psX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIikscz10LmRlZmluZUxvY2FsZSgic2siLHttb250aHM6bixtb250aHNTaG9ydDpyLHdlZWtkYXlzOiJuZWRlxL5hX3BvbmRlbG9rX3V0b3Jva19zdHJlZGFfxaF0dnJ0b2tfcGlhdG9rX3NvYm90YSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJuZV9wb191dF9zdF/FoXRfcGlfc28iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Im5lX3BvX3V0X3N0X8WhdF9waV9zbyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCBELiBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbZG5lcyBvXSBMVCIsbmV4dERheToiW3phanRyYSBvXSBMVCIsbmV4dFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbdiBuZWRlxL51IG9dIExUIjtjYXNlIDE6Y2FzZSAyOnJldHVybiJbdl0gZGRkZCBbb10gTFQiO2Nhc2UgMzpyZXR1cm4iW3Ygc3RyZWR1IG9dIExUIjtjYXNlIDQ6cmV0dXJuIlt2byDFoXR2cnRvayBvXSBMVCI7Y2FzZSA1OnJldHVybiJbdiBwaWF0b2sgb10gTFQiO2Nhc2UgNjpyZXR1cm4iW3Ygc29ib3R1IG9dIExUIn19LGxhc3REYXk6Ilt2xI1lcmEgb10gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW21pbnVsw7ogbmVkZcS+dSBvXSBMVCI7Y2FzZSAxOmNhc2UgMjpyZXR1cm4iW21pbnVsw71dIGRkZGQgW29dIExUIjtjYXNlIDM6cmV0dXJuIlttaW51bMO6IHN0cmVkdSBvXSBMVCI7Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW21pbnVsw71dIGRkZGQgW29dIExUIjtjYXNlIDY6cmV0dXJuIlttaW51bMO6IHNvYm90dSBvXSBMVCJ9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ6YSAlcyIscGFzdDoicHJlZCAlcyIsczppLG06aSxtbTppLGg6aSxoaDppLGQ6aSxkZDppLE06aSxNTTppLHk6aSx5eTppfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gc30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9dCsiICI7c3dpdGNoKGkpe2Nhc2UicyI6cmV0dXJuIGV8fG4/Im5la2FqIHNla3VuZCI6Im5la2FqIHNla3VuZGFtaSI7Y2FzZSJtIjpyZXR1cm4gZT8iZW5hIG1pbnV0YSI6ImVubyBtaW51dG8iO2Nhc2UibW0iOnJldHVybiByKz0xPT09dD9lPyJtaW51dGEiOiJtaW51dG8iOjI9PT10P2V8fG4/Im1pbnV0aSI6Im1pbnV0YW1hIjp0PDU/ZXx8bj8ibWludXRlIjoibWludXRhbWkiOmV8fG4/Im1pbnV0IjoibWludXRhbWkiO2Nhc2UiaCI6cmV0dXJuIGU/ImVuYSB1cmEiOiJlbm8gdXJvIjtjYXNlImhoIjpyZXR1cm4gcis9MT09PXQ/ZT8idXJhIjoidXJvIjoyPT09dD9lfHxuPyJ1cmkiOiJ1cmFtYSI6dDw1P2V8fG4/InVyZSI6InVyYW1pIjplfHxuPyJ1ciI6InVyYW1pIjtjYXNlImQiOnJldHVybiBlfHxuPyJlbiBkYW4iOiJlbmltIGRuZW0iO2Nhc2UiZGQiOnJldHVybiByKz0xPT09dD9lfHxuPyJkYW4iOiJkbmVtIjoyPT09dD9lfHxuPyJkbmkiOiJkbmV2b21hIjplfHxuPyJkbmkiOiJkbmV2aSI7Y2FzZSJNIjpyZXR1cm4gZXx8bj8iZW4gbWVzZWMiOiJlbmltIG1lc2VjZW0iO2Nhc2UiTU0iOnJldHVybiByKz0xPT09dD9lfHxuPyJtZXNlYyI6Im1lc2VjZW0iOjI9PT10P2V8fG4/Im1lc2VjYSI6Im1lc2VjZW1hIjp0PDU/ZXx8bj8ibWVzZWNlIjoibWVzZWNpIjplfHxuPyJtZXNlY2V2IjoibWVzZWNpIjtjYXNlInkiOnJldHVybiBlfHxuPyJlbm8gbGV0byI6ImVuaW0gbGV0b20iO2Nhc2UieXkiOnJldHVybiByKz0xPT09dD9lfHxuPyJsZXRvIjoibGV0b20iOjI9PT10P2V8fG4/ImxldGkiOiJsZXRvbWEiOnQ8NT9lfHxuPyJsZXRhIjoibGV0aSI6ZXx8bj8ibGV0IjoibGV0aSJ9fXZhciBpPXQuZGVmaW5lTG9jYWxlKCJzbCIse21vbnRoczoiamFudWFyX2ZlYnJ1YXJfbWFyZWNfYXByaWxfbWFqX2p1bmlqX2p1bGlqX2F2Z3VzdF9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuLl9mZWIuX21hci5fYXByLl9tYWouX2p1bi5fanVsLl9hdmcuX3NlcC5fb2t0Ll9ub3YuX2RlYy4iLnNwbGl0KCJfIiksd2Vla2RheXM6Im5lZGVsamFfcG9uZWRlbGpla190b3Jla19zcmVkYV/EjWV0cnRla19wZXRla19zb2JvdGEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoibmVkLl9wb24uX3Rvci5fc3JlLl/EjWV0Ll9wZXQuX3NvYi4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Im5lX3BvX3RvX3NyX8SNZV9wZV9zbyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQuIE1NLiBZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBELiBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbZGFuZXMgb2JdIExUIixuZXh0RGF5OiJbanV0cmkgb2JdIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt2XSBbbmVkZWxqb10gW29iXSBMVCI7Y2FzZSAzOnJldHVybiJbdl0gW3NyZWRvXSBbb2JdIExUIjtjYXNlIDY6cmV0dXJuIlt2XSBbc29ib3RvXSBbb2JdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlt2XSBkZGRkIFtvYl0gTFQifX0sbGFzdERheToiW3bEjWVyYWogb2JdIExUIixsYXN0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIltwcmVqxaFuam9dIFtuZWRlbGpvXSBbb2JdIExUIjtjYXNlIDM6cmV0dXJuIltwcmVqxaFuam9dIFtzcmVkb10gW29iXSBMVCI7Y2FzZSA2OnJldHVybiJbcHJlasWhbmpvXSBbc29ib3RvXSBbb2JdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIltwcmVqxaFuamldIGRkZGQgW29iXSBMVCJ9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLEjWV6ICVzIixwYXN0OiJwcmVkICVzIixzOmUsbTplLG1tOmUsaDplLGhoOmUsZDplLGRkOmUsTTplLE1NOmUseTplLHl5OmV9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInNxIix7bW9udGhzOiJKYW5hcl9TaGt1cnRfTWFyc19QcmlsbF9NYWpfUWVyc2hvcl9Lb3JyaWtfR3VzaHRfU2h0YXRvcl9UZXRvcl9Ow6tudG9yX0RoamV0b3IiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbl9TaGtfTWFyX1ByaV9NYWpfUWVyX0tvcl9HdXNfU2h0X1RldF9Ow6tuX0RoaiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiRSBEaWVsX0UgSMOrbsOrX0UgTWFydMOrX0UgTcOrcmt1csOrX0UgRW5qdGVfRSBQcmVtdGVfRSBTaHR1bsOrIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRpZV9Iw6tuX01hcl9Nw6tyX0Vual9QcmVfU2h0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJEX0hfTWFfTcOrX0VfUF9TaCIuc3BsaXQoIl8iKSxtZXJpZGllbVBhcnNlOi9QRHxNRC8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4iTSI9PT10LmNoYXJBdCgwKX0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDEyPyJQRCI6Ik1EIn0sbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbU290IG7Dq10gTFQiLG5leHREYXk6IltOZXPDq3IgbsOrXSBMVCIsbmV4dFdlZWs6ImRkZGQgW27Dq10gTFQiLGxhc3REYXk6IltEamUgbsOrXSBMVCIsbGFzdFdlZWs6ImRkZGQgW2Uga2FsdWFyIG7Dq10gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im7DqyAlcyIscGFzdDoiJXMgbcOrIHBhcsOrIixzOiJkaXNhIHNla29uZGEiLG06Im5qw6sgbWludXTDqyIsbW06IiVkIG1pbnV0YSIsaDoibmrDqyBvcsOrIixoaDoiJWQgb3LDqyIsZDoibmrDqyBkaXTDqyIsZGQ6IiVkIGRpdMOrIixNOiJuasOrIG11YWoiLE1NOiIlZCBtdWFqIix5OiJuasOrIHZpdCIseXk6IiVkIHZpdGUifSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXt3b3Jkczp7bTpbImplZGFuIG1pbnV0IiwiamVkbmUgbWludXRlIl0sbW06WyJtaW51dCIsIm1pbnV0ZSIsIm1pbnV0YSJdLGg6WyJqZWRhbiBzYXQiLCJqZWRub2cgc2F0YSJdLGhoOlsic2F0Iiwic2F0YSIsInNhdGkiXSxkZDpbImRhbiIsImRhbmEiLCJkYW5hIl0sTU06WyJtZXNlYyIsIm1lc2VjYSIsIm1lc2VjaSJdLHl5OlsiZ29kaW5hIiwiZ29kaW5lIiwiZ29kaW5hIl19LGNvcnJlY3RHcmFtbWF0aWNhbENhc2U6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMT09PXQ/ZVswXTp0Pj0yJiZ0PD00P2VbMV06ZVsyXX0sdHJhbnNsYXRlOmZ1bmN0aW9uKHQsaSxuKXt2YXIgcj1lLndvcmRzW25dO3JldHVybiAxPT09bi5sZW5ndGg/aT9yWzBdOnJbMV06dCsiICIrZS5jb3JyZWN0R3JhbW1hdGljYWxDYXNlKHQscil9fSxpPXQuZGVmaW5lTG9jYWxlKCJzciIse21vbnRoczpbImphbnVhciIsImZlYnJ1YXIiLCJtYXJ0IiwiYXByaWwiLCJtYWoiLCJqdW4iLCJqdWwiLCJhdmd1c3QiLCJzZXB0ZW1iYXIiLCJva3RvYmFyIiwibm92ZW1iYXIiLCJkZWNlbWJhciJdLG1vbnRoc1Nob3J0OlsiamFuLiIsImZlYi4iLCJtYXIuIiwiYXByLiIsIm1haiIsImp1biIsImp1bCIsImF2Zy4iLCJzZXAuIiwib2t0LiIsIm5vdi4iLCJkZWMuIl0sd2Vla2RheXM6WyJuZWRlbGphIiwicG9uZWRlbGphayIsInV0b3JhayIsInNyZWRhIiwixI1ldHZydGFrIiwicGV0YWsiLCJzdWJvdGEiXSx3ZWVrZGF5c1Nob3J0OlsibmVkLiIsInBvbi4iLCJ1dG8uIiwic3JlLiIsIsSNZXQuIiwicGV0LiIsInN1Yi4iXSx3ZWVrZGF5c01pbjpbIm5lIiwicG8iLCJ1dCIsInNyIiwixI1lIiwicGUiLCJzdSJdLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC4gTU0uIFlZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltkYW5hcyB1XSBMVCIsbmV4dERheToiW3N1dHJhIHVdIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt1XSBbbmVkZWxqdV0gW3VdIExUIjtjYXNlIDM6cmV0dXJuIlt1XSBbc3JlZHVdIFt1XSBMVCI7Y2FzZSA2OnJldHVybiJbdV0gW3N1Ym90dV0gW3VdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlt1XSBkZGRkIFt1XSBMVCJ9fSxsYXN0RGF5OiJbanXEjWUgdV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7dmFyIHQ9WyJbcHJvxaFsZV0gW25lZGVsamVdIFt1XSBMVCIsIltwcm/FoWxvZ10gW3BvbmVkZWxqa2FdIFt1XSBMVCIsIltwcm/FoWxvZ10gW3V0b3JrYV0gW3VdIExUIiwiW3Byb8WhbGVdIFtzcmVkZV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbxI1ldHZydGthXSBbdV0gTFQiLCJbcHJvxaFsb2ddIFtwZXRrYV0gW3VdIExUIiwiW3Byb8WhbGVdIFtzdWJvdGVdIFt1XSBMVCJdO3JldHVybiB0W3RoaXMuZGF5KCldfSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ6YSAlcyIscGFzdDoicHJlICVzIixzOiJuZWtvbGlrbyBzZWt1bmRpIixtOmUudHJhbnNsYXRlLG1tOmUudHJhbnNsYXRlLGg6ZS50cmFuc2xhdGUsaGg6ZS50cmFuc2xhdGUsZDoiZGFuIixkZDplLnRyYW5zbGF0ZSxNOiJtZXNlYyIsTU06ZS50cmFuc2xhdGUseToiZ29kaW51Iix5eTplLnRyYW5zbGF0ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17d29yZHM6e206WyLRmNC10LTQsNC9INC80LjQvdGD0YIiLCLRmNC10LTQvdC1INC80LjQvdGD0YLQtSJdLG1tOlsi0LzQuNC90YPRgiIsItC80LjQvdGD0YLQtSIsItC80LjQvdGD0YLQsCJdLGg6WyLRmNC10LTQsNC9INGB0LDRgiIsItGY0LXQtNC90L7QsyDRgdCw0YLQsCJdLGhoOlsi0YHQsNGCIiwi0YHQsNGC0LAiLCLRgdCw0YLQuCJdLGRkOlsi0LTQsNC9Iiwi0LTQsNC90LAiLCLQtNCw0L3QsCJdLE1NOlsi0LzQtdGB0LXRhiIsItC80LXRgdC10YbQsCIsItC80LXRgdC10YbQuCJdLHl5Olsi0LPQvtC00LjQvdCwIiwi0LPQvtC00LjQvdC1Iiwi0LPQvtC00LjQvdCwIl19LGNvcnJlY3RHcmFtbWF0aWNhbENhc2U6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMT09PXQ/ZVswXTp0Pj0yJiZ0PD00P2VbMV06ZVsyXX0sdHJhbnNsYXRlOmZ1bmN0aW9uKHQsaSxuKXt2YXIgcj1lLndvcmRzW25dO3JldHVybiAxPT09bi5sZW5ndGg/aT9yWzBdOnJbMV06dCsiICIrZS5jb3JyZWN0R3JhbW1hdGljYWxDYXNlKHQscil9fSxpPXQuZGVmaW5lTG9jYWxlKCJzci1jeXJsIix7bW9udGhzOlsi0ZjQsNC90YPQsNGAIiwi0YTQtdCx0YDRg9Cw0YAiLCLQvNCw0YDRgiIsItCw0L/RgNC40LsiLCLQvNCw0ZgiLCLRmNGD0L0iLCLRmNGD0LsiLCLQsNCy0LPRg9GB0YIiLCLRgdC10L/RgtC10LzQsdCw0YAiLCLQvtC60YLQvtCx0LDRgCIsItC90L7QstC10LzQsdCw0YAiLCLQtNC10YbQtdC80LHQsNGAIl0sbW9udGhzU2hvcnQ6WyLRmNCw0L0uIiwi0YTQtdCxLiIsItC80LDRgC4iLCLQsNC/0YAuIiwi0LzQsNGYIiwi0ZjRg9C9Iiwi0ZjRg9C7Iiwi0LDQstCzLiIsItGB0LXQvy4iLCLQvtC60YIuIiwi0L3QvtCyLiIsItC00LXRhi4iXSx3ZWVrZGF5czpbItC90LXQtNC10ZnQsCIsItC/0L7QvdC10LTQtdGZ0LDQuiIsItGD0YLQvtGA0LDQuiIsItGB0YDQtdC00LAiLCLRh9C10YLQstGA0YLQsNC6Iiwi0L/QtdGC0LDQuiIsItGB0YPQsdC+0YLQsCJdLHdlZWtkYXlzU2hvcnQ6WyLQvdC10LQuIiwi0L/QvtC9LiIsItGD0YLQvi4iLCLRgdGA0LUuIiwi0YfQtdGCLiIsItC/0LXRgi4iLCLRgdGD0LEuIl0sd2Vla2RheXNNaW46WyLQvdC1Iiwi0L/QviIsItGD0YIiLCLRgdGAIiwi0YfQtSIsItC/0LUiLCLRgdGDIl0sbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELiBNTS4gWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9C00LDQvdCw0YEg0YNdIExUIixuZXh0RGF5OiJb0YHRg9GC0YDQsCDRg10gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW9GDXSBb0L3QtdC00LXRmdGDXSBb0YNdIExUIjtjYXNlIDM6cmV0dXJuIlvRg10gW9GB0YDQtdC00YNdIFvRg10gTFQiO2Nhc2UgNjpyZXR1cm4iW9GDXSBb0YHRg9Cx0L7RgtGDXSBb0YNdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlvRg10gZGRkZCBb0YNdIExUIn19LGxhc3REYXk6IlvRmNGD0YfQtSDRg10gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7dmFyIHQ9WyJb0L/RgNC+0YjQu9C1XSBb0L3QtdC00LXRmdC1XSBb0YNdIExUIiwiW9C/0YDQvtGI0LvQvtCzXSBb0L/QvtC90LXQtNC10ZnQutCwXSBb0YNdIExUIiwiW9C/0YDQvtGI0LvQvtCzXSBb0YPRgtC+0YDQutCwXSBb0YNdIExUIiwiW9C/0YDQvtGI0LvQtV0gW9GB0YDQtdC00LVdIFvRg10gTFQiLCJb0L/RgNC+0YjQu9C+0LNdIFvRh9C10YLQstGA0YLQutCwXSBb0YNdIExUIiwiW9C/0YDQvtGI0LvQvtCzXSBb0L/QtdGC0LrQsF0gW9GDXSBMVCIsIlvQv9GA0L7RiNC70LVdIFvRgdGD0LHQvtGC0LVdIFvRg10gTFQiXTtyZXR1cm4gdFt0aGlzLmRheSgpXX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0LfQsCAlcyIscGFzdDoi0L/RgNC1ICVzIixzOiLQvdC10LrQvtC70LjQutC+INGB0LXQutGD0L3QtNC4IixtOmUudHJhbnNsYXRlLG1tOmUudHJhbnNsYXRlLGg6ZS50cmFuc2xhdGUsaGg6ZS50cmFuc2xhdGUsZDoi0LTQsNC9IixkZDplLnRyYW5zbGF0ZSxNOiLQvNC10YHQtdGGIixNTTplLnRyYW5zbGF0ZSx5OiLQs9C+0LTQuNC90YMiLHl5OmUudHJhbnNsYXRlfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJzdiIse21vbnRoczoiamFudWFyaV9mZWJydWFyaV9tYXJzX2FwcmlsX21hal9qdW5pX2p1bGlfYXVndXN0aV9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuX2ZlYl9tYXJfYXByX21hal9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6InPDtm5kYWdfbcOlbmRhZ190aXNkYWdfb25zZGFnX3RvcnNkYWdfZnJlZGFnX2zDtnJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic8O2bl9tw6VuX3Rpc19vbnNfdG9yX2ZyZV9sw7ZyIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJzw7ZfbcOlX3RpX29uX3RvX2ZyX2zDtiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJZWVlZLU1NLUREIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0lkYWddIExUIixuZXh0RGF5OiJbSW1vcmdvbl0gTFQiLGxhc3REYXk6IltJZ8Olcl0gTFQiLG5leHRXZWVrOiJbUMOlXSBkZGRkIExUIixsYXN0V2VlazoiW0ldIGRkZGRbc10gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9tICVzIixwYXN0OiJmw7ZyICVzIHNlZGFuIixzOiJuw6VncmEgc2VrdW5kZXIiLG06ImVuIG1pbnV0IixtbToiJWQgbWludXRlciIsaDoiZW4gdGltbWUiLGhoOiIlZCB0aW1tYXIiLGQ6ImVuIGRhZyIsZGQ6IiVkIGRhZ2FyIixNOiJlbiBtw6VuYWQiLE1NOiIlZCBtw6VuYWRlciIseToiZXR0IMOlciIseXk6IiVkIMOlciJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShlfGEpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT0xPT09fn4odCUxMDAvMTApPyJlIjoxPT09ZT8iYSI6Mj09PWU/ImEiOiJlIjtyZXR1cm4gdCtpfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJzdyIse21vbnRoczoiSmFudWFyaV9GZWJydWFyaV9NYWNoaV9BcHJpbGlfTWVpX0p1bmlfSnVsYWlfQWdvc3RpX1NlcHRlbWJhX09rdG9iYV9Ob3ZlbWJhX0Rlc2VtYmEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbl9GZWJfTWFjX0Fwcl9NZWlfSnVuX0p1bF9BZ29fU2VwX09rdF9Ob3ZfRGVzIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJKdW1hcGlsaV9KdW1hdGF0dV9KdW1hbm5lX0p1bWF0YW5vX0FsaGFtaXNpX0lqdW1hYV9KdW1hbW9zaSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJKcGxfSnRhdF9Kbm5lX0p0YW5fQWxoX0lqbV9KbW9zIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJKMl9KM19KNF9KNV9BbF9Jal9KMSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltsZW8gc2FhXSBMVCIsbmV4dERheToiW2tlc2hvIHNhYV0gTFQiLG5leHRXZWVrOiJbd2lraSBpamF5b10gZGRkZCBbc2FhdF0gTFQiLGxhc3REYXk6IltqYW5hXSBMVCIsbGFzdFdlZWs6Ilt3aWtpIGlsaXlvcGl0YV0gZGRkZCBbc2FhdF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzIGJhYWRheWUiLHBhc3Q6InRva2VhICVzIixzOiJoaXZpIHB1bmRlIixtOiJkYWtpa2EgbW9qYSIsbW06ImRha2lrYSAlZCIsaDoic2FhIGxpbW9qYSIsaGg6Im1hc2FhICVkIixkOiJzaWt1IG1vamEiLGRkOiJtYXNpa3UgJWQiLE06Im13ZXppIG1tb2phIixNTToibWllemkgJWQiLHk6Im13YWthIG1tb2phIix5eToibWlha2EgJWQifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLgr6ciLDI6IuCvqCIsMzoi4K+pIiw0OiLgr6oiLDU6IuCvqyIsNjoi4K+sIiw3OiLgr60iLDg6IuCvriIsOToi4K+vIiwwOiLgr6YifSxpPXsi4K+nIjoiMSIsIuCvqCI6IjIiLCLgr6kiOiIzIiwi4K+qIjoiNCIsIuCvqyI6IjUiLCLgr6wiOiI2Iiwi4K+tIjoiNyIsIuCvriI6IjgiLCLgr68iOiI5Iiwi4K+mIjoiMCJ9LG49dC5kZWZpbmVMb2NhbGUoInRhIix7bW9udGhzOiLgrpzgrqngrrXgrrDgrr9f4K6q4K6/4K6q4K+N4K6w4K614K6w4K6/X+CuruCuvuCusOCvjeCumuCvjV/gro/grqrgr43grrDgrrLgr41f4K6u4K+HX+CunOCvguCuqeCvjV/grpzgr4LgrrLgr4hf4K6G4K6V4K644K+N4K6f4K+NX+CumuCvhuCuquCvjeCun+CvhuCuruCvjeCuquCusOCvjV/groXgrpXgr43grp/gr4fgrr7grqrgrrDgr41f4K6o4K614K6u4K+N4K6q4K6w4K+NX+Cun+Cuv+CumuCuruCvjeCuquCusOCvjSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4K6c4K6p4K614K6w4K6/X+CuquCuv+CuquCvjeCusOCuteCusOCuv1/grq7grr7grrDgr43grprgr41f4K6P4K6q4K+N4K6w4K6y4K+NX+CuruCvh1/grpzgr4Lgrqngr41f4K6c4K+C4K6y4K+IX+CuhuCuleCuuOCvjeCun+CvjV/grprgr4bgrqrgr43grp/gr4bgrq7gr43grqrgrrDgr41f4K6F4K6V4K+N4K6f4K+H4K6+4K6q4K6w4K+NX+CuqOCuteCuruCvjeCuquCusOCvjV/grp/grr/grprgrq7gr43grqrgrrDgr40iLnNwbGl0KCJfIiksd2Vla2RheXM6IuCunuCuvuCur+Cuv+CuseCvjeCuseCvgeCuleCvjeCuleCuv+CutOCuruCviF/grqTgrr/grpngr43grpXgrp/gr43grpXgrr/grrTgrq7gr4hf4K6a4K+G4K614K+N4K614K6+4K6v4K+N4K6V4K6/4K604K6u4K+IX+CuquCvgeCupOCuqeCvjeCuleCuv+CutOCuruCviF/grrXgrr/grq/grr7grrTgrpXgr43grpXgrr/grrTgrq7gr4hf4K614K+G4K6z4K+N4K6z4K6/4K6V4K+N4K6V4K6/4K604K6u4K+IX+CumuCuqeCuv+CuleCvjeCuleCuv+CutOCuruCviCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLgrp7grr7grq/grr/grrHgr4Ff4K6k4K6/4K6Z4K+N4K6V4K6z4K+NX+CumuCvhuCuteCvjeCuteCuvuCur+CvjV/grqrgr4HgrqTgrqngr41f4K614K6/4K6v4K6+4K604K6p4K+NX+CuteCvhuCus+CvjeCus+Cuv1/grprgrqngrr8iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuCunuCuvl/grqTgrr9f4K6a4K+GX+CuquCvgV/grrXgrr9f4K614K+GX+CumiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSwgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW+Cuh+CuqeCvjeCuseCvgV0gTFQiLG5leHREYXk6Ilvgrqjgrr7grrPgr4hdIExUIixuZXh0V2VlazoiZGRkZCwgTFQiLGxhc3REYXk6Ilvgrqjgr4fgrrHgr43grrHgr4FdIExUIixsYXN0V2VlazoiW+CuleCun+CuqOCvjeCupCDgrrXgrr7grrDgrq7gr41dIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgrofgrrLgr40iLHBhc3Q6IiVzIOCuruCvgeCuqeCvjSIsczoi4K6S4K6w4K+BIOCumuCuv+CusiDgrrXgrr/grqjgrr7grp/grr/grpXgrrPgr40iLG06IuCukuCusOCvgSDgrqjgrr/grq7grr/grp/grq7gr40iLG1tOiIlZCDgrqjgrr/grq7grr/grp/grpngr43grpXgrrPgr40iLGg6IuCukuCusOCvgSDgrq7grqPgrr8g4K6o4K+H4K6w4K6u4K+NIixoaDoiJWQg4K6u4K6j4K6/IOCuqOCvh+CusOCuruCvjSIsZDoi4K6S4K6w4K+BIOCuqOCuvuCus+CvjSIsZGQ6IiVkIOCuqOCuvuCun+CvjeCuleCus+CvjSIsTToi4K6S4K6w4K+BIOCuruCuvuCupOCuruCvjSIsTU06IiVkIOCuruCuvuCupOCumeCvjeCuleCus+CvjSIseToi4K6S4K6w4K+BIOCuteCusOCvgeCun+CuruCvjSIseXk6IiVkIOCuhuCuo+CvjeCun+CvgeCuleCus+CvjSJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfeCuteCupOCvgS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdCsi4K614K6k4K+BIn0scHJlcGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvW+Cvp+CvqOCvqeCvquCvq+CvrOCvreCvruCvr+Cvpl0vZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pfSxwb3N0Zm9ybWF0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1xkL2csZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX0sbWVyaWRpZW1QYXJzZTov4K6v4K6+4K6u4K6u4K+NfOCuteCviOCuleCuseCviHzgrpXgrr7grrLgr4h84K6o4K6j4K+N4K6q4K6V4K6y4K+NfOCujuCuseCvjeCuquCuvuCun+CvgXzgrq7grr7grrLgr4gvLG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwyPyIg4K6v4K6+4K6u4K6u4K+NIjp0PDY/IiDgrrXgr4jgrpXgrrHgr4giOnQ8MTA/IiDgrpXgrr7grrLgr4giOnQ8MTQ/IiDgrqjgrqPgr43grqrgrpXgrrLgr40iOnQ8MTg/IiDgro7grrHgr43grqrgrr7grp/gr4EiOnQ8MjI/IiDgrq7grr7grrLgr4giOiIg4K6v4K6+4K6u4K6u4K+NIn0sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuCur+CuvuCuruCuruCvjSI9PT1lP3Q8Mj90OnQrMTI6IuCuteCviOCuleCuseCviCI9PT1lfHwi4K6V4K6+4K6y4K+IIj09PWU/dDoi4K6o4K6j4K+N4K6q4K6V4K6y4K+NIj09PWUmJnQ+PTEwP3Q6dCsxMn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgidGUiLHttb250aHM6IuCwnOCwqOCwteCwsOCwv1/gsKvgsL/gsKzgsY3gsLDgsLXgsLDgsL9f4LCu4LC+4LCw4LGN4LCa4LC/X+Cwj+CwquCxjeCwsOCwv+CwsuCxjV/gsK7gsYdf4LCc4LGC4LCo4LGNX+CwnOCxguCwsuCxhuCxll/gsIbgsJfgsLjgsY3gsJ/gsYFf4LC44LGG4LCq4LGN4LCf4LGG4LCC4LCs4LCw4LGNX+CwheCwleCxjeCwn+Cxi+CwrOCwsOCxjV/gsKjgsLXgsILgsKzgsLDgsY1f4LCh4LC/4LC44LGG4LCC4LCs4LCw4LGNIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLgsJzgsKguX+Cwq+Cwv+CwrOCxjeCwsC5f4LCu4LC+4LCw4LGN4LCa4LC/X+Cwj+CwquCxjeCwsOCwvy5f4LCu4LGHX+CwnOCxguCwqOCxjV/gsJzgsYLgsLLgsYbgsZZf4LCG4LCXLl/gsLjgsYbgsKrgsY0uX+CwheCwleCxjeCwn+Cxiy5f4LCo4LC1Ll/gsKHgsL/gsLjgsYYuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgsIbgsKbgsL/gsLXgsL7gsLDgsIJf4LC44LGL4LCu4LC14LC+4LCw4LCCX+CwruCwguCwl+Cws+CwteCwvuCwsOCwgl/gsKzgsYHgsKfgsLXgsL7gsLDgsIJf4LCX4LGB4LCw4LGB4LC14LC+4LCw4LCCX+CwtuCxgeCwleCxjeCwsOCwteCwvuCwsOCwgl/gsLbgsKjgsL/gsLXgsL7gsLDgsIIiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4LCG4LCm4LC/X+CwuOCxi+Cwrl/gsK7gsILgsJfgsLNf4LCs4LGB4LCnX+Cwl+CxgeCwsOCxgV/gsLbgsYHgsJXgsY3gsLBf4LC24LCo4LC/Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgsIZf4LC44LGLX+CwruCwgl/gsKzgsYFf4LCX4LGBX+CwtuCxgV/gsLYiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0iLExUUzoiQSBoOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEEgaDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4LCo4LGH4LCh4LGBXSBMVCIsbmV4dERheToiW+CwsOCxh+CwquCxgV0gTFQiLG5leHRXZWVrOiJkZGRkLCBMVCIsbGFzdERheToiW+CwqOCwv+CwqOCxjeCwqF0gTFQiLGxhc3RXZWVrOiJb4LCX4LCkXSBkZGRkLCBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMg4LCy4LGLIixwYXN0OiIlcyDgsJXgsY3gsLDgsL/gsKTgsIIiLHM6IuCwleCxiuCwqOCxjeCwqOCwvyDgsJXgsY3gsLfgsKPgsL7gsLLgsYEiLG06IuCwkuCwlSDgsKjgsL/gsK7gsL/gsLfgsIIiLG1tOiIlZCDgsKjgsL/gsK7gsL/gsLfgsL7gsLLgsYEiLGg6IuCwkuCwlSDgsJfgsILgsJ8iLGhoOiIlZCDgsJfgsILgsJ/gsLLgsYEiLGQ6IuCwkuCwlSDgsLDgsYvgsJzgsYEiLGRkOiIlZCDgsLDgsYvgsJzgsYHgsLLgsYEiLE06IuCwkuCwlSDgsKjgsYbgsLIiLE1NOiIlZCDgsKjgsYbgsLLgsLLgsYEiLHk6IuCwkuCwlSDgsLjgsILgsLXgsKTgsY3gsLjgsLDgsIIiLHl5OiIlZCDgsLjgsILgsLXgsKTgsY3gsLjgsLDgsL7gsLLgsYEifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3gsLUvLG9yZGluYWw6IiVk4LC1IixtZXJpZGllbVBhcnNlOi/gsLDgsL7gsKTgsY3gsLDgsL984LCJ4LCm4LCv4LCCfOCwruCwp+CxjeCwr+CwvuCwueCxjeCwqOCwgnzgsLjgsL7gsK/gsILgsKTgsY3gsLDgsIIvLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgsLDgsL7gsKTgsY3gsLDgsL8iPT09ZT90PDQ/dDp0KzEyOiLgsIngsKbgsK/gsIIiPT09ZT90OiLgsK7gsKfgsY3gsK/gsL7gsLngsY3gsKjgsIIiPT09ZT90Pj0xMD90OnQrMTI6IuCwuOCwvuCwr+CwguCwpOCxjeCwsOCwgiI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4LCw4LC+4LCk4LGN4LCw4LC/Ijp0PDEwPyLgsIngsKbgsK/gsIIiOnQ8MTc/IuCwruCwp+CxjeCwr+CwvuCwueCxjeCwqOCwgiI6dDwyMD8i4LC44LC+4LCv4LCC4LCk4LGN4LCw4LCCIjoi4LCw4LC+4LCk4LGN4LCw4LC/In0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgidGgiLHttb250aHM6IuC4oeC4geC4o+C4suC4hOC4oV/guIHguLjguKHguKDguLLguJ7guLHguJnguJjguYxf4Lih4Li14LiZ4Liy4LiE4LihX+C5gOC4oeC4qeC4suC4ouC4mV/guJ7guKTguKnguKDguLLguITguKFf4Lih4Li04LiW4Li44LiZ4Liy4Lii4LiZX+C4geC4o+C4geC4juC4suC4hOC4oV/guKrguLTguIfguKvguLLguITguKFf4LiB4Lix4LiZ4Lii4Liy4Lii4LiZX+C4leC4uOC4peC4suC4hOC4oV/guJ7guKTguKjguIjguLTguIHguLLguKLguJlf4LiY4Lix4LiZ4Lin4Liy4LiE4LihIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLguKHguIHguKPguLJf4LiB4Li44Lih4Lig4LiyX+C4oeC4teC4meC4sl/guYDguKHguKnguLJf4Lie4Lik4Lip4Lig4LiyX+C4oeC4tOC4luC4uOC4meC4sl/guIHguKPguIHguI7guLJf4Liq4Li04LiH4Lir4LiyX+C4geC4seC4meC4ouC4sl/guJXguLjguKXguLJf4Lie4Lik4Lio4LiI4Li04LiB4LiyX+C4mOC4seC4meC4p+C4siIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4Lit4Liy4LiX4Li04LiV4Lii4LmMX+C4iOC4seC4meC4l+C4o+C5jF/guK3guLHguIfguITguLLguKNf4Lie4Li44LiYX+C4nuC4pOC4q+C4seC4quC4muC4lOC4tV/guKjguLjguIHguKPguYxf4LmA4Liq4Liy4Lij4LmMIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuC4reC4suC4l+C4tOC4leC4ouC5jF/guIjguLHguJnguJfguKPguYxf4Lit4Lix4LiH4LiE4Liy4LijX+C4nuC4uOC4mF/guJ7guKTguKvguLHguKpf4Lio4Li44LiB4Lij4LmMX+C5gOC4quC4suC4o+C5jCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4Lit4LiyLl/guIguX+C4rS5f4LieLl/guJ7guKQuX+C4qC5f4LiqLiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikgg4LiZ4Liy4Lis4Li04LiB4LiyIG0g4LiZ4Liy4LiX4Li1IixMVFM6Ikgg4LiZ4Liy4Lis4Li04LiB4LiyIG0g4LiZ4Liy4LiX4Li1IHMg4Lin4Li04LiZ4Liy4LiX4Li1IixMOiJZWVlZL01NL0REIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkg4LmA4Lin4Lil4LiyIEgg4LiZ4Liy4Lis4Li04LiB4LiyIG0g4LiZ4Liy4LiX4Li1IixMTExMOiLguKfguLHguJlkZGRk4LiX4Li14LmIIEQgTU1NTSBZWVlZIOC5gOC4p+C4peC4siBIIOC4meC4suC4rOC4tOC4geC4siBtIOC4meC4suC4l+C4tSJ9LG1lcmlkaWVtUGFyc2U6L+C4geC5iOC4reC4meC5gOC4l+C4teC5iOC4ouC4h3zguKvguKXguLHguIfguYDguJfguLXguYjguKLguIcvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuIuC4q+C4peC4seC4h+C5gOC4l+C4teC5iOC4ouC4hyI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/IuC4geC5iOC4reC4meC5gOC4l+C4teC5iOC4ouC4hyI6IuC4q+C4peC4seC4h+C5gOC4l+C4teC5iOC4ouC4hyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4Lin4Lix4LiZ4LiZ4Li14LmJIOC5gOC4p+C4peC4sl0gTFQiLG5leHREYXk6IlvguJ7guKPguLjguYjguIfguJnguLXguYkg4LmA4Lin4Lil4LiyXSBMVCIsbmV4dFdlZWs6ImRkZGRb4Lir4LiZ4LmJ4LiyIOC5gOC4p+C4peC4sl0gTFQiLGxhc3REYXk6IlvguYDguKHguLfguYjguK3guKfguLLguJnguJnguLXguYkg4LmA4Lin4Lil4LiyXSBMVCIsbGFzdFdlZWs6IlvguKfguLHguJldZGRkZFvguJfguLXguYjguYHguKXguYnguKcg4LmA4Lin4Lil4LiyXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi4Lit4Li14LiBICVzIixwYXN0OiIlc+C4l+C4teC5iOC5geC4peC5ieC4pyIsczoi4LmE4Lih4LmI4LiB4Li14LmI4Lin4Li04LiZ4Liy4LiX4Li1IixtOiIxIOC4meC4suC4l+C4tSIsbW06IiVkIOC4meC4suC4l+C4tSIsaDoiMSDguIrguLHguYjguKfguYLguKHguIciLGhoOiIlZCDguIrguLHguYjguKfguYLguKHguIciLGQ6IjEg4Lin4Lix4LiZIixkZDoiJWQg4Lin4Lix4LiZIixNOiIxIOC5gOC4lOC4t+C4reC4mSIsTU06IiVkIOC5gOC4lOC4t+C4reC4mSIseToiMSDguJvguLUiLHl5OiIlZCDguJvguLUifX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInRsLXBoIix7bW9udGhzOiJFbmVyb19QZWJyZXJvX01hcnNvX0FicmlsX01heW9fSHVueW9fSHVseW9fQWdvc3RvX1NldHllbWJyZV9Pa3R1YnJlX05vYnllbWJyZV9EaXN5ZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IkVuZV9QZWJfTWFyX0Ficl9NYXlfSHVuX0h1bF9BZ29fU2V0X09rdF9Ob2JfRGlzIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJMaW5nZ29fTHVuZXNfTWFydGVzX01peWVya3VsZXNfSHV3ZWJlc19CaXllcm5lc19TYWJhZG8iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiTGluX0x1bl9NYXJfTWl5X0h1d19CaXlfU2FiIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJMaV9MdV9NYV9NaV9IdV9CaV9TYWIiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiTU0vRC9ZWVlZIixMTDoiTU1NTSBELCBZWVlZIixMTEw6Ik1NTU0gRCwgWVlZWSBISDptbSIsTExMTDoiZGRkZCwgTU1NTSBERCwgWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbTmdheW9uIHNhXSBMVCIsbmV4dERheToiW0J1a2FzIHNhXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3NhXSBMVCIsbGFzdERheToiW0thaGFwb24gc2FdIExUIixsYXN0V2VlazoiZGRkZCBbaHVsaW5nIGxpbmdnb10gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InNhIGxvb2IgbmcgJXMiLHBhc3Q6IiVzIGFuZyBuYWthbGlwYXMiLHM6ImlsYW5nIHNlZ3VuZG8iLG06ImlzYW5nIG1pbnV0byIsbW06IiVkIG1pbnV0byIsaDoiaXNhbmcgb3JhcyIsaGg6IiVkIG9yYXMiLGQ6ImlzYW5nIGFyYXciLGRkOiIlZCBhcmF3IixNOiJpc2FuZyBidXdhbiIsTU06IiVkIGJ1d2FuIix5OiJpc2FuZyB0YW9uIix5eToiJWQgdGFvbiJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdH0sd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQpe3ZhciBlPXQ7cmV0dXJuIGU9dC5pbmRleE9mKCJqYWoiKSE9PS0xP2Uuc2xpY2UoMCwtMykrImxlUyI6dC5pbmRleE9mKCJqYXIiKSE9PS0xP2Uuc2xpY2UoMCwtMykrIndhUSI6dC5pbmRleE9mKCJESVMiKSE9PS0xP2Uuc2xpY2UoMCwtMykrIm5lbSI6ZSsiIHBJcSJ9ZnVuY3Rpb24gaSh0KXt2YXIgZT10O3JldHVybiBlPXQuaW5kZXhPZigiamFqIikhPT0tMT9lLnNsaWNlKDAsLTMpKyJIdeKAmSI6dC5pbmRleE9mKCJqYXIiKSE9PS0xP2Uuc2xpY2UoMCwtMykrIndlbiI6dC5pbmRleE9mKCJESVMiKSE9PS0xP2Uuc2xpY2UoMCwtMykrImJlbiI6ZSsiIHJldCJ9ZnVuY3Rpb24gbih0LGUsaSxuKXt2YXIgcz1yKHQpO3N3aXRjaChpKXtjYXNlIm1tIjpyZXR1cm4gcysiIHR1cCI7Y2FzZSJoaCI6cmV0dXJuIHMrIiByZXAiO2Nhc2UiZGQiOnJldHVybiBzKyIgamFqIjtjYXNlIk1NIjpyZXR1cm4gcysiIGphciI7Y2FzZSJ5eSI6cmV0dXJuIHMrIiBESVMifX1mdW5jdGlvbiByKHQpe3ZhciBlPU1hdGguZmxvb3IodCUxZTMvMTAwKSxpPU1hdGguZmxvb3IodCUxMDAvMTApLG49dCUxMCxyPSIiO3JldHVybiBlPjAmJihyKz1zW2VdKyJ2YXRsaCIpLGk+MCYmKHIrPSgiIiE9PXI/IiAiOiIiKStzW2ldKyJtYUgiKSxuPjAmJihyKz0oIiIhPT1yPyIgIjoiIikrc1tuXSksIiI9PT1yPyJwYWdoIjpyfXZhciBzPSJwYWdoX3dh4oCZX2NoYeKAmV93ZWpfbG9TX3ZhZ2hfamF2X1NvY2hfY2hvcmdoX0h1dCIuc3BsaXQoIl8iKSxvPXQuZGVmaW5lTG9jYWxlKCJ0bGgiLHttb250aHM6InRlcmHigJkgamFyIHdh4oCZX3RlcmHigJkgamFyIGNoYeKAmV90ZXJh4oCZIGphciB3ZWpfdGVyYeKAmSBqYXIgbG9TX3RlcmHigJkgamFyIHZhZ2hfdGVyYeKAmSBqYXIgamF2X3RlcmHigJkgamFyIFNvY2hfdGVyYeKAmSBqYXIgY2hvcmdoX3RlcmHigJkgamFyIEh1dF90ZXJh4oCZIGphciB3YeKAmW1hSF90ZXJh4oCZIGphciB3YeKAmW1hSCB3YeKAmV90ZXJh4oCZIGphciB3YeKAmW1hSCBjaGHigJkiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ImphciB3YeKAmV9qYXIgY2hh4oCZX2phciB3ZWpfamFyIGxvU19qYXIgdmFnaF9qYXIgamF2X2phciBTb2NoX2phciBjaG9yZ2hfamFyIEh1dF9qYXIgd2HigJltYUhfamFyIHdh4oCZbWFIIHdh4oCZX2phciB3YeKAmW1hSCBjaGHigJkiLnNwbGl0KCJfIiksd2Vla2RheXM6Imxvam1JdGphal9EYVNqYWpfcG92amFqX2doSXRsaGphal9sb2doamFqX2J1cWphal9naEluamFqIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Imxvam1JdGphal9EYVNqYWpfcG92amFqX2doSXRsaGphal9sb2doamFqX2J1cWphal9naEluamFqIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJsb2ptSXRqYWpfRGFTamFqX3Bvdmphal9naEl0bGhqYWpfbG9naGphal9idXFqYWpfZ2hJbmphaiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltEYUhqYWpdIExUIixuZXh0RGF5OiJbd2HigJlsZVNdIExUIixuZXh0V2VlazoiTExMIixsYXN0RGF5OiJbd2HigJlIdeKAmV0gTFQiLGxhc3RXZWVrOiJMTEwiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZSxwYXN0OmksczoicHVTIGx1cCIsbToid2HigJkgdHVwIixtbTpuLGg6Indh4oCZIHJlcCIsaGg6bixkOiJ3YeKAmSBqYWoiLGRkOm4sTToid2HigJkgamFyIixNTTpuLHk6Indh4oCZIERJUyIseXk6bn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIG99KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToiJ2luY2kiLDU6IidpbmNpIiw4OiInaW5jaSIsNzA6IidpbmNpIiw4MDoiJ2luY2kiLDI6IiduY2kiLDc6IiduY2kiLDIwOiInbmNpIiw1MDoiJ25jaSIsMzoiJ8O8bmPDvCIsNDoiJ8O8bmPDvCIsMTAwOiInw7xuY8O8Iiw2OiInbmPEsSIsOToiJ3VuY3UiLDEwOiIndW5jdSIsMzA6Iid1bmN1Iiw2MDoiJ8SxbmPEsSIsOTA6IifEsW5jxLEifSxpPXQuZGVmaW5lTG9jYWxlKCJ0ciIse21vbnRoczoiT2Nha1/FnnViYXRfTWFydF9OaXNhbl9NYXnEsXNfSGF6aXJhbl9UZW1tdXpfQcSfdXN0b3NfRXlsw7xsX0VraW1fS2FzxLFtX0FyYWzEsWsiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ik9jYV/FnnViX01hcl9OaXNfTWF5X0hhel9UZW1fQcSfdV9FeWxfRWtpX0thc19BcmEiLnNwbGl0KCJfIiksd2Vla2RheXM6IlBhemFyX1BhemFydGVzaV9TYWzEsV/Dh2FyxZ9hbWJhX1BlcsWfZW1iZV9DdW1hX0N1bWFydGVzaSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJQYXpfUHRzX1NhbF/Dh2FyX1Blcl9DdW1fQ3RzIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJQel9QdF9TYV/Dh2FfUGVfQ3VfQ3QiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbYnVnw7xuIHNhYXRdIExUIixuZXh0RGF5OiJbeWFyxLFuIHNhYXRdIExUIixuZXh0V2VlazoiW2hhZnRheWFdIGRkZGQgW3NhYXRdIExUIixsYXN0RGF5OiJbZMO8bl0gTFQiLGxhc3RXZWVrOiJbZ2XDp2VuIGhhZnRhXSBkZGRkIFtzYWF0XSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgc29ucmEiLHBhc3Q6IiVzIMO2bmNlIixzOiJiaXJrYcOnIHNhbml5ZSIsbToiYmlyIGRha2lrYSIsbW06IiVkIGRha2lrYSIsaDoiYmlyIHNhYXQiLGhoOiIlZCBzYWF0IixkOiJiaXIgZ8O8biIsZGQ6IiVkIGfDvG4iLE06ImJpciBheSIsTU06IiVkIGF5Iix5OiJiaXIgecSxbCIseXk6IiVkIHnEsWwifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0nKGluY2l8bmNpfMO8bmPDvHxuY8SxfHVuY3V8xLFuY8SxKS8sb3JkaW5hbDpmdW5jdGlvbih0KXtpZigwPT09dClyZXR1cm4gdCsiJ8SxbmPEsSI7dmFyIGk9dCUxMCxuPXQlMTAwLWkscj10Pj0xMDA/MTAwOm51bGw7cmV0dXJuIHQrKGVbaV18fGVbbl18fGVbcl0pfSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9e3M6WyJ2aWVuc2FzIHNlY3VuZHMiLCInaWVuc2FzIHNlY3VuZHMiXSxtOlsiJ24gbcOtdXQiLCInaWVucyBtw611dCJdLG1tOlt0KyIgbcOtdXRzIiwiIit0KyIgbcOtdXRzIl0saDpbIiduIMO+b3JhIiwiJ2llbnNhIMO+b3JhIl0saGg6W3QrIiDDvm9yYXMiLCIiK3QrIiDDvm9yYXMiXSxkOlsiJ24geml1YSIsIidpZW5zYSB6aXVhIl0sZGQ6W3QrIiB6aXVhcyIsIiIrdCsiIHppdWFzIl0sTTpbIiduIG1lcyIsIidpZW5zIG1lcyJdLE1NOlt0KyIgbWVzZW4iLCIiK3QrIiBtZXNlbiJdLHk6WyInbiBhciIsIidpZW5zIGFyIl0seXk6W3QrIiBhcnMiLCIiK3QrIiBhcnMiXX07cmV0dXJuIG4/cltpXVswXTplP3JbaV1bMF06cltpXVsxXX12YXIgaT10LmRlZmluZUxvY2FsZSgidHpsIix7bW9udGhzOiJKYW51YXJfRmV2cmFnbGhfTWFyw6dfQXZyw691X01haV9Hw7xuX0p1bGlhX0d1c2NodF9TZXRlbXZhcl9MaXN0b3DDpHRzX05vZW12YXJfWmVjZW12YXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbl9GZXZfTWFyX0F2cl9NYWlfR8O8bl9KdWxfR3VzX1NldF9MaXNfTm9lX1plYyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU8O6bGFkaV9Mw7puZcOnaV9NYWl0emlfTcOhcmN1cmlfWGjDumFkaV9WacOpbmVyw6dpX1PDoXR1cmkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU8O6bF9Mw7puX01haV9Nw6FyX1how7pfVmnDqV9Tw6F0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTw7pfTMO6X01hX03DoV9YaF9WaV9Tw6EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQuIE1NTU0gW2RhbGxhc10gWVlZWSIsTExMOiJELiBNTU1NIFtkYWxsYXNdIFlZWVkgSEgubW0iLExMTEw6ImRkZGQsIFtsaV0gRC4gTU1NTSBbZGFsbGFzXSBZWVlZIEhILm1tIn0sbWVyaWRpZW1QYXJzZTovZFwnb3xkXCdhL2ksaXNQTTpmdW5jdGlvbih0KXtyZXR1cm4iZCdvIj09PXQudG9Mb3dlckNhc2UoKX0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PjExP2k/ImQnbyI6IkQnTyI6aT8iZCdhIjoiRCdBIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltveGhpIMOgXSBMVCIsbmV4dERheToiW2RlbcOgIMOgXSBMVCIsbmV4dFdlZWs6ImRkZGQgW8OgXSBMVCIsbGFzdERheToiW2llaXJpIMOgXSBMVCIsbGFzdFdlZWs6Iltzw7xyIGVsXSBkZGRkIFtsYXN0ZXUgw6BdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvc3ByZWkgJXMiLHBhc3Q6ImphJXMiLHM6ZSxtOmUsbW06ZSxoOmUsaGg6ZSxkOmUsZGQ6ZSxNOmUsTU06ZSx5OmUseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLAoJb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ0em0iLHttb250aHM6IuK1ieK1j+K1j+K0sOK1ouK1lF/itLHitZXitLDitaLitZVf4rWO4rSw4rWV4rWaX+K1ieK0seK1lOK1ieK1lF/itY7itLDitaLitaLitZNf4rWi4rWT4rWP4rWi4rWTX+K1ouK1k+K1jeK1ouK1k+K1o1/itZbitZPitZvitZxf4rWb4rWT4rWc4rSw4rWP4rSx4rWJ4rWUX+K0veK1n+K1k+K0seK1lV/itY/itZPitaHitLDitY/itLHitYnitZRf4rS34rWT4rWK4rWP4rSx4rWJ4rWUIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLitYnitY/itY/itLDitaLitZRf4rSx4rWV4rSw4rWi4rWVX+K1juK0sOK1leK1ml/itYnitLHitZTitYnitZRf4rWO4rSw4rWi4rWi4rWTX+K1ouK1k+K1j+K1ouK1k1/itaLitZPitY3itaLitZPitaNf4rWW4rWT4rWb4rWcX+K1m+K1k+K1nOK0sOK1j+K0seK1ieK1lF/itL3itZ/itZPitLHitZVf4rWP4rWT4rWh4rSw4rWP4rSx4rWJ4rWUX+K0t+K1k+K1iuK1j+K0seK1ieK1lCIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4rSw4rWZ4rSw4rWO4rSw4rWZX+K0sOK1ouK1j+K0sOK1mV/itLDitZnitYnitY/itLDitZlf4rSw4rS94rWU4rSw4rWZX+K0sOK0veK1oeK0sOK1mV/itLDitZnitYnitY7itaHitLDitZlf4rSw4rWZ4rWJ4rS54rWi4rSw4rWZIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuK0sOK1meK0sOK1juK0sOK1mV/itLDitaLitY/itLDitZlf4rSw4rWZ4rWJ4rWP4rSw4rWZX+K0sOK0veK1lOK0sOK1mV/itLDitL3itaHitLDitZlf4rSw4rWZ4rWJ4rWO4rWh4rSw4rWZX+K0sOK1meK1ieK0ueK1ouK0sOK1mSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4rSw4rWZ4rSw4rWO4rSw4rWZX+K0sOK1ouK1j+K0sOK1mV/itLDitZnitYnitY/itLDitZlf4rSw4rS94rWU4rSw4rWZX+K0sOK0veK1oeK0sOK1mV/itLDitZnitYnitY7itaHitLDitZlf4rSw4rWZ4rWJ4rS54rWi4rSw4rWZIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4rSw4rWZ4rS34rWFIOK0tF0gTFQiLG5leHREYXk6IlvitLDitZnitL3itLAg4rS0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW+K0tF0gTFQiLGxhc3REYXk6IlvitLDitZritLDitY/itZwg4rS0XSBMVCIsbGFzdFdlZWs6ImRkZGQgW+K0tF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IuK0t+K0sOK0t+K1hSDitZkg4rWi4rSw4rWPICVzIixwYXN0OiLitaLitLDitY8gJXMiLHM6IuK1ieK1juK1ieK0vSIsbToi4rWO4rWJ4rWP4rWT4rS6IixtbToiJWQg4rWO4rWJ4rWP4rWT4rS6IixoOiLitZnitLDitYTitLAiLGhoOiIlZCDitZzitLDitZnitZnitLDitYTitYnitY8iLGQ6IuK0sOK1meK1mSIsZGQ6IiVkIG/itZnitZnitLDitY8iLE06IuK0sOK1om/itZPitZQiLE1NOiIlZCDitYnitaLitaLitYnitZTitY8iLHk6IuK0sOK1meK0s+K0sOK1mSIseXk6IiVkIOK1ieK1meK0s+K0sOK1meK1jyJ9LHdlZWs6e2Rvdzo2LGRveToxMn19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ0em0tbGF0biIse21vbnRoczoiaW5uYXlyX2Jyy6RheXLLpF9tYXLLpHPLpF9pYnJpcl9tYXl5d195d255d195d2x5d3pfyaN3xaF0X8Whd3RhbmJpcl9rdMukd2Jyy6Rfbnd3YW5iaXJfZHdqbmJpciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiaW5uYXlyX2Jyy6RheXLLpF9tYXLLpHPLpF9pYnJpcl9tYXl5d195d255d195d2x5d3pfyaN3xaF0X8Whd3RhbmJpcl9rdMukd2Jyy6Rfbnd3YW5iaXJfZHdqbmJpciIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiYXNhbWFzX2F5bmFzX2FzaW5hc19ha3Jhc19ha3dhc19hc2ltd2FzX2FzaeG4jXlhcyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJhc2FtYXNfYXluYXNfYXNpbmFzX2FrcmFzX2Frd2FzX2FzaW13YXNfYXNp4biNeWFzIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJhc2FtYXNfYXluYXNfYXNpbmFzX2FrcmFzX2Frd2FzX2FzaW13YXNfYXNp4biNeWFzIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbYXNka2ggZ10gTFQiLG5leHREYXk6Ilthc2thIGddIExUIixuZXh0V2VlazoiZGRkZCBbZ10gTFQiLGxhc3REYXk6Ilthc3NhbnQgZ10gTFQiLGxhc3RXZWVrOiJkZGRkIFtnXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFka2ggcyB5YW4gJXMiLHBhc3Q6InlhbiAlcyIsczoiaW1payIsbToibWludeG4jSIsbW06IiVkIG1pbnXhuI0iLGg6InNhyZthIixoaDoiJWQgdGFzc2HJm2luIixkOiJhc3MiLGRkOiIlZCBvc3NhbiIsTToiYXlvd3IiLE1NOiIlZCBpeXlpcm4iLHk6ImFzZ2FzIix5eToiJWQgaXNnYXNuIn0sd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUpe3ZhciBpPXQuc3BsaXQoIl8iKTtyZXR1cm4gZSUxMD09PTEmJmUlMTAwIT09MTE/aVswXTplJTEwPj0yJiZlJTEwPD00JiYoZSUxMDA8MTB8fGUlMTAwPj0yMCk/aVsxXTppWzJdfWZ1bmN0aW9uIGkodCxpLG4pe3ZhciByPXttbTppPyLRhdCy0LjQu9C40L3QsF/RhdCy0LjQu9C40L3QuF/RhdCy0LjQu9C40L0iOiLRhdCy0LjQu9C40L3Rg1/RhdCy0LjQu9C40L3QuF/RhdCy0LjQu9C40L0iLGhoOmk/ItCz0L7QtNC40L3QsF/Qs9C+0LTQuNC90Lhf0LPQvtC00LjQvSI6ItCz0L7QtNC40L3Rg1/Qs9C+0LTQuNC90Lhf0LPQvtC00LjQvSIsZGQ6ItC00LXQvdGMX9C00L3Rll/QtNC90ZbQsiIsTU06ItC80ZbRgdGP0YbRjF/QvNGW0YHRj9GG0ZZf0LzRltGB0Y/RhtGW0LIiLHl5OiLRgNGW0Lpf0YDQvtC60Lhf0YDQvtC60ZbQsiJ9O3JldHVybiJtIj09PW4/aT8i0YXQstC40LvQuNC90LAiOiLRhdCy0LjQu9C40L3RgyI6ImgiPT09bj9pPyLQs9C+0LTQuNC90LAiOiLQs9C+0LTQuNC90YMiOnQrIiAiK2UocltuXSwrdCl9ZnVuY3Rpb24gbih0LGUpe3ZhciBpPXtub21pbmF0aXZlOiLQvdC10LTRltC70Y9f0L/QvtC90LXQtNGW0LvQvtC6X9Cy0ZbQstGC0L7RgNC+0Lpf0YHQtdGA0LXQtNCwX9GH0LXRgtCy0LXRgF/Qv+KAmdGP0YLQvdC40YbRj1/RgdGD0LHQvtGC0LAiLnNwbGl0KCJfIiksYWNjdXNhdGl2ZToi0L3QtdC00ZbQu9GOX9C/0L7QvdC10LTRltC70L7Qul/QstGW0LLRgtC+0YDQvtC6X9GB0LXRgNC10LTRg1/Rh9C10YLQstC10YBf0L/igJnRj9GC0L3QuNGG0Y5f0YHRg9Cx0L7RgtGDIi5zcGxpdCgiXyIpLGdlbml0aXZlOiLQvdC10LTRltC70ZZf0L/QvtC90LXQtNGW0LvQutCwX9Cy0ZbQstGC0L7RgNC60LBf0YHQtdGA0LXQtNC4X9GH0LXRgtCy0LXRgNCz0LBf0L/igJnRj9GC0L3QuNGG0ZZf0YHRg9Cx0L7RgtC4Ii5zcGxpdCgiXyIpfSxuPS8oXFtb0JLQstCj0YNdXF0pID9kZGRkLy50ZXN0KGUpPyJhY2N1c2F0aXZlIjovXFs/KD860LzQuNC90YPQu9C+0Zd80L3QsNGB0YLRg9C/0L3QvtGXKT8gP1xdID9kZGRkLy50ZXN0KGUpPyJnZW5pdGl2ZSI6Im5vbWluYXRpdmUiO3JldHVybiBpW25dW3QuZGF5KCldfWZ1bmN0aW9uIHIodCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQrItC+IisoMTE9PT10aGlzLmhvdXJzKCk/ItCxIjoiIikrIl0gTFQifX12YXIgcz10LmRlZmluZUxvY2FsZSgidWsiLHttb250aHM6e2Zvcm1hdDoi0YHRltGH0L3Rj1/Qu9GO0YLQvtCz0L5f0LHQtdGA0LXQt9C90Y9f0LrQstGW0YLQvdGPX9GC0YDQsNCy0L3Rj1/Rh9C10YDQstC90Y9f0LvQuNC/0L3Rj1/RgdC10YDQv9C90Y9f0LLQtdGA0LXRgdC90Y9f0LbQvtCy0YLQvdGPX9C70LjRgdGC0L7Qv9Cw0LTQsF/Qs9GA0YPQtNC90Y8iLnNwbGl0KCJfIiksc3RhbmRhbG9uZToi0YHRltGH0LXQvdGMX9C70Y7RgtC40Llf0LHQtdGA0LXQt9C10L3RjF/QutCy0ZbRgtC10L3RjF/RgtGA0LDQstC10L3RjF/Rh9C10YDQstC10L3RjF/Qu9C40L/QtdC90Yxf0YHQtdGA0L/QtdC90Yxf0LLQtdGA0LXRgdC10L3RjF/QttC+0LLRgtC10L3RjF/Qu9C40YHRgtC+0L/QsNC0X9Cz0YDRg9C00LXQvdGMIi5zcGxpdCgiXyIpfSxtb250aHNTaG9ydDoi0YHRltGHX9C70Y7Rgl/QsdC10YBf0LrQstGW0YJf0YLRgNCw0LJf0YfQtdGA0LJf0LvQuNC/X9GB0LXRgNC/X9Cy0LXRgF/QttC+0LLRgl/Qu9C40YHRgl/Qs9GA0YPQtCIuc3BsaXQoIl8iKSx3ZWVrZGF5czpuLHdlZWtkYXlzU2hvcnQ6ItC90LRf0L/QvV/QstGCX9GB0YBf0YfRgl/Qv9GCX9GB0LEiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItC90LRf0L/QvV/QstGCX9GB0YBf0YfRgl/Qv9GCX9GB0LEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQgTU1NTSBZWVlZINGALiIsTExMOiJEIE1NTU0gWVlZWSDRgC4sIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSDRgC4sIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6cigiW9Ch0YzQvtCz0L7QtNC90ZYgIiksbmV4dERheTpyKCJb0JfQsNCy0YLRgNCwICIpLGxhc3REYXk6cigiW9CS0YfQvtGA0LAgIiksbmV4dFdlZWs6cigiW9CjXSBkZGRkIFsiKSxsYXN0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6Y2FzZSAzOmNhc2UgNTpjYXNlIDY6cmV0dXJuIHIoIlvQnNC40L3Rg9C70L7Rl10gZGRkZCBbIikuY2FsbCh0aGlzKTtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpyZXR1cm4gcigiW9Cc0LjQvdGD0LvQvtCz0L5dIGRkZGQgWyIpLmNhbGwodGhpcyl9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLQt9CwICVzIixwYXN0OiIlcyDRgtC+0LzRgyIsczoi0LTQtdC60ZbQu9GM0LrQsCDRgdC10LrRg9C90LQiLG06aSxtbTppLGg6ItCz0L7QtNC40L3RgyIsaGg6aSxkOiLQtNC10L3RjCIsZGQ6aSxNOiLQvNGW0YHRj9GG0YwiLE1NOmkseToi0YDRltC6Iix5eTppfSxtZXJpZGllbVBhcnNlOi/QvdC+0YfRlnzRgNCw0L3QutGDfNC00L3Rj3zQstC10YfQvtGA0LAvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuL14o0LTQvdGPfNCy0LXRh9C+0YDQsCkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i0L3QvtGH0ZYiOnQ8MTI/ItGA0LDQvdC60YMiOnQ8MTc/ItC00L3RjyI6ItCy0LXRh9C+0YDQsCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfS0o0Ll80LPQvikvLG9yZGluYWw6ZnVuY3Rpb24odCxlKXtzd2l0Y2goZSl7Y2FzZSJNIjpjYXNlImQiOmNhc2UiREREIjpjYXNlInciOmNhc2UiVyI6cmV0dXJuIHQrIi3QuSI7Y2FzZSJEIjpyZXR1cm4gdCsiLdCz0L4iO2RlZmF1bHQ6cmV0dXJuIHR9fSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gc30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ1eiIse21vbnRoczoi0Y/QvdCy0LDRgF/RhNC10LLRgNCw0Ltf0LzQsNGA0YJf0LDQv9GA0LXQu1/QvNCw0Llf0LjRjtC9X9C40Y7Qu1/QsNCy0LPRg9GB0YJf0YHQtdC90YLRj9Cx0YBf0L7QutGC0Y/QsdGAX9C90L7Rj9Cx0YBf0LTQtdC60LDQsdGAIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLRj9C90LJf0YTQtdCyX9C80LDRgF/QsNC/0YBf0LzQsNC5X9C40Y7QvV/QuNGO0Ltf0LDQstCzX9GB0LXQvV/QvtC60YJf0L3QvtGPX9C00LXQuiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0K/QutGI0LDQvdCx0LBf0JTRg9GI0LDQvdCx0LBf0KHQtdGI0LDQvdCx0LBf0KfQvtGA0YjQsNC90LHQsF/Qn9Cw0LnRiNCw0L3QsdCwX9CW0YPQvNCwX9Co0LDQvdCx0LAiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi0K/QutGIX9CU0YPRiF/QodC10Yhf0KfQvtGAX9Cf0LDQuV/QltGD0Lxf0KjQsNC9Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLQr9C6X9CU0YNf0KHQtV/Qp9C+X9Cf0LBf0JbRg1/QqNCwIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiRCBNTU1NIFlZWVksIGRkZGQgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9CR0YPQs9GD0L0g0YHQvtCw0YJdIExUIFvQtNCwXSIsbmV4dERheToiW9Ct0YDRgtCw0LPQsF0gTFQgW9C00LBdIixuZXh0V2VlazoiZGRkZCBb0LrRg9C90Lgg0YHQvtCw0YJdIExUIFvQtNCwXSIsbGFzdERheToiW9Ca0LXRh9CwINGB0L7QsNGCXSBMVCBb0LTQsF0iLGxhc3RXZWVrOiJb0KPRgtCz0LDQvV0gZGRkZCBb0LrRg9C90Lgg0YHQvtCw0YJdIExUIFvQtNCwXSIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0K/QutC40L0gJXMg0LjRh9C40LTQsCIscGFzdDoi0JHQuNGAINC90LXRh9CwICVzINC+0LvQtNC40L0iLHM6ItGE0YPRgNGB0LDRgiIsbToi0LHQuNGAINC00LDQutC40LrQsCIsbW06IiVkINC00LDQutC40LrQsCIsaDoi0LHQuNGAINGB0L7QsNGCIixoaDoiJWQg0YHQvtCw0YIiLGQ6ItCx0LjRgCDQutGD0L0iLGRkOiIlZCDQutGD0L0iLE06ItCx0LjRgCDQvtC5IixNTToiJWQg0L7QuSIseToi0LHQuNGAINC50LjQuyIseXk6IiVkINC50LjQuyJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInZpIix7bW9udGhzOiJ0aMOhbmcgMV90aMOhbmcgMl90aMOhbmcgM190aMOhbmcgNF90aMOhbmcgNV90aMOhbmcgNl90aMOhbmcgN190aMOhbmcgOF90aMOhbmcgOV90aMOhbmcgMTBfdGjDoW5nIDExX3Row6FuZyAxMiIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiVGgwMV9UaDAyX1RoMDNfVGgwNF9UaDA1X1RoMDZfVGgwN19UaDA4X1RoMDlfVGgxMF9UaDExX1RoMTIiLnNwbGl0KCJfIiksd2Vla2RheXM6ImNo4bunIG5o4bqtdF90aOG7qSBoYWlfdGjhu6kgYmFfdGjhu6kgdMawX3Ro4bupIG7Eg21fdGjhu6kgc8OhdV90aOG7qSBi4bqjeSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJDTl9UMl9UM19UNF9UNV9UNl9UNyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiQ05fVDJfVDNfVDRfVDVfVDZfVDciLnNwbGl0KCJfIiksbWVyaWRpZW1QYXJzZTovc2F8Y2gvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eY2gkL2kudGVzdCh0KX0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDEyP2k/InNhIjoiU0EiOmk/ImNoIjoiQ0gifSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFtuxINtXSBZWVlZIixMTEw6IkQgTU1NTSBbbsSDbV0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFtuxINtXSBZWVlZIEhIOm1tIixsOiJERC9NL1lZWVkiLGxsOiJEIE1NTSBZWVlZIixsbGw6IkQgTU1NIFlZWVkgSEg6bW0iLGxsbGw6ImRkZCwgRCBNTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSMO0bSBuYXkgbMO6Y10gTFQiLG5leHREYXk6IltOZ8OgeSBtYWkgbMO6Y10gTFQiLG5leHRXZWVrOiJkZGRkIFt0deG6p24gdOG7m2kgbMO6Y10gTFQiLGxhc3REYXk6IltIw7RtIHF1YSBsw7pjXSBMVCIsbGFzdFdlZWs6ImRkZGQgW3R14bqnbiBy4buTaSBsw7pjXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgdOG7m2kiLHBhc3Q6IiVzIHRyxrDhu5tjIixzOiJ2w6BpIGdpw6J5IixtOiJt4buZdCBwaMO6dCIsbW06IiVkIHBow7p0IixoOiJt4buZdCBnaeG7nSIsaGg6IiVkIGdp4budIixkOiJt4buZdCBuZ8OgeSIsZGQ6IiVkIG5nw6B5IixNOiJt4buZdCB0aMOhbmciLE1NOiIlZCB0aMOhbmciLHk6Im3hu5l0IG7Eg20iLHl5OiIlZCBuxINtIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0fSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ6aC1jbiIse21vbnRoczoi5LiA5pyIX+S6jOaciF/kuInmnIhf5Zub5pyIX+S6lOaciF/lha3mnIhf5LiD5pyIX+WFq+aciF/kuZ3mnIhf5Y2B5pyIX+WNgeS4gOaciF/ljYHkuozmnIgiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IjHmnIhfMuaciF8z5pyIXzTmnIhfNeaciF825pyIXzfmnIhfOOaciF855pyIXzEw5pyIXzEx5pyIXzEy5pyIIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLmmJ/mnJ/ml6Vf5pif5pyf5LiAX+aYn+acn+S6jF/mmJ/mnJ/kuIlf5pif5pyf5ZubX+aYn+acn+S6lF/mmJ/mnJ/lha0iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi5ZGo5pelX+WRqOS4gF/lkajkuoxf5ZGo5LiJX+WRqOWbm1/lkajkupRf5ZGo5YWtIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLml6Vf5LiAX+S6jF/kuIlf5ZubX+S6lF/lha0iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBaOeCuW1t5YiGIixMVFM6IkFo54K5beWIhnPnp5IiLEw6IllZWVktTU0tREQiLExMOiJZWVlZ5bm0TU1NROaXpSIsTExMOiJZWVlZ5bm0TU1NROaXpUFo54K5bW3liIYiLExMTEw6IllZWVnlubRNTU1E5pelZGRkZEFo54K5bW3liIYiLGw6IllZWVktTU0tREQiLGxsOiJZWVlZ5bm0TU1NROaXpSIsbGxsOiJZWVlZ5bm0TU1NROaXpUFo54K5bW3liIYiLGxsbGw6IllZWVnlubRNTU1E5pelZGRkZEFo54K5bW3liIYifSxtZXJpZGllbVBhcnNlOi/lh4zmmah85pep5LiKfOS4iuWNiHzkuK3ljYh85LiL5Y2IfOaZmuS4ii8sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuWHjOaZqCI9PT1lfHwi5pep5LiKIj09PWV8fCLkuIrljYgiPT09ZT90OiLkuIvljYgiPT09ZXx8IuaZmuS4iiI9PT1lP3QrMTI6dD49MTE/dDp0KzEyfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7dmFyIG49MTAwKnQrZTtyZXR1cm4gbjw2MDA/IuWHjOaZqCI6bjw5MDA/IuaXqeS4iiI6bjwxMTMwPyLkuIrljYgiOm48MTIzMD8i5Lit5Y2IIjpuPDE4MDA/IuS4i+WNiCI6IuaZmuS4iiJ9LGNhbGVuZGFyOntzYW1lRGF5OmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLm1pbnV0ZXMoKT8iW+S7iuWkqV1BaFvngrnmlbRdIjoiW+S7iuWkqV1MVCJ9LG5leHREYXk6ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMubWludXRlcygpPyJb5piO5aSpXUFoW+eCueaVtF0iOiJb5piO5aSpXUxUIn0sbGFzdERheTpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5taW51dGVzKCk/IlvmmKjlpKldQWhb54K55pW0XSI6IlvmmKjlpKldTFQifSxuZXh0V2VlazpmdW5jdGlvbigpe3ZhciBlLGk7cmV0dXJuIGU9dCgpLnN0YXJ0T2YoIndlZWsiKSxpPXRoaXMudW5peCgpLWUudW5peCgpPj02MDQ4MDA/IlvkuItdIjoiW+acrF0iLDA9PT10aGlzLm1pbnV0ZXMoKT9pKyJkZGRBaOeCueaVtCI6aSsiZGRkQWjngrltbSJ9LGxhc3RXZWVrOmZ1bmN0aW9uKCl7dmFyIGUsaTtyZXR1cm4gZT10KCkuc3RhcnRPZigid2VlayIpLGk9dGhpcy51bml4KCk8ZS51bml4KCk/IlvkuIpdIjoiW+acrF0iLDA9PT10aGlzLm1pbnV0ZXMoKT9pKyJkZGRBaOeCueaVtCI6aSsiZGRkQWjngrltbSJ9LHNhbWVFbHNlOiJMTCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfSjml6V85pyIfOWRqCkvLG9yZGluYWw6ZnVuY3Rpb24odCxlKXtzd2l0Y2goZSl7Y2FzZSJkIjpjYXNlIkQiOmNhc2UiREREIjpyZXR1cm4gdCsi5pelIjtjYXNlIk0iOnJldHVybiB0KyLmnIgiO2Nhc2UidyI6Y2FzZSJXIjpyZXR1cm4gdCsi5ZGoIjtkZWZhdWx0OnJldHVybiB0fX0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz5YaFIixwYXN0OiIlc+WJjSIsczoi5Yeg56eSIixtOiIxIOWIhumSnyIsbW06IiVkIOWIhumSnyIsaDoiMSDlsI/ml7YiLGhoOiIlZCDlsI/ml7YiLGQ6IjEg5aSpIixkZDoiJWQg5aSpIixNOiIxIOS4quaciCIsTU06IiVkIOS4quaciCIseToiMSDlubQiLHl5OiIlZCDlubQifSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ6aC10dyIse21vbnRoczoi5LiA5pyIX+S6jOaciF/kuInmnIhf5Zub5pyIX+S6lOaciF/lha3mnIhf5LiD5pyIX+WFq+aciF/kuZ3mnIhf5Y2B5pyIX+WNgeS4gOaciF/ljYHkuozmnIgiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IjHmnIhfMuaciF8z5pyIXzTmnIhfNeaciF825pyIXzfmnIhfOOaciF855pyIXzEw5pyIXzEx5pyIXzEy5pyIIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLmmJ/mnJ/ml6Vf5pif5pyf5LiAX+aYn+acn+S6jF/mmJ/mnJ/kuIlf5pif5pyf5ZubX+aYn+acn+S6lF/mmJ/mnJ/lha0iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi6YCx5pelX+mAseS4gF/pgLHkuoxf6YCx5LiJX+mAseWbm1/pgLHkupRf6YCx5YWtIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLml6Vf5LiAX+S6jF/kuIlf5ZubX+S6lF/lha0iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBaOm7nm1t5YiGIixMVFM6IkFo6buebeWIhnPnp5IiLEw6IllZWVnlubRNTU1E5pelIixMTDoiWVlZWeW5tE1NTUTml6UiLExMTDoiWVlZWeW5tE1NTUTml6VBaOm7nm1t5YiGIixMTExMOiJZWVlZ5bm0TU1NROaXpWRkZGRBaOm7nm1t5YiGIixsOiJZWVlZ5bm0TU1NROaXpSIsbGw6IllZWVnlubRNTU1E5pelIixsbGw6IllZWVnlubRNTU1E5pelQWjpu55tbeWIhiIsbGxsbDoiWVlZWeW5tE1NTUTml6VkZGRkQWjpu55tbeWIhiJ9LG1lcmlkaWVtUGFyc2U6L+aXqeS4inzkuIrljYh85Lit5Y2IfOS4i+WNiHzmmZrkuIovLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLml6nkuIoiPT09ZXx8IuS4iuWNiCI9PT1lP3Q6IuS4reWNiCI9PT1lP3Q+PTExP3Q6dCsxMjoi5LiL5Y2IIj09PWV8fCLmmZrkuIoiPT09ZT90KzEyOnZvaWQgMH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3ZhciBuPTEwMCp0K2U7cmV0dXJuIG48OTAwPyLml6nkuIoiOm48MTEzMD8i5LiK5Y2IIjpuPDEyMzA/IuS4reWNiCI6bjwxODAwPyLkuIvljYgiOiLmmZrkuIoifSxjYWxlbmRhcjp7c2FtZURheToiW+S7iuWkqV1MVCIsbmV4dERheToiW+aYjuWkqV1MVCIsbmV4dFdlZWs6IlvkuItdZGRkZExUIixsYXN0RGF5OiJb5pio5aSpXUxUIixsYXN0V2VlazoiW+S4il1kZGRkTFQiLHNhbWVFbHNlOiJMIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KOaXpXzmnIh86YCxKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3N3aXRjaChlKXtjYXNlImQiOmNhc2UiRCI6Y2FzZSJEREQiOnJldHVybiB0KyLml6UiO2Nhc2UiTSI6cmV0dXJuIHQrIuaciCI7Y2FzZSJ3IjpjYXNlIlciOnJldHVybiB0KyLpgLEiO2RlZmF1bHQ6cmV0dXJuIHR9fSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXPlhaciLHBhc3Q6IiVz5YmNIixzOiLlub7np5IiLG06IuS4gOWIhumQmCIsbW06IiVk5YiG6ZCYIixoOiLkuIDlsI/mmYIiLGhoOiIlZOWwj+aZgiIsZDoi5LiA5aSpIixkZDoiJWTlpKkiLE06IuS4gOWAi+aciCIsTU06IiVk5YCL5pyIIix5OiLkuIDlubQiLHl5OiIlZOW5tCJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDEzNyldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe3NlY3VyZUpTT046ITEsX2J1aWx0SW5Mb2NhbFByb3BzOntfX2VkaXRfXzoiYm9vbGVhbiIsX19wZW5kaW5nX186ImJvb2xlYW4ifSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3RoaXMubG9jYWw9dC5kZWZhdWx0cyh7fSx0LnJlc3VsdCh0aGlzLCJsb2NhbCIpLHRoaXMuX2J1aWx0SW5Mb2NhbFByb3BzKSx0LnJlc3VsdCh0aGlzLCJzZWN1cmVKU09OIikmJih0aGlzLnN5bmM9dC53cmFwKHRoaXMuc3luYyxmdW5jdGlvbihlLGksbixyKXtyZXR1cm4gZS5jYWxsKHRoaXMsaSxuLHQuZXh0ZW5kKHtkYXRhVHlwZToic2VjdXJlSlNPTiJ9LHIpKX0pKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOyFmdW5jdGlvbihvLGEpe3I9W2koMiksaSgzNSldLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKGUsbixyLHMpe3ZhciBvPXQuY29udGFpbnMobixyKTtyZXR1cm4gc3x8KHM9e30pLG98fCF0LmlzT2JqZWN0KGUpfHx0LmlzQXJyYXkoZSl8fHQuaXNGdW5jdGlvbihlKT92b2lkIDAhPT1yJiYoc1tyXT1lKTp0LmVhY2goZSxmdW5jdGlvbih0LGUpe2kodCxuLHI/cisiLiIrZTplLHMpfSksc31mdW5jdGlvbiBuKGUpe3JldHVybiB0LmVhY2goZSxmdW5jdGlvbih0LGUsaSl7aWYoZS5pbmRleE9mKCIuIikhPS0xKXtmb3IodmFyIG4scj1pLHM9ZS5zcGxpdCgiLiIpO3ZvaWQgMCE9PShuPXMuc2hpZnQoKSk7KXJbbl18fChyW25dPXMubGVuZ3RoP3t9OnQpLHI9cltuXTtkZWxldGUgaVtlXX19KSxlfWZ1bmN0aW9uIHIodCxlKXt2YXIgaT17fTtyZXR1cm4gaVt0Lm5hbWVdPWUsaX1mdW5jdGlvbiBzKGUsaSl7dmFyIG47cmV0dXJuIG49dC5pc1N0cmluZyhlKT97dHlwZTplfTp0LmlzQXJyYXkoZSk/e3R5cGU6ZVswXSxyZXF1aXJlZDplWzFdLHZhbHVlOmVbMl19OnQuY2xvbmUoZSksdC5kZWZhdWx0cyhuLHtyZXF1aXJlZDohMSxuYW1lOml9KSxufWZ1bmN0aW9uIG8odCl7cmV0dXJuIHQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cYlthLXpdL2csZnVuY3Rpb24odCl7cmV0dXJuIHQudG9VcHBlckNhc2UoKX0pfWZ1bmN0aW9uIGEoZSxpKXtyZXR1cm4gdC5pc0Jvb2xlYW4oZSk/ZTp0LmlzUmVnRXhwKGUpP2UudGVzdChpKTohIXQuaXNGdW5jdGlvbihlKSYmZS5jYWxsKHRoaXMsaSl9ZnVuY3Rpb24gbCh0LGUsaSl7aWYoIWUudGVzdCh0KSlyZXR1cm4gaX1mdW5jdGlvbiBjKHQsZSl7dmFyIGk9Zlt0LmZvcm1hdF07aWYodC5mb3JtYXQmJiFpKXRocm93IG5ldyBUeXBlRXJyb3IodC5mb3JtYXQrIiBpcyBub3QgYSBzdXBwb3J0ZWQgc3RyaW5nIGZvcm1hdCIpO3JldHVybiBpJiZpKGUpfWZ1bmN0aW9uIHUoZSxpKXt2YXIgbj10LnBhcnRpYWwocixlKSxzPWMoZSxpKTtyZXR1cm4gcz9uKHMpOmkmJmUubWluTGVuZ3RoJiZpLmxlbmd0aDxlLm1pbkxlbmd0aD9uKHAuRVJST1JfU1RSSU5HX1NUUklOR19NSU5fTEVOR1RILGkubGVuZ3RoKTppJiZlLm1heExlbmd0aCYmaS5sZW5ndGg+ZS5tYXhMZW5ndGg/bihwLkVSUk9SX1NUUklOR19TVFJJTkdfTUFYX0xFTkdUSCxpLmxlbmd0aCk6dm9pZCAwfWZ1bmN0aW9uIGQoZSxpKXt2YXIgbixzLGE9dC5wYXJ0aWFsKHIsZSksbD0hdC5pc1VuZGVmaW5lZChpKSYmIXQuaXNOdWxsKGkpO2lmKGUucmVxdWlyZWQmJighbHx8dC5pc051bGwoaSl8fCIiPT09aSkpcmV0dXJuIGEocC5FUlJPUl9CTEFOSyk7aWYobj10WyJpcyIrbyhlLnR5cGUpXSxsJiYiYW55IiE9ZS50eXBlJiYoIXQuaXNGdW5jdGlvbihuKXx8IW4oaSkpKXJldHVybiBhKHAuRVJST1JfV1JPTkdfVFlQRSk7aWYoaSYmInN0cmluZyI9PWUudHlwZSl7dmFyIGM9dShlLGkpO2lmKGMpcmV0dXJuIGN9aWYobCYmZS52YWx1ZXMmJiF0LmNvbnRhaW5zKGUudmFsdWVzLGkpKXJldHVybiBhKHAuRVJST1JfTk9UX0FMTE9XRUQpO2lmKHQuaXNGdW5jdGlvbihlLnZhbGlkYXRlKSl7dmFyIGQ9ZS52YWxpZGF0ZShpKTtpZih0LmlzU3RyaW5nKGQpJiZkKXJldHVybiBhKGQpO2lmKGQ9PT0hMSlyZXR1cm4gYShwLkVSUk9SX0lOVkFMSUQpfXJldHVybiBsJiYiYXJyYXkiPT1lLnR5cGUmJihzPWgoZSxpKSk/YShzKTp2b2lkIDB9ZnVuY3Rpb24gaChlLGkpe2lmKGUubWluSXRlbXMmJmkubGVuZ3RoPGUubWluSXRlbXMpcmV0dXJuIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuYXJyYXkubWluSXRlbXMiO2lmKGUubWF4SXRlbXMmJmkubGVuZ3RoPmUubWF4SXRlbXMpcmV0dXJuIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuYXJyYXkubWF4SXRlbXMiO2lmKGUudW5pcXVlSXRlbXMmJmkubGVuZ3RoPnQudW5pcShpKS5sZW5ndGgpcmV0dXJuIHAuRVJST1JfSUFSUkFZX1VOSVFVRTtpZihlLml0ZW1zKWZvcih2YXIgbj1zKGUuaXRlbXMsInBsYWNlaG9sZGVyIikscj0wO3I8aS5sZW5ndGg7cisrKXt2YXIgbz1pW3JdLGE9ZChuLG8pO2lmKGEpcmV0dXJuIGEucGxhY2Vob2xkZXJ9fXZhciBwLGY9e2VtYWlsOmZ1bmN0aW9uKHQpe3ZhciBlPS9eKChbXjw+KClcW1xdXFwuLDs6XHNAIl0rKFwuW148PigpXFtcXVxcLiw7OlxzQCJdKykqKXwoIi4rIikpQCgoXFtbMC05XXsxLDN9XC5bMC05XXsxLDN9XC5bMC05XXsxLDN9XC5bMC05XXsxLDN9XSl8KChbYS16QS1aXC0wLTldK1wuKStbYS16QS1aXXsyLH0pKSQvO3JldHVybiBsKHQsZSxwLkVSUk9SX0lOVkFMSURfRk9STUFUX0VNQUlMKX0sdXJpOmZ1bmN0aW9uKHQpe3ZhciBlPS9eKD86KD86aHR0cHM/fGZ0cCk6XC9cLykoPzpcUysoPzo6XFMqKT9AKT8oPzooPyEoPzoxMHwxMjcpKD86XC5cZHsxLDN9KXszfSkoPyEoPzoxNjlcLjI1NHwxOTJcLjE2OCkoPzpcLlxkezEsM30pezJ9KSg/ITE3MlwuKD86MVs2LTldfDJcZHwzWzAtMV0pKD86XC5cZHsxLDN9KXsyfSkoPzpbMS05XVxkP3wxXGRcZHwyWzAxXVxkfDIyWzAtM10pKD86XC4oPzoxP1xkezEsMn18MlswLTRdXGR8MjVbMC01XSkpezJ9KD86XC4oPzpbMS05XVxkP3wxXGRcZHwyWzAtNF1cZHwyNVswLTRdKSl8KD86KD86W2Etelx1MDBhMS1cdWZmZmYwLTldLSopKlthLXpcdTAwYTEtXHVmZmZmMC05XSspKD86XC4oPzpbYS16XHUwMGExLVx1ZmZmZjAtOV0tKikqW2Etelx1MDBhMS1cdWZmZmYwLTldKykqKD86XC4oPzpbYS16XHUwMGExLVx1ZmZmZl17Mix9KSlcLj8pKD86OlxkezIsNX0pPyg/OltcLz8jXVxTKik/JC9pO3JldHVybiBsKHQsZSxwLkVSUk9SX0lOVkFMSURfRk9STUFUX1VSSSl9LGlwdjQ6ZnVuY3Rpb24odCl7dmFyIGU9L14oPzooPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pXC4pezN9KD86MjVbMC01XXwyWzAtNF1bMC05XXxbMDFdP1swLTldWzAtOV0/KSQvO3JldHVybiBsKHQsZSxwLkVSUk9SX0lOVkFMSURfRk9STUFUX0lQVjQpfSxob3N0bmFtZTpmdW5jdGlvbih0KXt2YXIgZT0vXigoW2EtekEtWjAtOV18W2EtekEtWjAtOV1bYS16QS1aMC05XC1dKlthLXpBLVowLTldKVwuKSooW0EtWmEtejAtOV18W0EtWmEtejAtOV1bQS1aYS16MC05XC1dKltBLVphLXowLTldKSQvO3JldHVybiBsKHQsZSxwLkVSUk9SX0lOVkFMSURfRk9STUFUX0hPU1ROQU1FKX19O3JldHVybiBwPWUuTW9kZWwuZXh0ZW5kKHtwcm9wczp7fSxkZXJpdmVkOnt9LGxvY2FsOnt9LGV4dHJhUHJvcGVydGllczohMSxmbGF0OiEwLGRlZmF1bHRzOnt9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKG4pe3RoaXMub3B0aW9ucz1ufHx7fTt2YXIgcj10aGlzLl9fc2NoZW1hX189e30sbz1bXTtyLmNvbXB1dGVkUHJvcGVydGllcz17fSxyLmV4dHJhUHJvcGVydGllcz10aGlzLmV4dHJhUHJvcGVydGllcyxyLnByb3BzPXQuY2xvbmUodC5yZXN1bHQodGhpcywicHJvcHMiKXx8e30pLHIuZGVyaXZlZD10LmNsb25lKHQucmVzdWx0KHRoaXMsImRlcml2ZWQiKXx8e30pLHIubG9jYWw9dC5jbG9uZSh0LnJlc3VsdCh0aGlzLCJsb2NhbCIpfHx7fSk7dmFyIGE9e307aWYodC5lYWNoKHQuZXh0ZW5kKHt9LHIucHJvcHMsci5sb2NhbCksZnVuY3Rpb24oZSxpKXt2YXIgbj1zKGUsaSk7dC5pc1VuZGVmaW5lZChuLnZhbHVlKXx8KGFbaV09bi52YWx1ZSksIm9iamVjdCI9PT1uLnR5cGUmJm8ucHVzaChpKX0sdGhpcyksdC5zaXplKGEpKXt2YXIgbD10LnJlc3VsdCh0aGlzLCJkZWZhdWx0cyIpO3RoaXMuZGVmYXVsdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdC5kZWZhdWx0cyh7fSxhLGwpfX10aGlzLnZhbGlkYXRlPXQud3JhcCh0aGlzLnZhbGlkYXRlLGZ1bmN0aW9uKGUpe3ZhciBpPXQucmVzdChhcmd1bWVudHMpLG49dC5leHRlbmQodGhpcy5fdmFsaWRhdGVTY2hlbWEuYXBwbHkodGhpcyxpKSxlLmFwcGx5KHRoaXMsaSkpO3JldHVybiB0LnNpemUobikmJm58fHZvaWQgMH0pLHRoaXMucGFyc2U9dC53cmFwKHRoaXMucGFyc2UsZnVuY3Rpb24oZSl7dmFyIG49ZS5hcHBseSh0aGlzLHQucmVzdChhcmd1bWVudHMpKTtyZXR1cm4gdGhpcy5mbGF0JiYobj1pKG4sbykpLG59KSxlLk1vZGVsLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0LmVhY2goci5kZXJpdmVkLGZ1bmN0aW9uKHQsZSl7ci5jb21wdXRlZFByb3BlcnRpZXNbZV09dGhpcy5fX2dldERlcml2ZWRWYWx1ZShlKTt2YXIgaT10LmRlcHN8fFtdO2kubGVuZ3RoJiZ0aGlzLm9uKCJjYWNoZTpjbGVhciBjaGFuZ2U6IitpLmpvaW4oIiBjaGFuZ2U6IiksZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9fZ2V0RGVyaXZlZFZhbHVlKGUpO3QhPT1yLmNvbXB1dGVkUHJvcGVydGllc1tlXSYmKHIuY29tcHV0ZWRQcm9wZXJ0aWVzW2VdPXQsdGhpcy50cmlnZ2VyKCJjaGFuZ2U6IitlLHRoaXMsdCkpfSx0aGlzKX0sdGhpcyksdGhpcy5vbigic3luYyIsZnVuY3Rpb24oKXt0aGlzLl9fc3luY2VkRGF0YT10aGlzLnRvSlNPTigpfSx0aGlzKX0sdmFsaWRhdGU6ZnVuY3Rpb24oKXt9LGFsbG93czpmdW5jdGlvbihlKXt2YXIgaT10aGlzLl9fc2NoZW1hX18sbj10LmV4dGVuZCh7fSxpLnByb3BzLGkubG9jYWwpO3JldHVybiEhdC5oYXMobixlKXx8ISFhLmNhbGwodGhpcyxpLmV4dHJhUHJvcGVydGllcyxlKX0sZ2V0UHJvcGVydHlTY2hlbWE6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5fX3NjaGVtYV9fO3JldHVybiB0LnJlZHVjZShbaS5wcm9wcyxpLmxvY2FsXSxmdW5jdGlvbih0LGkpe3JldHVybiB0fHxzKGlbZV0sZSl9LG51bGwpfSxzZXQ6ZnVuY3Rpb24oaSxuKXt2YXIgcjsib2JqZWN0Ij09dHlwZW9mIGk/cj1pOihyPXt9KVtpXT1uLHQuZWFjaChyLGZ1bmN0aW9uKGUsaSl7aWYodC5oYXModGhpcy5fX3NjaGVtYV9fLmRlcml2ZWQsaSkpdGhyb3cib3ZlcnJpZGluZyBkZXJpdmVkIHByb3BlcnRpZXMgaXMgbm90IHN1cHBvcnRlZDogIitpfSx0aGlzKTt2YXIgcz1bXTtpZih0LmVhY2gocixmdW5jdGlvbih0LGUpe3RoaXMuYWxsb3dzKGUpfHxzLnB1c2goZSl9LHRoaXMpLHMubGVuZ3RoKXRocm93ImZpZWxkIG5vdCBhbGxvd2VkOiAiK3Muam9pbigiLCAiKTtyZXR1cm4gZS5Nb2RlbC5wcm90b3R5cGUuc2V0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0OmZ1bmN0aW9uKGkpe3ZhciBuPXRoaXMuX19zY2hlbWFfXztyZXR1cm4gdC5oYXMobi5kZXJpdmVkLGkpP24uZGVyaXZlZFtpXS5jYWNoZSE9PSExP24uY29tcHV0ZWRQcm9wZXJ0aWVzW2ldOnRoaXMuX19nZXREZXJpdmVkVmFsdWUoaSk6ZS5Nb2RlbC5wcm90b3R5cGUuZ2V0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdG9KU09OOmZ1bmN0aW9uKGkpe2l8fChpPXt9KTt2YXIgcj10LmNsb25lKGUuTW9kZWwucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cykpLHM9dGhpcy5fX3NjaGVtYV9fO3JldHVybiBpLnZlcmJvc2U/dC5lYWNoKHMuZGVyaXZlZCxmdW5jdGlvbih0LGUpe3JbZV09dGhpcy5nZXQoZSl9LHRoaXMpOnI9dC5vbWl0KHIsdC5rZXlzKHMubG9jYWwpKSx0aGlzLmZsYXQmJihyPW4ocikpLHJ9LHJlc2V0OmZ1bmN0aW9uKGUpe3RoaXMuY2xlYXIoZSksdGhpcy5zZXQodC5yZXN1bHQodGhpcywiZGVmYXVsdHMiKSxlKX0saXNTeW5jZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5pc0VxdWFsKHRoaXMuX19zeW5jZWREYXRhLHRoaXMudG9KU09OKCkpfSx2YWxpZGF0ZUZpZWxkOmZ1bmN0aW9uKHQpe3ZhciBlPXQmJnRoaXMuZ2V0UHJvcGVydHlTY2hlbWEodCk7cmV0dXJuIGUmJmQoZSx0aGlzLmdldCh0KSl9LF92YWxpZGF0ZVNjaGVtYTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX19zY2hlbWFfXztyZXR1cm4gdC5yZWR1Y2UodC5leHRlbmQoe30sZS5wcm9wcyxlLmxvY2FsKSxmdW5jdGlvbihlLGksbil7cmV0dXJuIHQuZXh0ZW5kKGUsdGhpcy52YWxpZGF0ZUZpZWxkKG4pfHx7fSl9LHt9LHRoaXMpfSxfX2dldERlcml2ZWRWYWx1ZTpmdW5jdGlvbihlKXt2YXIgaT10aGlzLl9fc2NoZW1hX18uZGVyaXZlZFtlXTtpZih0LmlzU3RyaW5nKGkpKXt2YXIgbj1pO2k9e2RlcHM6W25dLGZuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KG4pfX19dmFyIHI9aS5kZXBzfHxbXTtyZXR1cm4gaS5mbi5hcHBseSh0aGlzLHQubWFwKHIsdGhpcy5nZXQsdGhpcykpfX0se0VSUk9SX0JMQU5LOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmJsYW5rIixFUlJPUl9XUk9OR19UWVBFOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLndyb25nLnR5cGUiLEVSUk9SX05PVF9BTExPV0VEOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLnZhbHVlLm5vdC5hbGxvd2VkIixFUlJPUl9JTlZBTElEOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQiLEVSUk9SX0lBUlJBWV9VTklRVUU6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQuYXJyYXkudW5pcXVlIixFUlJPUl9JTlZBTElEX0ZPUk1BVF9FTUFJTDoibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkLmZvcm1hdC5lbWFpbCIsRVJST1JfSU5WQUxJRF9GT1JNQVRfVVJJOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0LnVyaSIsRVJST1JfSU5WQUxJRF9GT1JNQVRfSVBWNDoibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkLmZvcm1hdC5pcHY0IixFUlJPUl9JTlZBTElEX0ZPUk1BVF9IT1NUTkFNRToibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkLmZvcm1hdC5ob3N0bmFtZSIsRVJST1JfU1RSSU5HX1NUUklOR19NSU5fTEVOR1RIOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLnN0cmluZy5taW5MZW5ndGgiLEVSUk9SX1NUUklOR19TVFJJTkdfTUFYX0xFTkdUSDoibW9kZWwudmFsaWRhdGlvbi5maWVsZC5zdHJpbmcubWF4TGVuZ3RoIn0pfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxMzYpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9ZnVuY3Rpb24oZSl7dmFyIGk9dC5vbWl0KGUubG9jYWwsdC5rZXlzKGUuX2J1aWx0SW5Mb2NhbFByb3BzKSk7cmV0dXJuIHQuc2l6ZShlLnByb3BzKSt0LnNpemUoaSk+MH0sbj1lLmV4dGVuZCh7ZmxhdDohMSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMub24oInN5bmMiLHRoaXMuX3NldFN5bmNlZCl9LGFsbG93czpmdW5jdGlvbigpe3JldHVybiFpKHRoaXMpfHxlLnByb3RvdHlwZS5hbGxvd3MuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXQ6ZnVuY3Rpb24oaSxuKXt2YXIgcjtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIGk/cj1pOihyPXt9KVtpXT1uLHQocikuZWFjaChmdW5jdGlvbihlLGkpe2UmJnQuaXNBcnJheShlLl9fYXR0cmlidXRlcykmJnRoaXMub24oImNoYW5nZToiK2UuX19hdHRyaWJ1dGVzLmpvaW4oIiBjaGFuZ2U6IiksZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldChpKTt0IT09dGhpcy5fX3NjaGVtYV9fLmNvbXB1dGVkUHJvcGVydGllc1tpXSYmKHRoaXMuX19zY2hlbWFfXy5jb21wdXRlZFByb3BlcnRpZXNbaV09dCx0aGlzLnRyaWdnZXIoImNoYW5nZToiK2ksdCkpfSx0aGlzKX0sdGhpcyksZS5wcm90b3R5cGUuc2V0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0OmZ1bmN0aW9uKCl7dmFyIGk9ZS5wcm90b3R5cGUuZ2V0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdC5pc0Z1bmN0aW9uKGkpP2kuYXBwbHkodGhpcyx0Lm1hcChpLl9fYXR0cmlidXRlc3x8W10sdGhpcy5nZXQsdGhpcykpOml9LHRvSlNPTjpmdW5jdGlvbihpKXtpfHwoaT17fSk7dmFyIG49ZS5wcm90b3R5cGUudG9KU09OLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdChuKS5lYWNoKGZ1bmN0aW9uKHQsZSl7ImZ1bmN0aW9uIj09dHlwZW9mIHQmJihpLnZlcmJvc2U/bltlXT10aGlzLmdldChlKTpkZWxldGUgbltlXSl9LHRoaXMpLGkudmVyYm9zZXx8dChuKS5lYWNoKGZ1bmN0aW9uKHQsZSl7L15fX1x3K19fJC8udGVzdChlKSYmZGVsZXRlIG5bZV19KSxufSxzYW5pdGl6ZUF0dHJpYnV0ZXM6ZnVuY3Rpb24oZSl7dmFyIGk9e307cmV0dXJuIHQuZWFjaChlLGZ1bmN0aW9uKGUsbil7dC5pc0Z1bmN0aW9uKGUpfHwoaVtuXT1lKX0pLGl9LHJlc2V0OmZ1bmN0aW9uKHQpe3RoaXMuY2xlYXIodCksdGhpcy5zZXQodGhpcy5zYW5pdGl6ZUF0dHJpYnV0ZXModGhpcy5kZWZhdWx0cyksdCl9LGNsZWFyOmZ1bmN0aW9uKGUpe3ZhciBpPXt9O3JldHVybiB0LmVhY2godGhpcy5zYW5pdGl6ZUF0dHJpYnV0ZXModGhpcy5hdHRyaWJ1dGVzKSxmdW5jdGlvbih0LGUpe2lbZV09dm9pZCAwfSksdGhpcy5zZXQoaSx0LmV4dGVuZCh7fSxlLHt1bnNldDohMH0pKX0sX3NldFN5bmNlZDpmdW5jdGlvbihlKXt0aGlzLl9zeW5jZWREYXRhPWUmJnQuaXNGdW5jdGlvbihlLnRvSlNPTik/ZS50b0pTT04oKTp7fX0sX2dldFN5bmNlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jZWREYXRhfSxpc1N5bmNlZDpmdW5jdGlvbigpe3JldHVybiB0LmlzRXF1YWwodGhpcy5fZ2V0U3luY2VkKCksdGhpcy50b0pTT04oKSl9fSx7Q29tcHV0ZWRQcm9wZXJ0eTpmdW5jdGlvbigpe3ZhciBlPXQudG9BcnJheShhcmd1bWVudHMpLGk9ZS5wb3AoKTtyZXR1cm4gaS5fX2F0dHJpYnV0ZXM9ZS5wb3AoKSxpfX0pO3JldHVybiBufS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbjtuPWZ1bmN0aW9uKCl7fS5jYWxsKGUsaSxlLHQpLCEodm9pZCAwIT09biYmKHQuZXhwb3J0cz1uKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQxKV0scj1mdW5jdGlvbih0KXtyZXR1cm57VGFibGVGYWN0b3J5OnR9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8sYSl7cj1baSgyKSxpKDE0MildLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKGUpe3JldHVybiB0Lm1hcChlLGZ1bmN0aW9uKGUpe3JldHVybiB0LmlzU3RyaW5nKGUpJiYoZT17bmFtZTplfSksIWUubmFtZSYmZS5maWVsZCYmKGU9dC5leHRlbmQoe25hbWU6ZS5maWVsZH0sZSkpLGV9KX1mdW5jdGlvbiBuKGUpe3ZhciBpPXt9O3JldHVybiB0LmVhY2goZXx8e30sZnVuY3Rpb24oZSxuKXtpW25dPWZ1bmN0aW9uKGkpe2kucHJldmVudERlZmF1bHQoKSxpLnN0b3BQcm9wYWdhdGlvbigpLHQuaXNGdW5jdGlvbihlKSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSx0aGlzKSxpfXJldHVybntjcmVhdGVIZWFkZXI6ZnVuY3Rpb24obil7cmV0dXJuIGUuZXh0ZW5kKHt0YWdOYW1lOiJ0aGVhZCIsdGVtcGxhdGU6Ijx0cj48L3RyPiIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3QuZWFjaChpKG4pLGZ1bmN0aW9uKHQpe3RoaXMuYWRkKGUuZXh0ZW5kKHtlbDonPHRoIHJvbGU9ImNvbHVtbmhlYWRlciI+PC90aD4nLGNoaWxkcmVuOnQuaGVhZGVyVmlldyYmW3QuaGVhZGVyVmlld10sdGVtcGxhdGU6dC5oZWFkZXJWaWV3P251bGw6dC5sYWJlbHx8IiZuYnNwOyJ9KSwidHIiKX0sdGhpcyl9fSl9LGNyZWF0ZVJvdzpmdW5jdGlvbihuKXt2YXIgcj10aGlzO3JldHVybiBlLmV4dGVuZCh7dGFnTmFtZToidGJvZHkiLHRlbXBsYXRlOic8dHIgcm9sZT0icm93Ij48L3RyPicsY2hpbGRyZW46dC5tYXAoaShuKSxmdW5jdGlvbih0KXtyZXR1cm5bci5jcmVhdGVDZWxsKHQpLCJ0ciJdfSl9KX0sY3JlYXRlQ2VsbDpmdW5jdGlvbihpKXt2YXIgcj10LmV4dGVuZCh0LnBpY2soaSwiY2xhc3NOYW1lIiwiYXR0cmlidXRlcyIsImluaXRpYWxpemUiKSx7dGFnTmFtZToidGQiLGV2ZW50czpuKGkuZXZlbnRzKSxjaGlsZHJlbjppLnZpZXcmJltpLnZpZXddLHRlbXBsYXRlOmkudmlldz9udWxsOmkudGVtcGxhdGV8fCJ7eyIraS5uYW1lKyJ9fSJ9KTtyZXR1cm4gZS5leHRlbmQocil9LF9fbm9ybWFsaXplRmllbGRzOmksX19jbGVhbkV2ZW50czpufX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOyFmdW5jdGlvbihvLGEpe3I9W2koMiksaSgzNSldLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7Zm9yKHZhciBpPTA7aTx0W29dLmxlbmd0aDtpKyspaWYoZS5jaWQ9PT10W29dW2ldLmNpZClyZXR1cm4gaX1mdW5jdGlvbiBuKCl7fWZ1bmN0aW9uIHIodCl7dFthXT0hMDt2YXIgZT10LnJlbmRlclRlbXBsYXRlKHQudGVtcGxhdGUpO2U/dC4kZWwuaHRtbChlKTp0Lmxlbmd0aCYmdC4kZWwuZW1wdHkoKSx0LmVhY2goZnVuY3Rpb24odCl7dFt1XSgpfSl9ZnVuY3Rpb24gcyhlKXt2YXIgaT0vXig/ISg/OmRlbGVnYXRlfHVuZGVsZWdhdGV8XykpKFthLXpBLVowLTldKykoPzpFdmVudHMpJC87dC5lYWNoKHQuYWxsS2V5cyhlKSxmdW5jdGlvbihuKXt2YXIgcj1uLm1hdGNoKGkpO2lmKHIpe3ZhciBzPXQucmVzdWx0KGUsbiksbz1lLm9wdGlvbnNbclsxXV18fGVbclsxXV07byYmdC5pc09iamVjdChzKSYmdC5pc0Z1bmN0aW9uKG8udHJpZ2dlcikmJnQuZWFjaChzLGZ1bmN0aW9uKGksbil7dmFyIHI9dC5pc0Z1bmN0aW9uKGkpP1tpXTp0LnJlZHVjZShpLnNwbGl0KC9ccysvKSxmdW5jdGlvbihpLG4pe3JldHVybiB0LmlzRnVuY3Rpb24oZVtuXSkmJmkucHVzaChlW25dKSxpfSxbXSk7dC5lYWNoKHIsZnVuY3Rpb24odCl7ZS5saXN0ZW5UbyhvLG4sdCl9KX0pfX0pfXZhciBvPSJfX2NoaWxkcmVuX18iLGE9Il9fcmVuZGVyZWRfXyIsbD0iX19wYXJlbnRfXyIsYz0iX19jaGlsZHJlbl9kZWZpbml0aW9uc19fIix1PSJfX2FkZF90b19jb250YWluZXJfXyIsZD1lLlZpZXcuZXh0ZW5kKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbihpKXt0aGlzLm9wdGlvbnM9aXx8e30sdC5leHRlbmQodGhpcyx0LnBpY2sodGhpcy5vcHRpb25zLCJzdGF0ZSIsInNldHRpbmdzIikpLHRoaXNbb109W10sdGhpc1thXT0hMSx0aGlzW2xdPW51bGwsdGhpc1tjXT10aGlzLmNoaWxkcmVuO3ZhciByPXRoaXMuaW5pdGlhbA==", "base64"));
  res.write(new Buffer("aXplO2lmKHRoaXMuaW5pdGlhbGl6ZT1uLGUuVmlldy5hcHBseSh0aGlzLGFyZ3VtZW50cyksdC5lYWNoKHQucmVzdWx0KHRoaXMsYyksZnVuY3Rpb24oZSl7dGhpcy5hZGQuYXBwbHkodGhpcyx0LmlzQXJyYXkoZSk/ZTpbZV0pfSx0aGlzKSxkZWxldGUgdGhpc1tjXSx0aGlzLmF1dG9SZW5kZXImJnRoaXMubW9kZWwpe3ZhciB1PXQuaXNBcnJheSh0aGlzLmF1dG9SZW5kZXIpP3QubWFwKHRoaXMuYXV0b1JlbmRlcixmdW5jdGlvbih0KXtyZXR1cm4iY2hhbmdlOiIrdH0pLmpvaW4oIiAiKToiY2hhbmdlIjt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsdSxmdW5jdGlvbigpe3RoaXMucmVuZGVyKCl9KX10aGlzLmluaXRpYWxpemU9cix0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHModGhpcyl9LHVucmVnaXN0ZXI6ZnVuY3Rpb24oZSl7dGhpcy5zdG9wTGlzdGVuaW5nKGUpO3ZhciBuPWkodGhpcyxlKTt0LmlzTnVtYmVyKG4pJiZ0aGlzW29dLnNwbGljZShuLDEpfSxhdXRvUmVuZGVyOiExLHRlbXBsYXRlOm51bGwsY2hpbGRyZW46W10sYWRkOmZ1bmN0aW9uKG4scixzLGEsYyl7dmFyIGg9e30scD10LnRvQXJyYXkoYXJndW1lbnRzKTtpZih0LmlzT2JqZWN0KHIpPyhoPXIscj1oLnNlbGVjdG9yLHM9aC5idWJibGUsYT1oLnByZXBlbmQsYz1oLm9wdGlvbnMpOnQuaXNPYmplY3QocykmJihoPXMscz1oLmJ1YmJsZSxhPWgucHJlcGVuZCxjPWgub3B0aW9ucyksdC5pc1N0cmluZyhuKSYmKG49ZnVuY3Rpb24odCl7cmV0dXJuIGQuZXh0ZW5kKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3RyeXt2YXIgaT1lLiQodCk7aWYoMSE9aS5sZW5ndGgpdGhyb3ciaW52YWxpZCBFbGVtZW50Ijt0aGlzLnRlbXBsYXRlPWkuaHRtbCgpLHRoaXMuZWw9aS5lbXB0eSgpWzBdfWNhdGNoKG4pe3RoaXMudGVtcGxhdGU9dH1kLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0obikpLG4ucHJvdG90eXBlJiZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIGQpe3ZhciBmPXQub21pdCh0LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMsYyksImVsIik7cmV0dXJuIHBbMF09bmV3IG4oZiksdGhpcy5hZGQuYXBwbHkodGhpcyxwKX1pZih0LmlzTnVtYmVyKGkodGhpcyxuKSkpdGhyb3cgbmV3IEVycm9yKCJEdXBsaWNhdGUgY2hpbGQiKTtyZXR1cm4gbltsXT10aGlzLG5bdV09ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7aWYodCYmMSE9bltsXS4kKHQpLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgc2VsZWN0b3I6ICIrdCk7dmFyIGU9dD90aGlzW2xdLiQodCk6dGhpc1tsXS4kZWw7dGhpcy5yZW5kZXIoKSx0aGlzLmRlbGVnYXRlRXZlbnRzKCksYT9lLnByZXBlbmQodGhpcy5lbCk6ZS5hcHBlbmQodGhpcy5lbCl9fS5jYWxsKG4scikscyYmdGhpcy5saXN0ZW5UbyhuLCJhbGwiLGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLHRoaXMucmVuZGVyZWQoKSYmblt1XSgpLHRoaXNbb10ucHVzaChuKSx0aGlzfSxyZW1vdmVDaGlsZHJlbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24odCl7dC5yZW1vdmUoKX0pLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW92ZUNoaWxkcmVuKCksdGhpc1tsXSYmdGhpc1tsXS51bnJlZ2lzdGVyKHRoaXMpLGUuVmlldy5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sY29tcGlsZVRlbXBsYXRlOmZ1bmN0aW9uKGUpe3JldHVybiB0LnRlbXBsYXRlKGUpfSxyZW5kZXJUZW1wbGF0ZTpmdW5jdGlvbihlKXtpZih0LmlzU3RyaW5nKGUpJiYoZT10aGlzLmNvbXBpbGVUZW1wbGF0ZShlKSksdC5pc0Z1bmN0aW9uKGUpKXJldHVybiBlKHRoaXMuZ2V0VGVtcGxhdGVEYXRhKCkpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm1vZGVsJiZ0aGlzLm1vZGVsLnRvSlNPTih7dmVyYm9zZTohMH0pfHx7fSxpPXQub21pdCh0aGlzLm9wdGlvbnMsWyJzdGF0ZSIsInNldHRpbmdzIiwibW9kZWwiLCJjb2xsZWN0aW9uIl0pO3JldHVybiB0LmRlZmF1bHRzKHt9LGUsaSl9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZVJlbmRlcigpLHIodGhpcyksdGhpcy5wb3N0UmVuZGVyKCksdGhpc30scHJlUmVuZGVyOm4scG9zdFJlbmRlcjpuLHJlbmRlcmVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbYV19LGdldENoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9BcnJheSgpfSxhdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRDaGlsZHJlbigpW3RdfSxpbnZva2U6ZnVuY3Rpb24oZSl7dmFyIGk9dC50b0FycmF5KGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihuKXtuLnNpemUoKSYmbi5pbnZva2UuYXBwbHkobixpKSx0LmlzRnVuY3Rpb24obltlXSkmJm5bZV0uYXBwbHkobixpLnNsaWNlKDEpKX0pLHRoaXN9fSksaD1bImVhY2giLCJtYXAiLCJyZWR1Y2UiLCJyZWR1Y2VSaWdodCIsImZpbmQiLCJmaWx0ZXIiLCJyZWplY3QiLCJldmVyeSIsInNvbWUiLCJjb250YWlucyIsInRvQXJyYXkiLCJzaXplIiwiZmlyc3QiLCJpbml0aWFsIiwicmVzdCIsImxhc3QiLCJ3aXRob3V0IiwiaW5kZXhPZiIsInNodWZmbGUiLCJsYXN0SW5kZXhPZiIsImlzRW1wdHkiLCJjaGFpbiIsIndoZXJlIiwiZmluZFdoZXJlIl07cmV0dXJuIHQuZWFjaChoLGZ1bmN0aW9uKGUpe2QucHJvdG90eXBlW2VdPWZ1bmN0aW9uKCl7dmFyIGk9dC50b0FycmF5KGFyZ3VtZW50cyk7cmV0dXJuIGkudW5zaGlmdCh0LnRvQXJyYXkodGhpc1tvXSkpLHRbZV0uYXBwbHkodCxpKX19LHRoaXMpLGR9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDUpLGkoMTUwKSxpKDE1MiksaSgxNTMpLGkoMTU2KSxpKDE1NyksaSgxNjUpLGkoMTY3KSxpKDE2OCksaSgxNjkpLGkoMTcwKSxpKDE3MiksaSgxNzMpLGkoMTQ0KSxpKDE3NCksaSgxNzUpLGkoMTc2KSxpKDE0OSksaSgxNDgpLGkoMTc3KSxpKDE4MyksaSgxNDcpLGkoMTg3KSxpKDE4OCksaSgxODkpLGkoMTkwKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjLHUsZCxoLHAsZixtLF8sZyx2LHksYix3LE0sayxULFMpe3JldHVybntCYXNlQ29udHJvbGxlcjp0LEJhc2VSb3V0ZXI6ZSxCYXRjaEFqYXhVdGlsOmksQnV0dG9uRmFjdG9yeTpuLENsYXNzOnIsQ2xpcGJvYXJkOnMsQ29va2llOm8sRGF0YUxpc3RDb250cm9sbGVyOmEsRXJyb3JQYXJzZXI6bCxFdmVudHM6Yyxmb3JtYXRYbWw6dSxGeDpkLEtleXM6aCxMb2dnZXI6cCxNZXRyaWNzOmYsTnVtYmVyVXRpbDptLFNjaGVtYVV0aWw6XyxTZXR0aW5nc01vZGVsOmcsU3RhdGVNYWNoaW5lOnYsU3RyaW5nVXRpbDp5LFRhYmJlZFJvdXRlcjpiLFRlbXBsYXRlVXRpbDp3LFRpbWU6TSxUaW1lVXRpbDprLFRpbWV6b25lVXRpbDpULFV0aWw6U319LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuO249ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7d2luZG93LmNvbnNvbGUmJndpbmRvdy5jb25zb2xlW3RdLmFwcGx5KHdpbmRvdy5jb25zb2xlLGUpfXJldHVybnt0cmFjZTpmdW5jdGlvbigpe3JldHVybiB0KCJ0cmFjZSIsYXJndW1lbnRzKX0sZGlyOmZ1bmN0aW9uKCl7cmV0dXJuIHQoImRpciIsYXJndW1lbnRzKX0sdGltZTpmdW5jdGlvbigpe3JldHVybiB0KCJ0aW1lIixhcmd1bWVudHMpfSx0aW1lRW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHQoInRpbWVFbmQiLGFyZ3VtZW50cyl9LGdyb3VwOmZ1bmN0aW9uKCl7cmV0dXJuIHQoImdyb3VwIixhcmd1bWVudHMpfSxncm91cEVuZDpmdW5jdGlvbigpe3JldHVybiB0KCJncm91cEVuZCIsYXJndW1lbnRzKX0sYXNzZXJ0OmZ1bmN0aW9uKCl7cmV0dXJuIHQoImFzc2VydCIsYXJndW1lbnRzKX0sbG9nOmZ1bmN0aW9uKCl7cmV0dXJuIHQoImxvZyIsYXJndW1lbnRzKX0saW5mbzpmdW5jdGlvbigpe3JldHVybiB0KCJpbmZvIixhcmd1bWVudHMpfSx3YXJuOmZ1bmN0aW9uKCl7cmV0dXJuIHQoIndhcm4iLGFyZ3VtZW50cyl9LGVycm9yOmZ1bmN0aW9uKCl7cmV0dXJuIHQoImVycm9yIixhcmd1bWVudHMpfX19LmNhbGwoZSxpLGUsdCksISh2b2lkIDAhPT1uJiYodC5leHBvcnRzPW4pKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTQ2KSxpKDE0OCksaSgxNDkpLGkoMTUwKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyl7ZnVuY3Rpb24gbyh0KXt2YXIgaT17fTtyZXR1cm4gZS5lYWNoKHQsZnVuY3Rpb24odCxuKXtlLmlzTnVsbCh0KXx8KGlbbl09dCl9KSxpfXJldHVybiBpLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24odCl7dHx8KHQ9e30pO3ZhciBhPWUuZGVmYXVsdHMobyh0LnN0YXRlKSx0aGlzLnN0YXRlfHx7fSk7dGhpcy5zdGF0ZT1uZXcgbihhKSxkZWxldGUgdC5zdGF0ZSx0LnNldHRpbmdzP3RoaXMuc2V0dGluZ3M9dC5zZXR0aW5nczoodGhpcy5zZXR0aW5ncz10LnNldHRpbmdzPW5ldyByKGUub21pdCh0fHx7fSwiZWwiKSksdGhpcy5saXN0ZW4oIm5vdGlmaWNhdGlvbiIscy5wcm90b3R5cGUuX25vdGlmeSksdGhpcy5saXN0ZW4oImNvbmZpcm1hdGlvbiIscy5wcm90b3R5cGUuX2NvbmZpcm0pKSxpLmNhbGwodGhpcyx0KSx0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsIl9faW52b2tlX18iLGZ1bmN0aW9uKCl7dmFyIHQ9ZS50b0FycmF5KGFyZ3VtZW50cyksaT10LnNoaWZ0KCk7ZS5pc0Z1bmN0aW9uKHRoaXNbaV0pJiZ0aGlzW2ldLmFwcGx5KHRoaXMsdCl9KSx0aGlzLlZpZXcmJnRoaXMuYWRkKG5ldyB0aGlzLlZpZXcodGhpcy50b0pTT04oKSkpfSxzdGF0ZTp7fSxWaWV3Om51bGwscmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGU9YXJndW1lbnRzLG49dGhpcztyZXR1cm4gdChmdW5jdGlvbigpe2kucHJvdG90eXBlLnJlbmRlci5hcHBseShuLGUpfSksdGhpc30sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiBlLmV4dGVuZChlLnBpY2sodGhpcywic3RhdGUiLCJzZXR0aW5ncyIsImNvbGxlY3Rpb24iLCJtb2RlbCIpLHR8fHt9KX0scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGRyZW4oKSx0aGlzLnN0b3BMaXN0ZW5pbmcoKSx0aGlzLiRlbC5lbXB0eSgpLHRoaXN9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDM1KSxpKDE0NyksaSgxNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuY2xvbmUoZS5FdmVudHMpLHM9e2NvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5tb2R1bGUmJnRoaXMuJGVsLmF0dHIoImRhdGEtdmlldyIsdGhpcy5tb2R1bGUuaWQpfSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW92ZUNoaWxkcmVuKCl9LGNvbXBpbGVUZW1wbGF0ZTppLnRwbCxicm9hZGNhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gci50cmlnZ2VyLmFwcGx5KHIsYXJndW1lbnRzKSx0aGlzfSxsaXN0ZW46ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5saXN0ZW5UbyhyLHQsZSksdGhpc30sbm90aWZ5OmZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gdGhpcy5icm9hZGNhc3QoIm5vdGlmaWNhdGlvbiIsdC5kZWZhdWx0cyh7bWVzc2FnZTppLGxldmVsOmV9LG4pKSx0aGlzfSxjb25maXJtOmZ1bmN0aW9uKGUsaSxuLHIpe3ZhciBzO3JldHVybiBzPSJvYmplY3QiPT10eXBlb2YgZT9lOjI9PWFyZ3VtZW50cy5sZW5ndGgmJnQuaXNGdW5jdGlvbihpKT97dGl0bGU6Ik9rdGEiLHN1YnRpdGxlOmUsb2s6aX06e3RpdGxlOmUsc3VidGl0bGU6aSxvazpuLGNhbmNlbEZuOnJ9LHQuaXNGdW5jdGlvbihzLm9rKSYmKHMub2s9dC5iaW5kKHMub2ssdGhpcykpLHQuaXNGdW5jdGlvbihzLmNhbmNlbEZuKSYmKHMuY2FuY2VsRm49dC5iaW5kKHMuY2FuY2VsRm4sdGhpcykpLHRoaXMuYnJvYWRjYXN0KCJjb25maXJtYXRpb24iLHMpLHRoaXN9LGFsZXJ0OmZ1bmN0aW9uKGUpe3JldHVybiB0LmlzU3RyaW5nKGUpJiYoZT17c3VidGl0bGU6ZX0pLHRoaXMuY29uZmlybSh0LmV4dGVuZCh7fSxlLHtub0NhbmNlbEJ1dHRvbjohMH0pKSx0aGlzfX07cmV0dXJuIG4uZXh0ZW5kKHMse2RlY29yYXRlOmZ1bmN0aW9uKGUpe3ZhciBpPWUuZXh0ZW5kKHt9KTtyZXR1cm4gdC5kZWZhdWx0cyhpLnByb3RvdHlwZSxzKSxpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSg0KV0scj1mdW5jdGlvbih0LGUpe3JldHVybnt0cGw6dC5tZW1vaXplKGZ1bmN0aW9uKHQpe3JldHVybiBlLmNvbXBpbGUodCl9KX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDEzNildLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe2V4dHJhUHJvcGVydGllczohMCxpbnZva2U6ZnVuY3Rpb24oKXt2YXIgZT10LnRvQXJyYXkoYXJndW1lbnRzKTtlLnVuc2hpZnQoIl9faW52b2tlX18iKSx0aGlzLnRyaWdnZXIuYXBwbHkodGhpcyxlKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTM2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7bG9jYWw6ZnVuY3Rpb24oKXt2YXIgdD13aW5kb3cub2t0YSYmd2luZG93Lm9rdGEuc2V0dGluZ3N8fHt9O3JldHVybntvcmdJZDpbInN0cmluZyIsITEsdC5vcmdJZF0sb3JnTmFtZTpbInN0cmluZyIsITEsdC5vcmdOYW1lXSxpc1ByZXZpZXc6WyJib29sZWFuIiwhMSx0LmlzUHJldmlld10sc2VydmVyU3RhdHVzOlsic3RyaW5nIiwhMSx0LnNlcnZlclN0YXR1c10scGVybWlzc2lvbnM6WyJhcnJheSIsITAsdC5wZXJtaXNzaW9uc3x8W11dfX0sZXh0cmFQcm9wZXJ0aWVzOiEwLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5mZWF0dXJlcz13aW5kb3cuX2ZlYXR1cmVzfHxbXSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0saGFzRmVhdHVyZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5jb250YWlucyh0aGlzLmZlYXR1cmVzLGUpfSxoYXNBbnlGZWF0dXJlOmZ1bmN0aW9uKGUpe3JldHVybiB0LnNvbWUoZSx0aGlzLmhhc0ZlYXR1cmUsdGhpcyl9LGhhc1Blcm1pc3Npb246ZnVuY3Rpb24oZSl7cmV0dXJuIHQuY29udGFpbnModGhpcy5nZXQoInBlcm1pc3Npb25zIiksZSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMzUpLGkoMTQ5KSxpKDE1MSksaSgxMzkpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXtyZXR1cm4gaS5Sb3V0ZXIuZXh0ZW5kKHtsaXN0ZW46ci5wcm90b3R5cGUubGlzdGVuLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KSx0aGlzLmVsPXQuZWwsdGhpcy5zZXR0aW5ncz1uZXcgbihlLm9taXQodCwiZWwiKSksaS5Sb3V0ZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGlzdGVuKCJub3RpZmljYXRpb24iLHRoaXMuX25vdGlmeSksdGhpcy5saXN0ZW4oImNvbmZpcm1hdGlvbiIsdGhpcy5fY29uZmlybSl9LF9jb25maXJtOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KTt2YXIgaT1zLmV4dGVuZChlLnBpY2sodCwidGl0bGUiLCJzdWJ0aXRsZSIsInNhdmUiLCJvayIsImNhbmNlbCIsImNhbmNlbEZuIiwibm9DYW5jZWxCdXR0b24iLCJjb250ZW50IiwiZGFuZ2VyIikpLG49bmV3IGkoe21vZGVsOnRoaXMuc2V0dGluZ3N9KTtyZXR1cm4gbi5yZW5kZXIoKSxufSxfbm90aWZ5OmZ1bmN0aW9uKGUpe3ZhciBpPW5ldyByKGUpO3JldHVybiB0KCIjY29udGVudCIpLnByZXBlbmQoaS5yZW5kZXIoKS5lbCksaX0scmVuZGVyOmZ1bmN0aW9uKHQsaSl7dGhpcy5jb250cm9sbGVyJiYodGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29udHJvbGxlciksdGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29udHJvbGxlci5zdGF0ZSksdGhpcy5jb250cm9sbGVyLnJlbW92ZSgpKSxpPWUuZXh0ZW5kKGUucGljayh0aGlzLCJzZXR0aW5ncyIsImVsIiksaXx8e30pLHRoaXMuY29udHJvbGxlcj1uZXcgdChpKSx0aGlzLmNvbnRyb2xsZXIucmVuZGVyKCl9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIGU9YXJndW1lbnRzO3QoZnVuY3Rpb24oKXtpLmhpc3Rvcnkuc3RhcnQuYXBwbHkoaS5oaXN0b3J5LGUpfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49e2xldmVsOiJzdWNjZXNzIixtZXNzYWdlOiJHcmVhdCBTdWNjZXNzISIsaGlkZTohMCxmYWRlOjQwMCxkZWxheTozZTMsd2lkdGg6MCxkaXNtaXNzYWJsZTohMX07cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImluZm9ib3ggaW5mb2JveC1jb25maXJtIGluZm9ib3gtY29uZmlybS1maXhlZCIsZXZlbnRzOnsiY2xpY2sgLmluZm9ib3gtZGlzbWlzcy1saW5rIjoiZmFkZU91dCJ9LHRlbXBsYXRlOidcdCAgICAgIHt7I2lmIGRpc21pc3NhYmxlfX1cdCAgICAgIDxhIGNsYXNzPSJpbmZvYm94LWRpc21pc3MtbGluayIgdGl0bGU9IkRpc21pc3MiIGhyZWY9IiMiPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iZGlzbWlzcy1pY29uIj48L3NwYW4+XHQgICAgICA8L2E+XHQgICAgICB7ey9pZn19XHQgICAgICA8c3BhbiBjbGFzcz0iaWNvbiB7e2xldmVsfX0tMTYiPjwvc3Bhbj5cdCAgICAgIHt7I2lmIHRpdGxlfX08aDM+e3t0aXRsZX19PC9oMz57ey9pZn19XHQgICAgICA8cD57e21lc3NhZ2V9fTwvcD5cdCAgICAnLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnM9ZS5kZWZhdWx0cyh7fSx0aGlzLm9wdGlvbnMsbiksdGhpcy4kZWwuYWRkQ2xhc3MoImluZm9ib3gtIit0aGlzLm9wdGlvbnMubGV2ZWwpLHRoaXMub3B0aW9ucy53aWR0aCYmdGhpcy4kZWwud2lkdGgodGhpcy5vcHRpb25zLndpZHRoKS5jc3MoeyJtYXJnaW4tbGVmdCI6IjBweCIsbGVmdDpNYXRoLnJvdW5kKCh0KHdpbmRvdykud2lkdGgoKS10aGlzLm9wdGlvbnMud2lkdGgpLzIpfSl9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3JldHVybiBlLmV4dGVuZChlLnBpY2sodGhpcy5vcHRpb25zLCJsZXZlbCIsIm1lc3NhZ2UiLCJ0aXRsZSIpLHtkaXNtaXNzYWJsZTp0aGlzLm9wdGlvbnMuaGlkZT09PSExfHx0aGlzLm9wdGlvbnMuZGlzbWlzc2FibGU9PT0hMH0pfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmhpZGUmJmUuZGVsYXkoZS5iaW5kKHRoaXMuZmFkZU91dCx0aGlzKSx0aGlzLm9wdGlvbnMuZGVsYXkpfSxmYWRlT3V0OmZ1bmN0aW9uKCl7dGhpcy4kZWwuZmFkZU91dCh0aGlzLm9wdGlvbnMuZmFkZSxlLmJpbmQodGhpcy5yZW1vdmUsdGhpcykpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXtxdWVyeUJ1aWxkRm46ZS5ub29wLGJhdGNoU2l6ZToyMH07cmV0dXJue2dldEJ5SWRzOmZ1bmN0aW9uKG4pe3ZhciByPWUuZGVmYXVsdHMoe30sbixpKSxzPXIuaWRzO2lmKCFlLmlzU3RyaW5nKHIudXJsKSl0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGluZyBhbiBzdHJpbmcgVVJMIGJ1dCBnZXQ6ICIrci51cmwpO2lmKCFlLmlzQXJyYXkocyl8fGUuaXNFbXB0eShzKSl0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGluZyBhbiBsaXN0IG9mIElEcyBidXQgZ2V0OiAiK3MpO2lmKCFlLmlzTnVtYmVyKHIuYmF0Y2hTaXplKXx8MD09PXIuYmF0Y2hTaXplfHxzLmxlbmd0aDw9ci5iYXRjaFNpemUpcmV0dXJuIHQuZ2V0KHIudXJsLHIucXVlcnlCdWlsZEZuKHMpKTt2YXIgbz1lLmNoYWluKHMpLmdyb3VwQnkoZnVuY3Rpb24odCxlKXtyZXR1cm4gTWF0aC5mbG9vcihlL3IuYmF0Y2hTaXplKX0pLnZhbHVlcygpLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gdC5nZXQoci51cmwsci5xdWVyeUJ1aWxkRm4oZSkpfSx0aGlzKS52YWx1ZSgpO3JldHVybiB0LndoZW4uYXBwbHkodCxvKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGUuY2hhaW4oYXJndW1lbnRzKS5tYXAoZS5maXJzdCkuZmxhdHRlbigpLnZhbHVlKCl9KX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNTQpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShlKXt2YXIgaT10LmV4dGVuZChlLmNsaWNrP3tjbGljazplLmNsaWNrfTp7fSxlLmV2ZW50c3x8e30pLG49e307cmV0dXJuIHQuZWFjaChpLGZ1bmN0aW9uKHQsaSl7bltpXT1mdW5jdGlvbihpKXtlLmhyZWZ8fChpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wUHJvcGFnYXRpb24oKSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSksbn1yZXR1cm57Y3JlYXRlOmZ1bmN0aW9uKG4pe3JldHVybiBuPXQuY2xvbmUobiksZS5leHRlbmQodC5leHRlbmQobix7ZXZlbnRzOmkobil9KSl9fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KSxpKDE1NSldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXtjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKX19O3JldHVybiBlLmV4dGVuZCh7dGFnTmFtZToiYSIsdGVtcGxhdGU6J3t7I2lmIGljb259fTxzcGFuIGNsYXNzPSJpY29uIHt7aWNvbn19Ij48L3NwYW4+e3svaWZ9fXt7I2lmIHRpdGxlfX17e3RpdGxlfX17ey9pZn19Jyx2aXNpYmxlOiEwLGVuYWJsZWQ6ITAsZW5hYmxlV2hlbjp7fSxzaG93V2hlbjp7fSwKCWNvbnN0cnVjdG9yOmZ1bmN0aW9uKHQpe3RoaXMub3B0aW9ucz10fHx7fTt2YXIgaT10aGlzLmdldFRlbXBsYXRlRGF0YSgpO3RoaXMuZGlzYWJsZWQ9ITEsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3MoImxpbmstYnV0dG9uIiksaS5pY29uJiYodGhpcy4kZWwuYWRkQ2xhc3MoImxpbmstYnV0dG9uLWljb24iKSxpLnRpdGxlfHx0aGlzLiRlbC5hZGRDbGFzcygiaWNvbi1vbmx5IikpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm57aHJlZjp0aGlzLl9fZ2V0QXR0cmlidXRlKCJocmVmIiksdGl0bGU6dGhpcy5fX2dldEF0dHJpYnV0ZSgidGl0bGUiKSxpY29uOnRoaXMuX19nZXRBdHRyaWJ1dGUoImljb24iKX19LGluaXRpYWxpemU6ZnVuY3Rpb24oKXtpLmFwcGx5RG9XaGVuKHRoaXMsdC5yZXN1bHRDdHgodGhpcywiZW5hYmxlV2hlbiIsdGhpcyksdGhpcy50b2dnbGUpLGkuYXBwbHlEb1doZW4odGhpcyx0LnJlc3VsdEN0eCh0aGlzLCJzaG93V2hlbiIsdGhpcyksdGhpcy50b2dnbGVWaXNpYmxlKX0scmVuZGVyOmZ1bmN0aW9uKCl7ZS5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0LnJlc3VsdCh0aGlzLCJlbmFibGVkIil8fHRoaXMudG9nZ2xlKCExKSx0LnJlc3VsdCh0aGlzLCJ2aXNpYmxlIil8fHRoaXMudG9nZ2xlVmlzaWJsZSghMSk7dmFyIGk9dGhpcy5nZXRUZW1wbGF0ZURhdGEoKTtyZXR1cm4gdGhpcy4kZWwuYXR0cigiaHJlZiIsaS5ocmVmfHwiIyIpLHRoaXN9LF9fZ2V0QXR0cmlidXRlOmZ1bmN0aW9uKGUsaSl7dmFyIG49dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLGUsdGhpcyk7cmV0dXJuIHQuaXNVbmRlZmluZWQobikmJihuPXQucmVzdWx0KHRoaXMsZSkpLHQuaXNVbmRlZmluZWQobik/aTpufSxlbmFibGU6ZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZSghMCl9LGRpc2FibGU6ZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZSghMSl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZVZpc2libGUoITApfSxoaWRlOmZ1bmN0aW9uKCl7dGhpcy50b2dnbGVWaXNpYmxlKCExKX0sdG9nZ2xlOmZ1bmN0aW9uKGUpe3ZhciBpPSEhZSYmdC5yZXN1bHQodGhpcywiZW5hYmxlZCIpO3RoaXMuZGlzYWJsZWQ9IWksdGhpcy4kZWwudG9nZ2xlQ2xhc3MoImxpbmstYnV0dG9uLWRpc2FibGVkIGJ0bi1kaXNhYmxlZCBkaXNhYmxlZCIsdGhpcy5kaXNhYmxlZCksdC5kZWZlcih0LmJpbmQoZnVuY3Rpb24oKXt0aGlzLmRlbGVnYXRlRXZlbnRzKHRoaXMuZGlzYWJsZWQ/bjpudWxsKX0sdGhpcykpfSx0b2dnbGVWaXNpYmxlOmZ1bmN0aW9uKGUpe3ZhciBpPSFlfHwhdC5yZXN1bHQodGhpcywidmlzaWJsZSIpO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCJoaWRlIixpKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpXSxyPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSl7cmV0dXJuImNoYW5nZToiK3Qua2V5cyhlKS5qb2luKCIgY2hhbmdlOiIpfWZ1bmN0aW9uIGkoZSxpKXt2YXIgbj10aGlzLm1vZGVsLmdldChpKTtyZXR1cm4gdC5pc0Z1bmN0aW9uKGUpP2UuY2FsbCh0aGlzLG4pOmU9PW59ZnVuY3Rpb24gbihpLG4scil7dmFyIHM9dC5iaW5kKHIsaSxpLG4pO2kucmVuZGVyPXQud3JhcChpLnJlbmRlcixmdW5jdGlvbih0KXt2YXIgZT10LmNhbGwoaSk7cmV0dXJuIHMoe2FuaW1hdGU6ITF9KSxlfSksaS5saXN0ZW5UbyhpLm1vZGVsLGUobiksZnVuY3Rpb24oKXtzKHthbmltYXRlOiEwfSl9KX1yZXR1cm57YXBwbHlEb1doZW46ZnVuY3Rpb24oZSxyLHMpe2UubW9kZWwmJnQuaXNPYmplY3QocikmJnQuc2l6ZShyKSYmdC5pc0Z1bmN0aW9uKHMpJiZuKGUscixmdW5jdGlvbihlLG4scil7dmFyIG89dC5ldmVyeSh0Lm1hcChuLGksZSkpO3MuY2FsbChlLG8scil9KX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgzNSldLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKGUpe3RoaXMub3B0aW9ucz10LmNsb25lKGV8fHt9KSx0aGlzLmNpZD10LnVuaXF1ZUlkKCJjbGFzcyIpLHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIHQuZXh0ZW5kKGkucHJvdG90eXBlLGUuRXZlbnRzLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7fX0pLGkuZXh0ZW5kPWUuTW9kZWwuZXh0ZW5kLGl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTU2KSxpKDE1OCksaSgxNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9bixvPVsic3VjY2VzcyIsImVycm9yIiwidGFyZ2V0IiwidGV4dCJdLGE9aS5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oaSxuKXtuPWUucGljayhufHx7fSxvKTt2YXIgYSxsLGM7ZS5pc1N0cmluZyhpKSYmKGE9aSksZS5pc0VsZW1lbnQoaSkmJihhPWkpLGkgaW5zdGFuY2VvZiB0JiYoYT1pLnNlbGVjdG9yKSxpIGluc3RhbmNlb2YgciYmKGE9aS5lbCksZS5pc0Z1bmN0aW9uKG4udGFyZ2V0KSYmKGw9bi50YXJnZXQpLGUuaXNFbGVtZW50KG4udGFyZ2V0KSYmKGw9ZS5jb25zdGFudChuLnRhcmdldCkpLGUuaXNTdHJpbmcobi50ZXh0KT9jPWUuY29uc3RhbnQobi50ZXh0KTplLmlzRnVuY3Rpb24obi50ZXh0KSYmKGM9bi50ZXh0KSx0aGlzLl9faW5zdGFuY2U9bmV3IHMoYSx7dGFyZ2V0OmwsdGV4dDpjfSksdGhpcy5kb25lPWUucGFydGlhbCh0aGlzLl9fc2V0Q2FsbGJhY2ssInN1Y2Nlc3MiKSx0aGlzLmVycm9yPWUucGFydGlhbCh0aGlzLl9fc2V0Q2FsbGJhY2ssImVycm9yIiksdGhpcy5kb25lKG4uc3VjY2VzcyksdGhpcy5lcnJvcihuLmVycm9yKX0sX19zZXRDYWxsYmFjazpmdW5jdGlvbih0LGkpe2lmKGUuaXNGdW5jdGlvbihpKSlyZXR1cm4gdGhpcy5fX2luc3RhbmNlLm9uKHQsaSksdGhpcy5fX2luc3RhbmNlfX0pO3JldHVybnthdHRhY2g6ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IGEodCxlKX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8sYSl7cj1bdCxpKDE1OSksaSgzMCksaSgxNjEpXSxuPWEscz0iZnVuY3Rpb24iPT10eXBlb2Ygbj9uLmFwcGx5KGUscik6biwhKHZvaWQgMCE9PXMmJih0LmV4cG9ydHM9cykpfSh0aGlzLGZ1bmN0aW9uKHQsZSxpLG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ImRlZmF1bHQiOnR9fWZ1bmN0aW9uIHModCxlKXtpZighKHQgaW5zdGFuY2VvZiBlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX1mdW5jdGlvbiBvKHQsZSl7aWYoIXQpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTtyZXR1cm4hZXx8Im9iamVjdCIhPXR5cGVvZiBlJiYiZnVuY3Rpb24iIT10eXBlb2YgZT90OmV9ZnVuY3Rpb24gYSh0LGUpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlJiZudWxsIT09ZSl0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIrdHlwZW9mIGUpO3QucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoZSYmZS5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTp0LGVudW1lcmFibGU6ITEsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLGUmJihPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKHQsZSk6dC5fX3Byb3RvX189ZSl9ZnVuY3Rpb24gbCh0LGUpe3ZhciBpPSJkYXRhLWNsaXBib2FyZC0iK3Q7aWYoZS5oYXNBdHRyaWJ1dGUoaSkpcmV0dXJuIGUuZ2V0QXR0cmlidXRlKGkpfXZhciBjPXIoZSksdT1yKGkpLGQ9cihuKSxoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgbj1lW2ldO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBuJiYobi53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsbi5rZXksbil9fXJldHVybiBmdW5jdGlvbihlLGksbil7cmV0dXJuIGkmJnQoZS5wcm90b3R5cGUsaSksbiYmdChlLG4pLGV9fSgpLHA9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0LGkpe3ModGhpcyxlKTt2YXIgbj1vKHRoaXMsKGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSkpLmNhbGwodGhpcykpO3JldHVybiBuLnJlc29sdmVPcHRpb25zKGkpLG4ubGlzdGVuQ2xpY2sodCksbn1yZXR1cm4gYShlLHQpLGgoZSxbe2tleToicmVzb2x2ZU9wdGlvbnMiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnt9O3RoaXMuYWN0aW9uPSJmdW5jdGlvbiI9PXR5cGVvZiB0LmFjdGlvbj90LmFjdGlvbjp0aGlzLmRlZmF1bHRBY3Rpb24sdGhpcy50YXJnZXQ9ImZ1bmN0aW9uIj09dHlwZW9mIHQudGFyZ2V0P3QudGFyZ2V0OnRoaXMuZGVmYXVsdFRhcmdldCx0aGlzLnRleHQ9ImZ1bmN0aW9uIj09dHlwZW9mIHQudGV4dD90LnRleHQ6dGhpcy5kZWZhdWx0VGV4dH19LHtrZXk6Imxpc3RlbkNsaWNrIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzO3RoaXMubGlzdGVuZXI9KDAsZFsiZGVmYXVsdCJdKSh0LCJjbGljayIsZnVuY3Rpb24odCl7cmV0dXJuIGUub25DbGljayh0KX0pfX0se2tleToib25DbGljayIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dC5kZWxlZ2F0ZVRhcmdldHx8dC5jdXJyZW50VGFyZ2V0O3RoaXMuY2xpcGJvYXJkQWN0aW9uJiYodGhpcy5jbGlwYm9hcmRBY3Rpb249bnVsbCksdGhpcy5jbGlwYm9hcmRBY3Rpb249bmV3IGNbImRlZmF1bHQiXSh7YWN0aW9uOnRoaXMuYWN0aW9uKGUpLHRhcmdldDp0aGlzLnRhcmdldChlKSx0ZXh0OnRoaXMudGV4dChlKSx0cmlnZ2VyOmUsZW1pdHRlcjp0aGlzfSl9fSx7a2V5OiJkZWZhdWx0QWN0aW9uIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gbCgiYWN0aW9uIix0KX19LHtrZXk6ImRlZmF1bHRUYXJnZXQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPWwoInRhcmdldCIsdCk7aWYoZSlyZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKX19LHtrZXk6ImRlZmF1bHRUZXh0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gbCgidGV4dCIsdCl9fSx7a2V5OiJkZXN0cm95Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuZXIuZGVzdHJveSgpLHRoaXMuY2xpcGJvYXJkQWN0aW9uJiYodGhpcy5jbGlwYm9hcmRBY3Rpb24uZGVzdHJveSgpLHRoaXMuY2xpcGJvYXJkQWN0aW9uPW51bGwpfX1dLFt7a2V5OiJpc1N1cHBvcnRlZCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06WyJjb3B5IiwiY3V0Il0sZT0ic3RyaW5nIj09dHlwZW9mIHQ/W3RdOnQsaT0hIWRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZDtyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2k9aSYmISFkb2N1bWVudC5xdWVyeUNvbW1hbmRTdXBwb3J0ZWQodCl9KSxpfX1dKSxlfSh1WyJkZWZhdWx0Il0pO3QuZXhwb3J0cz1wfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8sYSl7cj1bdCxpKDE2MCldLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gaSh0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6eyJkZWZhdWx0Ijp0fX1mdW5jdGlvbiBuKHQsZSl7aWYoISh0IGluc3RhbmNlb2YgZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9dmFyIHI9aShlKSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJiJzeW1ib2wiPT10eXBlb2YgU3ltYm9sLml0ZXJhdG9yP2Z1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdH06ZnVuY3Rpb24odCl7cmV0dXJuIHQmJiJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJnQuY29uc3RydWN0b3I9PT1TeW1ib2wmJnQhPT1TeW1ib2wucHJvdG90eXBlPyJzeW1ib2wiOnR5cGVvZiB0fSxvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgbj1lW2ldO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBuJiYobi53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsbi5rZXksbil9fXJldHVybiBmdW5jdGlvbihlLGksbil7cmV0dXJuIGkmJnQoZS5wcm90b3R5cGUsaSksbiYmdChlLG4pLGV9fSgpLGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe24odGhpcyx0KSx0aGlzLnJlc29sdmVPcHRpb25zKGUpLHRoaXMuaW5pdFNlbGVjdGlvbigpfXJldHVybiBvKHQsW3trZXk6InJlc29sdmVPcHRpb25zIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fTt0aGlzLmFjdGlvbj10LmFjdGlvbix0aGlzLmVtaXR0ZXI9dC5lbWl0dGVyLHRoaXMudGFyZ2V0PXQudGFyZ2V0LHRoaXMudGV4dD10LnRleHQsdGhpcy50cmlnZ2VyPXQudHJpZ2dlcix0aGlzLnNlbGVjdGVkVGV4dD0iIn19LHtrZXk6ImluaXRTZWxlY3Rpb24iLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy50ZXh0P3RoaXMuc2VsZWN0RmFrZSgpOnRoaXMudGFyZ2V0JiZ0aGlzLnNlbGVjdFRhcmdldCgpfX0se2tleToic2VsZWN0RmFrZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLGU9InJ0bCI9PWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRpciIpO3RoaXMucmVtb3ZlRmFrZSgpLHRoaXMuZmFrZUhhbmRsZXJDYWxsYmFjaz1mdW5jdGlvbigpe3JldHVybiB0LnJlbW92ZUZha2UoKX0sdGhpcy5mYWtlSGFuZGxlcj1kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIix0aGlzLmZha2VIYW5kbGVyQ2FsbGJhY2spfHwhMCx0aGlzLmZha2VFbGVtPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRleHRhcmVhIiksdGhpcy5mYWtlRWxlbS5zdHlsZS5mb250U2l6ZT0iMTJwdCIsdGhpcy5mYWtlRWxlbS5zdHlsZS5ib3JkZXI9IjAiLHRoaXMuZmFrZUVsZW0uc3R5bGUucGFkZGluZz0iMCIsdGhpcy5mYWtlRWxlbS5zdHlsZS5tYXJnaW49IjAiLHRoaXMuZmFrZUVsZW0uc3R5bGUucG9zaXRpb249ImFic29sdXRlIix0aGlzLmZha2VFbGVtLnN0eWxlW2U/InJpZ2h0IjoibGVmdCJdPSItOTk5OXB4Ijt2YXIgaT13aW5kb3cucGFnZVlPZmZzZXR8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7dGhpcy5mYWtlRWxlbS5zdHlsZS50b3A9aSsicHgiLHRoaXMuZmFrZUVsZW0uc2V0QXR0cmlidXRlKCJyZWFkb25seSIsIiIpLHRoaXMuZmFrZUVsZW0udmFsdWU9dGhpcy50ZXh0LGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5mYWtlRWxlbSksdGhpcy5zZWxlY3RlZFRleHQ9KDAsclsiZGVmYXVsdCJdKSh0aGlzLmZha2VFbGVtKSx0aGlzLmNvcHlUZXh0KCl9fSx7a2V5OiJyZW1vdmVGYWtlIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuZmFrZUhhbmRsZXImJihkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIix0aGlzLmZha2VIYW5kbGVyQ2FsbGJhY2spLHRoaXMuZmFrZUhhbmRsZXI9bnVsbCx0aGlzLmZha2VIYW5kbGVyQ2FsbGJhY2s9bnVsbCksdGhpcy5mYWtlRWxlbSYmKGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5mYWtlRWxlbSksdGhpcy5mYWtlRWxlbT1udWxsKX19LHtrZXk6InNlbGVjdFRhcmdldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnNlbGVjdGVkVGV4dD0oMCxyWyJkZWZhdWx0Il0pKHRoaXMudGFyZ2V0KSx0aGlzLmNvcHlUZXh0KCl9fSx7a2V5OiJjb3B5VGV4dCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD12b2lkIDA7dHJ5e3Q9ZG9jdW1lbnQuZXhlY0NvbW1hbmQodGhpcy5hY3Rpb24pfWNhdGNoKGUpe3Q9ITF9dGhpcy5oYW5kbGVSZXN1bHQodCl9fSx7a2V5OiJoYW5kbGVSZXN1bHQiLHZhbHVlOmZ1bmN0aW9uKHQpe3RoaXMuZW1pdHRlci5lbWl0KHQ/InN1Y2Nlc3MiOiJlcnJvciIse2FjdGlvbjp0aGlzLmFjdGlvbix0ZXh0OnRoaXMuc2VsZWN0ZWRUZXh0LHRyaWdnZXI6dGhpcy50cmlnZ2VyLGNsZWFyU2VsZWN0aW9uOnRoaXMuY2xlYXJTZWxlY3Rpb24uYmluZCh0aGlzKX0pfX0se2tleToiY2xlYXJTZWxlY3Rpb24iLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy50YXJnZXQmJnRoaXMudGFyZ2V0LmJsdXIoKSx3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCl9fSx7a2V5OiJkZXN0cm95Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMucmVtb3ZlRmFrZSgpfX0se2tleToiYWN0aW9uIixzZXQ6ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06ImNvcHkiO2lmKHRoaXMuX2FjdGlvbj10LCJjb3B5IiE9PXRoaXMuX2FjdGlvbiYmImN1dCIhPT10aGlzLl9hY3Rpb24pdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkICJhY3Rpb24iIHZhbHVlLCB1c2UgZWl0aGVyICJjb3B5IiBvciAiY3V0IicpfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0aW9ufX0se2tleToidGFyZ2V0IixzZXQ6ZnVuY3Rpb24odCl7aWYodm9pZCAwIT09dCl7aWYoIXR8fCJvYmplY3QiIT09KCJ1bmRlZmluZWQiPT10eXBlb2YgdD8idW5kZWZpbmVkIjpzKHQpKXx8MSE9PXQubm9kZVR5cGUpdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkICJ0YXJnZXQiIHZhbHVlLCB1c2UgYSB2YWxpZCBFbGVtZW50Jyk7aWYoImNvcHkiPT09dGhpcy5hY3Rpb24mJnQuaGFzQXR0cmlidXRlKCJkaXNhYmxlZCIpKXRocm93IG5ldyBFcnJvcignSW52YWxpZCAidGFyZ2V0IiBhdHRyaWJ1dGUuIFBsZWFzZSB1c2UgInJlYWRvbmx5IiBpbnN0ZWFkIG9mICJkaXNhYmxlZCIgYXR0cmlidXRlJyk7aWYoImN1dCI9PT10aGlzLmFjdGlvbiYmKHQuaGFzQXR0cmlidXRlKCJyZWFkb25seSIpfHx0Lmhhc0F0dHJpYnV0ZSgiZGlzYWJsZWQiKSkpdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkICJ0YXJnZXQiIGF0dHJpYnV0ZS4gWW91IGNhblwndCBjdXQgdGV4dCBmcm9tIGVsZW1lbnRzIHdpdGggInJlYWRvbmx5IiBvciAiZGlzYWJsZWQiIGF0dHJpYnV0ZXMnKTt0aGlzLl90YXJnZXQ9dH19LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90YXJnZXR9fV0pLHR9KCk7dC5leHBvcnRzPWF9KX0sZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQpe3ZhciBlO2lmKCJTRUxFQ1QiPT09dC5ub2RlTmFtZSl0LmZvY3VzKCksZT10LnZhbHVlO2Vsc2UgaWYoIklOUFVUIj09PXQubm9kZU5hbWV8fCJURVhUQVJFQSI9PT10Lm5vZGVOYW1lKXt2YXIgaT10Lmhhc0F0dHJpYnV0ZSgicmVhZG9ubHkiKTtpfHx0LnNldEF0dHJpYnV0ZSgicmVhZG9ubHkiLCIiKSx0LnNlbGVjdCgpLHQuc2V0U2VsZWN0aW9uUmFuZ2UoMCx0LnZhbHVlLmxlbmd0aCksaXx8dC5yZW1vdmVBdHRyaWJ1dGUoInJlYWRvbmx5IiksZT10LnZhbHVlfWVsc2V7dC5oYXNBdHRyaWJ1dGUoImNvbnRlbnRlZGl0YWJsZSIpJiZ0LmZvY3VzKCk7dmFyIG49d2luZG93LmdldFNlbGVjdGlvbigpLHI9ZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtyLnNlbGVjdE5vZGVDb250ZW50cyh0KSxuLnJlbW92ZUFsbFJhbmdlcygpLG4uYWRkUmFuZ2UociksZT1uLnRvU3RyaW5nKCl9cmV0dXJuIGV9dC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSxpKXtpZighdCYmIWUmJiFpKXRocm93IG5ldyBFcnJvcigiTWlzc2luZyByZXF1aXJlZCBhcmd1bWVudHMiKTtpZighYS5zdHJpbmcoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiU2Vjb25kIGFyZ3VtZW50IG11c3QgYmUgYSBTdHJpbmciKTtpZighYS5mbihpKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGlyZCBhcmd1bWVudCBtdXN0IGJlIGEgRnVuY3Rpb24iKTtpZihhLm5vZGUodCkpcmV0dXJuIHIodCxlLGkpO2lmKGEubm9kZUxpc3QodCkpcmV0dXJuIHModCxlLGkpO2lmKGEuc3RyaW5nKHQpKXJldHVybiBvKHQsZSxpKTt0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgU3RyaW5nLCBIVE1MRWxlbWVudCwgSFRNTENvbGxlY3Rpb24sIG9yIE5vZGVMaXN0Iil9ZnVuY3Rpb24gcih0LGUsaSl7cmV0dXJuIHQuYWRkRXZlbnRMaXN0ZW5lcihlLGkpLHtkZXN0cm95OmZ1bmN0aW9uKCl7dC5yZW1vdmVFdmVudExpc3RlbmVyKGUsaSl9fX1mdW5jdGlvbiBzKHQsZSxpKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCh0LGZ1bmN0aW9uKHQpe3QuYWRkRXZlbnRMaXN0ZW5lcihlLGkpfSkse2Rlc3Ryb3k6ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHQsZnVuY3Rpb24odCl7dC5yZW1vdmVFdmVudExpc3RlbmVyKGUsaSl9KX19fWZ1bmN0aW9uIG8odCxlLGkpe3JldHVybiBsKGRvY3VtZW50LmJvZHksdCxlLGkpfXZhciBhPWkoMTYyKSxsPWkoMTYzKTt0LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlKXtlLm5vZGU9ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMCE9PXQmJnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCYmMT09PXQubm9kZVR5cGV9LGUubm9kZUxpc3Q9ZnVuY3Rpb24odCl7dmFyIGk9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpO3JldHVybiB2b2lkIDAhPT10JiYoIltvYmplY3QgTm9kZUxpc3RdIj09PWl8fCJbb2JqZWN0IEhUTUxDb2xsZWN0aW9uXSI9PT1pKSYmImxlbmd0aCJpbiB0JiYoMD09PXQubGVuZ3RofHxlLm5vZGUodFswXSkpfSxlLnN0cmluZz1mdW5jdGlvbih0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHR8fHQgaW5zdGFuY2VvZiBTdHJpbmd9LGUuZm49ZnVuY3Rpb24odCl7dmFyIGU9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpO3JldHVybiJbb2JqZWN0IEZ1bmN0aW9uXSI9PT1lfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlLGksbixzKXt2YXIgbz1yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdC5hZGRFdmVudExpc3RlbmVyKGksbyxzKSx7ZGVzdHJveTpmdW5jdGlvbigpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihpLG8scyl9fX1mdW5jdGlvbiByKHQsZSxpLG4pe3JldHVybiBmdW5jdGlvbihpKXtpLmRlbGVnYXRlVGFyZ2V0PXMoaS50YXJnZXQsZSksaS5kZWxlZ2F0ZVRhcmdldCYmbi5jYWxsKHQsaSl9fXZhciBzPWkoMTY0KTt0LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7Zm9yKDt0JiZ0Lm5vZGVUeXBlIT09bjspe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiB0Lm1hdGNoZXMmJnQubWF0Y2hlcyhlKSlyZXR1cm4gdDt0PXQucGFyZW50Tm9kZX19dmFyIG49OTtpZigidW5kZWZpbmVkIiE9dHlwZW9mIEVsZW1lbnQmJiFFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzKXt2YXIgcj1FbGVtZW50LnByb3RvdHlwZTtyLm1hdGNoZXM9ci5tYXRjaGVzU2VsZWN0b3J8fHIubW96TWF0Y2hlc1NlbGVjdG9yfHxyLm1zTWF0Y2hlc1NlbGVjdG9yfHxyLm9NYXRjaGVzU2VsZWN0b3J8fHIud2Via2l0TWF0Y2hlc1NlbGVjdG9yfXQuZXhwb3J0cz1pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTY2KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPS9eaHR0cHMvLnRlc3Qod2luZG93LmxvY2F0aW9uLmhyZWYpO3JldHVybntzZXRDb29raWU6ZnVuY3Rpb24obixyLHMpe2Uuc2V0KG4scix0LmRlZmF1bHRzKHN8fHt9LHtzZWN1cmU6aSxwYXRoOiIvIn0pKX0sZ2V0Q29va2llOmZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0LmFwcGx5KGUsYXJndW1lbnRzKX0scmVtb3ZlQ29va2llOmZ1bmN0aW9uKCl7cmV0dXJuIGUucmVtb3ZlLmFwcGx5KGUsYXJndW1lbnRzKX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyOy8qIQoJCSAqIEphdmFTY3JpcHQgQ29va2llIHYyLjEuMAoJCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9qcy1jb29raWUvanMtY29va2llCgkJICoKCQkgKiBDb3B5cmlnaHQgMjAwNiwgMjAxNSBLbGF1cyBIYXJ0bCAmIEZhZ25lciBCcmFjawoJCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJCSAqLwoJIWZ1bmN0aW9uKHMpe249cyxyPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uY2FsbChlLGksZSx0KTpuLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe2Zvcih2YXIgdD0wLGU9e307dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIGk9YXJndW1lbnRzW3RdO2Zvcih2YXIgbiBpbiBpKWVbbl09aVtuXX1yZXR1cm4gZX1mdW5jdGlvbiBlKGkpe2Z1bmN0aW9uIG4oZSxyLHMpe3ZhciBvO2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7aWYocz10KHtwYXRoOiIvIn0sbi5kZWZhdWx0cyxzKSwibnVtYmVyIj09dHlwZW9mIHMuZXhwaXJlcyl7dmFyIGE9bmV3IERhdGU7YS5zZXRNaWxsaXNlY29uZHMoYS5nZXRNaWxsaXNlY29uZHMoKSs4NjRlNSpzLmV4cGlyZXMpLHMuZXhwaXJlcz1hfXRyeXtvPUpTT04uc3RyaW5naWZ5KHIpLC9eW1x7XFtdLy50ZXN0KG8pJiYocj1vKX1jYXRjaChsKXt9cmV0dXJuIHI9aS53cml0ZT9pLndyaXRlKHIsZSk6ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhyKSkucmVwbGFjZSgvJSgyM3wyNHwyNnwyQnwzQXwzQ3wzRXwzRHwyRnwzRnw0MHw1Qnw1RHw1RXw2MHw3Qnw3RHw3QykvZyxkZWNvZGVVUklDb21wb25lbnQpLGU9ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhlKSksZT1lLnJlcGxhY2UoLyUoMjN8MjR8MjZ8MkJ8NUV8NjB8N0MpL2csZGVjb2RlVVJJQ29tcG9uZW50KSxlPWUucmVwbGFjZSgvW1woXCldL2csZXNjYXBlKSxkb2N1bWVudC5jb29raWU9W2UsIj0iLHIscy5leHBpcmVzJiYiOyBleHBpcmVzPSIrcy5leHBpcmVzLnRvVVRDU3RyaW5nKCkscy5wYXRoJiYiOyBwYXRoPSIrcy5wYXRoLHMuZG9tYWluJiYiOyBkb21haW49IitzLmRvbWFpbixzLnNlY3VyZT8iOyBzZWN1cmUiOiIiXS5qb2luKCIiKX1lfHwobz17fSk7Zm9yKHZhciBjPWRvY3VtZW50LmNvb2tpZT9kb2N1bWVudC5jb29raWUuc3BsaXQoIjsgIik6W10sdT0vKCVbMC05QS1aXXsyfSkrL2csZD0wO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgaD1jW2RdLnNwbGl0KCI9IikscD1oWzBdLnJlcGxhY2UodSxkZWNvZGVVUklDb21wb25lbnQpLGY9aC5zbGljZSgxKS5qb2luKCI9Iik7JyInPT09Zi5jaGFyQXQoMCkmJihmPWYuc2xpY2UoMSwtMSkpO3RyeXtpZihmPWkucmVhZD9pLnJlYWQoZixwKTppKGYscCl8fGYucmVwbGFjZSh1LGRlY29kZVVSSUNvbXBvbmVudCksdGhpcy5qc29uKXRyeXtmPUpTT04ucGFyc2UoZil9Y2F0Y2gobCl7fWlmKGU9PT1wKXtvPWY7YnJlYWt9ZXx8KG9bcF09Zil9Y2F0Y2gobCl7fX1yZXR1cm4gb31yZXR1cm4gbi5nZXQ9bi5zZXQ9bixuLmdldEpTT049ZnVuY3Rpb24oKXtyZXR1cm4gbi5hcHBseSh7anNvbjohMH0sW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKX0sbi5kZWZhdWx0cz17fSxuLnJlbW92ZT1mdW5jdGlvbihlLGkpe24oZSwiIix0KGkse2V4cGlyZXM6LTF9KSl9LG4ud2l0aENvbnZlcnRlcj1lLG59cmV0dXJuIGUoZnVuY3Rpb24oKXt9KX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ1KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7ZmV0Y2hFdmVudHM6ImNoYW5nZSIsY29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0aGlzLmZldGNoPXQuZGVib3VuY2UodGhpcy5mZXRjaCw1MCksdGhpcy5Db2xsZWN0aW9uJiYodGhpcy5jb2xsZWN0aW9uPW5ldyB0aGlzLkNvbGxlY3Rpb24pLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSx0LnJlc3VsdCh0aGlzLCJmZXRjaEV2ZW50cyIpLGZ1bmN0aW9uKCl7dGhpcy5mZXRjaCh7cmVzZXQ6ITB9KX0pLHRoaXMuY29sbGVjdGlvbiYmdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sImVycm9yIixmdW5jdGlvbih0KXt0PT09dGhpcy5jb2xsZWN0aW9uJiZ0aGlzLmNvbGxlY3Rpb24ucmVzZXQoKX0pLHRoaXMuZmV0Y2goe3Jlc2V0OiEwfSl9LGZldGNoOmZ1bmN0aW9uKGUpe3RoaXMuY29sbGVjdGlvbiYmKHRoaXMudHJpZ2dlcigiZmV0Y2giLHRoaXMuc3RhdGUpLHRoaXMuY29sbGVjdGlvbi5mZXRjaCh0LmV4dGVuZCh0LnBpY2soZXx8e30sWyJyZXNldCIsInJlbW92ZSIsInN1Y2Nlc3MiLCJlcnJvciIsImRhdGEiXSkse2RhdGE6dGhpcy5nZXRGZXRjaERhdGEoKX0pKSl9LGdldEZldGNoRGF0YTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlLnRvSlNPTigpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMildLHI9ZnVuY3Rpb24odCl7cmV0dXJue2NyZWF0ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5lcnJvck9iaiYmKHQuaXNFbXB0eShlLmVycm9yT2JqLmVycm9yQ2F1c2VzKT9lLmVycm9ycz1be2Vycm9yU3VtbWFyeTplLmVycm9yT2JqLmVycm9yU3VtbWFyeX1dOmUuZXJyb3JzPWUuZXJyb3JPYmouZXJyb3JDYXVzZXMpLHtnZXRGaWVsZE5hbWU6ZnVuY3Rpb24odCl7cmV0dXJuIHQuaW5kZXhPZigiOiIpPi0xP3Quc3BsaXQoIjoiKVswXTpudWxsfSxnZXRNZXNzYWdlczpmdW5jdGlvbigpe3ZhciBpPVtdO3JldHVybiB0LmVhY2goZS5lcnJvcnMsZnVuY3Rpb24odCl7dmFyIG49dGhpcy5nZXRGaWVsZE5hbWUodC5lcnJvclN1bW1hcnkpO2lmKG4mJmUuaW5wdXRNYXBbbl0pe3ZhciByPW5ldyBSZWdFeHAoIl4iK24pO2kucHVzaCh7ZXJyb3JTdW1tYXJ5OnQuZXJyb3JTdW1tYXJ5LnJlcGxhY2UocixlLmlucHV0TWFwW25dKX0pfWVsc2UgaS5wdXNoKHQpfSx0aGlzKSxpfSxnZXRJbnB1dHM6ZnVuY3Rpb24oKXt2YXIgaT1bXTtyZXR1cm4gdC5lYWNoKGUuZXJyb3JzLGZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMuZ2V0RmllbGROYW1lKHQuZXJyb3JTdW1tYXJ5KTtlLmlucHV0TWFwLmhhc093blByb3BlcnR5KG4pJiZpLnB1c2gobil9LHRoaXMpLGl9LGdldFJlZm9ybWF0dGVkTWVzc2FnZXM6ZnVuY3Rpb24oKXt2YXIgaT17fTtyZXR1cm4gdC5lYWNoKGUuZXJyb3JzLGZ1bmN0aW9uKGUpe2lmKHQuaXNVbmRlZmluZWQoZS5lcnJvclN1bW1hcnkpKWkuZXJyb3JTdW1tYXJ5PWU7ZWxzZXt2YXIgbj1lLmVycm9yU3VtbWFyeS5pbmRleE9mKCI6Iik+LTE/ZS5lcnJvclN1bW1hcnkuc3BsaXQoIjogIik6bnVsbDtuP2lbblswXV09blsxXTppLmVycm9yU3VtbWFyeT1lLmVycm9yU3VtbWFyeX19LHRoaXMpLGl9fX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXshKHQuZXhwb3J0cz17RkVUQ0hfTU9SRToiRkVUQ0hfTU9SRSIsU0hPV19NT1JFOiJTSE9XX01PUkUiLERFTEVURToiREVMRVRFIixBQ1RJVkFURToiQUNUSVZBVEUiLERFQUNUSVZBVEU6IkRFQUNUSVZBVEUiLENIRUNLX0FMTDoiQ0hFQ0tfQUxMIixVUExPQURfRE9ORToiVVBMT0FEX0RPTkUiLFVQTE9BRF9FTVBUWV9DT05URU5UOiJVUExPQURfRU1QVFlfQ09OVEVOVCIsRE9XTkxPQURfRE9ORToiRE9XTkxPQURfRE9ORSIsQ0xPU0U6IkNMT1NFIixET05FOiJET05FIixTVUJNSVQ6IlNVQk1JVCJ9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNzEpXSxyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3JldHVybiB0PXZrYmVhdXRpZnkueG1sKHQpLGUmJih0PXQucmVwbGFjZSgvJi9nLCImYW1wOyIpLnJlcGxhY2UoLzwvZywiJmx0OyIpLnJlcGxhY2UoLz4vZywiJmd0OyIpLnJlcGxhY2UoLyIvZywiJnF1b3Q7IikpLHR9cmV0dXJuIHR9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXsvKioKCQkqIHZrQmVhdXRpZnkgLSBqYXZhc2NyaXB0IHBsdWdpbiB0byBwcmV0dHktcHJpbnQgb3IgbWluaWZ5IHRleHQgaW4gWE1MLCBKU09OLCBDU1MgYW5kIFNRTCBmb3JtYXRzLgoJCSogIAoJCSogVmVyc2lvbiAtIDAuOTkuMDAuYmV0YSAKCQkqIENvcHlyaWdodCAoYykgMjAxMiBWYWRpbSBLaXJ5dWtoaW4KCQkqIHZraXJ5dWtoaW4gQCBnbWFpbC5jb20KCQkqIGh0dHA6Ly93d3cuZXNsaW5zdHJ1Y3Rvci5uZXQvdmtiZWF1dGlmeS8KCQkqIAoJCSogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXM6CgkJKiAgIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwCgkJKiAgIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwuaHRtbAoJCSoKCQkqICAgUHJldHR5IHByaW50CgkJKgoJCSogICAgICAgIHZrYmVhdXRpZnkueG1sKHRleHQgWyxpbmRlbnRfcGF0dGVybl0pOwoJCSogICAgICAgIHZrYmVhdXRpZnkuanNvbih0ZXh0IFssaW5kZW50X3BhdHRlcm5dKTsKCQkqICAgICAgICB2a2JlYXV0aWZ5LmNzcyh0ZXh0IFssaW5kZW50X3BhdHRlcm5dKTsKCQkqICAgICAgICB2a2JlYXV0aWZ5LnNxbCh0ZXh0IFssaW5kZW50X3BhdHRlcm5dKTsKCQkqCgkJKiAgICAgICAgQHRleHQgLSBTdHJpbmc7IHRleHQgdG8gYmVhdHVmeTsKCQkqICAgICAgICBAaW5kZW50X3BhdHRlcm4gLSBJbnRlZ2VyIHwgU3RyaW5nOwoJCSogICAgICAgICAgICAgICAgSW50ZWdlcjogIG51bWJlciBvZiB3aGl0ZSBzcGFjZXM7CgkJKiAgICAgICAgICAgICAgICBTdHJpbmc6ICAgY2hhcmFjdGVyIHN0cmluZyB0byB2aXN1YWxpemUgaW5kZW50YXRpb24gKCBjYW4gYWxzbyBiZSBhIHNldCBvZiB3aGl0ZSBzcGFjZXMgKQoJCSogICBNaW5pZnkKCQkqCgkJKiAgICAgICAgdmtiZWF1dGlmeS54bWxtaW4odGV4dCBbLHByZXNlcnZlX2NvbW1lbnRzXSk7CgkJKiAgICAgICAgdmtiZWF1dGlmeS5qc29ubWluKHRleHQpOwoJCSogICAgICAgIHZrYmVhdXRpZnkuY3NzbWluKHRleHQgWyxwcmVzZXJ2ZV9jb21tZW50c10pOwoJCSogICAgICAgIHZrYmVhdXRpZnkuc3FsbWluKHRleHQpOwoJCSoKCQkqICAgICAgICBAdGV4dCAtIFN0cmluZzsgdGV4dCB0byBtaW5pZnk7CgkJKiAgICAgICAgQHByZXNlcnZlX2NvbW1lbnRzIC0gQm9vbDsgW29wdGlvbmFsXTsKCQkqICAgICAgICAgICAgICAgIFNldCB0aGlzIGZsYWcgdG8gdHJ1ZSB0byBwcmV2ZW50IHJlbW92aW5nIGNvbW1lbnRzIGZyb20gQHRleHQgKCBtaW54bWwgYW5kIG1pbmNzcyBmdW5jdGlvbnMgb25seS4gKQoJCSoKCQkqICAgRXhhbXBsZXM6CgkJKiAgICAgICAgdmtiZWF1dGlmeS54bWwodGV4dCk7IC8vIHByZXR0eSBwcmludCBYTUwKCQkqICAgICAgICB2a2JlYXV0aWZ5Lmpzb24odGV4dCwgNCApOyAvLyBwcmV0dHkgcHJpbnQgSlNPTgoJCSogICAgICAgIHZrYmVhdXRpZnkuY3NzKHRleHQsICcuIC4gLiAuJyk7IC8vIHByZXR0eSBwcmludCBDU1MKCQkqICAgICAgICB2a2JlYXV0aWZ5LnNxbCh0ZXh0LCAnLS0tLScpOyAvLyBwcmV0dHkgcHJpbnQgU1FMCgkJKgoJCSogICAgICAgIHZrYmVhdXRpZnkueG1sbWluKHRleHQsIHRydWUpOy8vIG1pbmlmeSBYTUwsIHByZXNlcnZlIGNvbW1lbnRzCgkJKiAgICAgICAgdmtiZWF1dGlmeS5qc29ubWluKHRleHQpOy8vIG1pbmlmeSBKU09OCgkJKiAgICAgICAgdmtiZWF1dGlmeS5jc3NtaW4odGV4dCk7Ly8gbWluaWZ5IENTUywgcmVtb3ZlIGNvbW1lbnRzICggZGVmYXVsdCApCgkJKiAgICAgICAgdmtiZWF1dGlmeS5zcWxtaW4odGV4dCk7Ly8gbWluaWZ5IFNRTAoJCSoKCQkqLwoJIWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt2YXIgZT0iICAgICI7aWYoaXNOYU4ocGFyc2VJbnQodCkpKWU9dDtlbHNlIHN3aXRjaCh0KXtjYXNlIDE6ZT0iICI7YnJlYWs7Y2FzZSAyOmU9IiAgIjticmVhaztjYXNlIDM6ZT0iICAgIjticmVhaztjYXNlIDQ6ZT0iICAgICI7YnJlYWs7Y2FzZSA1OmU9IiAgICAgIjticmVhaztjYXNlIDY6ZT0iICAgICAgIjticmVhaztjYXNlIDc6ZT0iICAgICAgICI7YnJlYWs7Y2FzZSA4OmU9IiAgICAgICAgIjticmVhaztjYXNlIDk6ZT0iICAgICAgICAgIjticmVhaztjYXNlIDEwOmU9IiAgICAgICAgICAiO2JyZWFrO2Nhc2UgMTE6ZT0iICAgICAgICAgICAiO2JyZWFrO2Nhc2UgMTI6ZT0iICAgICAgICAgICAgIn12YXIgaT1bIlxuIl07Zm9yKGl4PTA7aXg8MTAwO2l4KyspaS5wdXNoKGlbaXhdK2UpO3JldHVybiBpfWZ1bmN0aW9uIGUoKXt0aGlzLnN0ZXA9IiAgICAiLHRoaXMuc2hpZnQ9dCh0aGlzLnN0ZXApfWZ1bmN0aW9uIGkodCxlKXtyZXR1cm4gZS0odC5yZXBsYWNlKC9cKC9nLCIiKS5sZW5ndGgtdC5yZXBsYWNlKC9cKS9nLCIiKS5sZW5ndGgpfWZ1bmN0aW9uIG4odCxlKXtyZXR1cm4gdC5yZXBsYWNlKC9cc3sxLH0vZywiICIpLnJlcGxhY2UoLyBBTkQgL2dpLCJ+Ojp+IitlK2UrIkFORCAiKS5yZXBsYWNlKC8gQkVUV0VFTiAvZ2ksIn46On4iK2UrIkJFVFdFRU4gIikucmVwbGFjZSgvIENBU0UgL2dpLCJ+Ojp+IitlKyJDQVNFICIpLnJlcGxhY2UoLyBFTFNFIC9naSwifjo6fiIrZSsiRUxTRSAiKS5yZXBsYWNlKC8gRU5EIC9naSwifjo6fiIrZSsiRU5EICIpLnJlcGxhY2UoLyBGUk9NIC9naSwifjo6fkZST00gIikucmVwbGFjZSgvIEdST1VQXHN7MSx9QlkvZ2ksIn46On5HUk9VUCBCWSAiKS5yZXBsYWNlKC8gSEFWSU5HIC9naSwifjo6fkhBVklORyAiKS5yZXBsYWNlKC8gSU4gL2dpLCIgSU4gIikucmVwbGFjZSgvIEpPSU4gL2dpLCJ+Ojp+Sk9JTiAiKS5yZXBsYWNlKC8gQ1JPU1N+Ojp+ezEsfUpPSU4gL2dpLCJ+Ojp+Q1JPU1MgSk9JTiAiKS5yZXBsYWNlKC8gSU5ORVJ+Ojp+ezEsfUpPSU4gL2dpLCJ+Ojp+SU5ORVIgSk9JTiAiKS5yZXBsYWNlKC8gTEVGVH46On57MSx9Sk9JTiAvZ2ksIn46On5MRUZUIEpPSU4gIikucmVwbGFjZSgvIFJJR0hUfjo6fnsxLH1KT0lOIC9naSwifjo6flJJR0hUIEpPSU4gIikucmVwbGFjZSgvIE9OIC9naSwifjo6fiIrZSsiT04gIikucmVwbGFjZSgvIE9SIC9naSwifjo6fiIrZStlKyJPUiAiKS5yZXBsYWNlKC8gT1JERVJcc3sxLH1CWS9naSwifjo6fk9SREVSIEJZICIpLnJlcGxhY2UoLyBPVkVSIC9naSwifjo6fiIrZSsiT1ZFUiAiKS5yZXBsYWNlKC9cKFxzezAsfVNFTEVDVCAvZ2ksIn46On4oU0VMRUNUICIpLnJlcGxhY2UoL1wpXHN7MCx9U0VMRUNUIC9naSwiKX46On5TRUxFQ1QgIikucmVwbGFjZSgvIFRIRU4gL2dpLCIgVEhFTn46On4iK2UpLnJlcGxhY2UoLyBVTklPTiAvZ2ksIn46On5VTklPTn46On4iKS5yZXBsYWNlKC8gVVNJTkcgL2dpLCJ+Ojp+VVNJTkcgIikucmVwbGFjZSgvIFdIRU4gL2dpLCJ+Ojp+IitlKyJXSEVOICIpLnJlcGxhY2UoLyBXSEVSRSAvZ2ksIn46On5XSEVSRSAiKS5yZXBsYWNlKC8gV0lUSCAvZ2ksIn46On5XSVRIICIpLnJlcGxhY2UoLyBBTEwgL2dpLCIgQUxMICIpLnJlcGxhY2UoLyBBUyAvZ2ksIiBBUyAiKS5yZXBsYWNlKC8gQVNDIC9naSwiIEFTQyAiKS5yZXBsYWNlKC8gREVTQyAvZ2ksIiBERVNDICIpLnJlcGxhY2UoLyBESVNUSU5DVCAvZ2ksIiBESVNUSU5DVCAiKS5yZXBsYWNlKC8gRVhJU1RTIC9naSwiIEVYSVNUUyAiKS5yZXBsYWNlKC8gTk9UIC9naSwiIE5PVCAiKS5yZXBsYWNlKC8gTlVMTCAvZ2ksIiBOVUxMICIpLnJlcGxhY2UoLyBMSUtFIC9naSwiIExJS0UgIikucmVwbGFjZSgvXHN7MCx9U0VMRUNUIC9naSwiU0VMRUNUICIpLnJlcGxhY2UoL1xzezAsfVVQREFURSAvZ2ksIlVQREFURSAiKS5yZXBsYWNlKC8gU0VUIC9naSwiIFNFVCAiKS5yZXBsYWNlKC9+Ojp+ezEsfS9nLCJ+Ojp+Iikuc3BsaXQoIn46On4iKX1lLnByb3RvdHlwZS54bWw9ZnVuY3Rpb24oZSxpKXt2YXIgbj1lLnJlcGxhY2UoLz5cc3swLH08L2csIj48IikucmVwbGFjZSgvPC9nLCJ+Ojp+PCIpLnJlcGxhY2UoL1xzKnhtbG5zXDovZywifjo6fnhtbG5zOiIpLnJlcGxhY2UoL1xzKnhtbG5zXD0vZywifjo6fnhtbG5zPSIpLnNwbGl0KCJ+Ojp+Iikscj1uLmxlbmd0aCxzPSExLG89MCxhPSIiLGw9MCxjPWk/dChpKTp0aGlzLnNoaWZ0O2ZvcihsPTA7bDxyO2wrKyluW2xdLnNlYXJjaCgvPCEvKT4tMT8oYSs9Y1tvXStuW2xdLHM9ITAsKG5bbF0uc2VhcmNoKC8tLT4vKT4tMXx8bltsXS5zZWFyY2goL1xdPi8pPi0xfHxuW2xdLnNlYXJjaCgvIURPQ1RZUEUvKT4tMSkmJihzPSExKSk6bltsXS5zZWFyY2goLy0tPi8pPi0xfHxuW2xdLnNlYXJjaCgvXF0+Lyk+LTE/KGErPW5bbF0scz0hMSk6L148XHcvLmV4ZWMobltsLTFdKSYmL148XC9cdy8uZXhlYyhuW2xdKSYmL148W1x3OlwtXC5cLF0rLy5leGVjKG5bbC0xXSk9PS9ePFwvW1x3OlwtXC5cLF0rLy5leGVjKG5bbF0pWzBdLnJlcGxhY2UoIi8iLCIiKT8oYSs9bltsXSxzfHxvLS0pOm5bbF0uc2VhcmNoKC88XHcvKT4tMSYmbltsXS5zZWFyY2goLzxcLy8pPT0tMSYmbltsXS5zZWFyY2goL1wvPi8pPT0tMT9hPWErPXM/bltsXTpjW28rK10rbltsXTpuW2xdLnNlYXJjaCgvPFx3Lyk+LTEmJm5bbF0uc2VhcmNoKC88XC8vKT4tMT9hPWErPXM/bltsXTpjW29dK25bbF06bltsXS5zZWFyY2goLzxcLy8pPi0xP2E9YSs9cz9uW2xdOmNbLS1vXStuW2xdOm5bbF0uc2VhcmNoKC9cLz4vKT4tMT9hPWErPXM/bltsXTpjW29dK25bbF06YSs9bltsXS5zZWFyY2goLzxcPy8pPi0xP2Nbb10rbltsXTpuW2xdLnNlYXJjaCgveG1sbnNcOi8pPi0xfHxuW2xdLnNlYXJjaCgveG1sbnNcPS8pPi0xP2Nbb10rbltsXTpuW2xdO3JldHVybiJcbiI9PWFbMF0/YS5zbGljZSgxKTphfSxlLnByb3RvdHlwZS5qc29uPWZ1bmN0aW9uKHQsZSl7dmFyIGU9ZT9lOnRoaXMuc3RlcDtyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIEpTT04/dDoic3RyaW5nIj09dHlwZW9mIHQ/SlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZSh0KSxudWxsLGUpOiJvYmplY3QiPT10eXBlb2YgdD9KU09OLnN0cmluZ2lmeSh0LG51bGwsZSk6dH0sZS5wcm90b3R5cGUuY3NzPWZ1bmN0aW9uKGUsaSl7dmFyIG49ZS5yZXBsYWNlKC9cc3sxLH0vZywiICIpLnJlcGxhY2UoL1x7L2csInt+Ojp+IikucmVwbGFjZSgvXH0vZywifjo6fn1+Ojp+IikucmVwbGFjZSgvXDsvZywiO346On4iKS5yZXBsYWNlKC9cL1wqL2csIn46On4vKiIpLnJlcGxhY2UoL1wqXC8vZywiKi9+Ojp+IikucmVwbGFjZSgvfjo6flxzezAsfX46On4vZywifjo6fiIpLnNwbGl0KCJ+Ojp+Iikscj1uLmxlbmd0aCxzPTAsbz0iIixhPTAsbD1pP3QoaSk6dGhpcy5zaGlmdDtmb3IoYT0wO2E8cjthKyspbys9L1x7Ly5leGVjKG5bYV0pP2xbcysrXStuW2FdOi9cfS8uZXhlYyhuW2FdKT9sWy0tc10rblthXTovXCpcXC8uZXhlYyhuW2FdKT9sW3NdK25bYV06bFtzXStuW2FdO3JldHVybiBvLnJlcGxhY2UoL15cbnsxLH0vLCIiKX0sZS5wcm90b3R5cGUuc3FsPWZ1bmN0aW9uKGUscil7dmFyIHM9ZS5yZXBsYWNlKC9cc3sxLH0vZywiICIpLnJlcGxhY2UoL1wnL2dpLCJ+Ojp+JyIpLnNwbGl0KCJ+Ojp+Iiksbz1zLmxlbmd0aCxhPVtdLGw9MCxjPXRoaXMuc3RlcCx1PTAsZD0iIixoPTAscD1yP3Qocik6dGhpcy5zaGlmdDtmb3IoaD0wO2g8bztoKyspYT1oJTI/YS5jb25jYXQoc1toXSk6YS5jb25jYXQobihzW2hdLGMpKTtmb3Iobz1hLmxlbmd0aCxoPTA7aDxvO2grKyl7dT1pKGFbaF0sdSksL1xzezAsfVxzezAsfVNFTEVDVFxzezAsfS8uZXhlYyhhW2hdKSYmKGFbaF09YVtoXS5yZXBsYWNlKC9cLC9nLCIsXG4iK2MrYykpLC9cc3swLH1cc3swLH1TRVRcc3swLH0vLmV4ZWMoYVtoXSkmJihhW2hdPWFbaF0ucmVwbGFjZSgvXCwvZywiLFxuIitjK2MpKSwvXHN7MCx9XChcc3swLH1TRUxFQ1Rcc3swLH0vLmV4ZWMoYVtoXSk/KGwrKyxkKz1wW2xdK2FbaF0pOi9cJy8uZXhlYyhhW2hdKT8odTwxJiZsJiZsLS0sZCs9YVtoXSk6KGQrPXBbbF0rYVtoXSx1PDEmJmwmJmwtLSl9cmV0dXJuIGQ9ZC5yZXBsYWNlKC9eXG57MSx9LywiIikucmVwbGFjZSgvXG57MSx9L2csIlxuIil9LGUucHJvdG90eXBlLnhtbG1pbj1mdW5jdGlvbih0LGUpe3ZhciBpPWU/dDp0LnJlcGxhY2UoL1w8IVsgXHJcblx0XSooLS0oW15cLV18W1xyXG5dfC1bXlwtXSkqLS1bIFxyXG5cdF0qKVw+L2csIiIpLnJlcGxhY2UoL1sgXHJcblx0XXsxLH14bWxucy9nLCIgeG1sbnMiKTtyZXR1cm4gaS5yZXBsYWNlKC8+XHN7MCx9PC9nLCI+PCIpfSxlLnByb3RvdHlwZS5qc29ubWluPWZ1bmN0aW9uKHQpe3JldHVybiJ1bmRlZmluZWQiPT10eXBlb2YgSlNPTj90OkpTT04uc3RyaW5naWZ5KEpTT04ucGFyc2UodCksbnVsbCwwKX0sZS5wcm90b3R5cGUuY3NzbWluPWZ1bmN0aW9uKHQsZSl7dmFyIGk9ZT90OnQucmVwbGFjZSgvXC9cKihbXipdfFtcclxuXXwoXCorKFteKlwvXXxbXHJcbl0pKSkqXCorXC8vZywiIik7cmV0dXJuIGkucmVwbGFjZSgvXHN7MSx9L2csIiAiKS5yZXBsYWNlKC9ce1xzezEsfS9nLCJ7IikucmVwbGFjZSgvXH1cc3sxLH0vZywifSIpLnJlcGxhY2UoL1w7XHN7MSx9L2csIjsiKS5yZXBsYWNlKC9cL1wqXHN7MSx9L2csIi8qIikucmVwbGFjZSgvXCpcL1xzezEsfS9nLCIqLyIpfSxlLnByb3RvdHlwZS5zcWxtaW49ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXHN7MSx9L2csIiAiKS5yZXBsYWNlKC9cc3sxLH1cKC8sIigiKS5yZXBsYWNlKC9cc3sxLH1cKS8sIikiKX0sd2luZG93LnZrYmVhdXRpZnk9bmV3IGV9KCl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9e05PTkU6Im5vbmUiLFNMSURFOiJzbGlkZSIsRkFERToiZmFkZSJ9O3JldHVybntERUZBVUxUX0RVUkFUSU9OOjQwMCxFRkZFQ1RTOmUsYW5pbWF0ZTpmdW5jdGlvbihpLG4pe3N3aXRjaChufHwobj17fSksdC5pc1N0cmluZyhuKSYmKG49e2VmZmVjdDpufSksbi5lZmZlY3Qpe2Nhc2UgZS5TTElERTpjYXNlIGUuRkFERTppLmhpZGUoKSxpLnRvZ2dsZShuKTticmVhaztjYXNlIGUuTk9ORTp9fX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpeyEodC5leHBvcnRzPXtVUDozOCxET1dOOjQwLERFTDo0NixUQUI6OSxSRVRVUk46MTMsRU5URVI6MTMsRVNDOjI3LENPTU1BOjE4OCxQQUdFVVA6MzMsUEFHRURPV046MzQsU1BBQ0U6MzIsQkFDS1NQQUNFOjgsX19pc0tleTpmdW5jdGlvbih0LGUpe3JldHVybih0LndoaWNofHx0LmtleUNvZGUpPT10aGlzW2VdfSxpc0VudGVyOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9faXNLZXkodCwiRU5URVIiKX0saXNFc2M6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX19pc0tleSh0LCJFU0MiKX0saXNTcGFjZUJhcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fX2lzS2V5KHQsIlNQQUNFIil9fSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDEzOSksaSgxNTYpLGkoMTQ0KSxpKDE0NyldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe2Z1bmN0aW9uIG8odCl7dmFyIGk9WyIlY21peHBhbmVsOiIrdCxjXS5jb25jYXQoZS5yZXN0KGFyZ3VtZW50cykpO3IubG9nLmFwcGx5KHIsaSl9dmFyIGE9ImVkMDRiYTdiNDNhYmJkZmJjNTc4YzU0MDJmODZhMDNlIixsPSI3MzYyM2QwMzVjZGFiZjExZTljZmQ3NTgwYzZkNWE5NyIsYz0iYmFja2dyb3VuZC1jb2xvcjojZjEwOyBjb2xvcjojZmZmOyBwYWRkaW5nOjJweCI7cmV0dXJuIG4uZXh0ZW5kKHtjb21wb25lbnQ6dm9pZCAwLG5hbWU6dm9pZCAwLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7aWYodHx8KHQ9e30pLCF0aGlzLmNvbXBvbmVudCl0aHJvdyBuZXcgRXJyb3IoIk11c3QgZGVmaW5lIG1ldHJpY3MgY29tcG9uZW50Iik7aWYoIXRoaXMubmFtZSl0aHJvdyBuZXcgRXJyb3IoIk11c3QgZGVmaW5lIG1ldHJpY3MgbmFtZSIpO3ZhciBlPXRoaXMuaXNQcm9kdWN0aW9uKCksbj1lP2w6YSxyPXRoaXMuZ2V0U3VwZXJQcm9wZXJ0aWVzKCkscz10aGlzLmdldERpc3RpbmN0SWQoKSxjPSF3aW5kb3cub2t0YXx8d2luZG93Lm9rdGEubWl4cGFuZWwhPT0hMTtpLmluaXQobix7fSx0aGlzLm5hbWUpLHRoaXMuX19pbnN0YW5jZT1pW3RoaXMubmFtZV0sdGhpcy5fX2luc3RhbmNlLnJlZ2lzdGVyKHIpLHRoaXMuX19pbnN0YW5jZS5pZGVudGlmeShzKSx0aGlzLl9fc2VuZE1peHBhbmVsRXZlbnRzPWMmJihlfHx0LnNlbmRFdmVudHNJbkRldiksdGhpcy5fX3NlbmRNaXhwYW5lbEV2ZW50c3x8bygiaW5pdCIse2Rpc3RpbmN0SWQ6cyxpc1Byb2Q6ZSxzdXBlclByb3BlcnRpZXM6cn0pfSxpc1Byb2R1Y3Rpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldERlcGxveUVudmlyb25tZW50KCk7cmV0dXJuIlBSRVZJRVciPT09dHx8IlBST0QiPT09dH0sZ2V0RGlzdGluY3RJZDpmdW5jdGlvbigpe3JldHVybiB0KCIjYW5hbHl0aWNzLXVpZCIpLnRleHQoKX0sZ2V0RGVwbG95RW52aXJvbm1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdCgiI2FuYWx5dGljcy1lbnYiKS50ZXh0KCl8fCJERVYifSxnZXRTdXBlclByb3BlcnRpZXM6ZnVuY3Rpb24oKXtyZXR1cm57ZW52OnRoaXMuZ2V0RGVwbG95RW52aXJvbm1lbnQoKX19LGdldERlZmF1bHRQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7cmV0dXJue21ldHJpY3NDb21wb25lbnQ6dGhpcy5jb21wb25lbnQsbWV0cmljc05hbWU6dGhpcy5uYW1lfX0sZ2V0RnVsbEV2ZW50TmFtZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldERlZmF1bHRQcm9wZXJ0aWVzKCk7cmV0dXJuIHMudHBsKCJ7e21ldHJpY3NDb21wb25lbnR9fTp7e21ldHJpY3NOYW1lfX06e3tldmVudE5hbWV9fSIpKHttZXRyaWNzQ29tcG9uZW50OmUubWV0cmljc0NvbXBvbmVudCxtZXRyaWNzTmFtZTplLm1ldHJpY3NOYW1lLGV2ZW50TmFtZTp0fSl9LHRyYWNrOmZ1bmN0aW9uKGksbil7dmFyIHM9ZS5leHRlbmQodGhpcy5nZXREZWZhdWx0UHJvcGVydGllcygpLG4pLGE9dC5EZWZlcnJlZCgpLGw9dGhpcy5nZXRGdWxsRXZlbnROYW1lKGkpO3JldHVybiB0aGlzLl9fc2VuZE1peHBhbmVsRXZlbnRzP3RoaXMuX19pbnN0YW5jZS50cmFjayhsLHMsZnVuY3Rpb24oKXthLnJlc29sdmUoKX0pOihsLmxlbmd0aD4zMCYmci53YXJuKCJQcmVmaXhlZCBldmVudCBuYW1lIGlzIHRvbyBsb25nICg+MzApOiIrbCksbygidHJhY2siLGwscyksZS5kZWZlcihhLnJlc29sdmUpKSxhLnByb21pc2UoKX0sdGltZUV2ZW50OmZ1bmN0aW9uKHQpe3RoaXMuX19zZW5kTWl4cGFuZWxFdmVudHM/dGhpcy5fX2luc3RhbmNlLnRpbWVfZXZlbnQodGhpcy5nZXRGdWxsRXZlbnROYW1lKHQpKTpvKCJ0aW1lX2V2ZW50Iix0aGlzLmdldEZ1bGxFdmVudE5hbWUodCkpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9bmV3IFJlZ0V4cCgiKFxcZCkoPz0oXFxkezN9KSsoPyFcXGQpKSIsImciKTtyZXR1cm57bnVtYmVyVG9TdHJpbmc6ZnVuY3Rpb24oaSxuKXt2YXIgcj1ufHwiLCI7cmV0dXJuIHQuaXNOdW1iZXIoaSk/U3RyaW5nKGkpLnJlcGxhY2UoZSwiJDEiK3IpOiIwIn19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNzcpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS5sb2NhbGl6ZSxuPXtTVFJJTkc6InN0cmluZyIsTlVNQkVSOiJudW1iZXIiLElOVEVHRVI6ImludGVnZXIiLEJPT0xFQU46ImJvb2xlYW4iLE9CSkVDVDoib2JqZWN0IixGT1JNQVRESVNQTEFZVFlQRTp7ImRhdGUtdGltZSI6ImRhdGUiLHVyaToidXJpIixlbWFpbDoiZW1haWwiLCJjb3VudHJ5LWNvZGUiOiJjb3VudHJ5LWNvZGUiLCJsYW5ndWFnZS1jb2RlIjoibGFuZ3VhZ2UtY29kZSIsbG9jYWxlOiJsb2NhbGUiLHRpbWV6b25lOiJ0aW1lem9uZSIsInJlZi1pZCI6InJlZmVyZW5jZSJ9LEFSUkFZRElTUExBWVRZUEU6e2FycmF5b2ZvYmplY3Q6ImFycmF5b2ZvYmplY3QiLGFycmF5b2ZzdHJpbmc6ImFycmF5b2ZzdHJpbmciLGFycmF5b2ZudW1iZXI6ImFycmF5b2ZudW1iZXIiLGFycmF5b2ZpbnRlZ2VyOiJhcnJheW9maW50ZWdlciJ9LERJU1BMQVlUWVBFUzp7ZGF0ZTp7dHlwZToic3RyaW5nIixmb3JtYXQ6ImRhdGUtdGltZSJ9LHVyaTp7dHlwZToic3RyaW5nIixmb3JtYXQ6InVyaSJ9LGVtYWlsOnt0eXBlOiJzdHJpbmciLGZvcm1hdDoiZW1haWwifSwiY291bnRyeS1jb2RlIjp7dHlwZToic3RyaW5nIixmb3JtYXQ6ImNvdW50cnktY29kZSJ9LCJsYW5ndWFnZS1jb2RlIjp7dHlwZToic3RyaW5nIixmb3JtYXQ6Imxhbmd1YWdlLWNvZGUifSxsb2NhbGU6e3R5cGU6InN0cmluZyIsZm9ybWF0OiJsb2NhbGUifSx0aW1lem9uZTp7dHlwZToic3RyaW5nIixmb3JtYXQ6InRpbWV6b25lIn0sc3RyaW5nOnt0eXBlOiJzdHJpbmcifSxudW1iZXI6e3R5cGU6Im51bWJlciJ9LCJib29sZWFuIjp7dHlwZToiYm9vbGVhbiJ9LGludGVnZXI6e3R5cGU6ImludGVnZXIifSxyZWZlcmVuY2U6e3R5cGU6InN0cmluZyIsZm9ybWF0OiJyZWYtaWQifSxhcnJheW9mb2JqZWN0Ont0eXBlOiJhcnJheSIsaXRlbXM6e3R5cGU6Im9iamVjdCJ9fSxhcnJheW9mc3RyaW5nOnt0eXBlOiJhcnJheSIsaXRlbXM6e3R5cGU6InN0cmluZyJ9fSxhcnJheW9mbnVtYmVyOnt0eXBlOiJhcnJheSIsaXRlbXM6e3R5cGU6Im51bWJlciJ9fSxhcnJheW9maW50ZWdlcjp7dHlwZToiYXJyYXkiLGl0ZW1zOnt0eXBlOiJpbnRlZ2VyIn19LGltYWdlOnt0eXBlOiJpbWFnZSJ9LHBhc3N3b3JkOnt0eXBlOiJzdHJpbmcifX0sU1VQUE9SVFNNSU5NQVg6WyJzdHJpbmciLCJudW1iZXIiLCJpbnRlZ2VyIiwicGFzc3dvcmQiXSxEQVRBVFlQRTp7c3RyaW5nOiJzdHJpbmciLG51bWJlcjoibnVtYmVyIiwiYm9vbGVhbiI6ImJvb2xlYW4iLGludGVnZXI6ImludGVnZXIiLGRhdGU6ImRhdGV0aW1lIixvYmplY3Q6Im9iamVjdCIsYXJyYXlvZm9iamVjdDoib2JqZWN0IGFycmF5IixhcnJheW9mc3RyaW5nOiJzdHJpbmcgYXJyYXkiLGFycmF5b2ZudW1iZXI6Im51bWJlciBhcnJheSIsYXJyYXlvZmludGVnZXI6ImludGVnZXIgYXJyYXkiLCJjb3VudHJ5LWNvZGUiOiJjb3VudHJ5IGNvZGUiLCJsYW5ndWFnZS1jb2RlIjoibGFuZ3VhZ2UgY29kZSIscmVmZXJlbmNlOiJyZWZlcmVuY2UiLHRpbWV6b25lOiJ0aW1lem9uZSIsaW1hZ2U6ImltYWdlIn0sTVVUQUJJTElUWTp7UkVBRE9OTFk6IlJFQURfT05MWSIsV1JJVEVPTkxZOiJXUklURV9PTkxZIixSRUFEV1JJVEU6IlJFQURfV1JJVEUiLElNTVVUQUJMRToiSU1NVVRBQkxFIn0sU0NPUEU6e05PTkU6Ik5PTkUiLFNFTEY6IlNFTEYiLFNZU1RFTToiU1lTVEVNIn0sRElTUExBWVNDT1BFOntTRUxGOiJVc2VyIHBlcnNvbmFsIixTWVNURU06IlN5c3RlbSIsTkE6Ik5vbmUifSxVTklPTjp7RElTQUJMRToiRElTQUJMRSIsRU5BQkxFOiJFTkFCTEUifSxVTklPTl9PUFRJT05TOntESVNBQkxFOmkoInVuaXZlcnNhbC1kaXJlY3RvcnkucHJvZmlsZXMuYXR0cmlidXRlLmZvcm0udW5pb24uZW5hYmxlLmRpc3BsYXkiKSxFTkFCTEU6aSgidW5pdmVyc2FsLWRpcmVjdG9yeS5wcm9maWxlcy5hdHRyaWJ1dGUuZm9ybS51bmlvbi5kaXNhYmxlLmRpc3BsYXkiKX0sUEVSTUlTU0lPTjp7SElERToiSElERSIsUkVBRF9PTkxZOiJSRUFEX09OTFkiLFdSSVRFX09OTFk6IldSSVRFX09OTFkiLFJFQURfV1JJVEU6IlJFQURfV1JJVEUifSxFTkRVU0VSX0FUVFJJQlVURV9QRVJNSVNTSU9OX09QVElPTlM6e0hJREU6aSgidW5pdmVyc2FsLWRpcmVjdG9yeS5wcm9maWxlcy5hdHRyaWJ1dGUuZW5kdXNlci5wZXJtaXNzaW9uLmhpZGUiKSxSRUFEX09OTFk6aSgidW5pdmVyc2FsLWRpcmVjdG9yeS5wcm9maWxlcy5hdHRyaWJ1dGUuZW5kdXNlci5wZXJtaXNzaW9uLnJlYWRvbmx5IiksUkVBRF9XUklURTppKCJ1bml2ZXJzYWwtZGlyZWN0b3J5LnByb2ZpbGVzLmF0dHJpYnV0ZS5lbmR1c2VyLnBlcm1pc3Npb24ucmVhZHdyaXRlIil9LEFUVFJJQlVURV9MRVZFTF9NQVNURVJJTkdfT1BUSU9OUzp7SU5IRVJJVDppKCJ1bml2ZXJzYWwtZGlyZWN0b3J5LnByb2ZpbGVzLmF0dHJpYnV0ZS5tYXN0ZXIuaW5oZXJpdCIpLE9LVEFfTUFTVEVSRUQ6aSgidW5pdmVyc2FsLWRpcmVjdG9yeS5wcm9maWxlcy5hdHRyaWJ1dGUubWFzdGVyLm9rdGFtYXN0ZXJlZCIpLE9WRVJSSURFOmkoInVuaXZlcnNhbC1kaXJlY3RvcnkucHJvZmlsZXMuYXR0cmlidXRlLm1hc3Rlci5vdmVycmlkZSIpfSxVU0VSTkFNRVRZUEU6e05PTkU6Im5vbi11c2VybmFtZSIsT0tUQV9UT19BUFA6Im9rdGEtdG8tYXBwLXVzZXJuYW1lIixPS1RBX1RPX0FEOiJva3RhLXRvLWFkLXVzZXJuYW1lIixBUFBfVE9fT0tUQToiYXBwLXRvLW9rdGEtdXNlcm5hbWUiLElEUF9UT19PS1RBOiJpZHAtdG8tb2t0YS11c2VybmFtZSJ9LGdldERpc3BsYXlUeXBlOmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByO3JldHVybiB0JiYocj1lP3RoaXMuRk9STUFURElTUExBWVRZUEVbZV06aT90aGlzLkFSUkFZRElTUExBWVRZUEVbdCsib2YiK2ldOnQpLHJ8fChyPSJ1bmRlZmluZWQiPT10eXBlb2Ygbj8iIjpuKSxyfSxnZXRTb3VyY2VVc2VybmFtZVR5cGU6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuVVNFUk5BTUVUWVBFLk5PTkU7cmV0dXJuIm9rdGFUb0FwcCI9PT10PyJ1c2VyTmFtZSI9PT1lP249dGhpcy5VU0VSTkFNRVRZUEUuT0tUQV9UT19BUFA6ImNuIj09PWUmJihuPXRoaXMuVVNFUk5BTUVUWVBFLk9LVEFfVE9fQUQpOiJhcHBUb09rdGEiPT09dCYmImxvZ2luIj09PWUmJihuPSJzYW1sX2lkcCI9PT1pP3RoaXMuVVNFUk5BTUVUWVBFLklEUF9UT19PS1RBOnRoaXMuVVNFUk5BTUVUWVBFLkFQUF9UT19PS1RBKSxufSxpc0FycmF5RGF0YVR5cGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuY29udGFpbnModC52YWx1ZXModGhpcy5BUlJBWURJU1BMQVlUWVBFKSxlKX0saXNPYmplY3REYXRhVHlwZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5EQVRBVFlQRS5vYmplY3Q9PT10fX07cmV0dXJuIG59LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMTc4KSxpKDcpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj17IiZhbXA7IjoiJiIsIiZsdDsiOiI8IiwiJmd0OyI6Ij4iLCImcXVvdDsiOiciJywiJiMzOTsiOiInIiwiJiMwMzk7IjoiJyIsIiYjeDJGOyI6Ii8ifSxyPS9eKChbXjw+KClbXF1cXC4sOzpcc0BcIl0rKFwuW148PigpW1xdXFwuLDs6XHNAXCJdKykqKXwoXCIuK1wiKSlAKD8hLSkoKFxbP1swLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cXT8pfCgoW2EtekEtWlwtMC05XStcLikrW2EtekEtWl17Mix9KSkkLyxzPXtzcHJpbnRmOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3Rocm93IG5ldyBFcnJvcigiTWlzbWF0Y2ggbnVtYmVyIG9mIHZhcmlhYmxlczogIithcmd1bWVudHNbMF0rIiwgIitKU09OLnN0cmluZ2lmeShlKSl9Zm9yKHZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpLGk9ZS5zaGlmdCgpLG49aSxyPTAscz1lLmxlbmd0aDtyPHM7cisrKXt2YXIgbz1lW3JdO2k9aS5yZXBsYWNlKCJ7IityKyJ9IixvKSx2b2lkIDAhPT1vJiZudWxsIT09byYmaSE9PW58fHQoKSxuPWl9cmV0dXJuL1x7W1xkK11cfS8udGVzdChpKSYmdCgpLGl9LHBhcnNlUXVlcnk6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXt9LGk9ZGVjb2RlVVJJQ29tcG9uZW50KHQucmVwbGFjZSgvXCsvZywiICIpKS5zcGxpdCgiJiIpLG49MDtuPGkubGVuZ3RoO24rKyl7dmFyIHI9aVtuXSxzPXIuc3BsaXQoIj0iKTtlW3Muc2hpZnQoKV09cy5qb2luKCI9Iil9cmV0dXJuIGV9LGVuY29kZUpTT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkodCkpfSxkZWNvZGVKU09iamVjdDpmdW5jdGlvbih0KXt0cnl7cmV0dXJuIEpTT04ucGFyc2UoZGVjb2RlVVJJQ29tcG9uZW50KHQpKX1jYXRjaChlKXtyZXR1cm4gbnVsbH19LHVuZXNjYXBlSHRtbDpmdW5jdGlvbih0KXtyZXR1cm4gU3RyaW5nKHQpLnJlcGxhY2UoLyZbXHdcI1xkXXsyLH07L2csZnVuY3Rpb24odCl7cmV0dXJuIG5bdF18fHR9KX0sbG9jYWxpemU6ZnVuY3Rpb24oZSxuLHIpe3ZhciBvPW4/aVtuXTppW3Qua2V5cyhpKVswXV07aWYoIW8pcmV0dXJuIkwxME5fRVJST1JbIituKyJdIjt2YXIgYT1vW2VdO3RyeXtyPXImJnIuc2xpY2U/ci5zbGljZSgwKTpbXSxyLnVuc2hpZnQoYSksYT1zLnNwcmludGYuYXBwbHkobnVsbCxyKX1jYXRjaChsKXthPW51bGx9cmV0dXJuIGF8fCJMMTBOX0VSUk9SWyIrZSsiXSJ9LHBhcnNlRmxvYXQ6ZnVuY3Rpb24odCl7dmFyIGU9K3Q7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0JiZlPT09cGFyc2VGbG9hdCh0KT9lOnR9LHJhbmRvbVN0cmluZzpmdW5jdGlvbihlKXt2YXIgaT0iMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFRaYWJjZGVmZ2hpa2xtbm9wcXJzdHV2d3h5eiI7aWYodm9pZCAwPT09ZSllPXQucmFuZG9tKGkubGVuZ3RoKTtlbHNlIGlmKDA9PT1lKXJldHVybiIiO2Zvcih2YXIgbj1bXTtlLS07KW4ucHVzaChpW3QucmFuZG9tKGkubGVuZ3RoLTEpXSk7cmV0dXJuIG4uam9pbigiIil9LGVuZHNXaXRoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrPSIiLGUrPSIiLHQubGVuZ3RoPj1lLmxlbmd0aCYmdC5zdWJzdHJpbmcodC5sZW5ndGgtZS5sZW5ndGgpPT09ZX0saXNFbWFpbDpmdW5jdGlvbihpKXt2YXIgbj1lLnRyaW0oaSk7cmV0dXJuIXQuaXNFbXB0eShuKSYmci50ZXN0KG4pfX07cmV0dXJuIHN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDIxKSxpKDUpLGkoMTc5KSxpKDE4MCksaSgxODEpLGkoMSksaSgxODIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7ZnVuY3Rpb24gbChlKXtyZXR1cm4gZT90Lm1hcE9iamVjdChlLGZ1bmN0aW9uKGUpe3ZhciBpPXtsb2dpbjp7fSxjb3VudHJ5Ont9fTtpZighdC5pc09iamVjdChlKSl0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZm9ybWF0IGZvciAiaTE4biInKTtyZXR1cm4gdC5lYWNoKGUsZnVuY3Rpb24odCxlKXt2YXIgbj1lLnNwbGl0KC9eY291bnRyeVwuLyk7bi5sZW5ndGg+MT9pLmNvdW50cnlbblsxXV09dDppLmxvZ2luW25bMF1dPXR9KSxpfSk6e319ZnVuY3Rpb24gYygpe3ZhciB0PUpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0ocCkpO3JldHVybiB0JiZ0LnZlcnNpb249PT1vLnZlcnNpb258fCh0PXt2ZXJzaW9uOm8udmVyc2lvbn0pLHR9ZnVuY3Rpb24gdSh0LGUsaSl7dmFyIG49YygpO25bdF09e2xvZ2luOmUsY291bnRyeTppfSxsb2NhbFN0b3JhZ2Uuc2V0SXRlbShwLEpTT04uc3RyaW5naWZ5KG4pKX1mdW5jdGlvbiBkKHQsZSxuKXt2YXIgcixzO3JldHVybiByPWUucmVwbGFjZSgiLSIsIl8iKSxzPW4ucmV3cml0ZShmKHtidW5kbGU6dCxsYW5ndWFnZUNvZGU6cn0pKSxpLmFqYXgoe3VybDpuLmJhc2VVcmwrcyxkYXRhVHlwZToianNvbnAiLGNhY2hlOiEwLHRpbWVvdXQ6NWUzLGpzb25wQ2FsbGJhY2s6Impzb25wXyIrdH0pfWZ1bmN0aW9uIGgoaSxuKXtpZigiZW4iPT09aXx8IXQuY29udGFpbnMoby5zdXBwb3J0ZWRMYW5ndWFnZXMsaSkpcmV0dXJuIGUoe30pO3ZhciByPSFhLmxvY2FsU3RvcmFnZUlzTm90U3VwcG9ydGVkKCk7aWYocil7dmFyIGw9YygpO2lmKGxbaV0pcmV0dXJuIGUobFtpXSl9cmV0dXJuIGUuYWxsKFtkKCJsb2dpbiIsaSxuKSxkKCJjb3VudHJ5IixpLG4pXSkuc3ByZWFkKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHImJnUoaSx0LGUpLHtsb2dpbjp0LGNvdW50cnk6ZX19KS5mYWlsKGZ1bmN0aW9uKCl7cmV0dXJuIHMud2FybigiVW5hYmxlIHRvIGxvYWQgbGFuZ3VhZ2U6ICIraSkse319KX12YXIgcD0ib3N3Lmxhbmd1YWdlcyIsZj10LnRlbXBsYXRlKCIvbGFiZWxzL2pzb25wL3t7YnVuZGxlfX1fe3tsYW5ndWFnZUNvZGV9fS5qc29ucCIpO3JldHVybntsb2dpbjpuLGNvdW50cnk6cixjdXJyZW50TGFuZ3VhZ2U6bnVsbCxpc0xvYWRlZDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jdXJyZW50TGFuZ3VhZ2U9PT10fSxsb2FkTGFuZ3VhZ2U6ZnVuY3Rpb24oZSxpLHMpe3ZhciBvPWwoaSksYT1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuIGgoZSxzKS50aGVuKHQuYmluZChmdW5jdGlvbihpKXt0aGlzLmxvZ2luPXQuZXh0ZW5kKHt9LG4saS5sb2dpbiksdGhpcy5jb3VudHJ5PXQuZXh0ZW5kKHt9LHIsaS5jb3VudHJ5KSxvW2FdJiYodC5leHRlbmQodGhpcy5sb2dpbixvW2FdLmxvZ2luKSx0LmV4dGVuZCh0aGlzLmNvdW50cnksb1thXS5jb3VudHJ5KSksdGhpcy5jdXJyZW50TGFuZ3VhZ2U9ZX0sdGhpcykpfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9e3NpZ25vdXQ6IlNpZ24gT3V0IixyZW1lbWJlcjoiUmVtZW1iZXIgbWUiLHJlbWVtYmVyRGV2aWNlOiJUcnVzdCB0aGlzIGRldmljZSIsInJlbWVtYmVyRGV2aWNlLnRpbWViYXNlZCI6IkRvIG5vdCBjaGFsbGVuZ2UgbWUgb24gdGhpcyBkZXZpY2UgZm9yIHRoZSBuZXh0IHswfSIsInJlbWVtYmVyRGV2aWNlLmRldmljZWJhc2VkIjoiRG8gbm90IGNoYWxsZW5nZSBtZSBvbiB0aGlzIGRldmljZSBhZ2FpbiIsYXV0b1B1c2g6IlNlbmQgcHVzaCBhdXRvbWF0aWNhbGx5Iix1bmxvY2thY2NvdW50OiJVbmxvY2sgYWNjb3VudD8iLG5lZWRoZWxwOiJOZWVkIGhlbHAgc2lnbmluZyBpbj8iLGdvYmFjazoiQmFjayB0byBTaWduIEluIixmb3Jnb3RwYXNzd29yZDoiRm9yZ290IHBhc3N3b3JkPyIsaGVscDoiSGVscCIscmV0cnk6IlJldHJ5IiwibWludXRlcy5vbmVNaW51dGUiOiJtaW51dGUiLG1pbnV0ZXM6InswfSBtaW51dGVzIixob3VyczoiezB9IGhvdXJzIixkYXlzOiJ7MH0gZGF5cyIsImVycm9yLmNvbmZpZyI6IlRoZXJlIHdhcyBhIGNvbmZpZ3VyYXRpb24gZXJyb3IiLCJlcnJvci5yZXF1aXJlZC5hdXRoUGFyYW1zIjonTWlzc2luZyBwYXJhbWV0ZXJzIGZvciB0aGUgY29uZmlndXJlZCBhdXRoZW50aWNhdGlvbiBzY2hlbWUgLSAiT0FVVEgyIicsImVycm9yLnJlcXVpcmVkLmJhc2VVcmwiOiciYmFzZVVybCIgaXMgYSByZXF1aXJlZCB3aWRnZXQgcGFyYW1ldGVyJywiZXJyb3IucmVxdWlyZWQuc3VjY2VzcyI6IkEgc3VjY2VzcyBoYW5kbGVyIGlzIHJlcXVpcmVkIiwiZXJyb3IucmVxdWlyZWQuZWwiOiciZWwiIGlzIGEgcmVxdWlyZWQgd2lkZ2V0IHBhcmFtZXRlcicsImVycm9yLnVuc3VwcG9ydGVkLmJyb3dzZXIiOiJVbnN1cHBvcnRlZCBicm93c2VyIiwiZXJyb3IudW5zdXBwb3J0ZWQuY29ycyI6IlVuc3VwcG9ydGVkIGJyb3dzZXIgLSBtaXNzaW5nIENPUlMgc3VwcG9ydCIsImVycm9yLnVuc3VwcG9ydGVkLmxvY2FsU3RvcmFnZSI6IlVuc3VwcG9ydGVkIGJyb3dzZXIgLSBtaXNzaW5nIGxvY2FsU3RvcmFnZSBzdXBwb3J0IiwiZXJyb3IuZW5hYmxlZC5jb3JzIjoiVGhlcmUgd2FzIGFuIGVycm9yIHNlbmRpbmcgdGhlIHJlcXVlc3QgLSBoYXZlIHlvdSBlbmFibGVkIENPUlM/IiwiZXJyb3IuZXhwaXJlZC5zZXNzaW9uIjoiWW91ciBzZXNzaW9uIGhhcyBleHBpcmVkLiBQbGVhc2UgdHJ5IHRvIGxvZyBpbiBhZ2Fpbi4iLCJlcnJvci5hdXRoLmxvY2tlZE91dCI6IllvdXIgYWNjb3VudCBpcyBsb2NrZWQuIFBsZWFzZSBjb250YWN0IHlvdXIgYWRtaW5pc3RyYXRvci4iLCJlcnJvci5vYXV0aC5pZFRva2VuIjoiVGhlcmUgd2FzIGEgcHJvYmxlbSBnZW5lcmF0aW5nIHRoZSBpZF90b2tlbiBmb3IgdGhlIHVzZXIuIFBsZWFzZSB0cnkgYWdhaW4uIiwiZXJyb3IubmV0d29yay5jb25uZWN0aW9uIjoiVW5hYmxlIHRvIGNvbm5lY3QgdG8gdGhlIHNlcnZlci4gUGxlYXNlIGNoZWNrIHlvdXIgbmV0d29yayBjb25uZWN0aW9uLiIsImVycm9yLnVzZXJuYW1lLnJlcXVpcmVkIjoiUGxlYXNlIGVudGVyIGEgdXNlcm5hbWUiLCJlcnJvci5wYXNzd29yZC5yZXF1aXJlZCI6IlBsZWFzZSBlbnRlciBhIHBhc3N3b3JkIiwiZXJyb3JzLkUwMDAwMDA0IjoiU2lnbiBpbiBmYWlsZWQhIiwiZXJyb3JzLkUwMDAwMDY5IjoiWW91ciBhY2NvdW50IHdhcyBsb2NrZWQgZHVlIHRvIGV4Y2Vzc2l2ZSBNRkEgYXR0ZW1wdHMuIiwiZXJyb3JzLkUwMDAwMDQ3IjoiWW91IGV4Y2VlZGVkIHRoZSBtYXhpbXVtIG51bWJlciBvZiByZXF1ZXN0cy4gVHJ5IGFnYWluIGluIGEgd2hpbGUuIiwiZXJyb3JzLkUwMDAwMDAxIjoiQXBpIHZhbGlkYXRpb24gZmFpbGVkOiB7MH0iLCJlcnJvcnMuRTAwMDAwMDIiOiJUaGUgcmVxdWVzdCB3YXMgbm90IHZhbGlkOiB7MH0iLCJlcnJvcnMuRTAwMDAwMDMiOiJUaGUgcmVxdWVzdCBib2R5IHdhcyBub3Qgd2VsbC1mb3JtZWQuIiwiZXJyb3JzLkUwMDAwMDA1IjoiSW52YWxpZCBzZXNzaW9uIiwiZXJyb3JzLkUwMDAwMDA2IjoiWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gcGVyZm9ybSB0aGUgcmVxdWVzdGVkIGFjdGlvbiIsImVycm9ycy5FMDAwMDAwNyI6Ik5vdCBmb3VuZDogezB9IiwiZXJyb3JzLkUwMDAwMDA4IjoiVGhlIHJlcXVlc3RlZCBwYXRoIHdhcyBub3QgZm91bmQiLCJlcnJvcnMuRTAwMDAwMDkiOiJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLCJlcnJvcnMuRTAwMDAwMTAiOiJTZXJ2aWNlIGlzIGluIHJlYWQgb25seSBtb2RlIiwiZXJyb3JzLkUwMDAwMDExIjoiSW52YWxpZCB0b2tlbiBwcm92aWRlZCIsImVycm9ycy5FMDAwMDAxMiI6IlVuc3VwcG9ydGVkIG1lZGlhIHR5cGUiLCJlcnJvcnMuRTAwMDAwMTMiOiJJbnZhbGlkIGNsaWVudCBhcHAgaWQiLCJlcnJvcnMuRTAwMDAwMTUiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgdGhlIGZlYXR1cmUgeW91IGFyZSByZXF1ZXN0aW5nIiwiZXJyb3JzLkUwMDAwMDE2IjoiQWN0aXZhdGlvbiBmYWlsZWQgYmVjYXVzZSB0aGUgdXNlciBpcyBhbHJlYWR5IGFjdGl2ZSIsImVycm9ycy5FMDAwMDAxNyI6IlBhc3N3b3JkIHJlc2V0IGZhaWxlZCIsImVycm9ycy5FMDAwMDAxOCI6IkJhZCByZXF1ZXN0LiAgQWNjZXB0IGFuZC9vciBDb250ZW50LVR5cGUgaGVhZGVycyBhcmUgbGlrZWx5IG5vdCBzZXQuIiwiZXJyb3JzLkUwMDAwMDE5IjoiQmFkIHJlcXVlc3QuICBBY2NlcHQgYW5kL29yIENvbnRlbnQtVHlwZSBoZWFkZXJzIGxpa2VseSBkbyBub3QgbWF0Y2ggc3VwcG9ydGVkIHZhbHVlcy4iLCJlcnJvcnMuRTAwMDAwMjAiOiJCYWQgcmVxdWVzdC4iLCJlcnJvcnMuRTAwMDAwMjEiOiJCYWQgcmVxdWVzdC4gIEFjY2VwdCBhbmQvb3IgQ29udGVudC1UeXBlIGhlYWRlcnMgbGlrZWx5IGRvIG5vdCBtYXRjaCBzdXBwb3J0ZWQgdmFsdWVzLiIsImVycm9ycy5FMDAwMDAyMiI6IlRoZSBlbmRwb2ludCBkb2VzIG5vdCBzdXBwb3J0IHRoZSBwcm92aWRlZCBIVFRQIG1ldGhvZCIsImVycm9ycy5FMDAwMDAyMyI6Ik9wZXJhdGlvbiBmYWlsZWQgYmVjYXVzZSB1c2VyIHByb2ZpbGUgaXMgbWFzdGVyZWQgdW5kZXIgYW5vdGhlciBzeXN0ZW0iLCJlcnJvcnMuRTAwMDAwMjQiOiJCYWQgcmVxdWVzdC4gIFRoaXMgb3BlcmF0aW9uIG9uIGFwcCBtZXRhZGF0YSBpcyBub3QgeWV0IHN1cHBvcnRlZC4iLCJlcnJvcnMuRTAwMDAwMjUiOiJBcHAgdmVyc2lvbiBhc3NpZ25tZW50IGZhaWxlZC4iLCJlcnJvcnMuRTAwMDAwMjYiOiJUaGlzIGVuZHBvaW50IGhhcyBiZWVuIGRlcHJlY2F0ZWQuIiwiZXJyb3JzLkUwMDAwMDI3IjoiR3JvdXAgcHVzaCBiYWQgcmVxdWVzdCA6IHswfSIsImVycm9ycy5FMDAwMDAyOCI6IlRoZSByZXF1ZXN0IGlzIG1pc3NpbmcgYSByZXF1aXJlZCBwYXJhbWV0ZXIuIiwiZXJyb3JzLkUwMDAwMDI5IjoiSW52YWxpZCBwYWdpbmcgcmVxdWVzdC4iLCJlcnJvcnMuRTAwMDAwMzAiOiJCYWQgcmVxdWVzdC4gSW52YWxpZCBkYXRlLiBEYXRlcyBtdXN0IGJlIG9mIHRoZSBmb3JtIHl5eXktTU0tZGQnJ1QnJ0hIOm1tOnNzLlNTU1paLCBlLmcuIDIwMTMtMDEtMDFUMTI6MDA6MDAuMDAwLTA3OjAwLiIsImVycm9ycy5FMDAwMDAzMSI6IkludmFsaWQgc2VhcmNoIGNyaXRlcmlhLiIsImVycm9ycy5FMDAwMDAzMiI6IlVubG9jayBpcyBub3QgYWxsb3dlZCBmb3IgdGhpcyB1c2VyLiIsImVycm9ycy5FMDAwMDAzMyI6IkJhZCByZXF1ZXN0LiBDYW4ndCBzcGVjaWZ5IGEgc2VhcmNoIHF1ZXJ5IGFuZCBmaWx0ZXIgaW4gdGhlIHNhbWUgcmVxdWVzdC4iLCJlcnJvcnMuRTAwMDAwMzQiOiJGb3Jnb3QgcGFzc3dvcmQgbm90IGFsbG93ZWQgb24gc3BlY2lmaWVkIHVzZXIuIiwiZXJyb3JzLkUwMDAwMDM1IjoiQ2hhbmdlIHBhc3N3b3JkIG5vdCBhbGxvd2VkIG9uIHNwZWNpZmllZCB1c2VyLiIsImVycm9ycy5FMDAwMDAzNiI6IkNoYW5nZSByZWNvdmVyeSBxdWVzdGlvbiBub3QgYWxsb3dlZCBvbiBzcGVjaWZpZWQgdXNlci4iLCJlcnJvcnMuRTAwMDAwMzciOiJUeXBlIG1pc21hdGNoIGV4Y2VwdGlvbi4iLCJlcnJvcnMuRTAwMDAwMzgiOiJUaGlzIG9wZXJhdGlvbiBpcyBub3QgYWxsb3dlZCBpbiB0aGUgdXNlcicncyBjdXJyZW50IHN0YXR1cy4iLCJlcnJvcnMuRTAwMDAwMzkiOiJPcGVyYXRpb24gb24gYXBwbGljYXRpb24gc2V0dGluZ3MgZmFpbGVkLiIsImVycm9ycy5FMDAwMDA0MCI6IkFwcGxpY2F0aW9uIGxhYmVsIG11c3Qgbm90IGJlIHRoZSBzYW1lIGFzIGFuIGV4aXN0aW5nIGFwcGxpY2F0aW9uIGxhYmVsLiIsImVycm9ycy5FMDAwMDA0MSI6IkNyZWRlbnRpYWxzIHNob3VsZCBub3QgYmUgc2V0IG9uIHRoaXMgcmVzb3VyY2UgYmFzZWQgb24gdGhlIHNjaGVtZS4iLCJlcnJvcnMuRTAwMDAwNDIiOiJTZXR0aW5nIHRoZSBlcnJvciBwYWdlIHJlZGlyZWN0IFVSTCBmYWlsZWQuIiwiZXJyb3JzLkUwMDAwMDQzIjoiU2VsZiBzZXJ2aWNlIGFwcGxpY2F0aW9uIGFzc2lnbm1lbnQgaXMgbm90IGVuYWJsZWQuIiwiZXJyb3JzLkUwMDAwMDQ0IjoiU2VsZiBzZXJ2aWNlIGFwcGxpY2F0aW9uIGFzc2lnbm1lbnQgaXMgbm90IHN1cHBvcnRlZC4iLCJlcnJvcnMuRTAwMDAwNDUiOiJGaWVsZCBtYXBwaW5nIGJhZCByZXF1ZXN0LiIsImVycm9ycy5FMDAwMDA0NiI6IkRlYWN0aXZhdGUgYXBwbGljYXRpb24gZm9yIHVzZXIgZm9yYmlkZGVuLiIsImVycm9ycy5FMDAwMDA0OCI6IkVudGl0eSBub3QgZm91bmQgZXhjZXB0aW9uLiIsImVycm9ycy5FMDAwMDA0OSI6IkludmFsaWQgU0NJTSBkYXRhIGZyb20gU0NJTSBpbXBsZW1lbnRhdGlvbi4iLCJlcnJvcnMuRTAwMDAwNTAiOiJJbnZhbGlkIFNDSU0gZGF0YSBmcm9tIGNsaWVudC4iLCJlcnJvcnMuRTAwMDAwNTEiOiJObyByZXNwb25zZSBmcm9tIFNDSU0gaW1wbGVtZW50YXRpb24uIiwiZXJyb3JzLkUwMDAwMDUyIjoiRW5kcG9pbnQgbm90IGltcGxlbWVudGVkLiIsImVycm9ycy5FMDAwMDA1MyI6IkludmFsaWQgU0NJTSBmaWx0ZXIuIiwiZXJyb3JzLkUwMDAwMDU0IjoiSW52YWxpZCBwYWdpbmF0aW9uIHByb3BlcnRpZXMuIiwiZXJyb3JzLkUwMDAwMDU1IjoiRHVwbGljYXRlIGdyb3VwLiIsImVycm9ycy5FMDAwMDA1NiI6IkRlbGV0ZSBhcHBsaWNhdGlvbiBmb3JiaWRkZW4uIiwiZXJyb3JzLkUwMDAwMDU3IjoiQWNjZXNzIHRvIHRoaXMgYXBwbGljYXRpb24gaXMgZGVuaWVkIGR1ZSB0byBhIHBvbGljeS4iLCJlcnJvcnMuRTAwMDAwNTgiOiJBY2Nlc3MgdG8gdGhpcyBhcHBsaWNhdGlvbiByZXF1aXJlcyBNRkE6IHswfSIsImVycm9ycy5FMDAwMDA1OSI6IlRoZSBjb25uZWN0b3IgY29uZmlndXJhdGlvbiBjb3VsZCBub3QgYmUgdGVzdGVkLiBNYWtlIHN1cmUgdGhhdCB0aGUgVVJMLCBBdXRoZW50aWNhdGlvbiBQYXJhbWV0ZXJzIGFyZSBjb3JyZWN0IGFuZCB0aGF0IHRoZXJlIGlzIGFuIGltcGxlbWVudGF0aW9uIGF2YWlsYWJsZSBhdCB0aGUgVVJMIHByb3ZpZGVkLiIsImVycm9ycy5FMDAwMDA2MCI6IlVuc3VwcG9ydGVkIG9wZXJhdGlvbi4iLCJlcnJvcnMuRTAwMDAwNjEiOiJUYWIgZXJyb3I6IHswfSIsImVycm9ycy5FMDAwMDA2MiI6IlRoZSBzcGVjaWZpZWQgdXNlciBpcyBhbHJlYWR5IGFzc2lnbmVkIHRvIHRoZSBhcHBsaWNhdGlvbi4iLCJlcnJvcnMuRTAwMDAwNjMiOiJJbnZhbGlkIGNvbWJpbmF0aW9uIG9mIHBhcmFtZXRlcnMgc3BlY2lmaWVkLiIsImVycm9ycy5FMDAwMDA2NCI6IlBhc3N3b3JkIGlzIGV4cGlyZWQgYW5kIG11c3QgYmUgY2hhbmdlZC4iLCJlcnJvcnMuRTAwMDAwNjUiOiJJbnRlcm5hbCBlcnJvciBwcm9jZXNzaW5nIGFwcCBtZXRhZGF0YS4iLCJlcnJvcnMuRTAwMDAwNjYiOiJBUE5TIGlzIG5vdCBjb25maWd1cmVkLCBjb250YWN0IHlvdXIgYWRtaW4iLCJlcnJvcnMuRTAwMDAwNjciOiJGYWN0b3JzIFNlcnZpY2UgRXJyb3IuIiwiZXJyb3JzLkUwMDAwMDcwIjoiV2FpdGluZyBmb3IgQUNLIiwiZXJyb3JzLkUwMDAwMDcxIjoiVW5zdXBwb3J0ZWQgT1MgVmVyc2lvbjogezB9IiwiZXJyb3JzLkUwMDAwMDcyIjoiTUlNIHBvbGljeSBzZXR0aW5ncyBoYXZlIGRpc2FsbG93ZWQgZW5yb2xsbWVudCBmb3IgdGhpcyB1c2VyIiwiZXJyb3JzLkUwMDAwMDczIjoiVXNlciByZWplY3RlZCBhdXRoZW50aWNhdGlvbiIsImVycm9ycy5FMDAwMDA3NCI6IkZhY3RvciBTZXJ2aWNlIEVycm9yIiwiZXJyb3JzLkUwMDAwMDc1IjoiQ2Fubm90IG1vZGlmeSB0aGUgezB9IGF0dHJpYnV0ZSBiZWNhdXNlIGl0IGhhcyBhIGZpZWxkIG1hcHBpbmcgYW5kIHByb2ZpbGUgcHVzaCBpcyBlbmFibGVkLiIsImVycm9ycy5FMDAwMDA3NiI6IkNhbm5vdCBtb2RpZnkgdGhlIGFwcCB1c2VyIGJlY2F1c2UgaXQgaXMgbWFzdGVyZWQgYnkgYW4gZXh0ZXJuYWwgYXBwLiIsImVycm9ycy5FMDAwMDA3NyI6IkNhbm5vdCBtb2RpZnkgdGhlIHswfSBhdHRyaWJ1dGUgYmVjYXVzZSBpdCBpcyByZWFkLW9ubHkuIiwiZXJyb3JzLkUwMDAwMDc4IjoiQ2Fubm90IG1vZGlmeSB0aGUgezB9IGF0dHJpYnV0ZSBiZWNhdXNlIGl0IGlzIGltbXV0YWJsZS4iLCJlcnJvcnMuRTAwMDAwNzkiOiJUaGlzIG9wZXJhdGlvbiBpcyBub3QgYWxsb3dlZCBpbiB0aGUgY3VycmVudCBhdXRoZW50aWNhdGlvbiBzdGF0ZS4iLCJlcnJvcnMuRTAwMDAwODEiOiJDYW5ub3QgbW9kaWZ5IHRoZSB7MH0gYXR0cmlidXRlIGJlY2F1c2UgaXQgaXMgYSByZXNlcnZlZCBhdHRyaWJ1dGUgZm9yIHRoaXMgYXBwbGljYXRpb24uIiwiZXJyb3JzLkUwMDAwMDgyIjoiRWFjaCBjb2RlIGNhbiBvbmx5IGJlIHVzZWQgb25jZS4gUGxlYXNlIHdhaXQgZm9yIGEgbmV3IGNvZGUgYW5kIHRyeSBhZ2Fpbi4iLCJlcnJvcnMuRTAwMDAwODMiOiJQYXNzQ29kZSBpcyB2YWxpZCBidXQgZXhjZWVkZWQgdGltZSB3aW5kb3cuIiwiZXJyb3JzLkUwMDAwMDg0IjoiQXBwIGV2YWx1YXRpb24gZXJyb3IuIiwiZXJyb3JzLkUwMDAwMDg1IjoiWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIHlvdXIgYWNjb3VudCBhdCB0aGlzIHRpbWUuIiwiZXJyb3JzLkUwMDAwMDg2IjoiVGhpcyBwb2xpY3kgY2Fubm90IGJlIGFjdGl2YXRlZCBhdCB0aGlzIHRpbWUuIiwiZXJyb3JzLkUwMDAwMDg3IjoiVGhlIHJlY292ZXJ5IHF1ZXN0aW9uIGFuc3dlciBkaWQgbm90IG1hdGNoIG91ciByZWNvcmRzLiIsImVycm9ycy5FMDAwMDA5MCI6IlRoZSByb2xlIHNwZWNpZmllZCBpcyBhbHJlYWR5IGFzc2lnbmVkIHRvIHRoZSB1c2VyLiIsImVycm9ycy5FMDAwMDA5MSI6IlRoZSBwcm92aWRlZCByb2xlIHR5cGUgd2FzIG5vdCB0aGUgc2FtZSBhcyByZXF1aXJlZCByb2xlIHR5cGUuIiwiZXJyb3JzLkUwMDAwMDkyIjoiQWNjZXNzIHRvIHRoaXMgYXBwbGljYXRpb24gcmVxdWlyZXMgcmUtYXV0aGVudGljYXRpb246IHswfSIsImVycm9ycy5FMDAwMDA5MyI6IlRhcmdldCBjb3VudCBsaW1pdCBleGNlZWRlZCIsImVycm9ycy5FMDAwMDA5NCI6IlRoZSBwcm92aWRlZCBmaWx0ZXIgaXMgdW5zdXBwb3J0ZWQuIiwiZXJyb3JzLkUwMDAwMDk1IjoiUmVjb3Zlcnkgbm90IGFsbG93ZWQgZm9yIHVua25vd24gdXNlci4iLCJlcnJvcnMuRTAwMDAwOTYiOiJUaGlzIGNlcnRpZmljYXRlIGhhcyBhbHJlYWR5IGJlZW4gdXBsb2FkZWQgd2l0aCBraWQ9ezB9LiIsImVycm9ycy5FMDAwMDA5NyI6IlRoZXJlIGlzIG5vIHZlcmlmaWVkIHBob25lIG51bWJlciBvbiBmaWxlLiIsImVycm9ycy5FMDAwMDA5OCI6IlRoaXMgcGhvbmUgbnVtYmVyIGlzIGludmFsaWQuIiwiZXJyb3JzLkUwMDAwMDk5IjoiT25seSBudW1iZXJzIGxvY2F0ZWQgaW4gVVMgYW5kIENhbmFkYSBhcmUgYWxsb3dlZC4gIENvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yIGlmIHRoaXMgaXMgYSBwcm9ibGVtLiIsImVycm9ycy5FMDAwMDEwMCI6IlVuYWJsZSB0byBwZXJmb3JtIHNlYXJjaCBxdWVyeS4iLCJlcnJvcnMuRTAwMDAxMDEiOiJVcGxvYWQgZmFpbGVkIGJlY2F1c2Ugb2YgYSBwcm9ibGVtIHdpdGggeW91ciBpcGEgZmlsZSwgezB9IiwiZXJyb3JzLkUwMDAwMTAyIjoiWXViaUtleSBjYW5ub3QgYmUgZGVsZXRlZCB3aGlsZSBhc3NpZ25lZCB0byBhbiB1c2VyLiBQbGVhc2UgZGVhY3RpdmF0ZSBZdWJpS2V5IHVzaW5nIHJlc2V0IE1GQSBhbmQgdHJ5IGFnYWluIiwiZXJyb3JzLkUwMDAwMTAzIjoiQWN0aW9uIG9uIGRldmljZSBhbHJlYWR5IGluIHF1ZXVlIG9yIGluIHByb2dyZXNzIiwiZXJyb3JzLkUwMDAwMTA0IjoiRGV2aWNlIGlzIGFscmVhZHkgbG9ja2VkIGFuZCBjYW5ub3QgYmUgbG9ja2VkIGFnYWluIiwiZXJyb3JzLkUwMDAwMTA1IjoiWW91IGhhdmUgYWNjZXNzZWQgYW4gYWNjb3VudCByZWNvdmVyeSBsaW5rIHRoYXQgaGFzIGV4cGlyZWQgb3IgYmVlbiBwcmV2aW91c2x5IHVzZWQuIiwiZXJyb3JzLkUwMDAwMTA2IjoiV2FpdCBmb3IgdG9rZW4gdG8gY2hhbmdlLCB0aGVuIGVudGVyIHRoZSBuZXcgdG9rZW5jb2RlLiIsImVycm9ycy5FMDAwMDEwNyI6IlRoZSBlbnRpdHkgaXMgbm90IGluIHRoZSBleHBlY3RlZCBzdGF0ZSBmb3IgdGhlIHJlcXVlc3RlZCB0cmFuc2l0aW9uLiIsImVycm9ycy5FMDAwMDEwOSI6IkFuIFNNUyBtZXNzYWdlIHdhcyByZWNlbnRseSBzZW50LiBQbGVhc2Ugd2FpdCAzMCBzZWNvbmRzIGJlZm9yZSB0cnlpbmcgYWdhaW4uIiwiZXJyb3JzLkUwMDAwMTEwIjoiWW91IGhhdmUgYWNjZXNzZWQgYSBsaW5rIHRoYXQgaGFzIGV4cGlyZWQgb3IgaGFzIGJlZW4gcHJldmlvdXNseSB1c2VkLiIsImVycm9ycy5FMDAwMDExMSI6IkNhbm5vdCBtb2RpZnkgdGhlIHswfSBvYmplY3QgYmVjYXVzZSBpdCBpcyByZWFkLW9ubHkuIiwiZXJyb3JzLkUwMDAwMTEyIjoiQ2Fubm90IHVwZGF0ZSB0aGlzIHVzZXIgYmVjYXVzZSB0aGV5IGFyZSBzdGlsbCBiZWluZyBhY3RpdmF0ZWQuIFBsZWFzZSB0cnkgYWdhaW4gaW4gYSBmZXcgbWludXRlcy4iLCJlcnJvcnMuRTAwMDAxMTMiOiJ7MH0uIiwiZXJyb3JzLkUwMDAwMTE0IjoiQSB1c2VyIHdpdGggdGhpcyBsb2dpbiBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgY3VycmVudCBvcmdhbml6YXRpb24uIiwiZXJyb3JzLkUwMDAwMTE1IjoiVXBsb2FkIGZhaWxlZCwgezB9IiwiZXJyb3JzLkUwMDAwMTE2IjoiezB9Iiwib2Zvcm0ubmV4dCI6Ik5leHQiLCJvZm9ybS52ZXJpZnkiOiJWZXJpZnkiLCJvZm9ybS5zZW5kIjoiU2VuZCIsIm9mb3JtLmJhY2siOiJCYWNrIiwib2Zvcm0uc2F2ZSI6IlNhdmUiLCJvZm9ybS5jYW5jZWwiOiJDYW5jZWwiLCJvZm9ybS5lZGl0IjoiRWRpdCIsIm9mb3JtLnByZXZpb3VzIjoiUHJldmlvdXMiLCJvZm9ybS5lcnJvcmJhbm5lci50aXRsZSI6IldlIGZvdW5kIHNvbWUgZXJyb3JzLiBQbGVhc2UgcmV2aWV3IHRoZSBmb3JtIGFuZCBtYWtlIGNvcnJlY3Rpb25zLiIsIm9mb3JtLmVycm9ybXNnLnRpdGxlIjoiUGxlYXNlIHJldmlldyB0aGUgZm9ybSB0byBjb3JyZWN0IHRoZSBmb2xsb3dpbmcgZXJyb3JzOiIsIm9mb3JtLmVycm9yLnVuZXhwZWN0ZWQiOiJUaGVyZSB3YXMgYW4gdW5leHBlY3RlZCBpbnRlcm5hbCBlcnJvci4gUGxlYXNlIHRyeSBhZ2Fpbi4iLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmJsYW5rIjoiVGhlIGZpZWxkIGNhbm5vdCBiZSBsZWZ0IGJsYW5rIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5hc2NpaSI6IlRoZSBmaWVsZCBjYW5ub3QgY29udGFpbiBOb24tQVNDSUkgY2hhcmFjdGVycyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQud3JvbmcudHlwZSI6IlRoZSBmaWVsZCBpcyBvZiB0aGUgd3JvbmcgdHlwZSIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuaW52YWxpZCI6IlRoZSBmaWVsZCBoYXMgYW4gaW52YWxpZCB2YWx1ZSIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQudmFsdWUubm90LmFsbG93ZWQiOiJUaGUgZmllbGQgdmFsdWUgaXMgbm90IGFsbG93ZWQiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmFycmF5Lm1pbkl0ZW1zIjoiVGhlIGFycmF5IGRvZXMgbm90IGhhdmUgZW5vdWdoIGl0ZW1zIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5hcnJheS5tYXhJdGVtcyI6IlRoZSBhcnJheSBjb250YWlucyB0b28gbWFueSBpdGVtcyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuYXJyYXkudW5pcXVlIjoiVGhlIGFycmF5IGNhbiBvbmx5IGhhdmUgdW5pcXVlIHZhbHVlcyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQudG9vLmxvbmciOiJUaGUgZmllbGQgY2Fubm90IGV4Y2VlZCB7MH0gY2hhcmFjdGVycyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQudG9vLnNtYWxsIjoiVGhlIGZpZWxkIGNhbm5vdCBiZSBsZXNzIHRoYW4gezB9IGNoYXJhY3RlcnMiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLnN0cmluZy5taW5MZW5ndGgiOiJUaGlzIGZpZWxkIGNhbm5vdCBiZSBsZXNzIHRoYW4gdGhlIG1pbmltdW0gcmVxdWlyZWQgY2hhcmFjdGVycyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuc3RyaW5nLm1heExlbmd0aCI6IlRoaXMgZmllbGQgY2Fubm90IGV4Y2VlZCB0aGUgbWF4aW11bSBhbGxvd2VkIGNoYXJhY3RlcnMiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0LmVtYWlsIjoiVGhpcyB2YWx1ZSBpcyBub3QgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkLmZvcm1hdC51cmkiOiJUaGlzIHZhbHVlIGlzIG5vdCBhIHZhbGlkIFVSSSIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuaW52YWxpZC5mb3JtYXQuaXB2NCI6IlRoaXMgdmFsdWUgaXMgbm90IGEgdmFsaWQgSVB2NCBhZGRyZXNzIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkLmZvcm1hdC5ob3N0bmFtZSI6IlRoaXMgdmFsdWUgaXMgbm90IGEgdmFsaWQgaG9zdG5hbWUiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLnVzZXJuYW1lIjoiUGxlYXNlIGNoZWNrIHlvdXIgdXNlcm5hbWUiLCJmYWN0b3IudG90cFNvZnQub2t0YVZlcmlmeSI6Ik9rdGEgVmVyaWZ5IiwiZmFjdG9yLnRvdHBTb2Z0Lmdvb2dsZUF1dGhlbnRpY2F0b3IiOiJHb29nbGUgQXV0aGVudGljYXRvciIsImZhY3Rvci50b3RwU29mdC5kZXNjcmlwdGlvbiI6IkVudGVyIHNpbmdsZS11c2UgY29kZSBmcm9tIHRoZSBtb2JpbGUgYXBwLiIsImZhY3Rvci50b3RwSGFyZC5yc2FTZWN1cklkIjoiUlNBIFNlY3VySUQiLCJmYWN0b3IudG90cEhhcmQuc3ltYW50ZWNWaXAiOiJTeW1hbnRlYyBWSVAiLCJmYWN0b3IudG90cEhhcmQuZGVzY3JpcHRpb24iOiJFbnRlciBhIHNpbmdsZS11c2UgY29kZSBmcm9tIGEgaGFyZHdhcmUgdG9rZW4uIiwiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkiOiJZdWJpa2V5IiwiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkuZGVzY3JpcHRpb24iOiJJbnNlcnQgeW91ciBZdWJpa2V5IGFuZCB0YXAgaXQgdG8gZ2V0IGEgdmVyaWZpY2F0aW9uIGNvZGUuIiwiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkucGxhY2Vob2xkZXIiOiJDbGljayBoZXJlLCB0aGVuIHRhcCB5b3VyIFl1YmlrZXkiLCJmYWN0b3Iub2t0YVZlcmlmeVB1c2giOiJPa3RhIFZlcmlmeSIsImZhY3Rvci5wdXNoLmRlc2NyaXB0aW9uIjoiVXNlIGEgcHVzaCBub3RpZmljYXRpb24gc2VudCB0byB0aGUgbW9iaWxlIGFwcC4iLCJmYWN0b3IuZHVvIjoiRHVvIFNlY3VyaXR5IiwiZmFjdG9yLmR1by5kZXNjcmlwdGlvbiI6IlVzZSBQdXNoIE5vdGlmaWNhdGlvbiwgU01TLCBvciBWb2ljZSBjYWxsIHRvIGF1dGhlbnRpY2F0ZS4iLCJmYWN0b3Iuc21zIjoiU01TIEF1dGhlbnRpY2F0aW9uIiwiZmFjdG9yLnNtcy5kZXNjcmlwdGlvbiI6IkVudGVyIGEgc2luZ2xlLXVzZSBjb2RlIHNlbnQgdG8geW91ciBtb2JpbGUgcGhvbmUuIiwiZmFjdG9yLmNhbGwiOiJWb2ljZSBDYWxsIEF1dGhlbnRpY2F0aW9uIiwiZmFjdG9yLmNhbGwuZGVzY3JpcHRpb24iOiJVc2UgYSBwaG9uZSB0byBhdXRoZW50aWNhdGUgYnkgZm9sbG93aW5nIHZvaWNlIGluc3RydWN0aW9ucy4iLCJmYWN0b3Iuc2VjdXJpdHlRdWVzdGlvbiI6IlNlY3VyaXR5IFF1ZXN0aW9uIiwiZmFjdG9yLnNlY3VyaXR5UXVlc3Rpb24uZGVzY3JpcHRpb24iOiJVc2UgdGhlIGFuc3dlciB0byBhIHNlY3VyaXR5IHF1ZXN0aW9uIHRvIGF1dGhlbnRpY2F0ZS4iLCJmYWN0b3Iud2luZG93c0hlbGxvIjoiV2luZG93cyBIZWxsbyIsImZhY3Rvci53aW5kb3dzSGVsbG8uc2lnbmluLmRlc2NyaXB0aW9uIjoiU2lnbiBpbiB0byBPa3RhIHVzaW5nIFdpbmRvd3MgSGVsbG8uIiwiZmFjdG9yLnUyZiI6IlNlY3VyaXR5IEtleSAoVTJGKSIsImZhY3Rvci51MmYuZGVzY3JpcHRpb24iOiJVc2UgYSBVbml2ZXJzYWwgMm5kIEZhY3RvciAoVTJGKSBzZWN1cml0eSBrZXkgdG8gc2lnbiBvbiB0byBPa3RhLiIsImZhY3Rvci5lbWFpbCI6IkVtYWlsIEF1dGhlbnRpY2F0aW9uIiwibWZhLmNoYWxsZW5nZS52ZXJpZnkiOiJWZXJpZnkiLCJtZmEuY2hhbGxlbmdlLmFuc3dlci5wbGFjZWhvbGRlciI6IkFuc3dlciIsIm1mYS5jaGFsbGVuZ2UuYW5zd2VyLnRvb2x0aXAiOiJBbnN3ZXIiLCJtZmEuY2hhbGxlbmdlLmFuc3dlci5zaG93QW5zd2VyIjoiU2hvdyIsIm1mYS5jaGFsbGVuZ2UuYW5zd2VyLmhpZGVBbnN3ZXIiOiJIaWRlIiwibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUucGxhY2Vob2xkZXIiOiJFbnRlciBDb2RlIiwibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUudG9vbHRpcCI6IkVudGVyIENvZGUiLCJtZmEuYmFja1RvRmFjdG9ycyI6IkJhY2sgdG8gZmFjdG9yIGxpc3QiLCJtZmEucGhvbmVOdW1iZXIucGxhY2Vob2xkZXIiOiJQaG9uZSBudW1iZXIiLCJtZmEucGhvbmVOdW1iZXIuZXh0LnBsYWNlaG9sZGVyIjoiRXh0ZW5zaW9uIiwibWZhLnNlbmRDb2RlIjoiU2VuZCBjb2RlIiwibWZhLnNlbnQiOiJTZW50IiwibWZhLnJlc2VuZENvZGUiOiJSZS1zZW5kIGNvZGUiLCJtZmEuY2FsbCI6IkNhbGwiLCJtZmEuY2FsbGluZyI6IkNhbGxpbmciLCJtZmEucmVkaWFsIjoiUmVkaWFsIiwibWZhLnNlbmRFbWFpbCI6IlNlbmQgZW1haWwiLCJtZmEucmVzZW5kRW1haWwiOiJSZS1zZW5kIGVtYWlsIiwibWZhLnNjYW5CYXJjb2RlIjoiU2NhbiBiYXJjb2RlIiwibWZhLm5vQWNjZXNzVG9FbWFpbCI6IkNhbid0IGFjY2VzcyBlbWFpbCIsInBhc3N3b3JkLnJlc2V0IjoiUmVzZXQgUGFzc3dvcmQiLCJwYXNzd29yZC5vbGRQYXNzd29yZC5wbGFjZWhvbGRlciI6Ik9sZCBwYXNzd29yZCIsInBhc3N3b3JkLm9sZFBhc3N3b3JkLnRvb2x0aXAiOiJPbGQgcGFzc3dvcmQiLCJwYXNzd29yZC5uZXdQYXNzd29yZC5wbGFjZWhvbGRlciI6Ik5ldyBwYXNzd29yZCIsInBhc3N3b3JkLm5ld1Bhc3N3b3JkLnRvb2x0aXAiOiJOZXcgcGFzc3dvcmQiLCJwYXNzd29yZC5jb25maXJtUGFzc3dvcmQucGxhY2Vob2xkZXIiOiJSZXBlYXQgcGFzc3dvcmQiLCJwYXNzd29yZC5jb25maXJtUGFzc3dvcmQudG9vbHRpcCI6IlJlcGVhdCBwYXNzd29yZCIsInBhc3N3b3JkLmVycm9yLm1hdGNoIjoiTmV3IHBhc3N3b3JkcyBtdXN0IG1hdGNoIiwicmVjb3Zlcnkuc21zLmhpbnQiOiJTTVMgY2FuIG9ubHkgYmUgdXNlZCBpZiBhIG1vYmlsZSBwaG9uZSBudW1iZXIgaGFzIGJlZW4gY29uZmlndXJlZC4iLCJyZWNvdmVyeS5tb2JpbGUuaGludCI6InswfSBjYW4gb25seSBiZSB1c2VkIGlmIGEgbW9iaWxlIHBob25lIG51bWJlciBoYXMgYmVlbiBjb25maWd1cmVkLiIsInJlY292ZXJ5LnNtcyI6IlNNUyIsInJlY292ZXJ5LmNhbGwiOiJWb2ljZSBDYWxsIiwicmVjb3Zlcnkuc21zT3JDYWxsIjoiU01TIG9yIFZvaWNlIENhbGwiLCJlbnJvbGwuY2hvaWNlcy50aXRsZSI6IlNldCB1cCBtdWx0aWZhY3RvciBhdXRoZW50aWNhdGlvbiIsImVucm9sbC5jaG9pY2VzLmRlc2NyaXB0aW9uIjoiWW91ciBjb21wYW55IHJlcXVpcmVzIG11bHRpZmFjdG9yIGF1dGhlbnRpY2F0aW9uIHRvIGFkZCBhbiBhZGRpdGlvbmFsIGxheWVyIG9mIHNlY3VyaXR5IHdoZW4gc2lnbmluZyBpbnRvIHlvdXIgT2t0YSBhY2NvdW50IiwiZW5yb2xsLmNob2ljZXMub3B0aW9uYWwiOiJZb3UgY2FuIGNvbmZpZ3VyZSBhbnkgYWRkaXRpb25hbCBvcHRpb25hbCBmYWN0b3Igb3IgY2xpY2sgZmluaXNoIiwiZW5yb2xsLmNob2ljZXMubGlzdC5zZXR1cCI6IlNldHVwIHJlcXVpcmVkIiwiZW5yb2xsLmNob2ljZXMubGlzdC5lbnJvbGxlZCI6IkVucm9sbGVkIGZhY3RvcnMiLCJlbnJvbGwuY2hvaWNlcy5saXN0Lm9wdGlvbmFsIjoiQWRkaXRpb25hbCBvcHRpb25hbCBmYWN0b3JzIiwiZW5yb2xsLmNob2ljZXMuc3RlcCI6InswfSBvZiB7MX0iLCJlbnJvbGwuY2hvaWNlcy5zZXR1cCI6IlNldHVwIiwiZW5yb2xsLmNob2ljZXMuc3VibWl0LmZpbmlzaCI6IkZpbmlzaCIsImVucm9sbC5jaG9pY2VzLnN1Ym1pdC5jb25maWd1cmUiOiJDb25maWd1cmUgZmFjdG9yIiwiZW5yb2xsLmNob2ljZXMuc3VibWl0Lm5leHQiOiJDb25maWd1cmUgbmV4dCBmYWN0b3IiLCJlbnJvbGwuc2VjdXJpdHlRdWVzdGlvbi5zZXR1cCI6IlNldHVwIHNlY3JldCBxdWVzdGlvbiBhdXRoZW50aWNhdGlvbiIsInNlY3VyaXR5LmRpc2xpa2VkX2Zvb2QiOiJXaGF0IGlzIHRoZSBmb29kIHlvdSBsZWFzdCBsaWtlZCBhcyBhIGNoaWxkPyIsInNlY3VyaXR5Lm5hbWVfb2ZfZmlyc3RfcGx1c2hfdG95IjoiV2hhdCBpcyB0aGUgbmFtZSBvZiB5b3VyIGZpcnN0IHN0dWZmZWQgYW5pbWFsPyIsInNlY3VyaXR5LmZpcnN0X2F3YXJkIjoiV2hhdCBkaWQgeW91IGVhcm4geW91ciBmaXJzdCBtZWRhbCBvciBhd2FyZCBmb3I/Iiwic2VjdXJpdHkuZmF2b3JpdGVfc2VjdXJpdHlfcXVlc3Rpb24iOiJXaGF0IGlzIHlvdXIgZmF2b3JpdGUgc2VjdXJpdHkgcXVlc3Rpb24/Iiwic2VjdXJpdHkuZmF2b3JpdGVfdG95IjoiV2hhdCBpcyB0aGUgdG95L3N0dWZmZWQgYW5pbWFsIHlvdSBsaWtlZCB0aGUgbW9zdCBhcyBhIGtpZD8iLCJzZWN1cml0eS5maXJzdF9jb21wdXRlcl9nYW1lIjoiV2hhdCB3YXMgdGhlIGZpcnN0IGNvbXB1dGVyIGdhbWUgeW91IHBsYXllZD8iLCJzZWN1cml0eS5mYXZvcml0ZV9tb3ZpZV9xdW90ZSI6IldoYXQgaXMgeW91ciBmYXZvcml0ZSBtb3ZpZSBxdW90ZT8iLCJzZWN1cml0eS5maXJzdF9zcG9ydHNfdGVhbV9tYXNjb3QiOiJXaGF0IHdhcyB0aGUgbWFzY290IG9mIHRoZSBmaXJzdCBzcG9ydHMgdGVhbSB5b3UgcGxheWVkIG9uPyIsInNlY3VyaXR5LmZpcnN0X211c2ljX3B1cmNoYXNlIjoiV2hhdCBtdXNpYyBhbGJ1bSBvciBzb25nIGRpZCB5b3UgZmlyc3QgcHVyY2hhc2U/Iiwic2VjdXJpdHkuZmF2b3JpdGVfYXJ0X3BpZWNlIjoiV2hhdCBpcyB5b3VyIGZhdm9yaXRlIHBpZWNlIG9mIGFydD8iLCJzZWN1cml0eS5ncmFuZG1vdGhlcl9mYXZvcml0ZV9kZXNlcnQiOiJXaGF0IHdhcyB5b3VyIGdyYW5kbW90aGVyJ3MgZmF2b3JpdGUgZGVzc2VydD8iLCJzZWN1cml0eS5maXJzdF90aGluZ19jb29rZWQiOiJXaGF0IHdhcyB0aGUgZmlyc3QgdGhpbmcgeW91IGxlYXJuZWQgdG8gY29vaz8iLCJzZWN1cml0eS5jaGlsZGhvb2RfZHJlYW1fam9iIjoiV2hhdCB3YXMgeW91ciBkcmVhbSBqb2IgYXMgYSBjaGlsZD8iLCJzZWN1cml0eS5maXJzdF9raXNzX2xvY2F0aW9uIjoiV2hlcmUgZGlkIHlvdSBoYXZlIHlvdXIgZmlyc3Qga2lzcz8iLCJzZWN1cml0eS5wbGFjZV93aGVyZV9zaWduaWZpY2FudF9vdGhlcl93YXNfbWV0IjoiV2hlcmUgZGlkIHlvdSBtZWV0IHlvdXIgc3BvdXNlL3NpZ25pZmljYW50IG90aGVyPyIsInNlY3VyaXR5LmZhdm9yaXRlX3ZhY2F0aW9uX2xvY2F0aW9uIjoiV2hlcmUgZGlkIHlvdSBnbyBmb3IgeW91ciBmYXZvcml0ZSB2YWNhdGlvbj8iLCJzZWN1cml0eS5uZXdfeWVhcnNfdHdvX3Rob3VzYW5kIjoiV2hlcmUgd2VyZSB5b3Ugb24gTmV3IFllYXIncyBFdmUgaW4gdGhlIHllYXIgMjAwMD8iLCJzZWN1cml0eS5mYXZvcml0ZV9zcGVha2VyX2FjdG9yIjoiV2hvIGlzIHlvdXIgZmF2b3JpdGUgc3BlYWtlci9vcmF0b3I/Iiwic2VjdXJpdHkuZmF2b3JpdGVfYm9va19tb3ZpZV9jaGFyYWN0ZXIiOiJXaG8gaXMgeW91ciBmYXZvcml0ZSBib29rL21vdmllIGNoYXJhY3Rlcj8iLCJzZWN1cml0eS5mYXZvcml0ZV9zcG9ydHNfcGxheWVyIjoiV2hvIGlzIHlvdXIgZmF2b3JpdGUgc3BvcnRzIHBsYXllcj8iLCJlbnJvbGwuc21zLnNldHVwIjoiUmVjZWl2ZSBhIGNvZGUgdmlhIFNNUyB0byBhdXRoZW50aWNhdGUiLCJlbnJvbGwuc21zLnRyeV9hZ2FpbiI6IlRoZSBudW1iZXIgeW91IGVudGVyZWQgc2VlbXMgaW52YWxpZC4gSWYgdGhlIG51bWJlciBpcyBjb3JyZWN0LCBwbGVhc2UgdHJ5IGFnYWluLiIsImVucm9sbC5jYWxsLnNldHVwIjoiRm9sbG93IHBob25lIGNhbGwgaW5zdHJ1Y3Rpb25zIHRvIGF1dGhlbnRpY2F0ZSIsImVucm9sbC5vbnByZW0udXNlcm5hbWUucGxhY2Vob2xkZXIiOiJFbnRlciB7MH0gdXNlcm5hbWUiLCJlbnJvbGwub25wcmVtLnVzZXJuYW1lLnRvb2x0aXAiOiJFbnRlciB7MH0gdXNlcm5hbWUiLCJlbnJvbGwub25wcmVtLnBhc3Njb2RlLnBsYWNlaG9sZGVyIjoiRW50ZXIgezB9IHBhc3Njb2RlIiwiZW5yb2xsLm9ucHJlbS5wYXNzY29kZS50b29sdGlwIjoiRW50ZXIgezB9IHBhc3Njb2RlIiwiZW5yb2xsLnN5bWFudGVjVmlwLnN1YnRpdGxlIjoiRW50ZXIgQ3JlZGVudGlhbCBJRCBhbmQgdHdvIGNvbnNlY3V0aXZlIGdlbmVyYXRlZCBjb2RlcyIsImVucm9sbC5zeW1hbnRlY1ZpcC5jcmVkZW50aWFsSWQucGxhY2Vob2xkZXIiOiJFbnRlciBjcmVkZW50aWFsIElEIiwiZW5yb2xsLnN5bWFudGVjVmlwLmNyZWRlbnRpYWxJZC50b29sdGlwIjoiRW50ZXIgY3JlZGVudGlhbCBJRCIsImVucm9sbC5zeW1hbnRlY1ZpcC5wYXNzY29kZTEucGxhY2Vob2xkZXIiOiJTZWN1cml0eSBjb2RlIDEiLCJlbnJvbGwuc3ltYW50ZWNWaXAucGFzc2NvZGUxLnRvb2x0aXAiOiJTZWN1cml0eSBjb2RlIDEiLCJlbnJvbGwuc3ltYW50ZWNWaXAucGFzc2NvZGUyLnBsYWNlaG9sZGVyIjoiU2VjdXJpdHkgY29kZSAyIiwiZW5yb2xsLnN5bWFudGVjVmlwLnBhc3Njb2RlMi50b29sdGlwIjoiU2VjdXJpdHkgY29kZSAyIiwiZW5yb2xsLnl1YmlrZXkudGl0bGUiOiJTZXR1cCBZdWJpa2V5IiwiZW5yb2xsLnl1YmlrZXkuc3VidGl0bGUiOiJJbnNlcnQgeW91ciBZdWJpa2V5IGludG8gYSBVU0IgcG9ydCBhbmQgdGFwIGl0IHRvIGdlbmVyYXRlIGEgdmVyaWZpY2F0aW9uIGNvZGUiLCJlbnJvbGwudG90cC50aXRsZSI6IlNldHVwIHswfSIsImVucm9sbC50b3RwLnNlbGVjdERldmljZSI6IlNlbGVjdCB5b3VyIGRldmljZSB0eXBlIiwiZW5yb2xsLnRvdHAuZG93bmxvYWRBcHAiOidEb3dubG9hZCA8YSBocmVmPSJ7MH0iIGNsYXNzPSJpbmxpbmUtbGluayI+ezF9IGZyb20gdGhlIHsyfTwvYT4gb250byB5b3VyIG1vYmlsZSBkZXZpY2UuJywiZW5yb2xsLnRvdHAuaW5zdGFsbEFwcCI6Ikluc3RhbGwgezB9IiwiZW5yb2xsLmR1by50aXRsZSI6IlNldHVwIER1byBTZWN1cml0eSIsImVucm9sbC53aW5kb3dzSGVsbG8udGl0bGUiOiJFbnJvbGwgV2luZG93cyBIZWxsbyIsCgkiZW5yb2xsLndpbmRvd3NIZWxsby5zdWJ0aXRsZSI6IkNsaWNrIGJlbG93IHRvIGVucm9sbCBXaW5kb3dzIEhlbGxvIGFzIGEgc2Vjb25kIGZvcm0gb2YgYXV0aGVudGljYXRpb24iLCJlbnJvbGwud2luZG93c0hlbGxvLnN1YnRpdGxlLmxvYWRpbmciOiJQbGVhc2Ugd2FpdCB3aGlsZSBXaW5kb3dzIEhlbGxvIGlzIGxvYWRpbmcuLi4iLCJlbnJvbGwud2luZG93c0hlbGxvLnNhdmUiOiJFbnJvbGwgV2luZG93cyBIZWxsbyIsImVucm9sbC53aW5kb3dzSGVsbG8uZXJyb3Iubm90V2luZG93cyI6IldpbmRvd3MgSGVsbG8gY2FuIG9ubHkgYmUgdXNlZCBvbiBXaW5kb3dzIEVkZ2Ugd2l0aCBXaW5kb3dzIDEwLiBDb250YWN0IHlvdXIgYWRtaW4gZm9yIGFzc2lzdGFuY2UuIiwiZW5yb2xsLndpbmRvd3NIZWxsby5lcnJvci5ub3RDb25maWd1cmVkSHRtbCI6IldpbmRvd3MgSGVsbG8gaXMgbm90IGNvbmZpZ3VyZWQuIFNlbGVjdCB0aGUgPGI+U3RhcnQ8L2I+IGJ1dHRvbiwgdGhlbiBzZWxlY3QgPGI+U2V0dGluZ3M8L2I+ICZndDsgPGI+QWNjb3VudHM8L2I+ICZndDsgPGI+U2lnbi1pbjwvYj4gdG8gY29uZmlndXJlIFdpbmRvd3MgSGVsbG8uIiwidmVyaWZ5LndpbmRvd3NIZWxsby5zdWJ0aXRsZSI6IlZlcmlmeSB5b3VyIGlkZW50aXR5IHdpdGggV2luZG93cyBIZWxsbyIsInZlcmlmeS53aW5kb3dzSGVsbG8uc3VidGl0bGUubG9hZGluZyI6IlBsZWFzZSB3YWl0IHdoaWxlIFdpbmRvd3MgSGVsbG8gaXMgbG9hZGluZy4uLiIsInZlcmlmeS53aW5kb3dzSGVsbG8uc3VidGl0bGUuc2lnbmluZ0luIjoiU2lnbmluZyBpbnRvIE9rdGEuLi4iLCJ2ZXJpZnkud2luZG93c0hlbGxvLnNhdmUiOiJWZXJpZnkgd2l0aCBXaW5kb3dzIEhlbGxvIiwidmVyaWZ5LndpbmRvd3NIZWxsby5lcnJvci5ub3RGb3VuZCI6IllvdXIgV2luZG93cyBIZWxsbyBlbnJvbGxtZW50IGRvZXMgbm90IG1hdGNoIG91ciByZWNvcmRzLiBDb250YWN0IHlvdXIgYWRtaW5pc3RyYXRvciBmb3IgYXNzaXN0YW5jZS4iLCJ2ZXJpZnkud2luZG93c0hlbGxvLmVycm9yLm5vdEZvdW5kLnNlbGVjdEFub3RoZXIiOiJZb3VyIFdpbmRvd3MgSGVsbG8gZW5yb2xsbWVudCBkb2VzIG5vdCBtYXRjaCBvdXIgcmVjb3Jkcy4gU2VsZWN0IGFub3RoZXIgZmFjdG9yIG9yIGNvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yIGZvciBhc3Npc3RhbmNlLiIsImVucm9sbC51MmYudGl0bGUiOiJTZXR1cCBTZWN1cml0eSBLZXkgKFUyRikiLCJlbnJvbGwudTJmLnNhdmUiOiJSZWdpc3RlciBTZWN1cml0eSBLZXkiLCJlbnJvbGwudTJmLmdlbmVyYWwxIjoiSWYgdXNpbmcgRmlyZWZveCBkb3dubG9hZCBhbmQgaW5zdGFsbCB0aGUgVTJGIGJyb3dzZXIgZXh0ZW5zaW9uLiIsImVucm9sbC51MmYuZ2VuZXJhbDIiOiJNYWtlIHN1cmUgeW91IGhhdmUgYSBTZWN1cml0eSBLZXkuIElmIGFscmVhZHkgaW5zZXJ0ZWQsIHJlbW92ZSBpdCBub3cuPGJyPklmIHlvdSBoYXZlIGEgQmx1ZXRvb3RoIFNlY3VyaXR5IEtleSwgdHVybiBvbiB5b3VyIGNvbXB1dGVyJ3MgQmx1ZXRvb3RoLiIsImVucm9sbC51MmYuZ2VuZXJhbDMiOiJDbGljayB0aGUgYnV0dG9uIGJlbG93IHRvIHJlZ2lzdGVyIiwiZW5yb2xsLnUyZi5pbnN0cnVjdGlvbnMiOiJJbnNlcnQgeW91ciBTZWN1cml0eSBLZXkgaW50byBhIFVTQiBwb3J0IG9uIHRoaXMgY29tcHV0ZXIuIElmIGl0IGhhcyBhIGJ1dHRvbiBvciBnb2xkIGRpc2ssIHRhcCBpdC4iLCJlbnJvbGwudTJmLmluc3RydWN0aW9uc0JsdWV0b290aCI6IklmIHlvdSBhcmUgdXNpbmcgYSBCbHVldG9vdGggU2VjdXJpdHkgS2V5LCBwcmVzcyB0aGUgYnV0dG9uLiIsInUyZi5lcnJvci5ub3RTdXBwb3J0ZWRCcm93c2VyIjoiVGhlIFNlY3VyaXR5IEtleSBpcyBvbmx5IHN1cHBvcnRlZCBmb3IgQ2hyb21lIG9yIEZpcmVmb3ggYnJvd3NlcnMuIFNlbGVjdCBhbm90aGVyIGZhY3RvciBvciBjb250YWN0IHlvdXIgYWRtaW4gZm9yIGFzc2lzdGFuY2UuIiwidTJmLmVycm9yLm5vdFN1cHBvcnRlZEJyb3dzZXIub25lRmFjdG9yIjoiVGhlIFNlY3VyaXR5IEtleSBpcyBvbmx5IHN1cHBvcnRlZCBmb3IgQ2hyb21lIG9yIEZpcmVmb3ggYnJvd3NlcnMuIENvbnRhY3QgeW91ciBhZG1pbiBmb3IgYXNzaXN0YW5jZS4iLCJ1MmYuZXJyb3Iubm9GaXJlZm94RXh0ZW5zaW9uIjonPGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9Imh0dHBzOi8vYWRkb25zLm1vemlsbGEub3JnL2VuLVVTL2ZpcmVmb3gvYWRkb24vdTJmLXN1cHBvcnQtYWRkLW9uLyI+RG93bmxvYWQ8L2E+IGFuZCBpbnN0YWxsIHRoZSBGaXJlZm94IFUyRiBicm93c2VyIGV4dGVuc2lvbiBiZWZvcmUgcHJvY2VlZGluZy4gWW91IG1heSBiZSByZXF1aXJlZCB0byByZXN0YXJ0IHlvdXIgYnJvd3NlciBhZnRlciBpbnN0YWxsYXRpb24uJywidTJmLmVycm9yLm90aGVyIjoiQW4gdW5rbm93biBlcnJvciBoYXMgb2NjdXJlZC4gVHJ5IGFnYWluIG9yIHNlbGVjdCBhbm90aGVyIGZhY3Rvci4iLCJ1MmYuZXJyb3Iub3RoZXIub25lRmFjdG9yIjoiQW4gdW5rbm93biBlcnJvciBoYXMgb2NjdXJlZC4gVHJ5IGFnYWluIG9yIGNvbnRhY3QgeW91ciBhZG1pbiBmb3IgYXNzaXN0YW5jZS4iLCJ1MmYuZXJyb3IuYmFkUmVxdWVzdCI6IlRoZXJlIHdhcyBhbiBlcnJvciB3aXRoIHRoZSBVMkYgcmVxdWVzdC4gVHJ5IGFnYWluIG9yIHNlbGVjdCBhbm90aGVyIGZhY3Rvci4iLCJ1MmYuZXJyb3IuYmFkUmVxdWVzdC5vbmVGYWN0b3IiOiJUaGVyZSB3YXMgYW4gZXJyb3Igd2l0aCB0aGUgVTJGIHJlcXVlc3QuIFRyeSBhZ2FpbiBvciBjb250YWN0IHlvdXIgYWRtaW4gZm9yIGFzc2lzdGFuY2UuIiwidTJmLmVycm9yLnVuc3VwcG9ydGVkIjoiVGhlIHNlY3VyaXR5IGtleSBpcyB1bnN1cHBvcnRlZC4gU2VsZWN0IGFub3RoZXIgZmFjdG9yLiIsInUyZi5lcnJvci51bnN1cHBvcnRlZC5vbmVGYWN0b3IiOiJUaGUgc2VjdXJpdHkga2V5IGlzIHVuc3VwcG9ydGVkLiBDb250YWN0IHlvdXIgYWRtaW4gZm9yIGFzc2lzdGFuY2UuIiwidTJmLmVycm9yLnRpbWVvdXQiOiJZb3UgaGF2ZSB0aW1lZCBvdXQgb2YgdGhlIGF1dGhlbnRpY2F0aW9uIHBlcmlvZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLCJ2ZXJpZnkudTJmLmluc3RydWN0aW9ucyI6Ikluc2VydCB5b3VyIFNlY3VyaXR5IEtleS4gSWYgaXQgaGFzIGEgYnV0dG9uIG9yIGdvbGQgZGlzaywgdGFwwqBpdC4iLCJ2ZXJpZnkudTJmLmluc3RydWN0aW9uc0JsdWV0b290aCI6IklmIHlvdSBhcmUgdXNpbmcgYSBCbHVldG9vdGggU2VjdXJpdHkgS2V5LCB0dXJuIG9uIHlvdXIgY29tcHV0ZXIncyBCbHVldG9vdGggYW5kIHByZXNzIHRoZSBidXR0b24uIiwidmVyaWZ5LnUyZi5yZXRyeSI6IlJldHJ5IiwiZW5yb2xsLnRvdHAuZW50ZXJDb2RlIjoiRW50ZXIgY29kZSBkaXNwbGF5ZWQgZnJvbSB0aGUgYXBwbGljYXRpb24iLCJlbnJvbGwudG90cC5zZXR1cEFwcCI6IkxhdW5jaCB7MH0gYXBwbGljYXRpb24gb24geW91ciBtb2JpbGUgZGV2aWNlIGFuZCBzZWxlY3QgQWRkIGFuIGFjY291bnQuIiwiZW5yb2xsLnRvdHAuc2V0dXBHb29nbGVBdXRoQXBwIjonTGF1bmNoIHswfSwgdGFwIHRoZSAiKyIgaWNvbiwgdGhlbiBzZWxlY3QgIlNjYW4gYmFyY29kZSIuJywiZW5yb2xsLnRvdHAuY2Fubm90U2NhbiI6IkNhbid0IHNjYW4/IiwiZW5yb2xsLnRvdHAucmVmcmVzaEJhcmNvZGUiOiJSZWZyZXNoIGNvZGUiLCJlbnJvbGwudG90cC5jYW5ub3RTY2FuQmFyY29kZSI6IkNhbid0IHNjYW4gYmFyY29kZT8iLCJlbnJvbGwudG90cC5tYW51YWxTZXR1cEluc3RydWN0aW9ucyI6IlRvIHNldCB1cCBtYW51YWxseSBlbnRlciB5b3VyIE9rdGEgQWNjb3VudCB1c2VybmFtZSBhbmQgdGhlbiBpbnB1dCB0aGUgZm9sbG93aW5nIGluIHRoZSBTZWNyZXQgS2V5IEZpZWxkIiwiZW5yb2xsLnRvdHAuc2hhcmVkU2VjcmV0SW5zdHJ1Y3Rpb25zIjoiRW50ZXIgeW91ciBPa3RhIEFjY291bnQgdXNlcm5hbWUgYW5kIGVudGVyIHRoZSBmb2xsb3dpbmcgaW4gdGhlIFNlY3JldCBLZXkgRmllbGQiLCJlbnJvbGwudG90cC5zZW5kU21zIjoiU2VuZCBhY3RpdmF0aW9uIGxpbmsgdmlhIFNNUyIsImVucm9sbC50b3RwLnNlbmRFbWFpbCI6IlNlbmQgYWN0aXZhdGlvbiBsaW5rIHZpYSBlbWFpbCIsImVucm9sbC50b3RwLnNldHVwTWFudWFsbHkiOiJTZXR1cCBtYW51YWxseSB3aXRob3V0IHB1c2ggbm90aWZpY2F0aW9uIiwiZW5yb2xsLnRvdHAuZW5yb2xsVmlhRW1haWwudGl0bGUiOiJBY3RpdmF0aW9uIGVtYWlsIHNlbnQhIiwiZW5yb2xsLnRvdHAuZW5yb2xsVmlhRW1haWwubXNnIjoiT3BlbiB0aGUgZW1haWwgZnJvbSB5b3VyIG1vYmlsZSBkZXZpY2UuIiwiZW5yb2xsLnRvdHAuZW5yb2xsVmlhU21zLnRpdGxlIjoiU01TIHNlbnQhIiwiZW5yb2xsLnRvdHAuZW5yb2xsVmlhU21zLm1zZyI6IlZpZXcgdGhlIFNNUyBvbiB5b3VyIG1vYmlsZSBkZXZpY2UuIiwicmVjb3ZlcnlDaGFsbGVuZ2Uuc21zLnRpdGxlIjoiRW50ZXIgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB2aWEgU01TIiwicmVjb3ZlcnlDaGFsbGVuZ2UuY2FsbC50aXRsZSI6IkVudGVyIHZlcmlmaWNhdGlvbiBjb2RlIHJlY2VpdmVkIHZpYSBWb2ljZSBDYWxsIiwibWZhLmZhY3RvcnMuZHJvcGRvd24udGl0bGUiOiJTZWxlY3QgYW4gYXV0aGVudGljYXRpb24gZmFjdG9yIiwibWZhLmR1b1NlYw==", "base64"));
  res.write(new Buffer("dXJpdHkucHVzaCI6IlB1c2gg4oCUIHswfSIsIm1mYS5kdW9TZWN1cml0eS5zbXMiOiJTTVMg4oCUIHswfSIsIm1mYS5kdW9TZWN1cml0eS5jYWxsIjoiQ2FsbCDigJQgezB9IiwibWZhLmNoYWxsZW5nZS50aXRsZSI6IkVudGVyIHlvdXIgezB9IHBhc3Njb2RlIiwibWZhLmNoYWxsZW5nZS5vckVudGVyQ29kZSI6Ik9yIGVudGVyIGNvZGUiLCJva3RhdmVyaWZ5LnNlbmQiOiJTZW5kIFB1c2giLCJva3RhdmVyaWZ5LnJlc2VuZCI6IlJlLXNlbmQgUHVzaCIsIm9rdGF2ZXJpZnkuc2VudCI6IlB1c2ggc2VudCEiLCJva3RhdmVyaWZ5LnJlamVjdGVkIjoiWW91IGhhdmUgY2hvc2VuIHRvIHJlamVjdCB0aGlzIGxvZ2luLiIsIm9rdGF2ZXJpZnkudGltZW91dCI6IllvdXIgcHVzaCBub3RpZmljYXRpb24gaGFzIGV4cGlyZWQuIiwib2t0YXZlcmlmeS53YXJuaW5nIjoiSGF2ZW4ndCByZWNlaXZlZCBhIHB1c2ggbm90aWZpY2F0aW9uIHlldD8gVHJ5IG9wZW5pbmcgdGhlIE9rdGEgVmVyaWZ5IEFwcCBvbiB5b3VyIHBob25lLiIsInByaW1hcnlhdXRoLnRpdGxlIjoiU2lnbiBJbiIsInByaW1hcnlhdXRoLnVzZXJuYW1lLnBsYWNlaG9sZGVyIjoiVXNlcm5hbWUiLCJwcmltYXJ5YXV0aC51c2VybmFtZS50b29sdGlwIjoiVXNlcm5hbWUiLCJwcmltYXJ5YXV0aC5wYXNzd29yZC5wbGFjZWhvbGRlciI6IlBhc3N3b3JkIiwicHJpbWFyeWF1dGgucGFzc3dvcmQudG9vbHRpcCI6IlBhc3N3b3JkIiwicHJpbWFyeWF1dGguc3VibWl0IjoiU2lnbiBJbiIsInByaW1hcnlhdXRoLm5ld1VzZXIudG9vbHRpcCI6IlRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgeW91IGFyZSBjb25uZWN0aW5nIHRvIHswfSBmcm9tIHRoaXMgYnJvd3NlciIsInByaW1hcnlhdXRoLm5ld1VzZXIudG9vbHRpcC5jbG9zZSI6IkNsb3NlIiwicGFzc3dvcmQuZm9yZ290LmVtYWlsLm9yLnVzZXJuYW1lLnBsYWNlaG9sZGVyIjoiRW1haWwgb3IgVXNlcm5hbWUiLCJwYXNzd29yZC5mb3Jnb3QuZW1haWwub3IudXNlcm5hbWUudG9vbHRpcCI6IkVtYWlsIG9yIFVzZXJuYW1lIiwicGFzc3dvcmQuZm9yZ290LnNlbmRUZXh0IjoiUmVzZXQgdmlhIFNNUyIsInBhc3N3b3JkLmZvcmdvdC5zZW5kRW1haWwiOiJSZXNldCB2aWEgRW1haWwiLCJwYXNzd29yZC5mb3Jnb3QuY2FsbCI6IlJlc2V0IHZpYSBWb2ljZSBDYWxsIiwicGFzc3dvcmQuZm9yZ290LmVtYWlsU2VudC50aXRsZSI6IkVtYWlsIHNlbnQhIiwicGFzc3dvcmQuZm9yZ290LmVtYWlsU2VudC5kZXNjIjoiRW1haWwgaGFzIGJlZW4gc2VudCB0byB7MH0gd2l0aCBpbnN0cnVjdGlvbnMgb24gcmVzZXR0aW5nIHlvdXIgcGFzc3dvcmQuIiwicGFzc3dvcmQuZm9yZ290LnF1ZXN0aW9uLnRpdGxlIjoiQW5zd2VyIEZvcmdvdHRlbiBQYXNzd29yZCBDaGFsbGVuZ2UiLCJwYXNzd29yZC5mb3Jnb3QucXVlc3Rpb24uc3VibWl0IjoiUmVzZXQgUGFzc3dvcmQiLCJwYXNzd29yZC5mb3Jnb3Quc21zLm5vdFJlY2VpdmVkIjoiRGlkbid0IHJlY2VpdmUgYW4gU01TPyBSZXNldCB2aWEgZW1haWwiLCJwYXNzd29yZC5mb3Jnb3QuY29kZS5ub3RSZWNlaXZlZCI6IkRpZG4ndCByZWNlaXZlIGEgY29kZT8gUmVzZXQgdmlhIGVtYWlsIiwicGFzc3dvcmQucmVzZXQudGl0bGUiOiJSZXNldCB5b3VyIE9rdGEgcGFzc3dvcmQiLCJwYXNzd29yZC5jb21wbGV4aXR5LmRlc2NyaXB0aW9uIjoiWW91ciBwYXNzd29yZCBtdXN0IGhhdmUgezB9LiIsInBhc3N3b3JkLmNvbXBsZXhpdHkuaGlzdG9yeSI6IllvdXIgcGFzc3dvcmQgY2Fubm90IGJlIGFueSBvZiB5b3VyIGxhc3QgezB9IHBhc3N3b3Jkcy4iLCJwYXNzd29yZC5jb21wbGV4aXR5Lm1pbkFnZU1pbnV0ZXMiOiJBdCBsZWFzdCB7MH0gbWludXRlKHMpIG11c3QgaGF2ZSBlbGFwc2VkIHNpbmNlIHlvdSBsYXN0IGNoYW5nZWQgeW91ciBwYXNzd29yZC4iLCJwYXNzd29yZC5jb21wbGV4aXR5Lm1pbkFnZUhvdXJzIjoiQXQgbGVhc3QgezB9IGhvdXIocykgbXVzdCBoYXZlIGVsYXBzZWQgc2luY2UgeW91IGxhc3QgY2hhbmdlZCB5b3VyIHBhc3N3b3JkLiIsInBhc3N3b3JkLmNvbXBsZXhpdHkubWluQWdlRGF5cyI6IkF0IGxlYXN0IHswfSBkYXkocykgbXVzdCBoYXZlIGVsYXBzZWQgc2luY2UgeW91IGxhc3QgY2hhbmdlZCB5b3VyIHBhc3N3b3JkLiIsInBhc3N3b3JkLmNvbXBsZXhpdHkubGVuZ3RoIjoiYXQgbGVhc3QgezB9IGNoYXJhY3RlcnMiLCJwYXNzd29yZC5jb21wbGV4aXR5Lmxpc3QuZWxlbWVudCI6IiwgezB9IiwicGFzc3dvcmQuY29tcGxleGl0eS5sb3dlcmNhc2UiOiJhIGxvd2VyY2FzZSBsZXR0ZXIiLCJwYXNzd29yZC5jb21wbGV4aXR5LnVwcGVyY2FzZSI6ImFuIHVwcGVyY2FzZSBsZXR0ZXIiLCJwYXNzd29yZC5jb21wbGV4aXR5Lm51bWJlciI6ImEgbnVtYmVyIiwicGFzc3dvcmQuY29tcGxleGl0eS5zeW1ib2wiOiJhIHN5bWJvbCIsInBhc3N3b3JkLmNvbXBsZXhpdHkubm9fdXNlcm5hbWUiOiJubyBwYXJ0cyBvZiB5b3VyIHVzZXJuYW1lIiwicGFzc3dvcmQuZXhwaXJlZC5zdWJtaXQiOiJDaGFuZ2UgUGFzc3dvcmQiLCJwYXNzd29yZC5leHBpcmVkLnRpdGxlIjoiWW91ciBPa3RhIHBhc3N3b3JkIGhhcyBleHBpcmVkIiwicGFzc3dvcmQuZXhwaXJpbmcubGF0ZXIiOiJSZW1pbmQgbWUgbGF0ZXIiLCJwYXNzd29yZC5leHBpcmluZy50aXRsZSI6IllvdXIgcGFzc3dvcmQgd2lsbCBleHBpcmUgaW4gezB9IGRheXMiLCJwYXNzd29yZC5leHBpcmluZy50b2RheSI6IllvdXIgcGFzc3dvcmQgd2lsbCBleHBpcmUgbGF0ZXIgdG9kYXkiLCJwYXNzd29yZC5leHBpcmluZy5zdWJ0aXRsZSI6IldoZW4gcGFzc3dvcmQgZXhwaXJlcyB5b3UgbWF5IGJlIGxvY2tlZCBvdXQgb2YgT2t0YSBNb2JpbGUsIG1vYmlsZSBlbWFpbCwgYW5kIG90aGVyIHNlcnZpY2VzLiIsInBhc3N3b3JkLmV4cGlyZWQuY3VzdG9tLnN1Ym1pdCI6IkdvIHRvIHswfSIsInBhc3N3b3JkLmV4cGlyZWQuY3VzdG9tLnN1YnRpdGxlIjoiVGhpcyBwYXNzd29yZCBpcyBzZXQgb24gYW5vdGhlciB3ZWJzaXRlLiBDbGljayB0aGUgYnV0dG9uIGJlbG93IHRvIGdvIHRoZXJlIGFuZCBzZXQgYSBuZXcgcGFzc3dvcmQuIiwiYWNjb3VudC51bmxvY2sudGl0bGUiOiJVbmxvY2sgYWNjb3VudCIsImFjY291bnQudW5sb2NrLmVtYWlsLm9yLnVzZXJuYW1lLnBsYWNlaG9sZGVyIjoiRW1haWwgb3IgdXNlcm5hbWUiLCJhY2NvdW50LnVubG9jay5lbWFpbC5vci51c2VybmFtZS50b29sdGlwIjoiRW1haWwgb3IgdXNlcm5hbWUiLCJhY2NvdW50LnVubG9jay5zZW5kVGV4dCI6IlNlbmQgU01TIiwiYWNjb3VudC51bmxvY2suc2VuZEVtYWlsIjoiU2VuZCBFbWFpbCIsImFjY291bnQudW5sb2NrLmVtYWlsU2VudC50aXRsZSI6IkVtYWlsIHNlbnQhIiwiYWNjb3VudC51bmxvY2suZW1haWxTZW50LmRlc2MiOiJFbWFpbCBoYXMgYmVlbiBzZW50IHRvIHswfSB3aXRoIGluc3RydWN0aW9ucyBvbiB1bmxvY2tpbmcgeW91ciBhY2NvdW50LiIsImFjY291bnQudW5sb2NrLnF1ZXN0aW9uLnRpdGxlIjoiQW5zd2VyIFVubG9jayBBY2NvdW50IENoYWxsZW5nZSIsImFjY291bnQudW5sb2NrLnF1ZXN0aW9uLnN1Ym1pdCI6IlVubG9jayBBY2NvdW50IiwiYWNjb3VudC51bmxvY2sudW5sb2NrZWQudGl0bGUiOiJBY2NvdW50IHN1Y2Nlc3NmdWxseSB1bmxvY2tlZCEiLCJhY2NvdW50LnVubG9jay51bmxvY2tlZC5kZXNjIjoiWW91IGNhbiBsb2cgaW4gdXNpbmcgeW91ciBleGlzdGluZyB1c2VybmFtZSBhbmQgcGFzc3dvcmQuIiwiYWNjb3VudC51bmxvY2suc21zLm5vdFJlY2VpdmVkIjoiRGlkbid0IHJlY2VpdmUgYW4gU01TPyBVbmxvY2sgdmlhIGVtYWlsIiwiY29udGFjdC5zdXBwb3J0IjoiSWYgeW91IGRpZG4ndCBwcm92aWRlIGEgc2Vjb25kYXJ5IGVtYWlsIGFkZHJlc3Mgb3IgZG9uJ3QgaGF2ZSBhY2Nlc3MgdG8gZW1haWwsIHBsZWFzZSBjb250YWN0IHlvdXIgYWRtaW5pc3RyYXRvciBhdCB7MH0iLCJzb2NpYWxhdXRoLmRpdmlkZXIudGV4dCI6Ik9SIiwic29jaWFsYXV0aC5mYWNlYm9vay5sYWJlbCI6IlNpZ24gaW4gd2l0aCBGYWNlYm9vayIsInNvY2lhbGF1dGguZ29vZ2xlLmxhYmVsIjoiU2lnbiBpbiB3aXRoIEdvb2dsZSIsInNvY2lhbGF1dGgubGlua2VkaW4ubGFiZWwiOiJTaWduIGluIHdpdGggTGlua2VkSW4iLCJzb2NpYWxhdXRoLm1pY3Jvc29mdC5sYWJlbCI6IlNpZ24gaW4gd2l0aCBNaWNyb3NvZnQiLCJzb2NpYWxhdXRoLnBvcHVwLnRpdGxlIjoiRXh0ZXJuYWwgSWRlbnRpdHkgUHJvdmlkZXIgVXNlciBBdXRoZW50aWNhdGlvbiIsImF1dGhidXR0b24uZGl2aWRlci50ZXh0Ijoib3IiLCJyZWdpc3RyYXRpb24uc2lnbnVwLmxhYmVsIjoiRG9uJ3QgaGF2ZSBhbiBhY2NvdW50PyIsInJlZ2lzdHJhdGlvbi5zaWdudXAudGV4dCI6IlNpZ24gdXAiLCJyZWdpc3RyYXRpb24uY29tcGxldGUudGl0bGUiOiJWZXJpZmljYXRpb24gZW1haWwgc2VudCIsInJlZ2lzdHJhdGlvbi5jb21wbGV0ZS5kZXNjIjoiV2UganVzdCBzZW50IGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIHswfS4gUGxlYXNlIGNoZWNrIHlvdXIgZW1haWwgYW5kIHZlcmlmeSB5b3VyIGFjY291bnQgdG8gY29udGludWUuIiwicmVnaXN0cmF0aW9uLmZvcm0udGl0bGUiOiJDcmVhdGUgQWNjb3VudCIsInJlZ2lzdHJhdGlvbi5mb3JtLnN1Ym1pdCI6IlJlZ2lzdGVyIiwicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5taW5MZW5ndGgiOiJBdCBsZWFzdCB7MH0gY2hhcmFjdGVyKHMpIiwicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5taW5Mb3dlckNhc2UiOiJBdCBsZWFzdCB7MH0gbG93ZXJjYXNlIGxldHRlcihzKSIsInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluVXBwZXJDYXNlIjoiQXQgbGVhc3QgezB9IHVwcGVyY2FzZSBsZXR0ZXIocykiLCJyZWdpc3RyYXRpb24ucGFzc3dvcmRDb21wbGV4aXR5Lm1pbk51bWJlciI6IkF0IGxlYXN0IHswfSBudW1iZXIocykiLCJyZWdpc3RyYXRpb24ucGFzc3dvcmRDb21wbGV4aXR5Lm1pblN5bWJvbCI6IkF0IGxlYXN0IHswfSBzeW1ib2wocykiLCJyZWdpc3RyYXRpb24ucGFzc3dvcmRDb21wbGV4aXR5LmV4Y2x1ZGVVc2VybmFtZSI6IkRvZXMgbm90IGNvbnRhaW4gcGFydCBvZiB1c2VybmFtZSIsInBpdi5jYXJkIjoiUElWIENhcmQiLCJwaXYuY2FyZC5pbnNlcnQiOiJQbGVhc2UgaW5zZXJ0IHlvdXIgUElWIGNhcmQgYW5kIHNlbGVjdCB0aGUgdXNlciBjZXJ0aWZpY2F0ZS4iLCJwaXYuY2FyZC5lcnJvciI6IkNlcnRpZmljYXRlIGF1dGhlbnRpY2F0aW9uIGZhaWxlZC4gQ29udGFjdCB5b3VyIGFkbWluLiIsInBpdi5jYXJkLmVycm9yLmVtcHR5IjoiTm8gY2VydGlmaWNhdGUgc2VsZWN0ZWQuIENob29zZSBhIGNlcnRpZmljYXRlIGFuZCB0cnkgYWdhaW4uIiwicGl2LmNhcmQuZXJyb3IuaW52YWxpZCI6IkNlcnRpZmljYXRlIHZhbGlkYXRpb24gZmFpbGVkLiBDaG9vc2UgYW5vdGhlciBjZXJ0aWZpY2F0ZSBhbmQgdHJ5IGFnYWluLiIsInVuc3VwcG9ydGVkLm9uZURyaXZlLnRpdGxlIjoiWW91ciBPbmVEcml2ZSB2ZXJzaW9uIGlzIG5vdCBzdXBwb3J0ZWQiLCJ1bnN1cHBvcnRlZC5vbmVEcml2ZS5kZXNjIjoiVXBncmFkZSBub3cgYnkgaW5zdGFsbGluZyB0aGUgT25lRHJpdmUgZm9yIEJ1c2luZXNzIE5leHQgR2VuZXJhdGlvbiBTeW5jIENsaWVudCB0byBsb2dpbiB0byBPa3RhIiwidW5zdXBwb3J0ZWQub25lRHJpdmUuYWN0aW9uIjoiTGVhcm4gaG93IHRvIHVwZ3JhZGUiLCJ1bnN1cHBvcnRlZC5jb29raWVzLnRpdGxlIjoiQ29va2llcyBhcmUgcmVxdWlyZWQiLCJ1bnN1cHBvcnRlZC5jb29raWVzLmRlc2MiOiJDb29raWVzIGFyZSBkaXNhYmxlZCBvbiB5b3VyIGJyb3dzZXIuIFBsZWFzZSBlbmFibGUgQ29va2llcyBhbmQgcmVmcmVzaCB0aGlzIHBhZ2UuIiwidW5zdXBwb3J0ZWQuY29va2llcy5hY3Rpb24iOiJSZWZyZXNoICIsImRldmljZVRydXN0LnNzby50ZXh0IjoiU2lnbiBpbiB0byBhY2Nlc3MgY29tcGFueSByZXNvdXJjZXMiLCJkZXZpY2VUcnVzdC5zc28uaGludCI6IkVhc2lseSBnZXQgY29tcGFueSByZXNvdXJjZXMgdXNpbmcgT2t0YSBNb2JpbGUgdG8gc2lnbiBpbiB0byBhcHBzIGZyb20geW91ciBzZWN1cmUgZGV2aWNlLiIsImRldmljZVRydXN0LnNzby5idXR0b24iOiJTaWduIGluIHVzaW5nIE9rdGEgTW9iaWxlIiwiZGV2aWNlVHJ1c3Quc3NvLmV4cGlyZS50aXRsZSI6Ik9vcHMgbGV0J3MgZ2V0IHlvdSBiYWNrIG9uIHRyYWNrIiwiZGV2aWNlVHJ1c3Quc3NvLmV4cGlyZS5zdWJ0aXRsZSI6IlVuZm9ydHVuYXRlbHkgdGhlIHN0ZXBzIHJlcXVpcmVkIHRvIHNpZ24gaW4gdG9vayBsb25nZXIgdGhhbiBleHBlY3RlZCBhbmQgeW91ciBhdHRlbXB0IHRpbWVkIG91dC4iLCJkZXZpY2VUcnVzdC5zc28uZXhwaXJlLmJ1dHRvbiI6IlNpZ24gaW4gdXNpbmcgT2t0YSBNb2JpbGUiLCJkZXZpY2VUcnVzdC51bml2ZXJzYWxMaW5rLmZhbGxiYWNrLmdldE9rdGFNb2JpbGUudGl0bGUiOiJHZXQgT2t0YSBNb2JpbGUiLCJkZXZpY2VUcnVzdC51bml2ZXJzYWxMaW5rLmZhbGxiYWNrLmdldE9rdGFNb2JpbGUuc3VidGl0bGUiOiJHbyB0byB0aGUgezB9QXBwU3RvcmV7MX0sIHswfXNlYXJjaHsxfSBmb3IgezB9T2t0YSBNb2JpbGV7MX0gYW5kIHRhcCBvbiB7MH1HRVR7MX0gT2t0YSBNb2JpbGUuIE9uY2UgaW5zdGFsbGVkLCBzaWduIGluIHRvIE9rdGEgTW9iaWxlIGFuZCBmb2xsb3cgdGhlIGluc3RydWN0aW9ucyB0byBzZWN1cmUgeW91ciBkZXZpY2UuIiwicmVnaXN0cmF0aW9uLmVtYWlsU2VudC50aXRsZSI6IlZlcmlmaWNhdGlvbiBlbWFpbCBzZW50IiwicmVnaXN0cmF0aW9uLmVtYWlsU2VudC5kZXNjIjoiV2UganVzdCBzZW50IGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIHswfS4gUGxlYXNlIGNoZWNrIHlvdXIgZW1haWwgYW5kIHZlcmlmeSB5b3VyIGFjY291bnQgdG8gY29udGludWUuIn19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPXtBRjoiQWZnaGFuaXN0YW4iLEFYOiLDhWxhbmQgSXNsYW5kcyIsQUw6IkFsYmFuaWEiLERaOiJBbGdlcmlhIixBUzoiQW1lcmljYW4gU2Ftb2EiLEFEOiJBbmRvcnJhIixBTzoiQW5nb2xhIixBSToiQW5ndWlsbGEiLEFROiJBbnRhcmN0aWNhIixBRzoiQW50aWd1YSBhbmQgQmFyYnVkYSIsQVI6IkFyZ2VudGluYSIsQU06IkFybWVuaWEiLEFXOiJBcnViYSIsQVU6IkF1c3RyYWxpYSIsQVQ6IkF1c3RyaWEiLEFaOiJBemVyYmFpamFuIixCUzoiQmFoYW1hcyIsQkg6IkJhaHJhaW4iLEJEOiJCYW5nbGFkZXNoIixCQjoiQmFyYmFkb3MiLEJZOiJCZWxhcnVzIixCRToiQmVsZ2l1bSIsQlo6IkJlbGl6ZSIsQko6IkJlbmluIixCTToiQmVybXVkYSIsQlQ6IkJodXRhbiIsQk86IkJvbGl2aWEsIFBsdXJpbmF0aW9uYWwgU3RhdGUgb2YiLEJBOiJCb3NuaWEgYW5kIEhlcnplZ292aW5hIixCVzoiQm90c3dhbmEiLEJWOiJCb3V2ZXQgSXNsYW5kIixCUjoiQnJhemlsIixJTzoiQnJpdGlzaCBJbmRpYW4gT2NlYW4gVGVycml0b3J5IixWRzoiVmlyZ2luIElzbGFuZHMsIEJyaXRpc2giLEJOOiJCcnVuZWkgRGFydXNzYWxhbSIsQkc6IkJ1bGdhcmlhIixCRjoiQnVya2luYSBGYXNvIixCSToiQnVydW5kaSIsS0g6IkNhbWJvZGlhIixDTToiQ2FtZXJvb24iLENBOiJDYW5hZGEiLENWOiJDYXBlIFZlcmRlIixLWToiQ2F5bWFuIElzbGFuZHMiLENGOiJDZW50cmFsIEFmcmljYW4gUmVwdWJsaWMiLFREOiJDaGFkIixDTDoiQ2hpbGUiLENOOiJDaGluYSIsQ1g6IkNocmlzdG1hcyBJc2xhbmQiLENPOiJDb2xvbWJpYSIsS006IkNvbW9yb3MiLENHOiJDb25nbyIsQ0s6IkNvb2sgSXNsYW5kcyIsQ1I6IkNvc3RhIFJpY2EiLENJOiJDw7R0ZSBkJ0l2b2lyZSIsSFI6IkNyb2F0aWEiLENVOiJDdWJhIixDWToiQ3lwcnVzIixDWjoiQ3plY2ggUmVwdWJsaWMiLENEOiJDb25nbywgdGhlIERlbW9jcmF0aWMgUmVwdWJsaWMgb2YgdGhlIixESzoiRGVubWFyayIsREo6IkRqaWJvdXRpIixETToiRG9taW5pY2EiLERPOiJEb21pbmljYW4gUmVwdWJsaWMiLFRMOiJUaW1vci1MZXN0ZSIsRUM6IkVjdWFkb3IiLEVHOiJFZ3lwdCIsU1Y6IkVsIFNhbHZhZG9yIixHUToiRXF1YXRvcmlhbCBHdWluZWEiLEVSOiJFcml0cmVhIixFRToiRXN0b25pYSIsRVQ6IkV0aGlvcGlhIixGSzoiRmFsa2xhbmQgSXNsYW5kcyAoTWFsdmluYXMpIixGTzoiRmFyb2UgSXNsYW5kcyIsRko6IkZpamkiLEZJOiJGaW5sYW5kIixGUjoiRnJhbmNlIixHRjoiRnJlbmNoIEd1aWFuYSIsUEY6IkZyZW5jaCBQb2x5bmVzaWEiLFRGOiJGcmVuY2ggU291dGhlcm4gVGVycml0b3JpZXMiLEdBOiJHYWJvbiIsR006IkdhbWJpYSIsR0U6Ikdlb3JnaWEiLERFOiJHZXJtYW55IixHSDoiR2hhbmEiLEdJOiJHaWJyYWx0YXIiLEdSOiJHcmVlY2UiLEdMOiJHcmVlbmxhbmQiLEdEOiJHcmVuYWRhIixHUDoiR3VhZGVsb3VwZSIsR1U6Ikd1YW0iLEdUOiJHdWF0ZW1hbGEiLEdHOiJHdWVybnNleSIsR046Ikd1aW5lYSIsR1c6Ikd1aW5lYS1CaXNzYXUiLEdZOiJHdXlhbmEiLEhUOiJIYWl0aSIsSE06IkhlYXJkIElzbGFuZCBhbmQgTWNEb25hbGQgSXNsYW5kcyIsSE46IkhvbmR1cmFzIixISzoiSG9uZyBLb25nIixIVToiSHVuZ2FyeSIsSVM6IkljZWxhbmQiLElOOiJJbmRpYSIsSUQ6IkluZG9uZXNpYSIsSVI6IklyYW4sIElzbGFtaWMgUmVwdWJsaWMgb2YiLElROiJJcmFxIixJRToiSXJlbGFuZCIsSUw6IklzcmFlbCIsSVQ6Ikl0YWx5IixKTToiSmFtYWljYSIsSlA6IkphcGFuIixKRToiSmVyc2V5IixKTzoiSm9yZGFuIixLWjoiS2F6YWtoc3RhbiIsS0U6IktlbnlhIixLSToiS2lyaWJhdGkiLEtSOiJLb3JlYSwgUmVwdWJsaWMgb2YiLEtXOiJLdXdhaXQiLEtHOiJLeXJneXpzdGFuIixMQToiTGFvIFBlb3BsZSdzIERlbW9jcmF0aWMgUmVwdWJsaWMiLExWOiJMYXR2aWEiLExCOiJMZWJhbm9uIixMUzoiTGVzb3RobyIsTFI6IkxpYmVyaWEiLExZOiJMaWJ5YSIsTEk6IkxpZWNodGVuc3RlaW4iLExUOiJMaXRodWFuaWEiLExVOiJMdXhlbWJvdXJnIixNTzoiTWFjYW8iLE1LOiJNYWNlZG9uaWEsIHRoZSBmb3JtZXIgWXVnb3NsYXYgUmVwdWJsaWMgb2YiLE1HOiJNYWRhZ2FzY2FyIixNVzoiTWFsYXdpIixNWToiTWFsYXlzaWEiLE1WOiJNYWxkaXZlcyIsTUw6Ik1hbGkiLE1UOiJNYWx0YSIsTUg6Ik1hcnNoYWxsIElzbGFuZHMiLE1ROiJNYXJ0aW5pcXVlIixNUjoiTWF1cml0YW5pYSIsTVU6Ik1hdXJpdGl1cyIsWVQ6Ik1heW90dGUiLE1YOiJNZXhpY28iLEZNOiJNaWNyb25lc2lhLCBGZWRlcmF0ZWQgU3RhdGVzIG9mIixNRDoiTW9sZG92YSwgUmVwdWJsaWMgb2YiLE1DOiJNb25hY28iLE1OOiJNb25nb2xpYSIsTUU6Ik1vbnRlbmVncm8iLE1TOiJNb250c2VycmF0IixNQToiTW9yb2NjbyIsTVo6Ik1vemFtYmlxdWUiLE1NOiJNeWFubWFyIixOQToiTmFtaWJpYSIsTlI6Ik5hdXJ1IixOUDoiTmVwYWwiLE5MOiJOZXRoZXJsYW5kcyIsQU46Ik5ldGhlcmxhbmRzIEFudGlsbGVzIixOQzoiTmV3IENhbGVkb25pYSIsTlo6Ik5ldyBaZWFsYW5kIixOSToiTmljYXJhZ3VhIixORToiTmlnZXIiLE5HOiJOaWdlcmlhIixOVToiTml1ZSIsTkY6Ik5vcmZvbGsgSXNsYW5kIixLUDoiS29yZWEsIERlbW9jcmF0aWMgUGVvcGxlJ3MgUmVwdWJsaWMgb2YiLE1QOiJOb3J0aGVybiBNYXJpYW5hIElzbGFuZHMiLE5POiJOb3J3YXkiLE9NOiJPbWFuIixQSzoiUGFraXN0YW4iLFBXOiJQYWxhdSIsUFM6IlBhbGVzdGluZSwgU3RhdGUgb2YiLFBBOiJQYW5hbWEiLFBHOiJQYXB1YSBOZXcgR3VpbmVhIixQWToiUGFyYWd1YXkiLFBFOiJQZXJ1IixQSDoiUGhpbGlwcGluZXMiLFBOOiJQaXRjYWlybiIsUEw6IlBvbGFuZCIsUFQ6IlBvcnR1Z2FsIixQUjoiUHVlcnRvIFJpY28iLFFBOiJRYXRhciIsUkU6IlLDqXVuaW9uIixSTzoiUm9tYW5pYSIsUlU6IlJ1c3NpYW4gRmVkZXJhdGlvbiIsUlc6IlJ3YW5kYSIsU0g6IlNhaW50IEhlbGVuYSwgQXNjZW5zaW9uIGFuZCBUcmlzdGFuIGRhIEN1bmhhIixLTjoiU2FpbnQgS2l0dHMgYW5kIE5ldmlzIixMQzoiU2FpbnQgTHVjaWEiLFBNOiJTYWludCBQaWVycmUgYW5kIE1pcXVlbG9uIixWQzoiU2FpbnQgVmluY2VudCBhbmQgdGhlIEdyZW5hZGluZXMiLFdTOiJTYW1vYSIsU006IlNhbiBNYXJpbm8iLFNUOiJTw6NvIFRvbcOpIGFuZCBQcsOtbmNpcGUiLFNBOiJTYXVkaSBBcmFiaWEiLFNOOiJTZW5lZ2FsIixSUzoiU2VyYmlhIixTQzoiU2V5Y2hlbGxlcyIsU0w6IlNpZXJyYSBMZW9uZSIsU0c6IlNpbmdhcG9yZSIsU0s6IlNsb3Zha2lhIixTSToiU2xvdmVuaWEiLFNCOiJTb2xvbW9uIElzbGFuZHMiLFNPOiJTb21hbGlhIixaQToiU291dGggQWZyaWNhIixHUzoiU291dGggR2VvcmdpYSBhbmQgdGhlIFNvdXRoIFNhbmR3aWNoIElzbGFuZHMiLFNTOiJTb3V0aCBTdWRhbiIsRVM6IlNwYWluIixMSzoiU3JpIExhbmthIixTRDoiU3VkYW4iLFNSOiJTdXJpbmFtZSIsU0o6IlN2YWxiYXJkIGFuZCBKYW4gTWF5ZW4iLFNaOiJTd2F6aWxhbmQiLFNFOiJTd2VkZW4iLENIOiJTd2l0emVybGFuZCIsU1k6IlN5cmlhbiBBcmFiIFJlcHVibGljIixUVzoiVGFpd2FuIixUSjoiVGFqaWtpc3RhbiIsVFo6IlRhbnphbmlhLCBVbml0ZWQgUmVwdWJsaWMgb2YiLFRIOiJUaGFpbGFuZCIsVEc6IlRvZ28iLFRLOiJUb2tlbGF1IixUTzoiVG9uZ2EiLFRUOiJUcmluaWRhZCBhbmQgVG9iYWdvIixUTjoiVHVuaXNpYSIsVFI6IlR1cmtleSIsVE06IlR1cmttZW5pc3RhbiIsVEM6IlR1cmtzIGFuZCBDYWljb3MgSXNsYW5kcyIsVFY6IlR1dmFsdSIsVkk6IlZpcmdpbiBJc2xhbmRzLCBVLlMuIixVRzoiVWdhbmRhIixVQToiVWtyYWluZSIsQUU6IlVuaXRlZCBBcmFiIEVtaXJhdGVzIixHQjoiVW5pdGVkIEtpbmdkb20iLFVTOiJVbml0ZWQgU3RhdGVzIixVTToiVW5pdGVkIFN0YXRlcyBNaW5vciBPdXRseWluZyBJc2xhbmRzIixVWToiVXJ1Z3VheSIsVVo6IlV6YmVraXN0YW4iLFZVOiJWYW51YXR1IixWQToiSG9seSBTZWUgKFZhdGljYW4gQ2l0eSBTdGF0ZSkiLFZFOiJWZW5lenVlbGEsIEJvbGl2YXJpYW4gUmVwdWJsaWMgb2YiLFZOOiJWaWV0IE5hbSIsV0Y6IldhbGxpcyBhbmQgRnV0dW5hIixFSDoiV2VzdGVybiBTYWhhcmEiLFlFOiJZZW1lbiIsWk06IlphbWJpYSIsWlc6IlppbWJhYndlIn19LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDQpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuZXh0ZW5kKGUse2RlcHJlY2F0ZTpmdW5jdGlvbih0KXtlLndhcm4oIltva3RhLXNpZ25pbi13aWRnZXRdIERFUFJFQ0FURUQ6Iix0KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXt9LGk9IndpdGhDcmVkZW50aWFscyJpbiBuZXcgd2luZG93LlhNTEh0dHBSZXF1ZXN0LG49InVuZGVmaW5lZCIhPXR5cGVvZiBYRG9tYWluUmVxdWVzdDtyZXR1cm4gZS5jb3JzSXNOb3RTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4hKGl8fG4pfSxlLmNvcnNJc05vdEVuYWJsZWQ9ZnVuY3Rpb24odCl7cmV0dXJuIDA9PT10LnN0YXR1c30sZS5sb2NhbFN0b3JhZ2VJc05vdFN1cHBvcnRlZD1mdW5jdGlvbigpe3ZhciB0PSJ0ZXN0Ijt0cnl7cmV0dXJuIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHQsdCksbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odCksITF9Y2F0Y2goZSl7cmV0dXJuITB9fSxlLnN1cHBvcnRzUHVzaFN0YXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0PXR8fHdpbmRvdywhKCF0Lmhpc3Rvcnl8fCF0Lmhpc3RvcnkucHVzaFN0YXRlKX0sZS5pc0lFPWZ1bmN0aW9uKCl7cmV0dXJuLyhtc2llfHRyaWRlbnQpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KX0sZS5pc0ZpcmVmb3g9ZnVuY3Rpb24oKXtyZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoImZpcmVmb3giKT4tMX0sZS5nZXRVc2VyTGFuZ3VhZ2VzPWZ1bmN0aW9uKCl7dmFyIGUsaTtyZXR1cm4gbmF2aWdhdG9yLmxhbmd1YWdlcz9uYXZpZ2F0b3IubGFuZ3VhZ2VzOihlPVtdLGk9WyJsYW5ndWFnZSIsInVzZXJMYW5ndWFnZSIsImJyb3dzZXJMYW5ndWFnZSIsInN5c3RlbUxhbmd1YWdlIl0sdC5lYWNoKGksZnVuY3Rpb24odCl7bmF2aWdhdG9yW3RdJiZlLnB1c2gobmF2aWdhdG9yW3RdKX0pLGUpfSxlfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDE4NCksaSgxNTApXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBuLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24oZSl7dGhpcy5fX2hhc0RlZmF1bHRSb3V0ZT0hMTt2YXIgcj10aGlzLl9fdGFic1dpZGdldD1uZXcgaTtyLnJlbmRlcigpO3ZhciBzPXQoZS5lbCk7ZS5lbD1yLmNvbnRlbnQoKSx0KGZ1bmN0aW9uKCl7cy5hcHBlbmQoci5lbCl9KSxuLmNhbGwodGhpcyxlKX0sdGFiOmZ1bmN0aW9uKHQsaSxuLHIpe3ZhciBzPWUuaXNBcnJheSh0KT90Olt0XTtyZXR1cm4gdGhpcy5fX2FkZFRhYih7cm91dGVzOnMsbWV0aG9kOmksbGFiZWw6bixzdWJ0YWJzOnJ9KSx0aGlzfSxfX2FkZFRhYjpmdW5jdGlvbih0KXt0aGlzLl9faGFzRGVmYXVsdFJvdXRlfHwodGhpcy5yb3V0ZSgiIix0Lm1ldGhvZCksdGhpcy5fX2hhc0RlZmF1bHRSb3V0ZT0hMCksdC5zdWJ0YWJzJiZ0LnN1YnRhYnMubGVuZ3RoJiZ0aGlzLl9fYWRkU3ViVGFicyhlLmV4dGVuZChlLnBpY2sodCwicm91dGVzIiwic3VidGFicyIpKSksZS5lYWNoKHQucm91dGVzLGZ1bmN0aW9uKGUpe3RoaXMucm91dGUoZSx0Lm1ldGhvZCl9LHRoaXMpO3ZhciBpPWUuZmlyc3QodC5yb3V0ZXMpO3RoaXMuX190YWJzV2lkZ2V0LmFkZFRhYihlLmV4dGVuZChlLnBpY2sodCwibGFiZWwiLCJtZXRob2QiLCJzdWJ0YWJzIikse3JvdXRlOmkscm91dGVyOnRoaXN9KSl9LF9fYWRkU3ViVGFiczpmdW5jdGlvbih0KXtlLmVhY2godC5zdWJ0YWJzLGZ1bmN0aW9uKGkpe3ZhciBuPXQucm91dGVzKyIvIitpLnJvdXRlczt0aGlzLnJvdXRlKG4saS5tZXRob2QpLHRoaXMuX190YWJzV2lkZ2V0LmFkZFN1YlRhYihlLmV4dGVuZChlLnBpY2soaSwibGFiZWwiLCJtZXRob2QiKSx7cm91dGU6bixyb3V0ZXI6dGhpc30pKX0sdGhpcyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpLGkoMTg1KSxpKDE4NildLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0LmV4dGVuZCh7Y2xhc3NOYW1lOiJjbGVhcmZpeCB1aS10YWJzIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIix0ZW1wbGF0ZTonPHVsIHJvbGU9InRhYmxpc3QiIGNsYXNzPSJ1aS10YWJzLW5hdiB1aS1oZWxwZXItcmVzZXQgdWktaGVscGVyLWNsZWFyZml4IHVpLXdpZGdldC1oZWFkZXIgdWktY29ybmVyLWFsbCB1aS10YWJzLW1hcmdpbiI+PC91bD48ZGl2IHJvbGU9InN1YnRhYnMiIGNsYXNzPSJ1aS1zdWJ0YWJzIHVpLWhlbHBlci1yZXNldCB1aS10YWJzLW1hcmdpbiI+PC9kaXY+PGRpdiByb2xlPSJ0YWJwYW5lbCIgY2xhc3M9InVpLXRhYnMtcGFuZWwgdWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWJvdHRvbSI+PC9kaXY+Jyxjb250ZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgiZGl2LnVpLXRhYnMtcGFuZWwiKX0sYWRkVGFiOmZ1bmN0aW9uKHQpe3RoaXMuYWRkKGUsInVsIix7b3B0aW9uczp0fSl9LGFkZFN1YlRhYjpmdW5jdGlvbih0KXt0aGlzLmFkZChpLCJkaXYudWktc3VidGFicyIse29wdGlvbnM6dH0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHt0YWdOYW1lOiJsaSIsY2xhc3NOYW1lOiJ1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci10b3AiLGF0dHJpYnV0ZXM6e3JvbGU6InRhYiJ9LHRlbXBsYXRlOic8YSBjbGFzcz0idWktdGFicy1hbmNob3IiIHJvbGU9InByZXNlbnRhdGlvbiIgaHJlZj0ie3tyb3V0ZX19Ij57e2xhYmVsfX08L2E+JyxldmVudHM6eyJjbGljayBhIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLnJvdXRlci5uYXZpZ2F0ZSh0aGlzLnJvdXRlLHt0cmlnZ2VyOiEwfSl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dC5leHRlbmQodGhpcyx0LnBpY2sodGhpcy5vcHRpb25zLCJyb3V0ZSIsInJvdXRlciIsIm1ldGhvZCIpKSx0aGlzLmxpc3RlblRvKHRoaXMucm91dGVyLCJyb3V0ZSIsdGhpcy50b2dnbGUpfSx0b2dnbGU6ZnVuY3Rpb24oZSl7aWYodGhpcy4kZWwudG9nZ2xlQ2xhc3MoInVpLXN0YXRlLWFjdGl2ZSB1aS10YWJzLXNlbGVjdGVkIixlPT10aGlzLm1ldGhvZCksdGhpcy5vcHRpb25zLnN1YnRhYnMmJnRoaXMub3B0aW9ucy5zdWJ0YWJzLmxlbmd0aClpZihlIT10aGlzLm1ldGhvZCl0LmVhY2godGhpcy5vcHRpb25zLnN1YnRhYnMsZnVuY3Rpb24odCl7dC5tZXRob2Q9PWUmJnRoaXMuJGVsLmFkZENsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUgdWktdGFicy1zZWxlY3RlZCIpfSx0aGlzKTtlbHNle3RoaXMuJGVsLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoIi51aS1zdWJ0YWJzIGxpOmZpcnN0LWNoaWxkIikuYWRkQ2xhc3MoInVpLXN0YXRlLWFjdGl2ZSB1aS10YWJzLXNlbGVjdGVkIik7dmFyIGk9dGhpcy5vcHRpb25zLnJvdXRlKyIvIit0aGlzLm9wdGlvbnMuc3VidGFic1swXS5yb3V0ZXM7dGhpcy5yb3V0ZXIubmF2aWdhdGUoaSx7dHJpZ2dlcjohMH0pfWVsc2UgdGhpcy4kZWwucGFyZW50KCkucGFyZW50KCkuZmluZCgiLnVpLXN1YnRhYnMiKS50b2dnbGUoZSE9dGhpcy5tZXRob2QpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHt0YWdOYW1lOiJsaSIsY2xhc3NOYW1lOiJzdWJ0YWIgdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItdG9wIixhdHRyaWJ1dGVzOntyb2xlOiJzdWJ0YWIifSx0ZW1wbGF0ZTonPGEgY2xhc3M9InN1Yi10YWItbGluayB1aS10YWJzLWFuY2hvciIgcm9sZT0icHJlc2VudGF0aW9uIiBocmVmPSJ7e3JvdXRlfX0iPnt7bGFiZWx9fTwvYT4nLGV2ZW50czp7ImNsaWNrIGEiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMucm91dGVyLm5hdmlnYXRlKHRoaXMucm91dGUse3RyaWdnZXI6ITB9KX19LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmV4dGVuZCh0aGlzLHQucGljayh0aGlzLm9wdGlvbnMsInJvdXRlIiwicm91dGVyIiwibWV0aG9kIikpLHRoaXMubGlzdGVuVG8odGhpcy5yb3V0ZXIsInJvdXRlIix0aGlzLnRvZ2dsZSl9LHRvZ2dsZTpmdW5jdGlvbih0KXt0aGlzLiRlbC50b2dnbGVDbGFzcygidWktc3RhdGUtYWN0aXZlIHVpLXRhYnMtc2VsZWN0ZWQiLHQ9PXRoaXMubWV0aG9kKSx0aGlzLiRlbC5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCIudWktdGFicy1wYW5lbCIpLmFkZENsYXNzKCJzdWJ0YWItY29udGVudCIpLHRoaXMuJGVsLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoIi51aS1zdWJ0YWJzIikuYWRkQ2xhc3MoInN1YnRhYnMtcGFuZWwiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7ISh0LmV4cG9ydHM9e0RFQk9VTkNFX0RFTEFZOjIwMCxMT0FESU5HX0ZBREU6NDAwLFVOTE9BRElOR19GQURFOjQwMCxST1dfRVhQQU5ERVJfVFJBTlNJVElPTjoxNTAsSElERV9BRERfTUFQUElOR19GT1JNOjMwMH0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDM2KV0scj1mdW5jdGlvbih0KXt2YXIgZT17TUlMTElTRUNPTkQ6Im1pbGxpc2Vjb25kcyIsU0VDT05EOiJzZWNvbmRzIixNSU5VVEU6Im1pbnV0ZXMiLEhPVVI6ImhvdXJzIixEQVk6ImRheXMifTtyZXR1cm57TUlOVVRFU19IT1VSU19EQVlTOntNSU5VVEU6Ik1pbnV0ZXMiLEhPVVI6IkhvdXJzIixEQVk6IkRheXMifSxNSUxMSVNFQ09ORFNfU0VDT05EU19NSU5VVEVTOntNSUxMSVNFQ09ORDoiTWlsbGlzZWNvbmRzIixTRUNPTkQ6IlNlY29uZHMiLE1JTlVURToiTWludXRlcyJ9LGNvbnZlcnRUb1BEVDpmdW5jdGlvbihlLGksbil7cmV0dXJuIGl8fChpPSJNTU0gREQsIFlZWVkgaDptbTpzcyBBIiksbnx8KG49IiIpLGU/dChlKS51dGMoKS56b25lKCItMDc6MDAiKS5mb3JtYXQoaSk6bn0sZ2V0VGltZUluSGlnaGVzdFJlbGV2YW50VW5pdDpmdW5jdGlvbihpLG4pe3ZhciByLHM9dC5kdXJhdGlvbihpLGVbbl18fG4pO3JldHVybiByPTAhPT1zLm1pbGxpc2Vjb25kcygpPyJtaWxsaXNlY29uZHMiOjAhPT1zLnNlY29uZHMoKT8ic2Vjb25kcyI6MCE9PXMubWludXRlcygpPyJtaW51dGVzIjowIT09cy5ob3VycygpPyJob3VycyI6ImRheXMiLHt0aW1lOnMuYXMociksdW5pdDp0aGlzLmNvbnZlcnRNb21lbnRVbml0cyhyKX19LGNvbnZlcnRNb21lbnRVbml0czpmdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZSJtaWxsaXNlY29uZHMiOnJldHVybiJNSUxMSVNFQ09ORCI7Y2FzZSJzZWNvbmRzIjpyZXR1cm4iU0VDT05EIjtjYXNlIm1pbnV0ZXMiOnJldHVybiJNSU5VVEUiO2Nhc2UiaG91cnMiOnJldHVybiJIT1VSIjtjYXNlImRheXMiOnJldHVybiJEQVkiO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJUaW1lIHVuaXQgbm90IHJlY29nbml6ZWQ6ICIrdCl9fSxjb252ZXJ0VGltZVVuaXQ6ZnVuY3Rpb24oaSxuLHIpe3JldHVybiBpPXBhcnNlSW50KGksMTApLG49ZVtuXXx8bixyPWVbcl18fHIsdC5kdXJhdGlvbihpLG4pLmFzKHIpfSxjb252ZXJ0VGltZUZvcm1hdDpmdW5jdGlvbihlLGksbil7cmV0dXJuIG58fChuPSJNTU1NIERvLCBZWVlZIiksdChlLGkpLmZvcm1hdChuKX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpXSxyPWZ1bmN0aW9uKHQpe3JldHVybntyZWRpcmVjdDpmdW5jdGlvbih0KXt3aW5kb3cubG9jYXRpb249dH0scmVsb2FkUGFnZTpmdW5jdGlvbigpe3dpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKX0sY29uc3RhbnRFcnJvcjpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IodCl9fSxnZXRVcmxRdWVyeVN0cmluZzpmdW5jdGlvbihlKXt0LmlzT2JqZWN0KGUpfHwoZT17fSk7dmFyIGk9dC53aXRob3V0KHQubWFwKGUsZnVuY3Rpb24odCxlKXtpZih2b2lkIDAhPT10JiZudWxsIT09dClyZXR1cm4gZSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KHQpfSksdm9pZCAwKS5qb2luKCImIik7cmV0dXJuIHQuaXNFbXB0eShpKT8iIjoiPyIraX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQ2KSxpKDE5MiksaSgxOTQpLGkoMTk1KSxpKDI0NyksaSgyNjcpLGkoMjgzKSxpKDI4NCldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXtyZXR1cm57QmFzZVZpZXc6dCxMaXN0VmlldzplLFRhYmxlVmlldzppLGNvbXBvbmVudHM6bixkYXRhbGlzdDpyLGZvcm1zOnMsdGFiczpvLHVwbG9hZGVyOmF9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQ2KSxpKDE5MyldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5kZWNvcmF0ZShlKX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOyFmdW5jdGlvbihvLGEpe3I9W2koMiksaSgxNDIpXSxuPWEscz0iZnVuY3Rpb24iPT10eXBlb2Ygbj9uLmFwcGx5KGUscik6biwhKHZvaWQgMCE9PXMmJih0LmV4cG9ydHM9cykpfSh0aGlzLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2lmKGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLCF0aGlzLmNvbGxlY3Rpb24pdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIGNvbGxlY3Rpb24iKTt0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwicmVzZXQgc29ydCIsdGhpcy5yZXNldCksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sImFkZCIsdGhpcy5hZGRJdGVtKSx0aGlzLmNvbGxlY3Rpb24uZWFjaCh0aGlzLmFkZEl0ZW0sdGhpcyl9LGl0ZW06bnVsbCxpdGVtU2VsZWN0b3I6bnVsbCxyZXNldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW92ZUNoaWxkcmVuKCksdGhpcy5jb2xsZWN0aW9uLmVhY2godGhpcy5hZGRJdGVtLHRoaXMpLHRoaXN9LGFkZEl0ZW06ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hZGQodGhpcy5pdGVtLHRoaXMuaXRlbVNlbGVjdG9yLHtvcHRpb25zOnttb2RlbDp0fX0pLmxhc3QoKTtyZXR1cm4gZS5saXN0ZW5Ubyh0LCJkZXN0cm95IHJlbW92ZSIsZS5yZW1vdmUpLHRoaXN9fSl9KX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTU0KSxpKDE5NiksaSgxOTcpLGkoMjM3KSxpKDIzOSksaSgyNDIpLGkoMjQzKSxpKDI0NCksaSgyNDUpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsKXtyZXR1cm57QmFzZUJ1dHRvbkxpbms6dCxCYXNlRHJvcERvd246ZSxCYXNlRm9ybURpYWxvZzppLEJhc2VNb2RhbERpYWxvZzpuLEJhc2VTcGlubmVyOnIsQ2FsbG91dDpzLENvbmZpcm1hdGlvbkRpYWxvZzpvLERyb3BEb3duOmEsTXVsdGlWaWV3TW9kYWxEaWFsb2c6bH19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMTQ3KSxpKDE0NildLHI9ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9aS50cGwoJ1x0ICAgIDxhIGNsYXNzPSJpY29uLTE2IHt7Y2xhc3NOYW1lfX0iIGRhdGEtc2U9Int7c2VsZW5pdW1JZH19Ij5cdCAgICAgIHt7I2lmIGljb259fVx0ICAgICAgPHNwYW4gY2xhc3M9Imljb24ge3tpY29ufX0iPjwvc3Bhbj5cdCAgICAgIHt7L2lmfX1cdCAgICAgIHt7I2lmIHRpdGxlfX1cdCAgICAgIHt7dGl0bGV9fVx0ICAgICAge3svaWZ9fVx0ICAgICAge3sjaWYgc3VidGl0bGV9fVx0ICAgICAgICA8cCBjbGFzcz0ib3B0aW9uLXN1YnRpdGxlIj57e3N1YnRpdGxlfX08L3A+XHQgICAgICB7ey9pZn19XHQgICA8L2E+XHQgICAnKSxzPW4uZXh0ZW5kKHt0YWdOYW1lOiJsaSIsZXZlbnRzOntjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5hY3Rpb24mJnRoaXMuYWN0aW9uLmNhbGwodGhpcyl9fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe24uYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJGVsLmFkZENsYXNzKCJva3RhLWRyb3Bkb3duLW9wdGlvbiBvcHRpb24iKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLmh0bWwocih7aWNvbjp0LnJlc3VsdCh0aGlzLCJpY29uIiksY2xhc3NOYW1lOnQucmVzdWx0KHRoaXMsImNsYXNzTmFtZSIpfHwiIix0aXRsZTp0LnJlc3VsdCh0aGlzLCJ0aXRsZSIpLHN1YnRpdGxlOnQucmVzdWx0KHRoaXMsInN1YnRpdGxlIiksc2VsZW5pdW1JZDp0LnJlc3VsdCh0aGlzLCJzZWxlbml1bUlkIil9KSksdGhpc319KTtyZXR1cm4gbi5leHRlbmQoe2V2ZW50czp7ImNsaWNrIGEub3B0aW9uLXNlbGVjdGVkIjpmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksdC5yZXN1bHQodGhpcywiZGlzYWJsZWQiKSYmZS5zdG9wUHJvcGFnYXRpb24oKX0sImNsaWNrIC5kcm9wZG93bi1kaXNhYmxlZCI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCl9fSxpdGVtczpbXSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3ZhciBlPXRoaXMuY2xhc3NOYW1lO3RoaXMuY2xhc3NOYW1lPW51bGwsbi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5jbGFzc05hbWU9ZSx0aGlzLiRlbC5hZGRDbGFzcygiZHJvcGRvd24gbW9yZS1hY3Rpb25zIGZsb2F0LWwiKSx0LmVhY2godC5yZXN1bHQodGhpcywiaXRlbXMiKSxmdW5jdGlvbih0KXt0aGlzLmFkZE9wdGlvbih0LHRoaXMub3B0aW9ucyl9LHRoaXMpfSx0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluay1idXR0b24ge3tjbGFzc05hbWV9fSBsaW5rLWJ1dHRvbi1pY29uIG9wdGlvbi1zZWxlY3RlZCBjZW50ZXIiPlx0ICAgICAgICB7eyNpZiBpY29ufX1cdCAgICAgICAgPHNwYW4gY2xhc3M9Imljb24ge3tpY29ufX0iPjwvc3Bhbj5cdCAgICAgICAge3svaWZ9fVx0ICAgICAgICA8c3BhbiBjbGFzcz0ib3B0aW9uLXNlbGVjdGVkLXRleHQiPnt7dGl0bGV9fTwvc3Bhbj5cdCAgICAgICAgPHNwYW4gY2xhc3M9Imljb24tZG0iPjwvc3Bhbj5cdCAgICAgIDwvYT5cdCAgICAgIDxkaXYgY2xhc3M9Im9wdGlvbnMgY2xlYXJmaXgiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+XHQgICAgICA8dWwgY2xhc3M9Im9rdGEtZHJvcGRvd24tbGlzdCBvcHRpb25zLXdyYXAgY2xlYXJmaXgiPjwvdWw+XHQgICAgICA8L2Rpdj5cdCAgICAnLGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBpPVt0LnJlc3VsdCh0aGlzLCJjbGFzc05hbWUiKXx8IiIsdC5yZXN1bHQodGhpcywiZGlzYWJsZWQiKT8iZHJvcGRvd24tZGlzYWJsZWQiOiIiXTtyZXR1cm57aWNvbjp0LnJlc3VsdCh0aGlzLCJpY29uIiksY2xhc3NOYW1lOmUudHJpbShpLmpvaW4oIiAiKSksdGl0bGU6dC5yZXN1bHQodGhpcywidGl0bGUiKX19LGFkZE9wdGlvbjpmdW5jdGlvbih0LGUpe3RoaXMuYWRkKHMuZXh0ZW5kKHQpLCJ1bC5vcHRpb25zLXdyYXAiLHtvcHRpb25zOmV8fHt9fSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTQ2KSxpKDEzOSksaSgxOTgpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9WyJzYXZlIiwibm9DYW5jZWxCdXR0b24iLCJpbnB1dHMiLCJzdWJ0aXRsZSIsImF1dG9TYXZlIiwiZm9jdXMiLCJjYW5jZWwiLCJkYW5nZXIiLCJoYXNTYXZpbmdTdGF0ZSIsImN1c3RvbVNhdmluZ1N0YXRlIiwicGFyc2VFcnJvck1lc3NhZ2UiXSxvPXtsYXlvdXQ6Im8tZm9ybS13cmFwIixzY3JvbGxPbkVycm9yOiExfSxhPXttaW5XaWR0aDo2MDAsbWF4V2lkdGg6OTUwLGZvY3VzOiExLGNsb3NlOiExLGF1dG9SZXNpemU6ITEsYXV0b1Bvc2l0aW9uOiEwfTtyZXR1cm4gaS5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKGwpe3ZhciBjPXIuZXh0ZW5kKGUuZXh0ZW5kKHt9LG8sZS5waWNrKHRoaXMscykpKTt0aGlzLmZvcm09bmV3IGMoZS5vbWl0KGwsInRpdGxlIiwic3VidGl0bGUiKSksdGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInJlc2l6ZSIsZS5kZWJvdW5jZShlLmJpbmQodGhpcy5yZXNpemVNb2RhbCx0aGlzKSwxMDApKTt2YXIgdT1lLmJpbmQodGhpcy5yZW1vdmUsdGhpcyk7dGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sImFsbCIsZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLCJjYW5jZWwiPT09YXJndW1lbnRzWzBdJiZ1KCl9KSx0KHdpbmRvdykucmVzaXplKGUuZGVib3VuY2UoZS5iaW5kKHRoaXMucmVzaXplTW9kYWwsdGhpcyksMTAwKSk7dmFyIGQ9bi5leHRlbmQoe3RpdGxlOnRoaXMudGl0bGUsY2xhc3NOYW1lOnRoaXMuY2xhc3NOYW1lLHBhcmFtczplLmV4dGVuZCh7fSxhLHRoaXMucGFyYW1zKX0pO3RoaXMuZGlhbG9nPW5ldyBkKGwpLHRoaXMuZGlhbG9nLmFkZCh0aGlzLmZvcm0pLHRoaXMuZWw9dGhpcy5kaWFsb2cuZWwsaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5mb3JtLmdldEF0dHJpYnV0ZSgiYXV0b1NhdmUiKSYmdGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlZCIsdGhpcy5yZW1vdmUpfSxmb3JtOnZvaWQgMCxkaWFsb2c6dm9pZCAwLGFkZElucHV0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9ybS5hZGRJbnB1dC5hcHBseSh0aGlzLmZvcm0sYXJndW1lbnRzKX0sYWRkQnV0dG9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9ybS5hZGRCdXR0b24uYXBwbHkodGhpcy5mb3JtLGFyZ3VtZW50cyl9LGFkZERpdmlkZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtLmFkZERpdmlkZXIuYXBwbHkodGhpcy5mb3JtLGFyZ3VtZW50cyl9LGFkZFNlY3Rpb25UaXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZvcm0uYWRkU2VjdGlvblRpdGxlLmFwcGx5KHRoaXMuZm9ybSxhcmd1bWVudHMpfSxhZGQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtLmFkZC5hcHBseSh0aGlzLmZvcm0sYXJndW1lbnRzKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJlUmVuZGVyKCksdGhpcy5kaWFsb2cucmVuZGVyLmFwcGx5KHRoaXMuZGlhbG9nLGFyZ3VtZW50cyksZS5kZWZlcihlLmJpbmQodGhpcy5yZXNpemVNb2RhbCx0aGlzKSksdGhpcy5wb3N0UmVuZGVyKCksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlhbG9nLnJlbW92ZS5hcHBseSh0aGlzLmRpYWxvZyxhcmd1bWVudHMpLGkucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHJlc2l6ZU1vZGFsOmZ1bmN0aW9uKCl7dmFyIGk9dCgiLnNpbXBsZW1vZGFsLWNvbnRhaW5lci1uZXciKSxuPXRoaXMuZm9ybSxyPWkuaGVpZ2h0KCkscz1lLmlzTnVtYmVyKHRoaXMuZGlhbG9nLnBhcmFtcy5taW5IZWlnaHQpP3RoaXMuZGlhbG9nLnBhcmFtcy5taW5IZWlnaHQ6MCxvPXQod2luZG93KS5oZWlnaHQoKTtzPD1yJiYocj49bz9uLmNvbnRlbnRIZWlnaHQoby10aGlzLmRpYWxvZy4kKCJoMiIpLm91dGVySGVpZ2h0KCktbi4kKCIuby1mb3JtLWJ1dHRvbi1iYXIiKS5vdXRlckhlaWdodCgpLShpLm91dGVySGVpZ2h0KCEwKS1uLiRlbC5vdXRlckhlaWdodCghMCkpKTpuLmNvbnRlbnRIZWlnaHQobi5jb250ZW50SGVpZ2h0KCkrKG8tciktKGkub3V0ZXJIZWlnaHQoKS1yKSksdGhpcy5kaWFsb2cucmVzaXplLmFwcGx5KHRoaXMuZGlhbG9nLGFyZ3VtZW50cykpfSxjbGVhckVycm9yczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZvcm0uY2xlYXJFcnJvcnMuYXBwbHkodGhpcy5mb3JtLGFyZ3VtZW50cyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMTQ3KSxpKDE3NyksaSgxNDYpLGkoMjAwKSxpKDIzMCksaSgxOTkpLGkoMjMyKSxpKDIzNCksaSgyMjUpLGkoMjMzKSxpKDIzNSksaSgyMzYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMsdSxkLGgscCl7ZnVuY3Rpb24gZih0KXtpZighXyYmdGhpcy4kZWwuaGFzQ2xhc3MoIm8tZm9ybS1zYXZpbmciKSl7dmFyIGk9ZSh0LmN1cnJlbnRUYXJnZXQpO2kuY3NzKCJkaXNwbGF5Iiwibm9uZSIpO3ZhciBuPWRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQodC5jbGllbnRYLHQuY2xpZW50WSk7cmV0dXJuIGkuY3NzKCJkaXNwbGF5IiwiYmxvY2siKSx0LnRhcmdldD1uLGUobikudHJpZ2dlcih0KSwhMX19dmFyIG09J1x0ICAgIHt7I2lmIGhhc1JlYWRNb2RlfX1cdCAgICAgIDxoMiBjbGFzcz0iby1mb3JtLXRpdGxlLWJhciIgZGF0YS1zZT0iby1mb3JtLXRpdGxlLWJhciI+XHQgICAgICAgIHt7dGl0bGV9fVx0ICAgICAgPC9oMj5cdCAgICB7ey9pZn19XHQgICAgPGRpdiBkYXRhLXNlPSJvLWZvcm0tY29udGVudCIgY2xhc3M9Im8tZm9ybS1jb250ZW50IHt7bGF5b3V0fX0gY2xlYXJmaXgiPlx0ICAgICAge3sjdW5sZXNzIGhhc1JlYWRNb2RlfX1cdCAgICAgICAge3sjaWYgdGl0bGV9fVx0ICAgICAgICAgIDxoMiBkYXRhLXNlPSJvLWZvcm0taGVhZCIgY2xhc3M9Im9rdGEtZm9ybS10aXRsZSBvLWZvcm0taGVhZCI+e3t0aXRsZX19PC9oMj5cdCAgICAgICAge3svaWZ9fVx0ICAgICAge3svdW5sZXNzfX1cdCAgICAgIHt7I2lmIHN1YnRpdGxlfX1cdCAgICAgICAgPHAgY2xhc3M9Im9rdGEtZm9ybS1zdWJ0aXRsZSBvLWZvcm0tZXhwbGFpbiIgZGF0YS1zZT0iby1mb3JtLWV4cGxhaW4iPnt7c3VidGl0bGV9fTwvcD5cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxkaXYgY2xhc3M9Im8tZm9ybS1lcnJvci1jb250YWluZXIiIGRhdGEtc2U9Im8tZm9ybS1lcnJvci1jb250YWluZXIiPjwvZGl2Plx0ICAgICAgPGRpdiBjbGFzcz0iby1mb3JtLWZpZWxkc2V0LWNvbnRhaW5lciIgZGF0YS1zZT0iby1mb3JtLWZpZWxkc2V0LWNvbnRhaW5lciI+PC9kaXY+XHQgICAgPC9kaXY+XHQgICcsXz0iYXV0byI9PT1lKCI8ZGl2PiIpLmNzcyh7InBvaW50ZXItZXZlbnRzIjoiYXV0byJ9KVswXS5zdHlsZS5wb2ludGVyRXZlbnRzLGc9e3N1Ym1pdDpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5fX3NhdmUoKX19O3QuZWFjaChbImNsaWNrIiwiZGJsY2xpY2siLCJtb3VzZWRvd24iLCJtb3VzZXVwIl0sZnVuY3Rpb24odCl7Z1t0KyIgLm8tZm9ybS1pbnB1dCJdPWZ9KTt2YXIgdj1mdW5jdGlvbihlKXtlfHwoZT17fSk7dmFyIGk9ZSYmZS5jb2xsZWN0aW9ufHx7fTtyZXR1cm57bWV0aG9kOiJQT1NUIixhY3Rpb246dC5yZXN1bHQoZSwidXJsUm9vdCIpfHx0LnJlc3VsdChpLCJ1cmwiKXx8d2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLCJkYXRhLXNlIjoiby1mb3JtIn19LHk9ZnVuY3Rpb24oZSxpKXtlfHwoZT0iIik7dmFyIG49W107cmV0dXJuIHQuaXNTdHJpbmcoZSkmJihuPWUuc3BsaXQoIiAiKSksbj10LnVuaW9uKG4saSksbi5qb2luKCIgIil9O3JldHVybiByLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24oZSl7ZXx8KGU9e30pLHRoaXMub3B0aW9ucz1lLHRoaXMuaWQ9dC51bmlxdWVJZCgiZm9ybSIpLHRoaXMudGFnTmFtZT0iZm9ybSIsdC5kZWZhdWx0cyh0aGlzLmV2ZW50cyxnKSx0LmRlZmF1bHRzKHRoaXMuYXR0cmlidXRlcyx2KGUubW9kZWwpKSx0aGlzLl9fYnV0dG9ucz1bXSx0aGlzLl9fZXJyb3JGaWVsZHM9e30sdGhpcy5fX3NhdmVNb2RlbFN0YXRlKGUubW9kZWwpLHRoaXMuc3RlcCYmKHRoaXMuc2F2ZXx8KHRoaXMuc2F2ZT10aGlzLnRvdGFsU3RlcHMmJnRoaXMuc3RlcCE9PXRoaXMudG90YWxTdGVwcz8iTmV4dCI6IkZpbmlzaCIpLHRoaXMuY2xhc3NOYW1lKz0iIHdpemFyZCIpLHRoaXMuY2xhc3NOYW1lKz0iIG8tZm9ybSIsdGhpcy5fX3Rvb2xiYXI9dGhpcy5fX2NyZWF0ZVRvb2xiYXIoZSksci5jYWxsKHRoaXMsZSksdC5lYWNoKHQucmVzdWx0KHRoaXMsImlucHV0cyIpfHxbXSxmdW5jdGlvbih0KXt0aGlzLl9fYWRkTGF5b3V0SXRlbSh0KX0sdGhpcyksdGhpcy5hZGQodGhpcy5fX3Rvb2xiYXIsIiIpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOl9fZWRpdF9fIix0aGlzLl9fYXBwbHlNb2RlKSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImludmFsaWQgZXJyb3IiLHQudGhyb3R0bGUoZnVuY3Rpb24odCxlLGkpe3RoaXMuX19zaG93RXJyb3JzKHQsZSxpIT09ITEpfSwxMDAse3RyYWlsaW5nOiExfSkpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpyZXNpemUiLGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJyZXNpemUiKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpjYW5jZWwiLHQudGhyb3R0bGUodGhpcy5fX2NhbmNlbCwxMDAse3RyYWlsaW5nOiExfSkpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpwcmV2aW91cyIsdC50aHJvdHRsZSh0aGlzLl9fcHJldmlvdXMsMTAwLHt0cmFpbGluZzohMX0pKSx0aGlzLl9fc2F2ZT10LnRocm90dGxlKHRoaXMuX19zYXZlLDIwMCx7dHJhaWxpbmc6ITF9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImZvcm06c2F2ZSIsZnVuY3Rpb24oKXt0aGlzLiRlbC5zdWJtaXQoKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic3luYyIsZnVuY3Rpb24oKXt0aGlzLm1vZGVsLmdldCgiX19lZGl0X18iKSYmdGhpcy5tb2RlbC5zZXQoIl9fZWRpdF9fIiwhMSx7c2lsZW50OiEwfSksdGhpcy5fX3NhdmVNb2RlbFN0YXRlKHRoaXMubW9kZWwpLHRoaXMucmVuZGVyKCl9KTt2YXIgaT10aGlzLmdldEF0dHJpYnV0ZSgiaGFzU2F2aW5nU3RhdGUiKTtpZih0aGlzLmdldEF0dHJpYnV0ZSgiYXV0b1NhdmUiKSYmKHRoaXMubGlzdGVuVG8odGhpcywic2F2ZSIsZnVuY3Rpb24oZSl7dmFyIGk9ZS5zYXZlKCk7aSYmaS5kb25lJiZpLmRvbmUodC5iaW5kKGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJzYXZlZCIsZSl9LHRoaXMpKX0pLHQuaXNVbmRlZmluZWQoaSkmJihpPSEwKSksaSl7dmFyIG49dGhpcy5nZXRBdHRyaWJ1dGUoImN1c3RvbVNhdmluZ1N0YXRlIix7fSk7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLHkobi5zdGFydHx8IiIsWyJyZXF1ZXN0Il0pLHRoaXMuX19zZXRTYXZpbmdTdGF0ZSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLHkobi5zdG9wfHwiIixbImVycm9yIiwic3luYyJdKSx0aGlzLl9fY2xlYXJTYXZpbmdTdGF0ZSl9fSxfX2NyZWF0ZVRvb2xiYXI6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5nZXRBdHRyaWJ1dGUoImRhbmdlciIpLHI9aT09PSEwPyJidXR0b24tZXJyb3IiOiJidXR0b24tcHJpbWFyeSIscz1uZXcgcCh0LmV4dGVuZCh7c2F2ZTp0aGlzLnNhdmV8fG4ubG9jYWxpemUoIm9mb3JtLnNhdmUiKSxzYXZlSWQ6dGhpcy5zYXZlSWQsc2F2ZUNsYXNzTmFtZTpyLGNhbmNlbDp0aGlzLmNhbmNlbHx8bi5sb2NhbGl6ZSgib2Zvcm0uY2FuY2VsIiksbm9DYW5jZWxCdXR0b246dGhpcy5ub0NhbmNlbEJ1dHRvbnx8ITEsaGFzUHJldlN0ZXA6dGhpcy5zdGVwJiZ0aGlzLnN0ZXA+MX0sZXx8dGhpcy5vcHRpb25zKSk7cmV0dXJuIHQuZWFjaCh0aGlzLl9fYnV0dG9ucyxmdW5jdGlvbih0KXtzLmFkZEJ1dHRvbi5hcHBseShzLHQpfSksc30sY2xhc3NOYW1lOiIiLGF0dHJpYnV0ZXM6e30sZXZlbnRzOnt9LGlucHV0czpbXSx0ZW1wbGF0ZTpudWxsLHJlYWQ6ITEscmVhZE9ubHk6ITEsbm9CdXR0b25CYXI6ITEsbm9DYW5jZWxCdXR0b246ITEsc2F2ZTpudWxsLGNhbmNlbDpudWxsLGRhbmdlcjohMSxsYXlvdXQ6IiIsc3RlcDp2b2lkIDAsdG90YWxTdGVwczp2b2lkIDAsdGl0bGU6bnVsbCxzdWJ0aXRsZTpudWxsLGF1dG9TYXZlOiExLHNjcm9sbE9uRXJyb3I6ITAsc2hvd0Vycm9yczohMCxyZXNpemVTZWxlY3RvcjoiLm8tZm9ybS1jb250ZW50IixnZXRBdHRyaWJ1dGU6ZnVuY3Rpb24oZSxpKXt2YXIgbj10LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsZSx0aGlzKTtyZXR1cm4gdC5pc1VuZGVmaW5lZChuKSYmKG49dC5yZXN1bHQodGhpcyxlKSksdC5pc1VuZGVmaW5lZChuKT9pOm59LGhhc1JlYWRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmdldEF0dHJpYnV0ZSgicmVhZCIpOwoJfSxpc1JlYWRPbmx5OmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmdldEF0dHJpYnV0ZSgicmVhZE9ubHkiKX0saGFzQnV0dG9uQmFyOmZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLmdldEF0dHJpYnV0ZSgibm9CdXR0b25CYXIiKXx8dGhpcy5pc1JlYWRPbmx5KCkpfSxyZW5kZXI6ZnVuY3Rpb24oKXtpZih0aGlzLl9fcmVhZE1vZGVCYXImJnRoaXMuX19yZWFkTW9kZUJhci5yZW1vdmUoKSx0aGlzLmhhc1JlYWRNb2RlKCkmJiF0aGlzLmlzUmVhZE9ubHkoKSl7dmFyIHQ9aC5leHRlbmQoe2Zvcm1UaXRsZTp0aGlzLmdldEF0dHJpYnV0ZSgidGl0bGUiLCIiKX0pO3RoaXMuX19yZWFkTW9kZUJhcj10aGlzLmFkZCh0LCIuby1mb3JtLXRpdGxlLWJhciIpLmxhc3QoKX12YXIgZT1pLnRwbChtKSh7bGF5b3V0OnRoaXMuZ2V0QXR0cmlidXRlKCJsYXlvdXQiLCIiKSx0aXRsZTp0aGlzLmdldEF0dHJpYnV0ZSgidGl0bGUiLCIiLCEwKSxzdWJ0aXRsZTp0aGlzLmdldEF0dHJpYnV0ZSgic3VidGl0bGUiLCIiLCEwKSxoYXNSZWFkTW9kZTp0aGlzLmhhc1JlYWRNb2RlKCl9KTtyZXR1cm4gdGhpcy4kZWwuaHRtbChlKSxkZWxldGUgdGhpcy50ZW1wbGF0ZSxyLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX19hcHBseU1vZGUoKSx0aGlzfSxfX3NldFNhdmluZ1N0YXRlOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnNldC1zYXZpbmctc3RhdGUiKSx0aGlzLiRlbC5hZGRDbGFzcygiby1mb3JtLXNhdmluZyIpfSxfX2NsZWFyU2F2aW5nU3RhdGU6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06Y2xlYXItc2F2aW5nLXN0YXRlIiksdGhpcy4kZWwucmVtb3ZlQ2xhc3MoIm8tZm9ybS1zYXZpbmciKX0sX190b2dnbGVUb29sYmFyOmZ1bmN0aW9uKCl7dGhpcy5fX3Rvb2xiYXImJnRoaXMuX190b29sYmFyLnJlbW92ZSgpLHRoaXMuaGFzQnV0dG9uQmFyKCkmJnRoaXMuX2VkaXRNb2RlKCkmJih0aGlzLl9fdG9vbGJhcj10aGlzLl9fY3JlYXRlVG9vbGJhcigpLHRoaXMuYWRkKHRoaXMuX190b29sYmFyLCIiKSksdGhpcy50cmlnZ2VyKCJyZXNpemUiKX0sX19jYW5jZWw6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm1vZGVsLmdldCgiX19lZGl0X18iKTt0aGlzLm1vZGVsLmNsZWFyKHtzaWxlbnQ6ITB9KTt2YXIgaTtpPXRoaXMubW9kZWwuc2FuaXRpemVBdHRyaWJ1dGVzP3RoaXMubW9kZWwuc2FuaXRpemVBdHRyaWJ1dGVzKHRoaXMuX19vcmlnaW5hbE1vZGVsKTp0LmNsb25lKHRoaXMuX19vcmlnaW5hbE1vZGVsKSx0aGlzLm1vZGVsLnNldChpLHtzaWxlbnQ6ITB9KSx0aGlzLnRyaWdnZXIoImNhbmNlbCIsdGhpcy5tb2RlbCksdGhpcy5tb2RlbC50cmlnZ2VyKCJjYWNoZTpjbGVhciIpLGUmJih0aGlzLm1vZGVsLnNldCgiX19lZGl0X18iLCExLHtzaWxlbnQ6ITB9KSx0aGlzLm1vZGVsLnRyaWdnZXIoImNoYW5nZTpfX2VkaXRfXyIsdGhpcy5tb2RlbCwhMSkpLHRoaXMuY2xlYXJFcnJvcnMoKX0saXNWYWxpZDpmdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7cmV0dXJuIHQucmVkdWNlKGUsZnVuY3Rpb24oZSxpKXtyZXR1cm4gdC5leHRlbmQoZSxuLm1vZGVsLnZhbGlkYXRlRmllbGQoaSkpfSx7fSl9dmFyIGksbj10aGlzO3JldHVybiB0LmlzVW5kZWZpbmVkKHRoaXMudmFsaWRhdGUpP3RoaXMubW9kZWwuaXNWYWxpZCgpOih0LmlzRnVuY3Rpb24odGhpcy52YWxpZGF0ZSk/aT10aGlzLnZhbGlkYXRlKCk6dC5pc0FycmF5KHRoaXMudmFsaWRhdGUpP2k9ZSh0aGlzLnZhbGlkYXRlKToibG9jYWwiPT09dGhpcy52YWxpZGF0ZSYmKGk9ZSh0aGlzLmdldElucHV0cygpLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5vcHRpb25zLm5hbWV9KSkpLCEhdC5pc0VtcHR5KGkpfHwodGhpcy5tb2RlbC50cmlnZ2VyKCJpbnZhbGlkIix0aGlzLm1vZGVsLGkpLCExKSl9LF9fc2F2ZTpmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKSx0aGlzLmlzVmFsaWQoKSYmdGhpcy50cmlnZ2VyKCJzYXZlIix0aGlzLm1vZGVsKX0sX19wcmV2aW91czpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcigicHJldmlvdXMiLHRoaXMubW9kZWwpfSxfX2FwcGx5TW9kZTpmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKSx0aGlzLl9fdG9nZ2xlVG9vbGJhcigpLHRoaXMuX2VkaXRNb2RlKCk/KHRoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0tZWRpdC1tb2RlIiksdGhpcy4kZWwucmVtb3ZlQ2xhc3MoIm8tZm9ybS1yZWFkLW1vZGUiKSx0aGlzLiQoIi5vLWZvcm0tY29udGVudCIpLnJlbW92ZUNsYXNzKCJyb3VuZGVkLWJ0bS00IiksdGhpcy5mb2N1cygpKToodGhpcy4kZWwucmVtb3ZlQ2xhc3MoIm8tZm9ybS1lZGl0LW1vZGUiKSx0aGlzLiRlbC5hZGRDbGFzcygiby1mb3JtLXJlYWQtbW9kZSIpLHRoaXMuJCgiLm8tZm9ybS1jb250ZW50IikuYWRkQ2xhc3MoInJvdW5kZWQtYnRtLTQiKSl9LF9lZGl0TW9kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmdldCgiX19lZGl0X18iKXx8IXRoaXMuaGFzUmVhZE1vZGUoKX0scGFyc2VFcnJvck1lc3NhZ2U6dC5pZGVudGl0eSxfX3Nob3dFcnJvcnM6ZnVuY3Rpb24oaSxyLHMpe2lmKHRoaXMudHJpZ2dlcigiZXJyb3IiLGkpLHRoaXMuZ2V0QXR0cmlidXRlKCJzaG93RXJyb3JzIikpe3ZhciBvLGE9dS5wYXJzZUZpZWxkRXJyb3JzKHIpO2lmKHQuc2l6ZShhKSl0LmVhY2goYSxmdW5jdGlvbihlLGkpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpmaWVsZC1lcnJvciIsdGhpcy5fX2Vycm9yRmllbGRzW2ldfHxpLHQubWFwKGUsZnVuY3Rpb24odCl7cmV0dXJuL15tb2RlbFwudmFsaWRhdGlvbi8udGVzdCh0KT9uLmxvY2FsaXplKHQpOnR9KSl9LHRoaXMpO2Vsc2V7dmFyIGw9dS5nZXRSZXNwb25zZUpTT04ocik7bD10aGlzLnBhcnNlRXJyb3JNZXNzYWdlKGwpLG89bCYmbC5lcnJvclN1bW1hcnl9aWYocyYmKHRoaXMuJCgiLm8tZm9ybS1lcnJvci1jb250YWluZXIiKS5hZGRDbGFzcygiby1mb3JtLWhhcy1lcnJvcnMiKSx0aGlzLmFkZChjLCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIse29wdGlvbnM6e2Vycm9yU3VtbWFyeTpvfX0pKSx0aGlzLmdldEF0dHJpYnV0ZSgic2Nyb2xsT25FcnJvciIpKXt2YXIgZD1lKCIjIit0aGlzLmlkKyIgLm8tZm9ybS1lcnJvci1jb250YWluZXIiKTtkLmxlbmd0aCYmZSgiaHRtbCwgYm9keSIpLmFuaW1hdGUoe3Njcm9sbFRvcDpkLm9mZnNldCgpLnRvcH0sNDAwKX10aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cmVzaXplIil9fSxjbGVhckVycm9yczpmdW5jdGlvbigpe3RoaXMuJCgiLm8tZm9ybS1lcnJvci1jb250YWluZXIiKS5yZW1vdmVDbGFzcygiby1mb3JtLWhhcy1lcnJvcnMiKSx0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06Y2xlYXItZXJyb3JzIiksdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpfSx0b2dnbGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5zZXQoIl9fZWRpdF9fIiwhdGhpcy5oYXNSZWFkTW9kZSgpfHwhdGhpcy5tb2RlbC5nZXQoIl9fZWRpdF9fIikpLHRoaXN9LF9fYWRkTGF5b3V0SXRlbTpmdW5jdGlvbih0KXtzLnN1cHBvcnRzKHQpP3RoaXMuYWRkSW5wdXQodCk6dGhpcy5fX2FkZE5vbklucHV0TGF5b3V0SXRlbSh0KX0sX19hZGROb25JbnB1dExheW91dEl0ZW06ZnVuY3Rpb24oZSl7dmFyIGk9dC5vbWl0KGUsInR5cGUiKTtzd2l0Y2goZS50eXBlKXtjYXNlInNlY3Rpb25UaXRsZSI6dGhpcy5hZGRTZWN0aW9uVGl0bGUoZS50aXRsZSx0Lm9taXQoaSwidGl0bGUiKSk7YnJlYWs7Y2FzZSJkaXZpZGVyIjp0aGlzLmFkZERpdmlkZXIoaSk7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInVua25vd24gaW5wdXQ6ICIrZS50eXBlKX19LGFkZEJ1dHRvbjpmdW5jdGlvbih0LGUpe3RoaXMuX190b29sYmFyJiZ0aGlzLl9fdG9vbGJhci5hZGRCdXR0b24odCxlKSx0aGlzLl9fYnV0dG9ucy5wdXNoKFt0LGVdKX0sYWRkRGl2aWRlcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hZGQoJzxkaXYgY2xhc3M9Im9rdGEtZm9ybS1kaXZpZGVyIGZvcm0tZGl2aWRlciI+PC9kaXY+JyksZC5hcHBseVNob3dXaGVuKHRoaXMubGFzdCgpLHQmJnQuc2hvd1doZW4pLHRoaXN9LGFkZFNlY3Rpb25UaXRsZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmFkZChpLnRwbCgnPGgyIGNsYXNzPSJvLWZvcm0taGVhZCI+e3t0aXRsZX19PC9oMj4nKSh7dGl0bGU6dH0pKSxkLmFwcGx5U2hvd1doZW4odGhpcy5sYXN0KCksZSYmZS5zaG93V2hlbiksdGhpc30sYWRkSW5wdXQ6ZnVuY3Rpb24oZSl7ZT10LmNsb25lKGUpLGQudmFsaWRhdGVJbnB1dChlLHRoaXMubW9kZWwpO3ZhciBpPWQuZ2VuZXJhdGVJbnB1dE9wdGlvbnMoZSx0aGlzLHRoaXMuX19jcmVhdGVJbnB1dCkucmV2ZXJzZSgpO3QuaXNFbXB0eSh0aGlzLmdldElucHV0cygpLnRvQXJyYXkoKSkmJnQuZXh0ZW5kKGlbMF0se3ZhbGlkYXRlT25seUlmRGlydHk6ITB9KTt2YXIgbj10Lm1hcChpLHRoaXMuX19jcmVhdGVJbnB1dCx0aGlzKTt0LmVhY2goaSxmdW5jdGlvbih0KXt0LmVycm9yRmllbGQmJih0aGlzLl9fZXJyb3JGaWVsZHNbdC5lcnJvckZpZWxkXT10Lm5hbWUpfSx0aGlzKTt2YXIgcj17aW5wdXRJZDp0Lmxhc3Qobikub3B0aW9ucy5pbnB1dElkLGlucHV0Om4sbXVsdGk6aS5sZW5ndGg+MT9pLmxlbmd0aDp2b2lkIDB9O3QuZXh0ZW5kKHIsdC5vbWl0KHRoaXMub3B0aW9ucywiaW5wdXQiKSx0Lm9taXQoZSwiaW5wdXQiKSk7dmFyIHM9dGhpcy5fX2NyZWF0ZVdyYXBwZXIocik7ci5sYWJlbCE9PSExJiZzLmFkZCh0aGlzLl9fY3JlYXRlTGFiZWwocikpLHMuYWRkKHRoaXMuX2NyZWF0ZUNvbnRhaW5lcihyKSkscy50eXBlPXIudHlwZXx8ci5pbnB1dC50eXBlfHwiY3VzdG9tIjt2YXIgbz1bc10uY29uY2F0KHQuZHJvcChhcmd1bWVudHMsMSkpO3JldHVybiB0aGlzLmFkZC5hcHBseSh0aGlzLG8pfSxfX2NyZWF0ZUlucHV0OmZ1bmN0aW9uKGUpe3JldHVybiBlPXQucGljayhlLGQuSU5QVVRfT1BUSU9OUykscy5jcmVhdGUoZSl9LF9fY3JlYXRlV3JhcHBlcjpmdW5jdGlvbihlKXtyZXR1cm4gZT10LnBpY2soZSxkLldSQVBQRVJfT1BUSU9OUyksbmV3IGwoZSl9LF9fY3JlYXRlTGFiZWw6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dC5waWNrKGUsZC5MQUJFTF9PUFRJT05TKSxuZXcgbyhlKX0sX2NyZWF0ZUNvbnRhaW5lcjpmdW5jdGlvbihlKXtyZXR1cm4gZT10LnBpY2soZSxkLkNPTlRBSU5FUl9PUFRJT05TKSxuZXcgYShlKX0sX19zYXZlTW9kZWxTdGF0ZTpmdW5jdGlvbih0KXt0aGlzLl9fb3JpZ2luYWxNb2RlbD10LmNsb25lKCkuYXR0cmlidXRlc30sYWRkOmZ1bmN0aW9uKCl7dmFyIGU9dC50b0FycmF5KGFyZ3VtZW50cyk7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlWzFdJiYoZVsxXT0iPiBkaXYuby1mb3JtLWNvbnRlbnQgPiAuby1mb3JtLWZpZWxkc2V0LWNvbnRhaW5lciIpLHIucHJvdG90eXBlLmFkZC5hcHBseSh0aGlzLGUpfSxmb2N1czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0SW5wdXRzKCkuZmlyc3QoKTtyZXR1cm4gdCYmdC5mb2N1cyYmdC5mb2N1cygpLHRoaXN9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZva2UoImRpc2FibGUiKSx0aGlzfSxlbmFibGU6ZnVuY3Rpb24oKXt0aGlzLmludm9rZSgiZW5hYmxlIil9LGNvbnRlbnRIZWlnaHQ6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy4kKCIuby1mb3JtLWNvbnRlbnQiKTtyZXR1cm4gdC5pc051bWJlcihlKT92b2lkIGkuY3NzKCJtYXgtaGVpZ2h0IixlKTppLmhlaWdodCgpfSxnZXRJbnB1dHM6ZnVuY3Rpb24oKXtyZXR1cm4gdCh0aGlzLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIGx9KSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NyksaSgxNDQpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUsaSxuKXtmdW5jdGlvbiByKHQpe3JldHVybiB0IGluc3RhbmNlb2Ygbnx8dC5wcm90b3R5cGUgaW5zdGFuY2VvZiBufXJldHVybiBuLmV4dGVuZCh7YXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybnsiZGF0YS1zZSI6Im8tZm9ybS1pbnB1dC1jb250YWluZXIifX0sY2xhc3NOYW1lOmZ1bmN0aW9uKCl7dmFyIGU9Im8tZm9ybS1pbnB1dCI7aWYodGhpcy5vcHRpb25zLndpZGUmJihlKz0iIG8tZm9ybS13aWRlIiksdC5jb250YWlucyhbMSwyLDMsNF0sdGhpcy5vcHRpb25zLm11bHRpKSYmKGUrPSIgby1mb3JtLW11bHRpLWlucHV0LSIrdGhpcy5vcHRpb25zLm11bHRpLHQuaXNBcnJheSh0aGlzLm9wdGlvbnMuaW5wdXQpKSl7dmFyIGk9dC5maW5kKHRoaXMub3B0aW9ucy5pbnB1dCxmdW5jdGlvbihlKXtyZXR1cm4gdC5jb250YWlucyhbInRleHQrc2VsZWN0Iiwic2VsZWN0K3RleHQiXSxlLm9wdGlvbnMudHlwZSl9KTtpJiYoZSs9IiBvLWZvcm0tbXVsdGktaW5wdXQtZ3JvdXAtIit0aGlzLm9wdGlvbnMubXVsdGkpfXJldHVybiBlfSxfZ2V0TmFtZXM6ZnVuY3Rpb24oKXt2YXIgZT10LmlzQXJyYXkodGhpcy5vcHRpb25zLm5hbWUpP3RoaXMub3B0aW9ucy5uYW1lOlt0aGlzLm9wdGlvbnMubmFtZV07cmV0dXJuImdyb3VwIj09dGhpcy5vcHRpb25zLnR5cGU/ZS5wdXNoLmFwcGx5KGUsdC5wbHVjayh0aGlzLm9wdGlvbnMuaW5wdXRbMF0ub3B0aW9ucy5wYXJhbXMuaW5wdXRzLCJuYW1lIikpOnQuaXNBcnJheSh0aGlzLm9wdGlvbnMubmFtZSk/dGhpcy5vcHRpb25zLmlucHV0JiZ0aGlzLm9wdGlvbnMuaW5wdXQub3B0aW9ucyYmdGhpcy5vcHRpb25zLmlucHV0Lm9wdGlvbnMubmFtZSYmZS5wdXNoKHRoaXMub3B0aW9ucy5pbnB1dC5vcHRpb25zLm5hbWUpOnRoaXMub3B0aW9ucy5pbnB1dCYmKHQuaXNBcnJheSh0aGlzLm9wdGlvbnMuaW5wdXQpP3QuZWFjaCh0aGlzLm9wdGlvbnMuaW5wdXQsZnVuY3Rpb24odCl7ZS5wdXNoKHQub3B0aW9ucy5uYW1lKX0pOmUucHVzaCh0aGlzLm9wdGlvbnMuaW5wdXQub3B0aW9ucy5uYW1lKSksdC51bmlxKHQuY29tcGFjdChlKSl9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5vcHRpb25zLmlucHV0JiYodC5pc0FycmF5KHRoaXMub3B0aW9ucy5pbnB1dCk/dC5lYWNoKHRoaXMub3B0aW9ucy5pbnB1dCxmdW5jdGlvbih0KXt0aGlzLmFkZCh0LHtwcmVwZW5kOiEwfSl9LHRoaXMpOnRoaXMuYWRkKHRoaXMub3B0aW9ucy5pbnB1dCx7cHJlcGVuZDohMH0pKSx0aGlzLl9fc2V0RXhwbGFpbih0aGlzLm9wdGlvbnMpO3ZhciBlPXRoaXMuX2dldE5hbWVzKCk7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOmZpZWxkLWVycm9yIixmdW5jdGlvbihpLG4pe3QuY29udGFpbnMoZSxpKSYmdGhpcy5fX3NldEVycm9yKG4pfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOmNsZWFyLWVycm9ycyBjaGFuZ2U6IitlLmpvaW4oIiBjaGFuZ2U6IiksdGhpcy5fX2NsZWFyRXJyb3IpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpjbGVhci1lcnJvcjoiK2Uuam9pbigiIGZvcm06Y2xlYXItZXJyb3I6IiksdGhpcy5fX2NsZWFyRXJyb3IpLHQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywiYXV0b1JlbmRlciIsdGhpcykmJnRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOiIrdGhpcy5vcHRpb25zLm5hbWUsdGhpcy5yZW5kZXIpLHRoaXMuX19lcnJvclN0YXRlPSExfSxfX3NldEV4cGxhaW46ZnVuY3Rpb24oZSl7dmFyIG47cmV0dXJuIGUuY3VzdG9tRXhwbGFpbj8oaS53YXJuKCJEZXByZWNhdGVkIC0gdXNlIGV4cGxhaW4gaW5zdGVhZCBvZiBjdXN0b21FeHBsYWluIiksdm9pZCB0aGlzLmFkZCh0aGlzLm9wdGlvbnMuY3VzdG9tRXhwbGFpbikpOihuPWUuZXhwbGFpbix0LmlzRnVuY3Rpb24obikmJiFyKG4pJiYobj10LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsImV4cGxhaW4iLHRoaXMpKSx2b2lkKG4mJihyKG4pPyh0aGlzLnRlbXBsYXRlPSc8cCBjbGFzcz0iby1mb3JtLWV4cGxhaW4iPjwvcD4nLHRoaXMuYWRkKG4sIi5vLWZvcm0tZXhwbGFpbiIpKTp0aGlzLnRlbXBsYXRlPSc8cCBjbGFzcz0iby1mb3JtLWV4cGxhaW4iPnt7ZXhwbGFpbn19PC9wPicpKSl9LF9fc2V0RXJyb3I6ZnVuY3Rpb24odCl7dGhpcy5fX2Vycm9yU3RhdGU9ITAsdGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1oYXMtZXJyb3JzIik7dmFyIGk9Wyc8cCBjbGFzcz0ib2t0YS1mb3JtLWlucHV0LWVycm9yIG8tZm9ybS1pbnB1dC1lcnJvciBvLWZvcm0tZXhwbGFpbiIgcm9sZT0iYWxlcnQiPicsJzxzcGFuIGNsYXNzPSJpY29uIGljb24tMTYgZXJyb3ItMTYtc21hbGwiPjwvc3Bhbj4nLCJ7e3RleHR9fSIsIjwvcD4iXS5qb2luKCIiKSxuPWUudHBsKGkpKHt0ZXh0OnQuam9pbigiLCAiKX0pLHI9dGhpcy4kKCIuby1mb3JtLWV4cGxhaW4iKS5ub3QoIi5vLWZvcm0taW5wdXQtZXJyb3IiKS5maXJzdCgpO3IubGVuZ3RoP3IuYmVmb3JlKG4pOnRoaXMuJGVsLmFwcGVuZChuKX0sX19jbGVhckVycm9yOmZ1bmN0aW9uKCl7dGhpcy5fX2Vycm9yU3RhdGUmJih0aGlzLiQoIi5vLWZvcm0taW5wdXQtZXJyb3IiKS5yZW1vdmUoKSx0aGlzLiRlbC5yZW1vdmVDbGFzcygiby1mb3JtLWhhcy1lcnJvcnMiKSx0aGlzLl9fZXJyb3JTdGF0ZT0hMSx0LmRlZmVyKHQuYmluZChmdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX0sdGhpcykpKX0sZm9jdXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKHQpe2lmKHQuZm9jdXMpcmV0dXJuIHQuZm9jdXMoKX0pLHRoaXN9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDIwMyksaSgyMDIpLGkoMjA1KSxpKDIwNiksaSgyMDgpLGkoMjEwKSxpKDIxMSksaSgyMTIpLGkoMjEzKSxpKDIxNCksaSgyMTUpLGkoMjAxKSxpKDIxNiksaSgyMTcpLGkoMjE4KSxpKDIxOSksaSgyMjApLGkoMjIxKSxpKDIyMiksaSgyMjMpLGkoMjI4KSxpKDIyOSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwsYyx1LGQsaCxwLGYsbSxfLGcsdix5LGIsdyxNKXtmdW5jdGlvbiBrKGksbil7cmV0dXJuIGkucHJvdG90eXBlIGluc3RhbmNlb2YgZT9uZXcgaSh0Lm9taXQobiwiaW5wdXQiKSk6aX1mdW5jdGlvbiBUKGUpe2lmKGU9dC5jbG9uZShlKSxlLmlucHV0KXJldHVybiBrKGUuaW5wdXQsZSk7dmFyIGk7aWYoIUxbZS50eXBlXSl0aHJvdyBuZXcgRXJyb3IoInVua25vd24gaW5wdXQ6ICIrZS50eXBlKTtyZXR1cm4gaT0ic2VsZWN0Ij09ZS50eXBlJiZ0LnNpemUoZS5vcHRpb25zKT4xZTM/TTpMW2UudHlwZV0sayhpLGUpfWZ1bmN0aW9uIFModCl7cmV0dXJuISF0LmlucHV0fHx0LnR5cGUgaW4gTH12YXIgTD17ImZpbGUvaW1hZ2UiOmIsImZpbGUvY2VydCI6dyxzZWxlY3Q6cix0ZXh0YXJlYTpuLHJhZGlvOnMsY2hlY2tib3g6byx0ZXh0OmkscGFzc3dvcmQ6aSxudW1iZXI6dSx0ZXh0c2VsZWN0OmEsInRleHQrc2VsZWN0IjpsLCJzZWxlY3QrdGV4dCI6bCxkYXRlOmMsZ3JvdXBwaWNrZXI6ZCx1c2VycGlja2VyOmgsYXBwcGlja2VyOnAsYXBwaW5zdGFuY2VwaWNrZXI6Ziwic3Utb3Jnc3BpY2tlciI6bSx6b25lcGlja2VyOl8sbGlzdDpnLGdyb3VwOnYsY2hlY2tib3hzZXQ6eX07cmV0dXJue2NyZWF0ZTpULHN1cHBvcnRzOlN9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE0NyksaSgyMDMpLGkoMTczKSxpKDIwNCldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPSJva3RhLWZvcm0taW5wdXQtZmllbGQgaW5wdXQtZml4IjtyZXR1cm4gZS5leHRlbmQoe3RlbXBsYXRlOnQudHBsKCc8aW5wdXQgdHlwZT0ie3t0eXBlfX0iIHBsYWNlaG9sZGVyPSJ7e3BsYWNlaG9sZGVyfX0iXHQgICAgICBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19Ii8+JyksZXZlbnRzOnsiaW5wdXQgaW5wdXQiOiJ1cGRhdGUiLCJjaGFuZ2UgaW5wdXQiOiJ1cGRhdGUiLCJrZXlkb3duIGlucHV0IjoidXBkYXRlIiwia2V5dXAgaW5wdXQiOmZ1bmN0aW9uKHQpe2kuaXNFbnRlcih0KT90aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06c2F2ZSIpOmkuaXNFc2ModCkmJnRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjYW5jZWwiKX19LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1jb250cm9sIil9LGVkaXRNb2RlOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MobiksZS5wcm90b3R5cGUuZWRpdE1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJCgiaW5wdXQiKS5wbGFjZWhvbGRlcigpfSxyZWFkTW9kZTpmdW5jdGlvbigpe2UucHJvdG90eXBlLnJlYWRNb2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwicGFzc3dvcmQiPT10aGlzLm9wdGlvbnMudHlwZSYmdGhpcy4kZWwudGV4dCgiKioqKioqKioiKSx0aGlzLiRlbC5yZW1vdmVDbGFzcyhuKX0sdmFsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgnaW5wdXRbdHlwZT0iJyt0aGlzLm9wdGlvbnMudHlwZSsnIl0nKS52YWwoKX0sZm9jdXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCJpbnB1dCIpLmZvY3VzKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NildLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe3RhZ05hbWU6InNwYW4iLGF0dHJpYnV0ZXM6ZnVuY3Rpb24oKXtyZXR1cm57ImRhdGEtc2UiOiJvLWZvcm0taW5wdXQtIit0aGlzLmdldE5hbWVTdHJpbmcoKX19LGRlZmF1bHRQbGFjZWhvbGRlcjoiIixjb25zdHJ1Y3RvcjpmdW5jdGlvbihpKXtpPXQuZGVmYXVsdHMoaXx8e30se2lucHV0SWQ6aS5pZHx8dC51bmlxdWVJZCgiaW5wdXQiKSxwbGFjZWhvbGRlcjp0aGlzLmRlZmF1bHRQbGFjZWhvbGRlcixpbmxpbmVWYWxpZGF0aW9uOiEwLHZhbGlkYXRlT25seUlmRGlydHk6ITF9KSxkZWxldGUgaS5pZDt2YXIgbj10aGlzO3QuZWFjaCh7ZW5hYmxlOiJyZW1vdmVDbGFzcyIsZGlzYWJsZToiYWRkQ2xhc3MifSxmdW5jdGlvbihlLGkpe25baV09dC53cmFwKG5baV0sZnVuY3Rpb24odCl7dC5hcHBseShuLGFyZ3VtZW50cyksbi4kZWxbZV0oIm8tZm9ybS1kaXNhYmxlZCIpfSl9KSxlLmNhbGwodGhpcyxpKSx0LnJlc3VsdChpLCJyZWFkT25seSIpIT09ITAmJnQucmVzdWx0KGksInJlYWQiKT09PSEwJiZ0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTpfX2VkaXRfXyIsdGhpcy5yZW5kZXIpLHQuaXNGdW5jdGlvbih0aGlzLmZvY3VzKSYmKHRoaXMuZm9jdXM9dC5kZWJvdW5jZSh0LmJpbmQodGhpcy5mb2N1cyx0aGlzKSw1MCkpLHQucmVzdWx0KGksInZhbGlkYXRlT25seUlmRGlydHkiKXx8dGhpcy5hZGRJbmxpbmVWYWxpZGF0aW9uKCksdGhpcy5hZGRNb2RlbExpc3RlbmVycygpLHRoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0taW5wdXQtbmFtZS0iK3RoaXMuZ2V0TmFtZVN0cmluZygpKX0sYWRkSW5saW5lVmFsaWRhdGlvbjpmdW5jdGlvbigpe3QucmVzdWx0KHRoaXMub3B0aW9ucywiaW5saW5lVmFsaWRhdGlvbiIpJiZ0aGlzLiRlbC5vbigiZm9jdXNvdXQiLCI6aW5wdXQiLHQuYmluZCh0aGlzLnZhbGlkYXRlLHRoaXMpKX0sdG9Nb2RlbFZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy52YWwoKTtyZXR1cm4gdC5pc0Z1bmN0aW9uKHRoaXMudG8pJiYoZT10aGlzLnRvLmNhbGwodGhpcyxlKSksdC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy50bykmJihlPXRoaXMub3B0aW9ucy50by5jYWxsKHRoaXMsZSkpLGV9LF9pc0VkaXRlZDohMSx1cGRhdGU6ZnVuY3Rpb24oKXshdGhpcy5faXNFZGl0ZWQmJnQucmVzdWx0KHRoaXMub3B0aW9ucywidmFsaWRhdGVPbmx5SWZEaXJ0eSIpJiYodGhpcy5faXNFZGl0ZWQ9ITAsdGhpcy5hZGRJbmxpbmVWYWxpZGF0aW9uKCkpLHRoaXMubW9kZWwuc2V0KHRoaXMub3B0aW9ucy5uYW1lLHRoaXMudG9Nb2RlbFZhbHVlKCkpfSxpc0VkaXRNb2RlOmZ1bmN0aW9uKCl7dmFyIGU9IXQucmVzdWx0KHRoaXMub3B0aW9ucywicmVhZE9ubHkiKSYmKHQucmVzdWx0KHRoaXMub3B0aW9ucywicmVhZCIpIT09ITB8fHRoaXMubW9kZWwuZ2V0KCJfX2VkaXRfXyIpPT09ITApO3JldHVybiBlfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLnByZVJlbmRlcigpO3ZhciBlPXRoaXMub3B0aW9ucy5wYXJhbXM7cmV0dXJuIHRoaXMub3B0aW9ucy5wYXJhbXM9dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJwYXJhbXMiLHRoaXMpLHRoaXMuaXNFZGl0TW9kZSgpPyh0aGlzLmVkaXRNb2RlKCksdC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJkaXNhYmxlZCIsdGhpcyk/dGhpcy5kaXNhYmxlKCk6dGhpcy5lbmFibGUoKSk6dGhpcy5yZWFkTW9kZSgpLHRoaXMub3B0aW9ucy5wYXJhbXM9ZSx0aGlzLnBvc3RSZW5kZXIoKSx0aGlzfSx2YWxpZGF0ZTpmdW5jdGlvbigpe2lmKCF0aGlzLm1vZGVsLmdldCgiX19wZW5kaW5nX18iKSYmdGhpcy5pc0VkaXRNb2RlKCkmJnQuaXNGdW5jdGlvbih0aGlzLm1vZGVsLnZhbGlkYXRlRmllbGQpKXt2YXIgZT10aGlzLm1vZGVsLnZhbGlkYXRlRmllbGQodGhpcy5vcHRpb25zLm5hbWUpO2UmJnQuZGVsYXkoZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06Y2xlYXItZXJyb3I6Iit0aGlzLm9wdGlvbnMubmFtZSksdGhpcy5tb2RlbC50cmlnZ2VyKCJpbnZhbGlkIix0aGlzLm1vZGVsLGUsITEpfS5iaW5kKHRoaXMpLDEwMCl9fSxhZGRNb2RlbExpc3RlbmVyczpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpmaWVsZC1lcnJvciIsZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLm5hbWU9PT10JiZ0aGlzLl9fbWFya0Vycm9yKCl9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImZvcm06Y2xlYXItZXJyb3JzIGNoYW5nZToiK3RoaXMub3B0aW9ucy5uYW1lLHRoaXMuX19jbGVhckVycm9yKSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImZvcm06Y2xlYXItZXJyb3I6Iit0aGlzLm9wdGlvbnMubmFtZSx0aGlzLl9fY2xlYXJFcnJvcil9LHZhbDpmdW5jdGlvbigpe3Rocm93IG5ldyBFcnJvcigidmFsKCkgaXMgYW4gYWJzdHJhY3QgbWV0aG9kIil9LGZvY3VzOmZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJmb2N1cygpIGlzIGFuIGFic3RyYWN0IG1ldGhvZCIpfSxkZWZhdWx0VmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4iIn0sZWRpdE1vZGU6ZnVuY3Rpb24oKXt2YXIgZT10LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMse3ZhbHVlOnRoaXMuZ2V0TW9kZWxWYWx1ZSgpfSk7cmV0dXJuIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZShlKSksdGhpcy5vcHRpb25zLm11bHRpJiZ0aGlzLiRlbC5yZW1vdmVDbGFzcygibWFyZ2luLXIiKSx0aGlzfSxyZWFkTW9kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRlbC50ZXh0KHRoaXMuZ2V0UmVhZE1vZGVTdHJpbmcoKSksdGhpcy4kZWwucmVtb3ZlQ2xhc3MoImVycm9yLWZpZWxkIiksdGhpcy5vcHRpb25zLm11bHRpJiZ0aGlzLiRlbC5hZGRDbGFzcygibWFyZ2luLXIiKSx0aGlzfSxnZXRSZWFkTW9kZVN0cmluZzpmdW5jdGlvbigpe3ZhciBlPXQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywicmVhZE1vZGVTdHJpbmciLHRoaXMpO3JldHVybiBlP2U6dGhpcy50b1N0cmluZ1ZhbHVlKCl9LGdldE1vZGVsVmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm1vZGVsLmdldCh0aGlzLm9wdGlvbnMubmFtZSk7cmV0dXJuIHQuaXNGdW5jdGlvbih0aGlzLmZyb20pJiYoZT10aGlzLmZyb20uY2FsbCh0aGlzLGUpKSx0LmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLmZyb20pJiYoZT10aGlzLm9wdGlvbnMuZnJvbS5jYWxsKHRoaXMsZSkpLGV9LHRvU3RyaW5nVmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldE1vZGVsVmFsdWUoKTtyZXR1cm4gdGhpcy5vcHRpb25zLm9wdGlvbnMmJih0PXRoaXMub3B0aW9ucy5vcHRpb25zW3RdKSx0fHx0aGlzLmRlZmF1bHRWYWx1ZSgpfSxyZXNpemU6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cmVzaXplIil9LGRpc2FibGU6ZnVuY3Rpb24oKXt0aGlzLiQoIjppbnB1dCIpLnByb3AoImRpc2FibGVkIiwhMCl9LGVuYWJsZTpmdW5jdGlvbigpe3RoaXMuJCgiOmlucHV0IikucHJvcCgiZGlzYWJsZWQiLCExKX0sY2hhbmdlVHlwZTpmdW5jdGlvbih0KXt0aGlzLiQoIjppbnB1dCIpLnByb3AoInR5cGUiLHQpLHRoaXMub3B0aW9ucy50eXBlPXR9LGdldE5hbWVTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdC5pc0FycmF5KHRoaXMub3B0aW9ucy5uYW1lKT90aGlzLm9wdGlvbnMubmFtZS5qb2luKCItIik6dGhpcy5vcHRpb25zLm5hbWV9LGdldFBhcmFtczpmdW5jdGlvbihlKXt2YXIgaT1lfHx0aGlzLm9wdGlvbnN8fHt9O3JldHVybiB0LmNsb25lKHQucmVzdWx0Q3R4KGksInBhcmFtcyIsdGhpcyl8fHt9KX0sZ2V0UGFyYW06ZnVuY3Rpb24oZSxpKXt2YXIgbj10LnJlc3VsdEN0eCh0aGlzLmdldFBhcmFtcygpLGUsdGhpcyk7cmV0dXJuIHQuaXNVbmRlZmluZWQobik/aTpufSxnZXRQYXJhbU9yQXR0cmlidXRlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldFBhcmFtKGUpfHx0LnJlc3VsdCh0aGlzLGUpfSxfX21hcmtFcnJvcjpmdW5jdGlvbigpe3RoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpfSxfX2NsZWFyRXJyb3I6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmVDbGFzcygiby1mb3JtLWhhcy1lcnJvcnMiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7KGZ1bmN0aW9uKCl7dmFyIHQ9aSg2KTshZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7dmFyIGU9e30sbj0vXmpRdWVyeVxkKyQvO3JldHVybiBpLmVhY2godC5hdHRyaWJ1dGVzLGZ1bmN0aW9uKHQsaSl7aS5zcGVjaWZpZWQmJiFuLnRlc3QoaS5uYW1lKSYmKGVbaS5uYW1lXT1pLnZhbHVlKX0pLGV9ZnVuY3Rpb24gcih0LGUpe3ZhciBuPXRoaXMscj1pKG4pO2lmKG4udmFsdWU9PXIuYXR0cigicGxhY2Vob2xkZXIiKSYmci5oYXNDbGFzcygicGxhY2Vob2xkZXIiKSlpZihyLmRhdGEoInBsYWNlaG9sZGVyLXBhc3N3b3JkIikpe2lmKHI9ci5oaWRlKCkubmV4dCgpLnNob3coKS5hdHRyKCJpZCIsci5yZW1vdmVBdHRyKCJpZCIpLmRhdGEoInBsYWNlaG9sZGVyLWlkIikpLHQ9PT0hMClyZXR1cm4gclswXS52YWx1ZT1lO3IuZm9jdXMoKX1lbHNlIG4udmFsdWU9IiIsci5yZW1vdmVDbGFzcygicGxhY2Vob2xkZXIiKSxuPT1vKCkmJm4uc2VsZWN0KCl9ZnVuY3Rpb24gcygpe3ZhciB0LGU9dGhpcyxzPWkoZSksbz10aGlzLmlkO2lmKCIiPT1lLnZhbHVlKXtpZigicGFzc3dvcmQiPT1lLnR5cGUpe2lmKCFzLmRhdGEoInBsYWNlaG9sZGVyLXRleHRpbnB1dCIpKXt0cnl7dD1zLmNsb25lKCkuYXR0cih7dHlwZToidGV4dCJ9KX1jYXRjaChhKXt0PWkoIjxpbnB1dD4iKS5hdHRyKGkuZXh0ZW5kKG4odGhpcykse3R5cGU6InRleHQifSkpfXQucmVtb3ZlQXR0cigibmFtZSIpLmRhdGEoeyJwbGFjZWhvbGRlci1wYXNzd29yZCI6cywicGxhY2Vob2xkZXItaWQiOm99KS5iaW5kKCJmb2N1cy5wbGFjZWhvbGRlciIscikscy5kYXRhKHsicGxhY2Vob2xkZXItdGV4dGlucHV0Ijp0LCJwbGFjZWhvbGRlci1pZCI6b30pLmJlZm9yZSh0KX1zPXMucmVtb3ZlQXR0cigiaWQiKS5oaWRlKCkucHJldigpLmF0dHIoImlkIixvKS5zaG93KCl9cy5hZGRDbGFzcygicGxhY2Vob2xkZXIiKSxzWzBdLnZhbHVlPXMuYXR0cigicGxhY2Vob2xkZXIiKX1lbHNlIHMucmVtb3ZlQ2xhc3MoInBsYWNlaG9sZGVyIil9ZnVuY3Rpb24gbygpe3RyeXtyZXR1cm4gZS5hY3RpdmVFbGVtZW50fWNhdGNoKHQpe319dmFyIGEsbCxjPSJwbGFjZWhvbGRlciJpbiBlLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksdT0icGxhY2Vob2xkZXIiaW4gZS5jcmVhdGVFbGVtZW50KCJ0ZXh0YXJlYSIpLGQ9aS5mbixoPWkudmFsSG9va3MscD1pLnByb3BIb29rcztjJiZ1PyhsPWQucGxhY2Vob2xkZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sbC5pbnB1dD1sLnRleHRhcmVhPSEwKToobD1kLnBsYWNlaG9sZGVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdC5maWx0ZXIoKGM/InRleHRhcmVhIjoiOmlucHV0IikrIltwbGFjZWhvbGRlcl0iKS5ub3QoIi5wbGFjZWhvbGRlciIpLmJpbmQoeyJmb2N1cy5wbGFjZWhvbGRlciI6ciwiYmx1ci5wbGFjZWhvbGRlciI6c30pLmRhdGEoInBsYWNlaG9sZGVyLWVuYWJsZWQiLCEwKS50cmlnZ2VyKCJibHVyLnBsYWNlaG9sZGVyIiksdH0sbC5pbnB1dD1jLGwudGV4dGFyZWE9dSxhPXtnZXQ6ZnVuY3Rpb24odCl7dmFyIGU9aSh0KSxuPWUuZGF0YSgicGxhY2Vob2xkZXItcGFzc3dvcmQiKTtyZXR1cm4gbj9uWzBdLnZhbHVlOmUuZGF0YSgicGxhY2Vob2xkZXItZW5hYmxlZCIpJiZlLmhhc0NsYXNzKCJwbGFjZWhvbGRlciIpPyIiOnQudmFsdWV9LHNldDpmdW5jdGlvbih0LGUpe3ZhciBuPWkodCksYT1uLmRhdGEoInBsYWNlaG9sZGVyLXBhc3N3b3JkIik7cmV0dXJuIGE/YVswXS52YWx1ZT1lOm4uZGF0YSgicGxhY2Vob2xkZXItZW5hYmxlZCIpPygiIj09ZT8odC52YWx1ZT1lLHQhPW8oKSYmcy5jYWxsKHQpKTpuLmhhc0NsYXNzKCJwbGFjZWhvbGRlciIpP3IuY2FsbCh0LCEwLGUpfHwodC52YWx1ZT1lKTp0LnZhbHVlPWUsbik6dC52YWx1ZT1lfX0sY3x8KGguaW5wdXQ9YSxwLnZhbHVlPWEpLHV8fChoLnRleHRhcmVhPWEscC52YWx1ZT1hKSxpKGZ1bmN0aW9uKCl7aShlKS5kZWxlZ2F0ZSgiZm9ybSIsInN1Ym1pdC5wbGFjZWhvbGRlciIsZnVuY3Rpb24oKXt2YXIgdD1pKCIucGxhY2Vob2xkZXIiLHRoaXMpLmVhY2gocik7c2V0VGltZW91dChmdW5jdGlvbigpe3QuZWFjaChzKX0sMTApfSl9KSxpKHQpLmJpbmQoImJlZm9yZXVubG9hZC5wbGFjZWhvbGRlciIsZnVuY3Rpb24oKXtpKCIucGxhY2Vob2xkZXIiKS5lYWNoKGZ1bmN0aW9uKCl7dGhpcy52YWx1ZT0iIn0pfSkpfSh0aGlzLGRvY3VtZW50LHQpfSkuY2FsbCh3aW5kb3cpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTczKSxpKDE0NyksaSgyMDMpLGkoMjA3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe2Z1bmN0aW9uIHModCl7cmV0dXJuIHRoaXMucGFyYW1zLmF1dG9XaWR0aD90LmNhbGwodGhpcyk6ZS5kZWZlcihlLmJpbmQodCx0aGlzKSl9ZnVuY3Rpb24gbyhlKXtlLiRzZWxlY3QuaGlkZSgpO3ZhciBpPXQoZS4kc2VsZWN0WzBdKS5oaWRlKCk7dCgiYm9keSIpLmFwcGVuZChpKTt2YXIgbj1lLnBhcmFtcy53aWR0aD0xLjIqaS53aWR0aCgpKyJweCI7cmV0dXJuIGUuJGVsLmFwcGVuZChpLnNob3coKSksbn1mdW5jdGlvbiBhKGUsaSxuKXt2YXIgcj1uLm9mZnNldCgpO2UuY3NzKHtsZWZ0OnIubGVmdCx0b3A6ci50b3B9KTt2YXIgcz10KHdpbmRvdyksbz1pLm91dGVySGVpZ2h0KCksYT1vK2kub2Zmc2V0KCkudG9wLXMuc2Nyb2xsVG9wKCksbD1zLmhlaWdodCgpLWQsYz1NYXRoLm1pbihvK2wtYSxoKTtpLmNzcygibWF4LWhlaWdodCIsYyl9ZnVuY3Rpb24gbChpKXt2YXIgbj1pLm5leHQoIi5jaHpuLWNvbnRhaW5lciIpLHI9bi5jbG9uZSgpLHM9bi5maW5kKCIuY2h6bi1yZXN1bHRzIik7ci5jc3MoInZpc2liaWxpdHkiLCJoaWRkZW4iKSxyLnJlbW92ZUF0dHIoImlkIiksci5maW5kKCJsaSIpLnJlbW92ZUF0dHIoImlkIik7dmFyIG89e2xlZnQ6bi5jc3MoImxlZnQiKSx0b3A6bi5jc3MoInRvcCIpLHBvc2l0aW9uOm4uY3NzKCJwb3NpdGlvbiIpLCJmbG9hdCI6bi5jc3MoImZsb2F0IiksInotaW5kZXgiOm4uY3NzKCJ6LWluZGV4Iil9O3MuaGlkZSgpO3ZhciBsPWUuZGVib3VuY2UoZnVuY3Rpb24oKXthKG4scyxyKX0sMTApO2kub24oImxpc3p0OnNob3dpbmdfZHJvcGRvd24iLGZ1bmN0aW9uKCl7bi53aWR0aChuLndpZHRoKCkpLGkuYWZ0ZXIociksbi5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsImZsb2F0Ijoibm9uZSIsInotaW5kZXgiOnAsdG9wOi05OTk5OTl9KSx0KCJib2R5IikuYXBwZW5kKG4pLHMuc2hvdygpLGEobixzLHIpLGkucGFyZW50cygpLnNjcm9sbChsKSx0KHdpbmRvdykub24oInJlc2l6ZSBzY3JvbGwiLGwpfSksaS5vbigibGlzenQ6aGlkaW5nX2Ryb3Bkb3duIHJlbW92ZSIsZnVuY3Rpb24oKXtpLnBhcmVudHMoKS5vZmYoInNjcm9sbCIsbCksdCh3aW5kb3cpLm9mZigicmVzaXplIHNjcm9sbCIsbCksbi5jc3Mobykscy5oaWRlKCkscy5jc3MoIm1heC1oZWlnaHQiLGgpLHIucmVtb3ZlKCksaS5hZnRlcihuKX0pfXZhciBjPW4udHBsKCc8c2VsZWN0IGlkPSJ7e2lucHV0SWR9fSIgbmFtZT0ie3tuYW1lfX0iPjwvc2VsZWN0PicpLHU9bi50cGwoJzxvcHRpb24gdmFsdWU9Int7a2V5fX0iPnt7dmFsdWV9fTwvb3B0aW9uPicpLGQ9MjAsaD0yNDAscD01ZTQ7cmV0dXJuIHIuZXh0ZW5kKHtjbGFzc05hbWU6Im8tZm9ybS1zZWxlY3QiLGV2ZW50czp7ImNoYW5nZSBzZWxlY3QiOiJ1cGRhdGUiLCJrZXl1cCAuY2h6bi1zZWFyY2ggPiA6dGV4dCI6ZnVuY3Rpb24odCl7aS5pc0VzYyh0KSYmKHRoaXMuJCgiLmNoem4tc2VhcmNoID4gOnRleHQiKS52YWwoIiIpLHQuc3RvcFByb3BhZ2F0aW9uKCkpfX0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnBhcmFtcz10aGlzLm9wdGlvbnMucGFyYW1zfHx7fX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5odG1sKGModGhpcy5vcHRpb25zKSksdGhpcy4kc2VsZWN0PXRoaXMuJCgic2VsZWN0Iik7dmFyIHQ9dGhpcy5nZXRPcHRpb25zKCk7ZS5lYWNoKHQsZnVuY3Rpb24odCxlKXt0aGlzLiRzZWxlY3QuYXBwZW5kKHUoe2tleTplLHZhbHVlOnR9KSl9LHRoaXMpO3ZhciBpPXRoaXMuZ2V0TW9kZWxWYWx1ZSgpO3JldHVybiBpP3RoaXMuJHNlbGVjdC52YWwoaSk6dGhpcy4kKCJvcHRpb246Zmlyc3QtY2hpbGQiKS5wcm9wKCJzZWxlY3RlZCIsITApLHRoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0tY29udHJvbCIpLHRoaXMucGFyYW1zLmNob3NlbiE9PSExJiZ0aGlzLl9fYXBwbHlDaG9zZW4oKSx0aGlzfSxfX2FwcGx5Q2hvc2VuOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLndpZGU/IjEwMCUiOnRoaXMucGFyYW1zLndpZHRofHwiNjIlIjt0aGlzLnBhcmFtcy5hdXRvV2lkdGgmJih0PW8odGhpcykpLHMuY2FsbCh0aGlzLGZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5nZXRQYXJhbSgic2VhcmNoVGhyZXNob2xkIiwxMCk7ZS5yZXN1bHQodGhpcy5vcHRpb25zLCJhdXRvUmVuZGVyIil8fHRoaXMudXBkYXRlKCksdGhpcy4kc2VsZWN0LmNob3Nlbih7d2lkdGg6dCxkaXNhYmxlX3NlYXJjaF90aHJlc2hvbGQ6aSxwbGFjZWhvbGRlcl90ZXh0OnRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcn0pLGwodGhpcy4kc2VsZWN0KSx0aGlzLnBhcmFtcy5hdXRvV2lkdGgmJnRoaXMuJGVsLndpZHRoKDApLHRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX0pfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kc2VsZWN0JiZ0aGlzLiRzZWxlY3QudmFsKCl9LGZvY3VzOmZ1bmN0aW9uKCl7aWYodGhpcy4kc2VsZWN0KXJldHVybiB0aGlzLiRzZWxlY3QuZm9jdXMoKX0sdG9TdHJpbmdWYWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0TW9kZWxWYWx1ZSgpLGk9dCxuPXRoaXMuZ2V0T3B0aW9ucygpO3JldHVybiBlLmlzRW1wdHkobil8fChpPW5bdF0pLGUuaXNVbmRlZmluZWQoaSkmJihpPXRoaXMuZGVmYXVsdFZhbHVlKCkpLGl8fCIifSxnZXRPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLm9wdGlvbnM7cmV0dXJuIGUuaXNGdW5jdGlvbih0KSYmKHQ9dC5jYWxsKHRoaXMpKSxlLmlzT2JqZWN0KHQpP3Q6e319LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRzZWxlY3QmJnRoaXMuJHNlbGVjdC50cmlnZ2VyKCJyZW1vdmUiKSxyLnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNildLHI9ZnVuY3Rpb24odCl7KGZ1bmN0aW9uKCl7dmFyIHQ7dD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLm9wdGlvbnNfaW5kZXg9MCx0aGlzLnBhcnNlZD1bXX1yZXR1cm4gdC5wcm90b3R5cGUuYWRkX25vZGU9ZnVuY3Rpb24odCl7cmV0dXJuIk9QVEdST1VQIj09PXQubm9kZU5hbWUudG9VcHBlckNhc2UoKT90aGlzLmFkZF9ncm91cCh0KTp0aGlzLmFkZF9vcHRpb24odCl9LHQucHJvdG90eXBlLmFkZF9ncm91cD1mdW5jdGlvbih0KXt2YXIgZSxpLG4scixzLG87Zm9yKGU9dGhpcy5wYXJzZWQubGVuZ3RoLHRoaXMucGFyc2VkLnB1c2goe2FycmF5X2luZGV4OmUsZ3JvdXA6ITAsbGFiZWw6dC5sYWJlbCxjaGlsZHJlbjowLGRpc2FibGVkOnQuZGlzYWJsZWR9KSxzPXQuY2hpbGROb2RlcyxvPVtdLG49MCxyPXMubGVuZ3RoO248cjtuKyspaT1zW25dLG8ucHVzaCh0aGlzLmFkZF9vcHRpb24oaSxlLHQuZGlzYWJsZWQpKTtyZXR1cm4gb30sdC5wcm90b3R5cGUuYWRkX29wdGlvbj1mdW5jdGlvbih0LGUsaSl7aWYoIk9QVElPTiI9PT10Lm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkpcmV0dXJuIiIhPT10LnRleHQ/KG51bGwhPWUmJih0aGlzLnBhcnNlZFtlXS5jaGlsZHJlbis9MSksdGhpcy5wYXJzZWQucHVzaCh7YXJyYXlfaW5kZXg6dGhpcy5wYXJzZWQubGVuZ3RoLG9wdGlvbnNfaW5kZXg6dGhpcy5vcHRpb25zX2luZGV4LHZhbHVlOnQudmFsdWUsdGV4dDp0LnRleHQsaHRtbDp0LmlubmVySFRNTCxzZWxlY3RlZDp0LnNlbGVjdGVkLGRpc2FibGVkOmk9PT0hMD9pOnQuZGlzYWJsZWQsZ3JvdXBfYXJyYXlfaW5kZXg6ZSxjbGFzc2VzOnQuY2xhc3NOYW1lLHN0eWxlOnQuc3R5bGUuY3NzVGV4dH0pKTp0aGlzLnBhcnNlZC5wdXNoKHthcnJheV9pbmRleDp0aGlzLnBhcnNlZC5sZW5ndGgsb3B0aW9uc19pbmRleDp0aGlzLm9wdGlvbnNfaW5kZXgsZW1wdHk6ITB9KSx0aGlzLm9wdGlvbnNfaW5kZXgrPTF9LHR9KCksdC5zZWxlY3RfdG9fYXJyYXk9ZnVuY3Rpb24oZSl7dmFyIGksbixyLHMsbztmb3Iobj1uZXcgdCxvPWUuY2hpbGROb2RlcyxyPTAscz1vLmxlbmd0aDtyPHM7cisrKWk9b1tyXSxuLmFkZF9ub2RlKGkpO3JldHVybiBuLnBhcnNlZH0sdGhpcy5TZWxlY3RQYXJzZXI9dH0pLmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxlO2U9dGhpcyx0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLGkpe3RoaXMuZm9ybV9maWVsZD1lLHRoaXMub3B0aW9ucz1udWxsIT1pP2k6e30sdC5icm93c2VyX2lzX3N1cHBvcnRlZCgpJiYodGhpcy5pc19tdWx0aXBsZT10aGlzLmZvcm1fZmllbGQubXVsdGlwbGUsdGhpcy5zZXRfZGVmYXVsdF90ZXh0KCksdGhpcy5zZXRfZGVmYXVsdF92YWx1ZXMoKSx0aGlzLnNldHVwKCksdGhpcy5zZXRfdXBfaHRtbCgpLHRoaXMucmVnaXN0ZXJfb2JzZXJ2ZXJzKCksdGhpcy5maW5pc2hfc2V0dXAoKSl9cmV0dXJuIHQucHJvdG90eXBlLnNldF9kZWZhdWx0X3ZhbHVlcz1mdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMuY2xpY2tfdGVzdF9hY3Rpb249ZnVuY3Rpb24oZSl7cmV0dXJuIHQudGVzdF9hY3RpdmVfY2xpY2soZSl9LHRoaXMuYWN0aXZhdGVfYWN0aW9uPWZ1bmN0aW9uKGUpe3JldHVybiB0LmFjdGl2YXRlX2ZpZWxkKGUpfSx0aGlzLmFjdGl2ZV9maWVsZD0hMSx0aGlzLm1vdXNlX29uX2NvbnRhaW5lcj0hMSx0aGlzLnJlc3VsdHNfc2hvd2luZz0hMSx0aGlzLnJlc3VsdF9oaWdobGlnaHRlZD1udWxsLHRoaXMucmVzdWx0X3NpbmdsZV9zZWxlY3RlZD1udWxsLHRoaXMuYWxsb3dfc2luZ2xlX2Rlc2VsZWN0PW51bGwhPXRoaXMub3B0aW9ucy5hbGxvd19zaW5nbGVfZGVzZWxlY3QmJm51bGwhPXRoaXMuZm9ybV9maWVsZC5vcHRpb25zWzBdJiYiIj09PXRoaXMuZm9ybV9maWVsZC5vcHRpb25zWzBdLnRleHQmJnRoaXMub3B0aW9ucy5hbGxvd19zaW5nbGVfZGVzZWxlY3QsdGhpcy5kaXNhYmxlX3NlYXJjaF90aHJlc2hvbGQ9dGhpcy5vcHRpb25zLmRpc2FibGVfc2VhcmNoX3RocmVzaG9sZHx8MCx0aGlzLmRpc2FibGVfc2VhcmNoPXRoaXMub3B0aW9ucy5kaXNhYmxlX3NlYXJjaHx8ITEsdGhpcy5lbmFibGVfc3BsaXRfd29yZF9zZWFyY2g9bnVsbD09dGhpcy5vcHRpb25zLmVuYWJsZV9zcGxpdF93b3JkX3NlYXJjaHx8dGhpcy5vcHRpb25zLmVuYWJsZV9zcGxpdF93b3JkX3NlYXJjaCx0aGlzLnNlYXJjaF9jb250YWlucz10aGlzLm9wdGlvbnMuc2VhcmNoX2NvbnRhaW5zfHwhMSx0aGlzLnNpbmdsZV9iYWNrc3Ryb2tlX2RlbGV0ZT10aGlzLm9wdGlvbnMuc2luZ2xlX2JhY2tzdHJva2VfZGVsZXRlfHwhMSx0aGlzLm1heF9zZWxlY3RlZF9vcHRpb25zPXRoaXMub3B0aW9ucy5tYXhfc2VsZWN0ZWRfb3B0aW9uc3x8MS8wLHRoaXMuaW5oZXJpdF9zZWxlY3RfY2xhc3Nlcz10aGlzLm9wdGlvbnMuaW5oZXJpdF9zZWxlY3RfY2xhc3Nlc3x8ITF9LHQucHJvdG90eXBlLnNldF9kZWZhdWx0X3RleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtX2ZpZWxkLmdldEF0dHJpYnV0ZSgiZGF0YS1wbGFjZWhvbGRlciIpP3RoaXMuZGVmYXVsdF90ZXh0PXRoaXMuZm9ybV9maWVsZC5nZXRBdHRyaWJ1dGUoImRhdGEtcGxhY2Vob2xkZXIiKTp0aGlzLmlzX211bHRpcGxlP3RoaXMuZGVmYXVsdF90ZXh0PXRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcl90ZXh0X211bHRpcGxlfHx0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJfdGV4dHx8dC5kZWZhdWx0X211bHRpcGxlX3RleHQ6dGhpcy5kZWZhdWx0X3RleHQ9dGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyX3RleHRfc2luZ2xlfHx0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJfdGV4dHx8dC5kZWZhdWx0X3NpbmdsZV90ZXh0LHRoaXMucmVzdWx0c19ub25lX2ZvdW5kPXRoaXMuZm9ybV9maWVsZC5nZXRBdHRyaWJ1dGUoImRhdGEtbm9fcmVzdWx0c190ZXh0Iil8fHRoaXMub3B0aW9ucy5ub19yZXN1bHRzX3RleHR8fHQuZGVmYXVsdF9ub19yZXN1bHRfdGV4dH0sdC5wcm90b3R5cGUubW91c2VfZW50ZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb3VzZV9vbl9jb250YWluZXI9ITB9LHQucHJvdG90eXBlLm1vdXNlX2xlYXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW91c2Vfb25fY29udGFpbmVyPSExfSx0LnByb3RvdHlwZS5pbnB1dF9mb2N1cz1mdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKHRoaXMuaXNfbXVsdGlwbGUpe2lmKCF0aGlzLmFjdGl2ZV9maWVsZClyZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBlLmNvbnRhaW5lcl9tb3VzZWRvd24oKX0sNTApfWVsc2UgaWYoIXRoaXMuYWN0aXZlX2ZpZWxkKXJldHVybiB0aGlzLmFjdGl2YXRlX2ZpZWxkKCl9LHQucHJvdG90eXBlLmlucHV0X2JsdXI9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztpZighdGhpcy5tb3VzZV9vbl9jb250YWluZXIpcmV0dXJuIHRoaXMuYWN0aXZlX2ZpZWxkPSExLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gZS5ibHVyX3Rlc3QoKX0sMTAwKX0sdC5wcm90b3R5cGUucmVzdWx0X2FkZF9vcHRpb249ZnVuY3Rpb24odCl7dmFyIGUsaTtyZXR1cm4gdC5kb21faWQ9dGhpcy5jb250YWluZXJfaWQrIl9vXyIrdC5hcnJheV9pbmRleCxlPVtdLHQuZGlzYWJsZWR8fHQuc2VsZWN0ZWQmJnRoaXMuaXNfbXVsdGlwbGV8fGUucHVzaCgiYWN0aXZlLXJlc3VsdCIpLCF0LmRpc2FibGVkfHx0LnNlbGVjdGVkJiZ0aGlzLmlzX211bHRpcGxlfHxlLnB1c2goImRpc2FibGVkLXJlc3VsdCIpLHQuc2VsZWN0ZWQmJmUucHVzaCgicmVzdWx0LXNlbGVjdGVkIiksbnVsbCE9dC5ncm91cF9hcnJheV9pbmRleCYmZS5wdXNoKCJncm91cC1vcHRpb24iKSwiIiE9PXQuY2xhc3NlcyYmZS5wdXNoKHQuY2xhc3NlcyksaT0iIiE9PXQuc3R5bGUuY3NzVGV4dD8nIHN0eWxlPSInK3Quc3R5bGUrJyInOiIiLCc8bGkgaWQ9IicrdC5kb21faWQrJyIgY2xhc3M9IicrZS5qb2luKCIgIikrJyInK2krIj4iK3QuaHRtbCsiPC9saT4ifSx0LnByb3RvdHlwZS5yZXN1bHRzX3VwZGF0ZV9maWVsZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNldF9kZWZhdWx0X3RleHQoKSx0aGlzLmlzX211bHRpcGxlfHx0aGlzLnJlc3VsdHNfcmVzZXRfY2xlYW51cCgpLHRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpLHRoaXMucmVzdWx0X3NpbmdsZV9zZWxlY3RlZD1udWxsLHRoaXMucmVzdWx0c19idWlsZCgpfSx0LnByb3RvdHlwZS5yZXN1bHRzX3RvZ2dsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlc3VsdHNfc2hvd2luZz90aGlzLnJlc3VsdHNfaGlkZSgpOnRoaXMucmVzdWx0c19zaG93KCl9LHQucHJvdG90eXBlLnJlc3VsdHNfc2VhcmNoPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnJlc3VsdHNfc2hvd2luZz90aGlzLndpbm5vd19yZXN1bHRzKCk6dGhpcy5yZXN1bHRzX3Nob3coKX0sdC5wcm90b3R5cGUuY2hvaWNlc19jb3VudD1mdW5jdGlvbigpe3ZhciB0LGUsaSxuO2lmKG51bGwhPXRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50KXJldHVybiB0aGlzLnNlbGVjdGVkX29wdGlvbl9jb3VudDtmb3IodGhpcy5zZWxlY3RlZF9vcHRpb25fY291bnQ9MCxuPXRoaXMuZm9ybV9maWVsZC5vcHRpb25zLGU9MCxpPW4ubGVuZ3RoO2U8aTtlKyspdD1uW2VdLHQuc2VsZWN0ZWQmJih0aGlzLnNlbGVjdGVkX29wdGlvbl9jb3VudCs9MSk7cmV0dXJuIHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50fSx0LnByb3RvdHlwZS5jaG9pY2VzX2NsaWNrPWZ1bmN0aW9uKHQpe2lmKHQucHJldmVudERlZmF1bHQoKSwhdGhpcy5yZXN1bHRzX3Nob3dpbmcmJiF0aGlzLmlzX2Rpc2FibGVkKXJldHVybiB0aGlzLnJlc3VsdHNfc2hvdygpfSx0LnByb3RvdHlwZS5rZXl1cF9jaGVja2VyPWZ1bmN0aW9uKHQpe3ZhciBlLGk7c3dpdGNoKGU9bnVsbCE9KGk9dC53aGljaCk/aTp0LmtleUNvZGUsdGhpcy5zZWFyY2hfZmllbGRfc2NhbGUoKSxlKXtjYXNlIDg6aWYodGhpcy5pc19tdWx0aXBsZSYmdGhpcy5iYWNrc3Ryb2tlX2xlbmd0aDwxJiZ0aGlzLmNob2ljZXNfY291bnQoKT4wKXJldHVybiB0aGlzLmtleWRvd25fYmFja3N0cm9rZSgpO2lmKCF0aGlzLnBlbmRpbmdfYmFja3N0cm9rZSlyZXR1cm4gdGhpcy5yZXN1bHRfY2xlYXJfaGlnaGxpZ2h0KCksdGhpcy5yZXN1bHRzX3NlYXJjaCgpO2JyZWFrO2Nhc2UgMTM6aWYodC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMucmVzdWx0c19zaG93aW5nKXJldHVybiB0aGlzLnJlc3VsdF9zZWxlY3QodCk7YnJlYWs7Y2FzZSAyNzpyZXR1cm4gdGhpcy5yZXN1bHRzX3Nob3dpbmcmJnRoaXMucmVzdWx0c19oaWRlKCksITA7Y2FzZSA5OmNhc2UgMzg6Y2FzZSA0MDpjYXNlIDE2OmNhc2UgOTE6Y2FzZSAxNzpicmVhaztkZWZhdWx0OnJldHVybiB0aGlzLnJlc3VsdHNfc2VhcmNoKCl9fSx0LnByb3RvdHlwZS5nZW5lcmF0ZV9maWVsZF9pZD1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0PXRoaXMuZ2VuZXJhdGVfcmFuZG9tX2lkKCksdGhpcy5mb3JtX2ZpZWxkLmlkPXQsdH0sdC5wcm90b3R5cGUuZ2VuZXJhdGVfcmFuZG9tX2NoYXI9ZnVuY3Rpb24oKXt2YXIgdCxlLGk7cmV0dXJuIHQ9IjAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiIsaT1NYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqdC5sZW5ndGgpLGU9dC5zdWJzdHJpbmcoaSxpKzEpfSx0LnByb3RvdHlwZS5jb250YWluZXJfd2lkdGg9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9dGhpcy5vcHRpb25zLndpZHRoP3RoaXMub3B0aW9ucy53aWR0aDoiIit0aGlzLmZvcm1fZmllbGQub2Zmc2V0V2lkdGgrInB4In0sdC5icm93c2VyX2lzX3N1cHBvcnRlZD1mdW5jdGlvbigpe3ZhciB0O3JldHVybiJNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXIiIT09d2luZG93Lm5hdmlnYXRvci5hcHBOYW1lfHxudWxsIT09KHQ9ZG9jdW1lbnQuZG9jdW1lbnRNb2RlKSYmdD49OH0sdC5kZWZhdWx0X211bHRpcGxlX3RleHQ9IlNlbGVjdCBTb21lIE9wdGlvbnMiLHQuZGVmYXVsdF9zaW5nbGVfdGV4dD0iU2VsZWN0IGFuIE9wdGlvbiIsdC5kZWZhdWx0X25vX3Jlc3VsdF90ZXh0PSJObyByZXN1bHRzIG1hdGNoIix0fSgpLGUuQWJzdHJhY3RDaG9zZW49dH0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciBlLGksbixyLHM9e30uaGFzT3duUHJvcGVydHksbz1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkoKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBuIGluIGUpcy5jYWxsKGUsbikmJih0W25dPWVbbl0pO3JldHVybiBpLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgaSx0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fTtuPXRoaXM7dmFyIGE9bi5BYnN0cmFjdENob3NlbjtlPXQsZS5mbi5leHRlbmQoe2Nob3NlbjpmdW5jdGlvbih0KXtyZXR1cm4gYS5icm93c2VyX2lzX3N1cHBvcnRlZCgpP3RoaXMuZWFjaChmdW5jdGlvbihuKXt2YXIgcjtpZihyPWUodGhpcyksIXIuaGFzQ2xhc3MoImNoem4tZG9uZSIpKXJldHVybiByLmRhdGEoImNob3NlbiIsbmV3IGkodGhpcyx0KSl9KTp0aGlzfX0pLGk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaSgpe3JldHVybiByPWkuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbyhpLHQpLGkucHJvdG90eXBlLnNldHVwPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9ybV9maWVsZF9qcT1lKHRoaXMuZm9ybV9maWVsZCksdGhpcy5jdXJyZW50X3NlbGVjdGVkSW5kZXg9dGhpcy5mb3JtX2ZpZWxkLnNlbGVjdGVkSW5kZXgsdGhpcy5pc19ydGw9dGhpcy5mb3JtX2ZpZWxkX2pxLmhhc0NsYXNzKCJjaHpuLXJ0bCIpfSxpLnByb3RvdHlwZS5maW5pc2hfc2V0dXA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtX2ZpZWxkX2pxLmFkZENsYXNzKCJjaHpuLWRvbmUiKX0saS5wcm90b3R5cGUuc2V0X3VwX2h0bWw9ZnVuY3Rpb24oKXt2YXIgdCxpO3JldHVybiB0aGlzLmNvbnRhaW5lcl9pZD10aGlzLmZvcm1fZmllbGQuaWQubGVuZ3RoP3RoaXMuZm9ybV9maWVsZC5pZC5yZXBsYWNlKC9bXlx3XS9nLCJfIik6dGhpcy5nZW5lcmF0ZV9maWVsZF9pZCgpLHRoaXMuY29udGFpbmVyX2lkKz0iX2Noem4iLHQ9WyJjaHpuLWNvbnRhaW5lciJdLHQucHVzaCgiY2h6bi1jb250YWluZXItIisodGhpcy5pc19tdWx0aXBsZT8ibXVsdGkiOiJzaW5nbGUiKSksdGhpcy5pbmhlcml0X3NlbGVjdF9jbGFzc2VzJiZ0aGlzLmZvcm1fZmllbGQuY2xhc3NOYW1lJiZ0LnB1c2godGhpcy5mb3JtX2ZpZWxkLmNsYXNzTmFtZSksdGhpcy5pc19ydGwmJnQucHVzaCgiY2h6bi1ydGwiKSxpPXtpZDp0aGlzLmNvbnRhaW5lcl9pZCwiY2xhc3MiOnQuam9pbigiICIpLHN0eWxlOiJ3aWR0aDogIit0aGlzLmNvbnRhaW5lcl93aWR0aCgpKyI7Iix0aXRsZTp0aGlzLmZvcm1fZmllbGQudGl0bGV9LHRoaXMuY29udGFpbmVyPWUoIjxkaXYgLz4iLGkpLHRoaXMuaXNfbXVsdGlwbGU/dGhpcy5jb250YWluZXIuaHRtbCgnPHVsIGNsYXNzPSJjaHpuLWNob2ljZXMiPjxsaSBjbGFzcz0ic2VhcmNoLWZpZWxkIj48aW5wdXQgdHlwZT0idGV4dCIgdmFsdWU9IicrdGhpcy5kZWZhdWx0X3RleHQrJyIgY2xhc3M9ImRlZmF1bHQiIGF1dG9jb21wbGV0ZT0ib2ZmIiBzdHlsZT0id2lkdGg6MjVweDsiIC8+PC9saT48L3VsPjxkaXYgY2xhc3M9ImNoem4tZHJvcCI+PHVsIGNsYXNzPSJjaHpuLXJlc3VsdHMiPjwvdWw+PC9kaXY+Jyk6dGhpcy5jb250YWluZXIuaHRtbCgnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBjbGFzcz0iY2h6bi1zaW5nbGUgY2h6bi1kZWZhdWx0IiB0YWJpbmRleD0iLTEiPjxzcGFuPicrdGhpcy5kZWZhdWx0X3RleHQrJzwvc3Bhbj48ZGl2PjxiPjwvYj48L2Rpdj48L2E+PGRpdiBjbGFzcz0iY2h6bi1kcm9wIj48ZGl2IGNsYXNzPSJjaHpuLXNlYXJjaCI+PGlucHV0IHR5cGU9InRleHQiIGF1dG9jb21wbGV0ZT0ib2ZmIiAvPjwvZGl2Pjx1bCBjbGFzcz0iY2h6bi1yZXN1bHRzIj48L3VsPjwvZGl2PicpLHRoaXMuZm9ybV9maWVsZF9qcS5oaWRlKCkuYWZ0ZXIodGhpcy5jb250YWluZXIpLHRoaXMuZHJvcGRvd249dGhpcy5jb250YWluZXIuZmluZCgiZGl2LmNoem4tZHJvcCIpLmZpcnN0KCksdGhpcy5zZWFyY2hfZmllbGQ9dGhpcy5jb250YWluZXIuZmluZCgiaW5wdXQiKS5maXJzdCgpLHRoaXMuc2VhcmNoX3Jlc3VsdHM9dGhpcy5jb250YWluZXIuZmluZCgidWwuY2h6bi1yZXN1bHRzIikuZmlyc3QoKSx0aGlzLnNlYXJjaF9maWVsZF9zY2FsZSgpLHRoaXMuc2VhcmNoX25vX3Jlc3VsdHM9dGhpcy5jb250YWluZXIuZmluZCgibGkubm8tcmVzdWx0cyIpLmZpcnN0KCksdGhpcy5pc19tdWx0aXBsZT8odGhpcy5zZWFyY2hfY2hvaWNlcz10aGlzLmNvbnRhaW5lci5maW5kKCJ1bC5jaHpuLWNob2ljZXMiKS5maXJzdCgpLHRoaXMuc2VhcmNoX2NvbnRhaW5lcj10aGlzLmNvbnRhaW5lci5maW5kKCJsaS5zZWFyY2gtZmllbGQiKS5maXJzdCgpKToodGhpcy5zZWFyY2hfY29udGFpbmVyPXRoaXMuY29udGFpbmVyLmZpbmQoImRpdi5jaHpuLXNlYXJjaCIpLmZpcnN0KCksdGhpcy5zZWxlY3RlZF9pdGVtPXRoaXMuY29udGFpbmVyLmZpbmQoIi5jaHpuLXNpbmdsZSIpLmZpcnN0KCkpLHRoaXMucmVzdWx0c19idWlsZCgpLHRoaXMuc2V0X3RhYl9pbmRleCgpLHRoaXMuc2V0X2xhYmVsX2JlaGF2aW9yKCksdGhpcy5mb3JtX2ZpZWxkX2pxLnRyaWdnZXIoImxpc3p0OnJlYWR5Iix7Y2hvc2VuOnRoaXN9KX0saS5wcm90b3R5cGUucmVnaXN0ZXJfb2JzZXJ2ZXJzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5jb250YWluZXIubW91c2Vkb3duKGZ1bmN0aW9uKGUpe3QuY29udGFpbmVyX21vdXNlZG93bihlKX0pLHRoaXMuY29udGFpbmVyLm1vdXNldXAoZnVuY3Rpb24oZSl7dC5jb250YWluZXJfbW91c2V1cChlKX0pLHRoaXMuY29udGFpbmVyLm1vdXNlZW50ZXIoZnVuY3Rpb24oZSl7dC5tb3VzZV9lbnRlcihlKX0pLHRoaXMuY29udGFpbmVyLm1vdXNlbGVhdmUoZnVuY3Rpb24oZSl7dC5tb3VzZV9sZWF2ZShlKX0pLHRoaXMuc2VhcmNoX3Jlc3VsdHMubW91c2V1cChmdW5jdGlvbihlKXt0LnNlYXJjaF9yZXN1bHRzX21vdXNldXAoZSl9KSx0aGlzLnNlYXJjaF9yZXN1bHRzLm1vdXNlb3ZlcihmdW5jdGlvbihlKXt0LnNlYXJjaF9yZXN1bHRzX21vdXNlb3ZlcihlKX0pLHRoaXMuc2VhcmNoX3Jlc3VsdHMubW91c2VvdXQoZnVuY3Rpb24oZSl7dC5zZWFyY2hfcmVzdWx0c19tb3VzZW91dChlKX0pLHRoaXMuc2VhcmNoX3Jlc3VsdHMuYmluZCgibW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbCIsZnVuY3Rpb24oZSl7dC5zZWFyY2hfcmVzdWx0c19tb3VzZXdoZWVsKGUpfSksdGhpcy5mb3JtX2ZpZWxkX2pxLmJpbmQoImxpc3p0OnVwZGF0ZWQiLGZ1bmN0aW9uKGUpe3QucmVzdWx0c191cGRhdGVfZmllbGQoZSl9KSx0aGlzLmZvcm1fZmllbGRfanEuYmluZCgibGlzenQ6YWN0aXZhdGUiLGZ1bmN0aW9uKGUpe3QuYWN0aXZhdGVfZmllbGQoZSl9KSx0aGlzLmZvcm1fZmllbGRfanEuYmluZCgibGlzenQ6b3BlbiIsZnVuY3Rpb24oZSl7dC5jb250YWluZXJfbW91c2Vkb3duKGUpfSksdGhpcy5zZWFyY2hfZmllbGQuYmx1cihmdW5jdGlvbihlKXt0LmlucHV0X2JsdXIoZSl9KSx0aGlzLnNlYXJjaF9maWVsZC5rZXl1cChmdW5jdGlvbihlKXt0LmtleXVwX2NoZWNrZXIoZSl9KSx0aGlzLnNlYXJjaF9maWVsZC5rZXlkb3duKGZ1bmN0aW9uKGUpe3Qua2V5ZG93bl9jaGVja2VyKGUpfSksdGhpcy5zZWFyY2hfZmllbGQuZm9jdXMoZnVuY3Rpb24oZSl7dC5pbnB1dF9mb2N1cyhlKX0pLHRoaXMuaXNfbXVsdGlwbGU/dGhpcy5zZWFyY2hfY2hvaWNlcy5jbGljayhmdW5jdGlvbihlKXt0LmNob2ljZXNfY2xpY2soZSl9KTp0aGlzLmNvbnRhaW5lci5jbGljayhmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCl9KX0saS5wcm90b3R5cGUuc2VhcmNoX2ZpZWxkX2Rpc2FibGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNfZGlzYWJsZWQ9dGhpcy5mb3JtX2ZpZWxkX2pxWzBdLmRpc2FibGVkLHRoaXMuaXNfZGlzYWJsZWQ/KHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJjaHpuLWRpc2FibGVkIiksdGhpcy5zZWFyY2hfZmllbGRbMF0uZGlzYWJsZWQ9ITAsdGhpcy5pc19tdWx0aXBsZXx8dGhpcy5zZWxlY3RlZF9pdGVtLnVuYmluZCgiZm9jdXMiLHRoaXMuYWN0aXZhdGVfYWN0aW9uKSx0aGlzLmNsb3NlX2ZpZWxkKCkpOih0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygiY2h6bi1kaXNhYmxlZCIpLHRoaXMuc2VhcmNoX2ZpZWxkWzBdLmRpc2FibGVkPSExLHRoaXMuaXNfbXVsdGlwbGU/dm9pZCAwOnRoaXMuc2VsZWN0ZWRfaXRlbS5iaW5kKCJmb2N1cyIsdGhpcy5hY3RpdmF0ZV9hY3Rpb24pKX0saS5wcm90b3R5cGUuY29udGFpbmVyX21vdXNlZG93bj1mdW5jdGlvbih0KXtpZighdGhpcy5pc19kaXNhYmxlZCYmKHQmJiJtb3VzZWRvd24iPT09dC50eXBlJiYhdGhpcy5yZXN1bHRzX3Nob3dpbmcmJnQucHJldmVudERlZmF1bHQoKSxudWxsPT10fHwhZSh0LnRhcmdldCkuaGFzQ2xhc3MoInNlYXJjaC1jaG9pY2UtY2xvc2UiKSkpcmV0dXJuIHRoaXMuYWN0aXZlX2ZpZWxkP3RoaXMuaXNfbXVsdGlwbGV8fCF0fHxlKHQudGFyZ2V0KVswXSE9PXRoaXMuc2VsZWN0ZWRfaXRlbVswXSYmIWUodC50YXJnZXQpLnBhcmVudHMoImEuY2h6bi1zaW5nbGUiKS5sZW5ndGh8fCh0LnByZXZlbnREZWZhdWx0KCksdGhpcy5yZXN1bHRzX3RvZ2dsZSgpKToodGhpcy5pc19tdWx0aXBsZSYmdGhpcy5zZWFyY2hfZmllbGQudmFsKCIiKSxlKGRvY3VtZW50KS5jbGljayh0aGlzLmNsaWNrX3Rlc3RfYWN0aW9uKSx0aGlzLnJlc3VsdHNfc2hvdygpKSx0aGlzLmFjdGl2YXRlX2ZpZWxkKCl9LGkucHJvdG90eXBlLmNvbnRhaW5lcl9tb3VzZXVwPWZ1bmN0aW9uKHQpe2lmKCJBQkJSIj09PXQudGFyZ2V0Lm5vZGVOYW1lJiYhdGhpcy5pc19kaXNhYmxlZClyZXR1cm4gdGhpcy5yZXN1bHRzX3Jlc2V0KHQpfSxpLnByb3RvdHlwZS5zZWFyY2hfcmVzdWx0c19tb3VzZXdoZWVsPWZ1bmN0aW9uKHQpe3ZhciBlLGksbjtpZihlPS0obnVsbCE9KGk9dC5vcmlnaW5hbEV2ZW50KT9pLndoZWVsRGVsdGE6dm9pZCAwKXx8KG51bGwhPShuPXQub3JpZ2luaWFsRXZlbnQpP24uZGV0YWlsOnZvaWQgMCksbnVsbCE9ZSlyZXR1cm4gdC5wcmV2ZW50RGVmYXVsdCgpLCJET01Nb3VzZVNjcm9sbCI9PT10LnR5cGUmJihlPTQwKmUpLHRoaXMuc2VhcmNoX3Jlc3VsdHMuc2Nyb2xsVG9wKGUrdGhpcy5zZWFyY2hfcmVzdWx0cy5zY3JvbGxUb3AoKSl9LGkucHJvdG90eXBlLmJsdXJfdGVzdD1mdW5jdGlvbih0KXtpZighdGhpcy5hY3RpdmVfZmllbGQmJnRoaXMuY29udGFpbmVyLmhhc0NsYXNzKCJjaHpuLWNvbnRhaW5lci1hY3RpdmUiKSlyZXR1cm4gdGhpcy5jbG9zZV9maWVsZCgpfSxpLnByb3RvdHlwZS5jbG9zZV9maWVsZD1mdW5jdGlvbigpe3JldHVybiBlKGRvY3VtZW50KS51bmJpbmQoImNsaWNrIix0aGlzLmNsaWNrX3Rlc3RfYWN0aW9uKSx0aGlzLmFjdGl2ZV9maWVsZD0hMSx0aGlzLnJlc3VsdHNfaGlkZSgpLHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJjaHpuLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLmNsZWFyX2JhY2tzdHJva2UoKSx0aGlzLnNob3dfc2VhcmNoX2ZpZWxkX2RlZmF1bHQoKSx0aGlzLnNlYXJjaF9maWVsZF9zY2FsZSgpfSxpLnByb3RvdHlwZS5hY3RpdmF0ZV9maWVsZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5lci5hZGRDbGFzcygiY2h6bi1jb250YWluZXItYWN0aXZlIiksdGhpcy5hY3RpdmVfZmllbGQ9ITAsdGhpcy5zZWFyY2hfZmllbGQudmFsKHRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgpKSx0aGlzLnNlYXJjaF9maWVsZC5mb2N1cygpfSxpLnByb3RvdHlwZS50ZXN0X2FjdGl2ZV9jbGljaz1mdW5jdGlvbih0KXsKCXJldHVybiBlKHQudGFyZ2V0KS5wYXJlbnRzKCIjIit0aGlzLmNvbnRhaW5lcl9pZCkubGVuZ3RoP3RoaXMuYWN0aXZlX2ZpZWxkPSEwOnRoaXMuY2xvc2VfZmllbGQoKX0saS5wcm90b3R5cGUucmVzdWx0c19idWlsZD1mdW5jdGlvbigpe3ZhciB0LGUsaSxyLHM7Zm9yKHRoaXMucGFyc2luZz0hMCx0aGlzLnNlbGVjdGVkX29wdGlvbl9jb3VudD1udWxsLHRoaXMucmVzdWx0c19kYXRhPW4uU2VsZWN0UGFyc2VyLnNlbGVjdF90b19hcnJheSh0aGlzLmZvcm1fZmllbGQpLHRoaXMuaXNfbXVsdGlwbGU/dGhpcy5zZWFyY2hfY2hvaWNlcy5maW5kKCJsaS5zZWFyY2gtY2hvaWNlIikucmVtb3ZlKCk6dGhpcy5pc19tdWx0aXBsZXx8KHRoaXMuc2VsZWN0ZWRfaXRlbS5hZGRDbGFzcygiY2h6bi1kZWZhdWx0IikuZmluZCgic3BhbiIpLnRleHQodGhpcy5kZWZhdWx0X3RleHQpLHRoaXMuZGlzYWJsZV9zZWFyY2h8fHRoaXMuZm9ybV9maWVsZC5vcHRpb25zLmxlbmd0aDw9dGhpcy5kaXNhYmxlX3NlYXJjaF90aHJlc2hvbGQ/KHRoaXMuc2VhcmNoX2ZpZWxkWzBdLnJlYWRPbmx5PSEwLHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJjaHpuLWNvbnRhaW5lci1zaW5nbGUtbm9zZWFyY2giKSk6KHRoaXMuc2VhcmNoX2ZpZWxkWzBdLnJlYWRPbmx5PSExLHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJjaHpuLWNvbnRhaW5lci1zaW5nbGUtbm9zZWFyY2giKSkpLHQ9IiIscz10aGlzLnJlc3VsdHNfZGF0YSxpPTAscj1zLmxlbmd0aDtpPHI7aSsrKWU9c1tpXSxlLmdyb3VwP3QrPXRoaXMucmVzdWx0X2FkZF9ncm91cChlKTplLmVtcHR5fHwodCs9dGhpcy5yZXN1bHRfYWRkX29wdGlvbihlKSxlLnNlbGVjdGVkJiZ0aGlzLmlzX211bHRpcGxlP3RoaXMuY2hvaWNlX2J1aWxkKGUpOmUuc2VsZWN0ZWQmJiF0aGlzLmlzX211bHRpcGxlJiYodGhpcy5zZWxlY3RlZF9pdGVtLnJlbW92ZUNsYXNzKCJjaHpuLWRlZmF1bHQiKS5maW5kKCJzcGFuIikudGV4dChlLnRleHQpLHRoaXMuYWxsb3dfc2luZ2xlX2Rlc2VsZWN0JiZ0aGlzLnNpbmdsZV9kZXNlbGVjdF9jb250cm9sX2J1aWxkKCkpKTtyZXR1cm4gdGhpcy5zZWFyY2hfZmllbGRfZGlzYWJsZWQoKSx0aGlzLnNob3dfc2VhcmNoX2ZpZWxkX2RlZmF1bHQoKSx0aGlzLnNlYXJjaF9maWVsZF9zY2FsZSgpLHRoaXMuc2VhcmNoX3Jlc3VsdHMuaHRtbCh0KSx0aGlzLnBhcnNpbmc9ITF9LGkucHJvdG90eXBlLnJlc3VsdF9hZGRfZ3JvdXA9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZG9tX2lkPXRoaXMuY29udGFpbmVyX2lkKyJfZ18iK3QuYXJyYXlfaW5kZXgsJzxsaSBpZD0iJyt0LmRvbV9pZCsnIiBjbGFzcz0iZ3JvdXAtcmVzdWx0Ij4nK2UoIjxkaXYgLz4iKS50ZXh0KHQubGFiZWwpLmh0bWwoKSsiPC9saT4ifSxpLnByb3RvdHlwZS5yZXN1bHRfZG9faGlnaGxpZ2h0PWZ1bmN0aW9uKHQpe3ZhciBlLGksbixyLHM7aWYodC5sZW5ndGgpe2lmKHRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpLHRoaXMucmVzdWx0X2hpZ2hsaWdodD10LHRoaXMucmVzdWx0X2hpZ2hsaWdodC5hZGRDbGFzcygiaGlnaGxpZ2h0ZWQiKSxuPXBhcnNlSW50KHRoaXMuc2VhcmNoX3Jlc3VsdHMuY3NzKCJtYXhIZWlnaHQiKSwxMCkscz10aGlzLnNlYXJjaF9yZXN1bHRzLnNjcm9sbFRvcCgpLHI9bitzLGk9dGhpcy5yZXN1bHRfaGlnaGxpZ2h0LnBvc2l0aW9uKCkudG9wK3RoaXMuc2VhcmNoX3Jlc3VsdHMuc2Nyb2xsVG9wKCksZT1pK3RoaXMucmVzdWx0X2hpZ2hsaWdodC5vdXRlckhlaWdodCgpLGU+PXIpcmV0dXJuIHRoaXMuc2VhcmNoX3Jlc3VsdHMuc2Nyb2xsVG9wKGUtbj4wP2UtbjowKTtpZihpPHMpcmV0dXJuIHRoaXMuc2VhcmNoX3Jlc3VsdHMuc2Nyb2xsVG9wKGkpfX0saS5wcm90b3R5cGUucmVzdWx0X2NsZWFyX2hpZ2hsaWdodD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlc3VsdF9oaWdobGlnaHQmJnRoaXMucmVzdWx0X2hpZ2hsaWdodC5yZW1vdmVDbGFzcygiaGlnaGxpZ2h0ZWQiKSx0aGlzLnJlc3VsdF9oaWdobGlnaHQ9bnVsbH0saS5wcm90b3R5cGUucmVzdWx0c19zaG93PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNfbXVsdGlwbGUmJnRoaXMubWF4X3NlbGVjdGVkX29wdGlvbnM8PXRoaXMuY2hvaWNlc19jb3VudCgpPyh0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigibGlzenQ6bWF4c2VsZWN0ZWQiLHtjaG9zZW46dGhpc30pLCExKToodGhpcy5jb250YWluZXIuYWRkQ2xhc3MoImNoem4td2l0aC1kcm9wIiksdGhpcy5mb3JtX2ZpZWxkX2pxLnRyaWdnZXIoImxpc3p0OnNob3dpbmdfZHJvcGRvd24iLHtjaG9zZW46dGhpc30pLHRoaXMucmVzdWx0c19zaG93aW5nPSEwLHRoaXMuc2VhcmNoX2ZpZWxkLmZvY3VzKCksdGhpcy5zZWFyY2hfZmllbGQudmFsKHRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgpKSx0aGlzLndpbm5vd19yZXN1bHRzKCkpfSxpLnByb3RvdHlwZS5yZXN1bHRzX2hpZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHRzX3Nob3dpbmcmJih0aGlzLnJlc3VsdF9jbGVhcl9oaWdobGlnaHQoKSx0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygiY2h6bi13aXRoLWRyb3AiKSx0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigibGlzenQ6aGlkaW5nX2Ryb3Bkb3duIix7Y2hvc2VuOnRoaXN9KSksdGhpcy5yZXN1bHRzX3Nob3dpbmc9ITF9LGkucHJvdG90eXBlLnNldF90YWJfaW5kZXg9ZnVuY3Rpb24odCl7dmFyIGU7aWYodGhpcy5mb3JtX2ZpZWxkX2pxLmF0dHIoInRhYmluZGV4IikpcmV0dXJuIGU9dGhpcy5mb3JtX2ZpZWxkX2pxLmF0dHIoInRhYmluZGV4IiksdGhpcy5mb3JtX2ZpZWxkX2pxLmF0dHIoInRhYmluZGV4IiwtMSksdGhpcy5zZWFyY2hfZmllbGQuYXR0cigidGFiaW5kZXgiLGUpfSxpLnByb3RvdHlwZS5zZXRfbGFiZWxfYmVoYXZpb3I9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO2lmKHRoaXMuZm9ybV9maWVsZF9sYWJlbD10aGlzLmZvcm1fZmllbGRfanEucGFyZW50cygibGFiZWwiKSwhdGhpcy5mb3JtX2ZpZWxkX2xhYmVsLmxlbmd0aCYmdGhpcy5mb3JtX2ZpZWxkLmlkLmxlbmd0aCYmKHRoaXMuZm9ybV9maWVsZF9sYWJlbD1lKCJsYWJlbFtmb3I9JyIrdGhpcy5mb3JtX2ZpZWxkLmlkKyInXSIpKSx0aGlzLmZvcm1fZmllbGRfbGFiZWwubGVuZ3RoPjApcmV0dXJuIHRoaXMuZm9ybV9maWVsZF9sYWJlbC5jbGljayhmdW5jdGlvbihlKXtyZXR1cm4gdC5pc19tdWx0aXBsZT90LmNvbnRhaW5lcl9tb3VzZWRvd24oZSk6dC5hY3RpdmF0ZV9maWVsZCgpfSl9LGkucHJvdG90eXBlLnNob3dfc2VhcmNoX2ZpZWxkX2RlZmF1bHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc19tdWx0aXBsZSYmdGhpcy5jaG9pY2VzX2NvdW50KCk8MSYmIXRoaXMuYWN0aXZlX2ZpZWxkPyh0aGlzLnNlYXJjaF9maWVsZC52YWwodGhpcy5kZWZhdWx0X3RleHQpLHRoaXMuc2VhcmNoX2ZpZWxkLmFkZENsYXNzKCJkZWZhdWx0IikpOih0aGlzLnNlYXJjaF9maWVsZC52YWwoIiIpLHRoaXMuc2VhcmNoX2ZpZWxkLnJlbW92ZUNsYXNzKCJkZWZhdWx0IikpfSxpLnByb3RvdHlwZS5zZWFyY2hfcmVzdWx0c19tb3VzZXVwPWZ1bmN0aW9uKHQpe3ZhciBpO2lmKGk9ZSh0LnRhcmdldCkuaGFzQ2xhc3MoImFjdGl2ZS1yZXN1bHQiKT9lKHQudGFyZ2V0KTplKHQudGFyZ2V0KS5wYXJlbnRzKCIuYWN0aXZlLXJlc3VsdCIpLmZpcnN0KCksaS5sZW5ndGgpcmV0dXJuIHRoaXMucmVzdWx0X2hpZ2hsaWdodD1pLHRoaXMucmVzdWx0X3NlbGVjdCh0KSx0aGlzLnNlYXJjaF9maWVsZC5mb2N1cygpfSxpLnByb3RvdHlwZS5zZWFyY2hfcmVzdWx0c19tb3VzZW92ZXI9ZnVuY3Rpb24odCl7dmFyIGk7aWYoaT1lKHQudGFyZ2V0KS5oYXNDbGFzcygiYWN0aXZlLXJlc3VsdCIpP2UodC50YXJnZXQpOmUodC50YXJnZXQpLnBhcmVudHMoIi5hY3RpdmUtcmVzdWx0IikuZmlyc3QoKSlyZXR1cm4gdGhpcy5yZXN1bHRfZG9faGlnaGxpZ2h0KGkpfSxpLnByb3RvdHlwZS5zZWFyY2hfcmVzdWx0c19tb3VzZW91dD1mdW5jdGlvbih0KXtpZihlKHQudGFyZ2V0KS5oYXNDbGFzcygiYWN0aXZlLXJlc3VsdCIpKXJldHVybiB0aGlzLnJlc3VsdF9jbGVhcl9oaWdobGlnaHQoKX0saS5wcm90b3R5cGUuY2hvaWNlX2J1aWxkPWZ1bmN0aW9uKHQpe3ZhciBpLG4scj10aGlzO3JldHVybiBpPWUoIjxsaSAvPiIseyJjbGFzcyI6InNlYXJjaC1jaG9pY2UifSkuaHRtbCgiPHNwYW4+Iit0Lmh0bWwrIjwvc3Bhbj4iKSx0LmRpc2FibGVkP2kuYWRkQ2xhc3MoInNlYXJjaC1jaG9pY2UtZGlzYWJsZWQiKToobj1lKCI8YSAvPiIse2hyZWY6IiMiLCJjbGFzcyI6InNlYXJjaC1jaG9pY2UtY2xvc2UiLHJlbDp0LmFycmF5X2luZGV4fSksbi5jbGljayhmdW5jdGlvbih0KXtyZXR1cm4gci5jaG9pY2VfZGVzdHJveV9saW5rX2NsaWNrKHQpfSksaS5hcHBlbmQobikpLHRoaXMuc2VhcmNoX2NvbnRhaW5lci5iZWZvcmUoaSl9LGkucHJvdG90eXBlLmNob2ljZV9kZXN0cm95X2xpbmtfY2xpY2s9ZnVuY3Rpb24odCl7aWYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksIXRoaXMuaXNfZGlzYWJsZWQpcmV0dXJuIHRoaXMuY2hvaWNlX2Rlc3Ryb3koZSh0LnRhcmdldCkpfSxpLnByb3RvdHlwZS5jaG9pY2VfZGVzdHJveT1mdW5jdGlvbih0KXtpZih0aGlzLnJlc3VsdF9kZXNlbGVjdCh0LmF0dHIoInJlbCIpKSlyZXR1cm4gdGhpcy5zaG93X3NlYXJjaF9maWVsZF9kZWZhdWx0KCksdGhpcy5pc19tdWx0aXBsZSYmdGhpcy5jaG9pY2VzX2NvdW50KCk+MCYmdGhpcy5zZWFyY2hfZmllbGQudmFsKCkubGVuZ3RoPDEmJnRoaXMucmVzdWx0c19oaWRlKCksdC5wYXJlbnRzKCJsaSIpLmZpcnN0KCkucmVtb3ZlKCksdGhpcy5zZWFyY2hfZmllbGRfc2NhbGUoKX0saS5wcm90b3R5cGUucmVzdWx0c19yZXNldD1mdW5jdGlvbigpe2lmKHRoaXMuZm9ybV9maWVsZC5vcHRpb25zWzBdLnNlbGVjdGVkPSEwLHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50PW51bGwsdGhpcy5zZWxlY3RlZF9pdGVtLmZpbmQoInNwYW4iKS50ZXh0KHRoaXMuZGVmYXVsdF90ZXh0KSx0aGlzLmlzX211bHRpcGxlfHx0aGlzLnNlbGVjdGVkX2l0ZW0uYWRkQ2xhc3MoImNoem4tZGVmYXVsdCIpLHRoaXMuc2hvd19zZWFyY2hfZmllbGRfZGVmYXVsdCgpLHRoaXMucmVzdWx0c19yZXNldF9jbGVhbnVwKCksdGhpcy5mb3JtX2ZpZWxkX2pxLnRyaWdnZXIoImNoYW5nZSIpLHRoaXMuYWN0aXZlX2ZpZWxkKXJldHVybiB0aGlzLnJlc3VsdHNfaGlkZSgpfSxpLnByb3RvdHlwZS5yZXN1bHRzX3Jlc2V0X2NsZWFudXA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jdXJyZW50X3NlbGVjdGVkSW5kZXg9dGhpcy5mb3JtX2ZpZWxkLnNlbGVjdGVkSW5kZXgsdGhpcy5zZWxlY3RlZF9pdGVtLmZpbmQoImFiYnIiKS5yZW1vdmUoKX0saS5wcm90b3R5cGUucmVzdWx0X3NlbGVjdD1mdW5jdGlvbih0KXt2YXIgZSxpLG4scjtpZih0aGlzLnJlc3VsdF9oaWdobGlnaHQpcmV0dXJuIGU9dGhpcy5yZXN1bHRfaGlnaGxpZ2h0LGk9ZS5hdHRyKCJpZCIpLHRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpLHRoaXMuaXNfbXVsdGlwbGUmJnRoaXMubWF4X3NlbGVjdGVkX29wdGlvbnM8PXRoaXMuY2hvaWNlc19jb3VudCgpPyh0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigibGlzenQ6bWF4c2VsZWN0ZWQiLHtjaG9zZW46dGhpc30pLCExKToodGhpcy5pc19tdWx0aXBsZT9lLnJlbW92ZUNsYXNzKCJhY3RpdmUtcmVzdWx0Iik6KHRoaXMuc2VhcmNoX3Jlc3VsdHMuZmluZCgiLnJlc3VsdC1zZWxlY3RlZCIpLnJlbW92ZUNsYXNzKCJyZXN1bHQtc2VsZWN0ZWQiKSx0aGlzLnJlc3VsdF9zaW5nbGVfc2VsZWN0ZWQ9ZSx0aGlzLnNlbGVjdGVkX2l0ZW0ucmVtb3ZlQ2xhc3MoImNoem4tZGVmYXVsdCIpKSxlLmFkZENsYXNzKCJyZXN1bHQtc2VsZWN0ZWQiKSxyPWkuc3Vic3RyKGkubGFzdEluZGV4T2YoIl8iKSsxKSxuPXRoaXMucmVzdWx0c19kYXRhW3JdLG4uc2VsZWN0ZWQ9ITAsdGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbbi5vcHRpb25zX2luZGV4XS5zZWxlY3RlZD0hMCx0aGlzLnNlbGVjdGVkX29wdGlvbl9jb3VudD1udWxsLHRoaXMuaXNfbXVsdGlwbGU/dGhpcy5jaG9pY2VfYnVpbGQobik6KHRoaXMuc2VsZWN0ZWRfaXRlbS5maW5kKCJzcGFuIikuZmlyc3QoKS50ZXh0KA==", "base64"));
  res.write(new Buffer("bi50ZXh0KSx0aGlzLmFsbG93X3NpbmdsZV9kZXNlbGVjdCYmdGhpcy5zaW5nbGVfZGVzZWxlY3RfY29udHJvbF9idWlsZCgpKSwodC5tZXRhS2V5fHx0LmN0cmxLZXkpJiZ0aGlzLmlzX211bHRpcGxlfHx0aGlzLnJlc3VsdHNfaGlkZSgpLHRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgiIiksKHRoaXMuaXNfbXVsdGlwbGV8fHRoaXMuZm9ybV9maWVsZC5zZWxlY3RlZEluZGV4IT09dGhpcy5jdXJyZW50X3NlbGVjdGVkSW5kZXgpJiZ0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigiY2hhbmdlIix7c2VsZWN0ZWQ6dGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbbi5vcHRpb25zX2luZGV4XS52YWx1ZX0pLHRoaXMuY3VycmVudF9zZWxlY3RlZEluZGV4PXRoaXMuZm9ybV9maWVsZC5zZWxlY3RlZEluZGV4LHRoaXMuc2VhcmNoX2ZpZWxkX3NjYWxlKCkpfSxpLnByb3RvdHlwZS5yZXN1bHRfYWN0aXZhdGU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5kaXNhYmxlZD90LmFkZENsYXNzKCJkaXNhYmxlZC1yZXN1bHQiKTp0aGlzLmlzX211bHRpcGxlJiZlLnNlbGVjdGVkP3QuYWRkQ2xhc3MoInJlc3VsdC1zZWxlY3RlZCIpOnQuYWRkQ2xhc3MoImFjdGl2ZS1yZXN1bHQiKX0saS5wcm90b3R5cGUucmVzdWx0X2RlYWN0aXZhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVtb3ZlQ2xhc3MoImFjdGl2ZS1yZXN1bHQgcmVzdWx0LXNlbGVjdGVkIGRpc2FibGVkLXJlc3VsdCIpfSxpLnByb3RvdHlwZS5yZXN1bHRfZGVzZWxlY3Q9ZnVuY3Rpb24odCl7dmFyIGksbjtyZXR1cm4gbj10aGlzLnJlc3VsdHNfZGF0YVt0XSwhdGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbbi5vcHRpb25zX2luZGV4XS5kaXNhYmxlZCYmKG4uc2VsZWN0ZWQ9ITEsdGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbbi5vcHRpb25zX2luZGV4XS5zZWxlY3RlZD0hMSx0aGlzLnNlbGVjdGVkX29wdGlvbl9jb3VudD1udWxsLGk9ZSgiIyIrdGhpcy5jb250YWluZXJfaWQrIl9vXyIrdCksaS5yZW1vdmVDbGFzcygicmVzdWx0LXNlbGVjdGVkIikuYWRkQ2xhc3MoImFjdGl2ZS1yZXN1bHQiKS5zaG93KCksdGhpcy5yZXN1bHRfY2xlYXJfaGlnaGxpZ2h0KCksdGhpcy53aW5ub3dfcmVzdWx0cygpLHRoaXMuZm9ybV9maWVsZF9qcS50cmlnZ2VyKCJjaGFuZ2UiLHtkZXNlbGVjdGVkOnRoaXMuZm9ybV9maWVsZC5vcHRpb25zW24ub3B0aW9uc19pbmRleF0udmFsdWV9KSx0aGlzLnNlYXJjaF9maWVsZF9zY2FsZSgpLCEwKX0saS5wcm90b3R5cGUuc2luZ2xlX2Rlc2VsZWN0X2NvbnRyb2xfYnVpbGQ9ZnVuY3Rpb24oKXtpZih0aGlzLmFsbG93X3NpbmdsZV9kZXNlbGVjdClyZXR1cm4gdGhpcy5zZWxlY3RlZF9pdGVtLmZpbmQoImFiYnIiKS5sZW5ndGh8fHRoaXMuc2VsZWN0ZWRfaXRlbS5maW5kKCJzcGFuIikuZmlyc3QoKS5hZnRlcignPGFiYnIgY2xhc3M9InNlYXJjaC1jaG9pY2UtY2xvc2UiPjwvYWJicj4nKSx0aGlzLnNlbGVjdGVkX2l0ZW0uYWRkQ2xhc3MoImNoem4tc2luZ2xlLXdpdGgtZGVzZWxlY3QiKX0saS5wcm90b3R5cGUud2lubm93X3Jlc3VsdHM9ZnVuY3Rpb24oKXt2YXIgdCxpLG4scixzLG8sYSxsLGMsdSxkLGgscCxmLG0sXyxnLHY7Zm9yKHRoaXMubm9fcmVzdWx0c19jbGVhcigpLGM9MCx1PXRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgpPT09dGhpcy5kZWZhdWx0X3RleHQ/IiI6ZSgiPGRpdi8+IikudGV4dChlLnRyaW0odGhpcy5zZWFyY2hfZmllbGQudmFsKCkpKS5odG1sKCksbz10aGlzLnNlYXJjaF9jb250YWlucz8iIjoiXiIscz1uZXcgUmVnRXhwKG8rdS5yZXBsYWNlKC9bLVtcXXt9KCkqKz8uLFxcXiR8I1xzXS9nLCJcXCQmIiksImkiKSxwPW5ldyBSZWdFeHAodS5yZXBsYWNlKC9bLVtcXXt9KCkqKz8uLFxcXiR8I1xzXS9nLCJcXCQmIiksImkiKSx2PXRoaXMucmVzdWx0c19kYXRhLGY9MCxfPXYubGVuZ3RoO2Y8XztmKyspaWYoaT12W2ZdLCFpLmVtcHR5KWlmKGkuZ3JvdXApZSgiIyIraS5kb21faWQpLmNzcygiZGlzcGxheSIsIm5vbmUiKTtlbHNle2lmKHQ9ITEsbD1pLmRvbV9pZCxhPWUoIiMiK2wpLHMudGVzdChpLmh0bWwpKXQ9ITAsYys9MTtlbHNlIGlmKHRoaXMuZW5hYmxlX3NwbGl0X3dvcmRfc2VhcmNoJiYoaS5odG1sLmluZGV4T2YoIiAiKT49MHx8MD09PWkuaHRtbC5pbmRleE9mKCJbIikpJiYocj1pLmh0bWwucmVwbGFjZSgvXFt8XF0vZywiIikuc3BsaXQoIiAiKSxyLmxlbmd0aCkpZm9yKG09MCxnPXIubGVuZ3RoO208ZzttKyspbj1yW21dLHMudGVzdChuKSYmKHQ9ITAsYys9MSk7dD8odS5sZW5ndGg/KGQ9aS5odG1sLnNlYXJjaChwKSxoPWkuaHRtbC5zdWJzdHIoMCxkK3UubGVuZ3RoKSsiPC9lbT4iK2kuaHRtbC5zdWJzdHIoZCt1Lmxlbmd0aCksaD1oLnN1YnN0cigwLGQpKyI8ZW0+IitoLnN1YnN0cihkKSk6aD1pLmh0bWwsYS5odG1sKGgpLHRoaXMucmVzdWx0X2FjdGl2YXRlKGEsaSksbnVsbCE9aS5ncm91cF9hcnJheV9pbmRleCYmZSgiIyIrdGhpcy5yZXN1bHRzX2RhdGFbaS5ncm91cF9hcnJheV9pbmRleF0uZG9tX2lkKS5jc3MoImRpc3BsYXkiLCJsaXN0LWl0ZW0iKSk6KHRoaXMucmVzdWx0X2hpZ2hsaWdodCYmbD09PXRoaXMucmVzdWx0X2hpZ2hsaWdodC5hdHRyKCJpZCIpJiZ0aGlzLnJlc3VsdF9jbGVhcl9oaWdobGlnaHQoKSx0aGlzLnJlc3VsdF9kZWFjdGl2YXRlKGEpKX1yZXR1cm4gYzwxJiZ1Lmxlbmd0aD90aGlzLm5vX3Jlc3VsdHModSk6dGhpcy53aW5ub3dfcmVzdWx0c19zZXRfaGlnaGxpZ2h0KCl9LGkucHJvdG90eXBlLndpbm5vd19yZXN1bHRzX3NldF9oaWdobGlnaHQ9ZnVuY3Rpb24oKXt2YXIgdCxlO2lmKCF0aGlzLnJlc3VsdF9oaWdobGlnaHQmJihlPXRoaXMuaXNfbXVsdGlwbGU/W106dGhpcy5zZWFyY2hfcmVzdWx0cy5maW5kKCIucmVzdWx0LXNlbGVjdGVkLmFjdGl2ZS1yZXN1bHQiKSx0PWUubGVuZ3RoP2UuZmlyc3QoKTp0aGlzLnNlYXJjaF9yZXN1bHRzLmZpbmQoIi5hY3RpdmUtcmVzdWx0IikuZmlyc3QoKSxudWxsIT10KSlyZXR1cm4gdGhpcy5yZXN1bHRfZG9faGlnaGxpZ2h0KHQpfSxpLnByb3RvdHlwZS5ub19yZXN1bHRzPWZ1bmN0aW9uKHQpe3ZhciBpO3JldHVybiBpPWUoJzxsaSBjbGFzcz0ibm8tcmVzdWx0cyI+Jyt0aGlzLnJlc3VsdHNfbm9uZV9mb3VuZCsnICI8c3Bhbj48L3NwYW4+IjwvbGk+JyksaS5maW5kKCJzcGFuIikuZmlyc3QoKS5odG1sKHQpLHRoaXMuc2VhcmNoX3Jlc3VsdHMuYXBwZW5kKGkpfSxpLnByb3RvdHlwZS5ub19yZXN1bHRzX2NsZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VhcmNoX3Jlc3VsdHMuZmluZCgiLm5vLXJlc3VsdHMiKS5yZW1vdmUoKX0saS5wcm90b3R5cGUua2V5ZG93bl9hcnJvdz1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLnJlc3VsdHNfc2hvd2luZyYmdGhpcy5yZXN1bHRfaGlnaGxpZ2h0Pyh0PXRoaXMucmVzdWx0X2hpZ2hsaWdodC5uZXh0QWxsKCJsaS5hY3RpdmUtcmVzdWx0IikuZmlyc3QoKSk/dGhpcy5yZXN1bHRfZG9faGlnaGxpZ2h0KHQpOnZvaWQgMDp0aGlzLnJlc3VsdHNfc2hvdygpfSxpLnByb3RvdHlwZS5rZXl1cF9hcnJvdz1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLnJlc3VsdHNfc2hvd2luZ3x8dGhpcy5pc19tdWx0aXBsZT90aGlzLnJlc3VsdF9oaWdobGlnaHQ/KHQ9dGhpcy5yZXN1bHRfaGlnaGxpZ2h0LnByZXZBbGwoImxpLmFjdGl2ZS1yZXN1bHQiKSx0Lmxlbmd0aD90aGlzLnJlc3VsdF9kb19oaWdobGlnaHQodC5maXJzdCgpKToodGhpcy5jaG9pY2VzX2NvdW50KCk+MCYmdGhpcy5yZXN1bHRzX2hpZGUoKSx0aGlzLnJlc3VsdF9jbGVhcl9oaWdobGlnaHQoKSkpOnZvaWQgMDp0aGlzLnJlc3VsdHNfc2hvdygpfSxpLnByb3RvdHlwZS5rZXlkb3duX2JhY2tzdHJva2U9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5wZW5kaW5nX2JhY2tzdHJva2U/KHRoaXMuY2hvaWNlX2Rlc3Ryb3kodGhpcy5wZW5kaW5nX2JhY2tzdHJva2UuZmluZCgiYSIpLmZpcnN0KCkpLHRoaXMuY2xlYXJfYmFja3N0cm9rZSgpKToodD10aGlzLnNlYXJjaF9jb250YWluZXIuc2libGluZ3MoImxpLnNlYXJjaC1jaG9pY2UiKS5sYXN0KCksdC5sZW5ndGgmJiF0Lmhhc0NsYXNzKCJzZWFyY2gtY2hvaWNlLWRpc2FibGVkIik/KHRoaXMucGVuZGluZ19iYWNrc3Ryb2tlPXQsdGhpcy5zaW5nbGVfYmFja3N0cm9rZV9kZWxldGU/dGhpcy5rZXlkb3duX2JhY2tzdHJva2UoKTp0aGlzLnBlbmRpbmdfYmFja3N0cm9rZS5hZGRDbGFzcygic2VhcmNoLWNob2ljZS1mb2N1cyIpKTp2b2lkIDApfSxpLnByb3RvdHlwZS5jbGVhcl9iYWNrc3Ryb2tlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGVuZGluZ19iYWNrc3Ryb2tlJiZ0aGlzLnBlbmRpbmdfYmFja3N0cm9rZS5yZW1vdmVDbGFzcygic2VhcmNoLWNob2ljZS1mb2N1cyIpLHRoaXMucGVuZGluZ19iYWNrc3Ryb2tlPW51bGx9LGkucHJvdG90eXBlLmtleWRvd25fY2hlY2tlcj1mdW5jdGlvbih0KXt2YXIgZSxpO3N3aXRjaChlPW51bGwhPShpPXQud2hpY2gpP2k6dC5rZXlDb2RlLHRoaXMuc2VhcmNoX2ZpZWxkX3NjYWxlKCksOCE9PWUmJnRoaXMucGVuZGluZ19iYWNrc3Ryb2tlJiZ0aGlzLmNsZWFyX2JhY2tzdHJva2UoKSxlKXtjYXNlIDg6dGhpcy5iYWNrc3Ryb2tlX2xlbmd0aD10aGlzLnNlYXJjaF9maWVsZC52YWwoKS5sZW5ndGg7YnJlYWs7Y2FzZSA5OnRoaXMucmVzdWx0c19zaG93aW5nJiYhdGhpcy5pc19tdWx0aXBsZSYmdGhpcy5yZXN1bHRfc2VsZWN0KHQpLHRoaXMubW91c2Vfb25fY29udGFpbmVyPSExO2JyZWFrO2Nhc2UgMTM6dC5wcmV2ZW50RGVmYXVsdCgpO2JyZWFrO2Nhc2UgMzg6dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMua2V5dXBfYXJyb3coKTticmVhaztjYXNlIDQwOnQucHJldmVudERlZmF1bHQoKSx0aGlzLmtleWRvd25fYXJyb3coKX19LGkucHJvdG90eXBlLnNlYXJjaF9maWVsZF9zY2FsZT1mdW5jdGlvbigpe3ZhciB0LGksbixyLHMsbyxhLGw7aWYodGhpcy5pc19tdWx0aXBsZSl7Zm9yKGk9MCxvPTAscj0icG9zaXRpb246YWJzb2x1dGU7IGxlZnQ6IC0xMDAwcHg7IHRvcDogLTEwMDBweDsgZGlzcGxheTpub25lOyIscz1bImZvbnQtc2l6ZSIsImZvbnQtc3R5bGUiLCJmb250LXdlaWdodCIsImZvbnQtZmFtaWx5IiwibGluZS1oZWlnaHQiLCJ0ZXh0LXRyYW5zZm9ybSIsImxldHRlci1zcGFjaW5nIl0sYT0wLGw9cy5sZW5ndGg7YTxsO2ErKyluPXNbYV0scis9bisiOiIrdGhpcy5zZWFyY2hfZmllbGQuY3NzKG4pKyI7IjtyZXR1cm4gdD1lKCI8ZGl2IC8+Iix7c3R5bGU6cn0pLHQudGV4dCh0aGlzLnNlYXJjaF9maWVsZC52YWwoKSksZSgiYm9keSIpLmFwcGVuZCh0KSxvPXQud2lkdGgoKSsyNSx0LnJlbW92ZSgpLHRoaXMuZl93aWR0aHx8KHRoaXMuZl93aWR0aD10aGlzLmNvbnRhaW5lci5vdXRlcldpZHRoKCkpLG8+dGhpcy5mX3dpZHRoLTEwJiYobz10aGlzLmZfd2lkdGgtMTApLHRoaXMuc2VhcmNoX2ZpZWxkLmNzcyh7d2lkdGg6bysicHgifSl9fSxpLnByb3RvdHlwZS5nZW5lcmF0ZV9yYW5kb21faWQ9ZnVuY3Rpb24oKXt2YXIgdDtmb3IodD0ic2VsIit0aGlzLmdlbmVyYXRlX3JhbmRvbV9jaGFyKCkrdGhpcy5nZW5lcmF0ZV9yYW5kb21fY2hhcigpK3RoaXMuZ2VuZXJhdGVfcmFuZG9tX2NoYXIoKTtlKCIjIit0KS5sZW5ndGg+MDspdCs9dGhpcy5nZW5lcmF0ZV9yYW5kb21fY2hhcigpO3JldHVybiB0fSxpfShhKSxuLkNob3Nlbj1pfS5jYWxsKHRoaXMpfS5hcHBseShlLG4pLC8vIENob3NlbiwgYSBTZWxlY3QgQm94IEVuaGFuY2VyIGZvciBqUXVlcnkgYW5kIFByb3RvdHlwZQoJLy8gYnkgUGF0cmljayBGaWxsZXIgZm9yIEhhcnZlc3QsIGh0dHA6Ly9nZXRoYXJ2ZXN0LmNvbQoJLy8gVmVyc2lvbiAwLjExLjEKCS8vIEZ1bGwgc291cmNlIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9oYXJ2ZXN0aHEvY2hvc2VuCgkvLyBDb3B5cmlnaHQgKGMpIDIwMTEgSGFydmVzdCBodHRwOi8vZ2V0aGFydmVzdC5jb20KCS8vIE1JVCBMaWNlbnNlLCBodHRwczovL2dpdGh1Yi5jb20vaGFydmVzdGhxL2Nob3Nlbi9ibG9iL21hc3Rlci9MSUNFTlNFLm1kCgkhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoNSksaSgxNzMpLGkoMTQ3KSxpKDIwMyksaSgyMDkpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9bi50cGwoJ1x0ICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJ7e25hbWV9fSIgZGF0YS1zZS1uYW1lPSJ7e3JlYWxOYW1lfX0iIHZhbHVlPSJ7e3ZhbHVlfX0iIGlkPSJ7e2lkfX0iPlx0ICAgICAgPGxhYmVsIGZvcj0ie3tpZH19IiBkYXRhLXNlLWZvci1uYW1lPSJ7e3JlYWxOYW1lfX0iPlx0ICAgICAgICB7e2xhYmVsfX1cdCAgICAgICAge3sjaWYgZXhwbGFpbn19XHQgICAgICAgIDxwIGNsYXNzPSJvLWZvcm0tZXhwbGFpbiI+e3tleHBsYWlufX08L3A+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgIDwvbGFiZWw+XHQgICcpO3JldHVybiByLmV4dGVuZCh7ZXZlbnRzOnsiY2hhbmdlIDpyYWRpbyI6InVwZGF0ZSIsa2V5dXA6ZnVuY3Rpb24odCl7aS5pc1NwYWNlQmFyKHQpP2UodC50YXJnZXQpLmNsaWNrKCk6aS5pc0VudGVyKHQpJiZ0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06c2F2ZSIpfX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5lbXB0eSgpLHQuZWFjaCh0aGlzLm9wdGlvbnMub3B0aW9ucyxmdW5jdGlvbihlLGkpe3ZhciBuPXtpZDp0LnVuaXF1ZUlkKCJvcHRpb24iKSxuYW1lOnRoaXMub3B0aW9ucy5pbnB1dElkLHJlYWxOYW1lOnRoaXMub3B0aW9ucy5uYW1lLHZhbHVlOml9O3QuaXNPYmplY3QoZSl8fChlPXtsYWJlbDplfSksdC5leHRlbmQobixlKSx0aGlzLiRlbC5hcHBlbmQocyhuKSl9LHRoaXMpO3ZhciBlPXRoaXMuZ2V0TW9kZWxWYWx1ZSgpO3JldHVybiBlJiZ0aGlzLiQoIjpyYWRpb1t2YWx1ZT0iK2UrIl0iKS5wcm9wKCJjaGVja2VkIiwhMCksdGhpcy4kKCJpbnB1dCIpLmN1c3RvbUlucHV0KCksdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpLHRoaXMuZ2V0UGFyYW0oImlubGluZSIpPT09ITAmJnRoaXMuJCgiZGl2LmN1c3RvbS1yYWRpbyIpLmFkZENsYXNzKCJpbmxpbmUiKSx0aGlzfSxyZWFkTW9kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRNb2RlKCksdGhpcy4kKCI6cmFkaW8iKS5wcm9wKCJkaXNhYmxlZCIsITApLHRoaXN9LHZhbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIjpyYWRpbzpjaGVja2VkIikudmFsKCl9LGZvY3VzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgibGFiZWw6ZXEoMCkiKS5mb2N1cygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNildLHI9ZnVuY3Rpb24odCl7dmFyIGU9dDt0LmZuLmN1c3RvbUlucHV0PWZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcykuZWFjaChmdW5jdGlvbigpe2lmKGUodGhpcykuaXMoIlt0eXBlPWNoZWNrYm94XSxbdHlwZT1yYWRpb10iKSl7dmFyIHQ9ZSh0aGlzKSxpPXQuc2libGluZ3MoJ2xhYmVsW2Zvcj0iJyt0LmF0dHIoImlkIikrJyJdOmZpcnN0Jyk7aS5sZW5ndGh8fChpPXQuY2xvc2VzdCgnbGFiZWxbZm9yPSInK3QuYXR0cigiaWQiKSsnIl06Zmlyc3QnKSksdC5hZGQoaSkud3JhcEFsbCgnPGRpdiBjbGFzcz0iY3VzdG9tLScrdC5hdHRyKCJ0eXBlIikrJyI+PC9kaXY+JyksaS5ob3ZlcihmdW5jdGlvbigpe2UodGhpcykuYWRkQ2xhc3MoImhvdmVyIil9LGZ1bmN0aW9uKCl7ZSh0aGlzKS5yZW1vdmVDbGFzcygiaG92ZXIiKX0pLHQuYmluZCgidXBkYXRlU3RhdGUiLGZ1bmN0aW9uKCl7dC5pcygiOmNoZWNrZWQiKT9pLmFkZENsYXNzKCJjaGVja2VkIik6aS5yZW1vdmVDbGFzcygiY2hlY2tlZCBjaGVja2VkSG92ZXIgY2hlY2tlZEZvY3VzIil9KS50cmlnZ2VyKCJ1cGRhdGVTdGF0ZSIpLmNsaWNrKGZ1bmN0aW9uKCl7ZSgnaW5wdXRbbmFtZT0iJytlKHRoaXMpLmF0dHIoIm5hbWUiKSsnIl0nKS50cmlnZ2VyKCJ1cGRhdGVTdGF0ZSIpfSkuZm9jdXMoZnVuY3Rpb24oKXtpLmFkZENsYXNzKCJmb2N1cyIpLHQuaXMoIjpjaGVja2VkIikmJmUodGhpcykuYWRkQ2xhc3MoImNoZWNrZWRGb2N1cyIpfSkuYmx1cihmdW5jdGlvbigpe2kucmVtb3ZlQ2xhc3MoImZvY3VzIGNoZWNrZWRGb2N1cyIpfSl9fSl9fS5hcHBseShlLG4pLC8qKgoJCSAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJICogalF1ZXJ5IGN1c3RvbUlucHV0IHBsdWdpbgoJCSAqIEF1dGhvcjogTWFnZ2llIENvc3RlbGxvIFdhY2hzIG1hZ2dpZUBmaWxhbWVudGdyb3VwLmNvbSwgU2NvdHQgSmVobCwgc2NvdHRAZmlsYW1lbnRncm91cC5jb20KCQkgKiBDb3B5cmlnaHQgKGMpIDIwMDkgRmlsYW1lbnQgR3JvdXAKCQkgKiBsaWNlbnNlZCB1bmRlciBNSVQgKGZpbGFtZW50Z3JvdXAuY29tL2V4YW1wbGVzL21pdC1saWNlbnNlLnR4dCkKCQkgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCSovCgkhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTczKSxpKDE0NyksaSgyMDMpLGkoMjA5KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1pLnRwbCgnXHQgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aW5wdXRJZH19Ii8+XHQgICAgPGxhYmVsIGZvcj0ie3tpbnB1dElkfX0iIGRhdGEtc2UtZm9yLW5hbWU9Int7bmFtZX19Ij57e3BsYWNlaG9sZGVyfX08L2xhYmVsPlx0ICAnKTtyZXR1cm4gbi5leHRlbmQoe3RlbXBsYXRlOnIsZXZlbnRzOnsiY2hhbmdlIDpjaGVja2JveCI6InVwZGF0ZSIsa2V5dXA6ZnVuY3Rpb24odCl7ZS5pc1NwYWNlQmFyKHQpP3RoaXMuJCgiOmNoZWNrYm94IikuY2xpY2soKTplLmlzRW50ZXIodCkmJnRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpzYXZlIil9fSxlZGl0TW9kZTpmdW5jdGlvbigpe3ZhciBlPXQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywicGxhY2Vob2xkZXIiLHRoaXMpOyIiPT09ZT9lPXQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywibGFiZWwiLHRoaXMpOmU9PT0hMSYmKGU9IiIpLHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSh0LmV4dGVuZCh0Lm9taXQodGhpcy5vcHRpb25zLCJwbGFjZWhvbGRlciIpLHtwbGFjZWhvbGRlcjplfSkpKTt2YXIgaT10aGlzLiQoIjpjaGVja2JveCIpO3JldHVybiBpLnByb3AoImNoZWNrZWQiLHRoaXMuZ2V0TW9kZWxWYWx1ZSgpfHwhMSksdGhpcy4kKCJpbnB1dCIpLmN1c3RvbUlucHV0KCksdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpLHRoaXN9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdE1vZGUoKSx0aGlzLiQoIjpjaGVja2JveCIpLnByb3AoImRpc2FibGVkIiwhMCksdGhpc30sdmFsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgiOmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIpfSxmb2N1czpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIjpjaGVja2JveCIpLmZvY3VzKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgyMDMpLGkoMTQ2KSxpKDE1MyldLHI9ZnVuY3Rpb24odCxlLGksbil7ZnVuY3Rpb24gcihlKXtyZXR1cm4gdC5maWx0ZXIoZXx8W10sZnVuY3Rpb24oZSl7cmV0dXJuIXQuY29udGFpbnMoWyJsYWJlbCIsImJ1dHRvbiIsInNlbGVjdCJdLGUudHlwZSl9KS5sZW5ndGh9ZnVuY3Rpb24gcyhlKXtyZXR1cm4gbi5jcmVhdGUodC5kZWZhdWx0cyh7Z2V0UmVhZE1vZGVTdHJpbmc6dC5jb25zdGFudCgiICIpLGZvY3VzOnQubm9vcH0sdC5waWNrKGUsImNsaWNrIiwidGl0bGUiLCJocmVmIikpKX12YXIgbz1lLmV4dGVuZCh7dGFnTmFtZToic3BhbiIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuJGVsLnRleHQodGhpcy5nZXRNb2RlbFZhbHVlKCkpfSxlZGl0TW9kZTpmdW5jdGlvbigpe3RoaXMudG9nZ2xlKCEwKX0scmVhZE1vZGU6ZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZSghMSl9LGdldE1vZGVsVmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zLmxhYmVsfSx0b2dnbGU6ZnVuY3Rpb24odCl7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoIm8tZm9ybS1sYWJlbC1pbmxpbmUiLHQpLHRoaXMuJGVsLnRvZ2dsZUNsYXNzKCJvLWZvcm0tY29udHJvbCIsIXQpfSxmb2N1czp0Lm5vb3B9KSxhPWkuZXh0ZW5kKHtnZXRQYXJhbXM6ZS5wcm90b3R5cGUuZ2V0UGFyYW1zLGdldFBhcmFtOmUucHJvdG90eXBlLmdldFBhcmFtLGNsYXNzTmFtZTpmdW5jdGlvbigpe3ZhciB0O3JldHVybiB0PSJ0ZXh0Ij09dGhpcy5nZXRQYXJhbSgiZGlzcGxheSIpPyJvLWZvcm0taW5wdXQtZ3JvdXAtc3VidGxlIjoiby1mb3JtLWlucHV0LWdyb3VwIixyKHRoaXMuZ2V0UGFyYW0oImlucHV0cyIpKT4xJiYodCs9IiBvLWZvcm0taW5wdXQtZ3JvdXAtMiIpLHR9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmVhY2godGhpcy5nZXRQYXJhbSgiaW5wdXRzIiksZnVuY3Rpb24oZSl7c3dpdGNoKGUudHlwZSl7Y2FzZSJsYWJlbCI6dGhpcy5hZGQobyx7b3B0aW9uczplfSk7YnJlYWs7Y2FzZSJidXR0b24iOnRoaXMuYWRkKHMoZSkpO2JyZWFrO2RlZmF1bHQ6ZT10LmRlZmF1bHRzKHttb2RlbDp0aGlzLm1vZGVsLHBhcmFtczp0LmV4dGVuZCh7YXV0b1dpZHRoOiEwfSxlLnBhcmFtc3x8e30pfSxlKSx0aGlzLmFkZCh0aGlzLmdldFBhcmFtcygpLmNyZWF0ZShlKSl9fSx0aGlzKX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLmZpcnN0KCkuZm9jdXMoKX19KTtyZXR1cm4gZS5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKHQpe3RoaXMuaW5wdXRHcm91cFZpZXc9bmV3IGEodCksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGVkaXRNb2RlOmZ1bmN0aW9uKCl7dGhpcy5pbnB1dEdyb3VwVmlldy5yZW1vdmUoKSx0aGlzLmlucHV0R3JvdXBWaWV3PW5ldyBhKHRoaXMub3B0aW9ucyksdGhpcy4kZWwuaHRtbCh0aGlzLmlucHV0R3JvdXBWaWV3LnJlbmRlcigpLmVsKX0sdG9TdHJpbmdWYWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRHcm91cFZpZXcubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0LmdldFJlYWRNb2RlU3RyaW5nKCl9KTtyZXR1cm4gZS5sZW5ndGgmJnQuZXZlcnkoZSk/ZS5qb2luKCIgIik6IiAifSxmb2N1czpmdW5jdGlvbigpe3RoaXMuaW5wdXRHcm91cFZpZXcuZm9jdXMoKX19LHtMYWJlbElucHV0Om8sSW5wdXRHcm91cFZpZXc6YX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMjI0KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJpbWFnZS1maWxlLXVwbG9hZCIscGFyc2U6ZnVuY3Rpb24oZSl7dmFyIGk9dC5jbG9uZShlfHx7fSk7cmV0dXJuIGkuc2l6ZSYmKGkuZmlsZVNpemVLQj1NYXRoLnJvdW5kKGkuc2l6ZS8xZTMpKSxpfSxwcmV2aWV3VGVtcGxhdGU6J1x0ICAgICAgPGRpdiBjbGFzcz0iaW1hZ2UtZmlsZS10aHVtYm5haWwgZmxvYXQtbCI+XHQgICAgICAgIDxpbWcgc3JjPSJ7e2ltYWdlVXJsfX0iID5cdCAgICAgIDwvZGl2Plx0ICAgICAgPGRpdiBjbGFzcz0iaW1hZ2UtZmlsZS1pbmZvIGZsb2F0LWwiPlx0ICAgICAgICA8dWw+XHQgICAgICAgICAge3sjaWYgbmFtZX19PGxpPnt7bmFtZX19PC9saT57ey9pZn19XHQgICAgICAgICAge3sjaWYgZmlsZVNpemVLQn19PGxpPnt7ZmlsZVNpemVLQn19KEtCKTwvbGk+e3svaWZ9fVx0ICAgICAgICA8L3VsPlx0ICAgICAgPC9kaXY+JyxmaWxlVHlwZXM6WyIucG5nIiwiLmdpZiIsIi5qcGVnIiwiLmpwZyJdfSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMjAzKSxpKDEzNiksaSgzMyksaSgyMjUpLGkoMTc3KSxpKDE0NyksaSgyMjYpLGkoMjI3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjKXtmdW5jdGlvbiB1KHQpe2lmKCFlLmlzU3RyaW5nKHQpKXJldHVybiBlLmNsb25lKHQpO3RyeXtyZXR1cm4gSlNPTi5wYXJzZSh0KX1jYXRjaChpKXtyZXR1cm59fXJldHVybiBpLmV4dGVuZCh7aWRBdHRyaWJ1dGU6ImlkIixwcmV2aWV3VGVtcGxhdGU6bnVsbCxmaWxlVHlwZXM6bnVsbCxwYXJzZTplLmlkZW50aXR5LGZpbGVGaWVsZE5hbWU6ImZpbGUiLGZpbGVVcGxvYWRJbnB1dEV2ZW50czp7Y2xlYXI6ImNsZWFyRXJyb3IiLHN1Y2Nlc3M6ImFkZEZpbGVEYXRhIixlcnJvcjoic2hvd0Vycm9yIn0sY29uc3RydWN0b3I6ZnVuY3Rpb24odCl7dmFyIHM9ZS5leHRlbmQoe2ZpbGVUeXBlczplLnJlc3VsdCh0aGlzLCJmaWxlVHlwZXMiKSxmaWxlRmllbGROYW1lOmUucmVzdWx0KHQucGFyYW1zLCJmaWxlRmllbGROYW1lIil8fGUucmVzdWx0KHRoaXMsImZpbGVGaWVsZE5hbWUiKSxlbmRwb2ludDplLnJlc3VsdCh0aGlzLCJlbmRwb2ludCIpfSx0LHRoaXMuZ2V0UGFyYW1zKHQpKTt0aGlzLmZpbGVVcGxvYWRJbnB1dD1uZXcgbChzKSxpLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgbz1yLmV4dGVuZCh7bW9kZWw6bi5leHRlbmQoe2V4dHJhUHJvcGVydGllczohMCxpZEF0dHJpYnV0ZTp0aGlzLmdldFBhcmFtT3JBdHRyaWJ1dGUoImlkQXR0cmlidXRlIil9KX0pO3RoaXMuY29sbGVjdGlvbj1uZXcgbyx0aGlzLnByZXZpZXdMaXN0Vmlldz1uZXcgYyh7Y29sbGVjdGlvbjp0aGlzLmNvbGxlY3Rpb24scGFyYW1zOnQucGFyYW1zLHBhcnNlOnRoaXMucGFyc2UscHJldmlld1RlbXBsYXRlOnRoaXMucHJldmlld1RlbXBsYXRlfSksdGhpcy5maWxlVXBsb2FkSW5wdXQuc2V0Q29sbGVjdGlvbih0aGlzLmNvbGxlY3Rpb24pLHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCJ1cGRhdGUiLHRoaXMudXBkYXRlKSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwidXBkYXRlIix0aGlzLnJlc2l6ZSksdGhpcy4kZWwuYXBwZW5kKHRoaXMuZmlsZVVwbG9hZElucHV0LnJlbmRlcigpLmVsKSx0aGlzLiRlbC5hcHBlbmQodGhpcy5wcmV2aWV3TGlzdFZpZXcucmVuZGVyKCkuZWwpLHRoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0tY29udHJvbCBmaWxlLXVwbG9hZCBjbGVhcmZpeCIpfSxwcmV2aWV3RnJvbU1vZGVsOmZ1bmN0aW9uKCl7dGhpcy5jb2xsZWN0aW9uLnJlc2V0KCk7dmFyIGk9dGhpcy5nZXRNb2RlbFZhbHVlKCksbj10aGlzLmdldFBhcmFtKCJwcmV2aWV3RGF0YSIpLHI9dGhpcy5nZXRQYXJhbSgicHJldmlld0VuZHBvaW50Iikscz10aGlzLmNvbGxlY3Rpb247aWYoaSlpZihuKXMuc2V0KG4pO2Vsc2UgaWYocil7dmFyIG89ZS5pc1N0cmluZyhyKT9hLnRwbChyKTpyLGw9ZS5tYXAoZS5pc0FycmF5KGkpP2k6W2ldLGZ1bmN0aW9uKGUpe3JldHVybiB0LmdldChvKHtpZDplfSkpfSk7dC53aGVuLmFwcGx5KHQsbCkudGhlbihmdW5jdGlvbigpe3ZhciB0PTE9PWwubGVuZ3RoP2FyZ3VtZW50c1swXTplLnBsdWNrKGFyZ3VtZW50cywwKTtzLnNldCh0KX0pfX0sY2xlYXJFcnJvcjpmdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjbGVhci1lcnJvcjoiK3RoaXMub3B0aW9ucy5uYW1lKX0sYWRkRmlsZURhdGE6ZnVuY3Rpb24odCl7dmFyIGU9dSh0KTtlJiZ0aGlzLmNvbGxlY3Rpb24uYWRkKGUpfSxzaG93RXJyb3I6ZnVuY3Rpb24odCl7aWYodGhpcy5jbGVhckVycm9yKCksIXR8fDAhPT10LnN0YXR1c3x8ImFib3J0IiE9dC5zdGF0dXNUZXh0KXt2YXIgaTtpZihlLmlzU3RyaW5nKHQpKWk9dDtlbHNle3ZhciBuPXMuZ2V0UmVzcG9uc2VKU09OKHQpO2k9biYmbi5lcnJvclN1bW1hcnl8fG8ubG9jYWxpemUoIm9mb3JtLmZpbGUudXBsb2FkLmVycm9yIil9dmFyIHI9e307clt0aGlzLm9wdGlvbnMubmFtZV09aSx0aGlzLm1vZGVsLnRyaWdnZXIoImludmFsaWQiLHRoaXMubW9kZWwsciwhMSl9fSxlZGl0TW9kZTpmdW5jdGlvbigpe3RoaXMucHJldmlld0Zyb21Nb2RlbCgpLHRoaXMuZmlsZVVwbG9hZElucHV0LnRvZ2dsZSghMCl9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdE1vZGUoKX0sdmFsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jb2xsZWN0aW9uLnBsdWNrKHRoaXMuZ2V0UGFyYW1PckF0dHJpYnV0ZSgiaWRBdHRyaWJ1dGUiKSk7cmV0dXJuIHRoaXMuZ2V0UGFyYW0oIm11bHRpIik/dDp0WzBdfSxmb2N1czpmdW5jdGlvbigpe3RoaXMuZmlsZVVwbG9hZElucHV0LmZvY3VzKCl9LHZhbGlkYXRlOmUubm9vcH0se3BhcnNlSlNPTjp1fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKV0scj1mdW5jdGlvbih0KXtyZXR1cm57Z2V0UmVzcG9uc2VKU09OOmZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4gdC5yZXNwb25zZUpTT058fEpTT04ucGFyc2UodC5yZXNwb25zZVRleHQpfWNhdGNoKGUpe3JldHVybn19LHBhcnNlRXJyb3JTdW1tYXJ5OmZ1bmN0aW9uKHQpe3ZhciBlPXQubWF0Y2goL14oW15cOl0rKVw6ICguKykkLyk7aWYoZSlyZXR1cm5bZVsxXSxlWzJdXX0scGFyc2VGaWVsZEVycm9yczpmdW5jdGlvbihlKXt2YXIgaT10aGlzLmdldFJlc3BvbnNlSlNPTihlKSxuPXt9O3JldHVybiBpP3QuZWFjaChpLmVycm9yQ2F1c2VzfHxbXSxmdW5jdGlvbih0KXt2YXIgZT10aGlzLnBhcnNlRXJyb3JTdW1tYXJ5KHQmJnQuZXJyb3JTdW1tYXJ5fHwiIik7aWYoZSl7dmFyIGk9ZVswXSxyPWVbMV07bltpXXx8KG5baV09W10pLG5baV0ucHVzaChyKX19LHRoaXMpOnQuaXNPYmplY3QoZSkmJnQuc2l6ZShlKSYmdC5lYWNoKGUsZnVuY3Rpb24odCxlKXtuW2VdPVt0XX0pLHQuc2l6ZShuKT9uOnZvaWQgMH19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDE0NiksaSgxNDQpLGkoMTc3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe2Z1bmN0aW9uIHModCl7cmV0dXJuKHR8fFtdKS5qb2luKCIsIil9cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImZpbGUtdXBsb2FkLXdyYXAiLHRlbXBsYXRlOidcdCAgICAgIDxzcGFuIGNsYXNzPSJmaWxlLXVwbG9hZC1wcm9ncmVzcy1pbmRpY2F0b3Itd3JhcCBpbnB1dC1maXggby1mb3JtLWNvbnRyb2wgaGlkZSI+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJmaWxlLXVwbG9hZC1wcm9ncmVzcy1pbmRpY2F0b3IiPjwvc3Bhbj5cdCAgICAgICAgPGRpdiBjbGFzcz0iZmlsZS11cGxvYWQtY2FuY2VsIGZpbGUtdXBsb2FkLXVwbG9hZGluZyI+PC9kaXY+XHQgICAgICA8L3NwYW4+XHQgICAgICA8ZGl2IGNsYXNzPSJmYWNhZGUiPlx0ICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZpbGUtbmFtZS10ZXh0LWZpZWxkIiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBcdCAgICAgICAgICAgICAgIHRpdGxlPSJ7e2Jyb3dzZUZpbGVzVGl0bGV9fSIgcmVhZG9ubHk+XHQgICAgICAgIDxhIHRpdGxlPSJ7e2Jyb3dzZUZpbGVzVGl0bGV9fSIgY2xhc3M9ImJyb3dzZS1maWxlLWJ1dHRvbiBsaW5rLWJ1dHRvbiIgaHJlZj0iIyI+e3ticm93c2VGaWxlc1RpdGxlfX08L2E+XHQgICAgICA8L2Rpdj5cdCAgICAgIDxkaXYgY2xhc3M9Im8tZm9ybS1leHBsYWluIGhpZGUiPjwvZGl2Plx0ICAgICAgPGlucHV0IHR5cGU9ImZpbGUiIGNsYXNzPSJtLWZpbGUgaGlkZSJ7eyNpZiBhY2NlcHR9fSBhY2NlcHQ9Int7YWNjZXB0fX0ie3svaWZ9fVx0ICAgICAgICAgICAgIHt7I2lmIG11bHRpcGxlfX0gbXVsdGlwbGU9Im11bHRpcGxlInt7L2lmfX0+XHQgICAgJyxldmVudHM6eyJjbGljayAuZmlsZS11cGxvYWQtY2FuY2VsIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLmFib3J0UmVxdWVzdCgpLHRoaXMucmVuZGVyKCl9LCJjbGljayAuZmFjYWRlIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLmJyb3dzZUZpbGVzKCl9LCJjaGFuZ2UgLm0tZmlsZSI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksdGhpcy5tYWtlUmVxdWVzdCh0LnRhcmdldC5maWxlcyl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7ZS5iaW5kQWxsKHRoaXMsIm9uUHJvZ3Jlc3MiLCJvblByb2dyZXNzQ29tcGxldGUiKSx0aGlzLm9uU3VjY2Vzcz1lLmRlYm91bmNlKHRoaXMub25TdWNjZXNzLDFlMyksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6X19lZGl0X18iLHRoaXMucmVuZGVyKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2Jyb3dzZUZpbGVzVGl0bGU6ci5sb2NhbGl6ZSgib2Zvcm0uYnJvd3NlLmZpbGVzIiksYWNjZXB0OnModGhpcy5vcHRpb25zLmZpbGVUeXBlcyksbXVsdGlwbGU6dGhpcy5vcHRpb25zLm11bHRpLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcn19LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmRlbGVnYXRlRXZlbnRzKCl9LGJyb3dzZUZpbGVzOmZ1bmN0aW9uKCl7dGhpcy4kKCIubS1maWxlIikudmFsKCIiKS5jbGljaygpLGUuZGVsYXkoZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoImNsZWFyIil9LmJpbmQodGhpcyksMmUzKX0sc2V0Q29sbGVjdGlvbjpmdW5jdGlvbih0KXt0aGlzLmNvbGxlY3Rpb249dGhpcy5vcHRpb25zLmNvbGxlY3Rpb249dCx0aGlzLmxpc3RlblRvKHQsInVwZGF0ZSIsZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZSgwPT09dC5sZW5ndGgpfSl9LHNldEZpbGVOYW1lOmZ1bmN0aW9uKHQpe3RoaXMuJCgiLmZpbGUtbmFtZS10ZXh0LWZpZWxkIikudmFsKHR8fCIiKSx0aGlzLiQoIi5maWxlLXVwbG9hZC1wcm9ncmVzcy1pbmRpY2F0b3IiKS5odG1sKHR8fCIiKX0sc3RhcnRVcGxvYWRpbmc6ZnVuY3Rpb24odCl7dGhpcy4kKCIuZmlsZS11cGxvYWQtcHJvZ3Jlc3MtaW5kaWNhdG9yLXdyYXAiKS5yZW1vdmVDbGFzcygiaGlkZSIpLHRoaXMuJCgiLmZpbGUtdXBsb2FkLXByb2dyZXNzLWluZGljYXRvciIpLmNzcygid2lkdGgiLCIwcHgiKSx0aGlzLiQoIi5mYWNhZGUiKS5oaWRlKCksdGhpcy4kKCIuZmlsZS11cGxvYWQtY2FuY2VsIikuc2hvdygpLHRoaXMuc2V0RmlsZU5hbWUodCl9LG1ha2VSZXF1ZXN0OmZ1bmN0aW9uKHQpe2lmKDA9PT10Lmxlbmd0aClyZXR1cm4gdm9pZCBuLndhcm4oIk5vIGZpbGVzIGhhdmUgYmVlbiBzZWxlY3RlZC4iKTt2YXIgaT1lLnBsdWNrKHQsIm5hbWUiKS5qb2luKCIsICIpLHM9dGhpcy5nZXRNYXhJdGVtcygpO3JldHVybiB0Lmxlbmd0aCt0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoPnM/dm9pZCB0aGlzLnRyaWdnZXIoImVycm9yIixyLmxvY2FsaXplKCJvZm9ybS5maWxlLnVwbG9hZC50b28ubWFueS5maWxlcyIsIm1lc3NhZ2VzIixbc10pKToodGhpcy50cmlnZ2VyKCJjbGVhciIpLHRoaXMuc3RhcnRVcGxvYWRpbmcoaSksdm9pZCB0aGlzLnNlbmRVcGxvYWRSZXF1ZXN0KHQpLmRvbmUoZS5iaW5kKHRoaXMub25TdWNjZXNzLHRoaXMpKS5mYWlsKGUuYmluZCh0aGlzLm9uRmFpbHVyZSx0aGlzKSkpfSxzZW5kVXBsb2FkUmVxdWVzdDpmdW5jdGlvbihpKXt2YXIgbj10aGlzLHI9bmV3IEZvcm1EYXRhLHM9dGhpcy5vcHRpb25zLmZpbGVGaWVsZE5hbWU7ZS5lYWNoKGksZnVuY3Rpb24odCl7ci5hcHBlbmQocyx0KX0pLHIuYXBwZW5kKCJfeHNyZlRva2VuIix0KCIjX3hzcmZUb2tlbiIpLnRleHQoKSk7dmFyIG89e3VybDp0aGlzLm9wdGlvbnMuZW5kcG9pbnQsbWV0aG9kOiJQT1NUIixkYXRhOnIseGhyOmZ1bmN0aW9uKCl7dmFyIGU9dC5hamF4U2V0dGluZ3MueGhyKCk7cmV0dXJuIGUudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoInByb2dyZXNzIixuLm9uUHJvZ3Jlc3MsITEpLGUudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLG4ub25Qcm9ncmVzc0NvbXBsZXRlLCExKSxlfSxwcm9jZXNzRGF0YTohMSxjb250ZW50VHlwZTohMX07cmV0dXJuIHRoaXMuX3hocj10LmFqYXgobyksdGhpcy5feGhyfSxhYm9ydFJlcXVlc3Q6ZnVuY3Rpb24oKXtuLndhcm4oIlVwbG9hZCBhYm9ydGVkLi4uIiksdGhpcy5feGhyJiZ0aGlzLl94aHIuYWJvcnQoKX0sb25Qcm9ncmVzczpmdW5jdGlvbih0KXtpZih0Lmxlbmd0aENvbXB1dGFibGUpe3ZhciBlPU1hdGgucm91bmQoMTAwKnQubG9hZGVkL3QudG90YWwpO3JldHVybiBuLmluZm8oIlVwbG9hZCBpbiBwcm9ncmVzcy4uLiIsZSsiJSIpLHRoaXMuJCgiLmZpbGUtdXBsb2FkLXByb2dyZXNzLWluZGljYXRvciIpLmNzcygid2lkdGgiLGUrIiUiKSxlfX0sb25Qcm9ncmVzc0NvbXBsZXRlOmZ1bmN0aW9uKCl7bi5pbmZvKCJVcGxvYWQgY29tcGxldGUsIHByb2Nlc3NpbmcuLi4iKSx0aGlzLiQoIi5maWxlLXVwbG9hZC1jYW5jZWwiKS5mYWRlT3V0KCl9LG9uU3VjY2VzczpmdW5jdGlvbih0KXtuLmluZm8oIlVwbG9hZCBwcm9jZXNzaW5nIGNvbXBsZXRlLi4uIiksdGhpcy4kKCIuZmlsZS11cGxvYWQtcHJvZ3Jlc3MtaW5kaWNhdG9yLXdyYXAiKS5hZGRDbGFzcygiaGlkZSIpLHRoaXMudG9nZ2xlKCExKSx0aGlzLnRyaWdnZXIoInN1Y2Nlc3MiLHQpfSxvbkZhaWx1cmU6ZnVuY3Rpb24odCl7bi53YXJuKCJVcGxvYWQgZmFpbGVkLi4uIiksdGhpcy5zZXRGaWxlTmFtZSgpLHRoaXMuJCgiLmZpbGUtdXBsb2FkLXByb2dyZXNzLWluZGljYXRvci13cmFwIikuYWRkQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5mYWNhZGUiKS5zaG93KCksdGhpcy50b2dnbGUoITApLHRoaXMudHJpZ2dlcigiZXJyb3IiLHQpfSx0b2dnbGU6ZnVuY3Rpb24odCl7dGhpcy4kZWwuYWRkQ2xhc3MoImhpZGUiKTt2YXIgZT10O3JldHVybiB0aGlzLm9wdGlvbnMubXVsdGk/ZT10aGlzLmNvbGxlY3Rpb24ubGVuZ3RoPHRoaXMuZ2V0TWF4SXRlbXMoKTp0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoPjAmJihlPSExKSxlJiZ0aGlzLnJlbmRlcigpLiRlbC5yZW1vdmVDbGFzcygiaGlkZSIpLGV9LGZvY3VzOmZ1bmN0aW9uKCl7dGhpcy4kKCIuZmFjYWRlIikuZm9jdXMoKX0sZ2V0TWF4SXRlbXM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm1vZGVsLmdldFByb3BlcnR5U2NoZW1hKHRoaXMub3B0aW9ucy5uYW1lKXx8e307cmV0dXJuIHQubWF4SXRlbXN8fDEvMH19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KSxpKDE5MildLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4oaSl7ZnVuY3Rpb24gbihlKXt2YXIgbj0oaS5wYXJhbXMmJmkucGFyYW1zLnBhcnNlfHx0LmlkZW50aXR5KS5jYWxsKG51bGwsZSk7cmV0dXJuKGkucGFyc2V8fHQuaWRlbnRpdHkpLmNhbGwobnVsbCxuKX1yZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiZmlsZS11cGxvYWQtcHJldmlldyIsZXZlbnRzOnsiY2xpY2sgLmZpbGUtdXBsb2FkLWNhbmNlbCI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksdGhpcy5jb2xsZWN0aW9uLnJlbW92ZSh0aGlzLm1vZGVsKX19LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBlPW4odGhpcy5tb2RlbC50b0pTT04oKSksaT1bdC5vbWl0KGUsImNoYWluIildLmNvbmNhdCgoZS5jaGFpbnx8W10pLm1hcChuKSk7cmV0dXJuIHQuZXh0ZW5kKHt9LGUse2NlcnROYW1lczp0LnBsdWNrKGksImNlcnROYW1lIikuam9pbigiID4gIiksbXVsdGlJdGVtczppLmxlbmd0aD4xLGl0ZW1zOmkubWFwKGZ1bmN0aW9uKGUpe3JldHVybiB0LmV4dGVuZCh7fSxlLHttdWx0aUl0ZW1zOmkubGVuZ3RoPjF9KX0pfSl9LHRlbXBsYXRlOmkucHJldmlld1RlbXBsYXRlLHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLiRlbC5wcmVwZW5kKCc8ZGl2IGNsYXNzPSJmaWxlLXVwbG9hZC1jYW5jZWwiPjwvZGl2PicpLHRoaXMuZGVsZWdhdGVFdmVudHMoKX19KX1yZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiZmlsZS11cGxvYWQtcHJldmlldy13cmFwIixjb25zdHJ1Y3RvcjpmdW5jdGlvbih0KXt0aGlzLml0ZW09bih0KSxpLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgzNiksaSgxNzcpLGkoMjI0KV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe3JldHVybiByLmV4dGVuZCh7Y2xhc3NOYW1lOiJjZXJ0LWZpbGUtdXBsb2FkIixldmVudHM6eyJjbGljayAuY2VydC1leHBhbmQtZGV0YWlscyI6ZnVuY3Rpb24oZSl7ZSYmZS5wcmV2ZW50RGVmYXVsdCgpO3ZhciBpPXRoaXMscj10KGUudGFyZ2V0KS5zaWJsaW5ncygiLmNlcnQtZGV0YWlscyIpLHM9NzUqci5sZW5ndGgsbz1mdW5jdGlvbigpe2kubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX07ci5pcygiOmhpZGRlbiIpfHxyLmhhc0NsYXNzKCJoaWRlIik/KHIucmVtb3ZlQ2xhc3MoImhpZGUiKS5oaWRlKCkuc2xpZGVEb3duKHMsbyksdChlLnRhcmdldCkudGV4dChuLmxvY2FsaXplKCJvZm9ybS5jZXJ0aWZpY2F0ZS5oaWRlLmNoYWluIikpKTooci5zbGlkZVVwKHMsbyksdChlLnRhcmdldCkudGV4dChuLmxvY2FsaXplKCJvZm9ybS5jZXJ0aWZpY2F0ZS52aWV3LmNoYWluIikpKX19LHBhcnNlOmZ1bmN0aW9uKHQpe3ZhciBuPWUuY2xvbmUodHx8e30pO2lmKG4ubm90QWZ0ZXIpe3ZhciByPWkudXRjKG4ubm90QWZ0ZXIpLmRpZmYoaS51dGMoKSwiZGF5cyIpO3I+MCYmZS5leHRlbmQobix7ZXhwaXJlc0luRGF5czpyfSkscjwxNCYmKG4uZXhwaXJlQ2xhc3M9ImNlcnQtZXhwaXJlZCIpfXJldHVybiBufSxwcmV2aWV3VGVtcGxhdGU6J1x0ICAgICAgPGRpdiBjbGFzcz0iY2VydC10aHVtYm5haWwiPjxzcGFuIGNsYXNzPSJpY29uIGljb24tMzIgaWNvbi1vbmx5IGZpbGUtY2VydC0zMiI+PC9zcGFuPjwvZGl2Plx0ICAgICAgPHVsIGNsYXNzPSJjZXJ0LWRldGFpbHMtaGVhZGVyIj5cdCAgICAgICAge3sjaWYgY2VydE5hbWVzfX08bGkgY2xhc3M9ImNlcnQtbmFtZXMiPnt7Y2VydE5hbWVzfX08L2xpPnt7L2lmfX1cdCAgICAgICAge3sjaWYgdXBsb2FkZWRCeX19e3sjaWYgdXBsb2FkZWRPbn19XHQgICAgICAgIDxsaSBjbGFzcz0iY2VydC11cGxvYWQtaW5mbyI+XHQgICAgICAgICAge3tpMThuIGNvZGU9Im9mb3JtLmNlcnRpZmljYXRlLnVwbG9hZGVkIiBidW5kbGU9Im1lc3NhZ2VzIiBhcmd1bWVudHM9InVwbG9hZGVkQnk7dXBsb2FkZWRPbiJ9fSBcdCAgICAgICAgPC9saT5cdCAgICAgICAge3svaWZ9fXt7L2lmfX1cdCAgICAgIDwvdWw+XHQgICAgICB7eyNlYWNoIGl0ZW1zfX1cdCAgICAgICAgPHVsIGNsYXNzPSJjZXJ0LWRldGFpbHN7eyNpZiBtdWx0aUl0ZW1zfX0gaGlkZXt7L2lmfX0iPlx0ICAgICAgICAgIHt7I2lmIG11bHRpSXRlbXN9fXt7I2lmIGNlcnROYW1lfX1cdCAgICAgICAgICAgIDxsaSBjbGFzcz0iY2VydC1uYW1lIj57e2NlcnROYW1lfX08L2xpPlx0ICAgICAgICAgIHt7L2lmfX17ey9pZn19XHQgICAgICAgICAge3sjaWYgaXNzdWVyfX08bGkgY2xhc3M9ImNlcnQtaXNzdWVyIj57e2lzc3Vlcn19PC9saT57ey9pZn19XHQgICAgICAgICAge3sjaWYgbm90QmVmb3JlfX17eyNpZiBub3RBZnRlcn19XHQgICAgICAgICAgICA8bGkgY2xhc3M9ImNlcnQtdmFsaWQtZGF0ZSI+XHQgICAgICAgICAgICAgIHt7aTE4biBjb2RlPSJvZm9ybS5jZXJ0aWZpY2F0ZS52YWxpZCIgYnVuZGxlPSJtZXNzYWdlcyIgYXJndW1lbnRzPSJub3RCZWZvcmU7bm90QWZ0ZXIifX1cdCAgICAgICAgICAgIDwvbGk+XHQgICAgICAgICAge3svaWZ9fXt7L2lmfX1cdCAgICAgICAgICA8bGkgY2xhc3M9ImNlcnQtZXhwaXJhdGlvbiB7e2V4cGlyZUNsYXNzfX0iPlx0ICAgICAgICAgICAge3sjaWYgZXhwaXJlc0luRGF5c319XHQgICAgICAgICAgICB7e2kxOG4gY29kZT0ib2Zvcm0uY2VydGlmaWNhdGUuZXhwaXJlcyIgYnVuZGxlPSJtZXNzYWdlcyIgYXJndW1lbnRzPSJleHBpcmVzSW5EYXlzIn19XHQgICAgICAgICAgICB7e2Vsc2V9fVx0ICAgICAgICAgICAge3tpMThuIGNvZGU9Im9mb3JtLmNlcnRpZmljYXRlLmV4cGlyZWQiIGJ1bmRsZT0ibWVzc2FnZXMifX1cdCAgICAgICAgICAgIHt7L2lmfX1cdCAgICAgICAgICA8L2xpPlx0ICAgICAgICA8L3VsPlx0ICAgICAge3svZWFjaH19XHQgICAgICB7eyNpZiBtdWx0aUl0ZW1zfX1cdCAgICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImNlcnQtZXhwYW5kLWRldGFpbHMiPnt7aTE4biBjb2RlPSJvZm9ybS5jZXJ0aWZpY2F0ZS52aWV3LmNoYWluIn19PC9hPlx0ICAgICAge3svaWZ9fVx0ICAgICAgJyxmaWxlVHlwZXM6WyIuY3J0IiwiLnBlbSJdfSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NyksaSgyMDMpLGkoMTM5KV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49ZS50cGwoJ1x0ICAgIDxwIGNsYXNzPSJkcm9wZG93bi1mb290ZXIiPnt7aTE4biBjb2RlPSJvZm9ybS5zZWxlY3QuZHJvcGRvd24uZm9vdGVyIiBhcmd1bWVudHM9Im51bSJ9fTwvcD5cdCAgJykscj1lLnRwbCgnXHQgICAgPHAgY2xhc3M9ImRyb3Bkb3duLWZvb3RlciI+e3tpMThuIGNvZGU9Im9mb3JtLmJhc2VzZWxlY3Qubm9yZXN1bHRzIn19PC9wPlx0ICAnKSgpO3JldHVybiBpLmV4dGVuZCh7dGVtcGxhdGU6ZS50cGwoJzxzZWxlY3QgaWQ9Int7aW5wdXRJZH19IiBuYW1lPSJ7e25hbWV9fSI+PC9zZWxlY3Q+JyksY2xhc3NOYW1lOiJvLWZvcm0tc2VhcmNoYWJsZS1zZWxlY3QiLG1heE9wdGlvbnM6NTAsZXZlbnRzOnsiY2hhbmdlIHNlbGVjdCI6InVwZGF0ZSJ9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7aS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5zZWxlY3RPcHRpb25zPXRoaXMuX19nZXRPcHRpb25zKHRoaXMub3B0aW9ucy5vcHRpb25zKX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7bC4kKCIuZHJvcGRvd24tZm9vdGVyIikucmVtb3ZlKCksdC5kZWZlcihmdW5jdGlvbigpe3ZhciB0PWwuJCgiLnNlbGVjdGl6ZS1kcm9wZG93bi1jb250ZW50ID4gLm9wdGlvbiIpLmxlbmd0aDt0PT09bz9sLiQoIi5zZWxlY3RpemUtZHJvcGRvd24tY29udGVudCIpLmFwcGVuZChuKHtudW06b30pKTowPT09dCYmKGwuJCgiLnNlbGVjdGl6ZS1kcm9wZG93bi1jb250ZW50IikuYXBwZW5kKHIpLGwuJCgiLnNlbGVjdGl6ZS1kcm9wZG93bi5zaW5nbGUiKS5zaG93KCkpfSl9aS5wcm90b3R5cGUuZWRpdE1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBzPXRoaXMuZ2V0TW9kZWxWYWx1ZSgpLG89dGhpcy5nZXRQYXJhbU9yQXR0cmlidXRlKCJtYXhPcHRpb25zIiksYT10aGlzLnNlbGVjdE9wdGlvbnMsbD10aGlzO3JldHVybiB0aGlzLiRzZWxlY3Q9dGhpcy4kKCJzZWxlY3QiKSx0aGlzLiRzZWxlY3Quc2VsZWN0aXplKHtvcHRpb25zOmEsaXRlbXM6cz9bc106W10scGxhY2Vob2xkZXI6dGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyLHByZWxvYWQ6ITAsY3JlYXRlOiExLG1heE9wdGlvbnM6byxtYXhJdGVtczoxLGxhYmVsRmllbGQ6InZhbHVlIix2YWx1ZUZpZWxkOiJrZXkiLHNlYXJjaEZpZWxkOlsidmFsdWUiXSxvblR5cGU6ZSxvbkRyb3Bkb3duT3BlbjplfSksdGhpc30sdmFsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJHNlbGVjdCYmdGhpcy4kc2VsZWN0LnZhbCgpfSxmb2N1czpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRzZWxlY3QmJnRoaXMuJHNlbGVjdC5mb2N1cygpfSxfX2dldE9wdGlvbnM6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuaXNGdW5jdGlvbihlKSYmKGU9ZS5jYWxsKHRoaXMpKSx0Lm1hcCh0LmlzT2JqZWN0KGUpP2U6e30sZnVuY3Rpb24odCxlKXtyZXR1cm57a2V5OmUsdmFsdWU6dH19KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDE0NiksaSgyMzEpXSxyPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToib2t0YS1mb3JtLWxhYmVsIG8tZm9ybS1sYWJlbCIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJvLWZvcm0tbGFiZWwifSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihuKXt0LmRlZmF1bHRzKG4se2lucHV0SWQ6bi5pZH0pLGRlbGV0ZSBuLmlkLGkuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciByO3I9dGhpcy5faXNMYWJlbFZpZXcobi5sYWJlbCk/JzxsYWJlbCBmb3I9Int7aW5wdXRJZH19Ij48L2xhYmVsPic6dC5jb250YWlucyhbInJhZGlvIiwiY2hlY2tib3giXSxuLnR5cGUpfHwhbi5sYWJlbD8ie3tsYWJlbH19IjonPGxhYmVsIGZvcj0ie3tpbnB1dElkfX0iPnt7bGFiZWx9fSZuYnNwOzwvbGFiZWw+JyxuLnN1YmxhYmVsJiYocis9JzxzcGFuIGNsYXNzPSJvLWZvcm0tZXhwbGFpbiI+e3tzdWJsYWJlbH19PC9zcGFuPicpLG4udG9vbHRpcCYmKHQuaXNTdHJpbmcobi50b29sdGlwKSYmKG4udG9vbHRpcD17dGV4dDpuLnRvb2x0aXB9KSxyKz0nPHNwYW4gY2xhc3M9Im8tZm9ybS10b29sdGlwIGljb24tMTYgaWNvbi1vbmx5IGZvcm0taGVscC0xNiIgdGl0bGU9Int7dG9vbHRpcC50ZXh0fX0iPjwvc3Bhbj4nKSx0aGlzLnRlbXBsYXRlPWUudHBsKHIpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgZT17bGFiZWw6IiJ9O3JldHVybiB0LmVhY2goWyJpbnB1dElkIiwibGFiZWwiLCJzdWJsYWJlbCIsInRvb2x0aXAiXSxmdW5jdGlvbihpKXtlW2ldPXQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucyxpLHRoaXMpfSx0aGlzKSxlfSxfaXNMYWJlbFZpZXc6ZnVuY3Rpb24oZSl7cmV0dXJuIXQuaXNVbmRlZmluZWQoZSkmJmUgaW5zdGFuY2VvZiBpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRUZW1wbGF0ZURhdGEoKTt0aGlzLl9pc0xhYmVsVmlldyhlLmxhYmVsKSYmKHRoaXMucmVtb3ZlQ2hpbGRyZW4oKSx0aGlzLmFkZChlLmxhYmVsLCJsYWJlbCIpKSxlLnRvb2x0aXAmJnRoaXMuJCgiLm8tZm9ybS10b29sdGlwIikucXRpcCh0LmV4dGVuZCh7c3R5bGU6e2NsYXNzZXM6InF0aXAtY3VzdG9tIHF0aXAtc2hhZG93In0scG9zaXRpb246e215OiJib3R0b20gbGVmdCIsYXQ6InRvcCBjZW50ZXIifSxoaWRlOntmaXhlZDohMH0sc2hvdzp7ZGVsYXk6MH19LGUudG9vbHRpcC5vcHRpb25zKSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIsczsvKgoJCSAqIHFUaXAyIC0gUHJldHR5IHBvd2VyZnVsIHRvb2x0aXBzIC0gdjMuMC4zLTUtZwoJCSAqIGh0dHA6Ly9xdGlwMi5jb20KCQkgKgoJCSAqIENvcHlyaWdodCAoYykgMjAxNyAKCQkgKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VzCgkJICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQoJCSAqCgkJICogRGF0ZTogV2VkIE1heSAyNCAyMDE3IDAxOjIyIFVUQyswMDAwCgkJICogUGx1Z2luczogdGlwcyBtb2RhbCB2aWV3cG9ydCBzdmcgaW1hZ2VtYXAgaWU2CgkJICogU3R5bGVzOiBjb3JlIGJhc2ljIGNzczMKCQkgKi8KCSFmdW5jdGlvbihvLGEsbCl7IWZ1bmN0aW9uKG8peyJ1c2Ugc3RyaWN0IjtyPVtpKDYpXSxuPW8scz0iZnVuY3Rpb24iPT10eXBlb2Ygbj9uLmFwcGx5KGUscik6biwhKHMhPT1sJiYodC5leHBvcnRzPXMpKX0oZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUoZSxpLG4scil7dGhpcy5pZD1uLHRoaXMudGFyZ2V0PWUsdGhpcy50b29sdGlwPUMsdGhpcy5lbGVtZW50cz17dGFyZ2V0OmV9LHRoaXMuX2lkPXorIi0iK24sdGhpcy50aW1lcnM9e2ltZzp7fX0sdGhpcy5vcHRpb25zPWksdGhpcy5wbHVnaW5zPXt9LHRoaXMuY2FjaGU9e2V2ZW50Ont9LHRhcmdldDp0KCksZGlzYWJsZWQ6WSxhdHRyOnIsb25Ub29sdGlwOlksbGFzdENsYXNzOiIifSx0aGlzLnJlbmRlcmVkPXRoaXMuZGVzdHJveWVkPXRoaXMuZGlzYWJsZWQ9dGhpcy53YWl0aW5nPXRoaXMuaGlkZGVuRHVyaW5nV2FpdD10aGlzLnBvc2l0aW9uaW5nPXRoaXMudHJpZ2dlcmluZz1ZfWZ1bmN0aW9uIGkoZSl7cmV0dXJuIGU9PT1DfHwib2JqZWN0IiE9PXQudHlwZShlKX1mdW5jdGlvbiBuKGUpe3JldHVybiEodC5pc0Z1bmN0aW9uKGUpfHxlJiZlLmF0dHJ8fGUubGVuZ3RofHwib2JqZWN0Ij09PXQudHlwZShlKSYmKGUuanF1ZXJ5fHxlLnRoZW4pKX1mdW5jdGlvbiByKGUpe3ZhciByLHMsbyxhO3JldHVybiBpKGUpP1k6KGkoZS5tZXRhZGF0YSkmJihlLm1ldGFkYXRhPXt0eXBlOmUubWV0YWRhdGF9KSwiY29udGVudCJpbiBlJiYocj1lLmNvbnRlbnQsaShyKXx8ci5qcXVlcnl8fHIuZG9uZT8ocz1uKHIpP1k6cixyPWUuY29udGVudD17dGV4dDpzfSk6cz1yLnRleHQsImFqYXgiaW4gciYmKG89ci5hamF4LGE9byYmby5vbmNlIT09WSxkZWxldGUgci5hamF4LHIudGV4dD1mdW5jdGlvbihlLGkpe3ZhciBuPXN8fHQodGhpcykuYXR0cihpLm9wdGlvbnMuY29udGVudC5hdHRyKXx8IkxvYWRpbmcuLi4iLHI9dC5hamF4KHQuZXh0ZW5kKHt9LG8se2NvbnRleHQ6aX0pKS50aGVuKG8uc3VjY2VzcyxDLG8uZXJyb3IpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHQmJmEmJmkuc2V0KCJjb250ZW50LnRleHQiLHQpLHR9LGZ1bmN0aW9uKHQsZSxuKXtpLmRlc3Ryb3llZHx8MD09PXQuc3RhdHVzfHxpLnNldCgiY29udGVudC50ZXh0IixlKyI6ICIrbil9KTtyZXR1cm4gYT9uOihpLnNldCgiY29udGVudC50ZXh0IixuKSxyKX0pLCJ0aXRsZSJpbiByJiYodC5pc1BsYWluT2JqZWN0KHIudGl0bGUpJiYoci5idXR0b249ci50aXRsZS5idXR0b24sci50aXRsZT1yLnRpdGxlLnRleHQpLG4oci50aXRsZXx8WSkmJihyLnRpdGxlPVkpKSksInBvc2l0aW9uImluIGUmJmkoZS5wb3NpdGlvbikmJihlLnBvc2l0aW9uPXtteTplLnBvc2l0aW9uLGF0OmUucG9zaXRpb259KSwic2hvdyJpbiBlJiZpKGUuc2hvdykmJihlLnNob3c9ZS5zaG93LmpxdWVyeT97dGFyZ2V0OmUuc2hvd306ZS5zaG93PT09RD97cmVhZHk6RH06e2V2ZW50OmUuc2hvd30pLCJoaWRlImluIGUmJmkoZS5oaWRlKSYmKGUuaGlkZT1lLmhpZGUuanF1ZXJ5P3t0YXJnZXQ6ZS5oaWRlfTp7ZXZlbnQ6ZS5oaWRlfSksInN0eWxlImluIGUmJmkoZS5zdHlsZSkmJihlLnN0eWxlPXtjbGFzc2VzOmUuc3R5bGV9KSx0LmVhY2goQixmdW5jdGlvbigpe3RoaXMuc2FuaXRpemUmJnRoaXMuc2FuaXRpemUoZSl9KSxlKX1mdW5jdGlvbiBzKHQsZSl7Zm9yKHZhciBpLG49MCxyPXQscz1lLnNwbGl0KCIuIik7cj1yW3NbbisrXV07KW48cy5sZW5ndGgmJihpPXIpO3JldHVybltpfHx0LHMucG9wKCldfWZ1bmN0aW9uIGModCxlKXt2YXIgaSxuLHI7Zm9yKGkgaW4gdGhpcy5jaGVja3MpaWYodGhpcy5jaGVja3MuaGFzT3duUHJvcGVydHkoaSkpZm9yKG4gaW4gdGhpcy5jaGVja3NbaV0pdGhpcy5jaGVja3NbaV0uaGFzT3duUHJvcGVydHkobikmJihyPW5ldyBSZWdFeHAobiwiaSIpLmV4ZWModCkpJiYoZS5wdXNoKHIpLCgiYnVpbHRpbiI9PT1pfHx0aGlzLnBsdWdpbnNbaV0pJiZ0aGlzLmNoZWNrc1tpXVtuXS5hcHBseSh0aGlzLnBsdWdpbnNbaV18fHRoaXMsZSkpfWZ1bmN0aW9uIHUodCl7cmV0dXJuIHEuY29uY2F0KCIiKS5qb2luKHQ/Ii0iK3QrIiAiOiIgIil9ZnVuY3Rpb24gZChlLGkpe3JldHVybiBpPjA/c2V0VGltZW91dCh0LnByb3h5KGUsdGhpcyksaSk6dm9pZCBlLmNhbGwodGhpcyl9ZnVuY3Rpb24gaCh0KXt0aGlzLnRvb2x0aXAuaGFzQ2xhc3ModHQpfHwoY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnNob3cpLGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5oaWRlKSx0aGlzLnRpbWVycy5zaG93PWQuY2FsbCh0aGlzLGZ1bmN0aW9uKCl7dGhpcy50b2dnbGUoRCx0KX0sdGhpcy5vcHRpb25zLnNob3cuZGVsYXkpKX1mdW5jdGlvbiBwKGUpe2lmKCF0aGlzLnRvb2x0aXAuaGFzQ2xhc3ModHQpJiYhdGhpcy5kZXN0cm95ZWQpe3ZhciBpPXQoZS5yZWxhdGVkVGFyZ2V0KSxuPWkuY2xvc2VzdChHKVswXT09PXRoaXMudG9vbHRpcFswXSxyPWlbMF09PT10aGlzLm9wdGlvbnMuc2hvdy50YXJnZXRbMF07aWYoY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnNob3cpLGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5oaWRlKSx0aGlzIT09aVswXSYmIm1vdXNlIj09PXRoaXMub3B0aW9ucy5wb3NpdGlvbi50YXJnZXQmJm58fHRoaXMub3B0aW9ucy5oaWRlLmZpeGVkJiYvbW91c2Uob3V0fGxlYXZlfG1vdmUpLy50ZXN0KGUudHlwZSkmJihufHxyKSl0cnl7ZS5wcmV2ZW50RGVmYXVsdCgpLGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCl9Y2F0Y2gocyl7fWVsc2UgdGhpcy50aW1lcnMuaGlkZT1kLmNhbGwodGhpcyxmdW5jdGlvbigpe3RoaXMudG9nZ2xlKFksZSl9LHRoaXMub3B0aW9ucy5oaWRlLmRlbGF5LHRoaXMpfX1mdW5jdGlvbiBmKHQpeyF0aGlzLnRvb2x0aXAuaGFzQ2xhc3ModHQpJiZ0aGlzLm9wdGlvbnMuaGlkZS5pbmFjdGl2ZSYmKGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5pbmFjdGl2ZSksdGhpcy50aW1lcnMuaW5hY3RpdmU9ZC5jYWxsKHRoaXMsZnVuY3Rpb24oKXt0aGlzLmhpZGUodCl9LHRoaXMub3B0aW9ucy5oaWRlLmluYWN0aXZlKSl9ZnVuY3Rpb24gbSh0KXt0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXBbMF0ub2Zmc2V0V2lkdGg+MCYmdGhpcy5yZXBvc2l0aW9uKHQpfWZ1bmN0aW9uIF8oZSxpLG4pe3QoYS5ib2R5KS5kZWxlZ2F0ZShlLChpLnNwbGl0P2k6aS5qb2luKCIuIit6KyIgIikpKyIuIit6LGZ1bmN0aW9uKCl7dmFyIGU9VC5hcGlbdC5hdHRyKHRoaXMsJCldO2UmJiFlLmRpc2FibGVkJiZuLmFwcGx5KGUsYXJndW1lbnRzKX0pfWZ1bmN0aW9uIGcoaSxuLHMpe3ZhciBvLGwsYyx1LGQsaD10KGEuYm9keSkscD1pWzBdPT09YT9oOmksZj1pLm1ldGFkYXRhP2kubWV0YWRhdGEocy5tZXRhZGF0YSk6QyxtPSJodG1sNSI9PT1zLm1ldGFkYXRhLnR5cGUmJmY/ZltzLm1ldGFkYXRhLm5hbWVdOkMsXz1pLmRhdGEocy5tZXRhZGF0YS5uYW1lfHwicXRpcG9wdHMiKTt0cnl7Xz0ic3RyaW5nIj09dHlwZW9mIF8/dC5wYXJzZUpTT04oXyk6X31jYXRjaChnKXt9aWYodT10LmV4dGVuZChELHt9LFQuZGVmYXVsdHMscywib2JqZWN0Ij09dHlwZW9mIF8/cihfKTpDLHIobXx8ZikpLGw9dS5wb3NpdGlvbix1LmlkPW4sImJvb2xlYW4iPT10eXBlb2YgdS5jb250ZW50LnRleHQpe2lmKGM9aS5hdHRyKHUuY29udGVudC5hdHRyKSx1LmNvbnRlbnQuYXR0cj09PVl8fCFjKXJldHVybiBZO3UuY29udGVudC50ZXh0PWN9aWYobC5jb250YWluZXIubGVuZ3RofHwobC5jb250YWluZXI9aCksbC50YXJnZXQ9PT1ZJiYobC50YXJnZXQ9cCksdS5zaG93LnRhcmdldD09PVkmJih1LnNob3cudGFyZ2V0PXApLHUuc2hvdy5zb2xvPT09RCYmKHUuc2hvdy5zb2xvPWwuY29udGFpbmVyLmNsb3Nlc3QoImJvZHkiKSksdS5oaWRlLnRhcmdldD09PVkmJih1LmhpZGUudGFyZ2V0PXApLHUucG9zaXRpb24udmlld3BvcnQ9PT1EJiYodS5wb3NpdGlvbi52aWV3cG9ydD1sLmNvbnRhaW5lciksbC5jb250YWluZXI9bC5jb250YWluZXIuZXEoMCksbC5hdD1uZXcgTChsLmF0LEQpLGwubXk9bmV3IEwobC5teSksaS5kYXRhKHopKWlmKHUub3ZlcndyaXRlKWkucXRpcCgiZGVzdHJveSIsITApO2Vsc2UgaWYodS5vdmVyd3JpdGU9PT1ZKXJldHVybiBZO3JldHVybiBpLmF0dHIoVixuKSx1LnN1cHByZXNzJiYoZD1pLmF0dHIoInRpdGxlIikpJiZpLnJlbW92ZUF0dHIoInRpdGxlIikuYXR0cihpdCxkKS5hdHRyKCJ0aXRsZSIsIiIpLG89bmV3IGUoaSx1LG4sKCEhYykpLGkuZGF0YSh6LG8pLG99ZnVuY3Rpb24gdih0KXtyZXR1cm4gdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpfWZ1bmN0aW9uIHkodCxlKXt2YXIgaSxuLHI9ZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStlLnNsaWNlKDEpLHM9KGUrIiAiK3d0LmpvaW4ocisiICIpK3IpLnNwbGl0KCIgIiksbz0wO2lmKGJ0W2VdKXJldHVybiB0LmNzcyhidFtlXSk7Zm9yKDtpPXNbbysrXTspaWYoKG49dC5jc3MoaSkpIT09bClyZXR1cm4gYnRbZV09aSxufWZ1bmN0aW9uIGIodCxlKXtyZXR1cm4gTWF0aC5jZWlsKHBhcnNlRmxvYXQoeSh0LGUpKSl9ZnVuY3Rpb24gdyh0LGUpe3RoaXMuX25zPSJ0aXAiLHRoaXMub3B0aW9ucz1lLHRoaXMub2Zmc2V0PWUub2Zmc2V0LHRoaXMuc2l6ZT1bZS53aWR0aCxlLmhlaWdodF0sdGhpcy5xdGlwPXQsdGhpcy5pbml0KHQpfWZ1bmN0aW9uIE0odCxlKXt0aGlzLm9wdGlvbnM9ZSx0aGlzLl9ucz0iLW1vZGFsIix0aGlzLnF0aXA9dCx0aGlzLmluaXQodCl9ZnVuY3Rpb24gayh0KXt0aGlzLl9ucz0iaWU2Iix0aGlzLnF0aXA9dCx0aGlzLmluaXQodCl9dmFyIFQsUyxMLHgsRSxEPSEwLFk9ITEsQz1udWxsLEE9IngiLE89InkiLE49IndpZHRoIixJPSJoZWlnaHQiLFA9InRvcCIsUj0ibGVmdCIsSD0iYm90dG9tIixqPSJyaWdodCIsRj0iY2VudGVyIixVPSJmbGlwaW52ZXJ0IixXPSJzaGlmdCIsQj17fSx6PSJxdGlwIixWPSJkYXRhLWhhc3F0aXAiLCQ9ImRhdGEtcXRpcC1pZCIscT1bInVpLXdpZGdldCIsInVpLXRvb2x0aXAiXSxHPSIuIit6LEo9ImNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZWxlYXZlIG1vdXNlZW50ZXIiLnNwbGl0KCIgIiksSz16KyItZml4ZWQiLFE9eisiLWRlZmF1bHQiLFg9eisiLWZvY3VzIixaPXorIi1ob3ZlciIsdHQ9eisiLWRpc2FibGVkIixldD0iX3JlcGxhY2VkQnlxVGlwIixpdD0ib2xkdGl0bGUiLG50PXtpZTpmdW5jdGlvbigpe3ZhciB0LGU7Zm9yKHQ9NCxlPWEuY3JlYXRlRWxlbWVudCgiZGl2Iik7KGUuaW5uZXJIVE1MPSI8IS0tW2lmIGd0IElFICIrdCsiXT48aT48L2k+PCFbZW5kaWZdLS0+IikmJmUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImkiKVswXTt0Kz0xKTtyZXR1cm4gdD40P3Q6TmFOfSgpLGlPUzpwYXJzZUZsb2F0KCgiIisoL0NQVS4qT1MgKFswLTlfXXsxLDV9KXwoQ1BVIGxpa2UpLipBcHBsZVdlYktpdC4qTW9iaWxlL2kuZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KXx8WzAsIiJdKVsxXSkucmVwbGFjZSgidW5kZWZpbmVkIiwiM18yIikucmVwbGFjZSgiXyIsIi4iKS5yZXBsYWNlKCJfIiwiIikpfHxZfTtTPWUucHJvdG90eXBlLFMuX3doZW49ZnVuY3Rpb24oZSl7cmV0dXJuIHQud2hlbi5hcHBseSh0LGUpfSxTLnJlbmRlcj1mdW5jdGlvbihlKXtpZih0aGlzLnJlbmRlcmVkfHx0aGlzLmRlc3Ryb3llZClyZXR1cm4gdGhpczt2YXIgaT10aGlzLG49dGhpcy5vcHRpb25zLHI9dGhpcy5jYWNoZSxzPXRoaXMuZWxlbWVudHMsbz1uLmNvbnRlbnQudGV4dCxhPW4uY29udGVudC50aXRsZSxsPW4uY29udGVudC5idXR0b24sYz1uLnBvc2l0aW9uLHU9W107cmV0dXJuIHQuYXR0cih0aGlzLnRhcmdldFswXSwiYXJpYS1kZXNjcmliZWRieSIsdGhpcy5faWQpLHIucG9zQ2xhc3M9dGhpcy5fY3JlYXRlUG9zQ2xhc3MoKHRoaXMucG9zaXRpb249e215OmMubXksYXQ6Yy5hdH0pLm15KSx0aGlzLnRvb2x0aXA9cy50b29sdGlwPXQoIjxkaXYvPiIse2lkOnRoaXMuX2lkLCJjbGFzcyI6W3osUSxuLnN0eWxlLmNsYXNzZXMsci5wb3NDbGFzc10uam9pbigiICIpLHdpZHRoOm4uc3R5bGUud2lkdGh8fCIiLGhlaWdodDpuLnN0eWxlLmhlaWdodHx8IiIsdHJhY2tpbmc6Im1vdXNlIj09PWMudGFyZ2V0JiZjLmFkanVzdC5tb3VzZSxyb2xlOiJhbGVydCIsImFyaWEtbGl2ZSI6InBvbGl0ZSIsImFyaWEtYXRvbWljIjpZLCJhcmlhLWRlc2NyaWJlZGJ5Ijp0aGlzLl9pZCsiLWNvbnRlbnQiLCJhcmlhLWhpZGRlbiI6RH0pLnRvZ2dsZUNsYXNzKHR0LHRoaXMuZGlzYWJsZWQpLmF0dHIoJCx0aGlzLmlkKS5kYXRhKHosdGhpcykuYXBwZW5kVG8oYy5jb250YWluZXIpLmFwcGVuZChzLmNvbnRlbnQ9dCgiPGRpdiAvPiIseyJjbGFzcyI6eisiLWNvbnRlbnQiLGlkOnRoaXMuX2lkKyItY29udGVudCIsImFyaWEtYXRvbWljIjpEfSkpLHRoaXMucmVuZGVyZWQ9LTEsdGhpcy5wb3NpdGlvbmluZz1ELGEmJih0aGlzLl9jcmVhdGVUaXRsZSgpLHQuaXNGdW5jdGlvbihhKXx8dS5wdXNoKHRoaXMuX3VwZGF0ZVRpdGxlKGEsWSkpKSxsJiZ0aGlzLl9jcmVhdGVCdXR0b24oKSx0LmlzRnVuY3Rpb24obyl8fHUucHVzaCh0aGlzLl91cGRhdGVDb250ZW50KG8sWSkpLHRoaXMucmVuZGVyZWQ9RCx0aGlzLl9zZXRXaWRnZXQoKSx0LmVhY2goQixmdW5jdGlvbih0KXt2YXIgZTsicmVuZGVyIj09PXRoaXMuaW5pdGlhbGl6ZSYmKGU9dGhpcyhpKSkmJihpLnBsdWdpbnNbdF09ZSl9KSx0aGlzLl91bmFzc2lnbkV2ZW50cygpLHRoaXMuX2Fzc2lnbkV2ZW50cygpLHRoaXMuX3doZW4odSkudGhlbihmdW5jdGlvbigpe2kuX3RyaWdnZXIoInJlbmRlciIpLGkucG9zaXRpb25pbmc9WSxpLmhpZGRlbkR1cmluZ1dhaXR8fCFuLnNob3cucmVhZHkmJiFlfHxpLnRvZ2dsZShELHIuZXZlbnQsWSksaS5oaWRkZW5EdXJpbmdXYWl0PVl9KSxULmFwaVt0aGlzLmlkXT10aGlzLHRoaXN9LFMuZGVzdHJveT1mdW5jdGlvbihlKXtmdW5jdGlvbiBpKCl7aWYoIXRoaXMuZGVzdHJveWVkKXt0aGlzLmRlc3Ryb3llZD1EO3ZhciBlLGk9dGhpcy50YXJnZXQsbj1pLmF0dHIoaXQpO3RoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcC5zdG9wKDEsMCkuZmluZCgiKiIpLnJlbW92ZSgpLmVuZCgpLnJlbW92ZSgpLHQuZWFjaCh0aGlzLnBsdWdpbnMsZnVuY3Rpb24oKXt0aGlzLmRlc3Ryb3kmJnRoaXMuZGVzdHJveSgpfSk7Zm9yKGUgaW4gdGhpcy50aW1lcnMpdGhpcy50aW1lcnMuaGFzT3duUHJvcGVydHkoZSkmJmNsZWFyVGltZW91dCh0aGlzLnRpbWVyc1tlXSk7aS5yZW1vdmVEYXRhKHopLnJlbW92ZUF0dHIoJCkucmVtb3ZlQXR0cihWKS5yZW1vdmVBdHRyKCJhcmlhLWRlc2NyaWJlZGJ5IiksdGhpcy5vcHRpb25zLnN1cHByZXNzJiZuJiZpLmF0dHIoInRpdGxlIixuKS5yZW1vdmVBdHRyKGl0KSx0aGlzLl91bmFzc2lnbkV2ZW50cygpLHRoaXMub3B0aW9ucz10aGlzLmVsZW1lbnRzPXRoaXMuY2FjaGU9dGhpcy50aW1lcnM9dGhpcy5wbHVnaW5zPXRoaXMubW91c2U9QyxkZWxldGUgVC5hcGlbdGhpcy5pZF19fXJldHVybiB0aGlzLmRlc3Ryb3llZD90aGlzLnRhcmdldDooZT09PUQmJiJoaWRlIiE9PXRoaXMudHJpZ2dlcmluZ3x8IXRoaXMucmVuZGVyZWQ/aS5jYWxsKHRoaXMpOih0aGlzLnRvb2x0aXAub25lKCJ0b29sdGlwaGlkZGVuIix0LnByb3h5KGksdGhpcykpLCF0aGlzLnRyaWdnZXJpbmcmJnRoaXMuaGlkZSgpKSx0aGlzLnRhcmdldCl9LHg9Uy5jaGVja3M9e2J1aWx0aW46eyJeaWQkIjpmdW5jdGlvbihlLGksbixyKXt2YXIgcz1uPT09RD9ULm5leHRpZDpuLG89eisiLSIrcztzIT09WSYmcy5sZW5ndGg+MCYmIXQoIiMiK28pLmxlbmd0aD8odGhpcy5faWQ9byx0aGlzLnJlbmRlcmVkJiYodGhpcy50b29sdGlwWzBdLmlkPXRoaXMuX2lkLHRoaXMuZWxlbWVudHMuY29udGVudFswXS5pZD10aGlzLl9pZCsiLWNvbnRlbnQiLHRoaXMuZWxlbWVudHMudGl0bGVbMF0uaWQ9dGhpcy5faWQrIi10aXRsZSIpKTplW2ldPXJ9LCJecHJlcmVuZGVyIjpmdW5jdGlvbih0LGUsaSl7aSYmIXRoaXMucmVuZGVyZWQmJnRoaXMucmVuZGVyKHRoaXMub3B0aW9ucy5zaG93LnJlYWR5KX0sIl5jb250ZW50LnRleHQkIjpmdW5jdGlvbih0LGUsaSl7dGhpcy5fdXBkYXRlQ29udGVudChpKX0sIl5jb250ZW50LmF0dHIkIjpmdW5jdGlvbih0LGUsaSxuKXt0aGlzLm9wdGlvbnMuY29udGVudC50ZXh0PT09dGhpcy50YXJnZXQuYXR0cihuKSYmdGhpcy5fdXBkYXRlQ29udGVudCh0aGlzLnRhcmdldC5hdHRyKGkpKX0sIl5jb250ZW50LnRpdGxlJCI6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpPyhpJiYhdGhpcy5lbGVtZW50cy50aXRsZSYmdGhpcy5fY3JlYXRlVGl0bGUoKSx2b2lkIHRoaXMuX3VwZGF0ZVRpdGxlKGkpKTp0aGlzLl9yZW1vdmVUaXRsZSgpfSwiXmNvbnRlbnQuYnV0dG9uJCI6ZnVuY3Rpb24odCxlLGkpe3RoaXMuX3VwZGF0ZUJ1dHRvbihpKX0sIl5jb250ZW50LnRpdGxlLih0ZXh0fGJ1dHRvbikkIjpmdW5jdGlvbih0LGUsaSl7dGhpcy5zZXQoImNvbnRlbnQuIitlLGkpfSwiXnBvc2l0aW9uLihteXxhdCkkIjpmdW5jdGlvbih0LGUsaSl7InN0cmluZyI9PXR5cGVvZiBpJiYodGhpcy5wb3NpdGlvbltlXT10W2VdPW5ldyBMKGksImF0Ij09PWUpKX0sIl5wb3NpdGlvbi5jb250YWluZXIkIjpmdW5jdGlvbih0LGUsaSl7dGhpcy5yZW5kZXJlZCYmdGhpcy50b29sdGlwLmFwcGVuZFRvKGkpfSwiXnNob3cucmVhZHkkIjpmdW5jdGlvbih0LGUsaSl7aSYmKCF0aGlzLnJlbmRlcmVkJiZ0aGlzLnJlbmRlcihEKXx8dGhpcy50b2dnbGUoRCkpfSwiXnN0eWxlLmNsYXNzZXMkIjpmdW5jdGlvbih0LGUsaSxuKXt0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXAucmVtb3ZlQ2xhc3MobikuYWRkQ2xhc3MoaSl9LCJec3R5bGUuKHdpZHRofGhlaWdodCkiOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXAuY3NzKGUsaSl9LCJec3R5bGUud2lkZ2V0fGNvbnRlbnQudGl0bGUiOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXJlZCYmdGhpcy5fc2V0V2lkZ2V0KCl9LCJec3R5bGUuZGVmIjpmdW5jdGlvbih0LGUsaSl7dGhpcy5yZW5kZXJlZCYmdGhpcy50b29sdGlwLnRvZ2dsZUNsYXNzKFEsISFpKX0sIl5ldmVudHMuKHJlbmRlcnxzaG93fG1vdmV8aGlkZXxmb2N1c3xibHVyKSQiOmZ1bmN0aW9uKGUsaSxuKXt0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXBbKHQuaXNGdW5jdGlvbihuKT8iIjoidW4iKSsiYmluZCJdKCJ0b29sdGlwIitpLG4pfSwiXihzaG93fGhpZGV8cG9zaXRpb24pLihldmVudHx0YXJnZXR8Zml4ZWR8aW5hY3RpdmV8bGVhdmV8ZGlzdGFuY2V8dmlld3BvcnR8YWRqdXN0KSI6ZnVuY3Rpb24oKXtpZih0aGlzLnJlbmRlcmVkKXt2YXIgdD10aGlzLm9wdGlvbnMucG9zaXRpb247dGhpcy50b29sdGlwLmF0dHIoInRyYWNraW5nIiwibW91c2UiPT09dC50YXJnZXQmJnQuYWRqdXN0Lm1vdXNlKSx0aGlzLl91bmFzc2lnbkV2ZW50cygpLHRoaXMuX2Fzc2lnbkV2ZW50cygpfX19fSxTLmdldD1mdW5jdGlvbih0KXtpZih0aGlzLmRlc3Ryb3llZClyZXR1cm4gdGhpczt2YXIgZT1zKHRoaXMub3B0aW9ucyx0LnRvTG93ZXJDYXNlKCkpLGk9ZVswXVtlWzFdXTtyZXR1cm4gaS5wcmVjZWRhbmNlP2kuc3RyaW5nKCk6aX07dmFyIHJ0PS9ecG9zaXRpb25cLihteXxhdHxhZGp1c3R8dGFyZ2V0fGNvbnRhaW5lcnx2aWV3cG9ydCl8c3R5bGV8Y29udGVudHxzaG93XC5yZWFkeS9pLHN0PS9ecHJlcmVuZGVyfHNob3dcLnJlYWR5L2k7Uy5zZXQ9ZnVuY3Rpb24oZSxpKXtpZih0aGlzLmRlc3Ryb3llZClyZXR1cm4gdGhpczt2YXIgbixvPXRoaXMucmVuZGVyZWQsYT1ZLGw9dGhpcy5vcHRpb25zO3JldHVybiJzdHJpbmciPT10eXBlb2YgZT8obj1lLGU9e30sZVtuXT1pKTplPXQuZXh0ZW5kKHt9LGUpLHQuZWFjaChlLGZ1bmN0aW9uKGksbil7aWYobyYmc3QudGVzdChpKSlyZXR1cm4gdm9pZCBkZWxldGUgZVtpXTt2YXIgcixjPXMobCxpLnRvTG93ZXJDYXNlKCkpO3I9Y1swXVtjWzFdXSxjWzBdW2NbMV1dPW4mJm4ubm9kZVR5cGU/dChuKTpuLGE9cnQudGVzdChpKXx8YSxlW2ldPVtjWzBdLGNbMV0sbixyXX0pLHIobCksdGhpcy5wb3NpdGlvbmluZz1ELHQuZWFjaChlLHQucHJveHkoYyx0aGlzKSksdGhpcy5wb3NpdGlvbmluZz1ZLHRoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcFswXS5vZmZzZXRXaWR0aD4wJiZhJiZ0aGlzLnJlcG9zaXRpb24oIm1vdXNlIj09PWwucG9zaXRpb24udGFyZ2V0P0M6dGhpcy5jYWNoZS5ldmVudCksdGhpc30sUy5fdXBkYXRlPWZ1bmN0aW9uKGUsaSl7dmFyIG49dGhpcyxyPXRoaXMuY2FjaGU7cmV0dXJuIHRoaXMucmVuZGVyZWQmJmU/KHQuaXNGdW5jdGlvbihlKSYmKGU9ZS5jYWxsKHRoaXMuZWxlbWVudHMudGFyZ2V0LHIuZXZlbnQsdGhpcyl8fCIiKSx0LmlzRnVuY3Rpb24oZS50aGVuKT8oci53YWl0aW5nPUQsZS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiByLndhaXRpbmc9WSxuLl91cGRhdGUodCxpKX0sQyxmdW5jdGlvbih0KXtyZXR1cm4gbi5fdXBkYXRlKHQsaSl9KSk6ZT09PVl8fCFlJiYiIiE9PWU/WTooZS5qcXVlcnkmJmUubGVuZ3RoPjA/aS5lbXB0eSgpLmFwcGVuZChlLmNzcyh7ZGlzcGxheToiYmxvY2siLHZpc2liaWxpdHk6InZpc2libGUifSkpOmkuaHRtbChlKSx0aGlzLl93YWl0Rm9yQ29udGVudChpKS50aGVuKGZ1bmN0aW9uKHQpe24ucmVuZGVyZWQmJm4udG9vbHRpcFswXS5vZmZzZXRXaWR0aD4wJiZuLnJlcG9zaXRpb24oci5ldmVudCwhdC5sZW5ndGgpfSkpKTpZfSxTLl93YWl0Rm9yQ29udGVudD1mdW5jdGlvbihlKXt2YXIgaT10aGlzLmNhY2hlO3JldHVybiBpLndhaXRpbmc9RCwodC5mbi5pbWFnZXNMb2FkZWQ/ZS5pbWFnZXNMb2FkZWQoKToobmV3IHQuRGVmZXJyZWQpLnJlc29sdmUoW10pKS5kb25lKGZ1bmN0aW9uKCl7aS53YWl0aW5nPVl9KS5wcm9taXNlKCl9LFMuX3VwZGF0ZUNvbnRlbnQ9ZnVuY3Rpb24odCxlKXt0aGlzLl91cGRhdGUodCx0aGlzLmVsZW1lbnRzLmNvbnRlbnQsZSl9LFMuX3VwZGF0ZVRpdGxlPWZ1bmN0aW9uKHQsZSl7dGhpcy5fdXBkYXRlKHQsdGhpcy5lbGVtZW50cy50aXRsZSxlKT09PVkmJnRoaXMuX3JlbW92ZVRpdGxlKFkpfSxTLl9jcmVhdGVUaXRsZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZWxlbWVudHMsaT10aGlzLl9pZCsiLXRpdGxlIjtlLnRpdGxlYmFyJiZ0aGlzLl9yZW1vdmVUaXRsZSgpLGUudGl0bGViYXI9dCgiPGRpdiAvPiIseyJjbGFzcyI6eisiLXRpdGxlYmFyICIrKHRoaXMub3B0aW9ucy5zdHlsZS53aWRnZXQ/dSgiaGVhZGVyIik6IiIpfSkuYXBwZW5kKGUudGl0bGU9dCgiPGRpdiAvPiIse2lkOmksImNsYXNzIjp6KyItdGl0bGUiLCJhcmlhLWF0b21pYyI6RH0pKS5pbnNlcnRCZWZvcmUoZS5jb250ZW50KS5kZWxlZ2F0ZSgiLnF0aXAtY2xvc2UiLCJtb3VzZWRvd24ga2V5ZG93biBtb3VzZXVwIGtleXVwIG1vdXNlb3V0IixmdW5jdGlvbihlKXt0KHRoaXMpLnRvZ2dsZUNsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUgdWktc3RhdGUtZm9jdXMiLCJkb3duIj09PWUudHlwZS5zdWJzdHIoLTQpKX0pLmRlbGVnYXRlKCIucXRpcC1jbG9zZSIsIm1vdXNlb3ZlciBtb3VzZW91dCIsZnVuY3Rpb24oZSl7dCh0aGlzKS50b2dnbGVDbGFzcygidWktc3RhdGUtaG92ZXIiLCJtb3VzZW92ZXIiPT09ZS50eXBlKX0pLHRoaXMub3B0aW9ucy5jb250ZW50LmJ1dHRvbiYmdGhpcy5fY3JlYXRlQnV0dG9uKCl9LFMuX3JlbW92ZVRpdGxlPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZWxlbWVudHM7ZS50aXRsZSYmKGUudGl0bGViYXIucmVtb3ZlKCksZS50aXRsZWJhcj1lLnRpdGxlPWUuYnV0dG9uPUMsdCE9PVkmJnRoaXMucmVwb3NpdGlvbigpKX0sUy5fY3JlYXRlUG9zQ2xhc3M9ZnVuY3Rpb24odCl7cmV0dXJuIHorIi1wb3MtIisodHx8dGhpcy5vcHRpb25zLnBvc2l0aW9uLm15KS5hYmJyZXYoKX0sUy5yZXBvc2l0aW9uPWZ1bmN0aW9uKGUsaSl7aWYoIXRoaXMucmVuZGVyZWR8fHRoaXMucG9zaXRpb25pbmd8fHRoaXMuZGVzdHJveWVkKXJldHVybiB0aGlzO3RoaXMucG9zaXRpb25pbmc9RDt2YXIgbixyLHMsbCxjPXRoaXMuY2FjaGUsdT10aGlzLnRvb2x0aXAsZD10aGlzLm9wdGlvbnMucG9zaXRpb24saD1kLnRhcmdldCxwPWQubXksZj1kLmF0LG09ZC52aWV3cG9ydCxfPWQuY29udGFpbmVyLGc9ZC5hZGp1c3Qsdj1nLm1ldGhvZC5zcGxpdCgiICIpLHk9dS5vdXRlcldpZHRoKFkpLGI9dS5vdXRlckhlaWdodChZKSx3PTAsTT0wLGs9dS5jc3MoInBvc2l0aW9uIiksVD17bGVmdDowLHRvcDowfSxTPXVbMF0ub2Zmc2V0V2lkdGg+MCxMPWUmJiJzY3JvbGwiPT09ZS50eXBlLHg9dChvKSxFPV9bMF0ub3duZXJEb2N1bWVudCxDPXRoaXMubW91c2U7aWYodC5pc0FycmF5KGgpJiYyPT09aC5sZW5ndGgpZj17eDpSLHk6UH0sVD17bGVmdDpoWzBdLHRvcDpoWzFdfTtlbHNlIGlmKCJtb3VzZSI9PT1oKWY9e3g6Uix5OlB9LCghZy5tb3VzZXx8dGhpcy5vcHRpb25zLmhpZGUuZGlzdGFuY2UpJiZjLm9yaWdpbiYmYy5vcmlnaW4ucGFnZVg/ZT1jLm9yaWdpbjohZXx8ZSYmKCJyZXNpemUiPT09ZS50eXBlfHwic2Nyb2xsIj09PWUudHlwZSk/ZT1jLmV2ZW50OkMmJkMucGFnZVgmJihlPUMpLCJzdGF0aWMiIT09ayYmKFQ9Xy5vZmZzZXQoKSksRS5ib2R5Lm9mZnNldFdpZHRoIT09KG8uaW5uZXJXaWR0aHx8RS5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpJiYocj10KGEuYm9keSkub2Zmc2V0KCkpLFQ9e2xlZnQ6ZS5wYWdlWC1ULmxlZnQrKHImJnIubGVmdHx8MCksdG9wOmUucGFnZVktVC50b3ArKHImJnIudG9wfHwwKX0sZy5tb3VzZSYmTCYmQyYmKFQubGVmdC09KEMuc2Nyb2xsWHx8MCkteC5zY3JvbGxMZWZ0KCksVC50b3AtPShDLnNjcm9sbFl8fDApLXguc2Nyb2xsVG9wKCkpO2Vsc2V7aWYoImV2ZW50Ij09PWg/ZSYmZS50YXJnZXQmJiJzY3JvbGwiIT09ZS50eXBlJiYicmVzaXplIiE9PWUudHlwZT9jLnRhcmdldD10KGUudGFyZ2V0KTplLnRhcmdldHx8KGMudGFyZ2V0PXRoaXMuZWxlbWVudHMudGFyZ2V0KToiZXZlbnQiIT09aCYmKGMudGFyZ2V0PXQoaC5qcXVlcnk/aDp0aGlzLmVsZW1lbnRzLnRhcmdldCkpLGg9Yy50YXJnZXQsaD10KGgpLmVxKDApLDA9PT1oLmxlbmd0aClyZXR1cm4gdGhpcztoWzBdPT09YXx8aFswXT09PW8/KHc9bnQuaU9TP28uaW5uZXJXaWR0aDpoLndpZHRoKCksTT1udC5pT1M/by5pbm5lckhlaWdodDpoLmhlaWdodCgpLGhbMF09PT1vJiYoVD17dG9wOihtfHxoKS5zY3JvbGxUb3AoKSxsZWZ0OihtfHxoKS5zY3JvbGxMZWZ0KCl9KSk6Qi5pbWFnZW1hcCYmaC5pcygiYXJlYSIpP249Qi5pbWFnZW1hcCh0aGlzLGgsZixCLnZpZXdwb3J0P3Y6WSk6Qi5zdmcmJmgmJmhbMF0ub3duZXJTVkdFbGVtZW50P249Qi5zdmcodGhpcyxoLGYsQi52aWV3cG9ydD92OlkpOih3PWgub3V0ZXJXaWR0aChZKSxNPWgub3V0ZXJIZWlnaHQoWSksVD1oLm9mZnNldCgpKSxuJiYodz1uLndpZHRoLE09bi5oZWlnaHQscj1uLm9mZnNldCxUPW4ucG9zaXRpb24pLFQ9dGhpcy5yZXBvc2l0aW9uLm9mZnNldChoLFQsXyksKG50LmlPUz4zLjEmJm50LmlPUzw0LjF8fG50LmlPUz49NC4zJiZudC5pT1M8NC4zM3x8IW50LmlPUyYmImZpeGVkIj09PWspJiYoVC5sZWZ0LT14LnNjcm9sbExlZnQoKSxULnRvcC09eC5zY3JvbGxUb3AoKSksKCFufHxuJiZuLmFkanVzdGFibGUhPT1ZKSYmKFQubGVmdCs9Zi54PT09aj93OmYueD09PUY/dy8yOjAsVC50b3ArPWYueT09PUg/TTpmLnk9PT1GP00vMjowKX1yZXR1cm4gVC5sZWZ0Kz1nLngrKHAueD09PWo/LXk6cC54PT09Rj8teS8yOjApLFQudG9wKz1nLnkrKHAueT09PUg/LWI6cC55PT09Rj8tYi8yOjApLEIudmlld3BvcnQ/KHM9VC5hZGp1c3RlZD1CLnZpZXdwb3J0KHRoaXMsVCxkLHcsTSx5LGIpLHImJnMubGVmdCYmKFQubGVmdCs9ci5sZWZ0KSxyJiZzLnRvcCYmKFQudG9wKz1yLnRvcCkscy5teSYmKHRoaXMucG9zaXRpb24ubXk9cy5teSkpOlQuYWRqdXN0ZWQ9e2xlZnQ6MCx0b3A6MH0sYy5wb3NDbGFzcyE9PShsPXRoaXMuX2NyZWF0ZVBvc0NsYXNzKHRoaXMucG9zaXRpb24ubXkpKSYmKGMucG9zQ2xhc3M9bCx1LnJlbW92ZUNsYXNzKGMucG9zQ2xhc3MpLmFkZENsYXNzKGwpKSx0aGlzLl90cmlnZ2VyKCJtb3ZlIixbVCxtLmVsZW18fG1dLGUpPyhkZWxldGUgVC5hZGp1c3RlZCxpPT09WXx8IVN8fGlzTmFOKFQubGVmdCl8fGlzTmFOKFQudG9wKXx8Im1vdXNlIj09PWh8fCF0LmlzRnVuY3Rpb24oZC5lZmZlY3QpP3UuY3NzKFQpOnQuaXNGdW5jdGlvbihkLmVmZmVjdCkmJihkLmVmZmVjdC5jYWxsKHUsdGhpcyx0LmV4dGVuZCh7fSxUKSksdS5xdWV1ZShmdW5jdGlvbihlKXt0KHRoaXMpLmNzcyh7b3BhY2l0eToiIixoZWlnaHQ6IiJ9KSxudC5pZSYmdGhpcy5zdHlsZS5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpLGUoKX0pKSx0aGlzLnBvc2l0aW9uaW5nPVksdGhpcyk6dGhpc30sUy5yZXBvc2l0aW9uLm9mZnNldD1mdW5jdGlvbihlLGksbil7ZnVuY3Rpb24gcih0LGUpe2kubGVmdCs9ZSp0LnNjcm9sbExlZnQoKSxpLnRvcCs9ZSp0LnNjcm9sbFRvcCgpfWlmKCFuWzBdKXJldHVybiBpO3ZhciBzLG8sbCxjLHU9dChlWzBdLm93bmVyRG9jdW1lbnQpLGQ9ISFudC5pZSYmIkNTUzFDb21wYXQiIT09YS5jb21wYXRNb2RlLGg9blswXTtkbyJzdGF0aWMiIT09KG89dC5jc3MoaCwicG9zaXRpb24iKSkmJigiZml4ZWQiPT09bz8obD1oLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHIodSwtMSkpOihsPXQoaCkucG9zaXRpb24oKSxsLmxlZnQrPXBhcnNlRmxvYXQodC5jc3MoaCwiYm9yZGVyTGVmdFdpZHRoIikpfHwwLGwudG9wKz1wYXJzZUZsb2F0KHQuY3NzKGgsImJvcmRlclRvcFdpZHRoIikpfHwwKSxpLmxlZnQtPWwubGVmdCsocGFyc2VGbG9hdCh0LmNzcyhoLCJtYXJnaW5MZWZ0IikpfHwwKSxpLnRvcC09bC50b3ArKHBhcnNlRmxvYXQodC5jc3MoaCwibWFyZ2luVG9wIikpfHwwKSxzfHwiaGlkZGVuIj09PShjPXQuY3NzKGgsIm92ZXJmbG93IikpfHwidmlzaWJsZSI9PT1jfHwiQk9EWSI9PT10LnByb3AoaCwidGFnTmFtZSIpfHwocz10KGgpKSk7d2hpbGUoaD1oLm9mZnNldFBhcmVudCk7cmV0dXJuIHMmJihzWzBdIT09dVswXXx8ZCkmJnIocywxKSxpfTt2YXIgb3Q9KEw9Uy5yZXBvc2l0aW9uLkNvcm5lcj1mdW5jdGlvbih0LGUpe3Q9KCIiK3QpLnJlcGxhY2UoLyhbQS1aXSkvLCIgJDEiKS5yZXBsYWNlKC9taWRkbGUvZ2ksRikudG9Mb3dlckNhc2UoKSx0aGlzLng9KHQubWF0Y2goL2xlZnR8cmlnaHQvaSl8fHQubWF0Y2goL2NlbnRlci8pfHxbImluaGVyaXQiXSlbMF0udG9Mb3dlckNhc2UoKSx0aGlzLnk9KHQubWF0Y2goL3RvcHxib3R0b218Y2VudGVyL2kpfHxbImluaGVyaXQiXSlbMF0udG9Mb3dlckNhc2UoKSx0aGlzLmZvcmNlWT0hIWU7dmFyIGk9dC5jaGFyQXQoMCk7dGhpcy5wcmVjZWRhbmNlPSJ0Ij09PWl8fCJiIj09PWk/TzpBfSkucHJvdG90eXBlO290LmludmVydD1mdW5jdGlvbih0LGUpe3RoaXNbdF09dGhpc1t0XT09PVI/ajp0aGlzW3RdPT09aj9SOmV8fHRoaXNbdF19LG90LnN0cmluZz1mdW5jdGlvbih0KXt2YXIgZT10aGlzLngsaT10aGlzLnksbj1lIT09aT8iY2VudGVyIj09PWV8fCJjZW50ZXIiIT09aSYmKHRoaXMucHJlY2VkYW5jZT09PU98fHRoaXMuZm9yY2VZKT9baSxlXTpbZSxpXTpbZV07cmV0dXJuIHQhPT0hMT9uLmpvaW4oIiAiKTpufSxvdC5hYmJyZXY9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnN0cmluZyghMSk7cmV0dXJuIHRbMF0uY2hhckF0KDApKyh0WzFdJiZ0WzFdLmNoYXJBdCgwKXx8IiIpfSxvdC5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgTCh0aGlzLnN0cmluZygpLHRoaXMuZm9yY2VZKX0sUy50b2dnbGU9ZnVuY3Rpb24oZSxpKXt2YXIgbj10aGlzLmNhY2hlLHI9dGhpcy5vcHRpb25zLHM9dGhpcy50b29sdGlwO2lmKGkpe2lmKC9vdmVyfGVudGVyLy50ZXN0KGkudHlwZSkmJm4uZXZlbnQmJi9vdXR8bGVhdmUvLnRlc3Qobi5ldmVudC50eXBlKSYmci5zaG93LnRhcmdldC5hZGQoaS50YXJnZXQpLmxlbmd0aD09PXIuc2hvdy50YXJnZXQubGVuZ3RoJiZzLmhhcyhpLnJlbGF0ZWRUYXJnZXQpLmxlbmd0aClyZXR1cm4gdGhpcztuLmV2ZW50PXQuZXZlbnQuZml4KGkpfWlmKHRoaXMud2FpdGluZyYmIWUmJih0aGlzLmhpZGRlbkR1cmluZ1dhaXQ9RCksIXRoaXMucmVuZGVyZWQpcmV0dXJuIGU/dGhpcy5yZW5kZXIoMSk6dGhpcztpZih0aGlzLmRlc3Ryb3llZHx8dGhpcy5kaXNhYmxlZClyZXR1cm4gdGhpczt2YXIgbyxsLGMsdT1lPyJzaG93IjoiaGlkZSIsZD10aGlzLm9wdGlvbnNbdV0saD10aGlzLm9wdGlvbnMucG9zaXRpb24scD10aGlzLm9wdGlvbnMuY29udGVudCxmPXRoaXMudG9vbHRpcC5jc3MoIndpZHRoIiksbT10aGlzLnRvb2x0aXAuaXMoIjp2aXNpYmxlIiksXz1lfHwxPT09ZC50YXJnZXQubGVuZ3RoLGc9IWl8fGQudGFyZ2V0Lmxlbmd0aDwyfHxuLnRhcmdldFswXT09PWkudGFyZ2V0O3JldHVybih0eXBlb2YgZSkuc2VhcmNoKCJib29sZWFufG51bWJlciIpJiYoZT0hbSksbz0hcy5pcygiOmFuaW1hdGVkIikmJm09PT1lJiZnLGw9bz9DOiEhdGhpcy5fdHJpZ2dlcih1LFs5MF0pLHRoaXMuZGVzdHJveWVkP3RoaXM6KGwhPT1ZJiZlJiZ0aGlzLmZvY3VzKGkpLCFsfHxvP3RoaXM6KHQuYXR0cihzWzBdLCJhcmlhLWhpZGRlbiIsIWUpLGU/KHRoaXMubW91c2UmJihuLm9yaWdpbj10LmV2ZW50LmZpeCh0aGlzLm1vdXNlKSksdC5pc0Z1bmN0aW9uKHAudGV4dCkmJnRoaXMuX3VwZGF0ZUNvbnRlbnQocC50ZXh0LFkpLHQuaXNGdW5jdGlvbihwLnRpdGxlKSYmdGhpcy5fdXBkYXRlVGl0bGUocC50aXRsZSxZKSwhRSYmIm1vdXNlIj09PWgudGFyZ2V0JiZoLmFkanVzdC5tb3VzZSYmKHQoYSkuYmluZCgibW91c2Vtb3ZlLiIreix0aGlzLl9zdG9yZU1vdXNlKSxFPUQpLGZ8fHMuY3NzKCJ3aWR0aCIscy5vdXRlcldpZHRoKFkpKSx0aGlzLnJlcG9zaXRpb24oaSxhcmd1bWVudHNbMl0pLGZ8fHMuY3NzKCJ3aWR0aCIsIiIpLGQuc29sbyYmKCJzdHJpbmciPT10eXBlb2YgZC5zb2xvP3QoZC5zb2xvKTp0KEcsZC5zb2xvKSkubm90KHMpLm5vdChkLnRhcmdldCkucXRpcCgiaGlkZSIsbmV3IHQuRXZlbnQoInRvb2x0aXBzb2xvIikpKTooY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnNob3cpLGRlbGV0ZSBuLm9yaWdpbixFJiYhdChHKydbdHJhY2tpbmc9InRydWUiXTp2aXNpYmxlJyxkLnNvbG8pLm5vdChzKS5sZW5ndGgmJih0KGEpLnVuYmluZCgibW91c2Vtb3ZlLiIreiksRT1ZKSx0aGlzLmJsdXIoaSkpLGM9dC5wcm94eShmdW5jdGlvbigpe2U/KG50LmllJiZzWzBdLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZSgiZmlsdGVyIikscy5jc3MoIm92ZXJmbG93IiwiIiksInN0cmluZyI9PXR5cGVvZiBkLmF1dG9mb2N1cyYmdCh0aGlzLm9wdGlvbnMuc2hvdy5hdXRvZm9jdXMscykuZm9jdXMoKSx0aGlzLm9wdGlvbnMuc2hvdy50YXJnZXQudHJpZ2dlcigicXRpcC0iK3RoaXMuaWQrIi1pbmFjdGl2ZSIpKTpzLmNzcyh7ZGlzcGxheToiIix2aXNpYmlsaXR5OiIiLG9wYWNpdHk6IiIsbGVmdDoiIix0b3A6IiJ9KSx0aGlzLl90cmlnZ2VyKGU/InZpc2libGUiOiJoaWRkZW4iKX0sdGhpcyksZC5lZmZlY3Q9PT1ZfHxfPT09WT8oc1t1XSgpLGMoKSk6dC5pc0Z1bmN0aW9uKGQuZWZmZWN0KT8ocy5zdG9wKDEsMSksZC5lZmZlY3QuY2FsbChzLHRoaXMpLHMucXVldWUoImZ4IixmdW5jdGlvbih0KXtjKCksdCgpfSkpOnMuZmFkZVRvKDkwLGU/MTowLGMpLGUmJmQudGFyZ2V0LnRyaWdnZXIoInF0aXAtIit0aGlzLmlkKyItaW5hY3RpdmUiKSx0aGlzKSl9LFMuc2hvdz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50b2dnbGUoRCx0KX0sUy5oaWRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvZ2dsZShZLHQpfSxTLmZvY3VzPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLnJlbmRlcmVkfHx0aGlzLmRlc3Ryb3llZClyZXR1cm4gdGhpczt2YXIgaT10KEcpLG49dGhpcy50b29sdGlwLHI9cGFyc2VJbnQoblswXS5zdHlsZS56SW5kZXgsMTApLHM9VC56aW5kZXgraS5sZW5ndGg7cmV0dXJuIG4uaGFzQ2xhc3MoWCl8fHRoaXMuX3RyaWdnZXIoImZvY3VzIixbc10sZSkmJihyIT09cyYmKGkuZWFjaChmdW5jdGlvbigpe3RoaXMuc3R5bGUuekluZGV4PnImJih0aGlzLnN0eWxlLnpJbmRleD10aGlzLnN0eWxlLnpJbmRleC0xKX0pLGkuZmlsdGVyKCIuIitYKS5xdGlwKCJibHVyIixlKSksbi5hZGRDbGFzcyhYKVswXS5zdHlsZS56SW5kZXg9cyksdGhpc30sUy5ibHVyPWZ1bmN0aW9uKHQpe3JldHVybiF0aGlzLnJlbmRlcmVkfHx0aGlzLmRlc3Ryb3llZD90aGlzOih0aGlzLnRvb2x0aXAucmVtb3ZlQ2xhc3MoWCksdGhpcy5fdHJpZ2dlcigiYmx1ciIsW3RoaXMudG9vbHRpcC5jc3MoInpJbmRleCIpXSx0KSx0aGlzKX0sUy5kaXNhYmxlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRlc3Ryb3llZD90aGlzOigidG9nZ2xlIj09PXQ/dD0hKHRoaXMucmVuZGVyZWQ/dGhpcy50b29sdGlwLmhhc0NsYXNzKHR0KTp0aGlzLmRpc2FibGVkKToiYm9vbGVhbiIhPXR5cGVvZiB0JiYodD1EKSx0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXAudG9nZ2xlQ2xhc3ModHQsdCkuYXR0cigiYXJpYS1kaXNhYmxlZCIsdCksdGhpcy5kaXNhYmxlZD0hIXQsdGhpcyl9LFMuZW5hYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzYWJsZShZKX0sUy5fY3JlYXRlQnV0dG9uPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxpPXRoaXMuZWxlbWVudHMsbj1pLnRvb2x0aXAscj10aGlzLm9wdGlvbnMuY29udGVudC5idXR0b24scz0ic3RyaW5nIj09dHlwZW9mIHIsbz1zP3I6IkNsb3NlIHRvb2x0aXAiO2kuYnV0dG9uJiZpLmJ1dHRvbi5yZW1vdmUoKSxyLmpxdWVyeT9pLmJ1dHRvbj1yOmkuYnV0dG9uPXQoIjxhIC8+Iix7ImNsYXNzIjoicXRpcC1jbG9zZSAiKyh0aGlzLm9wdGlvbnMuc3R5bGUud2lkZ2V0PyIiOnorIi1pY29uIiksdGl0bGU6bywiYXJpYS1sYWJlbCI6b30pLnByZXBlbmQodCgiPHNwYW4gLz4iLHsiY2xhc3MiOiJ1aS1pY29uIHVpLWljb24tY2xvc2UiLGh0bWw6IiZ0aW1lczsifSkpLGkuYnV0dG9uLmFwcGVuZFRvKGkudGl0bGViYXJ8fG4pLmF0dHIoInJvbGUiLCJidXR0b24iKS5jbGljayhmdW5jdGlvbih0KXtyZXR1cm4gbi5oYXNDbGFzcyh0dCl8fGUuaGlkZSh0KSxZfSl9LFMuX3VwZGF0ZUJ1dHRvbj1mdW5jdGlvbih0KXtpZighdGhpcy5yZW5kZXJlZClyZXR1cm4gWTt2YXIgZT10aGlzLmVsZW1lbnRzLmJ1dHRvbjt0P3RoaXMuX2NyZWF0ZUJ1dHRvbigpOmUucmVtb3ZlKCl9LFMuX3NldFdpZGdldD1mdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy5zdHlsZS53aWRnZXQsZT10aGlzLmVsZW1lbnRzLGk9ZS50b29sdGlwLG49aS5oYXNDbGFzcyh0dCk7aS5yZW1vdmVDbGFzcyh0dCksdHQ9dD8idWktc3RhdGUtZGlzYWJsZWQiOiJxdGlwLWRpc2FibGVkIixpLnRvZ2dsZUNsYXNzKHR0LG4pLGkudG9nZ2xlQ2xhc3MoInVpLWhlbHBlci1yZXNldCAiK3UoKSx0KS50b2dnbGVDbGFzcyhRLHRoaXMub3B0aW9ucy5zdHlsZS5kZWYmJiF0KSxlLmNvbnRlbnQmJmUuY29udGVudC50b2dnbGVDbGFzcyh1KCJjb250ZW50IiksdCksZS50aXRsZWJhciYmZS50aXRsZWJhci50b2dnbGVDbGFzcyh1KCJoZWFkZXIiKSx0KSxlLmJ1dHRvbiYmZS5idXR0b24udG9nZ2xlQ2xhc3MoeisiLWljb24iLCF0KX0sUy5fc3RvcmVNb3VzZT1mdW5jdGlvbihlKXtyZXR1cm4odGhpcy5tb3VzZT10LmV2ZW50LmZpeChlKSkudHlwZT0ibW91c2Vtb3ZlIix0aGlzfSxTLl9iaW5kPWZ1bmN0aW9uKGUsaSxuLHIscyl7aWYoZSYmbiYmaS5sZW5ndGgpe3ZhciBvPSIuIit0aGlzLl9pZCsocj8iLSIrcjoiIik7cmV0dXJuIHQoZSkuYmluZCgoaS5zcGxpdD9pOmkuam9pbihvKyIgIikpK28sdC5wcm94eShuLHN8fHRoaXMpKSx0aGlzfX0sUy5fdW5iaW5kPWZ1bmN0aW9uKGUsaSl7cmV0dXJuIGUmJnQoZSkudW5iaW5kKCIuIit0aGlzLl9pZCsoaT8iLSIraToiIikpLHRoaXN9LFMuX3RyaWdnZXI9ZnVuY3Rpb24oZSxpLG4pe3ZhciByPW5ldyB0LkV2ZW50KCJ0b29sdGlwIitlKTtyZXR1cm4gci5vcmlnaW5hbEV2ZW50PW4mJnQuZXh0ZW5kKHt9LG4pfHx0aGlzLmNhY2hlLmV2ZW50fHxDLHRoaXMudHJpZ2dlcmluZz1lLHRoaXMudG9vbHRpcC50cmlnZ2VyKHIsW3RoaXNdLmNvbmNhdChpfHxbXSkpLHRoaXMudHJpZ2dlcmluZz1ZLCFyLmlzRGVmYXVsdFByZXZlbnRlZCgpfSxTLl9iaW5kRXZlbnRzPWZ1bmN0aW9uKGUsaSxuLHIscyxvKXt2YXIgYT1uLmZpbHRlcihyKS5hZGQoci5maWx0ZXIobikpLGw9W107YS5sZW5ndGgmJih0LmVhY2goaSxmdW5jdGlvbihpLG4pe3ZhciByPXQuaW5BcnJheShuLGUpO3I+LTEmJmwucHVzaChlLnNwbGljZShyLDEpWzBdKX0pLGwubGVuZ3RoJiYodGhpcy5fYmluZChhLGwsZnVuY3Rpb24odCl7dmFyIGU9ISF0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXBbMF0ub2Zmc2V0V2lkdGg+MDsoZT9vOnMpLmNhbGwodGhpcyx0KX0pLG49bi5ub3QoYSkscj1yLm5vdChhKSkpLHRoaXMuX2JpbmQobixlLHMpLHRoaXMuX2JpbmQocixpLG8pfSxTLl9hc3NpZ25Jbml0aWFsRXZlbnRzPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGkoZSl7cmV0dXJuIHRoaXMuZGlzYWJsZWR8fHRoaXMuZGVzdHJveWVkP1k6KHRoaXMuY2FjaGUuZXZlbnQ9ZSYmdC5ldmVudC5maXgoZSksdGhpcy5jYWNoZS50YXJnZXQ9ZSYmdChlLnRhcmdldCksY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnNob3cpLHZvaWQodGhpcy50aW1lcnMuc2hvdz1kLmNhbGwodGhpcyxmdW5jdGlvbigpe3RoaXMucmVuZGVyKCJvYmplY3QiPT10eXBlb2YgZXx8bi5zaG93LnJlYWR5KX0sbi5wcmVyZW5kZXI/MDpuLnNob3cuZGVsYXkpKSl9dmFyIG49dGhpcy5vcHRpb25zLHI9bi5zaG93LnRhcmdldCxzPW4uaGlkZS50YXJnZXQsbz1uLnNob3cuZXZlbnQ/dC50cmltKCIiK24uc2hvdy5ldmVudCkuc3BsaXQoIiAiKTpbXSxhPW4uaGlkZS5ldmVudD90LnRyaW0oIiIrbi5oaWRlLmV2ZW50KS5zcGxpdCgiICIpOltdO3RoaXMuX2JpbmQodGhpcy5lbGVtZW50cy50YXJnZXQsWyJyZW1vdmUiLCJyZW1vdmVxdGlwIl0sZnVuY3Rpb24oKXt0aGlzLmRlc3Ryb3koITApfSwiZGVzdHJveSIpLC9tb3VzZShvdmVyfGVudGVyKS9pLnRlc3Qobi5zaG93LmV2ZW50KSYmIS9tb3VzZShvdXR8bGVhdmUpL2kudGVzdChuLmhpZGUuZXZlbnQpJiZhLnB1c2goIm1vdXNlbGVhdmUiKSx0aGlzLl9iaW5kKHIsIm1vdXNlbW92ZSIsZnVuY3Rpb24odCl7dGhpcy5fc3RvcmVNb3VzZSh0KSx0aGlzLmNhY2hlLm9uVGFyZ2V0PUR9KSx0aGlzLl9iaW5kRXZlbnRzKG8sYSxyLHMsaSxmdW5jdGlvbigpe3JldHVybiB0aGlzLnRpbWVycz92b2lkIGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zaG93KTpZfSksKG4uc2hvdy5yZWFkeXx8bi5wcmVyZW5kZXIpJiZpLmNhbGwodGhpcyxlKX0sUy5fYXNzaWduRXZlbnRzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxpPXRoaXMub3B0aW9ucyxuPWkucG9zaXRpb24scj10aGlzLnRvb2x0aXAscz1pLnNob3cudGFyZ2V0LGw9aS5oaWRlLnRhcmdldCxjPW4uY29udGFpbmVyLHU9bi52aWV3cG9ydCxkPXQoYSksXz10KG8pLGc9aS5zaG93LmV2ZW50P3QudHJpbSgiIitpLnNob3cuZXZlbnQpLnNwbGl0KCIgIik6W10sdj1pLmhpZGUuZXZlbnQ/dC50cmltKCIiK2kuaGlkZS5ldmVudCkuc3BsaXQoIiAiKTpbXTt0LmVhY2goaS5ldmVudHMsZnVuY3Rpb24odCxpKXtlLl9iaW5kKHIsInRvZ2dsZSI9PT10P1sidG9vbHRpcHNob3ciLCJ0b29sdGlwaGlkZSJdOlsidG9vbHRpcCIrdF0saSxudWxsLHIpfSksL21vdXNlKG91dHxsZWF2ZSkvaS50ZXN0KGkuaGlkZS5ldmVudCkmJiJ3aW5kb3ciPT09aS5oaWRlLmxlYXZlJiZ0aGlzLl9iaW5kKGQsWyJtb3VzZW91dCIsImJsdXIiXSxmdW5jdGlvbih0KXsvc2VsZWN0fG9wdGlvbi8udGVzdCh0LnRhcmdldC5ub2RlTmFtZSl8fHQucmVsYXRlZFRhcmdldHx8dGhpcy5oaWRlKHQpfSksaS5oaWRlLmZpeGVkP2w9bC5hZGQoci5hZGRDbGFzcyhLKSk6L21vdXNlKG92ZXJ8ZW50ZXIpL2kudGVzdChpLnNob3cuZXZlbnQpJiZ0aGlzLl9iaW5kKGwsIm1vdXNlbGVhdmUiLGZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnNob3cpfSksKCIiK2kuaGlkZS5ldmVudCkuaW5kZXhPZigidW5mb2N1cyIpPi0xJiZ0aGlzLl9iaW5kKGMuY2xvc2VzdCgiaHRtbCIpLFsibW91c2Vkb3duIiwidG91Y2hzdGFydCJdLGZ1bmN0aW9uKGUpe3ZhciBpPXQoZS50YXJnZXQpLG49dGhpcy5yZW5kZXJlZCYmIXRoaXMudG9vbHRpcC5oYXNDbGFzcyh0dCkmJnRoaXMudG9vbHRpcFswXS5vZmZzZXRXaWR0aD4wLHI9aS5wYXJlbnRzKEcpLmZpbHRlcih0aGlzLnRvb2x0aXBbMF0pLmxlbmd0aD4wO2lbMF09PT10aGlzLnRhcmdldFswXXx8aVswXT09PXRoaXMudG9vbHRpcFswXXx8cnx8dGhpcy50YXJnZXQuaGFzKGlbMF0pLmxlbmd0aHx8IW58fHRoaXMuaGlkZShlKX0pLCJudW1iZXIiPT10eXBlb2YgaS5oaWRlLmluYWN0aXZlJiYodGhpcy5fYmluZChzLCJxdGlwLSIrdGhpcy5pZCsiLWluYWN0aXZlIixmLCJpbmFjdGl2ZSIpLHRoaXMuX2JpbmQobC5hZGQociksVC5pbmFjdGl2ZUV2ZW50cyxmKSksdGhpcy5fYmluZEV2ZW50cyhnLHYscyxsLGgscCksdGhpcy5fYmluZChzLmFkZChyKSwibW91c2Vtb3ZlIixmdW5jdGlvbih0KXtpZigibnVtYmVyIj09dHlwZW9mIGkuaGlkZS5kaXN0YW5jZSl7dmFyIGU9dGhpcy5jYWNoZS5vcmlnaW58fHt9LG49dGhpcy5vcHRpb25zLmhpZGUuZGlzdGFuY2Uscj1NYXRoLmFiczsocih0LnBhZ2VYLWUucGFnZVgpPj1ufHxyKHQucGFnZVktZS5wYWdlWSk+PW4pJiZ0aGlzLmhpZGUodCl9dGhpcy5fc3RvcmVNb3VzZSh0KX0pLCJtb3VzZSI9PT1uLnRhcmdldCYmbi5hZGp1c3QubW91c2UmJihpLmhpZGUuZXZlbnQmJnRoaXMuX2JpbmQocyxbIm1vdXNlZW50ZXIiLCJtb3VzZWxlYXZlIl0sZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY2FjaGU/dm9pZCh0aGlzLmNhY2hlLm9uVGFyZ2V0PSJtb3VzZWVudGVyIj09PXQudHlwZSk6WX0pLHRoaXMuX2JpbmQoZCwibW91c2Vtb3ZlIixmdW5jdGlvbih0KXt0aGlzLnJlbmRlcmVkJiZ0aGlzLmNhY2hlLm9uVGFyZ2V0JiYhdGhpcy50b29sdGlwLmhhc0NsYXNzKHR0KSYmdGhpcy50b29sdGlwWzBdLm9mZnNldFdpZHRoPjAmJnRoaXMucmVwb3NpdGlvbih0KX0pKSwobi5hZGp1c3QucmVzaXplfHx1Lmxlbmd0aCkmJnRoaXMuX2JpbmQodC5ldmVudC5zcGVjaWFsLnJlc2l6ZT91Ol8sInJlc2l6ZSIsbSksbi5hZGp1c3Quc2Nyb2xsJiZ0aGlzLl9iaW5kKF8uYWRkKG4uY29udGFpbmVyKSwic2Nyb2xsIixtKX0sUy5fdW5hc3NpZ25FdmVudHM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMsaT1lLnNob3cudGFyZ2V0LG49ZS5oaWRlLnRhcmdldCxyPXQuZ3JlcChbdGhpcy5lbGVtZW50cy50YXJnZXRbMF0sdGhpcy5yZW5kZXJlZCYmdGhpcy50b29sdGlwWzBdLGUucG9zaXRpb24uY29udGFpbmVyWzBdLGUucG9zaXRpb24udmlld3BvcnRbMF0sZS5wb3NpdGlvbi5jb250YWluZXIuY2xvc2VzdCgiaHRtbCIpWzBdLG8sYV0sZnVuY3Rpb24odCl7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiB0fSk7aSYmaS50b0FycmF5JiYocj1yLmNvbmNhdChpLnRvQXJyYXkoKSkpLG4mJm4udG9BcnJheSYmKHI9ci5jb25jYXQobi50b0FycmF5KCkpKSx0aGlzLl91bmJpbmQocikuX3VuYmluZChyLCJkZXN0cm95IikuX3VuYmluZChyLCJpbmFjdGl2ZSIpfSx0KGZ1bmN0aW9uKCl7XyhHLFsibW91c2VlbnRlciIsIm1vdXNlbGVhdmUiXSxmdW5jdGlvbihlKXt2YXIgaT0ibW91c2VlbnRlciI9PT1lLnR5cGUsbj10KGUuY3VycmVudFRhcmdldCkscj10KGUucmVsYXRlZFRhcmdldHx8ZS50YXJnZXQpLHM9dGhpcy5vcHRpb25zO2k/KHRoaXMuZm9jdXMoZSksbi5oYXNDbGFzcyhLKSYmIW4uaGFzQ2xhc3ModHQpJiZjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuaGlkZSkpOiJtb3VzZSI9PT1zLnBvc2l0aW9uLnRhcmdldCYmcy5wb3NpdGlvbi5hZGp1c3QubW91c2UmJnMuaGlkZS5ldmVudCYmcy5zaG93LnRhcmdldCYmIXIuY2xvc2VzdChzLnNob3cudGFyZ2V0WzBdKS5sZW5ndGgmJnRoaXMuaGlkZShlKSxuLnRvZ2dsZUNsYXNzKFosaSl9KSxfKCJbIiskKyJdIixKLGYpfSksVD10LmZuLnF0aXA9ZnVuY3Rpb24oZSxpLG4pe3ZhciBzPSgiIitlKS50b0xvd2VyQ2FzZSgpLG89QyxhPXQubWFrZUFycmF5KGFyZ3VtZW50cykuc2xpY2UoMSksYz1hW2EubGVuZ3RoLTFdLHU9dGhpc1swXT90LmRhdGEodGhpc1swXSx6KTpDO3JldHVybiFhcmd1bWVudHMubGVuZ3RoJiZ1fHwiYXBpIj09PXM/dToic3RyaW5nIj09dHlwZW9mIGU/KHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBlPXQuZGF0YSh0aGlzLHopO2lmKCFlKXJldHVybiBEO2lmKGMmJmMudGltZVN0YW1wJiYoZS5jYWNoZS5ldmVudD1jKSwhaXx8Im9wdGlvbiIhPT1zJiYib3B0aW9ucyIhPT1zKWVbc10mJmVbc10uYXBwbHkoZSxhKTtlbHNle2lmKG49PT1sJiYhdC5pc1BsYWluT2JqZWN0KGkpKXJldHVybiBvPWUuZ2V0KGkpLFk7ZS5zZXQoaSxuKX19KSxvIT09Qz9vOnRoaXMpOiJvYmplY3QiIT10eXBlb2YgZSYmYXJndW1lbnRzLmxlbmd0aD92b2lkIDA6KHU9cih0LmV4dGVuZChELHt9LGUpKSx0aGlzLmVhY2goZnVuY3Rpb24oZSl7dmFyIGksbjtyZXR1cm4gbj10LmlzQXJyYXkodS5pZCk/dS5pZFtlXTp1LmlkLG49IW58fG49PT1ZfHxuLmxlbmd0aDwxfHxULmFwaVtuXT9ULm5leHRpZCsrOm4saT1nKHQodGhpcyksbix1KSxpPT09WT9EOihULmFwaVtuXT1pLHQuZWFjaChCLGZ1bmN0aW9uKCl7ImluaXRpYWxpemUiPT09dGhpcy5pbml0aWFsaXplJiZ0aGlzKGkpfSksdm9pZCBpLl9hc3NpZ25Jbml0aWFsRXZlbnRzKGMpKX0pKX0sdC5xdGlwPWUsVC5hcGk9e30sdC5lYWNoKHthdHRyOmZ1bmN0aW9uKGUsaSl7aWYodGhpcy5sZW5ndGgpe3ZhciBuPXRoaXNbMF0scj0idGl0bGUiLHM9dC5kYXRhKG4sInF0aXAiKTtpZihlPT09ciYmcyYmcy5vcHRpb25zJiYib2JqZWN0Ij09dHlwZW9mIHMmJiJvYmplY3QiPT10eXBlb2Ygcy5vcHRpb25zJiZzLm9wdGlvbnMuc3VwcHJlc3MpcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg8Mj90LmF0dHIobixpdCk6KHMmJnMub3B0aW9ucy5jb250ZW50LmF0dHI9PT1yJiZzLmNhY2hlLmF0dHImJnMuc2V0KCJjb250ZW50LnRleHQiLGkpLHRoaXMuYXR0cihpdCxpKSl9cmV0dXJuIHQuZm5bImF0dHIiK2V0XS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGNsb25lOmZ1bmN0aW9uKGUpe3ZhciBpPXQuZm5bImNsb25lIitldF0uYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBlfHxpLmZpbHRlcigiWyIraXQrIl0iKS5hdHRyKCJ0aXRsZSIsZnVuY3Rpb24oKXtyZXR1cm4gdC5hdHRyKHRoaXMsaXQpfSkucmVtb3ZlQXR0cihpdCksaX19LGZ1bmN0aW9uKGUsaSl7aWYoIWl8fHQuZm5bZStldF0pcmV0dXJuIEQ7dmFyIG49dC5mbltlK2V0XT10LmZuW2VdO3QuZm5bZV09ZnVuY3Rpb24oKXtyZXR1cm4gaS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fG4uYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pLHQudWl8fCh0WyJjbGVhbkRhdGEiK2V0XT10LmNsZWFuRGF0YSx0LmNsZWFuRGF0YT1mdW5jdGlvbihlKXtmb3IodmFyIGksbj0wOyhpPXQoZVtuXSkpLmxlbmd0aDtuKyspaWYoaS5hdHRyKFYpKXRyeXtpLnRyaWdnZXJIYW5kbGVyKCJyZW1vdmVxdGlwIil9Y2F0Y2gocil7fXRbImNsZWFuRGF0YSIrZXRdLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLFQudmVyc2lvbj0iMy4wLjMtNS1nIixULm5leHRpZD0wLFQuaW5hY3RpdmVFdmVudHM9SixULnppbmRleD0xNWUzLFQuZGVmYXVsdHM9e3ByZXJlbmRlcjpZLGlkOlksb3ZlcndyaXRlOkQsc3VwcHJlc3M6RCxjb250ZW50Ont0ZXh0OkQsYXR0cjoidGl0bGUiLHRpdGxlOlksYnV0dG9uOll9LHBvc2l0aW9uOntteToidG9wIGxlZnQiLGF0OiJib3R0b20gcmlnaHQiLHRhcmdldDpZLGNvbnRhaW5lcjpZLHZpZXdwb3J0OlksYWRqdXN0Ont4OjAseTowLG1vdXNlOkQsc2Nyb2xsOkQscmVzaXplOkQsbWV0aG9kOiJmbGlwaW52ZXJ0IGZsaXBpbnZlcnQifSxlZmZlY3Q6ZnVuY3Rpb24oZSxpKXt0KHRoaXMpLmFuaW1hdGUoaSx7ZHVyYXRpb246MjAwLHF1ZXVlOll9KX19LHNob3c6e3RhcmdldDpZLGV2ZW50OiJtb3VzZWVudGVyIixlZmZlY3Q6RCxkZWxheTo5MCxzb2xvOlkscmVhZHk6WSxhdXRvZm9jdXM6WX0saGlkZTp7dGFyZ2V0OlksZXZlbnQ6Im1vdXNlbGVhdmUiLGVmZmVjdDpELGRlbGF5OjAsZml4ZWQ6WSxpbmFjdGl2ZTpZLGxlYXZlOiJ3aW5kb3ciLGRpc3RhbmNlOll9LHN0eWxlOntjbGFzc2VzOiIiLHdpZGdldDpZLHdpZHRoOlksaGVpZ2h0OlksZGVmOkR9LGV2ZW50czp7cmVuZGVyOkMsbW92ZTpDLHNob3c6QyxoaWRlOkMsdG9nZ2xlOkMsdmlzaWJsZTpDLGhpZGRlbjpDLGZvY3VzOkMsYmx1cjpDfX07dmFyIGF0LGx0LGN0LHV0LGR0LGh0PSJtYXJnaW4iLHB0PSJib3JkZXIiLGZ0PSJjb2xvciIsbXQ9ImJhY2tncm91bmQtY29sb3IiLF90PSJ0cmFuc3BhcmVudCIsZ3Q9IiAhaW1wb3J0YW50Iix2dD0hIWEuY3JlYXRlRWxlbWVudCgiY2FudmFzIikuZ2V0Q29udGV4dCx5dD0vcmdiYT9cKDAsIDAsIDAoLCAwKT9cKXx0cmFuc3BhcmVudHwjMTIzNDU2L2ksYnQ9e30sd3Q9WyJXZWJraXQiLCJPIiwiTW96IiwibXMiXTt2dD8odXQ9by5kZXZpY2VQaXhlbFJhdGlvfHwxLGR0PWZ1bmN0aW9uKCl7dmFyIHQ9YS5jcmVhdGVFbGVtZW50KCJjYW52YXMiKS5nZXRDb250ZXh0KCIyZCIpO3JldHVybiB0LmJhY2tpbmdTdG9yZVBpeGVsUmF0aW98fHQud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpb3x8dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvfHx0Lm1zQmFja2luZ1N0b3JlUGl4ZWxSYXRpb3x8dC5vQmFja2luZ1N0b3JlUGl4ZWxSYXRpb3x8MX0oKSxjdD11dC9kdCk6bHQ9ZnVuY3Rpb24odCxlLGkpe3JldHVybiI8cXRpcHZtbDoiK3QrJyB4bWxucz0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LmNvbTp2bWwiIGNsYXNzPSJxdGlwLXZtbCIgJysoZXx8IiIpKycgc3R5bGU9ImJlaGF2aW9yOiB1cmwoI2RlZmF1bHQjVk1MKTsgJysoaXx8IiIpKyciIC8+J30sdC5leHRlbmQody5wcm90b3R5cGUse2luaXQ6ZnVuY3Rpb24oZSl7dmFyIGksbjtuPXRoaXMuZWxlbWVudD1lLmVsZW1lbnRzLnRpcD10KCI8ZGl2IC8+Iix7ImNsYXNzIjp6KyItdGlwIn0pLnByZXBlbmRUbyhlLnRvb2x0aXApLHZ0PyhpPXQoIjxjYW52YXMgLz4iKS5hcHBlbmRUbyh0aGlzLmVsZW1lbnQpWzBdLmdldENvbnRleHQoIjJkIiksaS5saW5lSm9pbj0ibWl0ZXIiLGkubWl0ZXJMaW1pdD0xZTUsaS5zYXZlKCkpOihpPWx0KCJzaGFwZSIsJ2Nvb3Jkb3JpZ2luPSIwLDAiJywicG9zaXRpb246YWJzb2x1dGU7IiksdGhpcy5lbGVtZW50Lmh0bWwoaStpKSxlLl9iaW5kKHQoIioiLG4pLmFkZChuKSxbImNsaWNrIiwibW91c2Vkb3duIl0sZnVuY3Rpb24odCl7dC5zdG9wUHJvcGFnYXRpb24oKX0sdGhpcy5fbnMpKSxlLl9iaW5kKGUudG9vbHRpcCwidG9vbHRpcG1vdmUiLHRoaXMucmVwb3NpdGlvbix0aGlzLl9ucyx0aGlzKSx0aGlzLmNyZWF0ZSgpfSxfc3dhcERpbWVuc2lvbnM6ZnVuY3Rpb24oKXt0aGlzLnNpemVbMF09dGhpcy5vcHRpb25zLmhlaWdodCx0aGlzLnNpemVbMV09dGhpcy5vcHRpb25zLndpZHRofSxfcmVzZXREaW1lbnNpb25zOmZ1bmN0aW9uKCl7dGhpcy5zaXplWzBdPXRoaXMub3B0aW9ucy53aWR0aCx0aGlzLnNpemVbMV09dGhpcy5vcHRpb25zLmhlaWdodH0sX3VzZVRpdGxlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMucXRpcC5lbGVtZW50cy50aXRsZWJhcjtyZXR1cm4gZSYmKHQueT09PVB8fHQueT09PUYmJnRoaXMuZWxlbWVudC5wb3NpdGlvbigpLnRvcCt0aGlzLnNpemVbMV0vMit0aGlzLm9wdGlvbnMub2Zmc2V0PGUub3V0ZXJIZWlnaHQoRCkpfSxfcGFyc2VDb3JuZXI6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5xdGlwLm9wdGlvbnMucG9zaXRpb24ubXk7cmV0dXJuIHQ9PT1ZfHxlPT09WT90PVk6dD09PUQ/dD1uZXcgTChlLnN0cmluZygpKTp0LnN0cmluZ3x8KHQ9bmV3IEwodCksdC5maXhlZD1EKSx0fSxfcGFyc2VXaWR0aDpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy5xdGlwLmVsZW1lbnRzLHI9cHQrdihlKSsiV2lkdGgiO3JldHVybihpP2IoaSxyKTpiKG4uY29udGVudCxyKXx8Yih0aGlzLl91c2VUaXRsZSh0KSYmbi50aXRsZWJhcnx8bi5jb250ZW50LHIpfHxiKG4udG9vbHRpcCxyKSl8fDB9LF9wYXJzZVJhZGl1czpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnF0aXAuZWxlbWVudHMsaT1wdCt2KHQueSkrdih0LngpKyJSYWRpdXMiO3JldHVybiBudC5pZTw5PzA6Yih0aGlzLl91c2VUaXRsZSh0KSYmZS50aXRsZWJhcnx8ZS5jb250ZW50LGkpfHxiKGUudG9vbHRpcCxpKXx8MH0sX2ludmFsaWRDb2xvdXI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQuY3NzKGUpO3JldHVybiFufHxpJiZuPT09dC5jc3MoaSl8fHl0LnRlc3Qobik/WTpufSxfcGFyc2VDb2xvdXJzOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMucXRpcC5lbGVtZW50cyxuPXRoaXMuZWxlbWVudC5jc3MoImNzc1RleHQiLCIiKSxyPXB0K3YoZVtlLnByZWNlZGFuY2VdKSt2KGZ0KSxzPXRoaXMuX3VzZVRpdGxlKGUpJiZpLnRpdGxlYmFyfHxpLmNvbnRlbnQsbz10aGlzLl9pbnZhbGlkQ29sb3VyLGE9W107cmV0dXJuIGFbMF09byhuLG10KXx8byhzLG10KXx8byhpLmNvbnRlbnQsbXQpfHxvKGkudG9vbHRpcCxtdCl8fG4uY3NzKG10KSxhWzFdPW8obixyLGZ0KXx8byhzLHIsZnQpfHxvKGkuY29udGVudCxyLGZ0KXx8byhpLnRvb2x0aXAscixmdCl8fGkudG9vbHRpcC5jc3MociksdCgiKiIsbikuYWRkKG4pLmNzcygiY3NzVGV4dCIsbXQrIjoiK190K2d0KyI7IitwdCsiOjAiK2d0KyI7IiksYX0sX2NhbGN1bGF0ZVNpemU6ZnVuY3Rpb24odCl7dmFyIGUsaSxuLHI9dC5wcmVjZWRhbmNlPT09TyxzPXRoaXMub3B0aW9ucy53aWR0aCxvPXRoaXMub3B0aW9ucy5oZWlnaHQsYT0iYyI9PT10LmFiYnJldigpLGw9KHI/czpvKSooYT8uNToxKSxjPU1hdGgucG93LHU9TWF0aC5yb3VuZCxkPU1hdGguc3FydChjKGwsMikrYyhvLDIpKSxoPVt0aGlzLmJvcmRlci9sKmQsdGhpcy5ib3JkZXIvbypkXTtyZXR1cm4gaFsyXT1NYXRoLnNxcnQoYyhoWzBdLDIpLWModGhpcy5ib3JkZXIsMikpLGhbM109TWF0aC5zcXJ0KGMoaFsxXSwyKS1jKHRoaXMuYm9yZGVyLDIpKSxlPWQraFsyXStoWzNdKyhhPzA6aFswXSksaT1lL2Qsbj1bdShpKnMpLHUoaSpvKV0scj9uOm4ucmV2ZXJzZSgpfSxfY2FsY3VsYXRlVGlwOmZ1bmN0aW9uKHQsZSxpKXtpPWl8fDEsZT1lfHx0aGlzLnNpemU7dmFyIG49ZVswXSppLHI9ZVsxXSppLHM9TWF0aC5jZWlsKG4vMiksbz1NYXRoLmNlaWwoci8yKSxhPXticjpbMCwwLG4scixuLDBdLGJsOlswLDAsbiwwLDAscl0sdHI6WzAscixuLDAsbixyXSx0bDpbMCwwLDAscixuLHJdLHRjOlswLHIscywwLG4scl0sYmM6WzAsMCxuLDAscyxyXSxyYzpbMCwwLG4sbywwLHJdLGxjOltuLDAsbixyLDAsb119O3JldHVybiBhLmx0PWEuYnIsYS5ydD1hLmJsLGEubGI9YS50cixhLnJiPWEudGwsYVt0LmFiYnJldigpXX0sX2RyYXdDb29yZHM6ZnVuY3Rpb24odCxlKXt0LmJlZ2luUGF0aCgpLHQubW92ZVRvKGVbMF0sZVsxXSksdC5saW5lVG8oZVsyXSxlWzNdKSx0LmxpbmVUbyhlWzRdLGVbNV0pLHQuY2xvc2VQYXRoKCl9LGNyZWF0ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY29ybmVyPSh2dHx8bnQuaWUpJiZ0aGlzLl9wYXJzZUNvcm5lcih0aGlzLm9wdGlvbnMuY29ybmVyKTtyZXR1cm4gdGhpcy5lbmFibGVkPSEhdGhpcy5jb3JuZXImJiJjIiE9PXRoaXMuY29ybmVyLmFiYnJldigpLHRoaXMuZW5hYmxlZCYmKHRoaXMucXRpcC5jYWNoZS5jb3JuZXI9dC5jbG9uZSgpLHRoaXMudXBkYXRlKCkpLHRoaXMuZWxlbWVudC50b2dnbGUodGhpcy5lbmFibGVkKSx0aGlzLmNvcm5lcn0sdXBkYXRlOmZ1bmN0aW9uKGUsaSl7aWYoIXRoaXMuZW5hYmxlZClyZXR1cm4gdGhpczt2YXIgbixyLHMsYSxsLGMsdSxkLGg9dGhpcy5xdGlwLmVsZW1lbnRzLHA9dGhpcy5lbGVtZW50LGY9cC5jaGlsZHJlbigpLG09dGhpcy5vcHRpb25zLF89dGhpcy5zaXplLGc9bS5taW1pYyx2PU1hdGgucm91bmQ7ZXx8KGU9dGhpcy5xdGlwLmNhY2hlLmNvcm5lcnx8dGhpcy5jb3JuZXIpLGc9PT1ZP2c9ZTooZz1uZXcgTChnKSxnLnByZWNlZGFuY2U9ZS5wcmVjZWRhbmNlLCJpbmhlcml0Ij09PWcueD9nLng9ZS54OiJpbmhlcml0Ij09PWcueT9nLnk9ZS55OmcueD09PWcueSYmKGdbZS5wcmVjZWRhbmNlXT1lW2UucHJlY2VkYW5jZV0pKSxyPWcucHJlY2VkYW5jZSxlLnByZWNlZGFuY2U9PT1BP3RoaXMuX3N3YXBEaW1lbnNpb25zKCk6dGhpcy5fcmVzZXREaW1lbnNpb25zKCksbj10aGlzLmNvbG9yPXRoaXMuX3BhcnNlQ29sb3VycyhlKSxuWzFdIT09X3Q/KGQ9dGhpcy5ib3JkZXI9dGhpcy5fcGFyc2VXaWR0aChlLGVbZS5wcmVjZWRhbmNlXSksbS5ib3JkZXImJmQ8MSYmIXl0LnRlc3QoblsxXSkmJihuWzBdPW5bMV0pLHRoaXMuYm9yZGVyPWQ9bS5ib3JkZXIhPT1EP20uYm9yZGVyOmQpOnRoaXMuYm9yZGVyPWQ9MCx1PXRoaXMuc2l6ZT10aGlzLl9jYWxjdWxhdGVTaXplKGUpLHAuY3NzKHt3aWR0aDp1WzBdLGhlaWdodDp1WzFdLGxpbmVIZWlnaHQ6dVsxXSsicHgifSksYz1lLnByZWNlZGFuY2U9PT1PP1t2KGcueD09PVI/ZDpnLng9PT1qP3VbMF0tX1swXS1kOih1WzBdLV9bMF0pLzIpLHYoZy55PT09UD91WzFdLV9bMV06MCldOlt2KGcueD09PVI/dVswXS1fWzBdOjApLHYoZy55PT09UD9kOmcueT09PUg/dVsxXS1fWzFdLWQ6KHVbMV0tX1sxXSkvMildLHZ0PyhzPWZbMF0uZ2V0Q29udGV4dCgiMmQiKSxzLnJlc3RvcmUoKSxzLnNhdmUoKSxzLmNsZWFyUmVjdCgwLDAsNmUzLDZlMyksYT10aGlzLl9jYWxjdWxhdGVUaXAoZyxfLGN0KSxsPXRoaXMuX2NhbGN1bGF0ZVRpcChnLHRoaXMuc2l6ZSxjdCksZi5hdHRyKE4sdVswXSpjdCkuYXR0cihJLHVbMV0qY3QpLGYuY3NzKE4sdVswXSkuY3NzKEksdVsxXSksdGhpcy5fZHJhd0Nvb3JkcyhzLGwpLHMuZmlsbFN0eWxlPW5bMV0scy5maWxsKCkscy50cmFuc2xhdGUoY1swXSpjdCxjWzFdKmN0KSx0aGlzLl9kcmF3Q29vcmRzKHMsYSkscy5maWxsU3R5bGU9blswXSxzLmZpbGwoKSk6KGE9dGhpcy5fY2FsY3VsYXRlVGlwKGcpLGE9Im0iK2FbMF0rIiwiK2FbMV0rIiBsIithWzJdKyIsIithWzNdKyIgIithWzRdKyIsIithWzVdKyIgeGUiLGNbMl09ZCYmL14ocnxiKS9pLnRlc3QoZS5zdHJpbmcoKSk/OD09PW50LmllPzI6MTowLGYuY3NzKHtjb29yZHNpemU6dVswXStkKyIgIit1WzFdK2QsYW50aWFsaWFzOiIiKyhnLnN0cmluZygpLmluZGV4T2YoRik+LTEpLGxlZnQ6Y1swXS1jWzJdKk51bWJlcihyPT09QSksdG9wOmNbMV0tY1syXSpOdW1iZXIocj09PU8pLHdpZHRoOnVbMF0rZCxoZWlnaHQ6dVsxXStkfSkuZWFjaChmdW5jdGlvbihlKXt2YXIgaT10KHRoaXMpO2lbaS5wcm9wPyJwcm9wIjoiYXR0ciJdKHtjb29yZHNpemU6dVswXStkKyIgIit1WzFdK2QscGF0aDphLGZpbGxjb2xvcjpuWzBdLGZpbGxlZDohIWUsc3Ryb2tlZDohZX0pLnRvZ2dsZSghKCFkJiYhZSkpLCFlJiZpLmh0bWwobHQoInN0cm9rZSIsJ3dlaWdodD0iJysyKmQrJ3B4IiBjb2xvcj0iJytuWzFdKyciIG1pdGVybGltaXQ9IjEwMDAiIGpvaW5zdHlsZT0ibWl0ZXIiJykpfSkpLG8ub3BlcmEmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtoLnRpcC5jc3Moe2Rpc3BsYXk6ImlubGluZS1ibG9jayIsdmlzaWJpbGl0eToidmlzaWJsZSJ9KX0sMSksaSE9PVkmJnRoaXMuY2FsY3VsYXRlKGUsdSl9LGNhbGN1bGF0ZTpmdW5jdGlvbihlLGkpe2lmKCF0aGlzLmVuYWJsZWQpcmV0dXJuIFk7dmFyIG4scixzPXRoaXMsbz10aGlzLnF0aXAuZWxlbWVudHMsYT10aGlzLmVsZW1lbnQsbD10aGlzLm9wdGlvbnMub2Zmc2V0LGM9e307CglyZXR1cm4gZT1lfHx0aGlzLmNvcm5lcixuPWUucHJlY2VkYW5jZSxpPWl8fHRoaXMuX2NhbGN1bGF0ZVNpemUoZSkscj1bZS54LGUueV0sbj09PUEmJnIucmV2ZXJzZSgpLHQuZWFjaChyLGZ1bmN0aW9uKHQscil7dmFyIGEsdSxkO3I9PT1GPyhhPW49PT1PP1I6UCxjW2FdPSI1MCUiLGNbaHQrIi0iK2FdPS1NYXRoLnJvdW5kKGlbbj09PU8/MDoxXS8yKStsKTooYT1zLl9wYXJzZVdpZHRoKGUscixvLnRvb2x0aXApLHU9cy5fcGFyc2VXaWR0aChlLHIsby5jb250ZW50KSxkPXMuX3BhcnNlUmFkaXVzKGUpLGNbcl09TWF0aC5tYXgoLXMuYm9yZGVyLHQ/dTpsKyhkPmE/ZDotYSkpKX0pLGNbZVtuXV0tPWlbbj09PUE/MDoxXSxhLmNzcyh7bWFyZ2luOiIiLHRvcDoiIixib3R0b206IiIsbGVmdDoiIixyaWdodDoiIn0pLmNzcyhjKSxjfSxyZXBvc2l0aW9uOmZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSxpLG4scil7dD09PVcmJmMucHJlY2VkYW5jZT09PWUmJnVbbl0mJmNbaV0hPT1GP2MucHJlY2VkYW5jZT1jLnByZWNlZGFuY2U9PT1BP086QTp0IT09VyYmdVtuXSYmKGNbZV09Y1tlXT09PUY/dVtuXT4wP246cjpjW2VdPT09bj9yOm4pfWZ1bmN0aW9uIHIodCxlLG4pe2NbdF09PT1GP21baHQrIi0iK2VdPWZbdF09c1todCsiLSIrZV0tdVtlXToobz1zW25dIT09bD9bdVtlXSwtc1tlXV06Wy11W2VdLHNbZV1dLChmW3RdPU1hdGgubWF4KG9bMF0sb1sxXSkpPm9bMF0mJihpW2VdLT11W2VdLGZbZV09WSksbVtzW25dIT09bD9uOmVdPWZbdF0pfWlmKHRoaXMuZW5hYmxlZCl7dmFyIHMsbyxhPWUuY2FjaGUsYz10aGlzLmNvcm5lci5jbG9uZSgpLHU9aS5hZGp1c3RlZCxkPWUub3B0aW9ucy5wb3NpdGlvbi5hZGp1c3QubWV0aG9kLnNwbGl0KCIgIiksaD1kWzBdLHA9ZFsxXXx8ZFswXSxmPXtsZWZ0OlksdG9wOlkseDowLHk6MH0sbT17fTt0aGlzLmNvcm5lci5maXhlZCE9PUQmJihuKGgsQSxPLFIsaiksbihwLE8sQSxQLEgpLGMuc3RyaW5nKCk9PT1hLmNvcm5lci5zdHJpbmcoKSYmYS5jb3JuZXJUb3A9PT11LnRvcCYmYS5jb3JuZXJMZWZ0PT09dS5sZWZ0fHx0aGlzLnVwZGF0ZShjLFkpKSxzPXRoaXMuY2FsY3VsYXRlKGMpLHMucmlnaHQhPT1sJiYocy5sZWZ0PS1zLnJpZ2h0KSxzLmJvdHRvbSE9PWwmJihzLnRvcD0tcy5ib3R0b20pLHMudXNlcj10aGlzLm9mZnNldCxmLmxlZnQ9aD09PVcmJiEhdS5sZWZ0LGYubGVmdCYmcihBLFIsaiksZi50b3A9cD09PVcmJiEhdS50b3AsZi50b3AmJnIoTyxQLEgpLHRoaXMuZWxlbWVudC5jc3MobSkudG9nZ2xlKCEoZi54JiZmLnl8fGMueD09PUYmJmYueXx8Yy55PT09RiYmZi54KSksaS5sZWZ0LT1zLmxlZnQuY2hhckF0P3MudXNlcjpoIT09V3x8Zi50b3B8fCFmLmxlZnQmJiFmLnRvcD9zLmxlZnQrdGhpcy5ib3JkZXI6MCxpLnRvcC09cy50b3AuY2hhckF0P3MudXNlcjpwIT09V3x8Zi5sZWZ0fHwhZi5sZWZ0JiYhZi50b3A/cy50b3ArdGhpcy5ib3JkZXI6MCxhLmNvcm5lckxlZnQ9dS5sZWZ0LGEuY29ybmVyVG9wPXUudG9wLGEuY29ybmVyPWMuY2xvbmUoKX19LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnF0aXAuX3VuYmluZCh0aGlzLnF0aXAudG9vbHRpcCx0aGlzLl9ucyksdGhpcy5xdGlwLmVsZW1lbnRzLnRpcCYmdGhpcy5xdGlwLmVsZW1lbnRzLnRpcC5maW5kKCIqIikucmVtb3ZlKCkuZW5kKCkucmVtb3ZlKCl9fSksYXQ9Qi50aXA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyB3KHQsdC5vcHRpb25zLnN0eWxlLnRpcCl9LGF0LmluaXRpYWxpemU9InJlbmRlciIsYXQuc2FuaXRpemU9ZnVuY3Rpb24odCl7aWYodC5zdHlsZSYmInRpcCJpbiB0LnN0eWxlKXt2YXIgZT10LnN0eWxlLnRpcDsib2JqZWN0IiE9dHlwZW9mIGUmJihlPXQuc3R5bGUudGlwPXtjb3JuZXI6ZX0pLC9zdHJpbmd8Ym9vbGVhbi9pLnRlc3QodHlwZW9mIGUuY29ybmVyKXx8KGUuY29ybmVyPUQpfX0seC50aXA9eyJecG9zaXRpb24ubXl8c3R5bGUudGlwLihjb3JuZXJ8bWltaWN8Ym9yZGVyKSQiOmZ1bmN0aW9uKCl7dGhpcy5jcmVhdGUoKSx0aGlzLnF0aXAucmVwb3NpdGlvbigpfSwiXnN0eWxlLnRpcC4oaGVpZ2h0fHdpZHRoKSQiOmZ1bmN0aW9uKHQpe3RoaXMuc2l6ZT1bdC53aWR0aCx0LmhlaWdodF0sdGhpcy51cGRhdGUoKSx0aGlzLnF0aXAucmVwb3NpdGlvbigpfSwiXmNvbnRlbnQudGl0bGV8c3R5bGUuKGNsYXNzZXN8d2lkZ2V0KSQiOmZ1bmN0aW9uKCl7dGhpcy51cGRhdGUoKX19LHQuZXh0ZW5kKEQsVC5kZWZhdWx0cyx7c3R5bGU6e3RpcDp7Y29ybmVyOkQsbWltaWM6WSx3aWR0aDo2LGhlaWdodDo2LGJvcmRlcjpELG9mZnNldDowfX19KTt2YXIgTXQsa3QsVHQ9InF0aXAtbW9kYWwiLFN0PSIuIitUdDtrdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYodC5leHByWyI6Il0uZm9jdXNhYmxlKXJldHVybiB0LmV4cHJbIjoiXS5mb2N1c2FibGU7dmFyIGksbixyLHM9IWlzTmFOKHQuYXR0cihlLCJ0YWJpbmRleCIpKSxvPWUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iYXJlYSI9PT1vPyhpPWUucGFyZW50Tm9kZSxuPWkubmFtZSwhKCFlLmhyZWZ8fCFufHwibWFwIiE9PWkubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkmJihyPXQoImltZ1t1c2VtYXA9IyIrbisiXSIpWzBdLCEhciYmci5pcygiOnZpc2libGUiKSkpOi9pbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9ufG9iamVjdC8udGVzdChvKT8hZS5kaXNhYmxlZDoiYSI9PT1vP2UuaHJlZnx8czpzfWZ1bmN0aW9uIGkodCl7Yy5sZW5ndGg8MSYmdC5sZW5ndGg/dC5ub3QoImJvZHkiKS5ibHVyKCk6Yy5maXJzdCgpLmZvY3VzKCl9ZnVuY3Rpb24gbihlKXtpZihvLmlzKCI6dmlzaWJsZSIpKXt2YXIgbixzPXQoZS50YXJnZXQpLGE9ci50b29sdGlwLGw9cy5jbG9zZXN0KEcpO249bC5sZW5ndGg8MT9ZOnBhcnNlSW50KGxbMF0uc3R5bGUuekluZGV4LDEwKT5wYXJzZUludChhWzBdLnN0eWxlLnpJbmRleCwxMCksbnx8cy5jbG9zZXN0KEcpWzBdPT09YVswXXx8aShzKX19dmFyIHIscyxvLGw9dGhpcyxjPXt9O3QuZXh0ZW5kKGwse2luaXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbz1sLmVsZW09dCgiPGRpdiAvPiIse2lkOiJxdGlwLW92ZXJsYXkiLGh0bWw6IjxkaXY+PC9kaXY+Iixtb3VzZWRvd246ZnVuY3Rpb24oKXtyZXR1cm4gWX19KS5oaWRlKCksdChhLmJvZHkpLmJpbmQoImZvY3VzaW4iK1N0LG4pLHQoYSkuYmluZCgia2V5ZG93biIrU3QsZnVuY3Rpb24odCl7ciYmci5vcHRpb25zLnNob3cubW9kYWwuZXNjYXBlJiYyNz09PXQua2V5Q29kZSYmci5oaWRlKHQpfSksby5iaW5kKCJjbGljayIrU3QsZnVuY3Rpb24odCl7ciYmci5vcHRpb25zLnNob3cubW9kYWwuYmx1ciYmci5oaWRlKHQpfSksbH0sdXBkYXRlOmZ1bmN0aW9uKHQpe3I9dCxjPXQub3B0aW9ucy5zaG93Lm1vZGFsLnN0ZWFsZm9jdXMhPT1ZP3QudG9vbHRpcC5maW5kKCIqIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcyl9KTpbXX0sdG9nZ2xlOmZ1bmN0aW9uKGUsbixjKXt2YXIgdT1lLnRvb2x0aXAsZD1lLm9wdGlvbnMuc2hvdy5tb2RhbCxoPWQuZWZmZWN0LHA9bj8ic2hvdyI6ImhpZGUiLGY9by5pcygiOnZpc2libGUiKSxtPXQoU3QpLmZpbHRlcigiOnZpc2libGU6bm90KDphbmltYXRlZCkiKS5ub3QodSk7cmV0dXJuIGwudXBkYXRlKGUpLG4mJmQuc3RlYWxmb2N1cyE9PVkmJmkodCgiOmZvY3VzIikpLG8udG9nZ2xlQ2xhc3MoImJsdXJzIixkLmJsdXIpLG4mJm8uYXBwZW5kVG8oYS5ib2R5KSxvLmlzKCI6YW5pbWF0ZWQiKSYmZj09PW4mJnMhPT1ZfHwhbiYmbS5sZW5ndGg/bDooby5zdG9wKEQsWSksdC5pc0Z1bmN0aW9uKGgpP2guY2FsbChvLG4pOmg9PT1ZP29bcF0oKTpvLmZhZGVUbyhwYXJzZUludChjLDEwKXx8OTAsbj8xOjAsZnVuY3Rpb24oKXtufHxvLmhpZGUoKX0pLG58fG8ucXVldWUoZnVuY3Rpb24oZSl7by5jc3Moe2xlZnQ6IiIsdG9wOiIifSksdChTdCkubGVuZ3RofHxvLmRldGFjaCgpLGUoKX0pLHM9bixyLmRlc3Ryb3llZCYmKHI9QyksbCl9fSksbC5pbml0KCl9LGt0PW5ldyBrdCx0LmV4dGVuZChNLnByb3RvdHlwZSx7aW5pdDpmdW5jdGlvbihlKXt2YXIgaT1lLnRvb2x0aXA7cmV0dXJuIHRoaXMub3B0aW9ucy5vbj8oZS5lbGVtZW50cy5vdmVybGF5PWt0LmVsZW0saS5hZGRDbGFzcyhUdCkuY3NzKCJ6LWluZGV4IixULm1vZGFsX3ppbmRleCt0KFN0KS5sZW5ndGgpLGUuX2JpbmQoaSxbInRvb2x0aXBzaG93IiwidG9vbHRpcGhpZGUiXSxmdW5jdGlvbihlLG4scil7dmFyIHM9ZS5vcmlnaW5hbEV2ZW50O2lmKGUudGFyZ2V0PT09aVswXSlpZihzJiYidG9vbHRpcGhpZGUiPT09ZS50eXBlJiYvbW91c2UobGVhdmV8ZW50ZXIpLy50ZXN0KHMudHlwZSkmJnQocy5yZWxhdGVkVGFyZ2V0KS5jbG9zZXN0KGt0LmVsZW1bMF0pLmxlbmd0aCl0cnl7ZS5wcmV2ZW50RGVmYXVsdCgpfWNhdGNoKG8pe31lbHNlKCFzfHxzJiYidG9vbHRpcHNvbG8iIT09cy50eXBlKSYmdGhpcy50b2dnbGUoZSwidG9vbHRpcHNob3ciPT09ZS50eXBlLHIpfSx0aGlzLl9ucyx0aGlzKSxlLl9iaW5kKGksInRvb2x0aXBmb2N1cyIsZnVuY3Rpb24oZSxuKXtpZighZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSYmZS50YXJnZXQ9PT1pWzBdKXt2YXIgcj10KFN0KSxzPVQubW9kYWxfemluZGV4K3IubGVuZ3RoLG89cGFyc2VJbnQoaVswXS5zdHlsZS56SW5kZXgsMTApO2t0LmVsZW1bMF0uc3R5bGUuekluZGV4PXMtMSxyLmVhY2goZnVuY3Rpb24oKXt0aGlzLnN0eWxlLnpJbmRleD5vJiYodGhpcy5zdHlsZS56SW5kZXgtPTEpfSksci5maWx0ZXIoIi4iK1gpLnF0aXAoImJsdXIiLGUub3JpZ2luYWxFdmVudCksaS5hZGRDbGFzcyhYKVswXS5zdHlsZS56SW5kZXg9cyxrdC51cGRhdGUobik7dHJ5e2UucHJldmVudERlZmF1bHQoKX1jYXRjaChhKXt9fX0sdGhpcy5fbnMsdGhpcyksdm9pZCBlLl9iaW5kKGksInRvb2x0aXBoaWRlIixmdW5jdGlvbihlKXtlLnRhcmdldD09PWlbMF0mJnQoU3QpLmZpbHRlcigiOnZpc2libGUiKS5ub3QoaSkubGFzdCgpLnF0aXAoImZvY3VzIixlKX0sdGhpcy5fbnMsdGhpcykpOnRoaXN9LHRvZ2dsZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQmJnQuaXNEZWZhdWx0UHJldmVudGVkKCk/dGhpczp2b2lkIGt0LnRvZ2dsZSh0aGlzLnF0aXAsISFlLGkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5xdGlwLnRvb2x0aXAucmVtb3ZlQ2xhc3MoVHQpLHRoaXMucXRpcC5fdW5iaW5kKHRoaXMucXRpcC50b29sdGlwLHRoaXMuX25zKSxrdC50b2dnbGUodGhpcy5xdGlwLFkpLGRlbGV0ZSB0aGlzLnF0aXAuZWxlbWVudHMub3ZlcmxheX19KSxNdD1CLm1vZGFsPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgTSh0LHQub3B0aW9ucy5zaG93Lm1vZGFsKX0sTXQuc2FuaXRpemU9ZnVuY3Rpb24odCl7dC5zaG93JiYoIm9iamVjdCIhPXR5cGVvZiB0LnNob3cubW9kYWw/dC5zaG93Lm1vZGFsPXtvbjohIXQuc2hvdy5tb2RhbH06InVuZGVmaW5lZCI9PXR5cGVvZiB0LnNob3cubW9kYWwub24mJih0LnNob3cubW9kYWwub249RCkpfSxULm1vZGFsX3ppbmRleD1ULnppbmRleC0yMDAsTXQuaW5pdGlhbGl6ZT0icmVuZGVyIix4Lm1vZGFsPXsiXnNob3cubW9kYWwuKG9ufGJsdXIpJCI6ZnVuY3Rpb24oKXt0aGlzLmRlc3Ryb3koKSx0aGlzLmluaXQoKSx0aGlzLnF0aXAuZWxlbXMub3ZlcmxheS50b2dnbGUodGhpcy5xdGlwLnRvb2x0aXBbMF0ub2Zmc2V0V2lkdGg+MCl9fSx0LmV4dGVuZChELFQuZGVmYXVsdHMse3Nob3c6e21vZGFsOntvbjpZLGVmZmVjdDpELGJsdXI6RCxzdGVhbGZvY3VzOkQsZXNjYXBlOkR9fX0pLEIudmlld3BvcnQ9ZnVuY3Rpb24odCxlLGksbixyLHMsbCl7ZnVuY3Rpb24gYyh0LGksbixyLHMsbyxhLGwsYyl7dmFyIHU9ZVtzXSx2PWJbdF0seT13W3RdLE09bj09PVcsaz12PT09cz9jOnY9PT1vPy1jOi1jLzIsVD15PT09cz9sOnk9PT1vPy1sOi1sLzIsUz1fW3NdK2dbc10tKHA/MDpoW3NdKSxMPVMtdSx4PXUrYy0oYT09PU4/ZjptKS1TLEU9ay0oYi5wcmVjZWRhbmNlPT09dHx8dj09PWJbaV0/VDowKS0oeT09PUY/bC8yOjApO3JldHVybiBNPyhFPSh2PT09cz8xOi0xKSprLGVbc10rPUw+MD9MOng+MD8teDowLGVbc109TWF0aC5tYXgoLWhbc10rZ1tzXSx1LUUsTWF0aC5taW4oTWF0aC5tYXgoLWhbc10rZ1tzXSsoYT09PU4/ZjptKSx1K0UpLGVbc10sImNlbnRlciI9PT12P3UtazoxZTkpKSk6KHIqPW49PT1VPzI6MCxMPjAmJih2IT09c3x8eD4wKT8oZVtzXS09RStyLGQuaW52ZXJ0KHQscykpOng+MCYmKHYhPT1vfHxMPjApJiYoZVtzXS09KHY9PT1GPy1FOkUpK3IsZC5pbnZlcnQodCxvKSksZVtzXTxfW3NdJiYtZVtzXT54JiYoZVtzXT11LGQ9Yi5jbG9uZSgpKSksZVtzXS11fXZhciB1LGQsaCxwLGYsbSxfLGcsdj1pLnRhcmdldCx5PXQuZWxlbWVudHMudG9vbHRpcCxiPWkubXksdz1pLmF0LE09aS5hZGp1c3Qsaz1NLm1ldGhvZC5zcGxpdCgiICIpLFQ9a1swXSxTPWtbMV18fGtbMF0sTD1pLnZpZXdwb3J0LHg9aS5jb250YWluZXIsRT17bGVmdDowLHRvcDowfTtyZXR1cm4gTC5qcXVlcnkmJnZbMF0hPT1vJiZ2WzBdIT09YS5ib2R5JiYibm9uZSIhPT1NLm1ldGhvZD8oaD14Lm9mZnNldCgpfHxFLHA9InN0YXRpYyI9PT14LmNzcygicG9zaXRpb24iKSx1PSJmaXhlZCI9PT15LmNzcygicG9zaXRpb24iKSxmPUxbMF09PT1vP0wud2lkdGgoKTpMLm91dGVyV2lkdGgoWSksbT1MWzBdPT09bz9MLmhlaWdodCgpOkwub3V0ZXJIZWlnaHQoWSksXz17bGVmdDp1PzA6TC5zY3JvbGxMZWZ0KCksdG9wOnU/MDpMLnNjcm9sbFRvcCgpfSxnPUwub2Zmc2V0KCl8fEUsInNoaWZ0Ij09PVQmJiJzaGlmdCI9PT1TfHwoZD1iLmNsb25lKCkpLEU9e2xlZnQ6Im5vbmUiIT09VD9jKEEsTyxULE0ueCxSLGosTixuLHMpOjAsdG9wOiJub25lIiE9PVM/YyhPLEEsUyxNLnksUCxILEkscixsKTowLG15OmR9KTpFfSxCLnBvbHlzPXtwb2x5Z29uOmZ1bmN0aW9uKHQsZSl7dmFyIGksbixyLHM9e3dpZHRoOjAsaGVpZ2h0OjAscG9zaXRpb246e3RvcDoxZTEwLHJpZ2h0OjAsYm90dG9tOjAsbGVmdDoxZTEwfSxhZGp1c3RhYmxlOll9LG89MCxhPVtdLGw9MSxjPTEsdT0wLGQ9MDtmb3Iobz10Lmxlbmd0aDtvLS07KWk9W3BhcnNlSW50KHRbLS1vXSwxMCkscGFyc2VJbnQodFtvKzFdLDEwKV0saVswXT5zLnBvc2l0aW9uLnJpZ2h0JiYocy5wb3NpdGlvbi5yaWdodD1pWzBdKSxpWzBdPHMucG9zaXRpb24ubGVmdCYmKHMucG9zaXRpb24ubGVmdD1pWzBdKSxpWzFdPnMucG9zaXRpb24uYm90dG9tJiYocy5wb3NpdGlvbi5ib3R0b209aVsxXSksaVsxXTxzLnBvc2l0aW9uLnRvcCYmKHMucG9zaXRpb24udG9wPWlbMV0pLGEucHVzaChpKTtpZihuPXMud2lkdGg9TWF0aC5hYnMocy5wb3NpdGlvbi5yaWdodC1zLnBvc2l0aW9uLmxlZnQpLHI9cy5oZWlnaHQ9TWF0aC5hYnMocy5wb3NpdGlvbi5ib3R0b20tcy5wb3NpdGlvbi50b3ApLCJjIj09PWUuYWJicmV2KCkpcy5wb3NpdGlvbj17bGVmdDpzLnBvc2l0aW9uLmxlZnQrcy53aWR0aC8yLHRvcDpzLnBvc2l0aW9uLnRvcCtzLmhlaWdodC8yfTtlbHNle2Zvcig7bj4wJiZyPjAmJmw+MCYmYz4wOylmb3Iobj1NYXRoLmZsb29yKG4vMikscj1NYXRoLmZsb29yKHIvMiksZS54PT09Uj9sPW46ZS54PT09aj9sPXMud2lkdGgtbjpsKz1NYXRoLmZsb29yKG4vMiksZS55PT09UD9jPQ==", "base64"));
  res.write(new Buffer("cjplLnk9PT1IP2M9cy5oZWlnaHQtcjpjKz1NYXRoLmZsb29yKHIvMiksbz1hLmxlbmd0aDtvLS0mJiEoYS5sZW5ndGg8Mik7KXU9YVtvXVswXS1zLnBvc2l0aW9uLmxlZnQsZD1hW29dWzFdLXMucG9zaXRpb24udG9wLChlLng9PT1SJiZ1Pj1sfHxlLng9PT1qJiZ1PD1sfHxlLng9PT1GJiYodTxsfHx1PnMud2lkdGgtbCl8fGUueT09PVAmJmQ+PWN8fGUueT09PUgmJmQ8PWN8fGUueT09PUYmJihkPGN8fGQ+cy5oZWlnaHQtYykpJiZhLnNwbGljZShvLDEpO3MucG9zaXRpb249e2xlZnQ6YVswXVswXSx0b3A6YVswXVsxXX19cmV0dXJuIHN9LHJlY3Q6ZnVuY3Rpb24odCxlLGksbil7cmV0dXJue3dpZHRoOk1hdGguYWJzKGktdCksaGVpZ2h0Ok1hdGguYWJzKG4tZSkscG9zaXRpb246e2xlZnQ6TWF0aC5taW4odCxpKSx0b3A6TWF0aC5taW4oZSxuKX19fSxfYW5nbGVzOnt0YzoxLjUsdHI6Ny80LHRsOjUvNCxiYzouNSxicjouMjUsYmw6Ljc1LHJjOjIsbGM6MSxjOjB9LGVsbGlwc2U6ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz1CLnBvbHlzLl9hbmdsZXNbci5hYmJyZXYoKV0sbz0wPT09cz8wOmkqTWF0aC5jb3MocypNYXRoLlBJKSxhPW4qTWF0aC5zaW4ocypNYXRoLlBJKTtyZXR1cm57d2lkdGg6MippLU1hdGguYWJzKG8pLGhlaWdodDoyKm4tTWF0aC5hYnMoYSkscG9zaXRpb246e2xlZnQ6dCtvLHRvcDplK2F9LGFkanVzdGFibGU6WX19LGNpcmNsZTpmdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gQi5wb2x5cy5lbGxpcHNlKHQsZSxpLGksbil9fSxCLnN2Zz1mdW5jdGlvbihlLGksbil7Zm9yKHZhciByLHMsbyxsLGMsdSxkLGgscCxmPWlbMF0sbT10KGYub3duZXJTVkdFbGVtZW50KSxfPWYub3duZXJEb2N1bWVudCxnPShwYXJzZUludChpLmNzcygic3Ryb2tlLXdpZHRoIiksMTApfHwwKS8yOyFmLmdldEJCb3g7KWY9Zi5wYXJlbnROb2RlO2lmKCFmLmdldEJCb3h8fCFmLnBhcmVudE5vZGUpcmV0dXJuIFk7c3dpdGNoKGYubm9kZU5hbWUpe2Nhc2UiZWxsaXBzZSI6Y2FzZSJjaXJjbGUiOmg9Qi5wb2x5cy5lbGxpcHNlKGYuY3guYmFzZVZhbC52YWx1ZSxmLmN5LmJhc2VWYWwudmFsdWUsKGYucnh8fGYucikuYmFzZVZhbC52YWx1ZStnLChmLnJ5fHxmLnIpLmJhc2VWYWwudmFsdWUrZyxuKTticmVhaztjYXNlImxpbmUiOmNhc2UicG9seWdvbiI6Y2FzZSJwb2x5bGluZSI6Zm9yKGQ9Zi5wb2ludHN8fFt7eDpmLngxLmJhc2VWYWwudmFsdWUseTpmLnkxLmJhc2VWYWwudmFsdWV9LHt4OmYueDIuYmFzZVZhbC52YWx1ZSx5OmYueTIuYmFzZVZhbC52YWx1ZX1dLGg9W10sdT0tMSxsPWQubnVtYmVyT2ZJdGVtc3x8ZC5sZW5ndGg7Kyt1PGw7KWM9ZC5nZXRJdGVtP2QuZ2V0SXRlbSh1KTpkW3VdLGgucHVzaC5hcHBseShoLFtjLngsYy55XSk7aD1CLnBvbHlzLnBvbHlnb24oaCxuKTticmVhaztkZWZhdWx0Omg9Zi5nZXRCQm94KCksaD17d2lkdGg6aC53aWR0aCxoZWlnaHQ6aC5oZWlnaHQscG9zaXRpb246e2xlZnQ6aC54LHRvcDpoLnl9fX1yZXR1cm4gcD1oLnBvc2l0aW9uLG09bVswXSxtLmNyZWF0ZVNWR1BvaW50JiYocz1mLmdldFNjcmVlbkNUTSgpLGQ9bS5jcmVhdGVTVkdQb2ludCgpLGQueD1wLmxlZnQsZC55PXAudG9wLG89ZC5tYXRyaXhUcmFuc2Zvcm0ocykscC5sZWZ0PW8ueCxwLnRvcD1vLnkpLF8hPT1hJiYibW91c2UiIT09ZS5wb3NpdGlvbi50YXJnZXQmJihyPXQoKF8uZGVmYXVsdFZpZXd8fF8ucGFyZW50V2luZG93KS5mcmFtZUVsZW1lbnQpLm9mZnNldCgpLHImJihwLmxlZnQrPXIubGVmdCxwLnRvcCs9ci50b3ApKSxfPXQoXykscC5sZWZ0Kz1fLnNjcm9sbExlZnQoKSxwLnRvcCs9Xy5zY3JvbGxUb3AoKSxofSxCLmltYWdlbWFwPWZ1bmN0aW9uKGUsaSxuKXtpLmpxdWVyeXx8KGk9dChpKSk7dmFyIHIscyxvLGEsbCxjPShpLmF0dHIoInNoYXBlIil8fCJyZWN0IikudG9Mb3dlckNhc2UoKS5yZXBsYWNlKCJwb2x5IiwicG9seWdvbiIpLHU9dCgnaW1nW3VzZW1hcD0iIycraS5wYXJlbnQoIm1hcCIpLmF0dHIoIm5hbWUiKSsnIl0nKSxkPXQudHJpbShpLmF0dHIoImNvb3JkcyIpKSxoPWQucmVwbGFjZSgvLCQvLCIiKS5zcGxpdCgiLCIpO2lmKCF1Lmxlbmd0aClyZXR1cm4gWTtpZigicG9seWdvbiI9PT1jKWE9Qi5wb2x5cy5wb2x5Z29uKGgsbik7ZWxzZXtpZighQi5wb2x5c1tjXSlyZXR1cm4gWTtmb3Iobz0tMSxsPWgubGVuZ3RoLHM9W107KytvPGw7KXMucHVzaChwYXJzZUludChoW29dLDEwKSk7YT1CLnBvbHlzW2NdLmFwcGx5KHRoaXMscy5jb25jYXQobikpfXJldHVybiByPXUub2Zmc2V0KCksci5sZWZ0Kz1NYXRoLmNlaWwoKHUub3V0ZXJXaWR0aChZKS11LndpZHRoKCkpLzIpLHIudG9wKz1NYXRoLmNlaWwoKHUub3V0ZXJIZWlnaHQoWSktdS5oZWlnaHQoKSkvMiksYS5wb3NpdGlvbi5sZWZ0Kz1yLmxlZnQsYS5wb3NpdGlvbi50b3ArPXIudG9wLGF9O3ZhciBMdCx4dD0nPGlmcmFtZSBjbGFzcz0icXRpcC1iZ2lmcmFtZSIgZnJhbWVib3JkZXI9IjAiIHRhYmluZGV4PSItMSIgc3JjPSJqYXZhc2NyaXB0OlwnXCc7IiAgc3R5bGU9ImRpc3BsYXk6YmxvY2s7IHBvc2l0aW9uOmFic29sdXRlOyB6LWluZGV4Oi0xOyBmaWx0ZXI6YWxwaGEob3BhY2l0eT0wKTsgLW1zLWZpbHRlcjoicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LkFscGhhKE9wYWNpdHk9MCkiOyI+PC9pZnJhbWU+Jzt0LmV4dGVuZChrLnByb3RvdHlwZSx7X3Njcm9sbDpmdW5jdGlvbigpe3ZhciBlPXRoaXMucXRpcC5lbGVtZW50cy5vdmVybGF5O2UmJihlWzBdLnN0eWxlLnRvcD10KG8pLnNjcm9sbFRvcCgpKyJweCIpfSxpbml0OmZ1bmN0aW9uKGUpe3ZhciBpPWUudG9vbHRpcDt0KCJzZWxlY3QsIG9iamVjdCIpLmxlbmd0aDwxJiYodGhpcy5iZ2lmcmFtZT1lLmVsZW1lbnRzLmJnaWZyYW1lPXQoeHQpLmFwcGVuZFRvKGkpLGUuX2JpbmQoaSwidG9vbHRpcG1vdmUiLHRoaXMuYWRqdXN0QkdJRnJhbWUsdGhpcy5fbnMsdGhpcykpLHRoaXMucmVkcmF3Q29udGFpbmVyPXQoIjxkaXYvPiIse2lkOnorIi1yY29udGFpbmVyIn0pLmFwcGVuZFRvKGEuYm9keSksZS5lbGVtZW50cy5vdmVybGF5JiZlLmVsZW1lbnRzLm92ZXJsYXkuYWRkQ2xhc3MoInF0aXBtb2RhbC1pZTZmaXgiKSYmKGUuX2JpbmQobyxbInNjcm9sbCIsInJlc2l6ZSJdLHRoaXMuX3Njcm9sbCx0aGlzLl9ucyx0aGlzKSxlLl9iaW5kKGksWyJ0b29sdGlwc2hvdyJdLHRoaXMuX3Njcm9sbCx0aGlzLl9ucyx0aGlzKSksdGhpcy5yZWRyYXcoKX0sYWRqdXN0QkdJRnJhbWU6ZnVuY3Rpb24oKXt2YXIgdCxlLGk9dGhpcy5xdGlwLnRvb2x0aXAsbj17aGVpZ2h0Omkub3V0ZXJIZWlnaHQoWSksd2lkdGg6aS5vdXRlcldpZHRoKFkpfSxyPXRoaXMucXRpcC5wbHVnaW5zLnRpcCxzPXRoaXMucXRpcC5lbGVtZW50cy50aXA7ZT1wYXJzZUludChpLmNzcygiYm9yZGVyTGVmdFdpZHRoIiksMTApfHwwLGU9e2xlZnQ6LWUsdG9wOi1lfSxyJiZzJiYodD0ieCI9PT1yLmNvcm5lci5wcmVjZWRhbmNlP1tOLFJdOltJLFBdLGVbdFsxXV0tPXNbdFswXV0oKSksdGhpcy5iZ2lmcmFtZS5jc3MoZSkuY3NzKG4pfSxyZWRyYXc6ZnVuY3Rpb24oKXtpZih0aGlzLnF0aXAucmVuZGVyZWQ8MXx8dGhpcy5kcmF3aW5nKXJldHVybiB0aGlzO3ZhciB0LGUsaSxuLHI9dGhpcy5xdGlwLnRvb2x0aXAscz10aGlzLnF0aXAub3B0aW9ucy5zdHlsZSxvPXRoaXMucXRpcC5vcHRpb25zLnBvc2l0aW9uLmNvbnRhaW5lcjtyZXR1cm4gdGhpcy5xdGlwLmRyYXdpbmc9MSxzLmhlaWdodCYmci5jc3MoSSxzLmhlaWdodCkscy53aWR0aD9yLmNzcyhOLHMud2lkdGgpOihyLmNzcyhOLCIiKS5hcHBlbmRUbyh0aGlzLnJlZHJhd0NvbnRhaW5lciksZT1yLndpZHRoKCksZSUyPDEmJihlKz0xKSxpPXIuY3NzKCJtYXhXaWR0aCIpfHwiIixuPXIuY3NzKCJtaW5XaWR0aCIpfHwiIix0PShpK24pLmluZGV4T2YoIiUiKT4tMT9vLndpZHRoKCkvMTAwOjAsaT0oaS5pbmRleE9mKCIlIik+LTE/dDoxKnBhcnNlSW50KGksMTApKXx8ZSxuPShuLmluZGV4T2YoIiUiKT4tMT90OjEqcGFyc2VJbnQobiwxMCkpfHwwLGU9aStuP01hdGgubWluKE1hdGgubWF4KGUsbiksaSk6ZSxyLmNzcyhOLE1hdGgucm91bmQoZSkpLmFwcGVuZFRvKG8pKSx0aGlzLmRyYXdpbmc9MCx0aGlzfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5iZ2lmcmFtZSYmdGhpcy5iZ2lmcmFtZS5yZW1vdmUoKSx0aGlzLnF0aXAuX3VuYmluZChbbyx0aGlzLnF0aXAudG9vbHRpcF0sdGhpcy5fbnMpfX0pLEx0PUIuaWU2PWZ1bmN0aW9uKHQpe3JldHVybiA2PT09bnQuaWU/bmV3IGsodCk6WX0sTHQuaW5pdGlhbGl6ZT0icmVuZGVyIix4LmllNj17Il5jb250ZW50fHN0eWxlJCI6ZnVuY3Rpb24oKXt0aGlzLnJlZHJhdygpfX19KX0od2luZG93LGRvY3VtZW50KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NiksaSgyMzMpXSxyPWZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKGUsaSl7ZS5hcHBseSh0aGlzLHQubWFwKGkuc3BsaXQoL1xzKy8pLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm1vZGVsLmdldCh0KX0sdGhpcykpfWZ1bmN0aW9uIHIoZSxpKXt0LmlzRnVuY3Rpb24oZSkmJmUuY2FsbChpKX1yZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZTpmdW5jdGlvbigpe3ZhciB0PSJvLWZvcm0tZmllbGRzZXQiO3JldHVybiB0aGlzLm9wdGlvbnNbImxhYmVsLXRvcCJdJiYodCs9IiBvLWZvcm0tbGFiZWwtdG9wIiksdGhpcy5vcHRpb25zLnJlYWRPbmx5JiYodCs9IiBvLWZvcm0tcmVhZC1tb2RlIiksdH0sYXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybnsiZGF0YS1zZSI6dGhpcy5vcHRpb25zWyJkYXRhLXNlIl18fCJvLWZvcm0tZmllbGRzZXQifX0sY29uc3RydWN0b3I6ZnVuY3Rpb24ocyl7cy5jbGFzc05hbWUmJih0aGlzLmlucHV0V3JhcHBlckNsYXNzTmFtZT10aGlzLmNsYXNzTmFtZSx0aGlzLm9wdGlvbnNDbGFzc05hbWU9cy5jbGFzc05hbWUscy5jbGFzc05hbWU9ZnVuY3Rpb24oKXtyZXR1cm4gdC5yZXN1bHQodGhpcywiaW5wdXRXcmFwcGVyQ2xhc3NOYW1lIiwiIikrIiAiK3QucmVzdWx0KHRoaXMsIm9wdGlvbnNDbGFzc05hbWUiKX0pLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQuZWFjaChzLmV2ZW50c3x8e30sZnVuY3Rpb24odCxlKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsZSx0KX0sdGhpcyksdC5lYWNoKHMuYmluZGluZ3N8fHt9LGZ1bmN0aW9uKGUscil7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLGkuY2hhbmdlRXZlbnRTdHJpbmcoci5zcGxpdCgvXHMrLykpLHQuYmluZChuLHRoaXMsZSxyKSl9LHRoaXMpLGkuYXBwbHlTaG93V2hlbih0aGlzLHMuc2hvd1doZW4pLGkuYXBwbHlUb2dnbGVXaGVuKHRoaXMscy50b2dnbGVXaGVuKSxyKHMuaW5pdGlhbGl6ZSx0aGlzKX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3QuZWFjaCh0aGlzLm9wdGlvbnMuYmluZGluZ3N8fHt9LG4sdGhpcykscih0aGlzLm9wdGlvbnMucmVuZGVyLHRoaXMpfSxnZXRMYWJlbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNpemUoKT4xP3RoaXMuYXQoMCk6bnVsbH0sZ2V0SW5wdXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRJbnB1dENvbnRhaW5lcigpfSxnZXRJbnB1dENvbnRhaW5lcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmF0KHRoaXMuc2l6ZSgpPjE/MTowKX0sZ2V0SW5wdXRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0SW5wdXRDb250YWluZXIoKS50b0FycmF5KCl9LGZvY3VzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0SW5wdXQoKS5mb2N1cygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNzcpLGkoMTQ2KSxpKDE3MyksaSgxNDQpLGkoMTU1KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyl7ZnVuY3Rpb24gbyhlKXtpZihlJiYhZS5fX2VkaXRfXylyZXR1cm4gdC5leHRlbmQoe19fZWRpdF9fOnQuY29uc3RhbnQoITApfSxlKX1mdW5jdGlvbiBhKGUpe2U9dC5waWNrKGV8fHt9LCJhY3Rpb24iLCJpZCIsImNsYXNzTmFtZSIsInRleHQiLCJ0eXBlIik7dmFyIHIscyxvO3JldHVybiBpLmV4dGVuZCh7dGFnTmFtZToiaW5wdXQiLGNsYXNzTmFtZToiYnV0dG9uIixldmVudHM6e2NsaWNrOmZ1bmN0aW9uKCl7ZS5hY3Rpb24mJiF0aGlzLmRpc2FibGVkKCkmJmUuYWN0aW9uLmNhbGwodGhpcyl9LGtleXVwOmZ1bmN0aW9uKHQpe24uaXNFbnRlcih0KSYmZS5hY3Rpb24mJiF0aGlzLmRpc2FibGVkKCkmJmUuYWN0aW9uLmNhbGwodGhpcyl9fSxkaXNhYmxlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRlbC5wcm9wKCJkaXNhYmxlZCIpPT09ITB9LGRpc2FibGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5wcm9wKCJkaXNhYmxlZCIsITApLHRoaXMuJGVsLmFkZENsYXNzKCJidG4tZGlzYWJsZWQiKX0sZW5hYmxlOmZ1bmN0aW9uKCl7dGhpcy4kZWwucHJvcCgiZGlzYWJsZWQiLCExKSx0aGlzLiRlbC5yZW1vdmVDbGFzcygiYnRuLWRpc2FibGVkIil9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgaT10aGlzO3RoaXMuJGVsLmF0dHIoInR5cGUiLCJzYXZlIj09ZS50eXBlPyJzdWJtaXQiOiJidXR0b24iKSx0aGlzLiRlbC52YWwoZS50ZXh0KSxlLmlkJiZ0aGlzLiRlbC5hdHRyKCJpZCIsZS5pZCksZS5jbGFzc05hbWUmJnRoaXMuJGVsLmFkZENsYXNzKGUuY2xhc3NOYW1lKSxlLnR5cGUmJnRoaXMuJGVsLmF0dHIoImRhdGEtdHlwZSIsZS50eXBlKSx0aGlzLiRlbC5tb3VzZWRvd24oZnVuY3Rpb24oKXtpLm1vZGVsLnNldCgiX19wZW5kaW5nX18iLCEwKX0pLHRoaXMuJGVsLm1vdXNldXAoZnVuY3Rpb24oKXtpLm1vZGVsLnNldCgiX19wZW5kaW5nX18iLCExKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpzZXQtc2F2aW5nLXN0YXRlIixmdW5jdGlvbigpe3RoaXMuZGlzYWJsZSgpLCJzYXZlIj09ZS50eXBlJiYocj1zZXRUaW1lb3V0KHQuYmluZCh0aGlzLl9fY2hhbmdlU2F2ZVRleHQsdGhpcyksMWUzKSl9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImZvcm06Y2xlYXItc2F2aW5nLXN0YXRlIixmdW5jdGlvbigpe3RoaXMuZW5hYmxlKCksInNhdmUiPT1lLnR5cGUmJihjbGVhclRpbWVvdXQociksY2xlYXJJbnRlcnZhbChzKSx0aGlzLiRlbC52YWwoZS50ZXh0KSl9KX0sX19jaGFuZ2VTYXZlVGV4dDpmdW5jdGlvbigpe289MCxzPXNldEludGVydmFsKHQuYmluZCh0aGlzLl9fc2hvd0xvYWRpbmdUZXh0LHRoaXMpLDIwMCl9LF9fc2hvd0xvYWRpbmdUZXh0OmZ1bmN0aW9uKCl7dGhpcy4kZWwudmFsKF9bbysrJV8ubGVuZ3RoXSl9fSl9ZnVuY3Rpb24gbChlLGkpe2lmKGV8fChlPXt9KSwibGFiZWwiPT1lLnR5cGUpcmV0dXJuIHZvaWQoZS5sYWJlbHx8ci53YXJuKCdBIGxhYmVsIGlucHV0IG11c3QgaGF2ZSBhICJsYWJlbCIgcGFyYW1ldGVyJyxlKSk7aWYoImJ1dHRvbiI9PWUudHlwZSlyZXR1cm4gZS50aXRsZXx8ZS5pY29ufHxyLndhcm4oJ0EgYnV0dG9uIGlucHV0IG11c3QgaGF2ZSBhICJ0aXRsZSIgYW5kL29yIGFuICJpY29uIiBwYXJhbWV0ZXInLGUpLHZvaWQoZS5jbGlja3x8ZS5ocmVmfHxyLndhcm4oJ0EgYnV0dG9uIGlucHV0IG11c3QgaGF2ZSBhICJjbGljayIgYW5kL29yIGFuICJocmVmIiBwYXJhbWV0ZXInLGUpKTtpZihlLm5hbWV8fGUuaW5wdXR8fHIud2FybignTWlzc2luZyAibmFtZSIgb3IgImlucHV0IiBwYXJhbWV0ZXJzJyxlKSx0LmlzQXJyYXkoZS5uYW1lKSYmdC5pc0FycmF5KGUuaW5wdXQpKXRocm93IG5ldyBFcnJvcignTm90IGFsbG93ZWQgdG8gaGF2ZSBib3RoICJuYW1lIiBhbmQgImlucHV0IiBkZWZpbmVkIGFzIGFycmF5LicpO2lmKCJsaXN0IiE9ZS50eXBlJiZlLm5hbWUmJmkmJmkuYWxsb3dzKXt2YXIgbj1bXTt0LmlzQXJyYXkoZS5uYW1lKT9uPWUubmFtZTpuLnB1c2goZS5uYW1lKSx0LmVhY2gobixmdW5jdGlvbih0KXtpZighaS5hbGxvd3ModCkpdGhyb3cgbmV3IEVycm9yKCJmaWVsZCBub3QgYWxsb3dlZDogIitlLm5hbWUpfSl9dC5pc0FycmF5KGUuaW5wdXQpJiYibGlzdCIhPWUudHlwZSYmdC5lYWNoKGUuaW5wdXQsZnVuY3Rpb24odCl7bCh0LGkpfSk7dmFyIHM9dC5rZXlzKGUpLG89dC5pbnRlcnNlY3Rpb24ocyxtKTtpZih0LnNpemUobykhPXQuc2l6ZShlKSl7dmFyIGE9dC5jbG9uZShtKTthLnVuc2hpZnQocyksci53YXJuKCJJbnZhbGlkIGlucHV0IHBhcmFtZXRlcnMiLHQud2l0aG91dC5hcHBseShudWxsLGEpLGUpfX1mdW5jdGlvbiBjKGUsaSxuKXtlPXQuY2xvbmUoZSksdC5jb250YWlucyhbImxpc3QiLCJncm91cCJdLGUudHlwZSkmJihlLnBhcmFtcz10LmRlZmF1bHRzKHtjcmVhdGU6bixpbnB1dHM6dC5tYXAodC5pc0FycmF5KGUuaW5wdXQpP2UuaW5wdXQ6W2UuaW5wdXRdLGZ1bmN0aW9uKGUpe3JldHVybiB0LmZpcnN0KGMoZSxpLG4pKX0pfSxlLnBhcmFtc3x8e30pLGRlbGV0ZSBlLmlucHV0KTt2YXIgcj10LmlzQXJyYXkoZS5pbnB1dCk/dC5jbG9uZShlLmlucHV0KTpbZV07cmV0dXJuIHQubWFwKHIsZnVuY3Rpb24obil7dmFyIHI9dC5kZWZhdWx0cyh7bW9kZWw6aS5tb2RlbH0sbix0Lm9taXQoZSwiaW5wdXQiLCJpbnB1dHMiKSxpLm9wdGlvbnMse2lkOnQudW5pcXVlSWQoImlucHV0IikscmVhZE9ubHk6aS5pc1JlYWRPbmx5KCkscmVhZDppLmhhc1JlYWRNb2RlKCl9KTtyZXR1cm4gaS5pc1JlYWRPbmx5KCkmJihyLnJlYWQ9ci5yZWFkT25seT0hMCkscn0pfXZhciB1PVsibW9kZWwiLCJpZCIsImlucHV0SWQiLCJ0eXBlIiwibGFiZWwiLCJzdWJsYWJlbCIsInRvb2x0aXAiLCJuYW1lIl0sZD1bIndpZGUiLCJtdWx0aSIsImlucHV0IiwiZXhwbGFpbiIsImN1c3RvbUV4cGxhaW4iLCJtb2RlbCIsIm5hbWUiLCJ0eXBlIiwiYXV0b1JlbmRlciJdLGg9WyJtb2RlbCIsIm5hbWUiLCJsYWJlbC10b3AiLCJyZWFkT25seSIsImV2ZW50cyIsImluaXRpYWxpemUiLCJzaG93V2hlbiIsImJpbmRpbmdzIiwicmVuZGVyIiwiY2xhc3NOYW1lIiwiZGF0YS1zZSIsInRvZ2dsZVdoZW4iXSxwPVsibW9kZWwiLCJuYW1lIiwiaW5wdXRJZCIsInR5cGUiLCJpbnB1dCIsInBsYWNlaG9sZGVyIiwibGFiZWwiLCJyZWFkT25seSIsInJlYWQiLCJkaXNhYmxlZCIsInJlYWRNb2RlU3RyaW5nIiwib3B0aW9ucyIsImZyb20iLCJ0byIsImF1dG9SZW5kZXIiLCJpbmxpbmVWYWxpZGF0aW9uIiwidmFsaWRhdGVPbmx5SWZEaXJ0eSIsInBhcmFtcyJdLGY9WyJlcnJvckZpZWxkIl0sbT10LnVuaXEodC51bmlvbih1LGQsaCxwLGYpKSxfPVsi4oCiICAgICAgICAgIiwi4oCiICDigKIgICAgICAiLCLigKIgIOKAoiAg4oCiICAgIiwi4oCiICDigKIgIOKAoiAg4oCiIiwiICAg4oCiICDigKIgIOKAoiIsIiAgICAgIOKAoiAg4oCiIiwiICAgICAgICAg4oCiIiwiICAgICAgICAgICIsIiAgICAgICAgICAiLCIgICAgICAgICAgIl07cmV0dXJue0xBQkVMX09QVElPTlM6dSxDT05UQUlORVJfT1BUSU9OUzpkLFdSQVBQRVJfT1BUSU9OUzpoLElOUFVUX09QVElPTlM6cCxnZW5lcmF0ZUlucHV0T3B0aW9uczpjLGNoYW5nZUV2ZW50U3RyaW5nOmZ1bmN0aW9uKHQpe3JldHVybiJjaGFuZ2U6Iit0LmpvaW4oIiBjaGFuZ2U6Iil9LGNyZWF0ZVJlYWRGb3JtQnV0dG9uOmZ1bmN0aW9uKG4pe3ZhciByLHMsbztyZXR1cm4iY2FuY2VsIj09bi50eXBlPyhzPW89ZS5sb2NhbGl6ZSgib2Zvcm0uY2FuY2VsIikscj1mdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjYW5jZWwiKX0pOihzPWUubG9jYWxpemUoIm9mb3JtLmVkaXQiKSxvPXMrIiAiK24uZm9ybVRpdGxlLHI9ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnNldCgiX19lZGl0X18iLCEwKX0pLGkuZXh0ZW5kKHt0YWdOYW1lOiJhIixhdHRyaWJ1dGVzOntocmVmOiIjIiwiYXJpYS1sYWJlbCI6b30sdGVtcGxhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdC5lc2NhcGUocyl9LGV2ZW50czp7Y2xpY2s6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHIuY2FsbCh0aGlzKX19fSl9LGNyZWF0ZUJ1dHRvbjpmdW5jdGlvbihpKXtzd2l0Y2goaT10LmNsb25lKGkpLGkudHlwZSl7Y2FzZSJzYXZlIjp0LmRlZmF1bHRzKGkse2NsYXNzTmFtZToiYnV0dG9uLXByaW1hcnkifSk7YnJlYWs7Y2FzZSJjYW5jZWwiOnQuZGVmYXVsdHMoaSx7dGV4dDplLmxvY2FsaXplKCJvZm9ybS5jYW5jZWwiKSxhY3Rpb246ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06Y2FuY2VsIil9fSk7YnJlYWs7Y2FzZSJwcmV2aW91cyI6dC5kZWZhdWx0cyhpLHt0ZXh0OmUubG9jYWxpemUoIm9mb3JtLnByZXZpb3VzIiksYWN0aW9uOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnByZXZpb3VzIil9fSl9cmV0dXJuIGEoaSl9LHZhbGlkYXRlSW5wdXQ6bCxhcHBseVNob3dXaGVuOmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dC4kZWwudG9nZ2xlKGUpLHQubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX19O3MuYXBwbHlEb1doZW4odCxvKGUpLGZ1bmN0aW9uKGUsbil7bi5hbmltYXRlP3QuJGVsWyJzbGlkZSIrKGU/IkRvd24iOiJVcCIpXSgyMDAsaShlKSk6dC4kZWwudG9nZ2xlKGUpfSl9LGFwcGx5VG9nZ2xlV2hlbjpmdW5jdGlvbih0LGUpe3MuYXBwbHlEb1doZW4odCxvKGUpLGZ1bmN0aW9uKGUsaSl7dC4kZWwudG9nZ2xlKGUpLHQubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKSxpLmFuaW1hdGUmJnQucmVuZGVyKCl9KX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQ2KV0scj1mdW5jdGlvbih0KXt2YXIgZT0nXHQgICAgPGRpdiBjbGFzcz0ib2t0YS1mb3JtLWluZm9ib3gtZXJyb3IgaW5mb2JveCBpbmZvYm94LWVycm9yIiByb2xlPSJhbGVydCI+XHQgICAgICA8c3BhbiBjbGFzcz0iaWNvbiBlcnJvci0xNiI+PC9zcGFuPlx0ICAgICAge3sjaWYgZXJyb3JTdW1tYXJ5fX1cdCAgICAgICAgPHA+e3tlcnJvclN1bW1hcnl9fTwvcD5cdCAgICAgIHt7ZWxzZX19XHQgICAgICAgIDxwPnt7aTE4biBjb2RlPSJvZm9ybS5lcnJvcmJhbm5lci50aXRsZSJ9fTwvcD5cdCAgICAgIHt7L2lmfX1cdCAgICA8L2Rpdj5cdCAgJztyZXR1cm4gdC5leHRlbmQoe3RlbXBsYXRlOmUsbW9kZWxFdmVudHM6eyJmb3JtOmNsZWFyLWVycm9ycyI6InJlbW92ZSJ9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpLGkoMjMzKV0scj1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6Im8tZm9ybS1idXR0b24tYmFyIixpbml0aWFsaXplOmZ1bmN0aW9uKGUpe3RoaXMuYWRkQnV0dG9uKHt0eXBlOiJzYXZlIix0ZXh0OnQucmVzdWx0Q3R4KGUsInNhdmUiLHRoaXMpLGlkOnQucmVzdWx0Q3R4KGUsInNhdmVJZCIsdGhpcyksY2xhc3NOYW1lOnQucmVzdWx0Q3R4KGUsInNhdmVDbGFzc05hbWUiLHRoaXMpfSksZS5ub0NhbmNlbEJ1dHRvbnx8dGhpcy5hZGRCdXR0b24oe3R5cGU6ImNhbmNlbCIsdGV4dDp0LnJlc3VsdEN0eChlLCJjYW5jZWwiLHRoaXMpfSksZS5oYXNQcmV2U3RlcCYmdGhpcy5hZGRCdXR0b24oe3R5cGU6InByZXZpb3VzIn0se3ByZXBlbmQ6ITB9KX0sYWRkQnV0dG9uOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkKGkuY3JlYXRlQnV0dG9uKHQpLGUpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDE0NyksaSgxNDYpLGkoMjM4KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1pLnRwbDtyZXR1cm4gbi5leHRlbmQoe3BhcmFtczp7fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe24uYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJGVsLmFkZENsYXNzKCJzaW1wbGVtb2RhbC13cmFwIiksdGhpcy5wYXJhbXM9ZS5leHRlbmQoe29uQ2xvc2U6ZS5iaW5kKGUudGhyb3R0bGUodGhpcy5yZW1vdmUsNjQpLHRoaXMpfSx0aGlzLnBhcmFtc3x8e30pfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmRlbGVnYXRlRXZlbnRzKCksbi5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgaT1lLmV4dGVuZCh7fSxlLnBpY2sodGhpcywidGl0bGUiLCJzdWJ0aXRsZSIpLGUucGljayh0aGlzLm9wdGlvbnMsInRpdGxlIiwic3VidGl0bGUiKSk7aWYoaS5zdWJ0aXRsZSl7dmFyIHM9ZS5yZXN1bHRDdHgoaSwic3VidGl0bGUiLHRoaXMpO3RoaXMuJGVsLnByZXBlbmQocignPHAgY2xhc3M9Im1vZGFsLXN1YnRpdGxlIHRleHQtbGlnaHQgXHQgICAgICAgICAgcGFkZGluZy0yMCBtYXJnaW4tYnRtLTAiPnt7c3VidGl0bGV9fTwvcD4nKSh7c3VidGl0bGU6c30pKX1pZihpLnRpdGxlKXt2YXIgbz1lLnJlc3VsdEN0eChpLCJ0aXRsZSIsdGhpcyk7dGhpcy4kZWwucHJlcGVuZChyKCc8aDIgY2xhc3M9ImJsb2NrIG1vZGFsLXRpdGxlIj57e3RpdGxlfX08L2gyPicpKHt0aXRsZTpvfSkpfXJldHVybiBlLmRlZmVyKGUuYmluZChmdW5jdGlvbigpe3RoaXMuJGVsLm1vZGFsKHRoaXMucGFyYW1zKSx0aGlzLnJlc2l6ZSgpfSx0aGlzKSksdCgiYm9keSIpLmNzcygib3ZlcmZsb3ciLCJoaWRkZW4iKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdC5tb2RhbC5jbG9zZSgpLHQoImJvZHkiKS5jc3MoIm92ZXJmbG93IiwiIiksZS5kZWZlcihmdW5jdGlvbigpe3QubW9kYWwuY2xvc2UoKX0pLG4ucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHJlc2l6ZTpmdW5jdGlvbigpe3QubW9kYWwudXBkYXRlKHRoaXMuJGVsLm91dGVySGVpZ2h0KCkpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8pe3I9W2koNildLG49byxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KGZ1bmN0aW9uKHQpe3ZhciBlPVtdLGk9dChkb2N1bWVudCksbj1uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkscj10KHdpbmRvdykscz1bXSxvPXtpZVF1aXJrczpudWxsLG1zaWU6L21zaWUvLnRlc3QobikmJiEvb3BlcmEvLnRlc3Qobiksb3BlcmE6L29wZXJhLy50ZXN0KG4pfTtvLmllNj1vLm1zaWUmJi9tc2llIDYuLy50ZXN0KG4pJiYib2JqZWN0IiE9dHlwZW9mIHdpbmRvdy5YTUxIdHRwUmVxdWVzdCxvLmllNz1vLm1zaWUmJi9tc2llIDcuMC8udGVzdChuKSx0Lm1vZGFsPWZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQubW9kYWwuaW1wbC5pbml0KGUsaSl9LHQubW9kYWwuY2xvc2U9ZnVuY3Rpb24oKXt0Lm1vZGFsLmltcGwuY2xvc2UoKX0sdC5tb2RhbC5mb2N1cz1mdW5jdGlvbihlKXt0Lm1vZGFsLmltcGwuZm9jdXMoZSl9LHQubW9kYWwuc2V0Q29udGFpbmVyRGltZW5zaW9ucz1mdW5jdGlvbigpe3QubW9kYWwuaW1wbC5zZXRDb250YWluZXJEaW1lbnNpb25zKCl9LHQubW9kYWwuc2V0UG9zaXRpb249ZnVuY3Rpb24oKXt0Lm1vZGFsLmltcGwuc2V0UG9zaXRpb24oKX0sdC5tb2RhbC51cGRhdGU9ZnVuY3Rpb24oZSxpKXt0Lm1vZGFsLmltcGwudXBkYXRlKGUsaSl9LHQuZm4ubW9kYWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHQubW9kYWwuaW1wbC5pbml0KHRoaXMsZSl9LHQubW9kYWwuZGVmYXVsdHM9e2FwcGVuZFRvOiJib2R5Iixmb2N1czohMCxvcGFjaXR5OjUwLG92ZXJsYXlJZDoic2ltcGxlbW9kYWwtb3ZlcmxheSIsb3ZlcmxheUNzczp7fSxjb250YWluZXJJZDoic2ltcGxlbW9kYWwtY29udGFpbmVyIixjb250YWluZXJDc3M6e30sZGF0YUlkOiJzaW1wbGVtb2RhbC1kYXRhIixkYXRhQ3NzOnt9LG1pbkhlaWdodDpudWxsLG1pbldpZHRoOm51bGwsbWF4SGVpZ2h0Om51bGwsbWF4V2lkdGg6bnVsbCxhdXRvUmVzaXplOiExLGF1dG9Qb3NpdGlvbjohMCx6SW5kZXg6MWUzLGNsb3NlOiEwLGNsb3NlSFRNTDonPGEgY2xhc3M9Im1vZGFsQ2xvc2VJbWciIHRpdGxlPSJDbG9zZSI+PC9hPicsY2xvc2VDbGFzczoic2ltcGxlbW9kYWwtY2xvc2UiLGVzY0Nsb3NlOiEwLG92ZXJsYXlDbG9zZTohMSxmaXhlZDohMCxwb3NpdGlvbjpudWxsLHBlcnNpc3Q6ITEsbW9kYWw6ITAsb25PcGVuOm51bGwsb25TaG93Om51bGwsb25DbG9zZTpudWxsfSx0Lm1vZGFsLmltcGw9e2Q6e30saW5pdDpmdW5jdGlvbihlLGkpe3ZhciBuPXRoaXM7aWYobi5kLmRhdGEpcmV0dXJuITE7aWYoby5pZVF1aXJrcz1vLm1zaWUmJiJ1bmRlZmluZWQiIT10eXBlb2YgdC5zdXBwb3J0LmJveE1vZGVsJiYhdC5zdXBwb3J0LmJveE1vZGVsLG4ubz10LmV4dGVuZCh7fSx0Lm1vZGFsLmRlZmF1bHRzLGkpLG4uekluZGV4PW4uby56SW5kZXgsbi5vY2NiPSExLCJvYmplY3QiPT10eXBlb2YgZSllPWUgaW5zdGFuY2VvZiB0P2U6dChlKSxuLmQucGxhY2Vob2xkZXI9ITEsZS5wYXJlbnQoKS5wYXJlbnQoKS5zaXplKCk+MCYmKGUuYmVmb3JlKHQoIjxzcGFuPjwvc3Bhbj4iKS5hdHRyKCJpZCIsInNpbXBsZW1vZGFsLXBsYWNlaG9sZGVyIikuY3NzKHtkaXNwbGF5OiJub25lIn0pKSxuLmQucGxhY2Vob2xkZXI9ITAsbi5kaXNwbGF5PWUuY3NzKCJkaXNwbGF5Iiksbi5vLnBlcnNpc3R8fChuLmQub3JpZz1lLmNsb25lKCEwKSkpO2Vsc2V7aWYoInN0cmluZyIhPXR5cGVvZiBlJiYibnVtYmVyIiE9dHlwZW9mIGUpcmV0dXJuIGFsZXJ0KCJTaW1wbGVNb2RhbCBFcnJvcjogVW5zdXBwb3J0ZWQgZGF0YSB0eXBlOiAiK3R5cGVvZiBlKSxuO2U9dCgiPGRpdj48L2Rpdj4iKS5odG1sKGUpfXJldHVybiBuLmNyZWF0ZShlKSxlPW51bGwsbi5vcGVuKCksdC5pc0Z1bmN0aW9uKG4uby5vblNob3cpJiZuLm8ub25TaG93LmFwcGx5KG4sW24uZF0pLG59LGNyZWF0ZTpmdW5jdGlvbihpKXt2YXIgbj10aGlzO24uZ2V0RGltZW5zaW9ucygpLG4uby5tb2RhbCYmby5pZTYmJihuLmQuaWZyYW1lPXQoJzxpZnJhbWUgc3JjPSJqYXZhc2NyaXB0OmZhbHNlOyI+PC9pZnJhbWU+JykuY3NzKHQuZXh0ZW5kKG4uby5pZnJhbWVDc3Mse2Rpc3BsYXk6Im5vbmUiLG9wYWNpdHk6MCxwb3NpdGlvbjoiZml4ZWQiLGhlaWdodDpzWzBdLHdpZHRoOnNbMV0sekluZGV4Om4uby56SW5kZXgsdG9wOjAsbGVmdDowfSkpLmFwcGVuZFRvKG4uby5hcHBlbmRUbykpLG4uZC5vdmVybGF5PXQoIjxkaXY+PC9kaXY+IikuYXR0cigiaWQiLG4uby5vdmVybGF5SWQpLmFkZENsYXNzKCJzaW1wbGVtb2RhbC1vdmVybGF5IikuY3NzKHQuZXh0ZW5kKG4uby5vdmVybGF5Q3NzLHtkaXNwbGF5OiJub25lIixvcGFjaXR5Om4uby5vcGFjaXR5LzEwMCxoZWlnaHQ6bi5vLm1vZGFsP2VbMF06MCx3aWR0aDpuLm8ubW9kYWw/ZVsxXTowLHBvc2l0aW9uOiJmaXhlZCIsbGVmdDowLHRvcDowLHpJbmRleDpuLm8uekluZGV4KzF9KSkuYXBwZW5kVG8obi5vLmFwcGVuZFRvKSxuLmQuY29udGFpbmVyPXQoIjxkaXY+PC9kaXY+IikuYXR0cigiaWQiLG4uby5jb250YWluZXJJZCkuYXR0cigicm9sZSIsImRpYWxvZyIpLmFkZENsYXNzKCJzaW1wbGVtb2RhbC1jb250YWluZXItbmV3IikuY3NzKHQuZXh0ZW5kKHtwb3NpdGlvbjpuLm8uZml4ZWQ/ImZpeGVkIjoiYWJzb2x1dGUifSxuLm8uY29udGFpbmVyQ3NzLHtkaXNwbGF5OiJub25lIix6SW5kZXg6bi5vLnpJbmRleCsyfSkpLmFwcGVuZChuLm8uY2xvc2UmJm4uby5jbG9zZUhUTUw/dChuLm8uY2xvc2VIVE1MKS5hZGRDbGFzcyhuLm8uY2xvc2VDbGFzcyk6IiIpLmFwcGVuZFRvKG4uby5hcHBlbmRUbyksbi5kLndyYXA9dCgiPGRpdj48L2Rpdj4iKS5hdHRyKCJ0YWJJbmRleCIsLTEpLmFkZENsYXNzKCJzaW1wbGVtb2RhbC13cmFwIikuY3NzKHtoZWlnaHQ6IjEwMCUiLG91dGxpbmU6MCx3aWR0aDoiMTAwJSJ9KS5hcHBlbmRUbyhuLmQuY29udGFpbmVyKSxuLmQuZGF0YT1pLmF0dHIoImlkIixpLmF0dHIoImlkIil8fG4uby5kYXRhSWQpLmFkZENsYXNzKCJzaW1wbGVtb2RhbC1kYXRhIikuY3NzKHQuZXh0ZW5kKG4uby5kYXRhQ3NzLHtkaXNwbGF5OiJub25lIn0pKS5hcHBlbmRUbygiYm9keSIpLGk9bnVsbCxuLnNldENvbnRhaW5lckRpbWVuc2lvbnMoKSxuLmQuZGF0YS5hcHBlbmRUbyhuLmQud3JhcCksKG8uaWU2fHxvLmllUXVpcmtzKSYmbi5maXhJRSgpfSxiaW5kRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIG49dGhpczt0KCIuIituLm8uY2xvc2VDbGFzcykuYmluZCgiY2xpY2suc2ltcGxlbW9kYWwiLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSxuLmNsb3NlKCl9KSxuLm8ubW9kYWwmJm4uby5jbG9zZSYmbi5vLm92ZXJsYXlDbG9zZSYmbi5kLm92ZXJsYXkuYmluZCgiY2xpY2suc2ltcGxlbW9kYWwiLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSxuLmNsb3NlKCl9KSxpLmJpbmQoImtleWRvd24uc2ltcGxlbW9kYWwiLGZ1bmN0aW9uKHQpe24uby5tb2RhbCYmOT09PXQua2V5Q29kZT9uLndhdGNoVGFiKHQpOm4uby5jbG9zZSYmbi5vLmVzY0Nsb3NlJiYyNz09PXQua2V5Q29kZSYmKHQucHJldmVudERlZmF1bHQoKSxuLmNsb3NlKCkpfSksci5iaW5kKCJyZXNpemUuc2ltcGxlbW9kYWwgb3JpZW50YXRpb25jaGFuZ2Uuc2ltcGxlbW9kYWwiLGZ1bmN0aW9uKCl7bi5nZXREaW1lbnNpb25zKCksbi5vLmF1dG9SZXNpemU/bi5zZXRDb250YWluZXJEaW1lbnNpb25zKCk6bi5vLmF1dG9Qb3NpdGlvbiYmbi5zZXRQb3NpdGlvbigpLG8uaWU2fHxvLmllUXVpcmtzP24uZml4SUUoKTpuLm8ubW9kYWwmJihuLmQuaWZyYW1lJiZuLmQuaWZyYW1lLmNzcyh7aGVpZ2h0OnNbMF0sd2lkdGg6c1sxXX0pLG4uZC5vdmVybGF5LmNzcyh7aGVpZ2h0OmVbMF0sd2lkdGg6ZVsxXX0pKX0pfSx1bmJpbmRFdmVudHM6ZnVuY3Rpb24oKXt0KCIuIit0aGlzLm8uY2xvc2VDbGFzcykudW5iaW5kKCJjbGljay5zaW1wbGVtb2RhbCIpLGkudW5iaW5kKCJrZXlkb3duLnNpbXBsZW1vZGFsIiksci51bmJpbmQoIi5zaW1wbGVtb2RhbCIpLHRoaXMuZC5vdmVybGF5LnVuYmluZCgiY2xpY2suc2ltcGxlbW9kYWwiKX0sZml4SUU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLGk9ZS5vLnBvc2l0aW9uO3QuZWFjaChbZS5kLmlmcmFtZXx8bnVsbCxlLm8ubW9kYWw/ZS5kLm92ZXJsYXk6bnVsbCwiZml4ZWQiPT09ZS5kLmNvbnRhaW5lci5jc3MoInBvc2l0aW9uIik/ZS5kLmNvbnRhaW5lcjpudWxsXSxmdW5jdGlvbih0LGUpe2lmKGUpe3ZhciBuPSJkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCIscj0iZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCIscz0iZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQiLG89ImRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCIsYT0iZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AiLGw9ImRvY3VtZW50LmJvZHkuc2Nyb2xsV2lkdGgiLGM9ImRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQiLHU9ImRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCIsZD0iZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQiLGg9ImRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AiLHA9ZVswXS5zdHlsZTtpZihwLnBvc2l0aW9uPSJhYnNvbHV0ZSIsdDwyKXAucmVtb3ZlRXhwcmVzc2lvbigiaGVpZ2h0IikscC5yZW1vdmVFeHByZXNzaW9uKCJ3aWR0aCIpLHAuc2V0RXhwcmVzc2lvbigiaGVpZ2h0IiwiIitzKyIgPiAiK24rIiA/ICIrcysiIDogIituKycgKyAicHgiJykscC5zZXRFeHByZXNzaW9uKCJ3aWR0aCIsIiIrbCsiID4gIityKyIgPyAiK2wrIiA6ICIrcisnICsgInB4IicpO2Vsc2V7dmFyIGYsbTtpZihpJiZpLmNvbnN0cnVjdG9yPT09QXJyYXkpe3ZhciBfPWlbMF0/Im51bWJlciI9PXR5cGVvZiBpWzBdP2lbMF0udG9TdHJpbmcoKTppWzBdLnJlcGxhY2UoL3B4LywiIik6ZS5jc3MoInRvcCIpLnJlcGxhY2UoL3B4LywiIik7aWYoZj1fLmluZGV4T2YoIiUiKT09PS0xP18rIiArICh0ID0gIitoKyIgPyAiK2grIiA6ICIrYSsnKSArICJweCInOnBhcnNlSW50KF8ucmVwbGFjZSgvJS8sIiIpKSsiICogKCgiK2MrIiB8fCAiK24rIikgLyAxMDApICsgKHQgPSAiK2grIiA/ICIraCsiIDogIithKycpICsgInB4IicsaVsxXSl7dmFyIGc9Im51bWJlciI9PXR5cGVvZiBpWzFdP2lbMV0udG9TdHJpbmcoKTppWzFdLnJlcGxhY2UoL3B4LywiIik7bT1nLmluZGV4T2YoIiUiKT09PS0xP2crIiArICh0ID0gIitkKyIgPyAiK2QrIiA6ICIrbysnKSArICJweCInOnBhcnNlSW50KGcucmVwbGFjZSgvJS8sIiIpKSsiICogKCgiK3UrIiB8fCAiK3IrIikgLyAxMDApICsgKHQgPSAiK2QrIiA/ICIrZCsiIDogIitvKycpICsgInB4Iid9fWVsc2UgZj0iKCIrYysiIHx8ICIrbisiKSAvIDIgLSAodGhpcy5vZmZzZXRIZWlnaHQgLyAyKSArICh0ID0gIitoKyIgPyAiK2grIiA6ICIrYSsnKSArICJweCInLG09IigiK3UrIiB8fCAiK3IrIikgLyAyIC0gKHRoaXMub2Zmc2V0V2lkdGggLyAyKSArICh0ID0gIitkKyIgPyAiK2QrIiA6ICIrbysnKSArICJweCInO3AucmVtb3ZlRXhwcmVzc2lvbigidG9wIikscC5yZW1vdmVFeHByZXNzaW9uKCJsZWZ0IikscC5zZXRFeHByZXNzaW9uKCJ0b3AiLGYpLHAuc2V0RXhwcmVzc2lvbigibGVmdCIsbSl9fX0pfSxmb2N1czpmdW5jdGlvbihlKXt2YXIgaT10aGlzLG49ZSYmdC5pbkFycmF5KGUsWyJmaXJzdCIsImxhc3QiXSkhPT0tMT9lOiJmaXJzdCIscj10KCI6aW5wdXQ6ZW5hYmxlZDp2aXNpYmxlOiIrbixpLmQud3JhcCk7c2V0VGltZW91dChmdW5jdGlvbigpe3IubGVuZ3RoPjA/ci5mb2N1cyYmci5mb2N1cygpOmkmJmkuZCYmaS5kLndyYXAmJmkuZC53cmFwLmZvY3VzJiZpLmQud3JhcC5mb2N1cygpfSwxMCl9LGdldERpbWVuc2lvbnM6ZnVuY3Rpb24oKXt2YXIgdD0idW5kZWZpbmVkIj09dHlwZW9mIHdpbmRvdy5pbm5lckhlaWdodD9yLmhlaWdodCgpOndpbmRvdy5pbm5lckhlaWdodDtlPVtpLmhlaWdodCgpLGkud2lkdGgoKV0scz1bdCxyLndpZHRoKCldfSxnZXRWYWw6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD8ibnVtYmVyIj09dHlwZW9mIHQ/dDoiYXV0byI9PT10PzA6dC5pbmRleE9mKCIlIik+MD9wYXJzZUludCh0LnJlcGxhY2UoLyUvLCIiKSkvMTAwKigiaCI9PT1lP3NbMF06c1sxXSk6cGFyc2VJbnQodC5yZXBsYWNlKC9weC8sIiIpKTpudWxsfSx1cGRhdGU6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzO3JldHVybiEhaS5kLmRhdGEmJihpLmQub3JpZ0hlaWdodD1pLmdldFZhbCh0LCJoIiksaS5kLm9yaWdXaWR0aD1pLmdldFZhbChlLCJ3IiksaS5kLmRhdGEuaGlkZSgpLHQmJmkuZC5jb250YWluZXIuY3NzKCJoZWlnaHQiLHQpLGUmJmkuZC5jb250YWluZXIuY3NzKCJ3aWR0aCIsZSksaS5zZXRDb250YWluZXJEaW1lbnNpb25zKCksaS5kLmRhdGEuc2hvdygpLGkuby5mb2N1cyYmaS5mb2N1cygpLGkudW5iaW5kRXZlbnRzKCksdm9pZCBpLmJpbmRFdmVudHMoKSl9LHNldENvbnRhaW5lckRpbWVuc2lvbnM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLGU9by5pZTZ8fG8uaWU3LGk9dC5kLm9yaWdIZWlnaHQ/dC5kLm9yaWdIZWlnaHQ6by5vcGVyYT90LmQuY29udGFpbmVyLmhlaWdodCgpOnQuZ2V0VmFsKGU/dC5kLmNvbnRhaW5lclswXS5jdXJyZW50U3R5bGUuaGVpZ2h0OnQuZC5jb250YWluZXIuY3NzKCJoZWlnaHQiKSwiaCIpLG49dC5kLm9yaWdXaWR0aD90LmQub3JpZ1dpZHRoOm8ub3BlcmE/dC5kLmNvbnRhaW5lci53aWR0aCgpOnQuZ2V0VmFsKGU/dC5kLmNvbnRhaW5lclswXS5jdXJyZW50U3R5bGUud2lkdGg6dC5kLmNvbnRhaW5lci5jc3MoIndpZHRoIiksInciKSxyPXQuZC5kYXRhLm91dGVySGVpZ2h0KCEwKSxhPXQuZC5kYXRhLm91dGVyV2lkdGgoITApO3QuZC5vcmlnSGVpZ2h0PXQuZC5vcmlnSGVpZ2h0fHxpLHQuZC5vcmlnV2lkdGg9dC5kLm9yaWdXaWR0aHx8bjt2YXIgbD10Lm8ubWF4SGVpZ2h0P3QuZ2V0VmFsKHQuby5tYXhIZWlnaHQsImgiKTpudWxsLGM9dC5vLm1heFdpZHRoP3QuZ2V0VmFsKHQuby5tYXhXaWR0aCwidyIpOm51bGwsdT1sJiZsPHNbMF0/bDpzWzBdLGQ9YyYmYzxzWzFdP2M6c1sxXSxoPXQuby5taW5IZWlnaHQ/dC5nZXRWYWwodC5vLm1pbkhlaWdodCwiaCIpOiJhdXRvIjtpPWk/dC5vLmF1dG9SZXNpemUmJmk+dT91Omk8aD9oOmk6cj9yPnU/dTp0Lm8ubWluSGVpZ2h0JiYiYXV0byIhPT1oJiZyPGg/aDpyOmg7dmFyIHA9dC5vLm1pbldpZHRoP3QuZ2V0VmFsKHQuby5taW5XaWR0aCwidyIpOiJhdXRvIjtuPW4/dC5vLmF1dG9SZXNpemUmJm4+ZD9kOm48cD9wOm46YT9hPmQ/ZDp0Lm8ubWluV2lkdGgmJiJhdXRvIiE9PXAmJmE8cD9wOmE6cCx0LmQuY29udGFpbmVyLmNzcyh7aGVpZ2h0Omksd2lkdGg6bn0pLHQuZC53cmFwLmNzcyh7b3ZlcmZsb3c6cj5pfHxhPm4/ImF1dG8iOiJ2aXNpYmxlIn0pLHQuby5hdXRvUG9zaXRpb24mJnQuc2V0UG9zaXRpb24oKX0sc2V0UG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgdCxlLGk9dGhpcyxuPXNbMF0vMi1pLmQuY29udGFpbmVyLm91dGVySGVpZ2h0KCEwKS8yLG89c1sxXS8yLWkuZC5jb250YWluZXIub3V0ZXJXaWR0aCghMCkvMixhPSJmaXhlZCIhPT1pLmQuY29udGFpbmVyLmNzcygicG9zaXRpb24iKT9yLnNjcm9sbFRvcCgpOjA7aS5vLnBvc2l0aW9uJiYiW29iamVjdCBBcnJheV0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGkuby5wb3NpdGlvbik/KHQ9YSsoaS5vLnBvc2l0aW9uWzBdfHxuKSxlPWkuby5wb3NpdGlvblsxXXx8byk6KHQ9YStuLGU9byksaS5kLmNvbnRhaW5lci5jc3Moe2xlZnQ6ZSx0b3A6dH0pfSx3YXRjaFRhYjpmdW5jdGlvbihlKXt2YXIgaT10aGlzO2lmKHQoZS50YXJnZXQpLnBhcmVudHMoIi5zaW1wbGVtb2RhbC1jb250YWluZXItbmV3IikubGVuZ3RoPjApe2lmKGkuaW5wdXRzPXQoIjppbnB1dDplbmFibGVkOnZpc2libGU6Zmlyc3QsIDppbnB1dDplbmFibGVkOnZpc2libGU6bGFzdCIsaS5kLmRhdGFbMF0pLCFlLnNoaWZ0S2V5JiZlLnRhcmdldD09PWkuaW5wdXRzW2kuaW5wdXRzLmxlbmd0aC0xXXx8ZS5zaGlmdEtleSYmZS50YXJnZXQ9PT1pLmlucHV0c1swXXx8MD09PWkuaW5wdXRzLmxlbmd0aCl7ZS5wcmV2ZW50RGVmYXVsdCgpO3ZhciBuPWUuc2hpZnRLZXk/Imxhc3QiOiJmaXJzdCI7aS5mb2N1cyhuKX19ZWxzZSBlLnByZXZlbnREZWZhdWx0KCksaS5mb2N1cygpfSxvcGVuOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztlLmQuaWZyYW1lJiZlLmQuaWZyYW1lLnNob3coKSx0LmlzRnVuY3Rpb24oZS5vLm9uT3Blbik/ZS5vLm9uT3Blbi5hcHBseShlLFtlLmRdKTooZS5kLm92ZXJsYXkuc2hvdygpLGUuZC5jb250YWluZXIuc2hvdygpLGUuZC5kYXRhLnNob3coKSksZS5vLmZvY3VzJiZlLmZvY3VzKCksZS5iaW5kRXZlbnRzKCl9LGNsb3NlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztpZighZS5kLmRhdGEpcmV0dXJuITE7aWYoZS51bmJpbmRFdmVudHMoKSx0LmlzRnVuY3Rpb24oZS5vLm9uQ2xvc2UpJiYhZS5vY2NiKWUub2NjYj0hMCxlLm8ub25DbG9zZS5hcHBseShlLFtlLmRdKTtlbHNle2lmKGUuZC5wbGFjZWhvbGRlcil7dmFyIGk9dCgiI3NpbXBsZW1vZGFsLXBsYWNlaG9sZGVyIik7ZS5vLnBlcnNpc3Q/aS5yZXBsYWNlV2l0aChlLmQuZGF0YS5yZW1vdmVDbGFzcygic2ltcGxlbW9kYWwtZGF0YSIpLmNzcygiZGlzcGxheSIsZS5kaXNwbGF5KSk6KGUuZC5kYXRhLmhpZGUoKS5yZW1vdmUoKSxpLnJlcGxhY2VXaXRoKGUuZC5vcmlnKSl9ZWxzZSBlLmQuZGF0YS5oaWRlKCkucmVtb3ZlKCk7ZS5kLmNvbnRhaW5lci5oaWRlKCkucmVtb3ZlKCksZS5kLm92ZXJsYXkuaGlkZSgpLGUuZC5pZnJhbWUmJmUuZC5pZnJhbWUuaGlkZSgpLnJlbW92ZSgpLGUuZC5vdmVybGF5LnJlbW92ZSgpLGUuZD17fX19fX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KSxpKDE4NyksaSgyNDApXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj17bGluZXM6OSxsZW5ndGg6MCx3aWR0aDo4LHJhZGl1czoxMixjb3JuZXJzOjEscm90YXRlOjIzLGRpcmVjdGlvbjoxLGNvbG9yOiIjNjY2IixzcGVlZDouOCx0cmFpbDo1MCxzaGFkb3c6ITEsaHdhY2NlbDohMSxjbGFzc05hbWU6IiIsekluZGV4OjJlOSx0b3A6ImF1dG8iLGxlZnQ6ImF1dG8ifTtyZXR1cm4gZS5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5zcGluT3B0aW9uc3x8KHRoaXMuc3Bpbk9wdGlvbnM9e30pLHQuZGVmYXVsdHModGhpcy5zcGluT3B0aW9ucyxuKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3BpbkF0UmVuZGVyfHx0aGlzLiRlbC5oaWRlKCksZS5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnNwaW5BdFJlbmRlciYmdGhpcy5zcGluKCksdGhpc30sc3BpbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRlbC5zcGluKHRoaXMuc3Bpbk9wdGlvbnMpLnNob3coKSx0aGlzfSxlbXB0eTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuJGVsO3QuZmFkZU91dChpLkxPQURJTkdfRkFERSxmdW5jdGlvbigpe3Quc3BpbighMSl9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDYpLGkoMjQxKV0scj1mdW5jdGlvbih0LGUpe3QuZm4uc3Bpbj1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dHJ5e3ZhciBuPXQodGhpcykscj1uLmRhdGEoKTtyLnNwaW5uZXImJihyLnNwaW5uZXIuc3RvcCgpLGRlbGV0ZSByLnNwaW5uZXIpLGkhPT0hMSYmKHIuc3Bpbm5lcj1uZXcgZSh0LmV4dGVuZCh7Y29sb3I6bi5jc3MoImNvbG9yIil9LGkpKS5zcGluKHRoaXMpKX1jYXRjaChzKXt3aW5kb3cuY29uc29sZSYmd2luZG93LmNvbnNvbGUuZXJyb3Iocyl9fSksdGhpc319LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7IWZ1bmN0aW9uKHMsbyl7Im9iamVjdCI9PXR5cGVvZiB0JiZ0LmV4cG9ydHM/dC5leHBvcnRzPW8oKToobj1vLHI9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5jYWxsKGUsaSxlLHQpOm4sISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKSl9KHRoaXMsZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gdCh0LGUpe3ZhciBpLG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0fHwiZGl2Iik7Zm9yKGkgaW4gZSluW2ldPWVbaV07cmV0dXJuIG59ZnVuY3Rpb24gZSh0KXtmb3IodmFyIGU9MSxpPWFyZ3VtZW50cy5sZW5ndGg7ZTxpO2UrKyl0LmFwcGVuZENoaWxkKGFyZ3VtZW50c1tlXSk7cmV0dXJuIHR9ZnVuY3Rpb24gaSh0LGUsaSxuKXt2YXIgcj1bIm9wYWNpdHkiLGUsfn4oMTAwKnQpLGksbl0uam9pbigiLSIpLHM9LjAxK2kvbioxMDAsbz1NYXRoLm1heCgxLSgxLXQpL2UqKDEwMC1zKSx0KSxhPWMuc3Vic3RyaW5nKDAsYy5pbmRleE9mKCJBbmltYXRpb24iKSkudG9Mb3dlckNhc2UoKSxsPWEmJiItIithKyItInx8IiI7cmV0dXJuIGhbcl18fCh1Lmluc2VydFJ1bGUoIkAiK2wrImtleWZyYW1lcyAiK3IrInswJXtvcGFjaXR5OiIrbysifSIrcysiJXtvcGFjaXR5OiIrdCsifSIrKHMrLjAxKSsiJXtvcGFjaXR5OjF9IisocytlKSUxMDArIiV7b3BhY2l0eToiK3QrIn0xMDAle29wYWNpdHk6IitvKyJ9fSIsdS5jc3NSdWxlcy5sZW5ndGgpLGhbcl09MSkscn1mdW5jdGlvbiBuKHQsZSl7dmFyIGksbixyPXQuc3R5bGU7aWYoZT1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSksdm9pZCAwIT09cltlXSlyZXR1cm4gZTtmb3Iobj0wO248ZC5sZW5ndGg7bisrKWlmKGk9ZFtuXStlLHZvaWQgMCE9PXJbaV0pcmV0dXJuIGl9ZnVuY3Rpb24gcih0LGUpe2Zvcih2YXIgaSBpbiBlKXQuc3R5bGVbbih0LGkpfHxpXT1lW2ldO3JldHVybiB0fWZ1bmN0aW9uIHModCl7Zm9yKHZhciBlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyl7dmFyIGk9YXJndW1lbnRzW2VdO2Zvcih2YXIgbiBpbiBpKXZvaWQgMD09PXRbbl0mJih0W25dPWlbbl0pfXJldHVybiB0fWZ1bmN0aW9uIG8odCxlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQ/dDp0W2UldC5sZW5ndGhdfWZ1bmN0aW9uIGEodCl7dGhpcy5vcHRzPXModHx8e30sYS5kZWZhdWx0cyxwKX1mdW5jdGlvbiBsKCl7ZnVuY3Rpb24gaShlLGkpe3JldHVybiB0KCI8IitlKycgeG1sbnM9InVybjpzY2hlbWFzLW1pY3Jvc29mdC5jb206dm1sIiBjbGFzcz0ic3Bpbi12bWwiPicsaSl9dS5hZGRSdWxlKCIuc3Bpbi12bWwiLCJiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKSIpLGEucHJvdG90eXBlLmxpbmVzPWZ1bmN0aW9uKHQsbil7ZnVuY3Rpb24gcygpe3JldHVybiByKGkoImdyb3VwIix7Y29vcmRzaXplOnUrIiAiK3UsCgljb29yZG9yaWdpbjotYysiICIrLWN9KSx7d2lkdGg6dSxoZWlnaHQ6dX0pfWZ1bmN0aW9uIGEodCxhLGwpe2UoaCxlKHIocygpLHtyb3RhdGlvbjozNjAvbi5saW5lcyp0KyJkZWciLGxlZnQ6fn5hfSksZShyKGkoInJvdW5kcmVjdCIse2FyY3NpemU6bi5jb3JuZXJzfSkse3dpZHRoOmMsaGVpZ2h0Om4uc2NhbGUqbi53aWR0aCxsZWZ0Om4uc2NhbGUqbi5yYWRpdXMsdG9wOi1uLnNjYWxlKm4ud2lkdGg+PjEsZmlsdGVyOmx9KSxpKCJmaWxsIix7Y29sb3I6byhuLmNvbG9yLHQpLG9wYWNpdHk6bi5vcGFjaXR5fSksaSgic3Ryb2tlIix7b3BhY2l0eTowfSkpKSl9dmFyIGwsYz1uLnNjYWxlKihuLmxlbmd0aCtuLndpZHRoKSx1PTIqbi5zY2FsZSpjLGQ9LShuLndpZHRoK24ubGVuZ3RoKSpuLnNjYWxlKjIrInB4IixoPXIocygpLHtwb3NpdGlvbjoiYWJzb2x1dGUiLHRvcDpkLGxlZnQ6ZH0pO2lmKG4uc2hhZG93KWZvcihsPTE7bDw9bi5saW5lcztsKyspYShsLC0yLCJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuQmx1cihwaXhlbHJhZGl1cz0yLG1ha2VzaGFkb3c9MSxzaGFkb3dvcGFjaXR5PS4zKSIpO2ZvcihsPTE7bDw9bi5saW5lcztsKyspYShsKTtyZXR1cm4gZSh0LGgpfSxhLnByb3RvdHlwZS5vcGFjaXR5PWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuZmlyc3RDaGlsZDtuPW4uc2hhZG93JiZuLmxpbmVzfHwwLHImJmUrbjxyLmNoaWxkTm9kZXMubGVuZ3RoJiYocj1yLmNoaWxkTm9kZXNbZStuXSxyPXImJnIuZmlyc3RDaGlsZCxyPXImJnIuZmlyc3RDaGlsZCxyJiYoci5vcGFjaXR5PWkpKX19dmFyIGMsdSxkPVsid2Via2l0IiwiTW96IiwibXMiLCJPIl0saD17fSxwPXtsaW5lczoxMixsZW5ndGg6Nyx3aWR0aDo1LHJhZGl1czoxMCxzY2FsZToxLGNvcm5lcnM6MSxjb2xvcjoiIzAwMCIsb3BhY2l0eTouMjUscm90YXRlOjAsZGlyZWN0aW9uOjEsc3BlZWQ6MSx0cmFpbDoxMDAsZnBzOjIwLHpJbmRleDoyZTksY2xhc3NOYW1lOiJzcGlubmVyIix0b3A6IjUwJSIsbGVmdDoiNTAlIixzaGFkb3c6ITEsaHdhY2NlbDohMSxwb3NpdGlvbjoiYWJzb2x1dGUifTtpZihhLmRlZmF1bHRzPXt9LHMoYS5wcm90b3R5cGUse3NwaW46ZnVuY3Rpb24oZSl7dGhpcy5zdG9wKCk7dmFyIGk9dGhpcyxuPWkub3B0cyxzPWkuZWw9dChudWxsLHtjbGFzc05hbWU6bi5jbGFzc05hbWV9KTtpZihyKHMse3Bvc2l0aW9uOm4ucG9zaXRpb24sd2lkdGg6MCx6SW5kZXg6bi56SW5kZXgsbGVmdDpuLmxlZnQsdG9wOm4udG9wfSksZSYmZS5pbnNlcnRCZWZvcmUocyxlLmZpcnN0Q2hpbGR8fG51bGwpLHMuc2V0QXR0cmlidXRlKCJyb2xlIiwicHJvZ3Jlc3NiYXIiKSxpLmxpbmVzKHMsaS5vcHRzKSwhYyl7dmFyIG8sYT0wLGw9KG4ubGluZXMtMSkqKDEtbi5kaXJlY3Rpb24pLzIsdT1uLmZwcyxkPXUvbi5zcGVlZCxoPSgxLW4ub3BhY2l0eSkvKGQqbi50cmFpbC8xMDApLHA9ZC9uLmxpbmVzOyFmdW5jdGlvbiBmKCl7YSsrO2Zvcih2YXIgdD0wO3Q8bi5saW5lczt0Kyspbz1NYXRoLm1heCgxLShhKyhuLmxpbmVzLXQpKnApJWQqaCxuLm9wYWNpdHkpLGkub3BhY2l0eShzLHQqbi5kaXJlY3Rpb24rbCxvLG4pO2kudGltZW91dD1pLmVsJiZzZXRUaW1lb3V0KGYsfn4oMWUzL3UpKX0oKX1yZXR1cm4gaX0sc3RvcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZWw7cmV0dXJuIHQmJihjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KSx0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSx0aGlzLmVsPXZvaWQgMCksdGhpc30sbGluZXM6ZnVuY3Rpb24obixzKXtmdW5jdGlvbiBhKGUsaSl7cmV0dXJuIHIodCgpLHtwb3NpdGlvbjoiYWJzb2x1dGUiLHdpZHRoOnMuc2NhbGUqKHMubGVuZ3RoK3Mud2lkdGgpKyJweCIsaGVpZ2h0OnMuc2NhbGUqcy53aWR0aCsicHgiLGJhY2tncm91bmQ6ZSxib3hTaGFkb3c6aSx0cmFuc2Zvcm1PcmlnaW46ImxlZnQiLHRyYW5zZm9ybToicm90YXRlKCIrfn4oMzYwL3MubGluZXMqdStzLnJvdGF0ZSkrImRlZykgdHJhbnNsYXRlKCIrcy5zY2FsZSpzLnJhZGl1cysicHgsMCkiLGJvcmRlclJhZGl1czoocy5jb3JuZXJzKnMuc2NhbGUqcy53aWR0aD4+MSkrInB4In0pfWZvcih2YXIgbCx1PTAsZD0ocy5saW5lcy0xKSooMS1zLmRpcmVjdGlvbikvMjt1PHMubGluZXM7dSsrKWw9cih0KCkse3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdG9wOjErfihzLnNjYWxlKnMud2lkdGgvMikrInB4Iix0cmFuc2Zvcm06cy5od2FjY2VsPyJ0cmFuc2xhdGUzZCgwLDAsMCkiOiIiLG9wYWNpdHk6cy5vcGFjaXR5LGFuaW1hdGlvbjpjJiZpKHMub3BhY2l0eSxzLnRyYWlsLGQrdSpzLmRpcmVjdGlvbixzLmxpbmVzKSsiICIrMS9zLnNwZWVkKyJzIGxpbmVhciBpbmZpbml0ZSJ9KSxzLnNoYWRvdyYmZShsLHIoYSgiIzAwMCIsIjAgMCA0cHggIzAwMCIpLHt0b3A6IjJweCJ9KSksZShuLGUobCxhKG8ocy5jb2xvcix1KSwiMCAwIDFweCByZ2JhKDAsMCwwLC4xKSIpKSk7cmV0dXJuIG59LG9wYWNpdHk6ZnVuY3Rpb24odCxlLGkpe2U8dC5jaGlsZE5vZGVzLmxlbmd0aCYmKHQuY2hpbGROb2Rlc1tlXS5zdHlsZS5vcGFjaXR5PWkpfX0pLCJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQpe3U9ZnVuY3Rpb24oKXt2YXIgaT10KCJzdHlsZSIse3R5cGU6InRleHQvY3NzIn0pO3JldHVybiBlKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0saSksaS5zaGVldHx8aS5zdHlsZVNoZWV0fSgpO3ZhciBmPXIodCgiZ3JvdXAiKSx7YmVoYXZpb3I6InVybCgjZGVmYXVsdCNWTUwpIn0pOyFuKGYsInRyYW5zZm9ybSIpJiZmLmFkaj9sKCk6Yz1uKGYsImFuaW1hdGlvbiIpfXJldHVybiBhfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpLGkoMTg3KV0scj1mdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbihlLGkpe3JldHVybiB0LnJlc3VsdEN0eChlLm9wdGlvbnMsaSxlKXx8dC5yZXN1bHQoZSxpKX1mdW5jdGlvbiByKHQpe3ZhciBlPSJpbmZvYm94IGNsZWFyZml4IGluZm9ib3gtIituKHQsInR5cGUiKTtzd2l0Y2gobih0LCJzaXplIikpe2Nhc2Uic3RhbmRhcmQiOmUrPSIiO2JyZWFrO2Nhc2UiY29tcGFjdCI6ZSs9IiBpbmZvYm94LWNvbXBhY3QiO2JyZWFrO2Nhc2UibGFyZ2UiOmUrPSIgaW5mb2JveC1tZCJ9cmV0dXJuIG4odCwiZGlzbWlzc2libGUiKSYmKGUrPSIgaW5mb2JveC1kaXNtaXNzIiksZX12YXIgcz17ImNsaWNrIC5pbmZvYm94LWRpc21pc3MtbGluayI6ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuJGVsLmZhZGVPdXQoaS5VTkxPQURJTkdfRkFERSx0LmJpbmQodGhpcy5yZW1vdmUsdGhpcykpfX0sbz0nXHQgICAge3sjaWYgZGlzbWlzc2libGV9fVx0ICAgICAgPGEgY2xhc3M9ImluZm9ib3gtZGlzbWlzcy1saW5rIiB0aXRsZT0iRGlzbWlzcyIgaHJlZj0iIyI+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJkaXNtaXNzLWljb24iPjwvc3Bhbj5cdCAgICAgIDwvYT5cdCAgICB7ey9pZn19XHQgICAgPHNwYW4gY2xhc3M9Imljb24ge3tpY29ufX0iPjwvc3Bhbj5cdCAgICB7eyNpZiB0aXRsZX19PGgzPnt7dGl0bGV9fTwvaDM+e3svaWZ9fVx0ICAgIHt7I2lmIHN1YnRpdGxlfX08cD57e3N1YnRpdGxlfX08L3A+e3svaWZ9fVx0ICAgIHt7I2lmIGJ1bGxldHN9fVx0ICAgICAgPHVsIGNsYXNzPSJidWxsZXRzIj5cdCAgICAgIHt7I2VhY2ggYnVsbGV0c319PGxpPnt7dGhpc319PC9saT57ey9lYWNofX1cdCAgICAgIDwvdWw+XHQgICAge3svaWZ9fVx0ICAnLGE9ZS5leHRlbmQoe2NvbnRlbnQ6bnVsbCxzaXplOiJzdGFuZGFyZCIsdHlwZToiaW5mbyIsZGlzbWlzc2libGU6ITEsdGl0bGU6bnVsbCxzdWJ0aXRsZTpudWxsLGJ1bGxldHM6bnVsbCxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3RoaXMuZXZlbnRzPXQuZGVmYXVsdHModGhpcy5ldmVudHN8fHt9LHMpLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJGVsLmFkZENsYXNzKHIodGhpcykpLHRoaXMudGVtcGxhdGU9bzt2YXIgaT1uKHRoaXMsImNvbnRlbnQiKTtpJiZ0aGlzLmFkZChpKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIHQ9bih0aGlzLCJ0eXBlIik7cmV0dXJuInRpcCI9PXQmJih0PSJsaWdodC1idWxiIikse2ljb246dCsiLSIrKCJsYXJnZSI9PW4odGhpcywic2l6ZSIpPyIyNCI6IjE2IiksdGl0bGU6bih0aGlzLCJ0aXRsZSIpLHN1YnRpdGxlOm4odGhpcywic3VidGl0bGUiKSxidWxsZXRzOm4odGhpcywiYnVsbGV0cyIpLGRpc21pc3NpYmxlOm4odGhpcywiZGlzbWlzc2libGUiKX19fSk7cmV0dXJue2NyZWF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGEodCl9fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE5NyldLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZXh0ZW5kKHtzYXZlOiJPSyIscGFyYW1zOnttaW5XaWR0aDo1MDAsbWF4V2lkdGg6NzAwLGNsb3NlOiEwfSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3QuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuY29udGVudCYmdGhpcy5hZGQodGhpcy5jb250ZW50KSx0aGlzLmxpc3RlblRvKHRoaXMsInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5va3x8dGhpcy5vcHRpb25zLm9rO3QmJnQoKSx0aGlzLnJlbW92ZSgpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLCJjYW5jZWwiLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW5jZWxGbnx8dGhpcy5vcHRpb25zLmNhbmNlbEZuO3QmJnQoKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSg1KSxpKDE0NiksaSgxNTUpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe2UoZG9jdW1lbnQpLmNsaWNrKGZ1bmN0aW9uKHQpe3ZhciBpPWUodC50YXJnZXQpLG49KGkuaGFzQ2xhc3MoIm9wdGlvbi1zZWxlY3RlZCIpfHxpLnBhcmVudHMoKS5oYXNDbGFzcygib3B0aW9uLXNlbGVjdGVkIikpJiZpLmNsb3Nlc3QoIi5kcm9wZG93biIpLmxlbmd0aD4wO258fGUoIi5kcm9wZG93biAub3B0aW9ucyIpLmZhZGVPdXQoMTAwKX0pO3ZhciByPWkuZXh0ZW5kKHt0YWdOYW1lOiJsaSIsdGVtcGxhdGU6J1x0ICAgICAgPGEgY2xhc3M9Imljb24tMTZ7eyN1bmxlc3MgaWNvbn19IG5vLWljb257ey91bmxlc3N9fSJ7eyNpZiBzZWxlbml1bUlkfX0gZGF0YS1zZT0ie3tzZWxlbml1bUlkfX0ie3svaWZ9fT5cdCAgICAgICAge3sjaWYgaWNvbn19PHNwYW4gY2xhc3M9Imljb24ge3tpY29ufX0iPjwvc3Bhbj57ey9pZn19XHQgICAgICAgIDxwIGNsYXNzPXt7I2lmIHRpdGxlfX0ib3B0aW9uLXRpdGxlInt7ZWxzZX19Im5vLXRpdGxlInt7L2lmfX0+e3t0aXRsZX19PC9wPlx0ICAgICAgICB7eyNpZiBzdWJ0aXRsZX19PHAgY2xhc3M9Im9wdGlvbi1zdWJ0aXRsZSI+e3tzdWJ0aXRsZX19PC9wPnt7L2lmfX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToib2t0YS1kcm9wZG93bi1vcHRpb24gb3B0aW9uIixldmVudHM6e2NsaWNrOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLiRlbC5oYXNDbGFzcygib3B0aW9uLWRpc2FibGVkIik/dC5zdG9wUHJvcGFnYXRpb24oKTp0aGlzLm9wdGlvbnMuY2xpY2smJnRoaXMub3B0aW9ucy5jbGljay5jYWxsKHRoaXMpfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe24uYXBwbHlEb1doZW4odGhpcyx0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsImVuYWJsZVdoZW4iLHRoaXMpLHRoaXMudG9nZ2xlRW5hYmxlZCksbi5hcHBseURvV2hlbih0aGlzLHQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywic2hvd1doZW4iLHRoaXMpLHRoaXMudG9nZ2xlVmlzaWJsZSl9LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt0LnNpemUodC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJlbmFibGVXaGVuIix0aGlzKSl8fHRoaXMudG9nZ2xlRW5hYmxlZCghMCksdC5zaXplKHQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywic2hvd1doZW4iLHRoaXMpKXx8dGhpcy50b2dnbGVWaXNpYmxlKCEwKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2ljb246dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJpY29uIix0aGlzKSx0aXRsZTp0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsInRpdGxlIix0aGlzKSxzdWJ0aXRsZTp0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsInN1YnRpdGxlIix0aGlzKSxzZWxlbml1bUlkOnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywic2VsZW5pdW1JZCIsdGhpcyl9fSx0b2dnbGVFbmFibGVkOmZ1bmN0aW9uKGUpe3ZhciBpPWUmJnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywiZW5hYmxlZCIsdGhpcyk7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoIm9wdGlvbi1kaXNhYmxlZCIsIWkpfSx0b2dnbGVWaXNpYmxlOmZ1bmN0aW9uKGUpe3ZhciBpPWUmJnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywidmlzaWJsZSIsdGhpcyk7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoIm9wdGlvbi1oaWRkZW4iLCFpKX19KSxzPXsiY2xpY2sgYS5vcHRpb24tc2VsZWN0ZWQiOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSx0LnJlc3VsdCh0aGlzLCJkaXNhYmxlZCIpP2Uuc3RvcFByb3BhZ2F0aW9uKCk6dGhpcy4kKCJkaXYub3B0aW9ucyIpLnRvZ2dsZSgpfSwiY2xpY2sgLmRyb3Bkb3duLWRpc2FibGVkIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKX19LG89WyJpY29uIiwidGl0bGUiLCJzdWJ0aXRsZSIsImNsaWNrIiwiZW5hYmxlV2hlbiIsInNob3dXaGVuIiwiZW5hYmxlZCIsInZpc2libGUiLCJhdHRyaWJ1dGVzIiwic2VsZW5pdW1JZCJdO3JldHVybiBpLmV4dGVuZCh7aXRlbXM6W10saXRlbVdpZHRoOm51bGwsd2lkdGg6bnVsbCxpY29uOm51bGwsdGl0bGU6bnVsbCxkaXNhYmxlZDohMSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3RoaXMuZXZlbnRzPXQuZGVmYXVsdHModGhpcy5ldmVudHN8fHt9LHMpO3ZhciBlPXRoaXMuY2xhc3NOYW1lO3RoaXMuY2xhc3NOYW1lPW51bGwsdGhpcy5wb3N0UmVuZGVyPXQud3JhcCh0aGlzLnBvc3RSZW5kZXIsdC5iaW5kKGZ1bmN0aW9uKGUpe3ZhciBpPXQucmVzdWx0KHRoaXMsIml0ZW1XaWR0aCIpO2kmJnRoaXMuJCgidWwub3B0aW9ucy13cmFwIikud2lkdGgoaSk7dmFyIG49dC5yZXN1bHQodGhpcywid2lkdGgiKTtuJiZ0aGlzLiQoImEub3B0aW9uLXNlbGVjdGVkIikud2lkdGgobi0zMCksdC5yZXN1bHQodGhpcywiZGlzYWJsZWQiKSYmdGhpcy5kaXNhYmxlKCksZS5jYWxsKHRoaXMpfSx0aGlzKSksaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5jbGFzc05hbWU9ZSx0aGlzLiRlbC5hZGRDbGFzcygiZHJvcGRvd24gbW9yZS1hY3Rpb25zIGZsb2F0LWwiKSx0LmVhY2godC5yZXN1bHQodGhpcywiaXRlbXMiKXx8W10sZnVuY3Rpb24odCl7dGhpcy5hZGRJdGVtKHQsdGhpcy5vcHRpb25zKX0sdGhpcyl9LHRlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rLWJ1dHRvbiBsaW5rLWJ1dHRvbi1pY29uIG9wdGlvbi1zZWxlY3RlZCBjZW50ZXIge3tjbGFzc05hbWV9fSI+XHQgICAgICAgIHt7I2lmIGljb259fTxzcGFuIGNsYXNzPSJpY29uIHt7aWNvbn19Ij48L3NwYW4+e3svaWZ9fVx0ICAgICAgICB7eyNpZiB0aXRsZX19PHNwYW4gY2xhc3M9Im9wdGlvbi1zZWxlY3RlZC10ZXh0Ij57e3RpdGxlfX08L3NwYW4+e3svaWZ9fVx0ICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbi1kbSI+PC9zcGFuPlx0ICAgICAgPC9hPlx0ICAgICAgPGRpdiBjbGFzcz0ib3B0aW9ucyBjbGVhcmZpeCI+XHQgICAgICAgIDx1bCBjbGFzcz0ib2t0YS1kcm9wZG93bi1saXN0IG9wdGlvbnMtd3JhcCBjbGVhcmZpeCI+PC91bD5cdCAgICAgIDwvZGl2Plx0ICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2ljb246dC5yZXN1bHQodGhpcywiaWNvbiIpLGNsYXNzTmFtZTp0LnJlc3VsdCh0aGlzLCJjbGFzc05hbWUiKXx8IiIsdGl0bGU6dC5yZXN1bHQodGhpcywidGl0bGUiKX19LGRpc2FibGU6ZnVuY3Rpb24oKXt0aGlzLiQoIi5vcHRpb24tc2VsZWN0ZWQiKS5hZGRDbGFzcygiZHJvcGRvd24tZGlzYWJsZWQiKX0sZW5hYmxlOmZ1bmN0aW9uKCl7dGhpcy4kKCIub3B0aW9uLXNlbGVjdGVkIikucmVtb3ZlQ2xhc3MoImRyb3Bkb3duLWRpc2FibGVkIil9LGFkZEl0ZW06ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dC5waWNrKGV8fHt9LG8pLHQuZGVmYXVsdHMoZSx7dmlzaWJsZTohMCxlbmFibGVkOiEwfSksdGhpcy5hZGQociwidWwub3B0aW9ucy13cmFwIix7b3B0aW9uczplfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMjM3KSxpKDE3MiksaSgyNDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBpKHQsaSxuKXt2YXIgcyxvLGE9ZSh0KS5maW5kKGkpO2lmKGEpcmV0dXJuIHM9YS5vdXRlckhlaWdodCghMCktYS5oZWlnaHQoKSxvPXIoYS5zaWJsaW5ncygpKStzLG4tb31mdW5jdGlvbiBuKCl7cmV0dXJuIGUoImJvZHkiKS5hcHBlbmQoYSksZSgiLm1vZGFsLXN0YWdpbmciKX1mdW5jdGlvbiByKGkpe3JldHVybiB0LnJlZHVjZShpLGZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQrZShpKS5vdXRlckhlaWdodCghMCl9LDApfWZ1bmN0aW9uIHModCxlKXtvfHwobz1uKCkpLG8uaHRtbCh0KTt2YXIgaT1lKG8pO3JldHVybiBvLmVtcHR5KCksaX12YXIgbyxhPSc8ZGl2IGNsYXNzPSJtb2RhbC1zdGFnaW5nIHNpbXBsZW1vZGFsLXdyYXAiIHN0eWxlPSJ2aXNpYmlsaXR5OiBoaWRkZW47IHBvc2l0aW9uOiBhYnNvbHV0ZTsiPjwvZGl2Pic7cmV0dXJue21lYXN1cmU6ZnVuY3Rpb24odCl7cmV0dXJuIHModCxmdW5jdGlvbih0KXtyZXR1cm4gdC5oZWlnaHQoKX0pfSxmaXQ6ZnVuY3Rpb24odCxlLG4pe3JldHVybiBzKHQsZnVuY3Rpb24odCl7cmV0dXJuIGkodCxlLG4pfSl9LHJlbW92ZTpmdW5jdGlvbigpe28mJm8ucmVtb3ZlKCksbz12b2lkIDB9fX0oKSxvPXttaW5XaWR0aDo2MDAsbWF4V2lkdGg6OTUwLGF1dG9SZXNpemU6ITEsYXV0b1Bvc2l0aW9uOiEwfTtyZXR1cm4gaS5leHRlbmQoe3Jlc2l6ZU9uU3dpdGNoOiExLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKGUpe2lmKHQuZGVmYXVsdHModGhpcy5wYXJhbXMsbyksaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksZXx8KGU9e30pLHQuZXh0ZW5kKHRoaXMsdC5waWNrKGUsIlZpZXciLCJoZWlnaHQiLCJyZXNpemVPblN3aXRjaCIpKSwhdGhpcy5WaWV3KXRocm93IG5ldyBFcnJvcigiVGhlIE11bHRpVmlld01vZGFsRGlhbG9nIG11c3QgYmUgcHJvdmlkZWQgYSBWaWV3IHdoZW4gaW5pdGlhbGl6ZWQiKTt0aGlzLl9wcmVmZXRjaERldGVjdGlvbihlLCExKSx0aGlzLlN0YWdlPXN9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiBpLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX3NldEhlaWdodCgpLHRoaXMuX3NldENvbnRlbnRIZWlnaHQoKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtzLnJlbW92ZSgpLGkucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHN3aXRjaFZpZXc6ZnVuY3Rpb24oZSxpKXtpfHwoaT17fSksaT10LmNsb25lKHQuZXh0ZW5kKGkse2N1cnJlbnRWaWV3SGVpZ2h0OnRoaXMuaGVpZ2h0fSkpLHQuZXh0ZW5kKHRoaXMsdC5waWNrKGksImhlaWdodCIpLHtWaWV3OmV9KSx0aGlzLl9wcmVmZXRjaERldGVjdGlvbihpLCEwKX0sdXBkYXRlVGl0bGU6ZnVuY3Rpb24oZSl7ZT1lfHx0aGlzLmN1cnJlbnRWaWV3LnRpdGxlLGUmJih0LmlzRnVuY3Rpb24oZSkmJihlPWUuY2FsbCh0aGlzKSksdGhpcy5yZW5kZXJlZCgpPyh0aGlzLiQoImgyLmJsb2NrIikuaHRtbChlKSx0aGlzLmN1cnJlbnRWaWV3LiQoImgyLm9rdGEtZm9ybS10aXRsZSIpLnJlbW92ZSgpKToodGhpcy50aXRsZT1lLHRoaXMuY3VycmVudFZpZXcudGl0bGU9IiIpKX0sX2FkZFZpZXc6ZnVuY3Rpb24oZSxpKXt0aGlzLmN1cnJlbnRWaWV3JiZ0aGlzLmN1cnJlbnRWaWV3LnJlbW92ZSgpLHRoaXMuY3VycmVudFZpZXc9dGhpcy5hZGQoZSkuYXQoMCksdGhpcy5yZXNpemVTZWxlY3Rvcj10aGlzLmN1cnJlbnRWaWV3LnJlc2l6ZVNlbGVjdG9yfHx0aGlzLmN1cnJlbnRWaWV3LmVsLHRoaXMudXBkYXRlVGl0bGUoaS50aXRsZSksdGhpcy5saXN0ZW5Ubyh0aGlzLmN1cnJlbnRWaWV3LCJyZXNpemUiLHQuZGVib3VuY2UodC5iaW5kKHRoaXMuX3NldENvbnRlbnRIZWlnaHQsdGhpcyksMTAwKSl9LF9hZGRTY3JvbGxiYXJzOmZ1bmN0aW9uKHQsZSl7dC5oZWlnaHQoZSksdC5jc3MoIm92ZXJmbG93IiwiYXV0byIpfSxfZ2V0TWF4SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgucm91bmQoLjkqZSh3aW5kb3cpLmhlaWdodCgpKX0sX3NldENvbnRlbnRIZWlnaHQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmN1cnJlbnRWaWV3LGU9dC4kKHRoaXMucmVzaXplU2VsZWN0b3IpLGk9cy5maXQodC4kZWwuaHRtbCgpLHRoaXMucmVzaXplU2VsZWN0b3IsdGhpcy5oZWlnaHQpO2UuaGVpZ2h0KCkhPT1pJiZpJiYodGhpcy5fYWRkU2Nyb2xsYmFycyhlLGkpLHRoaXMucmVzaXplKCkpfSxfc2V0SGVpZ2h0OmZ1bmN0aW9uKHQpe3ZhciBlLGksbj10aGlzLl9nZXRNYXhIZWlnaHQoKSxyPXQ/dm9pZCAwOnRoaXMuaGVpZ2h0O3JldHVybiByPm4/dm9pZCh0aGlzLmhlaWdodD1uKTooaT1zLmZpdCh0aGlzLiRlbC5odG1sKCksdGhpcy5jdXJyZW50Vmlldy5yZXNpemVTZWxlY3RvcixyKSx2b2lkKGk+MjB8fChlPXMubWVhc3VyZSh0aGlzLiRlbC5odG1sKCkpLHRoaXMuaGVpZ2h0PU1hdGgubWluKGUsbikpKSl9LF9vblByZWZldGNoU3VjY2VzczpmdW5jdGlvbihlLGkscil7dmFyIHM9ISF0aGlzLmN1cnJlbnRWaWV3O3JldHVybiB0aGlzLl9zcGlubmVySGlkZSgpLHRoaXMuX2FkZFZpZXcoZSxpKSwhKCFyJiYhcykmJighciYmcz90aGlzLl9yZXNpemVEaWFsb2coe2hlaWdodDppLmhlaWdodCx0cmFuc2l0aW9uOm4uRUZGRUNUUy5OT05FfSk6dGhpcy5fcmVzaXplRGlhbG9nKGkpLHZvaWQodC5pc0Z1bmN0aW9uKGkucG9zdGZldGNoKT90LmRlZmVyKGkucG9zdGZldGNoKTp0LmlzRnVuY3Rpb24oZS5wb3N0ZmV0Y2gpJiZ0LmRlZmVyKHQuYmluZChlLnBvc3RmZXRjaCxlKSkpKX0sX3Jlc2l6ZURpYWxvZzpmdW5jdGlvbih0KXt0LmhlaWdodD90aGlzLl9zZXRIZWlnaHQoKTp0aGlzLnJlc2l6ZU9uU3dpdGNoJiZ0aGlzLl9zZXRIZWlnaHQoITApLHRoaXMuX3NldENvbnRlbnRIZWlnaHQoKSxuLmFuaW1hdGUodGhpcy5jdXJyZW50Vmlldy4kZWwsdC50cmFuc2l0aW9ufHxuLkVGRkVDVFMuU0xJREUpfSxfZ2V0SW5zdGFudGlhdGVkVmlldzpmdW5jdGlvbihlKXtyZXR1cm4gdC5pc0Z1bmN0aW9uKGUpP25ldyBlKHRoaXMub3B0aW9ucyk6ZX0sX3ByZWZldGNoRXJyb3I6ZnVuY3Rpb24odCl7dGhpcy5oZWlnaHQ9dC5jdXJyZW50Vmlld0hlaWdodHx8dGhpcy5oZWlnaHQsdGhpcy5fc2V0SGVpZ2h0KCksdGhpcy5fc2V0Q29udGVudEhlaWdodCgpLHRoaXMuX3NwaW5uZXJIaWRlKCl9LF9zcGlubmVyU2hvdzpmdW5jdGlvbih0KXt0aGlzLmN1cnJlbnRWaWV3Pyh0aGlzLnNwaW5uZXJWaWV3PW5ldyByKHtlbFRvQXR0YWNoVG86dGhpcy5jdXJyZW50Vmlldy4kKHRoaXMucmVzaXplU2VsZWN0b3IpfSksdGhpcy5hZGQodGhpcy5zcGlubmVyVmlldykpOnRoaXMuX2FkZFZpZXcobmV3IHIoe2hlaWdodDp0aGlzLmhlaWdodH0pLHt0aXRsZTp0LnRpdGxlfSl9LF9zcGlubmVySGlkZTpmdW5jdGlvbigpe3RoaXMuc3Bpbm5lclZpZXcmJnRoaXMuc3Bpbm5lclZpZXcucmVtb3ZlKCl9LF9nZXRQcmVmZXRjaEZ1bmN0aW9uOmZ1bmN0aW9uKGUsaSl7dmFyIG49dC5pc1VuZGVmaW5lZChpLnByZWZldGNoKT9lLnByZWZldGNoOmkucHJlZmV0Y2g7cmV0dXJuISFuJiYodC5pc0Z1bmN0aW9uKGkucHJlZmV0Y2gpP2kucHJlZmV0Y2g6dC5pc0Z1bmN0aW9uKGUucHJlZmV0Y2gpP3QuYmluZChlLnByZWZldGNoLGUpOnQuYmluZChlLm1vZGVsLmZldGNoLGUubW9kZWwpKX0sX3ByZWZldGNoRGV0ZWN0aW9uOmZ1bmN0aW9uKGksbil7dmFyIHI9dGhpcyxzPXRoaXMuX2dldEluc3RhbnRpYXRlZFZpZXcodGhpcy5WaWV3KSxvPXQuYmluZCh0aGlzLl9vblByZWZldGNoU3VjY2Vzcyx0aGlzLHMsaSxuKSxhPXRoaXMuX2dldFByZWZldGNoRnVuY3Rpb24ocyxpKTthPyh0aGlzLl9zcGlubmVyU2hvdyhzKSxlLndoZW4oYSgpKS5kb25lKG8pLmZhaWwoZnVuY3Rpb24oKXtyLl9wcmVmZXRjaEVycm9yKGkpfSkpOm8oKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMjM5KSxpKDE0NildLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPTIwO3JldHVybiBpLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuX2luaXRpYWxTdHlsZSh0aGlzLm9wdGlvbnMpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZ2V0UG9zaXRpb24oKTtlLmxlZnQ8MD90LmRlbGF5KHQuYmluZCh0aGlzLnNob3dTcGlubmVyLHRoaXMpLDIwMCk6dGhpcy5zaG93U3Bpbm5lcigpfSxzaG93U3Bpbm5lcjpmdW5jdGlvbigpe3RoaXMuc3Bpbm5lciYmdGhpcy5zcGlubmVyLnJlbW92ZSgpO3ZhciB0LGk9dGhpcy5fZ2V0UG9zaXRpb24oKTt0aGlzLm9wdGlvbnMuZWxUb0F0dGFjaFRvJiZ0aGlzLiRlbC5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSJ9KSx0PWUuZXh0ZW5kKHtzcGluQXRSZW5kZXI6ITAsc3Bpbk9wdGlvbnM6e2xlZnQ6aS5sZWZ0LHRvcDppLnRvcH19KSx0aGlzLnNwaW5uZXI9bmV3IHQsdGhpcy5hZGQodGhpcy5zcGlubmVyKX0sX2luaXRpYWxTdHlsZTpmdW5jdGlvbihlKXt2YXIgaT17fTtpZihlLmVsVG9BdHRhY2hUbyl7dmFyIG49ZS5lbFRvQXR0YWNoVG8ucG9zaXRpb24oKTtpLndpZHRoPWUuZWxUb0F0dGFjaFRvLm91dGVyV2lkdGgoKSxpLmhlaWdodD1lLmVsVG9BdHRhY2hUby5vdXRlckhlaWdodCgpLG4mJihpLnRvcD1uLnRvcCl9dC5leHRlbmQoaSx0LnBpY2soZSwiaGVpZ2h0Iiwid2lkdGgiKSksdGhpcy4kZWwuY3NzKGkpfSxfZ2V0UG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm57bGVmdDp0aGlzLiRlbC5vdXRlcldpZHRoKCkvMi1uLHRvcDp0aGlzLiRlbC5vdXRlckhlaWdodCgpLzItbn19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyNDkpLGkoMjYzKSxpKDI1MiksaSgyNTEpLGkoMjY0KSxpKDI1MCksaSgyNjApLGkoMjYxKSxpKDI2NiksaSgyNDgpLGkoMjU2KSxpKDI1OCksaSgyNjUpLGkoMjU3KSxpKDI2MiksaSgyNTMpLGkoMjU5KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjLHUsZCxoLHAsZixtLF8pe3JldHVybntDb250ZW50OnQsRGF0YUxpc3Q6ZSxEZWFkU2ltcGxlRGF0YUxpc3Q6aSxFbXB0eTpuLEZvb3RlcjpyLExvYWRpbmc6cyxTaWRlYmFyOm8sU2lkZWJhckZpbHRlclNldDphLFNpbXBsZURhdGFMaXN0OmwsVGFibGU6YyxUb29sQmFyOnUsY29tcG9uZW50czp7TGV0dGVyc05hdjpkLExvYWRNb3JlOmgsU2VhcmNoQm94OnAsU2lkZWJhckZpbHRlcjpmfSx1dGlsOntEYXRhbGlzdEZhY3Rvcnk6bSxGaWx0ZXJGYWN0b3J5Ol99fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NiksaSgyNTApLGkoMjUxKV0scj1mdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gZS5leHRlbmQoe0VtcHR5Om51bGwsTG9hZGluZzpudWxsLHRlbXBsYXRlOic8ZGl2IGNsYXNzPSJkYXRhLWxpc3QtY29udGVudCIgZGF0YS1zZT0iZGF0YS1saXN0LWNvbnRlbnQiPjwvZGl2PicsY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtpZihlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwhdGhpcy5jb2xsZWN0aW9uKXRocm93IG5ldyBFcnJvcigiTWlzc2luZyBBcmd1bWVudHM6IGNvbGxlY3Rpb24iKTt0aGlzLlRvb2xiYXImJnRoaXMuYWRkKHRoaXMuVG9vbGJhcix7cHJlcGVuZDohMH0pLHRoaXMuTWFpbiYmdGhpcy5hZGQodGhpcy5NYWluKTt2YXIgdD10aGlzLkVtcHR5fHxuLHI9dGhpcy5Mb2FkaW5nfHxpO3RoaXMuYWRkKHQpLHRoaXMuYWRkKHIpLHRoaXMuJGVsLmFkZENsYXNzKCJkYXRhLWxpc3QtY29udGVudC13cmFwIiksdGhpcy4kZWwuYXR0cigiZGF0YS1zZSIsImRhdGEtbGlzdC1jb250ZW50LXdyYXAiKX0sYWRkOmZ1bmN0aW9uKCl7dmFyIGk9dC50b0FycmF5KGFyZ3VtZW50cyk7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBpWzFdJiYoaVsxXT0iLmRhdGEtbGlzdC1jb250ZW50IiksZS5wcm90b3R5cGUuYWRkLmFwcGx5KHRoaXMsaSl9LGhlaWdodDpmdW5jdGlvbih0KXtyZXR1cm4gdD92b2lkIHRoaXMuJCgiLmRhdGEtbGlzdC1jb250ZW50IikuY3NzKCJtaW4taGVpZ2h0Iix0KTp0aGlzLiRlbC5oZWlnaHQoKX0sdHlwZToiY29udGVudCJ9KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIzOSldLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZXh0ZW5kKHtjbGFzc05hbWU6ImRhdGEtbGlzdC1sb2FkLXdyYXAiLHR5cGU6ImxvYWRpbmciLHRlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9ImRhdGEtbGlzdC1sb2FkLW1hc2siPjwvZGl2Plx0ICAgICAgPGg0IGNsYXNzPSJkYXRhLWxpc3QtaGVhZCI+TG9hZGluZy4uLjwvaDQ+XHQgICAgJyxzcGluT3B0aW9uczp7Y2xhc3NOYW1lOiJkYXRhLWxpc3Qtc3Bpbm5lciJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwicmVxdWVzdCIsdGhpcy5zcGluKSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwic3luYyBlcnJvciIsdGhpcy5lbXB0eSl9LHNwaW46ZnVuY3Rpb24oZSl7ZT09PXRoaXMuY29sbGVjdGlvbiYmdC5wcm90b3R5cGUuc3Bpbi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NyksaSgxNDYpLGkoMTc3KV0scj1mdW5jdGlvbih0LGUsaSxuKXtmdW5jdGlvbiByKGUsaSl7cmV0dXJuIGUuc3RhdGUuZ2V0KCJlbXB0eS5lc2NhcGUiKT09PSExfHx0LnJlc3VsdChlLCJlc2NhcGUiKT09PSExP2k6dC5lc2NhcGUoaSl9cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImRhdGEtbGlzdC1lbXB0eS1tc2ciLHR5cGU6ImVtcHR5Iixlc2NhcGU6ITAsdGl0bGU6dm9pZCAwLHN1YnRpdGxlOnZvaWQgMCx0ZW1wbGF0ZTonXHQgICAgICA8cCBjbGFzcz0iZGF0YS1saXN0LWVtcHR5LWJpbmFyeSI+XHQgICAgICAgIDAxMTAxMTEwMDExMDExMTEwMTExMDEwMDAxMTAxMDAwMDExMDEwMDEwMTEwMTExMDAxMTAwMTExXHQgICAgICAgIDxzcGFuIGNsYXNzPSJkYXRhLWxpc3QtZW1wdHktaW1nIj48L3NwYW4+XHQgICAgICA8L3A+XHQgICAgICA8aDQgY2xhc3M9ImRhdGEtbGlzdC1oZWFkIGRhdGEtbGlzdC1lbXB0eS1oZWFkIj57e3RpdGxlfX08L2g0Plx0ICAgICAgPGg1IGNsYXNzPSJkYXRhLWxpc3QtaGVhZCBkYXRhLWxpc3QtZW1wdHktaGVhZCBkYXRhLWxpc3QtZW1wdHktc3ViaGVhZCI+e3t7c3VidGl0bGV9fX08L2g1Plx0ICAgICcsY29uc3RydWN0b3I6ZnVuY3Rpb24obil7dmFyIHI9biYmbi50ZW1wbGF0ZXx8dGhpcy50ZW1wbGF0ZTt0aGlzLl9fdGVtcGxhdGU9dC5pc1N0cmluZyhyKT9lLnRwbChyKTpyLGkuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBzPXRoaXMub3B0aW9ucy5kZWJvdW5jZVRpbWV8fDIwMCxvPXMrMTA7dGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sInN5bmMgYWRkIHJlbW92ZSByZXNldCIsdC5kZWJvdW5jZSh0aGlzLnRvZ2dsZSxzKSksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sImVycm9yIix0LmRlYm91bmNlKHRoaXMuX3Nob3dFcnJvcixvKSksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sInJlcXVlc3QiLHRoaXMuZW1wdHkpfSxfc2hvd0Vycm9yOmZ1bmN0aW9uKGUsaSxyKXtpZihlPT09dGhpcy5jb2xsZWN0aW9uKXtpZighdC5pc1N0cmluZyhyKSl0cnl7dmFyIHM9aS5yZXNwb25zZUpTT058fEpTT04ucGFyc2UoaS5yZXNwb25zZVRleHQpO3I9cy5lcnJvclN1bW1hcnl9Y2F0Y2gobyl7fXRoaXMuX19kb1JlbmRlcihuLmxvY2FsaXplKCJkYXRhbGlzdC5lcnJvcl90aXRsZSIpLHQuaXNTdHJpbmcocik/cjpuLmxvY2FsaXplKCJkYXRhbGlzdC5lcnJvcl9zdWJ0aXRsZSIpKX19LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzfSxfX2RvUmVuZGVyOmZ1bmN0aW9uKHQsZSl7dGhpcy4kZWwuaHRtbCh0aGlzLl9fdGVtcGxhdGUoe3RpdGxlOnQsc3VidGl0bGU6cih0aGlzLGUpfSkpLnNob3coKX0sX19nZXRWYWx1ZTpmdW5jdGlvbihlKXt2YXIgaT10LnJlc3VsdCh0aGlzLGUpO3JldHVybiBpPT09ITE/IiI6dGhpcy5zdGF0ZS5nZXQoImVtcHR5LiIrZSl8fGl8fG4ubG9jYWxpemUoImRhdGFsaXN0LmVtcHR5XyIrZSl9LGlzRW1wdHlTdGF0ZTpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5jb2xsZWN0aW9uLnNpemUoKX0sdG9nZ2xlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFbXB0eVN0YXRlKCk/dGhpcy5fX2RvUmVuZGVyKHRoaXMuX19nZXRWYWx1ZSgidGl0bGUiKSx0aGlzLl9fZ2V0VmFsdWUoInN1YnRpdGxlIikpOnRoaXMuZW1wdHkoKSx0aGlzfSxlbXB0eTpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCkuaGlkZSgpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgyNTMpLGkoMjU1KSxpKDI1OSksaSgyNjMpLGkoMjQ5KSxpKDI0OCldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7ZnVuY3Rpb24gYShlLGksbil7dC5pc1VuZGVmaW5lZChuKSYmKG49dGhpc1tlXS5sZW5ndGgpLHRoaXNbZV0uc3BsaWNlKG4sMCxpKX1yZXR1cm4gci5leHRlbmQoe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZGF0YS1saXN0In0sZW1wdHlTdGF0ZTp7dGl0bGU6dm9pZCAwLHN1YnRpdGxlOnZvaWQgMCxlc2NhcGU6dm9pZCAwfSxjb2x1bW5zOltdLHRvb2xiYXI6W10saW5uZXJUb29sYmFyOiExLGZpbHRlcnM6W10sYWRkQ29sdW1uOnQucGFydGlhbChhLCJfX2NvbHVtbnMiKSxhZGRUb29sYmFyQ29tcG9uZW50OnQucGFydGlhbChhLCJfX3Rvb2xiYXIiKSxhZGRGaWx0ZXJTZXQ6dC5wYXJ0aWFsKGEsIl9fZmlsdGVycyIpLF9fcHJvY2Vzc0FjdGlvbnM6ZnVuY3Rpb24oaSl7aWYoIXQuaXNPYmplY3QoaSl8fHQuaXNBcnJheShpKSlyZXR1cm4gaTt2YXIgbj10Lm9taXQoaSwiYWN0aW9ucyIpLHI9dC5waWNrKGksImRyb3Bkb3duIiwidGhyZXNob2xkIik7cmV0dXJuIGkuYWN0aW9ucyYmKG4udmlldz1lLmNyZWF0ZUFjdGlvbnModC5yZXN1bHQoaSwiYWN0aW9ucyIpLHIpKSxufSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3RoaXMuX190b29sYmFyPXQuY2xvbmUodGhpcy50b29sYmFyfHxbXSksdGhpcy5fX2ZpbHRlcnM9dC5jbG9uZSh0aGlzLmZpbHRlcnN8fFtdKSx0aGlzLl9fY29sdW1ucz10LmNsb25lKHRoaXMuY29sdW1uc3x8W10pLHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZUNoaWxkcmVuKCksdGhpcy5fX3Rvb2xiYXIubGVuZ3RoJiYodGhpcy5Ub29sYmFyPWkuY3JlYXRlVG9vbGJhcih0aGlzLl9fdG9vbGJhcikpLHRoaXMuVG9vbGJhciYmIXRoaXMuaW5uZXJUb29sYmFyJiZ0aGlzLlRvb2xiYXImJnRoaXMuYWRkKHRoaXMuVG9vbGJhciksdGhpcy5fX2ZpbHRlcnMubGVuZ3RoJiYodGhpcy5TaWRlYmFyPW4uY3JlYXRlRmlsdGVycyh0aGlzLl9fZmlsdGVycykpLHRoaXMuU2lkZWJhciYmdGhpcy5hZGQodGhpcy5TaWRlYmFyKTt2YXIgYT10Lm1hcCh0aGlzLl9fY29sdW1ucyx0aGlzLl9fcHJvY2Vzc0FjdGlvbnMpO3JldHVybiB0aGlzLmFkZChzLmV4dGVuZCh7VG9vbGJhcjp0aGlzLmlubmVyVG9vbGJhciYmdGhpcy5Ub29sYmFyLE1haW46by5leHRlbmQoe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZGF0YS1saXN0LXRhYmxlIn0sY29sdW1uczphLGl0ZW06dGhpcy5pdGVtLGhlYWRlcjp0aGlzLmhlYWRlcixjYXB0aW9uOnRoaXMuY2FwdGlvbixmb290ZXI6dGhpcy5mb290ZXJ9KSxFbXB0eTp0aGlzLkVtcHR5fHxlLmNyZWF0ZUVtcHR5Vmlldyh0aGlzLmVtcHR5U3RhdGUpLExvYWRpbmc6dGhpcy5Mb2FkaW5nfSkpLHIucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpc319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQxKSxpKDI1MSksaSgyNTQpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybntjcmVhdGVIZWFkZXI6ZnVuY3Rpb24oKXtyZXR1cm4gZS5jcmVhdGVIZWFkZXIuYXBwbHkoZSxhcmd1bWVudHMpfSxjcmVhdGVSb3c6ZnVuY3Rpb24oKXtyZXR1cm4gZS5jcmVhdGVSb3cuYXBwbHkoZSxhcmd1bWVudHMpfSxjcmVhdGVBY3Rpb25zOmZ1bmN0aW9uKGUsaSl7aWYoaT1pfHx7fSwhdC5pc0FycmF5KGUpfHwhZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKGUrIiBoYXMgdG8gYmUgYSBub24tZW1wdHkgYXJyYXkuIik7cmV0dXJuIGkuYWN0aW9uT3B0aW9ucz10Lm1hcChlLHQuY2xvbmUpLG4uZXh0ZW5kKGkpfSxjcmVhdGVFbXB0eVZpZXc6ZnVuY3Rpb24oZSl7cmV0dXJuIGkuZXh0ZW5kKHQuY2xvbmUoZSl8fHt9KX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNTMpLGkoMTQ2KSxpKDEzOSksaSgxNzcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIGkuZXh0ZW5kKHthY3Rpb25PcHRpb25zOltdLHRpdGxlOnIubG9jYWxpemUoImRhdGFsaXN0LmNvbHVtbi5hY3Rpb25zLmRlZmF1bHQudGl0bGUiKSx0aHJlc2hvbGQ6MixfX2NvdW50VmlzaWJsZTpmdW5jdGlvbigpe3JldHVybiB0LmZpbHRlcih0aGlzLmFjdGlvbk9wdGlvbnMsZnVuY3Rpb24oZSl7cmV0dXJuIHQuaXNVbmRlZmluZWQoZS52aXNpYmxlKXx8dC5yZXN1bHRDdHgoZSwidmlzaWJsZSIsdGhpcyl9LHRoaXMpLmxlbmd0aH0sX19hZGRCdXR0b25zOmZ1bmN0aW9uKCl7dC5lYWNoKHRoaXMuYWN0aW9uT3B0aW9ucyxmdW5jdGlvbih0KXt0aGlzLmFkZChlLmNyZWF0ZSh0KSl9LHRoaXMpfSxfX2FkZERyb3BEb3duOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5kcm9wZG93bnx8e307dGhpcy5hZGQobi5leHRlbmQoe3RpdGxlOnQudGl0bGV8fHRoaXMudGl0bGUsaWNvbjp0Lmljb24sZGlzYWJsZWQ6dC5kaXNhYmxlZHx8ITEsd2lkdGg6dC53aWR0aCxpdGVtV2lkdGg6dC5pdGVtV2lkdGh8fDE4MCxpdGVtczp0aGlzLmFjdGlvbk9wdGlvbnN9KSl9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW92ZUNoaWxkcmVuKCksdGhpcy5fX2NvdW50VmlzaWJsZSgpPD10aGlzLnRocmVzaG9sZD90aGlzLl9fYWRkQnV0dG9ucygpOnRoaXMuX19hZGREcm9wRG93bigpLGkucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDM1KSxpKDE1MyksaSgyNTYpLGkoMjU3KSxpKDI1OCldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe3JldHVybntjcmVhdGVUb29sYmFyOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXM7cmV0dXJuIG4uZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dC5lYWNoKGUsZnVuY3Rpb24odCl7dGhpcy5hZGQoaS5fX2NyZWF0ZUNvbXBvbmVudCh0KSl9LHRoaXMpfX0pfSxfX2NyZWF0ZUNvbXBvbmVudDpmdW5jdGlvbihuKXtpZih0LmlzRnVuY3Rpb24obil8fHQuaXNPYmplY3QobikmJm4gaW5zdGFuY2VvZiBlLlZpZXcpcmV0dXJuIG47c3dpdGNoKG4udHlwZSl7Y2FzZSJidXR0b24iOnJldHVybiBpLmNyZWF0ZShuKTtjYXNlInNlYXJjaCI6cmV0dXJuIHIuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dC5leHRlbmQodGhpcy5vcHRpb25zLHQucGljayhuLCJmaWVsZCIsIm1pbkNoYXJzIikseyJmbG9hdCI6bi5hbGlnbn0pfX0pO2Nhc2UibGV0dGVycyI6cmV0dXJuIHMuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dC5leHRlbmQodGhpcy5vcHRpb25zLHQucGljayhuLCJmaWVsZCIpKX19KTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiTm90IEltcGxlbWVudGVkIil9fX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NildLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe2F0dHJpYnV0ZXM6e30sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0LmRlZmF1bHRzKHRoaXMuYXR0cmlidXRlcyx7ImRhdGEtc2UiOiJkYXRhLWxpc3QtdG9vbGJhciJ9KSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiRlbC5hZGRDbGFzcygiZGF0YS1saXN0LXRvb2xiYXIgY2xlYXJmaXgiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTg3KSxpKDE3MyksaSgxNDYpLGkoMjA0KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1uLmV4dGVuZCh7dGVtcGxhdGU6J1x0ICAgIDxzcGFuIGNsYXNzPSJzZWFyY2gtYm94IGlucHV0LWZpeCI+XHQgICAgICA8c3BhbiBjbGFzcz0iaWNvbi1vbmx5IGljb24tMTYgbWFnbmlmeWluZy1nbGFzcy0xNiI+PC9zcGFuPlx0ICAgICAgPGlucHV0IGNsYXNzPSJ0ZXh0LWZpZWxkLWRlZmF1bHQiIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJ7e3BsYWNlaG9sZGVyfX0iPlx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmstYnV0dG9uIGFsbG93LWluLXJlYWQtb25seSBjbGVhci1zZWFyY2ggaWNvbi0xNiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij5cdCAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiBjbGVhci1pbnB1dC0xNiI+PC9zcGFuPlx0ICAgICAgPC9hPlx0ICAgIDwvc3Bhbj5cdCAgJyxldmVudHM6eyJpbnB1dCAudGV4dC1maWVsZC1kZWZhdWx0IjoidXBkYXRlIiwiY2xpY2sgLmNsZWFyLXNlYXJjaCI6InJlc2V0Iiwia2V5dXAgLnRleHQtZmllbGQtZGVmYXVsdCI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQud2hpY2g9PT1pLkVTQz90aGlzLnJlc2V0KCk6dGhpcy51cGRhdGUoKX19LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7aWYobi5hcHBseSh0aGlzLGFyZ3VtZW50cyksIXRoaXMuc3RhdGUpdGhyb3cgbmV3IEVycm9yKCJObyBTdGF0ZSBQcm92aWRlZCIpO3RoaXMub3B0aW9ucy5taW5DaGFyc3x8KHRoaXMub3B0aW9ucy5taW5DaGFycz0yKSx0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJ8fCh0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXI9IlNlYXJjaC4uLiIpLHRoaXMuJGVsLmFkZENsYXNzKCJzZWFyY2gtYm94LXdyYXAiKSx0aGlzLiRlbC5hZGRDbGFzcygicmlnaHQiPT09dGhpcy5vcHRpb25zWyJmbG9hdCJdPyJmbG9hdC1yIjoiZmxvYXQtbCIpLHRoaXMuZmllbGQ9dGhpcy5vcHRpb25zLmZpZWxkfHwic2VhcmNoIix0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZToiK3RoaXMuZmllbGQsdGhpcy5fdXBkYXRlVmFsdWUpLHRoaXMuX3VwZGF0ZVN0YXRlPXQuZGVib3VuY2UodGhpcy5fdXBkYXRlU3RhdGUsZS5ERUJPVU5DRV9ERUxBWSksdC5iaW5kQWxsKHRoaXMsIl91cGRhdGVTdGF0ZSIsInVwZGF0ZSIpfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gbi5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMpLHRoaXMuX3VwZGF0ZVZhbHVlKCksdGhpc30sdXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy4kKCIuY2xlYXItc2VhcmNoIikudG9nZ2xlKCEhdGhpcy52YWwoKSksdGhpcy5fdXBkYXRlU3RhdGUoKX0scmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy4kKCJpbnB1dCIpLm9mZigpLG4ucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHJlc2V0OmZ1bmN0aW9uKHQpe3QmJnQucHJldmVudERlZmF1bHQoKSx0aGlzLnZhbCgiIiksdGhpcy51cGRhdGUoKX0sdmFsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy4kKCJpbnB1dCIpO3JldHVybiB0LnZhbC5hcHBseSh0LGFyZ3VtZW50cyl9LF9zdGF0ZVZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGUuZ2V0KHRoaXMuZmllbGQpfHwiIn0sX3VwZGF0ZVN0YXRlOmZ1bmN0aW9uKCl7dGhpcy5fY2hhbmdlZCgpJiZ0aGlzLnN0YXRlLnNldCh0aGlzLmZpZWxkLHRoaXMudmFsKCkpfSxfdXBkYXRlVmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jaGFuZ2VkKCkmJnRoaXMudmFsKHRoaXMuX3N0YXRlVmFsdWUoKSkmJnRoaXMuJCgiLmNsZWFyLXNlYXJjaCIpLnRvZ2dsZSghIXRoaXMudmFsKCkpfSxfY2hhbmdlZDpmdW5jdGlvbigpe3ZhciB0PXRoaXMudmFsKCl8fCIiLGU9dC5sZW5ndGg7cmV0dXJuKDA9PT1lfHxlPj10aGlzLm9wdGlvbnMubWluQ2hhcnMpJiZ0aGlzLl9zdGF0ZVZhbHVlKCkhPXR9fSk7cmV0dXJuIHJ9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDE0NyksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1lLnRwbCgnXHQgICAgPGxpPlx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImRhdGEtbGlzdC1uYXYtbGluayBkYXRhLWxpc3QtcGFnZXItbmF2LWxpbmsiIGRhdGEtdmFsdWU9Int7dmFsdWV9fSI+e3tsYWJlbH19PC9hPlx0ICAgIDwvbGk+XHQgICcpLHI9aS5leHRlbmQoe3RhZ05hbWU6InVsIixjbGFzc05hbWU6ImRhdGEtbGlzdC1wYWdlci1hbHBoYSBjbGVhcmZpeCBmbG9hdC1yIixldmVudHM6eyJjbGljayBsaSBhIjpmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksdGhpcy5hdXRvQmluZCYmdGhpcy5zdGF0ZS51bnNldCgic2VhcmNoIik7dmFyIGk9dChlLnRhcmdldCkuZGF0YSgidmFsdWUiKTtpPT09ci5ERUZBVUxUX1ZBTFVFP3RoaXMuc3RhdGUudW5zZXQodGhpcy5maWVsZCk6dGhpcy5zdGF0ZS5zZXQodGhpcy5maWVsZCxpKSx0aGlzLnRvZ2dsZSgpfX0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtpZihpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwhdGhpcy5zdGF0ZSl0aHJvdyBuZXcgRXJyb3IoIk5vIFN0YXRlIFByb3ZpZGVkIik7dGhpcy5hdXRvQmluZD10aGlzLm9wdGlvbnMuYXV0b0JpbmQhPT0hMSx0aGlzLmZpZWxkPXRoaXMub3B0aW9ucy5maWVsZHx8InByZWZpeCIsdGhpcy5saXN0ZW5Ubyh0aGlzLnN0YXRlLCJjaGFuZ2U6Iit0aGlzLmZpZWxkLHRoaXMuX3RvZ2dsZUNsYXNzKSx0aGlzLmF1dG9CaW5kJiZ0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZTpzZWFyY2giLHRoaXMudG9nZ2xlKX0scmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy4kZWwuaHRtbChuKHt2YWx1ZTpyLkRFRkFVTFRfVkFMVUUsbGFiZWw6ci5ERUZBVUxUX0xBQkVMfSkpO2Zvcih2YXIgdD02NTt0PD05MDt0Kyspe3ZhciBlPVN0cmluZy5mcm9tQ2hhckNvZGUodCk7dGhpcy4kZWwuYXBwZW5kKG4oe3ZhbHVlOmUsbGFiZWw6ZX0pKX1yZXR1cm4gdGhpcy5hdXRvQmluZCYmdGhpcy50b2dnbGUoKSx0aGlzfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCJsaSBhLiIrci5BQ1RJVkVfQ0xBU1NfTkFNRSkuZGF0YSgidmFsdWUiKX0sX3RvZ2dsZUNsYXNzOmZ1bmN0aW9uKCl7aWYodGhpcy4kKCJsaSBhIikucmVtb3ZlQ2xhc3Moci5BQ1RJVkVfQ0xBU1NfTkFNRSksIXRoaXMuX2Rpc2FibGVkKXt2YXIgdD10aGlzLnN0YXRlLmdldCh0aGlzLmZpZWxkKXx8ci5ERUZBVUxUX1ZBTFVFO3RoaXMuJCgnbGkgYVtkYXRhLXZhbHVlPSInK3QrJyJdJykuYWRkQ2xhc3Moci5BQ1RJVkVfQ0xBU1NfTkFNRSksdGhpcy52YWwoKXx8dGhpcy5zdGF0ZS51bnNldCh0aGlzLmZpZWxkKX19LGVuYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kaXNhYmxlZD0hMSx0aGlzLl90b2dnbGVDbGFzcygpLHRoaXN9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGlzYWJsZWQ9ITAsdGhpcy5fdG9nZ2xlQ2xhc3MoKSx0aGlzfSx0b2dnbGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZS5nZXQoInNlYXJjaCIpP3RoaXMuZGlzYWJsZSgpOnRoaXMuZW5hYmxlKCl9fSx7REVGQVVMVF9WQUxVRToiYWxsIixERUZBVUxUX0xBQkVMOiJBbGwiLEFDVElWRV9DTEFTU19OQU1FOiJkYXRhLWxpc3QtbmF2LWxpbmstYWN0aXZlIn0pO3JldHVybiByfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgzNSksaSgxNDQpLGkoMTc3KSxpKDE5OCksaSgyNjApLGkoMjYxKSxpKDI2MildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXtmdW5jdGlvbiBsKGUsaSl7dmFyIG47aWYodC5pc0FycmF5KGUpKXt2YXIgcj1lO2k9clswXSxlPXJbMV0sbj1yWzJdfXJldHVybntsYWJlbDplLHZhbHVlOmksY291bnQ6bn19cmV0dXJue2NyZWF0ZUZpbHRlcnM6ZnVuY3Rpb24obil7dmFyIHI9dGhpcztyZXR1cm4gcy5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmVhY2gobixmdW5jdGlvbihuKXtpZih0LmlzRnVuY3Rpb24obil8fHQuaXNPYmplY3QobikmJm4gaW5zdGFuY2VvZiBlLlZpZXcpcmV0dXJuIHRoaXMuYWRkKG4pO3N3aXRjaChuLnR5cGUpe2Nhc2UiZm9ybSI6cmV0dXJuIHRoaXMuYWRkKHIuX19jcmVhdGVGaWx0ZXJGb3JtKG4pKTtkZWZhdWx0Omkud2FybigiYSB0eXBlIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGZpbHRlcnMiKTtjYXNlImZpbHRlcnNldCI6cmV0dXJuIHRoaXMuYWRkKHIuX19jcmVhdGVGaWx0ZXJTZXQobikpfX0sdGhpcyl9fSl9LF9fY3JlYXRlRmlsdGVyRm9ybTpmdW5jdGlvbihlKXtyZXR1cm4gdC5pc1VuZGVmaW5lZChlLnVzZUFwcGx5QnV0dG9uKXx8KGUubm9CdXR0b25CYXI9IWUudXNlQXBwbHlCdXR0b24pLGU9dC5leHRlbmQoe2NsYXNzTmFtZToiZGF0YS1saXN0LXNpZGViYXIgZGF0YS1saXN0LXNpZGViYXItZmlsdGVyLWZvcm0iLG5vQ2FuY2VsQnV0dG9uOiEwLGF1dG9CaW5kOiEwLHNhdmU6bi5sb2NhbGl6ZSgiZGF0YWxpc3QuYXBwbHlfZmlsdGVyIiksbm9CdXR0b25CYXI6ITAsY29uc3RydWN0b3I6ZnVuY3Rpb24odCl7dC5tb2RlbD10LnN0YXRlLmNsb25lKCksci5jYWxsKHRoaXMsdCksdGhpcy5hdXRvQmluZCYmdGhpcy5saXN0ZW5Ubyh0aGlzLnN0YXRlLCJjaGFuZ2U6c2VhcmNoIix0aGlzLnRvZ2dsZSk7dmFyIGk9ZS5ub0J1dHRvbkJhcj8iY2hhbmdlIjoic2F2ZSIsbj1lLm5vQnV0dG9uQmFyP3RoaXMubW9kZWw6dGhpczt0aGlzLmxpc3RlblRvKG4saSxmdW5jdGlvbih0KXt0aGlzLnN0YXRlLnNldCh0LnRvSlNPTigpKX0pfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmF1dG9CaW5kJiZ0aGlzLnRvZ2dsZSgpLHRoaXN9LHRvZ2dsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlLmdldCgic2VhcmNoIik/dGhpcy5kaXNhYmxlKCk6dGhpcy5lbmFibGUoKX19LGUpLGUuaW5wdXRzPXQubWFwKGUuaW5wdXRzLGZ1bmN0aW9uKGUpe3JldHVybiB0LmV4dGVuZCh7ImxhYmVsLXRvcCI6ITB9LGUpfSksci5leHRlbmQoZSl9LF9fY3JlYXRlRmlsdGVyU2V0OmZ1bmN0aW9uKGUpe3JldHVybiBvLmV4dGVuZCh7dGl0bGU6ZS5sYWJlbCxhdXRvQmluZDp0LmlzVW5kZWZpbmVkKGUuYXV0b0JpbmQpP28ucHJvdG90eXBlLmF1dG9CaW5kOmUuYXV0b0JpbmQsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3QuZWFjaCh0LnJlc3VsdChlLCJvcHRpb25zIiksZnVuY3Rpb24odCxpKXt2YXIgbj1sKHQsaSk7dGhpcy5hZGQoYSwidWwiLHtvcHRpb25zOntmaWVsZDplLmZpZWxkLGxhYmVsOm4ubGFiZWwsdmFsdWU6bi52YWx1ZSxjb3VudDpuLmNvdW50fX0pfSx0aGlzKX19KX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQ2KV0scj1mdW5jdGlvbih0KXtyZXR1cm4gdC5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3MoImRhdGEtbGlzdC1zaWRlYmFyLXdyYXAiKX0saGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLmhlaWdodCgpfSx0eXBlOiJzaWRlYmFyIn0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDcpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbihlKXt2YXIgaT1lLnByb3RvdHlwZT90LnJlc3VsdChlLnByb3RvdHlwZSwidGFnTmFtZSIpOnQucmVzdWx0KGUsInRhZ05hbWUiKTtyZXR1cm4ibGkiPT09aS50b0xvd2VyQ2FzZSgpfXZhciByPWUudHBsKCdcdCAgICB7eyNpZiB0aXRsZX19XHQgICAgICA8aDMgY2xhc3M9ImRhdGEtbGlzdC1zaWRlYmFyLWhlYWRpbmciPnt7dGl0bGV9fTwvaDM+XHQgICAge3svaWZ9fVx0ICAgIDx1bCBjbGFzcz0iZGF0YS1saXN0LW5hdiI+PC91bD5cdCAgJyk7cmV0dXJuIGkuZXh0ZW5kKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImRhdGEtbGlzdC1maWx0ZXJzZXQifSxjbGFzc05hbWU6ImRhdGEtbGlzdC1zaWRlYmFyIixhdXRvQmluZDohMCxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2kuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXV0b0JpbmQmJnRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY2hhbmdlOnNlYXJjaCIsdGhpcy50b2dnbGUpLHQuaXNVbmRlZmluZWQodGhpcy50aXRsZSkmJih0aGlzLnRpdGxlPSJGaWx0ZXJzIil9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRlbXBsYXRlPXIoe3RpdGxlOnRoaXMudGl0bGV9KSxpLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXV0b0JpbmQmJnRoaXMudG9nZ2xlKCksdGhpc30sYWRkOmZ1bmN0aW9uKGUpe2lmKCFuKGUpKXRocm93IG5ldyBFcnJvcigiVW5zdXBwb3J0ZWQgVGFnIE5hbWUiKTtlLmF1dG9CaW5kPXRoaXMuYXV0b0JpbmQ7dmFyIHI9dC50b0FycmF5KGFyZ3VtZW50cyk7cmV0dXJuIHJbMV18fChyWzFdPSIuZGF0YS1saXN0LW5hdiIpLGkucHJvdG90eXBlLmFkZC5hcHBseSh0aGlzLHIpfSx0b2dnbGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZS5nZXQoInNlYXJjaCIpP3RoaXMuZGlzYWJsZSgpOnRoaXMuZW5hYmxlKCl9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZva2UoImRpc2FibGUiKSx0aGlzfSxlbmFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZva2UoImVuYWJsZSIpLHRoaXN9LGhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRlbC5oZWlnaHQoKX0sdHlwZToic2lkZWJhciJ9KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDE0NildLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpLmV4dGVuZCh7dGFnTmFtZToibGkiLHRlbXBsYXRlOmUudHBsKCdcdCAgICAgIDxhIGNsYXNzPSJkYXRhLWxpc3QtbmF2LWxpbmsgZ3JhZGllbnQiIGhyZWY9IiMiIGRhdGEtc2U9Int7dmFsdWV9fSI+XHQgICAgICAgIHt7bGFiZWx9fVx0ICAgICAgICA8c3BhbiBjbGFzcz0iZGF0YS1saXN0LWZpbHRlci1jb3VudCI+e3tjb3VudH19PC9zcGFuPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iZGF0YS1saXN0LW5hdi1saW5rLWFycm93Ij48L3NwYW4+XHQgICAgICA8L2E+XHQgICAgJyksYXV0b0JpbmQ6ITAsZXZlbnRzOnsiY2xpY2sgYSI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuYXV0b0JpbmQmJnRoaXMuc3RhdGUuZ2V0KCJzZWFyY2giKSYmdGhpcy5zdGF0ZS51bnNldCgic2VhcmNoIiksdGhpcy5zdGF0ZS5zZXQodGhpcy5maWVsZCx0aGlzLm9wdGlvbnMudmFsdWUpfX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXtpZighdGhpcy5zdGF0ZXx8IXQubGFiZWx8fCJ1bmRlZmluZWQiPT10eXBlb2YgdC52YWx1ZSl0aHJvdyBuZXcgRXJyb3IoIk1pc3NpbmcgQXJndW1lbnRzIik7dGhpcy5maWVsZD10JiZ0LmZpZWxkfHwiZmlsdGVyIix0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZToiK3RoaXMuZmllbGQsdGhpcy5fdG9nZ2xlU2VsZWN0ZWQpLHRoaXMuZW5hYmxlKCl9LGRpc2FibGU6ZnVuY3Rpb24oKXt0aGlzLl90b2dnbGVFbmFibGVkKCExKX0sZW5hYmxlOmZ1bmN0aW9uKCl7dGhpcy5fdG9nZ2xlRW5hYmxlZCghMCl9LF90b2dnbGVFbmFibGVkOmZ1bmN0aW9uKHQpe3RoaXMuX2Rpc2FibGVkPSF0LHRoaXMuX3RvZ2dsZVNlbGVjdGVkKCl9LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBlPXRoaXMudGVtcGxhdGUoe2xhYmVsOnRoaXMub3B0aW9ucy5sYWJlbCxjb3VudDp0LmlzVW5kZWZpbmVkKHRoaXMub3B0aW9ucy5jb3VudCk/IiI6dGhpcy5vcHRpb25zLmNvdW50LHZhbHVlOnRoaXMub3B0aW9ucy52YWx1ZX0pO3JldHVybiB0aGlzLiRlbC5odG1sKGUpLHRoaXMuZW5hYmxlKCksdGhpc30sX3RvZ2dsZVNlbGVjdGVkOmZ1bmN0aW9uKCl7dmFyIHQ9IXRoaXMuX2Rpc2FibGVkJiZ0aGlzLnN0YXRlLmdldCh0aGlzLmZpZWxkKT09dGhpcy5vcHRpb25zLnZhbHVlO3RoaXMuJCgiYSIpLnRvZ2dsZUNsYXNzKCJkYXRhLWxpc3QtbmF2LWxpbmstYWN0aXZlIix0KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7ZGVib3VuY2VUaW1lOjEwMCxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJGVsLmFkZENsYXNzKCJkYXRhLWxpc3QgZGF0YS1saXN0LXNpZGViYXItbGVmdCBjbGVhcmZpeCIpfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gZS5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0LmRlZmVyKHQuYmluZCh0aGlzLmJhbGFuY2UsdGhpcykpLHRoaXMuZmluZFdoZXJlKHt0eXBlOiJzaWRlYmFyIn0pfHx0aGlzLiRlbC5yZW1vdmVDbGFzcygiZGF0YS1saXN0LXNpZGViYXItbGVmdCIpLHRoaXN9LGJhbGFuY2VkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2lkZWJhcj10aGlzLmZpbmRXaGVyZSh7dHlwZToic2lkZWJhciJ9KSx0aGlzLmNvbnRlbnQ9dGhpcy5maW5kV2hlcmUoe3R5cGU6ImNvbnRlbnQifSksIXRoaXMuc2lkZWJhcnx8IXRoaXMuY29udGVudHx8dGhpcy5zaWRlYmFyLmhlaWdodCgpPD10aGlzLmNvbnRlbnQuaGVpZ2h0KCl9LGJhbGFuY2U6dC5kZWJvdW5jZShmdW5jdGlvbigpe3RoaXMuYmFsYW5jZWQoKXx8dGhpcy5jb250ZW50LmhlaWdodCh0aGlzLnNpZGViYXIuaGVpZ2h0KCkrMzApfSx0aGlzLmRlYm91bmNlVGltZSl9KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDE0NiksaSgyNjUpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPWUudHBsKCdcdCAgICA8dHI+XHQgICAgICA8dGQgY29sc3Bhbj0ie3tjb2xzcGFufX0iPjwvdGQ+XHQgICAgPC90cj5cdCAgJykscz1pLmV4dGVuZCh7dGFnTmFtZToidGZvb3QiLGNsYXNzTmFtZToiZGF0YS1saXN0LXBhZ2VyLWZvb3RlciIsY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwicmVxdWVzdCIsdGhpcy5lbXB0eSksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sInN5bmMgcmVzZXQiLHQuZGVib3VuY2UodGhpcy5yZW5kZXIsNTApKX0scmVuZGVyOmZ1bmN0aW9uKCl7aWYodGhpcy5jb2xsZWN0aW9uLmhhc01vcmUoKSl7dmFyIHQ9dGhpcy5vcHRpb25zLmNvbHNwYW58fHRoaXMuY29sc3Bhbnx8MTAwO3RoaXMuJGVsLmh0bWwocih7Y29sc3Bhbjp0fSkpLHRoaXMuJCgidGQiKS5odG1sKG5ldyBuKHRoaXMub3B0aW9ucykucmVuZGVyKCkuZWwpfWVsc2UgdGhpcy5lbXB0eSgpO3JldHVybiB0aGlzfSxlbXB0eTpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCl9fSk7cmV0dXJuIHN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZXh0ZW5kKHtlbDonPGEgaHJlZj0iIyIgY2xhc3M9ImRhdGEtbGlzdC1wYWdlci1mb290ZXItbGluayI+PC9hPicsdGVtcGxhdGU6J3t7aTE4biBjb2RlPSJkYXRhbGlzdC5zaG93X21vcmUifX0nLGV2ZW50czp7Y2xpY2s6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuY29sbGVjdGlvbi5mZXRjaE1vcmUmJnRoaXMuY29sbGVjdGlvbi5mZXRjaE1vcmUoKX19fSk7cmV0dXJuIGV9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTk4KSxpKDIwMyksaSgyNjgpLGkoMjY5KSxpKDI3MCksaSgyMzQpLGkoMjI1KSxpKDIzMyksaSgxOTkpLGkoMjAwKSxpKDIzMCksaSgyMzIpLGkoMjcxKSxpKDIyNCksaSgyNzUpLGkoMjcyKSxpKDIyOCksaSgyMTApLGkoMjc2KSxpKDIxMyksaSgyNzcpLGkoMjc0KSxpKDIxNSksaSgyNzgpLGkoMjgxKSxpKDIxNCksaSgyMDgpLGkoMjgyKSxpKDIwNiksaSgyMjIpLGkoMjA1KSxpKDIwMiksaSgyNzMpLGkoMjExKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjLHUsZCxoLHAsZixtLF8sZyx2LHksYix3LE0sayxULFMsTCx4LEUsRCxZLEMsQSxPKXtyZXR1cm57QmFzZUZvcm06dCxCYXNlSW5wdXQ6ZSxjb21wb25lbnRzOntUZXh0Q291bnRlckV4cGxhaW46aSxXaXphcmRUaXRsZTpufSxoZWxwZXJzOntFbnVtVHlwZUhlbHBlcjpyLEVycm9yQmFubmVyOnMsRXJyb3JQYXJzZXI6byxGb3JtVXRpbDphLElucHV0Q29udGFpbmVyOmwsSW5wdXRGYWN0b3J5OmMsSW5wdXRMYWJlbDp1LElucHV0V3JhcHBlcjpkLFNjaGVtYUZvcm1GYWN0b3J5Omh9LGlucHV0czp7QmFzZUZpbGVVcGxvYWRlcjpwLEJhc2VQaWNrZXI6ZixCb29sZWFuU2VsZWN0Om0sQ2VydGlmaWNhdGlvbkZpbGVVcGxvYWRlcjpfLENoZWNrQm94OmcsQ2hlY2tCb3hTZXQ6dixEYXRlQm94OnksRGF0ZVRpbWVQaWNrZXI6YixEZWxldGFibGVCb3g6dyxHcm91cFBpY2tlcjpNLEdyb3VwU2VsZWN0OmssSWRwUGlja2VyOlQsTnVtYmVyQm94OlMsUmFkaW86TCxTY29wZXNQaWNrZXI6eCxTZWxlY3Q6RSxTaW1wbGVDaGVja0JveFNldDpELFRleHRBcmVhOlksVGV4dEJveDpDLFRleHRCb3hTZXQ6QSxUZXh0U2VsZWN0Ok99fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6J1x0ICAgIHt7I2lmIGhhc1JlbWFpbmluZ319XHQgICAgICB7e2kxOG4gY29kZT0iY2hhcmFjdGVycy5yZW1haW5pbmciIGJ1bmRsZT0ibWVzc2FnZXMiIGFyZ3VtZW50cz0iY291bnQifX1cdCAgICB7ey9pZn19XHQgICAge3sjdW5sZXNzIGhhc1JlbWFpbmluZ319XHQgICAgICA8ZGl2IGNsYXNzPSJvLWZvcm0tdGV4dC1jb3VudGVyLW92ZXIiPlx0ICAgICAgICB7e2kxOG4gY29kZT0iY2hhcmFjdGVycy5vdmVyIiBidW5kbGU9Im1lc3NhZ2VzIiBhcmd1bWVudHM9ImNvdW50In19XHQgICAgICA8L2Rpdj5cdCAgICB7ey91bmxlc3N9fScsCgltb2RlbEV2ZW50czpmdW5jdGlvbigpe3ZhciBlPXt9O3JldHVybiBlWyJjaGFuZ2U6Iit0aGlzLm9wdGlvbnMuZmllbGRdPXQudGhyb3R0bGUodGhpcy5yZW5kZXIsNTApLGV9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXtpZighdGhpcy5vcHRpb25zLm1vZGVsfHwhdGhpcy5vcHRpb25zLmZpZWxkKXRocm93IG5ldyBFcnJvcignQ2Fubm90IGNyZWF0ZSBUZXh0Q291bnRlckV4cGxhaW4uIG1pc3NpbmcgYXJndW1lbnRzIFsibW9kZWwiLCAiZmllbGQiXScpO3ZhciBlPXRoaXMub3B0aW9ucy5tb2RlbC5nZXRQcm9wZXJ0eVNjaGVtYSh0aGlzLm9wdGlvbnMuZmllbGQpO2lmKCFlfHwhdC5pc051bWJlcihlLm1heExlbmd0aCkpdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY3JlYXRlIFRleHRDb3VudGVyRXhwbGFpbi4gcHJvcGVydHkgbWlzc2luZyAibWF4TGVuZ3RoIiBkZWZpbml0aW9uJyk7dGhpcy5maWVsZD10aGlzLm9wdGlvbnMuZmllbGQsdGhpcy5tYXhMZW5ndGg9ZS5tYXhMZW5ndGh9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciB0PXRoaXMubW9kZWwuZ2V0KHRoaXMuZmllbGQpfHwiIixlPXRoaXMubWF4TGVuZ3RoLGk9ZS10Lmxlbmd0aCxuPWk+PTA7cmV0dXJue2hhc1JlbWFpbmluZzpuLGNvdW50Om4/aTpNYXRoLmFicyhpKX19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZXh0ZW5kKHt0YWdOYW1lOiJoMiIsY2xhc3NOYW1lOiJ3aXphcmQtaGVhZCIsdGVtcGxhdGU6JzxzcGFuIGNsYXNzPSJzdGVwLW51bSI+e3tzdGVwfX08L3NwYW4+e3t0aXRsZX19J30pO3JldHVybiBlfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSg1KSxpKDE3NiksaSgyMjIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe2Z1bmN0aW9uIHIoZSl7dmFyIHI9e25hbWU6ZS5uYW1lLGxhYmVsOmUudGl0bGUscmVhZE9ubHk6ZS5yZWFkT25seSxjdXN0b21FeHBsYWluOmUuZXhwbGFpbixvcHRpb25zOnMoZS5lbnVtVmFsdWVzKSxwYXJhbXM6e2VudW1WYWx1ZXM6ZS5lbnVtVmFsdWVzfX07cmV0dXJuIGUuZGlzcGxheVR5cGU9PT1pLkRBVEFUWVBFLm9iamVjdD8oci50bz1sLHIuZnJvbT1hKTplLmRpc3BsYXlUeXBlPT09aS5BUlJBWURJU1BMQVlUWVBFLmFycmF5b2ZvYmplY3QmJihyLnRvPWZ1bmN0aW9uKGUpe3JldHVybiB0Lm1hcChlLGwsdGhpcyl9LHIuZnJvbT1mdW5jdGlvbihlKXtyZXR1cm4gdC5tYXAoZSxhLHRoaXMpfSksaS5pc0FycmF5RGF0YVR5cGUoZS5kaXNwbGF5VHlwZSk/ci5pbnB1dD1uOnIudHlwZT0ic2VsZWN0IixyfWZ1bmN0aW9uIHMoaSl7cmV0dXJuIHQuaXNBcnJheShpKT90LmFsbChpLGUuaXNQbGFpbk9iamVjdCk/dC5yZWR1Y2UoaSxvLHt9KTp0Lm9iamVjdChpLGkpOnt9fWZ1bmN0aW9uIG8odCxpKXtpZihlLmlzUGxhaW5PYmplY3QoaSkmJmkuaGFzT3duUHJvcGVydHkoYykpe3ZhciBuPWEoaSkscj1pLm5hbWU7dFtuXT1yfXJldHVybiB0fWZ1bmN0aW9uIGEodCl7cmV0dXJuIHQmJnRbY119ZnVuY3Rpb24gbChlKXtpZih0aGlzLm9wdGlvbnMucGFyYW1zJiZ0LmlzQXJyYXkodGhpcy5vcHRpb25zLnBhcmFtcy5lbnVtVmFsdWVzKSlyZXR1cm4gdC5maW5kKHRoaXMub3B0aW9ucy5wYXJhbXMuZW51bVZhbHVlcyxmdW5jdGlvbih0KXtyZXR1cm4gdFtjXT09PWV9KTt0aHJvdyBuZXcgRXJyb3IoIkNhbiBub3QgZmluZCBlbnVtIG9iamVjdCBmcm9tIEVudW0gVmFsdWVzIGxpc3QgZm9yIGtleTogIitlKX12YXIgYz0ibmFtZSI7cmV0dXJue2dldEVudW1JbnB1dE9wdGlvbnM6cixnZXREcm9wZG93bk9wdGlvbnM6c319LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE3NyksaSgyNzIpLGkoMjczKSxpKDIyMiksaSgyNzApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXtmdW5jdGlvbiBvKHIpe3ZhciBzPXIuZ2V0KCJfX2Rpc3BsYXlUeXBlX18iKSxvPXIuZ2V0KCJfX3Bvc3NpYmxlVmFsdWVzX18iKSxhPXIuZ2V0KCJuYW1lIiksYz1yLmdldCgidGl0bGUiKSxkPXt0eXBlOiJ0ZXh0IixuYW1lOmEsbGFiZWw6Y3x8YX07c3dpdGNoKHMpe2Nhc2UiYXJyYXlvZnN0cmluZyI6ZC5pbnB1dD1uLGQucGFyYW1zPXtpdGVtVHlwZToic3RyaW5nIn07YnJlYWs7Y2FzZSJhcnJheW9mbnVtYmVyIjpkLmlucHV0PW4sZC5wYXJhbXM9e2l0ZW1UeXBlOiJudW1iZXIifTticmVhaztjYXNlImFycmF5b2ZpbnRlZ2VyIjpkLmlucHV0PW4sZC5wYXJhbXM9e2l0ZW1UeXBlOiJpbnRlZ2VyIn07YnJlYWs7Y2FzZSJhcnJheW9mb2JqZWN0IjpkLmlucHV0PW4sZC5wYXJhbXM9e2l0ZW1UeXBlOnIuZ2V0KCJpdGVtcyIpLnR5cGV9O2JyZWFrO2Nhc2UiYm9vbGVhbiI6ZC5pbnB1dD1pO2JyZWFrO2Nhc2UiaW50ZWdlciI6Y2FzZSJudW1iZXIiOmQudG89bDticmVhaztjYXNlInJlZmVyZW5jZSI6ZC50eXBlPSJzZWxlY3QiLGQub3B0aW9ucz11KG8pO2JyZWFrO2Nhc2UiaW1hZ2UiOmQucmVhZE9ubHk9ITAsZC5mcm9tPWZ1bmN0aW9uKGkpe3JldHVybiB0LmlzRW1wdHkoaSk/IiI6ZS5sb2NhbGl6ZSgidXNlci5wcm9maWxlLmltYWdlLmltYWdlX3NldCIpfTticmVhaztjYXNlInBhc3N3b3JkIjpkLnR5cGU9InBhc3N3b3JkIjticmVhaztjYXNlImRhdGUiOmQudHlwZT0iZGF0ZSI7YnJlYWs7Y2FzZSJ1cmkiOmNhc2UiY291bnRyeS1jb2RlIjpjYXNlImxhbmd1YWdlLWNvZGUiOmNhc2UiZW1haWwiOmNhc2UibG9jYWxlIjpjYXNlInRpbWV6b25lIjpjYXNlInN0cmluZyI6Y2FzZSJvYmplY3QiOmJyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJ1bmtub3duIHR5cGU6ICIrcyl9cmV0dXJuIGR9ZnVuY3Rpb24gYShlKXt2YXIgaT17fSxuPWUuZ2V0KCJuYW1lIiksbz1lLmdldCgiX19kaXNwbGF5VHlwZV9fIiksYT1lLmdldCgiX19wb3NzaWJsZVZhbHVlc19fIiksbD1lLmdldCgiX19maWVsZE5hbWVQcmVmaXhfXyIpO2lmKGwmJihpLm5hbWU9bCtuLGkuZXJyb3JGaWVsZD1uKSxlLmlzRW51bVR5cGUoKSl7dmFyIGQ9e2Rpc3BsYXlUeXBlOm8sdGl0bGU6ZS5nZXQoInRpdGxlIiksZW51bVZhbHVlczplLmdldEVudW1WYWx1ZXMoKX07aT10LmV4dGVuZCh7fSxzLmdldEVudW1JbnB1dE9wdGlvbnMoZCksaSl9ZWxzZSBjKG8pJiZhJiYoaS5pbnB1dD1yLGkub3B0aW9ucz11KGEpKTtyZXR1cm4gaX1mdW5jdGlvbiBsKHQpe3ZhciBpPWUucGFyc2VGbG9hdCh0KTtyZXR1cm4iIj09PXQ/bnVsbDppfWZ1bmN0aW9uIGModCl7cmV0dXJuIHQmJnQuaW5kZXhPZigiYXJyYXkiKT49MH1mdW5jdGlvbiB1KGUpe3JldHVybiB0Lm9iamVjdChlLGUpfWZ1bmN0aW9uIGQodCl7dmFyIGU9dC5nZXQoIml0ZW1zIik7cmV0dXJuIGU/ZS5vYmplY3ROYW1lOnQuZ2V0KCJvYmplY3ROYW1lIil9ZnVuY3Rpb24gaChlLGksbil7dmFyIHIscyxvPWUuZ2V0KCJuYW1lIiksYT1uLl9fbmVzdGVkUHJvcGVydHlfXyxsPWlbb10sYz1uLmdldChvKTthJiZlLnNldCgiX19maWVsZE5hbWVQcmVmaXhfXyIsYSkscj1pW2QoZSldLGwmJmMmJihsPXQudW5pb24obCxjKSksciYmci5sZW5ndGg/cz1yOmwmJmwubGVuZ3RoJiYocz1sKSxlLnNldCgiX19wb3NzaWJsZVZhbHVlc19fIixzKX1mdW5jdGlvbiBwKHQsZSxpKXtyZXR1cm4gdC5lYWNoKGZ1bmN0aW9uKHQpe2godCxlLGkpfSksdH1mdW5jdGlvbiBmKHQsZSl7cmV0dXJuIHQuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiBtKHQsZSl9KX1mdW5jdGlvbiBtKGUsaSl7dmFyIG49ZChlKSxyPWlbbl07cmV0dXJuIW58fCF0KHIpLmlzRW1wdHkoKX1yZXR1cm57Y3JlYXRlSW5wdXRPcHRpb25zOmZ1bmN0aW9uKGUpe3ZhciBpPWEoZSksbj1vKGUpO3JldHVybiBpLnBhcmFtcyYmbi5wYXJhbXMmJihpLnBhcmFtcz10LmRlZmF1bHRzKGkucGFyYW1zLG4ucGFyYW1zKSksdC5kZWZhdWx0cyhpLG4pfSxoYXNWYWxpZFNjaGVtYVByb3BzOmZ1bmN0aW9uKGUsaSl7aWYodC5pc0VtcHR5KGUpKXJldHVybiExO3ZhciBuPWYoZSxpKTtyZXR1cm4hIW4ubGVuZ3RofSxwcmVwYXJlU2NoZW1hOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdC5yZXNldChmKHQsZSkpLHAodCxlLGkpfSxhdWdtZW50U2NoZW1hUHJvcHM6cCxhdWdtZW50U2NoZW1hUHJvcDpofX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIwNildLHI9ZnVuY3Rpb24odCl7dmFyIGU9e3VuZGVmaW5lZDoidW5kZWZpbmVkIiwidHJ1ZSI6InRydWUiLCJmYWxzZSI6ImZhbHNlIn0saT1mdW5jdGlvbih0KXtyZXR1cm4gdD8idHJ1ZSI6dD09PSExPyJmYWxzZSI6InVuZGVmaW5lZCJ9LG49ZnVuY3Rpb24odCl7c3dpdGNoKHQpe2Nhc2UidW5kZWZpbmVkIjpyZXR1cm4gbnVsbDtjYXNlInRydWUiOnJldHVybiEwO2Nhc2UiZmFsc2UiOnJldHVybiExO2RlZmF1bHQ6cmV0dXJuIG51bGx9fTtyZXR1cm4gdC5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMub3B0aW9ucz1lLHRoaXMub3B0aW9ucy5mcm9tPWksdGhpcy5vcHRpb25zLnRvPW59fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDIwMyksaSgxNzYpLGkoMjc0KV0scj1mdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiYXJyYXktaW5wdXQiLHRlbXBsYXRlOic8YSBocmVmPSIjIiBjbGFzcz0iYXJyYXktaW5wdXRzLWJ1dHRvbiBsaW5rLWJ1dHRvbiI+QWRkIEFub3RoZXI8L2E+JyxwYXJhbXM6e2l0ZW1UeXBlOiJzdHJpbmcifSxldmVudHM6eyJjbGljayAuYXJyYXktaW5wdXRzLWJ1dHRvbiI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuaXNFZGl0TW9kZSgpJiZ0aGlzLmFkZE5ld0VsZW1lbnQoKX19LGluaXRpYWxpemU6ZnVuY3Rpb24oZSl7ZXx8KGU9e30pLHRoaXMucGFyYW1zPXQuZGVmYXVsdHMoZS5wYXJhbXN8fHt9LHRoaXMucGFyYW1zKSx0aGlzLnVuaXF1ZUlkUHJlZml4PSJhcnJheSJ9LGZyb206ZnVuY3Rpb24oZSl7cmV0dXJuIHQuaXNBcnJheShlKT9lOltdfSxlZGl0TW9kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZXRBcnJheU9iamVjdCgpLHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSksdC5lYWNoKHRoaXMuYXJyYXlPYmplY3QsdC5iaW5kKHRoaXMuX2FkZERlbGV0YWJsZUJveCx0aGlzKSksdGhpc30scmVhZE1vZGU6ZnVuY3Rpb24oKXt0aGlzLmVkaXRNb2RlKCksdGhpcy4kKCIuYXJyYXktaW5wdXRzLWJ1dHRvbiIpLmFkZENsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIpfSx2YWw6ZnVuY3Rpb24oKXt2YXIgZT10LnZhbHVlcyh0aGlzLmFycmF5T2JqZWN0KTtyZXR1cm4gdC5jb250YWlucyhbaS5EQVRBVFlQRS5udW1iZXIsaS5EQVRBVFlQRS5pbnRlZ2VyXSx0aGlzLnBhcmFtcy5pdGVtVHlwZSkmJihlPXQuZmlsdGVyKGUsdC5pc051bWJlcikpLGV9LGZvY3VzOmZ1bmN0aW9uKCl7fSxhZGROZXdFbGVtZW50OmZ1bmN0aW9uKCl7dmFyIGU9IiIsaT10LnVuaXF1ZUlkKHRoaXMudW5pcXVlSWRQcmVmaXgpO3RoaXMuYXJyYXlPYmplY3RbaV09ZSx0aGlzLl9hZGREZWxldGFibGVCb3goZSxpKSx0aGlzLnVwZGF0ZSgpfSxfYWRkRGVsZXRhYmxlQm94OmZ1bmN0aW9uKGUsaSl7dmFyIHI9bmV3IG4odC5leHRlbmQodC5waWNrKHRoaXMub3B0aW9ucywicmVhZCIsInJlYWRPbmx5IiwibW9kZWwiKSx7a2V5OmksdmFsdWU6ZSxpdGVtVHlwZTp0aGlzLnBhcmFtcy5pdGVtVHlwZX0pKTtyZXR1cm4gdGhpcy5saXN0ZW5UbyhyLCJ1cGRhdGVBcnJheSIsZnVuY3Rpb24oZSl7dC5pc051bGwoZSk/KGRlbGV0ZSB0aGlzLmFycmF5T2JqZWN0W2ldLHRoaXMuc3RvcExpc3RlbmluZyhyKSk6dGhpcy5hcnJheU9iamVjdFtpXT1lLHRoaXMudXBkYXRlKCl9KSxyLnJlbmRlcigpLiRlbC5oaWRlKCksdGhpcy4kKCIuYXJyYXktaW5wdXRzLWJ1dHRvbiIpLmJlZm9yZShyLmVsKSxyLiRlbC5zbGlkZURvd24oKSxyfSxfc2V0QXJyYXlPYmplY3Q6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm1vZGVsLmdldCh0aGlzLm9wdGlvbnMubmFtZSk7aWYodGhpcy5hcnJheU9iamVjdD17fSx0LmlzQXJyYXkoZSkmJiF0LmlzRW1wdHkoZSkpe3ZhciBpPVtdLG49dGhpczt0KGUubGVuZ3RoKS50aW1lcyhmdW5jdGlvbigpe2kucHVzaCh0LnVuaXF1ZUlkKG4udW5pcXVlSWRQcmVmaXgpKX0pLHRoaXMuYXJyYXlPYmplY3Q9dC5vYmplY3QoaSxlKX19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0MiksaSgxNzYpLGkoMTc3KSxpKDE0NyksaSgxODcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXt2YXIgbz1mdW5jdGlvbih0KXtyZXR1cm4vXlthZWlvdV0vLnRlc3QodCl9LGE9ZnVuY3Rpb24odCl7cmV0dXJuIG8odCk/ImFuIjoiYSJ9LGw9ci50cGwoJ1x0ICAgIDxkaXYgY2xhc3M9Im8tZm9ybS1pbnB1dC1ncm91cC1jb250cm9scyI+XHQgICAgICA8c3BhbiBjbGFzcz0iaW5wdXQtZml4IG8tZm9ybS1jb250cm9sIj5cdCAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJvLWZvcm0tdGV4dCIgbmFtZT0ie3trZXl9fSIgaWQ9Int7a2V5fX0iIHZhbHVlPSJ7e3ZhbHVlfX0iIFx0ICAgICAgICBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19Ii8+XHQgICAgICA8L3NwYW4+XHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluay1idXR0b24gbGluay1idXR0b24taWNvbiBpY29uLW9ubHkgY2xlYXItaW5wdXQtMTYiPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiAiPjwvc3Bhbj5cdCAgICAgIDwvYT5cdCAgICA8L2Rpdj5cdCAgICA8cCBjbGFzcz0iby1mb3JtLWlucHV0LWVycm9yIG8tZm9ybS1leHBsYWluIj5cdCAgICAgIDxzcGFuIGNsYXNzPSJpY29uIGljb24tMTYgZXJyb3ItMTYtc21hbGwiPjwvc3Bhbj4ge3tlcnJvckV4cGxhaW59fVx0ICAgIDwvcD5cdCAgJyksYz0iby1mb3JtLWhhcy1lcnJvcnMiLHU9InVwZGF0ZUFycmF5IjtyZXR1cm4gZS5leHRlbmQoe3RhZ05hbWU6ImRpdiIsY2xhc3NOYW1lOiJvLWZvcm0taW5wdXQtZ3JvdXAiLGV2ZW50czp7ImNsaWNrIGEiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnJlbW92ZSgpfSwia2V5dXAgaW5wdXQiOmZ1bmN0aW9uKCl7dGhpcy51cGRhdGUoKX19LGlzRWRpdE1vZGU6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5vcHRpb25zLnJlYWRPbmx5JiYodGhpcy5vcHRpb25zLnJlYWQhPT0hMHx8dGhpcy5tb2RlbC5nZXQoIl9fZWRpdF9fIik9PT0hMCl9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLnRlbXBsYXRlPWwodC5leHRlbmQodGhpcy5vcHRpb25zLHtwbGFjZWhvbGRlcjp0aGlzLmdldFBsYWNlaG9sZGVyVGV4dCgpLGVycm9yRXhwbGFpbjp0aGlzLmdldEVycm9yRXhwbGFpblRleHQoKX0pKSx0aGlzLnVwZGF0ZT10LmRlYm91bmNlKHRoaXMudXBkYXRlLHRoaXMub3B0aW9ucy5kZWJvdW5jZURlbGF5fHxzLkRFQk9VTkNFX0RFTEFZKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFZGl0TW9kZSgpP3RoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSk6KHRoaXMuJGVsLnRleHQodGhpcy5vcHRpb25zLnZhbHVlKSx0aGlzLiQoImEiKS5oaWRlKCkpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcih1LG51bGwpLHRoaXMuJGVsLnNsaWRlVXAodC5iaW5kKGZ1bmN0aW9uKCl7ZS5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcyxhcmd1bWVudHMpfSx0aGlzKSl9LHVwZGF0ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuJCgiaW5wdXQiKS52YWwoKSxyPXQub2JqZWN0KFtpLkRBVEFUWVBFLm51bWJlcixpLkRBVEFUWVBFLmludGVnZXJdLFtuLnBhcnNlRmxvYXQsdGhpcy5wYXJzZUludF0pO3QuaGFzKHIsdGhpcy5vcHRpb25zLml0ZW1UeXBlKSYmKGU9clt0aGlzLm9wdGlvbnMuaXRlbVR5cGVdKGUpLHQuaXNOdW1iZXIoZSk/dGhpcy5jbGVhckludmFsaWQoKTp0aGlzLm1hcmtJbnZhbGlkKCkpLHRoaXMudHJpZ2dlcih1LGUpfSxtYXJrSW52YWxpZDpmdW5jdGlvbigpe3RoaXMuJGVsLmFkZENsYXNzKGMpfSxjbGVhckludmFsaWQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmVDbGFzcyhjKX0sZ2V0UGxhY2Vob2xkZXJUZXh0OmZ1bmN0aW9uKCl7dmFyIHQ9WyJFbnRlciJdO3JldHVybiB0LnB1c2goYSh0aGlzLm9wdGlvbnMuaXRlbVR5cGUpKSx0LnB1c2godGhpcy5vcHRpb25zLml0ZW1UeXBlLnRvTG93ZXJDYXNlKCkpLHQuam9pbigiICIpfSxnZXRFcnJvckV4cGxhaW5UZXh0OmZ1bmN0aW9uKCl7dmFyIHQ9WyJWYWx1ZSBtdXN0IGJlIl07cmV0dXJuIHQucHVzaChhKHRoaXMub3B0aW9ucy5pdGVtVHlwZSkpLHQucHVzaCh0aGlzLm9wdGlvbnMuaXRlbVR5cGUudG9Mb3dlckNhc2UoKSksdC5qb2luKCIgIil9LHBhcnNlSW50OmZ1bmN0aW9uKGUpe2lmKC9eLT9cZCskLy50ZXN0KGUpKXt2YXIgaT1wYXJzZUludChlLDEwKTtyZXR1cm4gdC5pc05hTihpKT9lOml9cmV0dXJuIGV9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSg1KSxpKDE3MyksaSgxNDcpLGkoMjAzKSxpKDIwOSksaSg3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBzPW4udHBsKCdcdCAgICA8c3BhbiBjbGFzcz0iYm9sZCBtYXJnaW4tbjEwIj57e3RpdGxlfX08L3NwYW4+XHQgICcpLG89bi50cGwoJ1x0ICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgbmFtZT0ie3tuYW1lfX0iIGlkPSJ7e2lkfX0iLz5cdCAgICA8bGFiZWwgZm9yPSJ7e2lkfX0iPnt7bGFiZWx9fTwvbGFiZWw+XHQgICcpLGE9bi50cGwoInt7c3VmZml4fX17e2lkfX0iKTtyZXR1cm4gci5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oZSl7aWYodGhpcy5hbGxPcHRpbw==", "base64"));
  res.write(new Buffer("bnM9ZS5vcHRpb25zLmFsbCx0aGlzLnN1ZmZpeD1lLm5hbWUsdGhpcy5ncm91cGVkT3B0aW9ucz17fSxlLm9wdGlvbnMubXVsdGlDb2x1bW4pe3ZhciBpPWUub3B0aW9ucy5ncm91cEJ5RmllbGQ7dC5lYWNoKHRoaXMuYWxsT3B0aW9ucyxmdW5jdGlvbih0KXt0aGlzLmdyb3VwZWRPcHRpb25zW3RbaV1dfHwodGhpcy5ncm91cGVkT3B0aW9uc1t0LmNhdGVnb3J5XT1bXSksdGhpcy5ncm91cGVkT3B0aW9uc1t0LmNhdGVnb3J5XS5wdXNoKHQpfSx0aGlzKX19LGV2ZW50czp7ImNoYW5nZSA6Y2hlY2tib3giOiJ1cGRhdGUiLGtleXVwOmZ1bmN0aW9uKHQpe3ZhciBuPXQud2hpY2h8fHQua2V5Q29kZTtuPT09aS5TUEFDRSYmZSh0LnRhcmdldCkuY2xpY2soKX19LHByZVJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCk7dmFyIGU9dC5rZXlzKHRoaXMuZ3JvdXBlZE9wdGlvbnMpO3RoaXMub3B0aW9ucy5vcHRpb25zLm11bHRpQ29sdW1uJiZlLmxlbmd0aD4xP3RoaXMucmVuZGVyTXVsdGlDb2x1bW4oZSk6dGhpcy5yZW5kZXJTaW5nbGVDb2x1bW4oKTt2YXIgaT10aGlzLiQoImlucHV0Iik7dC5kZWZlcih0LmJpbmQoaS5jdXN0b21JbnB1dCxpKSl9LHJlbmRlclNpbmdsZUNvbHVtbjpmdW5jdGlvbigpe3QuZWFjaCh0aGlzLmFsbE9wdGlvbnMsZnVuY3Rpb24oZSl7dGhpcy4kZWwuYXBwZW5kKG8oe25hbWU6YSh0LmV4dGVuZCh0aGlzLGUpKSxpZDphKHQuZXh0ZW5kKHRoaXMsZSkpLGxhYmVsOmUuZGlzcGxheU5hbWV8fGUubmFtZX0pKX0sdGhpcyl9LHJlbmRlck11bHRpQ29sdW1uOmZ1bmN0aW9uKGUpe3ZhciBpPTM9PWUubGVuZ3RoPyJzdS1jaGVja2JveC0zY29sdW1ucyI6InN1LWNoZWNrYm94LTJjb2x1bW5zIjt0LmVhY2goZSxmdW5jdGlvbihlLG4pe3ZhciByPSJjb2x1bW4iK247dGhpcy4kZWwuYXBwZW5kKCc8c3BhbiBjbGFzcz0iJytpKyciIGlkPSInK3IrJyI+Jyk7dmFyIGw9dGhpcy4kZWwuZmluZCgiIyIrcik7bC5hcHBlbmQocyh7dGl0bGU6ZX0pKSx0LmVhY2godGhpcy5ncm91cGVkT3B0aW9uc1tlXSxmdW5jdGlvbihlKXtsLmFwcGVuZChvKHtuYW1lOmEodC5leHRlbmQodGhpcyxlKSksaWQ6YSh0LmV4dGVuZCh0aGlzLGUpKSxsYWJlbDplLmRpc3BsYXlOYW1lfHxlLm5hbWV9KSl9LHRoaXMpLHRoaXMuJGVsLmFwcGVuZCgiPC9zcGFuPiIpfSx0aGlzKX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCI6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwhMSksdC5lYWNoKHRoaXMubW9kZWwuZ2V0KHRoaXMub3B0aW9ucy5uYW1lKSxmdW5jdGlvbihlKXt0aGlzLiQoImlucHV0IyIrYSh0LmV4dGVuZCh0aGlzLGUpKSkucHJvcCgiY2hlY2tlZCIsZS5lbmFibGVkKX0sdGhpcyksdGhpcy5nZXRNb2RlbFZhbHVlKCksdGhpc30sdmFsOmZ1bmN0aW9uKCl7dmFyIGU9W107cmV0dXJuIHQuZWFjaCh0aGlzLmFsbE9wdGlvbnMsZnVuY3Rpb24oaSl7aS5lbmFibGVkPXRoaXMuJCgiOmlucHV0IyIrYSh0LmV4dGVuZCh0aGlzLGkpKSkucHJvcCgiY2hlY2tlZCIpLGUucHVzaChpKX0sdGhpcyksZX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy52YWwoKTt0aGlzLm1vZGVsLnNldCh0aGlzLm9wdGlvbnMubmFtZSxKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHQpKSl9LGZvY3VzOmZ1bmN0aW9uKCl7fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQ3KSxpKDIwMyksaSgxNzMpLGkoMzYpLGkoMiksaSgxMzkpLGkoMjA0KV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBzPSJpbnB1dC1maXggby1mb3JtLWNvbnRyb2wgZGF0ZS10aW1lIixvPW5ldyBSZWdFeHAoIigwWzAtOV18MVswLTldfDJbMC0zXSk6WzAtNV1bMC05XTpbMC01XVswLTldIiksYT01MDAsbD04O3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6dC50cGwoJ1x0ICAgICAgPHNwYW4gY2xhc3M9Imljb24gaWNvbi0xNiBpY29uLW9ubHkgY2FsZW5kYXItMTYiLz5cdCAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBhdXRvY29tcGxldGU9Im9mZiJcdCAgICAgICAgbmFtZT0iZGF0ZSIgY2xhc3M9ImRhdGUtaW5wdXQiIGlkPSJ7e2lucHV0SWR9fV9kYXRlIiB2YWx1ZT0ie3tkYXRlVmFsdWV9fSIvPlx0ICAgICAgPHNwYW4gY2xhc3M9Imljb24gaWNvbi0xNiBpY29uLW9ubHkgdGltZS1hbHQtMTYiLz5cdCAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBtYXhsZW5ndGg9IjgiIG1pbmxlbmd0aD0iOCIgYXV0b2NvbXBsZXRlPSJvZmYiXHQgICAgICAgIG5hbWU9InRpbWUiIGNsYXNzPSJ0aW1lLWlucHV0IiBpZD0ie3tpbnB1dElkfX1fdGltZSIgdmFsdWU9Int7dGltZVZhbHVlfX0iLz5cdCAgICAnKSxldmVudHM6eyJpbnB1dCBpbnB1dCI6IndhaXRBbmRVcGRhdGUiLCJjaGFuZ2UgaW5wdXQiOiJ3YWl0QW5kVXBkYXRlIiwia2V5ZG93biBpbnB1dCI6IndhaXRBbmRVcGRhdGUiLCJrZXl1cCBpbnB1dCI6ZnVuY3Rpb24odCl7aS5pc0VudGVyKHQpP3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpzYXZlIik6aS5pc0VzYyh0KSYmdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOmNhbmNlbCIpfX0sd2FpdEFuZFVwZGF0ZTpyLmRlYm91bmNlKGZ1bmN0aW9uKHQpe2lmKCJ0aW1lLWlucHV0Ij09PXQuY3VycmVudFRhcmdldC5jbGFzc05hbWUpe2lmKHQuY3VycmVudFRhcmdldC52YWx1ZS5sZW5ndGg8bClyZXR1cm47by50ZXN0KHQuY3VycmVudFRhcmdldC52YWx1ZSl8fCh0LmN1cnJlbnRUYXJnZXQudmFsdWU9IjAwOjAwOjAwIil9dGhpcy51cGRhdGUoKX0sYSksZWRpdE1vZGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5hZGRDbGFzcyhzKTt2YXIgdD1uLnV0Yyh0aGlzLmdldE1vZGVsVmFsdWUoKSk7dGhpcy5vcHRpb25zLmRhdGVWYWx1ZT10LmZvcm1hdCgiTU0vREQvWVlZWSIpLHRoaXMub3B0aW9ucy50aW1lVmFsdWU9dC5mb3JtYXQoIkhIOm1tOnNzIiksZS5wcm90b3R5cGUuZWRpdE1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJCgiLmRhdGUtaW5wdXQiKS5wbGFjZWhvbGRlcigpLHRoaXMuJCgiLmRhdGUtaW5wdXQiKS5kYXRlcGlja2VyKHRoaXMub3B0aW9ucy5wYXJhbXMpfSxyZWFkTW9kZTpmdW5jdGlvbigpe2UucHJvdG90eXBlLnJlYWRNb2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiRlbC5yZW1vdmVDbGFzcyhzKX0sdmFsOmZ1bmN0aW9uKCl7cmV0dXJue2RhdGU6dGhpcy4kKCdpbnB1dFt0eXBlPSJ0ZXh0Il0uZGF0ZS1pbnB1dCcpLnZhbCgpLHRpbWU6dGhpcy4kKCdpbnB1dFt0eXBlPSJ0ZXh0Il0udGltZS1pbnB1dCcpLnZhbCgpfX0sZm9jdXM6ZnVuY3Rpb24oKXt9LHRvOmZ1bmN0aW9uKHQpe3JldHVybiBuLnV0Yyh0LmRhdGUrdC50aW1lLCJNTS9ERC9ZWVlZSEg6bW06c3MiKS5mb3JtYXQoKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDI3OSksaSgxNzcpLGkoMjgwKV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBzPWUudHBsKCdcdCAgICA8ZGl2IGNsYXNzPSJjbGVhcmZpeCI+XHQgICAgICA8c3BhbiBjbGFzcz0ibGluay1idXR0b24gbGluay1idXR0b24tc21hbGwiPlx0ICAgICAgICB7e2kxOG4gY29kZT0ib2Zvcm0uZ3JvdXBzZWxlY3QuYWRkIiBidW5kbGU9Im1lc3NhZ2VzIn19XHQgICAgICA8L3NwYW4+XHQgICAgICA8ZGl2IGNsYXNzPSJncm91cC1tZWRpdW0tYXBwLWxvZ28td3JhcHBlciI+PGltZyBjbGFzcz0iYXBwLWxvZ28iIHNyYz0ie3ttZWRpdW1JY29uVXJsfX0iLz48L2Rpdj5cdCAgICAgIDxkaXYgY2xhc3M9Imdyb3VwLWRlc2MiPlx0ICAgICAgICA8aDMgY2xhc3M9Imdyb3VwLWRlc2MtaGVhZGVyIj57e3toaWdobGlnaHRlZE5hbWV9fX08L2gzPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iZ3JvdXAtZGVzYy1pbmZvIj57eyNpZiBhcHBHcm91cH19e3thcHBHcm91cH19ICYjMTgzOyB7ey9pZn19XHQgICAgICAgIHt7I2lmIGRlc2NyaXB0aW9ufX1cdCAgICAgICAgICB7e2Rlc2NyaXB0aW9ufX1cdCAgICAgICAge3tlbHNlfX1cdCAgICAgICAgICB7e2kxOG4gY29kZT0ib2Zvcm0uZ3JvdXBzZWxlY3Qubm9fZGVzY3JpcHRpb24iIGJ1bmRsZT0ibWVzc2FnZXMifX1cdCAgICAgICAge3svaWZ9fTwvc3Bhbj5cdCAgICAgICAgPHVsIGNsYXNzPSJncm91cC1kZXNjLXN0YXRzIj5cdCAgICAgICAgICA8bGkgY2xhc3M9Imljb24tMTYiPjxzcGFuIGNsYXNzPSJpY29uIHBlcnNvbi0xNi1ncmF5Ij48L3NwYW4+e3t1c2Vyc0NvdW50fX08L2xpPlx0ICAgICAgICAgIDxsaSBjbGFzcz0iaWNvbi0xNiI+PHNwYW4gY2xhc3M9Imljb24gYXBwLTE2LWdyYXkiPjwvc3Bhbj57e2FwcHNDb3VudH19PC9saT5cdCAgICAgICAgICB7eyNpZiBncm91cFB1c2hNYXBwaW5nc0NvdW50fX1cdCAgICAgICAgICAgIDxsaSBjbGFzcz0iaWNvbi0xNiI+XHQgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIGluYWN0aXZlLXN5bmMtMTYiPjwvc3Bhbj57e2dyb3VwUHVzaE1hcHBpbmdzQ291bnR9fSBhcHBzXHQgICAgICAgICAgICA8L2xpPlx0ICAgICAgICAgIHt7L2lmfX1cdCAgICAgICAgPC91bD5cdCAgICAgIDwvZGl2Plx0ICAgIDwvZGl2Plx0ICAnKSxvPWUudHBsKCdcdCAgICA8ZGl2Plx0ICAgICAgPHNwYW4gY2xhc3M9Imdyb3VwLXNtYWxsLWFwcC1sb2dvLXdyYXBwZXIiPlx0ICAgICAgICA8aW1nIGNsYXNzPSJsb2dvIiBzcmM9Int7c21hbGxJY29uVXJsfX0iLz5cdCAgICAgIDwvc3Bhbj5cdCAgICAgIDxzcGFuIGNsYXNzPSJzZWxlY3QyLWNob3Nlbi10ZXh0Ij57e25hbWV9fTwvc3Bhbj5cdCAgICA8L2Rpdj5cdCAgJyksYT1lLnRwbCgnXHQgICAgICB7eyNpZiBzbWFsbEljb25Vcmx9fVx0ICAgICAgPHNwYW4gY2xhc3M9Imdyb3VwLXNtYWxsLWFwcC1sb2dvLXdyYXBwZXIiPlx0ICAgICAgICA8aW1nIGNsYXNzPSJsb2dvIiBzcmM9Int7c21hbGxJY29uVXJsfX0iLz5cdCAgICAgIDwvc3Bhbj5cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxzcGFuIGNsYXNzPSJzZWxlY3QyLWNob3Nlbi10ZXh0Ij57e25hbWV9fTwvc3Bhbj5cdCAgJyk7cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6Imdyb3VwLXNlbGVjdC13cmFwIixhcGlVUkw6Ii9hcGkvdjEvZ3JvdXBzIixleHRyYVBhcmFtczp7ZXhwYW5kOiJzdGF0cyxhcHAiLGxpbWl0OjEwfSxwbGFjZWhvbGRlcjpuLmxvY2FsaXplKCJvZm9ybS5ncm91cHNlbGVjdC5wbGFjZWhvbGRlciIsIm1lc3NhZ2VzIiksZm9ybWF0SW5wdXRUb29TaG9ydDpuLmxvY2FsaXplKCJvZm9ybS5ncm91cHNlbGVjdC5zaG9ydF9pbnB1dCIsIm1lc3NhZ2VzIiksdG9TdHJpbmdWYWx1ZTpmdW5jdGlvbigpe3JldHVybiBhKHRoaXMuX2VudGl0eSl9LGZvcm1hdFNlbGVjdGlvbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5lbXB0eT90Lm5hbWU6byh0KX0sZm9ybWF0UmVzdWx0OmZ1bmN0aW9uKHQsZSxpLG4pe2lmKHQuZW1wdHkpcmV0dXJuIHRoaXMuc2VsZWN0RW1wdHlPcHRpb25UZW1wbGF0ZSgpO2lmKHQuZGlzYWJsZWQpcmV0dXJuIGUuYWRkQ2xhc3MoInNlYXJjaC1pbmZvLW1zZyIpLHRoaXMuc2VhcmNoSW5mb01zZ1RlbXBsYXRlKHQpO3ZhciBvPVtdO3JldHVybiByLnV0aWwubWFya01hdGNoKHQubmFtZSxpLnRlcm0sbyxuKSx0LmhpZ2hsaWdodGVkTmFtZT1vLmpvaW4oIiIpLHModCl9LHBhcnNlOmZ1bmN0aW9uKGUpe3ZhciBpPXQuZXh0ZW5kKHt9LGUsZS5wcm9maWxlLGUuX2VtYmVkZGVkLnN0YXRzLHtzbWFsbEljb25Vcmw6dC5maW5kV2hlcmUoZS5fbGlua3MubG9nbyx7bmFtZToibWVkaXVtIn0pLmhyZWYsbWVkaXVtSWNvblVybDp0LmZpbmRXaGVyZShlLl9saW5rcy5sb2dvLHtuYW1lOiJtZWRpdW0ifSkuaHJlZixuYW1lOmUucHJvZmlsZS5uYW1lLGFwcEdyb3VwOmUuX2VtYmVkZGVkLmFwcCYmZS5fZW1iZWRkZWQuYXBwLmxhYmVsfSk7cmV0dXJuIHQucGljayhpLCJpZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInNtYWxsSWNvblVybCIsIm1lZGl1bUljb25VcmwiLCJ1c2Vyc0NvdW50IiwiYXBwc0NvdW50IiwiZ3JvdXBQdXNoTWFwcGluZ3NDb3VudCIsImFwcEdyb3VwIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMjAzKSxpKDE0NyksaSgxNzcpLGkoMjgwKV0scj1mdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBzPXtrZXl1cDpmdW5jdGlvbih0KXt0LnN0b3BQcm9wYWdhdGlvbigpfX07cmV0dXJuIGkuZXh0ZW5kKHt0ZW1wbGF0ZTpuLnRwbCgnPGlucHV0IG5hbWU9Int7bmFtZX19IiBpZD0ie3tpbnB1dElkfX0iIHR5cGU9ImhpZGRlbiI+PC9pbnB1dD4nKSxzZWxlY3RFbXB0eU9wdGlvblRlbXBsYXRlOm4udHBsKCdcdCAgICAgIDxkaXYgY2xhc3M9ImVtcHR5LW9wdGlvbiIiPjxwPnt7aTE4biBjb2RlPSJvZm9ybS5iYXNlc2VsZWN0LnJlc2V0IiBidW5kbGU9Im1lc3NhZ2VzIn19PC9wPjwvZGl2Plx0ICAgICcpLHNlYXJjaEluZm9Nc2dUZW1wbGF0ZTpuLnRwbCgiPHA+e3tuYW1lfX08L3A+IiksZXZlbnRzOnt9LG5hbWVBdHRyaWJ1dGU6Im5hbWUiLGV4dHJhUGFyYW1zOnt9LGFwaVVSTDpudWxsLHF1ZXJ5UGFyYW06InEiLHBsYWNlaG9sZGVyOnZvaWQgMCxkcm9wZG93bkNzc0NsYXNzOnZvaWQgMCxmb3JtYXROb01hdGNoZXM6ci5sb2NhbGl6ZSgib2Zvcm0uYmFzZXNlbGVjdC5ub3Jlc3VsdHMiLCJtZXNzYWdlcyIpLGZvcm1hdFNlYXJjaGluZzpyLmxvY2FsaXplKCJvZm9ybS5iYXNlc2VsZWN0LnNlYXJjaGluZyIsIm1lc3NhZ2VzIiksZm9ybWF0QWpheEVycm9yOnIubG9jYWxpemUoIm9mb3JtLmJhc2VzZWxlY3QuYWpheF9lcnJvciIsIm1lc3NhZ2VzIiksZm9ybWF0SW5wdXRUb29TaG9ydDpyLmxvY2FsaXplKCJvZm9ybS5iYXNlc2VsZWN0LnNob3J0X2lucHV0IiwibWVzc2FnZXMiKSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihlKXtpZighdGhpcy5hcGlVUkwpdGhyb3cgbmV3IEVycm9yKCJhcGlVUkwgbm90IHByb3ZpZGVkIik7dC5kZWZhdWx0cyh0aGlzLmV2ZW50cyxzKSxpLmNhbGwodGhpcyxlKSx0aGlzLmV4dHJhUGFyYW1zLmZpbHRlcj10aGlzLmdldFBhcmFtKCJmaWx0ZXIiKSx0aGlzLl9lbnRpdHk9e30sdC5iaW5kQWxsKHRoaXMsImJ1aWxkUXVlcnkiLCJwYXJzZUFsbCIsInByb2Nlc3NSZXN1bHRzIiwiaW5pdFNlbGVjdGlvbiIsInNlbGVjdEVudGl0eSIsImdldE5hbWVWYWx1ZSIsImZvcm1hdFJlc3VsdCIpfSx0b1N0cmluZ1ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VudGl0eVt0aGlzLm5hbWVBdHRyaWJ1dGVdfHx0aGlzLmRlZmF1bHRWYWx1ZSgpfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdmFsdWV9LGZvY3VzOmZ1bmN0aW9uKCl7dC5kZWZlcih0LmJpbmQoZnVuY3Rpb24oKXt0aGlzLiQoIi5zZWxlY3QyLWZvY3Vzc2VyIikuZm9jdXMoKX0sdGhpcykpfSxyZWFkTW9kZTpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCksdGhpcy5wcmVmZXRjaCh0LmJpbmQoZnVuY3Rpb24oZSl7ZS5sZW5ndGg/dGhpcy5fZW50aXR5PXRoaXMucGFyc2UodC5maXJzdChlKSk6dGhpcy5fZW50aXR5PXt9LHRoaXMuJGVsLmh0bWwodGhpcy5nZXRSZWFkTW9kZVN0cmluZygpKSx0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cmVzaXplIil9LHRoaXMpKX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5lbXB0eSgpLGkucHJvdG90eXBlLmVkaXRNb2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgdD10aGlzLl9zZWxlY3QyKCk7dC5vbigic2VsZWN0Mi1zZWxlY3RpbmciLHRoaXMuc2VsZWN0RW50aXR5KSx0aGlzLl9wcmVmaWxsKHQpfSxfc2VsZWN0MjpmdW5jdGlvbigpe3ZhciBlPXthamF4Ont1cmw6dGhpcy5hcGlVUkwsZGF0YVR5cGU6Impzb24iLHF1aWV0TWlsbGlzOjEwMCxkYXRhOnRoaXMuYnVpbGRRdWVyeSxyZXN1bHRzOnRoaXMucHJvY2Vzc1Jlc3VsdHN9LHdpZHRoOnRoaXMub3B0aW9ucy5wYXJhbXMmJnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucy5wYXJhbXMsIndpZHRoIix0aGlzKXx8dC5yZXN1bHQodGhpcywid2lkdGgiKXx8IjEwMCUiLHRleHQ6dGhpcy5nZXROYW1lVmFsdWUsZHJvcGRvd25Dc3NDbGFzczp0aGlzLm9wdGlvbnMucGFyYW1zJiZ0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMucGFyYW1zLCJkcm9wZG93bkNzc0NsYXNzIix0aGlzKXx8dC5yZXN1bHQodGhpcywiZHJvcGRvd25Dc3NDbGFzcyIpLG9wZW5PbkVudGVyOiEwLGZvcm1hdFJlc3VsdDp0aGlzLmZvcm1hdFJlc3VsdCxmb3JtYXRTZWxlY3Rpb246dGhpcy5mb3JtYXRTZWxlY3Rpb24sZm9ybWF0Tm9NYXRjaGVzOnRoaXMuZm9ybWF0Tm9NYXRjaGVzLGZvcm1hdFNlYXJjaGluZzp0aGlzLmZvcm1hdFNlYXJjaGluZyxmb3JtYXRBamF4RXJyb3I6dGhpcy5mb3JtYXRBamF4RXJyb3IsaW5pdFNlbGVjdGlvbjp0aGlzLmluaXRTZWxlY3Rpb259O3JldHVybiB0aGlzLl9lbXB0eU9wdGlvbj17aWQ6IiIsZW1wdHk6ITAsbmFtZTp0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJ8fHRoaXMucGxhY2Vob2xkZXJ9LHRoaXMuX25vUmVzdWx0c01zZz17ZGlzYWJsZWQ6ITAsbmFtZTp0aGlzLm9wdGlvbnMuZm9ybWF0Tm9NYXRjaGVzfHx0aGlzLmZvcm1hdE5vTWF0Y2hlc30sdGhpcy5fc3RhcnRUeXBpbmdNc2c9e2Rpc2FibGVkOiEwLG5hbWU6dGhpcy5vcHRpb25zLmZvcm1hdElucHV0VG9vU2hvcnR8fHRoaXMuZm9ybWF0SW5wdXRUb29TaG9ydH0sdGhpcy4kKCJpbnB1dCIpLnNlbGVjdDIoZSl9LGluaXRTZWxlY3Rpb246ZnVuY3Rpb24odCxlKXtlKHRoaXMuX2VudGl0eSYmdGhpcy5fZW50aXR5LmlkP3RoaXMuX2VudGl0eTp0aGlzLl9lbXB0eU9wdGlvbil9LGJ1aWxkUXVlcnk6ZnVuY3Rpb24oZSl7dmFyIGk9e307cmV0dXJuIGlbdGhpcy5xdWVyeVBhcmFtXT1lLHRoaXMuZXh0cmFQYXJhbXMmJiF0LmlzRW1wdHkodGhpcy5leHRyYVBhcmFtcykmJnQuZXh0ZW5kKGksdGhpcy5leHRyYVBhcmFtcyksaX0scHJvY2Vzc1Jlc3VsdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPVtdO3JldHVybiIiPT09aS50ZXJtP249W3RoaXMuX3N0YXJ0VHlwaW5nTXNnLHRoaXMuX2VtcHR5T3B0aW9uXToobj10aGlzLnBhcnNlQWxsKHQpLDA9PT1uLmxlbmd0aD9uLnB1c2godGhpcy5fbm9SZXN1bHRzTXNnLHRoaXMuX2VtcHR5T3B0aW9uKTpuLnB1c2godGhpcy5fZW1wdHlPcHRpb24pKSx7cmVzdWx0czpufX0sZm9ybWF0UmVzdWx0OmZ1bmN0aW9uKCl7fSxmb3JtYXRTZWxlY3Rpb246ZnVuY3Rpb24oKXt9LGdldE5hbWVWYWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdFt0aGlzLm5hbWVBdHRyaWJ1dGVdfSxwYXJzZUFsbDpmdW5jdGlvbihlKXtyZXR1cm4gdC5tYXAoZSx0aGlzLnBhcnNlKX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LF9wcmVmaWxsOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXM7dGhpcy5kaXNhYmxlKCksdGhpcy5wcmVmZXRjaChmdW5jdGlvbihuKXtuLmxlbmd0aCYmKGkuX2VudGl0eT1pLnBhcnNlKHQuZmlyc3QobikpKSxlLnNlbGVjdDIoInZhbCIsaS5fZW50aXR5KSxpLmVuYWJsZSgpfSx0LmJpbmQoaS5lbmFibGUsaSkpfSxwcmVmZXRjaDpmdW5jdGlvbih0LGkpe3ZhciBuPXRoaXMuZ2V0TW9kZWxWYWx1ZSgpO2lmKCFuKXJldHVybiB2b2lkIHQoW10pO3ZhciByPWUuZ2V0KHRoaXMuYXBpVVJMLHRoaXMuYnVpbGRQcmVmZXRjaFF1ZXJ5KG4pLHQpO2kmJnIuZXJyb3IoaSl9LGJ1aWxkUHJlZmV0Y2hRdWVyeTpmdW5jdGlvbihlKXtyZXR1cm4gdC5leHRlbmQoe30sdGhpcy5leHRyYVBhcmFtcyx7ZmlsdGVyOidpZCBlcSAiJytlKyciJ30pfSxzZWxlY3RFbnRpdHk6ZnVuY3Rpb24odCl7dGhpcy5fdXBkYXRlTW9kZWwodC5jaG9pY2UpfSxfdXBkYXRlTW9kZWw6ZnVuY3Rpb24odCl7dGhpcy5fZW50aXR5PXQsdGhpcy5fdmFsdWU9dC5pZCx0aGlzLnVwZGF0ZSgpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNildLHI9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGZ1bmN0aW9uKHQpeyJ1bmRlZmluZWQiPT10eXBlb2YgdC5mbi5lYWNoMiYmdC5leHRlbmQodC5mbix7ZWFjaDI6ZnVuY3Rpb24oZSl7Zm9yKHZhciBpPXQoWzBdKSxuPS0xLHI9dGhpcy5sZW5ndGg7KytuPHImJihpLmNvbnRleHQ9aVswXT10aGlzW25dKSYmZS5jYWxsKGlbMF0sbixpKSE9PSExOyk7cmV0dXJuIHRoaXN9fSl9KHQpLGZ1bmN0aW9uKHQsaSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7dmFyIGk9dChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiIikpO2UuYmVmb3JlKGkpLGkuYmVmb3JlKGUpLGkucmVtb3ZlKCl9ZnVuY3Rpb24gcih0KXtmdW5jdGlvbiBlKHQpe3JldHVybiBVW3RdfHx0fXJldHVybiB0LnJlcGxhY2UoL1teXHUwMDAwLVx1MDA3RV0vZyxlKX1mdW5jdGlvbiBzKHQsZSl7Zm9yKHZhciBpPTAsbj1lLmxlbmd0aDtpPG47aSs9MSlpZihhKHQsZVtpXSkpcmV0dXJuIGk7cmV0dXJuLTF9ZnVuY3Rpb24gbygpe3ZhciBlPXQoRik7ZS5hcHBlbmRUbygiYm9keSIpO3ZhciBpPXt3aWR0aDplLndpZHRoKCktZVswXS5jbGllbnRXaWR0aCxoZWlnaHQ6ZS5oZWlnaHQoKS1lWzBdLmNsaWVudEhlaWdodH07cmV0dXJuIGUucmVtb3ZlKCksaX1mdW5jdGlvbiBhKHQsZSl7cmV0dXJuIHQ9PT1lfHx0IT09aSYmZSE9PWkmJihudWxsIT09dCYmbnVsbCE9PWUmJih0LmNvbnN0cnVjdG9yPT09U3RyaW5nP3QrIiI9PWUrIiI6ZS5jb25zdHJ1Y3Rvcj09PVN0cmluZyYmZSsiIj09dCsiIikpfWZ1bmN0aW9uIGwoZSxpKXt2YXIgbixyLHM7aWYobnVsbD09PWV8fGUubGVuZ3RoPDEpcmV0dXJuW107Zm9yKG49ZS5zcGxpdChpKSxyPTAscz1uLmxlbmd0aDtyPHM7cis9MSluW3JdPXQudHJpbShuW3JdKTtyZXR1cm4gbn1mdW5jdGlvbiBjKHQpe3JldHVybiB0Lm91dGVyV2lkdGgoITEpLXQud2lkdGgoKX1mdW5jdGlvbiB1KGUpe3ZhciBuPSJrZXl1cC1jaGFuZ2UtdmFsdWUiO2Uub24oImtleWRvd24iLGZ1bmN0aW9uKCl7dC5kYXRhKGUsbik9PT1pJiZ0LmRhdGEoZSxuLGUudmFsKCkpfSksZS5vbigia2V5dXAiLGZ1bmN0aW9uKCl7dmFyIHI9dC5kYXRhKGUsbik7ciE9PWkmJmUudmFsKCkhPT1yJiYodC5yZW1vdmVEYXRhKGUsbiksZS50cmlnZ2VyKCJrZXl1cC1jaGFuZ2UiKSl9KX1mdW5jdGlvbiBkKGUpe2Uub24oIm1vdXNlbW92ZSIsZnVuY3Rpb24oZSl7dmFyIG49ajtuIT09aSYmbi54PT09ZS5wYWdlWCYmbi55PT09ZS5wYWdlWXx8dChlLnRhcmdldCkudHJpZ2dlcigibW91c2Vtb3ZlLWZpbHRlcmVkIixlKX0pfWZ1bmN0aW9uIGgodCxlLG4pe249bnx8aTt2YXIgcjtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgaT1hcmd1bWVudHM7d2luZG93LmNsZWFyVGltZW91dChyKSxyPXdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZS5hcHBseShuLGkpfSx0KX19ZnVuY3Rpb24gcCh0LGUpe3ZhciBpPWgodCxmdW5jdGlvbih0KXtlLnRyaWdnZXIoInNjcm9sbC1kZWJvdW5jZWQiLHQpfSk7ZS5vbigic2Nyb2xsIixmdW5jdGlvbih0KXtzKHQudGFyZ2V0LGUuZ2V0KCkpPj0wJiZpKHQpfSl9ZnVuY3Rpb24gZih0KXt0WzBdIT09ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCYmd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXt2YXIgZSxpPXRbMF0sbj10LnZhbCgpLmxlbmd0aDt0LmZvY3VzKCk7dmFyIHI9aS5vZmZzZXRXaWR0aD4wfHxpLm9mZnNldEhlaWdodD4wO3ImJmk9PT1kb2N1bWVudC5hY3RpdmVFbGVtZW50JiYoaS5zZXRTZWxlY3Rpb25SYW5nZT9pLnNldFNlbGVjdGlvblJhbmdlKG4sbik6aS5jcmVhdGVUZXh0UmFuZ2UmJihlPWkuY3JlYXRlVGV4dFJhbmdlKCksZS5jb2xsYXBzZSghMSksZS5zZWxlY3QoKSkpfSwwKX1mdW5jdGlvbiBtKGUpe2U9dChlKVswXTt2YXIgaT0wLG49MDtpZigic2VsZWN0aW9uU3RhcnQiaW4gZSlpPWUuc2VsZWN0aW9uU3RhcnQsbj1lLnNlbGVjdGlvbkVuZC1pO2Vsc2UgaWYoInNlbGVjdGlvbiJpbiBkb2N1bWVudCl7ZS5mb2N1cygpO3ZhciByPWRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO249ZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dC5sZW5ndGgsci5tb3ZlU3RhcnQoImNoYXJhY3RlciIsLWUudmFsdWUubGVuZ3RoKSxpPXIudGV4dC5sZW5ndGgtbn1yZXR1cm57b2Zmc2V0OmksbGVuZ3RoOm59fWZ1bmN0aW9uIF8odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCl9ZnVuY3Rpb24gZyh0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKX1mdW5jdGlvbiB2KGUpe2lmKCFQKXt2YXIgaT1lWzBdLmN1cnJlbnRTdHlsZXx8d2luZG93LmdldENvbXB1dGVkU3R5bGUoZVswXSxudWxsKTtQPXQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLmNzcyh7cG9zaXRpb246ImFic29sdXRlIixsZWZ0OiItMTAwMDBweCIsdG9wOiItMTAwMDBweCIsZGlzcGxheToibm9uZSIsZm9udFNpemU6aS5mb250U2l6ZSxmb250RmFtaWx5OmkuZm9udEZhbWlseSxmb250U3R5bGU6aS5mb250U3R5bGUsZm9udFdlaWdodDppLmZvbnRXZWlnaHQsbGV0dGVyU3BhY2luZzppLmxldHRlclNwYWNpbmcsdGV4dFRyYW5zZm9ybTppLnRleHRUcmFuc2Zvcm0sd2hpdGVTcGFjZToibm93cmFwIn0pLFAuYXR0cigiY2xhc3MiLCJzZWxlY3QyLXNpemVyIiksdCgiYm9keSIpLmFwcGVuZChQKX1yZXR1cm4gUC50ZXh0KGUudmFsKCkpLFAud2lkdGgoKX1mdW5jdGlvbiB5KGUsaSxuKXt2YXIgcixzLG89W107cj10LnRyaW0oZS5hdHRyKCJjbGFzcyIpKSxyJiYocj0iIityLHQoci5zcGxpdCgvXHMrLykpLmVhY2gyKGZ1bmN0aW9uKCl7MD09PXRoaXMuaW5kZXhPZigic2VsZWN0Mi0iKSYmby5wdXNoKHRoaXMpfSkpLHI9dC50cmltKGkuYXR0cigiY2xhc3MiKSksciYmKHI9IiIrcix0KHIuc3BsaXQoL1xzKy8pKS5lYWNoMihmdW5jdGlvbigpezAhPT10aGlzLmluZGV4T2YoInNlbGVjdDItIikmJihzPW4odGhpcykscyYmby5wdXNoKHMpKX0pKSxlLmF0dHIoImNsYXNzIixvLmpvaW4oIiAiKSl9ZnVuY3Rpb24gYih0LGUsaSxuKXt2YXIgcz1yKHQudG9VcHBlckNhc2UoKSkuaW5kZXhPZihyKGUudG9VcHBlckNhc2UoKSkpLG89ZS5sZW5ndGg7cmV0dXJuIHM8MD92b2lkIGkucHVzaChuKHQpKTooaS5wdXNoKG4odC5zdWJzdHJpbmcoMCxzKSkpLGkucHVzaCgiPHNwYW4gY2xhc3M9J3NlbGVjdDItbWF0Y2gnPiIpLGkucHVzaChuKHQuc3Vic3RyaW5nKHMscytvKSkpLGkucHVzaCgiPC9zcGFuPiIpLHZvaWQgaS5wdXNoKG4odC5zdWJzdHJpbmcocytvLHQubGVuZ3RoKSkpKX1mdW5jdGlvbiB3KHQpe3ZhciBlPXsiXFwiOiImIzkyOyIsIiYiOiImYW1wOyIsIjwiOiImbHQ7IiwiPiI6IiZndDsiLCciJzoiJnF1b3Q7IiwiJyI6IiYjMzk7IiwiLyI6IiYjNDc7In07cmV0dXJuIFN0cmluZyh0KS5yZXBsYWNlKC9bJjw+IidcL1xcXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfSl9ZnVuY3Rpb24gTShlKXt2YXIgbixyPW51bGwscz1lLnF1aWV0TWlsbGlzfHwxMDAsbz1lLnVybCxhPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKGwpe3dpbmRvdy5jbGVhclRpbWVvdXQobiksbj13aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBuPWUuZGF0YSxzPW8sYz1lLnRyYW5zcG9ydHx8dC5mbi5zZWxlY3QyLmFqYXhEZWZhdWx0cy50cmFuc3BvcnQsdT17dHlwZTplLnR5cGV8fCJHRVQiLGNhY2hlOmUuY2FjaGV8fCExLGpzb25wQ2FsbGJhY2s6ZS5qc29ucENhbGxiYWNrfHxpLGRhdGFUeXBlOmUuZGF0YVR5cGV8fCJqc29uIn0sZD10LmV4dGVuZCh7fSx0LmZuLnNlbGVjdDIuYWpheERlZmF1bHRzLnBhcmFtcyx1KTtuPW4/bi5jYWxsKGEsbC50ZXJtLGwucGFnZSxsLmNvbnRleHQpOm51bGwscz0iZnVuY3Rpb24iPT10eXBlb2Ygcz9zLmNhbGwoYSxsLnRlcm0sbC5wYWdlLGwuY29udGV4dCk6cyxyJiYiZnVuY3Rpb24iPT10eXBlb2Ygci5hYm9ydCYmci5hYm9ydCgpLGUucGFyYW1zJiYodC5pc0Z1bmN0aW9uKGUucGFyYW1zKT90LmV4dGVuZChkLGUucGFyYW1zLmNhbGwoYSkpOnQuZXh0ZW5kKGQsZS5wYXJhbXMpKSx0LmV4dGVuZChkLHt1cmw6cyxkYXRhVHlwZTplLmRhdGFUeXBlLGRhdGE6bixzdWNjZXNzOmZ1bmN0aW9uKHQpe3ZhciBpPWUucmVzdWx0cyh0LGwucGFnZSxsKTtsLmNhbGxiYWNrKGkpfSxlcnJvcjpmdW5jdGlvbih0LGUsaSl7dmFyIG49e2hhc0Vycm9yOiEwLGpxWEhSOnQsdGV4dFN0YXR1czplLGVycm9yVGhyb3duOml9O2wuY2FsbGJhY2sobil9fSkscj1jLmNhbGwoYSxkKX0scyl9fWZ1bmN0aW9uIGsoZSl7dmFyIGksbixyPWUscz1mdW5jdGlvbih0KXtyZXR1cm4iIit0LnRleHR9O3QuaXNBcnJheShyKSYmKG49cixyPXtyZXN1bHRzOm59KSx0LmlzRnVuY3Rpb24ocik9PT0hMSYmKG49cixyPWZ1bmN0aW9uKCl7cmV0dXJuIG59KTt2YXIgbz1yKCk7cmV0dXJuIG8udGV4dCYmKHM9by50ZXh0LHQuaXNGdW5jdGlvbihzKXx8KGk9by50ZXh0LHM9ZnVuY3Rpb24odCl7cmV0dXJuIHRbaV19KSksZnVuY3Rpb24oZSl7dmFyIGksbj1lLnRlcm0sbz17cmVzdWx0czpbXX07cmV0dXJuIiI9PT1uP3ZvaWQgZS5jYWxsYmFjayhyKCkpOihpPWZ1bmN0aW9uKHIsbyl7dmFyIGEsbDtpZihyPXJbMF0sci5jaGlsZHJlbil7YT17fTtmb3IobCBpbiByKXIuaGFzT3duUHJvcGVydHkobCkmJihhW2xdPXJbbF0pO2EuY2hpbGRyZW49W10sdChyLmNoaWxkcmVuKS5lYWNoMihmdW5jdGlvbih0LGUpe2koZSxhLmNoaWxkcmVuKX0pLChhLmNoaWxkcmVuLmxlbmd0aHx8ZS5tYXRjaGVyKG4scyhhKSxyKSkmJm8ucHVzaChhKX1lbHNlIGUubWF0Y2hlcihuLHMocikscikmJm8ucHVzaChyKX0sdChyKCkucmVzdWx0cykuZWFjaDIoZnVuY3Rpb24odCxlKXtpKGUsby5yZXN1bHRzKX0pLHZvaWQgZS5jYWxsYmFjayhvKSl9fWZ1bmN0aW9uIFQoZSl7dmFyIG49dC5pc0Z1bmN0aW9uKGUpO3JldHVybiBmdW5jdGlvbihyKXt2YXIgcz1yLnRlcm0sbz17cmVzdWx0czpbXX0sYT1uP2Uocik6ZTt0LmlzQXJyYXkoYSkmJih0KGEpLmVhY2goZnVuY3Rpb24oKXt2YXIgdD10aGlzLnRleHQhPT1pLGU9dD90aGlzLnRleHQ6dGhpczsoIiI9PT1zfHxyLm1hdGNoZXIocyxlKSkmJm8ucmVzdWx0cy5wdXNoKHQ/dGhpczp7aWQ6dGhpcyx0ZXh0OnRoaXN9KX0pLHIuY2FsbGJhY2sobykpfX1mdW5jdGlvbiBTKGUsaSl7aWYodC5pc0Z1bmN0aW9uKGUpKXJldHVybiEwO2lmKCFlKXJldHVybiExO2lmKCJzdHJpbmciPT10eXBlb2YgZSlyZXR1cm4hMDt0aHJvdyBuZXcgRXJyb3IoaSsiIG11c3QgYmUgYSBzdHJpbmcsIGZ1bmN0aW9uLCBvciBmYWxzeSB2YWx1ZSIpfWZ1bmN0aW9uIEwoZSxpKXtpZih0LmlzRnVuY3Rpb24oZSkpe3ZhciBuPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZS5hcHBseShpLG4pfXJldHVybiBlfWZ1bmN0aW9uIHgoZSl7dmFyIGk9MDtyZXR1cm4gdC5lYWNoKGUsZnVuY3Rpb24odCxlKXtlLmNoaWxkcmVuP2krPXgoZS5jaGlsZHJlbik6aSsrfSksaX1mdW5jdGlvbiBFKHQsZSxuLHIpe3ZhciBzLG8sbCxjLHUsZD10LGg9ITE7aWYoIXIuY3JlYXRlU2VhcmNoQ2hvaWNlfHwhci50b2tlblNlcGFyYXRvcnN8fHIudG9rZW5TZXBhcmF0b3JzLmxlbmd0aDwxKXJldHVybiBpO2Zvcig7Oyl7Zm9yKG89LTEsbD0wLGM9ci50b2tlblNlcGFyYXRvcnMubGVuZ3RoO2w8YyYmKHU9ci50b2tlblNlcGFyYXRvcnNbbF0sbz10LmluZGV4T2YodSksIShvPj0wKSk7bCsrKTtpZihvPDApYnJlYWs7aWYocz10LnN1YnN0cmluZygwLG8pLHQ9dC5zdWJzdHJpbmcobyt1Lmxlbmd0aCkscy5sZW5ndGg+MCYmKHM9ci5jcmVhdGVTZWFyY2hDaG9pY2UuY2FsbCh0aGlzLHMsZSkscyE9PWkmJm51bGwhPT1zJiZyLmlkKHMpIT09aSYmbnVsbCE9PXIuaWQocykpKXtmb3IoaD0hMSxsPTAsYz1lLmxlbmd0aDtsPGM7bCsrKWlmKGEoci5pZChzKSxyLmlkKGVbbF0pKSl7aD0hMDticmVha31ofHxuKHMpfX1yZXR1cm4gZCE9PXQ/dDp2b2lkIDB9ZnVuY3Rpb24gRCgpe3ZhciBlPXRoaXM7dC5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbih0LGkpe2VbaV0ucmVtb3ZlKCksZVtpXT1udWxsfSl9ZnVuY3Rpb24gWShlLGkpe3ZhciBuPWZ1bmN0aW9uKCl7fTtyZXR1cm4gbi5wcm90b3R5cGU9bmV3IGUsbi5wcm90b3R5cGUuY29uc3RydWN0b3I9bixuLnByb3RvdHlwZS5wYXJlbnQ9ZS5wcm90b3R5cGUsbi5wcm90b3R5cGU9dC5leHRlbmQobi5wcm90b3R5cGUsaSksbn1pZihlPT09aSl7dmFyIEMsQSxPLE4sSSxQLFIsSCxqPXt4OjAseTowfSxDPXtUQUI6OSxFTlRFUjoxMyxFU0M6MjcsU1BBQ0U6MzIsTEVGVDozNyxVUDozOCxSSUdIVDozOSxET1dOOjQwLFNISUZUOjE2LENUUkw6MTcsQUxUOjE4LFBBR0VfVVA6MzMsUEFHRV9ET1dOOjM0LEhPTUU6MzYsRU5EOjM1LEJBQ0tTUEFDRTo4LERFTEVURTo0Nixpc0Fycm93OmZ1bmN0aW9uKHQpe3N3aXRjaCh0PXQud2hpY2g/dC53aGljaDp0KXtjYXNlIEMuTEVGVDpjYXNlIEMuUklHSFQ6Y2FzZSBDLlVQOmNhc2UgQy5ET1dOOnJldHVybiEwfXJldHVybiExfSxpc0NvbnRyb2w6ZnVuY3Rpb24odCl7dmFyIGU9dC53aGljaDtzd2l0Y2goZSl7Y2FzZSBDLlNISUZUOmNhc2UgQy5DVFJMOmNhc2UgQy5BTFQ6cmV0dXJuITB9cmV0dXJuISF0Lm1ldGFLZXl9LGlzRnVuY3Rpb25LZXk6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dC53aGljaD90LndoaWNoOnQsdD49MTEyJiZ0PD0xMjN9fSxGPSI8ZGl2IGNsYXNzPSdzZWxlY3QyLW1lYXN1cmUtc2Nyb2xsYmFyJz48L2Rpdj4iLFU9eyLikrYiOiJBIiwi77yhIjoiQSIsIsOAIjoiQSIsIsOBIjoiQSIsIsOCIjoiQSIsIuG6piI6IkEiLCLhuqQiOiJBIiwi4bqqIjoiQSIsIuG6qCI6IkEiLCLDgyI6IkEiLCLEgCI6IkEiLCLEgiI6IkEiLCLhurAiOiJBIiwi4bquIjoiQSIsIuG6tCI6IkEiLCLhurIiOiJBIiwiyKYiOiJBIiwix6AiOiJBIiwiw4QiOiJBIiwix54iOiJBIiwi4bqiIjoiQSIsIsOFIjoiQSIsIse6IjoiQSIsIseNIjoiQSIsIsiAIjoiQSIsIsiCIjoiQSIsIuG6oCI6IkEiLCLhuqwiOiJBIiwi4bq2IjoiQSIsIuG4gCI6IkEiLCLEhCI6IkEiLCLIuiI6IkEiLCLisa8iOiJBIiwi6pyyIjoiQUEiLCLDhiI6IkFFIiwix7wiOiJBRSIsIseiIjoiQUUiLCLqnLQiOiJBTyIsIuqctiI6IkFVIiwi6py4IjoiQVYiLCLqnLoiOiJBViIsIuqcvCI6IkFZIiwi4pK3IjoiQiIsIu+8oiI6IkIiLCLhuIIiOiJCIiwi4biEIjoiQiIsIuG4hiI6IkIiLCLJgyI6IkIiLCLGgiI6IkIiLCLGgSI6IkIiLCLikrgiOiJDIiwi77yjIjoiQyIsIsSGIjoiQyIsIsSIIjoiQyIsIsSKIjoiQyIsIsSMIjoiQyIsIsOHIjoiQyIsIuG4iCI6IkMiLCLGhyI6IkMiLCLIuyI6IkMiLCLqnL4iOiJDIiwi4pK5IjoiRCIsIu+8pCI6IkQiLCLhuIoiOiJEIiwixI4iOiJEIiwi4biMIjoiRCIsIuG4kCI6IkQiLCLhuJIiOiJEIiwi4biOIjoiRCIsIsSQIjoiRCIsIsaLIjoiRCIsIsaKIjoiRCIsIsaJIjoiRCIsIuqduSI6IkQiLCLHsSI6IkRaIiwix4QiOiJEWiIsIseyIjoiRHoiLCLHhSI6IkR6Iiwi4pK6IjoiRSIsIu+8pSI6IkUiLCLDiCI6IkUiLCLDiSI6IkUiLCLDiiI6IkUiLCLhu4AiOiJFIiwi4bq+IjoiRSIsIuG7hCI6IkUiLCLhu4IiOiJFIiwi4bq8IjoiRSIsIsSSIjoiRSIsIuG4lCI6IkUiLCLhuJYiOiJFIiwixJQiOiJFIiwixJYiOiJFIiwiw4siOiJFIiwi4bq6IjoiRSIsIsSaIjoiRSIsIsiEIjoiRSIsIsiGIjoiRSIsIuG6uCI6IkUiLCLhu4YiOiJFIiwiyKgiOiJFIiwi4bicIjoiRSIsIsSYIjoiRSIsIuG4mCI6IkUiLCLhuJoiOiJFIiwixpAiOiJFIiwixo4iOiJFIiwi4pK7IjoiRiIsIu+8piI6IkYiLCLhuJ4iOiJGIiwixpEiOiJGIiwi6p27IjoiRiIsIuKSvCI6IkciLCLvvKciOiJHIiwix7QiOiJHIiwixJwiOiJHIiwi4bigIjoiRyIsIsSeIjoiRyIsIsSgIjoiRyIsIsemIjoiRyIsIsSiIjoiRyIsIsekIjoiRyIsIsaTIjoiRyIsIuqeoCI6IkciLCLqnb0iOiJHIiwi6p2+IjoiRyIsIuKSvSI6IkgiLCLvvKgiOiJIIiwixKQiOiJIIiwi4biiIjoiSCIsIuG4piI6IkgiLCLIniI6IkgiLCLhuKQiOiJIIiwi4bioIjoiSCIsIuG4qiI6IkgiLCLEpiI6IkgiLCLisaciOiJIIiwi4rG1IjoiSCIsIuqejSI6IkgiLCLikr4iOiJJIiwi77ypIjoiSSIsIsOMIjoiSSIsIsONIjoiSSIsIsOOIjoiSSIsIsSoIjoiSSIsIsSqIjoiSSIsIsSsIjoiSSIsIsSwIjoiSSIsIsOPIjoiSSIsIuG4riI6IkkiLCLhu4giOiJJIiwix48iOiJJIiwiyIgiOiJJIiwiyIoiOiJJIiwi4buKIjoiSSIsIsSuIjoiSSIsIuG4rCI6IkkiLCLGlyI6IkkiLCLikr8iOiJKIiwi77yqIjoiSiIsIsS0IjoiSiIsIsmIIjoiSiIsIuKTgCI6IksiLCLvvKsiOiJLIiwi4biwIjoiSyIsIseoIjoiSyIsIuG4siI6IksiLCLEtiI6IksiLCLhuLQiOiJLIiwixpgiOiJLIiwi4rGpIjoiSyIsIuqdgCI6IksiLCLqnYIiOiJLIiwi6p2EIjoiSyIsIuqeoiI6IksiLCLik4EiOiJMIiwi77ysIjoiTCIsIsS/IjoiTCIsIsS5IjoiTCIsIsS9IjoiTCIsIuG4tiI6IkwiLCLhuLgiOiJMIiwixLsiOiJMIiwi4bi8IjoiTCIsIuG4uiI6IkwiLCLFgSI6IkwiLCLIvSI6IkwiLCLisaIiOiJMIiwi4rGgIjoiTCIsIuqdiCI6IkwiLCLqnYYiOiJMIiwi6p6AIjoiTCIsIseHIjoiTEoiLCLHiCI6IkxqIiwi4pOCIjoiTSIsIu+8rSI6Ik0iLCLhuL4iOiJNIiwi4bmAIjoiTSIsIuG5giI6Ik0iLCLisa4iOiJNIiwixpwiOiJNIiwi4pODIjoiTiIsIu+8riI6Ik4iLCLHuCI6Ik4iLCLFgyI6Ik4iLCLDkSI6Ik4iLCLhuYQiOiJOIiwixYciOiJOIiwi4bmGIjoiTiIsIsWFIjoiTiIsIuG5iiI6Ik4iLCLhuYgiOiJOIiwiyKAiOiJOIiwixp0iOiJOIiwi6p6QIjoiTiIsIuqepCI6Ik4iLCLHiiI6Ik5KIiwix4siOiJOaiIsIuKThCI6Ik8iLCLvvK8iOiJPIiwiw5IiOiJPIiwiw5MiOiJPIiwiw5QiOiJPIiwi4buSIjoiTyIsIuG7kCI6Ik8iLCLhu5YiOiJPIiwi4buUIjoiTyIsIsOVIjoiTyIsIuG5jCI6Ik8iLCLIrCI6Ik8iLCLhuY4iOiJPIiwixYwiOiJPIiwi4bmQIjoiTyIsIuG5kiI6Ik8iLCLFjiI6Ik8iLCLIriI6Ik8iLCLIsCI6Ik8iLCLDliI6Ik8iLCLIqiI6Ik8iLCLhu44iOiJPIiwixZAiOiJPIiwix5EiOiJPIiwiyIwiOiJPIiwiyI4iOiJPIiwixqAiOiJPIiwi4bucIjoiTyIsIuG7miI6Ik8iLCLhu6AiOiJPIiwi4bueIjoiTyIsIuG7oiI6Ik8iLCLhu4wiOiJPIiwi4buYIjoiTyIsIseqIjoiTyIsIsesIjoiTyIsIsOYIjoiTyIsIse+IjoiTyIsIsaGIjoiTyIsIsafIjoiTyIsIuqdiiI6Ik8iLCLqnYwiOiJPIiwixqIiOiJPSSIsIuqdjiI6Ik9PIiwiyKIiOiJPVSIsIuKThSI6IlAiLCLvvLAiOiJQIiwi4bmUIjoiUCIsIuG5liI6IlAiLCLGpCI6IlAiLCLisaMiOiJQIiwi6p2QIjoiUCIsIuqdkiI6IlAiLCLqnZQiOiJQIiwi4pOGIjoiUSIsIu+8sSI6IlEiLCLqnZYiOiJRIiwi6p2YIjoiUSIsIsmKIjoiUSIsIuKThyI6IlIiLCLvvLIiOiJSIiwixZQiOiJSIiwi4bmYIjoiUiIsIsWYIjoiUiIsIsiQIjoiUiIsIsiSIjoiUiIsIuG5miI6IlIiLCLhuZwiOiJSIiwixZYiOiJSIiwi4bmeIjoiUiIsIsmMIjoiUiIsIuKxpCI6IlIiLCLqnZoiOiJSIiwi6p6mIjoiUiIsIuqegiI6IlIiLCLik4giOiJTIiwi77yzIjoiUyIsIuG6niI6IlMiLCLFmiI6IlMiLCLhuaQiOiJTIiwixZwiOiJTIiwi4bmgIjoiUyIsIsWgIjoiUyIsIuG5piI6IlMiLCLhuaIiOiJTIiwi4bmoIjoiUyIsIsiYIjoiUyIsIsWeIjoiUyIsIuKxviI6IlMiLCLqnqgiOiJTIiwi6p6EIjoiUyIsIuKTiSI6IlQiLCLvvLQiOiJUIiwi4bmqIjoiVCIsIsWkIjoiVCIsIuG5rCI6IlQiLCLImiI6IlQiLCLFoiI6IlQiLCLhubAiOiJUIiwi4bmuIjoiVCIsIsWmIjoiVCIsIsasIjoiVCIsIsauIjoiVCIsIsi+IjoiVCIsIuqehiI6IlQiLCLqnKgiOiJUWiIsIuKTiiI6IlUiLCLvvLUiOiJVIiwiw5kiOiJVIiwiw5oiOiJVIiwiw5siOiJVIiwixagiOiJVIiwi4bm4IjoiVSIsIsWqIjoiVSIsIuG5uiI6IlUiLCLFrCI6IlUiLCLDnCI6IlUiLCLHmyI6IlUiLCLHlyI6IlUiLCLHlSI6IlUiLCLHmSI6IlUiLCLhu6YiOiJVIiwixa4iOiJVIiwixbAiOiJVIiwix5MiOiJVIiwiyJQiOiJVIiwiyJYiOiJVIiwixq8iOiJVIiwi4buqIjoiVSIsIuG7qCI6IlUiLCLhu64iOiJVIiwi4busIjoiVSIsIuG7sCI6IlUiLCLhu6QiOiJVIiwi4bmyIjoiVSIsIsWyIjoiVSIsIuG5tiI6IlUiLCLhubQiOiJVIiwiyYQiOiJVIiwi4pOLIjoiViIsIu+8tiI6IlYiLCLhubwiOiJWIiwi4bm+IjoiViIsIsayIjoiViIsIuqdniI6IlYiLCLJhSI6IlYiLCLqnaAiOiJWWSIsIuKTjCI6IlciLCLvvLciOiJXIiwi4bqAIjoiVyIsIuG6giI6IlciLCLFtCI6IlciLCLhuoYiOiJXIiwi4bqEIjoiVyIsIuG6iCI6IlciLCLisbIiOiJXIiwi4pONIjoiWCIsIu+8uCI6IlgiLCLhuooiOiJYIiwi4bqMIjoiWCIsIuKTjiI6IlkiLCLvvLkiOiJZIiwi4buyIjoiWSIsIsOdIjoiWSIsIsW2IjoiWSIsIuG7uCI6IlkiLCLIsiI6IlkiLCLhuo4iOiJZIiwixbgiOiJZIiwi4bu2IjoiWSIsIuG7tCI6IlkiLCLGsyI6IlkiLCLJjiI6IlkiLCLhu74iOiJZIiwi4pOPIjoiWiIsIu+8uiI6IloiLCLFuSI6IloiLCLhupAiOiJaIiwixbsiOiJaIiwixb0iOiJaIiwi4bqSIjoiWiIsIuG6lCI6IloiLCLGtSI6IloiLCLIpCI6IloiLCLisb8iOiJaIiwi4rGrIjoiWiIsIuqdoiI6IloiLCLik5AiOiJhIiwi772BIjoiYSIsIuG6miI6ImEiLCLDoCI6ImEiLCLDoSI6ImEiLCLDoiI6ImEiLCLhuqciOiJhIiwi4bqlIjoiYSIsIuG6qyI6ImEiLCLhuqkiOiJhIiwiw6MiOiJhIiwixIEiOiJhIiwixIMiOiJhIiwi4bqxIjoiYSIsIuG6ryI6ImEiLCLhurUiOiJhIiwi4bqzIjoiYSIsIsinIjoiYSIsIsehIjoiYSIsIsOkIjoiYSIsIsefIjoiYSIsIuG6oyI6ImEiLCLDpSI6ImEiLCLHuyI6ImEiLCLHjiI6ImEiLCLIgSI6ImEiLCLIgyI6ImEiLCLhuqEiOiJhIiwi4bqtIjoiYSIsIuG6tyI6ImEiLCLhuIEiOiJhIiwixIUiOiJhIiwi4rGlIjoiYSIsIsmQIjoiYSIsIuqcsyI6ImFhIiwiw6YiOiJhZSIsIse9IjoiYWUiLCLHoyI6ImFlIiwi6py1IjoiYW8iLCLqnLciOiJhdSIsIuqcuSI6ImF2Iiwi6py7IjoiYXYiLCLqnL0iOiJheSIsIuKTkSI6ImIiLCLvvYIiOiJiIiwi4biDIjoiYiIsIuG4hSI6ImIiLCLhuIciOiJiIiwixoAiOiJiIiwixoMiOiJiIiwiyZMiOiJiIiwi4pOSIjoiYyIsIu+9gyI6ImMiLCLEhyI6ImMiLCLEiSI6ImMiLCLEiyI6ImMiLCLEjSI6ImMiLCLDpyI6ImMiLCLhuIkiOiJjIiwixogiOiJjIiwiyLwiOiJjIiwi6py/IjoiYyIsIuKGhCI6ImMiLCLik5MiOiJkIiwi772EIjoiZCIsIuG4iyI6ImQiLCLEjyI6ImQiLCLhuI0iOiJkIiwi4biRIjoiZCIsIuG4kyI6ImQiLCLhuI8iOiJkIiwixJEiOiJkIiwixowiOiJkIiwiyZYiOiJkIiwiyZciOiJkIiwi6p26IjoiZCIsIsezIjoiZHoiLCLHhiI6ImR6Iiwi4pOUIjoiZSIsIu+9hSI6ImUiLCLDqCI6ImUiLCLDqSI6ImUiLCLDqiI6ImUiLCLhu4EiOiJlIiwi4bq/IjoiZSIsIuG7hSI6ImUiLCLhu4MiOiJlIiwi4bq9IjoiZSIsIsSTIjoiZSIsIuG4lSI6ImUiLCLhuJciOiJlIiwixJUiOiJlIiwixJciOiJlIiwiw6siOiJlIiwi4bq7IjoiZSIsIsSbIjoiZSIsIsiFIjoiZSIsIsiHIjoiZSIsIuG6uSI6ImUiLCLhu4ciOiJlIiwiyKkiOiJlIiwi4bidIjoiZSIsIsSZIjoiZSIsIuG4mSI6ImUiLCLhuJsiOiJlIiwiyYciOiJlIiwiyZsiOiJlIiwix50iOiJlIiwi4pOVIjoiZiIsIu+9hiI6ImYiLCLhuJ8iOiJmIiwixpIiOiJmIiwi6p28IjoiZiIsIuKTliI6ImciLCLvvYciOiJnIiwix7UiOiJnIiwixJ0iOiJnIiwi4bihIjoiZyIsIsSfIjoiZyIsIsShIjoiZyIsIsenIjoiZyIsIsSjIjoiZyIsIselIjoiZyIsIsmgIjoiZyIsIuqeoSI6ImciLCLhtbkiOiJnIiwi6p2/IjoiZyIsIuKTlyI6ImgiLCLvvYgiOiJoIiwixKUiOiJoIiwi4bijIjoiaCIsIuG4pyI6ImgiLCLInyI6ImgiLCLhuKUiOiJoIiwi4bipIjoiaCIsIuG4qyI6ImgiLCLhupYiOiJoIiwixKciOiJoIiwi4rGoIjoiaCIsIuKxtiI6ImgiLCLJpSI6ImgiLCLGlSI6Imh2Iiwi4pOYIjoiaSIsIu+9iSI6ImkiLCLDrCI6ImkiLCLDrSI6ImkiLCLDriI6ImkiLCLEqSI6ImkiLCLEqyI6ImkiLCLErSI6ImkiLCLDryI6ImkiLCLhuK8iOiJpIiwi4buJIjoiaSIsIseQIjoiaSIsIsiJIjoiaSIsIsiLIjoiaSIsIuG7iyI6ImkiLCLEryI6ImkiLCLhuK0iOiJpIiwiyagiOiJpIiwixLEiOiJpIiwi4pOZIjoiaiIsIu+9iiI6ImoiLCLEtSI6ImoiLCLHsCI6ImoiLCLJiSI6ImoiLCLik5oiOiJrIiwi772LIjoiayIsIuG4sSI6ImsiLCLHqSI6ImsiLCLhuLMiOiJrIiwixLciOiJrIiwi4bi1IjoiayIsIsaZIjoiayIsIuKxqiI6ImsiLCLqnYEiOiJrIiwi6p2DIjoiayIsIuqdhSI6ImsiLCLqnqMiOiJrIiwi4pObIjoibCIsIu+9jCI6ImwiLCLFgCI6ImwiLCLEuiI6ImwiLCLEviI6ImwiLCLhuLciOiJsIiwi4bi5IjoibCIsIsS8IjoibCIsIuG4vSI6ImwiLCLhuLsiOiJsIiwixb8iOiJsIiwixYIiOiJsIiwixpoiOiJsIiwiyasiOiJsIiwi4rGhIjoibCIsIuqdiSI6ImwiLCLqnoEiOiJsIiwi6p2HIjoibCIsIseJIjoibGoiLCLik5wiOiJtIiwi772NIjoibSIsIuG4vyI6Im0iLCLhuYEiOiJtIiwi4bmDIjoibSIsIsmxIjoibSIsIsmvIjoibSIsIuKTnSI6Im4iLCLvvY4iOiJuIiwix7kiOiJuIiwixYQiOiJuIiwiw7EiOiJuIiwi4bmFIjoibiIsIsWIIjoibiIsIuG5hyI6Im4iLCLFhiI6Im4iLCLhuYsiOiJuIiwi4bmJIjoibiIsIsaeIjoibiIsIsmyIjoibiIsIsWJIjoibiIsIuqekSI6Im4iLCLqnqUiOiJuIiwix4wiOiJuaiIsIuKTniI6Im8iLCLvvY8iOiJvIiwiw7IiOiJvIiwiw7MiOiJvIiwiw7QiOiJvIiwi4buTIjoibyIsIuG7kSI6Im8iLCLhu5ciOiJvIiwi4buVIjoibyIsIsO1IjoibyIsIuG5jSI6Im8iLCLIrSI6Im8iLCLhuY8iOiJvIiwixY0iOiJvIiwi4bmRIjoibyIsIuG5kyI6Im8iLCLFjyI6Im8iLCLIryI6Im8iLCLIsSI6Im8iLCLDtiI6Im8iLCLIqyI6Im8iLCLhu48iOiJvIiwixZEiOiJvIiwix5IiOiJvIiwiyI0iOiJvIiwiyI8iOiJvIiwixqEiOiJvIiwi4budIjoibyIsIuG7myI6Im8iLCLhu6EiOiJvIiwi4bufIjoibyIsIuG7oyI6Im8iLCLhu40iOiJvIiwi4buZIjoibyIsIserIjoibyIsIsetIjoibyIsIsO4IjoibyIsIse/IjoibyIsIsmUIjoibyIsIuqdiyI6Im8iLCLqnY0iOiJvIiwiybUiOiJvIiwixqMiOiJvaSIsIsijIjoib3UiLCLqnY8iOiJvbyIsIuKTnyI6InAiLCLvvZAiOiJwIiwi4bmVIjoicCIsIuG5lyI6InAiLCLGpSI6InAiLCLhtb0iOiJwIiwi6p2RIjoicCIsIuqdkyI6InAiLCLqnZUiOiJwIiwi4pOgIjoicSIsIu+9kSI6InEiLCLJiyI6InEiLCLqnZciOiJxIiwi6p2ZIjoicSIsIuKToSI6InIiLCLvvZIiOiJyIiwixZUiOiJyIiwi4bmZIjoiciIsIsWZIjoiciIsIsiRIjoiciIsIsiTIjoiciIsIuG5myI6InIiLCLhuZ0iOiJyIiwixZciOiJyIiwi4bmfIjoiciIsIsmNIjoiciIsIsm9IjoiciIsIuqdmyI6InIiLCLqnqciOiJyIiwi6p6DIjoiciIsIuKToiI6InMiLCLvvZMiOiJzIiwiw58iOiJzIiwixZsiOiJzIiwi4bmlIjoicyIsIsWdIjoicyIsIuG5oSI6InMiLCLFoSI6InMiLCLhuaciOiJzIiwi4bmjIjoicyIsIuG5qSI6InMiLCLImSI6InMiLCLFnyI6InMiLCLIvyI6InMiLCLqnqkiOiJzIiwi6p6FIjoicyIsIuG6myI6InMiLCLik6MiOiJ0Iiwi772UIjoidCIsIuG5qyI6InQiLCLhupciOiJ0IiwixaUiOiJ0Iiwi4bmtIjoidCIsIsibIjoidCIsIsWjIjoidCIsIuG5sSI6InQiLCLhua8iOiJ0IiwixaciOiJ0Iiwixq0iOiJ0IiwiyogiOiJ0Iiwi4rGmIjoidCIsIuqehyI6InQiLCLqnKkiOiJ0eiIsIuKTpCI6InUiLCLvvZUiOiJ1Iiwiw7kiOiJ1Iiwiw7oiOiJ1Iiwiw7siOiJ1IiwixakiOiJ1Iiwi4bm5IjoidSIsIsWrIjoidSIsIuG5uyI6InUiLCLFrSI6InUiLCLDvCI6InUiLCLHnCI6InUiLCLHmCI6InUiLCLHliI6InUiLCLHmiI6InUiLCLhu6ciOiJ1IiwKCSLFryI6InUiLCLFsSI6InUiLCLHlCI6InUiLCLIlSI6InUiLCLIlyI6InUiLCLGsCI6InUiLCLhu6siOiJ1Iiwi4bupIjoidSIsIuG7ryI6InUiLCLhu60iOiJ1Iiwi4buxIjoidSIsIuG7pSI6InUiLCLhubMiOiJ1IiwixbMiOiJ1Iiwi4bm3IjoidSIsIuG5tSI6InUiLCLKiSI6InUiLCLik6UiOiJ2Iiwi772WIjoidiIsIuG5vSI6InYiLCLhub8iOiJ2IiwiyosiOiJ2Iiwi6p2fIjoidiIsIsqMIjoidiIsIuqdoSI6InZ5Iiwi4pOmIjoidyIsIu+9lyI6InciLCLhuoEiOiJ3Iiwi4bqDIjoidyIsIsW1IjoidyIsIuG6hyI6InciLCLhuoUiOiJ3Iiwi4bqYIjoidyIsIuG6iSI6InciLCLisbMiOiJ3Iiwi4pOnIjoieCIsIu+9mCI6IngiLCLhuosiOiJ4Iiwi4bqNIjoieCIsIuKTqCI6InkiLCLvvZkiOiJ5Iiwi4buzIjoieSIsIsO9IjoieSIsIsW3IjoieSIsIuG7uSI6InkiLCLIsyI6InkiLCLhuo8iOiJ5Iiwiw78iOiJ5Iiwi4bu3IjoieSIsIuG6mSI6InkiLCLhu7UiOiJ5IiwixrQiOiJ5IiwiyY8iOiJ5Iiwi4bu/IjoieSIsIuKTqSI6InoiLCLvvZoiOiJ6IiwixboiOiJ6Iiwi4bqRIjoieiIsIsW8IjoieiIsIsW+IjoieiIsIuG6kyI6InoiLCLhupUiOiJ6IiwixrYiOiJ6IiwiyKUiOiJ6IiwiyYAiOiJ6Iiwi4rGsIjoieiIsIuqdoyI6InoiLCLOhiI6Is6RIiwizogiOiLOlSIsIs6JIjoizpciLCLOiiI6Is6ZIiwizqoiOiLOmSIsIs6MIjoizp8iLCLOjiI6Is6lIiwizqsiOiLOpSIsIs6PIjoizqkiLCLOrCI6Is6xIiwizq0iOiLOtSIsIs6uIjoizrciLCLOryI6Is65Iiwiz4oiOiLOuSIsIs6QIjoizrkiLCLPjCI6Is6/Iiwiz40iOiLPhSIsIs+LIjoiz4UiLCLOsCI6Is+FIiwiz4kiOiLPiSIsIs+CIjoiz4MifTtSPXQoZG9jdW1lbnQpLEk9ZnVuY3Rpb24oKXt2YXIgdD0xO3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0Kyt9fSgpLEE9WShPYmplY3Qse2JpbmQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztyZXR1cm4gZnVuY3Rpb24oKXt0LmFwcGx5KGUsYXJndW1lbnRzKX19LGluaXQ6ZnVuY3Rpb24oZSl7dmFyIG4scixzPSIuc2VsZWN0Mi1yZXN1bHRzIjt0aGlzLm9wdHM9ZT10aGlzLnByZXBhcmVPcHRzKGUpLHRoaXMuaWQ9ZS5pZCxlLmVsZW1lbnQuZGF0YSgic2VsZWN0MiIpIT09aSYmbnVsbCE9PWUuZWxlbWVudC5kYXRhKCJzZWxlY3QyIikmJmUuZWxlbWVudC5kYXRhKCJzZWxlY3QyIikuZGVzdHJveSgpLHRoaXMuY29udGFpbmVyPXRoaXMuY3JlYXRlQ29udGFpbmVyKCksdGhpcy5saXZlUmVnaW9uPXQoIi5zZWxlY3QyLWhpZGRlbi1hY2Nlc3NpYmxlIiksMD09dGhpcy5saXZlUmVnaW9uLmxlbmd0aCYmKHRoaXMubGl2ZVJlZ2lvbj10KCI8c3Bhbj4iLHtyb2xlOiJzdGF0dXMiLCJhcmlhLWxpdmUiOiJwb2xpdGUifSkuYWRkQ2xhc3MoInNlbGVjdDItaGlkZGVuLWFjY2Vzc2libGUiKS5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KSksdGhpcy5jb250YWluZXJJZD0iczJpZF8iKyhlLmVsZW1lbnQuYXR0cigiaWQiKXx8ImF1dG9nZW4iK0koKSksdGhpcy5jb250YWluZXJFdmVudE5hbWU9dGhpcy5jb250YWluZXJJZC5yZXBsYWNlKC8oWy5dKS9nLCJfIikucmVwbGFjZSgvKFs7JixcLVwuXCtcKlx+JzoiXCFcXiMkJUBcW1xdXChcKT0+XHxdKS9nLCJcXCQxIiksdGhpcy5jb250YWluZXIuYXR0cigiaWQiLHRoaXMuY29udGFpbmVySWQpLHRoaXMuY29udGFpbmVyLmF0dHIoInRpdGxlIixlLmVsZW1lbnQuYXR0cigidGl0bGUiKSksdGhpcy5ib2R5PXQoImJvZHkiKSx5KHRoaXMuY29udGFpbmVyLHRoaXMub3B0cy5lbGVtZW50LHRoaXMub3B0cy5hZGFwdENvbnRhaW5lckNzc0NsYXNzKSx0aGlzLmNvbnRhaW5lci5hdHRyKCJzdHlsZSIsZS5lbGVtZW50LmF0dHIoInN0eWxlIikpLHRoaXMuY29udGFpbmVyLmNzcyhMKGUuY29udGFpbmVyQ3NzLHRoaXMub3B0cy5lbGVtZW50KSksdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoTChlLmNvbnRhaW5lckNzc0NsYXNzLHRoaXMub3B0cy5lbGVtZW50KSksdGhpcy5lbGVtZW50VGFiSW5kZXg9dGhpcy5vcHRzLmVsZW1lbnQuYXR0cigidGFiaW5kZXgiKSx0aGlzLm9wdHMuZWxlbWVudC5kYXRhKCJzZWxlY3QyIix0aGlzKS5hdHRyKCJ0YWJpbmRleCIsIi0xIikuYmVmb3JlKHRoaXMuY29udGFpbmVyKS5vbigiY2xpY2suc2VsZWN0MiIsXyksdGhpcy5jb250YWluZXIuZGF0YSgic2VsZWN0MiIsdGhpcyksdGhpcy5kcm9wZG93bj10aGlzLmNvbnRhaW5lci5maW5kKCIuc2VsZWN0Mi1kcm9wIikseSh0aGlzLmRyb3Bkb3duLHRoaXMub3B0cy5lbGVtZW50LHRoaXMub3B0cy5hZGFwdERyb3Bkb3duQ3NzQ2xhc3MpLHRoaXMuZHJvcGRvd24uYWRkQ2xhc3MoTChlLmRyb3Bkb3duQ3NzQ2xhc3MsdGhpcy5vcHRzLmVsZW1lbnQpKSx0aGlzLmRyb3Bkb3duLmRhdGEoInNlbGVjdDIiLHRoaXMpLHRoaXMuZHJvcGRvd24ub24oImNsaWNrIixfKSx0aGlzLnJlc3VsdHM9bj10aGlzLmNvbnRhaW5lci5maW5kKHMpLHRoaXMuc2VhcmNoPXI9dGhpcy5jb250YWluZXIuZmluZCgiaW5wdXQuc2VsZWN0Mi1pbnB1dCIpLHRoaXMucXVlcnlDb3VudD0wLHRoaXMucmVzdWx0c1BhZ2U9MCx0aGlzLmNvbnRleHQ9bnVsbCx0aGlzLmluaXRDb250YWluZXIoKSx0aGlzLmNvbnRhaW5lci5vbigiY2xpY2siLF8pLGQodGhpcy5yZXN1bHRzKSx0aGlzLmRyb3Bkb3duLm9uKCJtb3VzZW1vdmUtZmlsdGVyZWQiLHMsdGhpcy5iaW5kKHRoaXMuaGlnaGxpZ2h0VW5kZXJFdmVudCkpLHRoaXMuZHJvcGRvd24ub24oInRvdWNoc3RhcnQgdG91Y2htb3ZlIHRvdWNoZW5kIixzLHRoaXMuYmluZChmdW5jdGlvbih0KXt0aGlzLl90b3VjaEV2ZW50PSEwLHRoaXMuaGlnaGxpZ2h0VW5kZXJFdmVudCh0KX0pKSx0aGlzLmRyb3Bkb3duLm9uKCJ0b3VjaG1vdmUiLHMsdGhpcy5iaW5kKHRoaXMudG91Y2hNb3ZlZCkpLHRoaXMuZHJvcGRvd24ub24oInRvdWNoc3RhcnQgdG91Y2hlbmQiLHMsdGhpcy5iaW5kKHRoaXMuY2xlYXJUb3VjaE1vdmVkKSksdGhpcy5kcm9wZG93bi5vbigiY2xpY2siLHRoaXMuYmluZChmdW5jdGlvbih0KXt0aGlzLl90b3VjaEV2ZW50JiYodGhpcy5fdG91Y2hFdmVudD0hMSx0aGlzLnNlbGVjdEhpZ2hsaWdodGVkKCkpfSkpLHAoODAsdGhpcy5yZXN1bHRzKSx0aGlzLmRyb3Bkb3duLm9uKCJzY3JvbGwtZGVib3VuY2VkIixzLHRoaXMuYmluZCh0aGlzLmxvYWRNb3JlSWZOZWVkZWQpKSx0KHRoaXMuY29udGFpbmVyKS5vbigiY2hhbmdlIiwiLnNlbGVjdDItaW5wdXQiLGZ1bmN0aW9uKHQpe3Quc3RvcFByb3BhZ2F0aW9uKCl9KSx0KHRoaXMuZHJvcGRvd24pLm9uKCJjaGFuZ2UiLCIuc2VsZWN0Mi1pbnB1dCIsZnVuY3Rpb24odCl7dC5zdG9wUHJvcGFnYXRpb24oKX0pLHQuZm4ubW91c2V3aGVlbCYmbi5tb3VzZXdoZWVsKGZ1bmN0aW9uKHQsZSxpLHIpe3ZhciBzPW4uc2Nyb2xsVG9wKCk7cj4wJiZzLXI8PTA/KG4uc2Nyb2xsVG9wKDApLF8odCkpOnI8MCYmbi5nZXQoMCkuc2Nyb2xsSGVpZ2h0LW4uc2Nyb2xsVG9wKCkrcjw9bi5oZWlnaHQoKSYmKG4uc2Nyb2xsVG9wKG4uZ2V0KDApLnNjcm9sbEhlaWdodC1uLmhlaWdodCgpKSxfKHQpKX0pLHUociksci5vbigia2V5dXAtY2hhbmdlIGlucHV0IHBhc3RlIix0aGlzLmJpbmQodGhpcy51cGRhdGVSZXN1bHRzKSksci5vbigiZm9jdXMiLGZ1bmN0aW9uKCl7ci5hZGRDbGFzcygic2VsZWN0Mi1mb2N1c2VkIil9KSxyLm9uKCJibHVyIixmdW5jdGlvbigpe3IucmVtb3ZlQ2xhc3MoInNlbGVjdDItZm9jdXNlZCIpfSksdGhpcy5kcm9wZG93bi5vbigibW91c2V1cCIscyx0aGlzLmJpbmQoZnVuY3Rpb24oZSl7dChlLnRhcmdldCkuY2xvc2VzdCgiLnNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiKS5sZW5ndGg+MCYmKHRoaXMuaGlnaGxpZ2h0VW5kZXJFdmVudChlKSx0aGlzLnNlbGVjdEhpZ2hsaWdodGVkKGUpKX0pKSx0aGlzLmRyb3Bkb3duLm9uKCJjbGljayBtb3VzZXVwIG1vdXNlZG93biB0b3VjaHN0YXJ0IHRvdWNoZW5kIGZvY3VzaW4iLGZ1bmN0aW9uKHQpe3Quc3RvcFByb3BhZ2F0aW9uKCl9KSx0aGlzLm5leHRTZWFyY2hUZXJtPWksdC5pc0Z1bmN0aW9uKHRoaXMub3B0cy5pbml0U2VsZWN0aW9uKSYmKHRoaXMuaW5pdFNlbGVjdGlvbigpLHRoaXMubW9uaXRvclNvdXJjZSgpKSxudWxsIT09ZS5tYXhpbXVtSW5wdXRMZW5ndGgmJnRoaXMuc2VhcmNoLmF0dHIoIm1heGxlbmd0aCIsZS5tYXhpbXVtSW5wdXRMZW5ndGgpO3ZhciBhPWUuZWxlbWVudC5wcm9wKCJkaXNhYmxlZCIpO2E9PT1pJiYoYT0hMSksdGhpcy5lbmFibGUoIWEpO3ZhciBsPWUuZWxlbWVudC5wcm9wKCJyZWFkb25seSIpO2w9PT1pJiYobD0hMSksdGhpcy5yZWFkb25seShsKSxIPUh8fG8oKSx0aGlzLmF1dG9mb2N1cz1lLmVsZW1lbnQucHJvcCgiYXV0b2ZvY3VzIiksZS5lbGVtZW50LnByb3AoImF1dG9mb2N1cyIsITEpLHRoaXMuYXV0b2ZvY3VzJiZ0aGlzLmZvY3VzKCksdGhpcy5zZWFyY2guYXR0cigicGxhY2Vob2xkZXIiLGUuc2VhcmNoSW5wdXRQbGFjZWhvbGRlcil9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdHMuZWxlbWVudCxlPXQuZGF0YSgic2VsZWN0MiIpLG49dGhpczt0aGlzLmNsb3NlKCksdC5sZW5ndGgmJnRbMF0uZGV0YWNoRXZlbnQmJm4uX3N5bmMmJnQuZWFjaChmdW5jdGlvbigpe3RoaXMuZGV0YWNoRXZlbnQoIm9ucHJvcGVydHljaGFuZ2UiLG4uX3N5bmMpfSksdGhpcy5wcm9wZXJ0eU9ic2VydmVyJiYodGhpcy5wcm9wZXJ0eU9ic2VydmVyLmRpc2Nvbm5lY3QoKSx0aGlzLnByb3BlcnR5T2JzZXJ2ZXI9bnVsbCksdGhpcy5fc3luYz1udWxsLGUhPT1pJiYoZS5jb250YWluZXIucmVtb3ZlKCksZS5saXZlUmVnaW9uLnJlbW92ZSgpLGUuZHJvcGRvd24ucmVtb3ZlKCksdC5yZW1vdmVDbGFzcygic2VsZWN0Mi1vZmZzY3JlZW4iKS5yZW1vdmVEYXRhKCJzZWxlY3QyIikub2ZmKCIuc2VsZWN0MiIpLnByb3AoImF1dG9mb2N1cyIsdGhpcy5hdXRvZm9jdXN8fCExKSx0aGlzLmVsZW1lbnRUYWJJbmRleD90LmF0dHIoe3RhYmluZGV4OnRoaXMuZWxlbWVudFRhYkluZGV4fSk6dC5yZW1vdmVBdHRyKCJ0YWJpbmRleCIpLHQuc2hvdygpKSxELmNhbGwodGhpcywiY29udGFpbmVyIiwibGl2ZVJlZ2lvbiIsImRyb3Bkb3duIiwicmVzdWx0cyIsInNlYXJjaCIpfSxvcHRpb25Ub0RhdGE6ZnVuY3Rpb24odCl7cmV0dXJuIHQuaXMoIm9wdGlvbiIpP3tpZDp0LnByb3AoInZhbHVlIiksdGV4dDp0LnRleHQoKSxlbGVtZW50OnQuZ2V0KCksY3NzOnQuYXR0cigiY2xhc3MiKSxkaXNhYmxlZDp0LnByb3AoImRpc2FibGVkIiksbG9ja2VkOmEodC5hdHRyKCJsb2NrZWQiKSwibG9ja2VkIil8fGEodC5kYXRhKCJsb2NrZWQiKSwhMCl9OnQuaXMoIm9wdGdyb3VwIik/e3RleHQ6dC5hdHRyKCJsYWJlbCIpLGNoaWxkcmVuOltdLGVsZW1lbnQ6dC5nZXQoKSxjc3M6dC5hdHRyKCJjbGFzcyIpfTp2b2lkIDB9LHByZXBhcmVPcHRzOmZ1bmN0aW9uKGUpe3ZhciBuLHIscyxvLGM9dGhpcztpZihuPWUuZWxlbWVudCwic2VsZWN0Ij09PW4uZ2V0KDApLnRhZ05hbWUudG9Mb3dlckNhc2UoKSYmKHRoaXMuc2VsZWN0PXI9ZS5lbGVtZW50KSxyJiZ0LmVhY2goWyJpZCIsIm11bHRpcGxlIiwiYWpheCIsInF1ZXJ5IiwiY3JlYXRlU2VhcmNoQ2hvaWNlIiwiaW5pdFNlbGVjdGlvbiIsImRhdGEiLCJ0YWdzIl0sZnVuY3Rpb24oKXtpZih0aGlzIGluIGUpdGhyb3cgbmV3IEVycm9yKCJPcHRpb24gJyIrdGhpcysiJyBpcyBub3QgYWxsb3dlZCBmb3IgU2VsZWN0MiB3aGVuIGF0dGFjaGVkIHRvIGEgPHNlbGVjdD4gZWxlbWVudC4iKX0pLGU9dC5leHRlbmQoe30se3BvcHVsYXRlUmVzdWx0czpmdW5jdGlvbihuLHIscyl7dmFyIG8sYT10aGlzLm9wdHMuaWQsbD10aGlzLmxpdmVSZWdpb247KG89ZnVuY3Rpb24obixyLHUpe3ZhciBkLGgscCxmLG0sXyxnLHYseSxiO249ZS5zb3J0UmVzdWx0cyhuLHIscyk7dmFyIHc9W107Zm9yKGQ9MCxoPW4ubGVuZ3RoO2Q8aDtkKz0xKXA9bltkXSxtPXAuZGlzYWJsZWQ9PT0hMCxmPSFtJiZhKHApIT09aSxfPXAuY2hpbGRyZW4mJnAuY2hpbGRyZW4ubGVuZ3RoPjAsZz10KCI8bGk+PC9saT4iKSxnLmFkZENsYXNzKCJzZWxlY3QyLXJlc3VsdHMtZGVwdC0iK3UpLGcuYWRkQ2xhc3MoInNlbGVjdDItcmVzdWx0IiksZy5hZGRDbGFzcyhmPyJzZWxlY3QyLXJlc3VsdC1zZWxlY3RhYmxlIjoic2VsZWN0Mi1yZXN1bHQtdW5zZWxlY3RhYmxlIiksbSYmZy5hZGRDbGFzcygic2VsZWN0Mi1kaXNhYmxlZCIpLF8mJmcuYWRkQ2xhc3MoInNlbGVjdDItcmVzdWx0LXdpdGgtY2hpbGRyZW4iKSxnLmFkZENsYXNzKGMub3B0cy5mb3JtYXRSZXN1bHRDc3NDbGFzcyhwKSksZy5hdHRyKCJyb2xlIiwicHJlc2VudGF0aW9uIiksdj10KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpKSx2LmFkZENsYXNzKCJzZWxlY3QyLXJlc3VsdC1sYWJlbCIpLHYuYXR0cigiaWQiLCJzZWxlY3QyLXJlc3VsdC1sYWJlbC0iK0koKSksdi5hdHRyKCJyb2xlIiwib3B0aW9uIiksYj1lLmZvcm1hdFJlc3VsdChwLHYscyxjLm9wdHMuZXNjYXBlTWFya3VwKSxiIT09aSYmKHYuaHRtbChiKSxnLmFwcGVuZCh2KSksXyYmKHk9dCgiPHVsPjwvdWw+IikseS5hZGRDbGFzcygic2VsZWN0Mi1yZXN1bHQtc3ViIiksbyhwLmNoaWxkcmVuLHksdSsxKSxnLmFwcGVuZCh5KSksZy5kYXRhKCJzZWxlY3QyLWRhdGEiLHApLHcucHVzaChnWzBdKTtyLmFwcGVuZCh3KSxsLnRleHQoZS5mb3JtYXRNYXRjaGVzKG4ubGVuZ3RoKSl9KShyLG4sMCl9fSx0LmZuLnNlbGVjdDIuZGVmYXVsdHMsZSksImZ1bmN0aW9uIiE9dHlwZW9mIGUuaWQmJihzPWUuaWQsZS5pZD1mdW5jdGlvbih0KXtyZXR1cm4gdFtzXX0pLHQuaXNBcnJheShlLmVsZW1lbnQuZGF0YSgic2VsZWN0MlRhZ3MiKSkpe2lmKCJ0YWdzImluIGUpdGhyb3cidGFncyBzcGVjaWZpZWQgYXMgYm90aCBhbiBhdHRyaWJ1dGUgJ2RhdGEtc2VsZWN0Mi10YWdzJyBhbmQgaW4gb3B0aW9ucyBvZiBTZWxlY3QyICIrZS5lbGVtZW50LmF0dHIoImlkIik7ZS50YWdzPWUuZWxlbWVudC5kYXRhKCJzZWxlY3QyVGFncyIpfWlmKHI/KGUucXVlcnk9dGhpcy5iaW5kKGZ1bmN0aW9uKHQpe3ZhciBlLHIscyxvPXtyZXN1bHRzOltdLG1vcmU6ITF9LGE9dC50ZXJtO3M9ZnVuY3Rpb24oZSxpKXt2YXIgbjtlLmlzKCJvcHRpb24iKT90Lm1hdGNoZXIoYSxlLnRleHQoKSxlKSYmaS5wdXNoKGMub3B0aW9uVG9EYXRhKGUpKTplLmlzKCJvcHRncm91cCIpJiYobj1jLm9wdGlvblRvRGF0YShlKSxlLmNoaWxkcmVuKCkuZWFjaDIoZnVuY3Rpb24odCxlKXtzKGUsbi5jaGlsZHJlbil9KSxuLmNoaWxkcmVuLmxlbmd0aD4wJiZpLnB1c2gobikpfSxlPW4uY2hpbGRyZW4oKSx0aGlzLmdldFBsYWNlaG9sZGVyKCkhPT1pJiZlLmxlbmd0aD4wJiYocj10aGlzLmdldFBsYWNlaG9sZGVyT3B0aW9uKCksciYmKGU9ZS5ub3QocikpKSxlLmVhY2gyKGZ1bmN0aW9uKHQsZSl7cyhlLG8ucmVzdWx0cyl9KSx0LmNhbGxiYWNrKG8pfSksZS5pZD1mdW5jdGlvbih0KXtyZXR1cm4gdC5pZH0pOiJxdWVyeSJpbiBlfHwoImFqYXgiaW4gZT8obz1lLmVsZW1lbnQuZGF0YSgiYWpheC11cmwiKSxvJiZvLmxlbmd0aD4wJiYoZS5hamF4LnVybD1vKSxlLnF1ZXJ5PU0uY2FsbChlLmVsZW1lbnQsZS5hamF4KSk6ImRhdGEiaW4gZT9lLnF1ZXJ5PWsoZS5kYXRhKToidGFncyJpbiBlJiYoZS5xdWVyeT1UKGUudGFncyksZS5jcmVhdGVTZWFyY2hDaG9pY2U9PT1pJiYoZS5jcmVhdGVTZWFyY2hDaG9pY2U9ZnVuY3Rpb24oZSl7cmV0dXJue2lkOnQudHJpbShlKSx0ZXh0OnQudHJpbShlKX19KSxlLmluaXRTZWxlY3Rpb249PT1pJiYoZS5pbml0U2VsZWN0aW9uPWZ1bmN0aW9uKGksbil7dmFyIHI9W107dChsKGkudmFsKCksZS5zZXBhcmF0b3IpKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGk9e2lkOnRoaXMsdGV4dDp0aGlzfSxuPWUudGFnczt0LmlzRnVuY3Rpb24obikmJihuPW4oKSksdChuKS5lYWNoKGZ1bmN0aW9uKCl7aWYoYSh0aGlzLmlkLGkuaWQpKXJldHVybiBpPXRoaXMsITF9KSxyLnB1c2goaSl9KSxuKHIpfSkpKSwiZnVuY3Rpb24iIT10eXBlb2YgZS5xdWVyeSl0aHJvdyJxdWVyeSBmdW5jdGlvbiBub3QgZGVmaW5lZCBmb3IgU2VsZWN0MiAiK2UuZWxlbWVudC5hdHRyKCJpZCIpO2lmKCJ0b3AiPT09ZS5jcmVhdGVTZWFyY2hDaG9pY2VQb3NpdGlvbillLmNyZWF0ZVNlYXJjaENob2ljZVBvc2l0aW9uPWZ1bmN0aW9uKHQsZSl7dC51bnNoaWZ0KGUpfTtlbHNlIGlmKCJib3R0b20iPT09ZS5jcmVhdGVTZWFyY2hDaG9pY2VQb3NpdGlvbillLmNyZWF0ZVNlYXJjaENob2ljZVBvc2l0aW9uPWZ1bmN0aW9uKHQsZSl7dC5wdXNoKGUpfTtlbHNlIGlmKCJmdW5jdGlvbiIhPXR5cGVvZiBlLmNyZWF0ZVNlYXJjaENob2ljZVBvc2l0aW9uKXRocm93ImludmFsaWQgY3JlYXRlU2VhcmNoQ2hvaWNlUG9zaXRpb24gb3B0aW9uIG11c3QgYmUgJ3RvcCcsICdib3R0b20nIG9yIGEgY3VzdG9tIGZ1bmN0aW9uIjtyZXR1cm4gZX0sbW9uaXRvclNvdXJjZTpmdW5jdGlvbigpe3ZhciBlLG49dGhpcy5vcHRzLmVsZW1lbnQscj10aGlzO24ub24oImNoYW5nZS5zZWxlY3QyIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7dGhpcy5vcHRzLmVsZW1lbnQuZGF0YSgic2VsZWN0Mi1jaGFuZ2UtdHJpZ2dlcmVkIikhPT0hMCYmdGhpcy5pbml0U2VsZWN0aW9uKCl9KSksdGhpcy5fc3luYz10aGlzLmJpbmQoZnVuY3Rpb24oKXt2YXIgdD1uLnByb3AoImRpc2FibGVkIik7dD09PWkmJih0PSExKSx0aGlzLmVuYWJsZSghdCk7dmFyIGU9bi5wcm9wKCJyZWFkb25seSIpO2U9PT1pJiYoZT0hMSksdGhpcy5yZWFkb25seShlKSx5KHRoaXMuY29udGFpbmVyLHRoaXMub3B0cy5lbGVtZW50LHRoaXMub3B0cy5hZGFwdENvbnRhaW5lckNzc0NsYXNzKSx0aGlzLmNvbnRhaW5lci5hZGRDbGFzcyhMKHRoaXMub3B0cy5jb250YWluZXJDc3NDbGFzcyx0aGlzLm9wdHMuZWxlbWVudCkpLHkodGhpcy5kcm9wZG93bix0aGlzLm9wdHMuZWxlbWVudCx0aGlzLm9wdHMuYWRhcHREcm9wZG93bkNzc0NsYXNzKSx0aGlzLmRyb3Bkb3duLmFkZENsYXNzKEwodGhpcy5vcHRzLmRyb3Bkb3duQ3NzQ2xhc3MsdGhpcy5vcHRzLmVsZW1lbnQpKX0pLG4ubGVuZ3RoJiZuWzBdLmF0dGFjaEV2ZW50JiZuLmVhY2goZnVuY3Rpb24oKXt0aGlzLmF0dGFjaEV2ZW50KCJvbnByb3BlcnR5Y2hhbmdlIixyLl9zeW5jKX0pLGU9d2luZG93Lk11dGF0aW9uT2JzZXJ2ZXJ8fHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyfHx3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlcixlIT09aSYmKHRoaXMucHJvcGVydHlPYnNlcnZlciYmKGRlbGV0ZSB0aGlzLnByb3BlcnR5T2JzZXJ2ZXIsdGhpcy5wcm9wZXJ0eU9ic2VydmVyPW51bGwpLHRoaXMucHJvcGVydHlPYnNlcnZlcj1uZXcgZShmdW5jdGlvbihlKXt0LmVhY2goZSxyLl9zeW5jKX0pLHRoaXMucHJvcGVydHlPYnNlcnZlci5vYnNlcnZlKG4uZ2V0KDApLHthdHRyaWJ1dGVzOiEwLHN1YnRyZWU6ITF9KSl9LHRyaWdnZXJTZWxlY3Q6ZnVuY3Rpb24oZSl7dmFyIGk9dC5FdmVudCgic2VsZWN0Mi1zZWxlY3RpbmciLHt2YWw6dGhpcy5pZChlKSxvYmplY3Q6ZSxjaG9pY2U6ZX0pO3JldHVybiB0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKGkpLCFpLmlzRGVmYXVsdFByZXZlbnRlZCgpfSx0cmlnZ2VyQ2hhbmdlOmZ1bmN0aW9uKGUpe2U9ZXx8e30sZT10LmV4dGVuZCh7fSxlLHt0eXBlOiJjaGFuZ2UiLHZhbDp0aGlzLnZhbCgpfSksdGhpcy5vcHRzLmVsZW1lbnQuZGF0YSgic2VsZWN0Mi1jaGFuZ2UtdHJpZ2dlcmVkIiwhMCksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcihlKSx0aGlzLm9wdHMuZWxlbWVudC5kYXRhKCJzZWxlY3QyLWNoYW5nZS10cmlnZ2VyZWQiLCExKSx0aGlzLm9wdHMuZWxlbWVudC5jbGljaygpLHRoaXMub3B0cy5ibHVyT25DaGFuZ2UmJnRoaXMub3B0cy5lbGVtZW50LmJsdXIoKX0saXNJbnRlcmZhY2VFbmFibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5hYmxlZEludGVyZmFjZT09PSEwfSxlbmFibGVJbnRlcmZhY2U6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9lbmFibGVkJiYhdGhpcy5fcmVhZG9ubHksZT0hdDtyZXR1cm4gdCE9PXRoaXMuZW5hYmxlZEludGVyZmFjZSYmKHRoaXMuY29udGFpbmVyLnRvZ2dsZUNsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1kaXNhYmxlZCIsZSksdGhpcy5jbG9zZSgpLHRoaXMuZW5hYmxlZEludGVyZmFjZT10LCEwKX0sZW5hYmxlOmZ1bmN0aW9uKHQpe3Q9PT1pJiYodD0hMCksdGhpcy5fZW5hYmxlZCE9PXQmJih0aGlzLl9lbmFibGVkPXQsdGhpcy5vcHRzLmVsZW1lbnQucHJvcCgiZGlzYWJsZWQiLCF0KSx0aGlzLmVuYWJsZUludGVyZmFjZSgpKX0sZGlzYWJsZTpmdW5jdGlvbigpe3RoaXMuZW5hYmxlKCExKX0scmVhZG9ubHk6ZnVuY3Rpb24odCl7dD09PWkmJih0PSExKSx0aGlzLl9yZWFkb25seSE9PXQmJih0aGlzLl9yZWFkb25seT10LHRoaXMub3B0cy5lbGVtZW50LnByb3AoInJlYWRvbmx5Iix0KSx0aGlzLmVuYWJsZUludGVyZmFjZSgpKX0sb3BlbmVkOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmNvbnRhaW5lciYmdGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItZHJvcGRvd24tb3BlbiIpfSxwb3NpdGlvbkRyb3Bkb3duOmZ1bmN0aW9uKCl7dmFyIGUsaSxuLHIscyxvPXRoaXMuZHJvcGRvd24sYT10aGlzLmNvbnRhaW5lcixsPWEub2Zmc2V0KCksYz1hLm91dGVySGVpZ2h0KCExKSx1PWEub3V0ZXJXaWR0aCghMSksZD1vLm91dGVySGVpZ2h0KCExKSxoPXQod2luZG93KSxwPWgud2lkdGgoKSxmPWguaGVpZ2h0KCksbT1oLnNjcm9sbExlZnQoKStwLF89aC5zY3JvbGxUb3AoKStmLGc9bC50b3ArYyx2PWwubGVmdCx5PWcrZDw9XyxiPWwudG9wLWQ+PWguc2Nyb2xsVG9wKCksdz1vLm91dGVyV2lkdGgoITEpLE09ZnVuY3Rpb24oKXtyZXR1cm4gdit3PD1tfSxrPWZ1bmN0aW9uKCl7cmV0dXJuIGwubGVmdCttK2Eub3V0ZXJXaWR0aCghMSk+d30sVD1vLmhhc0NsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKTtUPyhpPSEwLCFiJiZ5JiYobj0hMCxpPSExKSk6KGk9ITEsIXkmJmImJihuPSEwLGk9ITApKSxuJiYoby5oaWRlKCksbD10aGlzLmNvbnRhaW5lci5vZmZzZXQoKSxjPXRoaXMuY29udGFpbmVyLm91dGVySGVpZ2h0KCExKSx1PXRoaXMuY29udGFpbmVyLm91dGVyV2lkdGgoITEpLGQ9by5vdXRlckhlaWdodCghMSksbT1oLnNjcm9sbExlZnQoKStwLF89aC5zY3JvbGxUb3AoKStmLGc9bC50b3ArYyx2PWwubGVmdCx3PW8ub3V0ZXJXaWR0aCghMSksby5zaG93KCksdGhpcy5mb2N1c1NlYXJjaCgpKSx0aGlzLm9wdHMuZHJvcGRvd25BdXRvV2lkdGg/KHM9dCgiLnNlbGVjdDItcmVzdWx0cyIsbylbMF0sby5hZGRDbGFzcygic2VsZWN0Mi1kcm9wLWF1dG8td2lkdGgiKSxvLmNzcygid2lkdGgiLCIiKSx3PW8ub3V0ZXJXaWR0aCghMSkrKHMuc2Nyb2xsSGVpZ2h0PT09cy5jbGllbnRIZWlnaHQ/MDpILndpZHRoKSx3PnU/dT13Onc9dSxkPW8ub3V0ZXJIZWlnaHQoITEpKTp0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1kcm9wLWF1dG8td2lkdGgiKSwic3RhdGljIiE9PXRoaXMuYm9keS5jc3MoInBvc2l0aW9uIikmJihlPXRoaXMuYm9keS5vZmZzZXQoKSxnLT1lLnRvcCx2LT1lLmxlZnQpLCFNKCkmJmsoKSYmKHY9bC5sZWZ0K3RoaXMuY29udGFpbmVyLm91dGVyV2lkdGgoITEpLXcpLHI9e2xlZnQ6dix3aWR0aDp1fSxpPyhyLnRvcD1sLnRvcC1kLHIuYm90dG9tPSJhdXRvIix0aGlzLmNvbnRhaW5lci5hZGRDbGFzcygic2VsZWN0Mi1kcm9wLWFib3ZlIiksby5hZGRDbGFzcygic2VsZWN0Mi1kcm9wLWFib3ZlIikpOihyLnRvcD1nLHIuYm90dG9tPSJhdXRvIix0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1kcm9wLWFib3ZlIiksby5yZW1vdmVDbGFzcygic2VsZWN0Mi1kcm9wLWFib3ZlIikpLHI9dC5leHRlbmQocixMKHRoaXMub3B0cy5kcm9wZG93bkNzcyx0aGlzLm9wdHMuZWxlbWVudCkpLG8uY3NzKHIpfSxzaG91bGRPcGVuOmZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIXRoaXMub3BlbmVkKCkmJih0aGlzLl9lbmFibGVkIT09ITEmJnRoaXMuX3JlYWRvbmx5IT09ITAmJihlPXQuRXZlbnQoInNlbGVjdDItb3BlbmluZyIpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIoZSksIWUuaXNEZWZhdWx0UHJldmVudGVkKCkpKX0sY2xlYXJEcm9wZG93bkFsaWdubWVudFByZWZlcmVuY2U6ZnVuY3Rpb24oKXt0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1kcm9wLWFib3ZlIiksdGhpcy5kcm9wZG93bi5yZW1vdmVDbGFzcygic2VsZWN0Mi1kcm9wLWFib3ZlIil9LG9wZW46ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuc2hvdWxkT3BlbigpJiYodGhpcy5vcGVuaW5nKCksUi5vbigibW91c2Vtb3ZlLnNlbGVjdDJFdmVudCIsZnVuY3Rpb24odCl7ai54PXQucGFnZVgsai55PXQucGFnZVl9KSwhMCl9LG9wZW5pbmc6ZnVuY3Rpb24oKXt2YXIgZSxpPXRoaXMuY29udGFpbmVyRXZlbnROYW1lLHI9InNjcm9sbC4iK2kscz0icmVzaXplLiIraSxvPSJvcmllbnRhdGlvbmNoYW5nZS4iK2k7dGhpcy5jb250YWluZXIuYWRkQ2xhc3MoInNlbGVjdDItZHJvcGRvd24tb3BlbiIpLmFkZENsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLmNsZWFyRHJvcGRvd25BbGlnbm1lbnRQcmVmZXJlbmNlKCksdGhpcy5kcm9wZG93blswXSE9PXRoaXMuYm9keS5jaGlsZHJlbigpLmxhc3QoKVswXSYmdGhpcy5kcm9wZG93bi5kZXRhY2goKS5hcHBlbmRUbyh0aGlzLmJvZHkpLGU9dCgiI3NlbGVjdDItZHJvcC1tYXNrIiksMD09ZS5sZW5ndGgmJihlPXQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLGUuYXR0cigiaWQiLCJzZWxlY3QyLWRyb3AtbWFzayIpLmF0dHIoImNsYXNzIiwic2VsZWN0Mi1kcm9wLW1hc2siKSxlLmhpZGUoKSxlLmFwcGVuZFRvKHRoaXMuYm9keSksZS5vbigibW91c2Vkb3duIHRvdWNoc3RhcnQgY2xpY2siLGZ1bmN0aW9uKGkpe24oZSk7dmFyIHIscz10KCIjc2VsZWN0Mi1kcm9wIik7cy5sZW5ndGg+MCYmKHI9cy5kYXRhKCJzZWxlY3QyIiksci5vcHRzLnNlbGVjdE9uQmx1ciYmci5zZWxlY3RIaWdobGlnaHRlZCh7bm9Gb2N1czohMH0pLHIuY2xvc2UoKSxpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wUHJvcGFnYXRpb24oKSl9KSksdGhpcy5kcm9wZG93bi5wcmV2KClbMF0hPT1lWzBdJiZ0aGlzLmRyb3Bkb3duLmJlZm9yZShlKSx0KCIjc2VsZWN0Mi1kcm9wIikucmVtb3ZlQXR0cigiaWQiKSx0aGlzLmRyb3Bkb3duLmF0dHIoImlkIiwic2VsZWN0Mi1kcm9wIiksZS5zaG93KCksdGhpcy5wb3NpdGlvbkRyb3Bkb3duKCksdGhpcy5kcm9wZG93bi5zaG93KCksdGhpcy5wb3NpdGlvbkRyb3Bkb3duKCksdGhpcy5kcm9wZG93bi5hZGRDbGFzcygic2VsZWN0Mi1kcm9wLWFjdGl2ZSIpO3ZhciBhPXRoaXM7dGhpcy5jb250YWluZXIucGFyZW50cygpLmFkZCh3aW5kb3cpLmVhY2goZnVuY3Rpb24oKXt0KHRoaXMpLm9uKHMrIiAiK3IrIiAiK28sZnVuY3Rpb24odCl7YS5vcGVuZWQoKSYmYS5wb3NpdGlvbkRyb3Bkb3duKCl9KX0pfSxjbG9zZTpmdW5jdGlvbigpe2lmKHRoaXMub3BlbmVkKCkpe3ZhciBlPXRoaXMuY29udGFpbmVyRXZlbnROYW1lLGk9InNjcm9sbC4iK2Usbj0icmVzaXplLiIrZSxyPSJvcmllbnRhdGlvbmNoYW5nZS4iK2U7dGhpcy5jb250YWluZXIucGFyZW50cygpLmFkZCh3aW5kb3cpLmVhY2goZnVuY3Rpb24oKXt0KHRoaXMpLm9mZihpKS5vZmYobikub2ZmKHIpfSksdGhpcy5jbGVhckRyb3Bkb3duQWxpZ25tZW50UHJlZmVyZW5jZSgpLHQoIiNzZWxlY3QyLWRyb3AtbWFzayIpLmhpZGUoKSx0aGlzLmRyb3Bkb3duLnJlbW92ZUF0dHIoImlkIiksdGhpcy5kcm9wZG93bi5oaWRlKCksdGhpcy5jb250YWluZXIucmVtb3ZlQ2xhc3MoInNlbGVjdDItZHJvcGRvd24tb3BlbiIpLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLnJlc3VsdHMuZW1wdHkoKSxSLm9mZigibW91c2Vtb3ZlLnNlbGVjdDJFdmVudCIpLHRoaXMuY2xlYXJTZWFyY2goKSx0aGlzLnNlYXJjaC5yZW1vdmVDbGFzcygic2VsZWN0Mi1hY3RpdmUiKSx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItY2xvc2UiKSl9fSxleHRlcm5hbFNlYXJjaDpmdW5jdGlvbih0KXt0aGlzLm9wZW4oKSx0aGlzLnNlYXJjaC52YWwodCksdGhpcy51cGRhdGVSZXN1bHRzKCExKX0sY2xlYXJTZWFyY2g6ZnVuY3Rpb24oKXt9LGdldE1heGltdW1TZWxlY3Rpb25TaXplOmZ1bmN0aW9uKCl7cmV0dXJuIEwodGhpcy5vcHRzLm1heGltdW1TZWxlY3Rpb25TaXplLHRoaXMub3B0cy5lbGVtZW50KX0sZW5zdXJlSGlnaGxpZ2h0VmlzaWJsZTpmdW5jdGlvbigpe3ZhciBlLGksbixyLHMsbyxhLGwsYz10aGlzLnJlc3VsdHM7aWYoaT10aGlzLmhpZ2hsaWdodCgpLCEoaTwwKSl7aWYoMD09aSlyZXR1cm4gdm9pZCBjLnNjcm9sbFRvcCgwKTtlPXRoaXMuZmluZEhpZ2hsaWdodGFibGVDaG9pY2VzKCkuZmluZCgiLnNlbGVjdDItcmVzdWx0LWxhYmVsIiksbj10KGVbaV0pLGw9KG4ub2Zmc2V0KCl8fHt9KS50b3B8fDAscj1sK24ub3V0ZXJIZWlnaHQoITApLGk9PT1lLmxlbmd0aC0xJiYoYT1jLmZpbmQoImxpLnNlbGVjdDItbW9yZS1yZXN1bHRzIiksYS5sZW5ndGg+MCYmKHI9YS5vZmZzZXQoKS50b3ArYS5vdXRlckhlaWdodCghMCkpKSxzPWMub2Zmc2V0KCkudG9wK2Mub3V0ZXJIZWlnaHQoITApLHI+cyYmYy5zY3JvbGxUb3AoYy5zY3JvbGxUb3AoKSsoci1zKSksbz1sLWMub2Zmc2V0KCkudG9wLG88MCYmIm5vbmUiIT1uLmNzcygiZGlzcGxheSIpJiZjLnNjcm9sbFRvcChjLnNjcm9sbFRvcCgpK28pfX0sZmluZEhpZ2hsaWdodGFibGVDaG9pY2VzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0cy5maW5kKCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZTpub3QoLnNlbGVjdDItZGlzYWJsZWQpOm5vdCguc2VsZWN0Mi1zZWxlY3RlZCkiKX0sbW92ZUhpZ2hsaWdodDpmdW5jdGlvbihlKXtmb3IodmFyIGk9dGhpcy5maW5kSGlnaGxpZ2h0YWJsZUNob2ljZXMoKSxuPXRoaXMuaGlnaGxpZ2h0KCk7bj4tMSYmbjxpLmxlbmd0aDspe24rPWU7dmFyIHI9dChpW25dKTtpZihyLmhhc0NsYXNzKCJzZWxlY3QyLXJlc3VsdC1zZWxlY3RhYmxlIikmJiFyLmhhc0NsYXNzKCJzZWxlY3QyLWRpc2FibGVkIikmJiFyLmhhc0NsYXNzKCJzZWxlY3QyLXNlbGVjdGVkIikpe3RoaXMuaGlnaGxpZ2h0KG4pO2JyZWFrfX19LGhpZ2hsaWdodDpmdW5jdGlvbihlKXt2YXIgaSxuLHI9dGhpcy5maW5kSGlnaGxpZ2h0YWJsZUNob2ljZXMoKTtyZXR1cm4gMD09PWFyZ3VtZW50cy5sZW5ndGg/cyhyLmZpbHRlcigiLnNlbGVjdDItaGlnaGxpZ2h0ZWQiKVswXSxyLmdldCgpKTooZT49ci5sZW5ndGgmJihlPXIubGVuZ3RoLTEpLGU8MCYmKGU9MCksdGhpcy5yZW1vdmVIaWdobGlnaHQoKSxpPXQocltlXSksaS5hZGRDbGFzcygic2VsZWN0Mi1oaWdobGlnaHRlZCIpLHRoaXMuc2VhcmNoLmF0dHIoImFyaWEtYWN0aXZlZGVzY2VuZGFudCIsaS5maW5kKCIuc2VsZWN0Mi1yZXN1bHQtbGFiZWwiKS5hdHRyKCJpZCIpKSx0aGlzLmVuc3VyZUhpZ2hsaWdodFZpc2libGUoKSx0aGlzLmxpdmVSZWdpb24udGV4dChpLnRleHQoKSksbj1pLmRhdGEoInNlbGVjdDItZGF0YSIpLHZvaWQobiYmdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih7dHlwZToic2VsZWN0Mi1oaWdobGlnaHQiLHZhbDp0aGlzLmlkKG4pLGNob2ljZTpufSkpKX0scmVtb3ZlSGlnaGxpZ2h0OmZ1bmN0aW9uKCl7dGhpcy5yZXN1bHRzLmZpbmQoIi5zZWxlY3QyLWhpZ2hsaWdodGVkIikucmVtb3ZlQ2xhc3MoInNlbGVjdDItaGlnaGxpZ2h0ZWQiKX0sdG91Y2hNb3ZlZDpmdW5jdGlvbigpe3RoaXMuX3RvdWNoTW92ZWQ9ITB9LGNsZWFyVG91Y2hNb3ZlZDpmdW5jdGlvbigpe3RoaXMuX3RvdWNoTW92ZWQ9ITF9LGNvdW50U2VsZWN0YWJsZVJlc3VsdHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maW5kSGlnaGxpZ2h0YWJsZUNob2ljZXMoKS5sZW5ndGh9LGhpZ2hsaWdodFVuZGVyRXZlbnQ6ZnVuY3Rpb24oZSl7dmFyIGk9dChlLnRhcmdldCkuY2xvc2VzdCgiLnNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiKTtpZihpLmxlbmd0aD4wJiYhaS5pcygiLnNlbGVjdDItaGlnaGxpZ2h0ZWQiKSl7dmFyIG49dGhpcy5maW5kSGlnaGxpZ2h0YWJsZUNob2ljZXMoKTt0aGlzLmhpZ2hsaWdodChuLmluZGV4KGkpKX1lbHNlIDA9PWkubGVuZ3RoJiZ0aGlzLnJlbW92ZUhpZ2hsaWdodCgpfSxsb2FkTW9yZUlmTmVlZGVkOmZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLnJlc3VsdHMsaT1lLmZpbmQoImxpLnNlbGVjdDItbW9yZS1yZXN1bHRzIiksbj10aGlzLnJlc3VsdHNQYWdlKzEscj10aGlzLHM9dGhpcy5zZWFyY2gudmFsKCksbz10aGlzLmNvbnRleHQ7MCE9PWkubGVuZ3RoJiYodD1pLm9mZnNldCgpLnRvcC1lLm9mZnNldCgpLnRvcC1lLmhlaWdodCgpLHQ8PXRoaXMub3B0cy5sb2FkTW9yZVBhZGRpbmcmJihpLmFkZENsYXNzKCJzZWxlY3QyLWFjdGl2ZSIpLHRoaXMub3B0cy5xdWVyeSh7ZWxlbWVudDp0aGlzLm9wdHMuZWxlbWVudCx0ZXJtOnMscGFnZTpuLGNvbnRleHQ6byxtYXRjaGVyOnRoaXMub3B0cy5tYXRjaGVyLGNhbGxiYWNrOnRoaXMuYmluZChmdW5jdGlvbih0KXtyLm9wZW5lZCgpJiYoci5vcHRzLnBvcHVsYXRlUmVzdWx0cy5jYWxsKHRoaXMsZSx0LnJlc3VsdHMse3Rlcm06cyxwYWdlOm4sY29udGV4dDpvfSksci5wb3N0cHJvY2Vzc1Jlc3VsdHModCwhMSwhMSksdC5tb3JlPT09ITA/KGkuZGV0YWNoKCkuYXBwZW5kVG8oZSkudGV4dChMKHIub3B0cy5mb3JtYXRMb2FkTW9yZSxyLm9wdHMuZWxlbWVudCxuKzEpKSx3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe3IubG9hZE1vcmVJZk5lZWRlZCgpfSwxMCkpOmkucmVtb3ZlKCksci5wb3NpdGlvbkRyb3Bkb3duKCksci5yZXN1bHRzUGFnZT1uLHIuY29udGV4dD10LmNvbnRleHQsdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih7dHlwZToic2VsZWN0Mi1sb2FkZWQiLGl0ZW1zOnR9KSl9KX0pKSl9LHRva2VuaXplOmZ1bmN0aW9uKCl7fSx1cGRhdGVSZXN1bHRzOmZ1bmN0aW9uKGUpe2Z1bmN0aW9uIG4oKXtjLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWFjdGl2ZSIpLGgucG9zaXRpb25Ecm9wZG93bigpLHUuZmluZCgiLnNlbGVjdDItbm8tcmVzdWx0cywuc2VsZWN0Mi1zZWxlY3Rpb24tbGltaXQsLnNlbGVjdDItc2VhcmNoaW5nIikubGVuZ3RoP2gubGl2ZVJlZ2lvbi50ZXh0KHUudGV4dCgpKTpoLmxpdmVSZWdpb24udGV4dChoLm9wdHMuZm9ybWF0TWF0Y2hlcyh1LmZpbmQoIi5zZWxlY3QyLXJlc3VsdC1zZWxlY3RhYmxlIikubGVuZ3RoKSl9ZnVuY3Rpb24gcih0KXt1Lmh0bWwodCksbigpfXZhciBzLG8sbCxjPXRoaXMuc2VhcmNoLHU9dGhpcy5yZXN1bHRzLGQ9dGhpcy5vcHRzLGg9dGhpcyxwPWMudmFsKCksZj10LmRhdGEodGhpcy5jb250YWluZXIsInNlbGVjdDItbGFzdC10ZXJtIik7aWYoKGU9PT0hMHx8IWZ8fCFhKHAsZikpJiYodC5kYXRhKHRoaXMuY29udGFpbmVyLCJzZWxlY3QyLWxhc3QtdGVybSIscCksZT09PSEwfHx0aGlzLnNob3dTZWFyY2hJbnB1dCE9PSExJiZ0aGlzLm9wZW5lZCgpKSl7bD0rK3RoaXMucXVlcnlDb3VudDt2YXIgbT10aGlzLmdldE1heGltdW1TZWxlY3Rpb25TaXplKCk7aWYobT49MSYmKHM9dGhpcy5kYXRhKCksdC5pc0FycmF5KHMpJiZzLmxlbmd0aD49bSYmUyhkLmZvcm1hdFNlbGVjdGlvblRvb0JpZywiZm9ybWF0U2VsZWN0aW9uVG9vQmlnIikpKXJldHVybiB2b2lkIHIoIjxsaSBjbGFzcz0nc2VsZWN0Mi1zZWxlY3Rpb24tbGltaXQnPiIrTChkLmZvcm1hdFNlbGVjdGlvblRvb0JpZyxkLmVsZW1lbnQsbSkrIjwvbGk+Iik7aWYoYy52YWwoKS5sZW5ndGg8ZC5taW5pbXVtSW5wdXRMZW5ndGgpcmV0dXJuIHIoUyhkLmZvcm1hdElucHV0VG9vU2hvcnQsImZvcm1hdElucHV0VG9vU2hvcnQiKT8iPGxpIGNsYXNzPSdzZWxlY3QyLW5vLXJlc3VsdHMnPiIrTChkLmZvcm1hdElucHV0VG9vU2hvcnQsZC5lbGVtZW50LGMudmFsKCksZC5taW5pbXVtSW5wdXRMZW5ndGgpKyI8L2xpPiI6IiIpLHZvaWQoZSYmdGhpcy5zaG93U2VhcmNoJiZ0aGlzLnNob3dTZWFyY2goITApKTtpZihkLm1heGltdW1JbnB1dExlbmd0aCYmYy52YWwoKS5sZW5ndGg+ZC5tYXhpbXVtSW5wdXRMZW5ndGgpcmV0dXJuIHZvaWQgcihTKGQuZm9ybWF0SW5wdXRUb29Mb25nLCJmb3JtYXRJbnB1dFRvb0xvbmciKT8iPGxpIGNsYXNzPSdzZWxlY3QyLW5vLXJlc3VsdHMnPiIrTChkLmZvcm1hdElucHV0VG9vTG9uZyxkLmVsZW1lbnQsYy52YWwoKSxkLm1heGltdW1JbnB1dExlbmd0aCkrIjwvbGk+IjoiIik7ZC5mb3JtYXRTZWFyY2hpbmcmJjA9PT10aGlzLmZpbmRIaWdobGlnaHRhYmxlQ2hvaWNlcygpLmxlbmd0aCYmcigiPGxpIGNsYXNzPSdzZWxlY3QyLXNlYXJjaGluZyc+IitMKGQuZm9ybWF0U2VhcmNoaW5nLGQuZWxlbWVudCkrIjwvbGk+IiksYy5hZGRDbGFzcygic2VsZWN0Mi1hY3RpdmUiKSx0aGlzLnJlbW92ZUhpZ2hsaWdodCgpLG89dGhpcy50b2tlbml6ZSgpLG8hPWkmJm51bGwhPW8mJmMudmFsKG8pLHRoaXMucmVzdWx0c1BhZ2U9MSxkLnF1ZXJ5KHtlbGVtZW50OmQuZWxlbWVudCx0ZXJtOmMudmFsKCkscGFnZTp0aGlzLnJlc3VsdHNQYWdlLGNvbnRleHQ6bnVsbCxtYXRjaGVyOmQubWF0Y2hlcixjYWxsYmFjazp0aGlzLmJpbmQoZnVuY3Rpb24ocyl7dmFyIG87aWYobD09dGhpcy5xdWVyeUNvdW50KXtpZighdGhpcy5vcGVuZWQoKSlyZXR1cm4gdm9pZCB0aGlzLnNlYXJjaC5yZW1vdmVDbGFzcygic2VsZWN0Mi1hY3RpdmUiKTtpZihzLmhhc0Vycm9yIT09aSYmUyhkLmZvcm1hdEFqYXhFcnJvciwiZm9ybWF0QWpheEVycm9yIikpcmV0dXJuIHZvaWQgcigiPGxpIGNsYXNzPSdzZWxlY3QyLWFqYXgtZXJyb3InPiIrTChkLmZvcm1hdEFqYXhFcnJvcixkLmVsZW1lbnQscy5qcVhIUixzLnRleHRTdGF0dXMscy5lcnJvclRocm93bikrIjwvbGk+Iik7aWYodGhpcy5jb250ZXh0PXMuY29udGV4dD09PWk/bnVsbDpzLmNvbnRleHQsdGhpcy5vcHRzLmNyZWF0ZVNlYXJjaENob2ljZSYmIiIhPT1jLnZhbCgpJiYobz10aGlzLm9wdHMuY3JlYXRlU2VhcmNoQ2hvaWNlLmNhbGwoaCxjLnZhbCgpLHMucmVzdWx0cyksbyE9PWkmJm51bGwhPT1vJiZoLmlkKG8pIT09aSYmbnVsbCE9PWguaWQobykmJjA9PT10KHMucmVzdWx0cykuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIGEoaC5pZCh0aGlzKSxoLmlkKG8pKX0pLmxlbmd0aCYmdGhpcy5vcHRzLmNyZWF0ZVNlYXJjaENob2ljZVBvc2l0aW9uKHMucmVzdWx0cyxvKSksMD09PXMucmVzdWx0cy5sZW5ndGgmJlMoZC5mb3JtYXROb01hdGNoZXMsImZvcm1hdE5vTWF0Y2hlcyIpKXJldHVybiB2b2lkIHIoIjxsaSBjbGFzcz0nc2VsZWN0Mi1uby1yZXN1bHRzJz4iK0woZC5mb3JtYXROb01hdGNoZXMsZC5lbGVtZW50LGMudmFsKCkpKyI8L2xpPiIpO3UuZW1wdHkoKSxoLm9wdHMucG9wdWxhdGVSZXN1bHRzLmNhbGwodGhpcyx1LHMucmVzdWx0cyx7dGVybTpjLnZhbCgpLHBhZ2U6dGhpcy5yZXN1bHRzUGFnZSxjb250ZXh0Om51bGx9KSxzLm1vcmU9PT0hMCYmUyhkLmZvcm1hdExvYWRNb3JlLCJmb3JtYXRMb2FkTW9yZSIpJiYodS5hcHBlbmQoIjxsaSBjbGFzcz0nc2VsZWN0Mi1tb3JlLXJlc3VsdHMnPiIrZC5lc2NhcGVNYXJrdXAoTChkLmZvcm1hdExvYWRNb3JlLGQuZWxlbWVudCx0aGlzLnJlc3VsdHNQYWdlKSkrIjwvbGk+Iiksd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtoLmxvYWRNb3JlSWZOZWVkZWQoKX0sMTApKSx0aGlzLnBvc3Rwcm9jZXNzUmVzdWx0cyhzLGUpLG4oKSx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHt0eXBlOiJzZWxlY3QyLWxvYWRlZCIsaXRlbXM6c30pfX0pfSl9fSxjYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLmNsb3NlKCl9LGJsdXI6ZnVuY3Rpb24oKXt0aGlzLm9wdHMuc2VsZWN0T25CbHVyJiZ0aGlzLnNlbGVjdEhpZ2hsaWdodGVkKHtub0ZvY3VzOiEwfSksdGhpcy5jbG9zZSgpLHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLnNlYXJjaFswXT09PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQmJnRoaXMuc2VhcmNoLmJsdXIoKSx0aGlzLmNsZWFyU2VhcmNoKCksdGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZS1mb2N1cyIpLnJlbW92ZUNsYXNzKCJzZWxlY3QyLXNlYXJjaC1jaG9pY2UtZm9jdXMiKX0sZm9jdXNTZWFyY2g6ZnVuY3Rpb24oKXtmKHRoaXMuc2VhcmNoKX0sc2VsZWN0SGlnaGxpZ2h0ZWQ6ZnVuY3Rpb24odCl7aWYodGhpcy5fdG91Y2hNb3ZlZClyZXR1cm4gdm9pZCB0aGlzLmNsZWFyVG91Y2hNb3ZlZCgpO3ZhciBlPXRoaXMuaGlnaGxpZ2h0KCksaT10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItaGlnaGxpZ2h0ZWQiKSxuPWkuY2xvc2VzdCgiLnNlbGVjdDItcmVzdWx0IikuZGF0YSgic2VsZWN0Mi1kYXRhIik7bj8odGhpcy5oaWdobGlnaHQoZSksdGhpcy5vblNlbGVjdChuLHQpKTp0JiZ0Lm5vRm9jdXMmJnRoaXMuY2xvc2UoKX0sZ2V0UGxhY2Vob2xkZXI6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5vcHRzLmVsZW1lbnQuYXR0cigicGxhY2Vob2xkZXIiKXx8dGhpcy5vcHRzLmVsZW1lbnQuYXR0cigiZGF0YS1wbGFjZWhvbGRlciIpfHx0aGlzLm9wdHMuZWxlbWVudC5kYXRhKCJwbGFjZWhvbGRlciIpfHx0aGlzLm9wdHMucGxhY2Vob2xkZXJ8fCgodD10aGlzLmdldFBsYWNlaG9sZGVyT3B0aW9uKCkpIT09aT90LnRleHQoKTppKX0sZ2V0UGxhY2Vob2xkZXJPcHRpb246ZnVuY3Rpb24oKXtpZih0aGlzLnNlbGVjdCl7dmFyIGU9dGhpcy5zZWxlY3QuY2hpbGRyZW4oIm9wdGlvbiIpLmZpcnN0KCk7aWYodGhpcy5vcHRzLnBsYWNlaG9sZGVyT3B0aW9uIT09aSlyZXR1cm4iZmlyc3QiPT09dGhpcy5vcHRzLnBsYWNlaG9sZGVyT3B0aW9uJiZlfHwiZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5vcHRzLnBsYWNlaG9sZGVyT3B0aW9uJiZ0aGlzLm9wdHMucGxhY2Vob2xkZXJPcHRpb24odGhpcy5zZWxlY3QpO2lmKCIiPT09dC50cmltKGUudGV4dCgpKSYmIiI9PT1lLnZhbCgpKXJldHVybiBlfX0saW5pdENvbnRhaW5lcldpZHRoOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3ZhciBlLG4scixzLG8sYTtpZigib2ZmIj09PXRoaXMub3B0cy53aWR0aClyZXR1cm4gbnVsbDtpZigiZWxlbWVudCI9PT10aGlzLm9wdHMud2lkdGgpcmV0dXJuIDA9PT10aGlzLm9wdHMuZWxlbWVudC5vdXRlcldpZHRoKCExKT8iYXV0byI6dGhpcy5vcHRzLmVsZW1lbnQub3V0ZXJXaWR0aCghMSkrInB4IjtpZigiY29weSI9PT10aGlzLm9wdHMud2lkdGh8fCJyZXNvbHZlIj09PXRoaXMub3B0cy53aWR0aCl7aWYoZT10aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJzdHlsZSIpLGUhPT1pKWZvcihuPWUuc3BsaXQoIjsiKSxzPTAsbz1uLmxlbmd0aDtzPG87cys9MSlpZihhPW5bc10ucmVwbGFjZSgvXHMvZywiIikscj1hLm1hdGNoKC9ed2lkdGg6KChbLStdPyhbMC05XSpcLik/WzAtOV0rKShweHxlbXxleHwlfGlufGNtfG1tfHB0fHBjKSkvaSksbnVsbCE9PXImJnIubGVuZ3RoPj0xKXJldHVybiByWzFdO3JldHVybiJyZXNvbHZlIj09PXRoaXMub3B0cy53aWR0aD8oZT10aGlzLm9wdHMuZWxlbWVudC5jc3MoIndpZHRoIiksZS5pbmRleE9mKCIlIik+MD9lOjA9PT10aGlzLm9wdHMuZWxlbWVudC5vdXRlcldpZHRoKCExKT8iYXV0byI6dGhpcy5vcHRzLmVsZW1lbnQub3V0ZXJXaWR0aCghMSkrInB4Iik6bnVsbH1yZXR1cm4gdC5pc0Z1bmN0aW9uKHRoaXMub3B0cy53aWR0aCk/dGhpcy5vcHRzLndpZHRoKCk6dGhpcy5vcHRzLndpZHRofXZhciBuPWUuY2FsbCh0aGlzKTtudWxsIT09biYmdGhpcy5jb250YWluZXIuY3NzKCJ3aWR0aCIsbil9fSksTz1ZKEEse2NyZWF0ZUNvbnRhaW5lcjpmdW5jdGlvbigpe3ZhciBlPXQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLmF0dHIoeyJjbGFzcyI6InNlbGVjdDItY29udGFpbmVyIn0pLmh0bWwoWyI8YSBocmVmPSdqYXZhc2NyaXB0OnZvaWQoMCknIGNsYXNzPSdzZWxlY3QyLWNob2ljZScgdGFiaW5kZXg9Jy0xJz4iLCIgICA8c3BhbiBjbGFzcz0nc2VsZWN0Mi1jaG9zZW4nPiYjMTYwOzwvc3Bhbj48YWJiciBjbGFzcz0nc2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWNsb3NlJz48L2FiYnI+IiwiICAgPHNwYW4gY2xhc3M9J3NlbGVjdDItYXJyb3cnIHJvbGU9J3ByZXNlbnRhdGlvbic+PGIgcm9sZT0ncHJlc2VudGF0aW9uJz48L2I+PC9zcGFuPiIsIjwvYT4iLCI8bGFiZWwgZm9yPScnIGNsYXNzPSdzZWxlY3QyLW9mZnNjcmVlbic+PC9sYWJlbD4iLCI8aW5wdXQgY2xhc3M9J3NlbGVjdDItZm9jdXNzZXIgc2VsZWN0Mi1vZmZzY3JlZW4nIHR5cGU9J3RleHQnIGFyaWEtaGFzcG9wdXA9J3RydWUnIHJvbGU9J2J1dHRvbicgLz4iLCI8ZGl2IGNsYXNzPSdzZWxlY3QyLWRyb3Agc2VsZWN0Mi1kaXNwbGF5LW5vbmUnPiIsIiAgIDxkaXYgY2xhc3M9J3NlbGVjdDItc2VhcmNoJz4iLCIgICAgICAgPGxhYmVsIGZvcj0nJyBjbGFzcz0nc2VsZWN0Mi1vZmZzY3JlZW4nPjwvbGFiZWw+IiwiICAgICAgIDxpbnB1dCB0eXBlPSd0ZXh0JyBhdXRvY29tcGxldGU9J29mZicgYXV0b2NvcnJlY3Q9J29mZicgYXV0b2NhcGl0YWxpemU9J29mZicgc3BlbGxjaGVjaz0nZmFsc2UnIGNsYXNzPSdzZWxlY3QyLWlucHV0JyByb2xlPSdjb21ib2JveCcgYXJpYS1leHBhbmRlZD0ndHJ1ZSciLCIgICAgICAgYXJpYS1hdXRvY29tcGxldGU9J2xpc3QnIC8+IiwiICAgPC9kaXY+IiwiICAgPHVsIGNsYXNzPSdzZWxlY3QyLXJlc3VsdHMnIHJvbGU9J2xpc3Rib3gnPiIsIiAgIDwvdWw+IiwiPC9kaXY+Il0uam9pbigiIikpO3JldHVybiBlfSxlbmFibGVJbnRlcmZhY2U6ZnVuY3Rpb24oKXt0aGlzLnBhcmVudC5lbmFibGVJbnRlcmZhY2UuYXBwbHkodGhpcyxhcmd1bWVudHMpJiZ0aGlzLmZvY3Vzc2VyLnByb3AoImRpc2FibGVkIiwhdGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSl9LG9wZW5pbmc6ZnVuY3Rpb24oKXt2YXIgZSxuLHI7dGhpcy5vcHRzLm1pbmltdW1SZXN1bHRzRm9yU2VhcmNoPj0wJiZ0aGlzLnNob3dTZWFyY2goITApLHRoaXMucGFyZW50Lm9wZW5pbmcuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuc2hvd1NlYXJjaElucHV0IT09ITEmJnRoaXMuc2VhcmNoLnZhbCh0aGlzLmZvY3Vzc2VyLnZhbCgpKSx0aGlzLm9wdHMuc2hvdWxkRm9jdXNJbnB1dCh0aGlzKSYmKHRoaXMuc2VhcmNoLmZvY3VzKCksZT10aGlzLnNlYXJjaC5nZXQoMCksZS5jcmVhdGVUZXh0UmFuZ2U/KG49ZS5jcmVhdGVUZXh0UmFuZ2UoKSxuLmNvbGxhcHNlKCExKSxuLnNlbGVjdCgpKTplLnNldFNlbGVjdGlvblJhbmdlJiYocj10aGlzLnNlYXJjaC52YWwoKS5sZW5ndGgsZS5zZXRTZWxlY3Rpb25SYW5nZShyLHIpKSksIiI9PT10aGlzLnNlYXJjaC52YWwoKSYmdGhpcy5uZXh0U2VhcmNoVGVybSE9aSYmKHRoaXMuc2VhcmNoLnZhbCh0aGlzLm5leHRTZWFyY2hUZXJtKSx0aGlzLnNlYXJjaC5zZWxlY3QoKSksdGhpcy5mb2N1c3Nlci5wcm9wKCJkaXNhYmxlZCIsITApLnZhbCgiIiksdGhpcy51cGRhdGVSZXN1bHRzKCEwKSx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItb3BlbiIpKX0sY2xvc2U6ZnVuY3Rpb24oKXt0aGlzLm9wZW5lZCgpJiYodGhpcy5wYXJlbnQuY2xvc2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuZm9jdXNzZXIucHJvcCgiZGlzYWJsZWQiLCExKSx0aGlzLm9wdHMuc2hvdWxkRm9jdXNJbnB1dCh0aGlzKSYmdGhpcy5mb2N1c3Nlci5mb2N1cygpKX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLm9wZW5lZCgpP3RoaXMuY2xvc2UoKToodGhpcy5mb2N1c3Nlci5wcm9wKCJkaXNhYmxlZCIsITEpLHRoaXMub3B0cy5zaG91bGRGb2N1c0lucHV0KHRoaXMpJiZ0aGlzLmZvY3Vzc2VyLmZvY3VzKCkpfSxpc0ZvY3VzZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfSxjYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLnBhcmVudC5jYW5jZWwuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuZm9jdXNzZXIucHJvcCgiZGlzYWJsZWQiLCExKSx0aGlzLm9wdHMuc2hvdWxkRm9jdXNJbnB1dCh0aGlzKSYmdGhpcy5mb2N1c3Nlci5mb2N1cygpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dCgibGFiZWxbZm9yPSciK3RoaXMuZm9jdXNzZXIuYXR0cigiaWQiKSsiJ10iKS5hdHRyKCJmb3IiLHRoaXMub3B0cy5lbGVtZW50LmF0dHIoImlkIikpLHRoaXMucGFyZW50LmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpLEQuY2FsbCh0aGlzLCJzZWxlY3Rpb24iLCJmb2N1c3NlciIpfSxpbml0Q29udGFpbmVyOmZ1bmN0aW9uKCl7dmFyIGUsaSxyPXRoaXMuY29udGFpbmVyLHM9dGhpcy5kcm9wZG93bixvPUkoKTt0aGlzLm9wdHMubWluaW11bVJlc3VsdHNGb3JTZWFyY2g8MD90aGlzLnNob3dTZWFyY2goITEpOnRoaXMuc2hvd1NlYXJjaCghMCksdGhpcy5zZWxlY3Rpb249ZT1yLmZpbmQoIi5zZWxlY3QyLWNob2ljZSIpLHRoaXMuZm9jdXNzZXI9ci5maW5kKCIuc2VsZWN0Mi1mb2N1c3NlciIpLGUuZmluZCgiLnNlbGVjdDItY2hvc2VuIikuYXR0cigiaWQiLCJzZWxlY3QyLWNob3Nlbi0iK28pLHRoaXMuZm9jdXNzZXIuYXR0cigiYXJpYS1sYWJlbGxlZGJ5Iiwic2VsZWN0Mi1jaG9zZW4tIitvKSx0aGlzLnJlc3VsdHMuYXR0cigiaWQiLCJzZWxlY3QyLXJlc3VsdHMtIitvKSx0aGlzLnNlYXJjaC5hdHRyKCJhcmlhLW93bnMiLCJzZWxlY3QyLXJlc3VsdHMtIitvKSx0aGlzLmZvY3Vzc2VyLmF0dHIoImlkIiwiczJpZF9hdXRvZ2VuIitvKSxpPXQoImxhYmVsW2Zvcj0nIit0aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJpZCIpKyInXSIpLHRoaXMuZm9jdXNzZXIucHJldigpLnRleHQoaS50ZXh0KCkpLmF0dHIoImZvciIsdGhpcy5mb2N1c3Nlci5hdHRyKCJpZCIpKTt2YXIgYT10aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJ0aXRsZSIpO3RoaXMub3B0cy5lbGVtZW50LmF0dHIoInRpdGxlIixhfHxpLnRleHQoKSksdGhpcy5mb2N1c3Nlci5hdHRyKCJ0YWJpbmRleCIsdGhpcy5lbGVtZW50VGFiSW5kZXgpLHRoaXMuc2VhcmNoLmF0dHIoImlkIix0aGlzLmZvY3Vzc2VyLmF0dHIoImlkIikrIl9zZWFyY2giKSx0aGlzLnNlYXJjaC5wcmV2KCkudGV4dCh0KCJsYWJlbFtmb3I9JyIrdGhpcy5mb2N1c3Nlci5hdHRyKCJpZCIpKyInXSIpLnRleHQoKSkuYXR0cigiZm9yIix0aGlzLnNlYXJjaC5hdHRyKCJpZCIpKSx0aGlzLnNlYXJjaC5vbigia2V5ZG93biIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe2lmKHRoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkmJjIyOSE9dC5rZXlDb2RlKXtpZih0LndoaWNoPT09Qy5QQUdFX1VQfHx0LndoaWNoPT09Qy5QQUdFX0RPV04pcmV0dXJuIHZvaWQgXyh0KTtzd2l0Y2godC53aGljaCl7Y2FzZSBDLlVQOmNhc2UgQy5ET1dOOnJldHVybiB0aGlzLm1vdmVIaWdobGlnaHQodC53aGljaD09PUMuVVA/LTE6MSksdm9pZCBfKHQpO2Nhc2UgQy5FTlRFUjpyZXR1cm4gdGhpcy5zZWxlY3RIaWdobGlnaHRlZCgpLHZvaWQgXyh0KTtjYXNlIEMuVEFCOnJldHVybiB2b2lkIHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoe25vRm9jdXM6ITB9KTtjYXNlIEMuRVNDOnJldHVybiB0aGlzLmNhbmNlbCh0KSx2b2lkIF8odCl9fX0pKSx0aGlzLnNlYXJjaC5vbigiYmx1ciIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe2RvY3VtZW50LmFjdGl2ZUVsZW1lbnQ9PT10aGlzLmJvZHkuZ2V0KDApJiZ3aW5kb3cuc2V0VGltZW91dCh0aGlzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLm9wZW5lZCgpJiZ0aGlzLnNlYXJjaC5mb2N1cygpfSksMCl9KSksdGhpcy5mb2N1c3Nlci5vbigia2V5ZG93biIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe2lmKHRoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkmJnQud2hpY2ghPT1DLlRBQiYmIUMuaXNDb250cm9sKHQpJiYhQy5pc0Z1bmN0aW9uS2V5KHQpJiZ0LndoaWNoIT09Qy5FU0Mpe2lmKHRoaXMub3B0cy5vcGVuT25FbnRlcj09PSExJiZ0LndoaWNoPT09Qy5FTlRFUilyZXR1cm4gdm9pZCBfKHQpO2lmKHQud2hpY2g9PUMuRE9XTnx8dC53aGljaD09Qy5VUHx8dC53aGljaD09Qy5FTlRFUiYmdGhpcy5vcHRzLm9wZW5PbkVudGVyKXtpZih0LmFsdEtleXx8dC5jdHJsS2V5fHx0LnNoaWZ0S2V5fHx0Lm1ldGFLZXkpcmV0dXJuO3JldHVybiB0aGlzLm9wZW4oKSx2b2lkIF8odCl9cmV0dXJuIHQud2hpY2g9PUMuREVMRVRFfHx0LndoaWNoPT1DLkJBQ0tTUEFDRT8odGhpcy5vcHRzLmFsbG93Q2xlYXImJnRoaXMuY2xlYXIoKSx2b2lkIF8odCkpOnZvaWQgMH19KSksdSh0aGlzLmZvY3Vzc2VyKSx0aGlzLmZvY3Vzc2VyLm9uKCJrZXl1cC1jaGFuZ2UgaW5wdXQiLHRoaXMuYmluZChmdW5jdGlvbih0KXtpZih0aGlzLm9wdHMubWluaW11bVJlc3VsdHNGb3JTZWFyY2g+PTApe2lmKHQuc3RvcFByb3BhZ2F0aW9uKCksdGhpcy5vcGVuZWQoKSlyZXR1cm47dGhpcy5vcGVuKCl9fSkpLGUub24oIm1vdXNlZG93biB0b3VjaHN0YXJ0IiwiYWJiciIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkmJih0aGlzLmNsZWFyKCksZyh0KSx0aGlzLmNsb3NlKCksdGhpcy5zZWxlY3Rpb24uZm9jdXMoKSl9KSksZS5vbigibW91c2Vkb3duIHRvdWNoc3RhcnQiLHRoaXMuYmluZChmdW5jdGlvbihpKXtuKGUpLHRoaXMuY29udGFpbmVyLmhhc0NsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKXx8dGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLWZvY3VzIikpLHRoaXMub3BlbmVkKCk/dGhpcy5jbG9zZSgpOnRoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkmJnRoaXMub3BlbigpLF8oaSl9KSkscy5vbigibW91c2Vkb3duIHRvdWNoc3RhcnQiLHRoaXMuYmluZChmdW5jdGlvbigpe3RoaXMub3B0cy5zaG91bGRGb2N1c0lucHV0KHRoaXMpJiZ0aGlzLnNlYXJjaC5mb2N1cygpfSkpLGUub24oImZvY3VzIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7Xyh0KX0pKSx0aGlzLmZvY3Vzc2VyLm9uKCJmb2N1cyIsdGhpcy5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfHx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItZm9jdXMiKSksdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfSkpLm9uKCJibHVyIix0aGlzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLm9wZW5lZCgpfHwodGhpcy5jb250YWluZXIucmVtb3ZlQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIodC5FdmVudCgic2VsZWN0Mi1ibHVyIikpKX0pKSx0aGlzLnNlYXJjaC5vbigiZm9jdXMiLHRoaXMuYmluZChmdW5jdGlvbigpe3RoaXMuY29udGFpbmVyLmhhc0NsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKXx8dGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLWZvY3VzIikpLHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKX0pKSx0aGlzLmluaXRDb250YWluZXJXaWR0aCgpLHRoaXMub3B0cy5lbGVtZW50LmFkZENsYXNzKCJzZWxlY3QyLW9mZnNjcmVlbiIpLHRoaXMuc2V0UGxhY2Vob2xkZXIoKX0sY2xlYXI6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5zZWxlY3Rpb24uZGF0YSgic2VsZWN0Mi1kYXRhIik7aWYoaSl7dmFyIG49dC5FdmVudCgic2VsZWN0Mi1jbGVhcmluZyIpO2lmKHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIobiksbi5pc0RlZmF1bHRQcmV2ZW50ZWQoKSlyZXR1cm47dmFyIHI9dGhpcy5nZXRQbGFjZWhvbGRlck9wdGlvbigpO3RoaXMub3B0cy5lbGVtZW50LnZhbChyP3IudmFsKCk6IiIpLHRoaXMuc2VsZWN0aW9uLmZpbmQoIi5zZWxlY3QyLWNob3NlbiIpLmVtcHR5KCksdGhpcy5zZWxlY3Rpb24ucmVtb3ZlRGF0YSgic2VsZWN0Mi1kYXRhIiksdGhpcy5zZXRQbGFjZWhvbGRlcigpLGUhPT0hMSYmKHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIoe3R5cGU6InNlbGVjdDItcmVtb3ZlZCIsdmFsOnRoaXMuaWQoaSksY2hvaWNlOml9KSx0aGlzLnRyaWdnZXJDaGFuZ2Uoe3JlbW92ZWQ6aX0pKX19LGluaXRTZWxlY3Rpb246ZnVuY3Rpb24oKXtpZih0aGlzLmlzUGxhY2Vob2xkZXJPcHRpb25TZWxlY3RlZCgpKXRoaXMudXBkYXRlU2VsZWN0aW9uKG51bGwpLHRoaXMuY2xvc2UoKSx0aGlzLnNldFBsYWNlaG9sZGVyKCk7ZWxzZXt2YXIgdD10aGlzO3RoaXMub3B0cy5pbml0U2VsZWN0aW9uLmNhbGwobnVsbCx0aGlzLm9wdHMuZWxlbWVudCxmdW5jdGlvbihlKXtlIT09aSYmbnVsbCE9PWUmJih0LnVwZGF0ZVNlbGVjdGlvbihlKSx0LmNsb3NlKCksdC5zZXRQbGFjZWhvbGRlcigpLHQubmV4dFNlYXJjaFRlcm09dC5vcHRzLm5leHRTZWFyY2hUZXJtKGUsdC5zZWFyY2gudmFsKCkpKX0pfX0saXNQbGFjZWhvbGRlck9wdGlvblNlbGVjdGVkOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHRoaXMuZ2V0UGxhY2Vob2xkZXIoKSE9PWkmJigodD10aGlzLmdldFBsYWNlaG9sZGVyT3B0aW9uKCkpIT09aSYmdC5wcm9wKCJzZWxlY3RlZCIpfHwiIj09PXRoaXMub3B0cy5lbGVtZW50LnZhbCgpfHx0aGlzLm9wdHMuZWxlbWVudC52YWwoKT09PWl8fG51bGw9PT10aGlzLm9wdHMuZWxlbWVudC52YWwoKSl9LHByZXBhcmVPcHRzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5wYXJlbnQucHJlcGFyZU9wdHMuYXBwbHkodGhpcyxhcmd1bWVudHMpLGk9dGhpcztyZXR1cm4ic2VsZWN0Ij09PWUuZWxlbWVudC5nZXQoMCkudGFnTmFtZS50b0xvd2VyQ2FzZSgpP2UuaW5pdFNlbGVjdGlvbj1mdW5jdGlvbih0LGUpe3ZhciBuPXQuZmluZCgib3B0aW9uIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0ZWQmJiF0aGlzLmRpc2FibGVkfSk7ZShpLm9wdGlvblRvRGF0YShuKSl9OiJkYXRhImluIGUmJihlLmluaXRTZWxlY3Rpb249ZS5pbml0U2VsZWN0aW9ufHxmdW5jdGlvbihpLG4pe3ZhciByPWkudmFsKCkscz1udWxsO2UucXVlcnkoe21hdGNoZXI6ZnVuY3Rpb24odCxpLG4pe3ZhciBvPWEocixlLmlkKG4pKTtyZXR1cm4gbyYmKHM9biksb30sY2FsbGJhY2s6dC5pc0Z1bmN0aW9uKG4pP2Z1bmN0aW9uKCl7bihzKX06dC5ub29wfSl9KSxlfSxnZXRQbGFjZWhvbGRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNlbGVjdCYmdGhpcy5nZXRQbGFjZWhvbGRlck9wdGlvbigpPT09aT9pOnRoaXMucGFyZW50LmdldFBsYWNlaG9sZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sc2V0UGxhY2Vob2xkZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFBsYWNlaG9sZGVyKCk7aWYodGhpcy5pc1BsYWNlaG9sZGVyT3B0aW9uU2VsZWN0ZWQoKSYmdCE9PWkpe2lmKHRoaXMuc2VsZWN0JiZ0aGlzLmdldFBsYWNlaG9sZGVyT3B0aW9uKCk9PT1pKXJldHVybjt0aGlzLnNlbGVjdGlvbi5maW5kKCIuc2VsZWN0Mi1jaG9zZW4iKS5odG1sKHRoaXMub3B0cy5lc2NhcGVNYXJrdXAodCkpLHRoaXMuc2VsZWN0aW9uLmFkZENsYXNzKCJzZWxlY3QyLWRlZmF1bHQiKSx0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1hbGxvd2NsZWFyIil9fSxwb3N0cHJvY2Vzc1Jlc3VsdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPTAscj10aGlzO2lmKHRoaXMuZmluZEhpZ2hsaWdodGFibGVDaG9pY2VzKCkuZWFjaDIoZnVuY3Rpb24odCxlKXtpZihhKHIuaWQoZS5kYXRhKCJzZWxlY3QyLWRhdGEiKSksci5vcHRzLmVsZW1lbnQudmFsKCkpKXJldHVybiBuPXQsITF9KSxpIT09ITEmJihlPT09ITAmJm4+PTA/dGhpcy5oaWdobGlnaHQobik6dGhpcy5oaWdobGlnaHQoMCkpLGU9PT0hMCl7dmFyIHM9dGhpcy5vcHRzLm1pbmltdW1SZXN1bHRzRm9yU2VhcmNoO3M+PTAmJnRoaXMuc2hvd1NlYXJjaCh4KHQucmVzdWx0cyk+PXMpfX0sc2hvd1NlYXJjaDpmdW5jdGlvbihlKXt0aGlzLnNob3dTZWFyY2hJbnB1dCE9PWUmJih0aGlzLnNob3dTZWFyY2hJbnB1dD1lLHRoaXMuZHJvcGRvd24uZmluZCgiLnNlbGVjdDItc2VhcmNoIikudG9nZ2xlQ2xhc3MoInNlbGVjdDItc2VhcmNoLWhpZGRlbiIsIWUpLHRoaXMuZHJvcGRvd24uZmluZCgiLnNlbGVjdDItc2VhcmNoIikudG9nZ2xlQ2xhc3MoInNlbGVjdDItb2Zmc2NyZWVuIiwhZSksdCh0aGlzLmRyb3Bkb3duLHRoaXMuY29udGFpbmVyKS50b2dnbGVDbGFzcygic2VsZWN0Mi13aXRoLXNlYXJjaGJveCIsZSkpfSxvblNlbGVjdDpmdW5jdGlvbih0LGUpe2lmKHRoaXMudHJpZ2dlclNlbGVjdCh0KSl7dmFyIGk9dGhpcy5vcHRzLmVsZW1lbnQudmFsKCksbj10aGlzLmRhdGEoKTt0aGlzLm9wdHMuZWxlbWVudC52YWwodGhpcy5pZCh0KSksdGhpcy51cGRhdGVTZWxlY3Rpb24odCksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih7dHlwZToic2VsZWN0Mi1zZWxlY3RlZCIsdmFsOnRoaXMuaWQodCksY2hvaWNlOnR9KSx0aGlzLm5leHRTZWFyY2hUZXJtPXRoaXMub3B0cy5uZXh0U2VhcmNoVGVybSh0LHRoaXMuc2VhcmNoLnZhbCgpKSx0aGlzLmNsb3NlKCksZSYmZS5ub0ZvY3VzfHwhdGhpcy5vcHRzLnNob3VsZEZvY3VzSW5wdXQodGhpcyl8fHRoaXMuZm9jdXNzZXIuZm9jdXMoKSxhKGksdGhpcy5pZCh0KSl8fHRoaXMudHJpZ2dlckNoYW5nZSh7YWRkZWQ6dCxyZW1vdmVkOm59KX19LHVwZGF0ZVNlbGVjdGlvbjpmdW5jdGlvbih0KXt2YXIgZSxuLHI9dGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItY2hvc2VuIik7dGhpcy5zZWxlY3Rpb24uZGF0YSgic2VsZWN0Mi1kYXRhIix0KSxyLmVtcHR5KCksbnVsbCE9PXQmJihlPXRoaXMub3B0cy5mb3JtYXRTZWxlY3Rpb24odCxyLHRoaXMub3B0cy5lc2NhcGVNYXJrdXApKSxlIT09aSYmci5hcHBlbmQoZSksbj10aGlzLm9wdHMuZm9ybWF0U2VsZWN0aW9uQ3NzQ2xhc3ModCxyKSxuIT09aSYmci5hZGRDbGFzcyhuKSx0aGlzLnNlbGVjdGlvbi5yZW1vdmVDbGFzcygic2VsZWN0Mi1kZWZhdWx0IiksdGhpcy5vcHRzLmFsbG93Q2xlYXImJnRoaXMuZ2V0UGxhY2Vob2xkZXIoKSE9PWkmJnRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJzZWxlY3QyLWFsbG93Y2xlYXIiKX0sdmFsOmZ1bmN0aW9uKCl7dmFyIHQsZT0hMSxuPW51bGwscj10aGlzLHM9dGhpcy5kYXRhKCk7aWYoMD09PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMub3B0cy5lbGVtZW50LnZhbCgpO2lmKHQ9YXJndW1lbnRzWzBdLGFyZ3VtZW50cy5sZW5ndGg+MSYmKGU9YXJndW1lbnRzWzFdKSx0aGlzLnNlbGVjdCl0aGlzLnNlbGVjdC52YWwodCkuZmluZCgib3B0aW9uIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0ZWR9KS5lYWNoMihmdW5jdGlvbih0LGUpe3JldHVybiBuPXIub3B0aW9uVG9EYXRhKGUpLCExfSksdGhpcy51cGRhdGVTZWxlY3Rpb24obiksdGhpcy5zZXRQbGFjZWhvbGRlcigpLGUmJnRoaXMudHJpZ2dlckNoYW5nZSh7YWRkZWQ6bixyZW1vdmVkOnN9KTtlbHNle2lmKCF0JiYwIT09dClyZXR1cm4gdm9pZCB0aGlzLmNsZWFyKGUpO2lmKHRoaXMub3B0cy5pbml0U2VsZWN0aW9uPT09aSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBjYWxsIHZhbCgpIGlmIGluaXRTZWxlY3Rpb24oKSBpcyBub3QgZGVmaW5lZCIpO3RoaXMub3B0cy5lbGVtZW50LnZhbCh0KSx0aGlzLm9wdHMuaW5pdFNlbGVjdGlvbih0aGlzLm9wdHMuZWxlbWVudCxmdW5jdGlvbih0KXtyLm9wdHMuZWxlbWVudC52YWwodD9yLmlkKHQpOiIiKSxyLnVwZGF0ZVNlbGVjdGlvbih0KSxyLnNldFBsYWNlaG9sZGVyKCksZSYmci50cmlnZ2VyQ2hhbmdlKHthZGRlZDp0LHJlbW92ZWQ6c30pfSl9fSxjbGVhclNlYXJjaDpmdW5jdGlvbigpe3RoaXMuc2VhcmNoLnZhbCgiIiksdGhpcy5mb2N1c3Nlci52YWwoIiIpfSxkYXRhOmZ1bmN0aW9uKHQpe3ZhciBlLG49ITE7cmV0dXJuIDA9PT1hcmd1bWVudHMubGVuZ3RoPyhlPXRoaXMuc2VsZWN0aW9uLmRhdGEoInNlbGVjdDItZGF0YSIpLGU9PWkmJihlPW51bGwpLGUpOihhcmd1bWVudHMubGVuZ3RoPjEmJihuPWFyZ3VtZW50c1sxXSksCgl2b2lkKHQ/KGU9dGhpcy5kYXRhKCksdGhpcy5vcHRzLmVsZW1lbnQudmFsKHQ/dGhpcy5pZCh0KToiIiksdGhpcy51cGRhdGVTZWxlY3Rpb24odCksbiYmdGhpcy50cmlnZ2VyQ2hhbmdlKHthZGRlZDp0LHJlbW92ZWQ6ZX0pKTp0aGlzLmNsZWFyKG4pKSl9fSksTj1ZKEEse2NyZWF0ZUNvbnRhaW5lcjpmdW5jdGlvbigpe3ZhciBlPXQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLmF0dHIoeyJjbGFzcyI6InNlbGVjdDItY29udGFpbmVyIHNlbGVjdDItY29udGFpbmVyLW11bHRpIn0pLmh0bWwoWyI8dWwgY2xhc3M9J3NlbGVjdDItY2hvaWNlcyc+IiwiICA8bGkgY2xhc3M9J3NlbGVjdDItc2VhcmNoLWZpZWxkJz4iLCIgICAgPGxhYmVsIGZvcj0nJyBjbGFzcz0nc2VsZWN0Mi1vZmZzY3JlZW4nPjwvbGFiZWw+IiwiICAgIDxpbnB1dCB0eXBlPSd0ZXh0JyBhdXRvY29tcGxldGU9J29mZicgYXV0b2NvcnJlY3Q9J29mZicgYXV0b2NhcGl0YWxpemU9J29mZicgc3BlbGxjaGVjaz0nZmFsc2UnIGNsYXNzPSdzZWxlY3QyLWlucHV0Jz4iLCIgIDwvbGk+IiwiPC91bD4iLCI8ZGl2IGNsYXNzPSdzZWxlY3QyLWRyb3Agc2VsZWN0Mi1kcm9wLW11bHRpIHNlbGVjdDItZGlzcGxheS1ub25lJz4iLCIgICA8dWwgY2xhc3M9J3NlbGVjdDItcmVzdWx0cyc+IiwiICAgPC91bD4iLCI8L2Rpdj4iXS5qb2luKCIiKSk7cmV0dXJuIGV9LHByZXBhcmVPcHRzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5wYXJlbnQucHJlcGFyZU9wdHMuYXBwbHkodGhpcyxhcmd1bWVudHMpLGk9dGhpcztyZXR1cm4ic2VsZWN0Ij09PWUuZWxlbWVudC5nZXQoMCkudGFnTmFtZS50b0xvd2VyQ2FzZSgpP2UuaW5pdFNlbGVjdGlvbj1mdW5jdGlvbih0LGUpe3ZhciBuPVtdO3QuZmluZCgib3B0aW9uIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0ZWQmJiF0aGlzLmRpc2FibGVkfSkuZWFjaDIoZnVuY3Rpb24odCxlKXtuLnB1c2goaS5vcHRpb25Ub0RhdGEoZSkpfSksZShuKX06ImRhdGEiaW4gZSYmKGUuaW5pdFNlbGVjdGlvbj1lLmluaXRTZWxlY3Rpb258fGZ1bmN0aW9uKGksbil7dmFyIHI9bChpLnZhbCgpLGUuc2VwYXJhdG9yKSxzPVtdO2UucXVlcnkoe21hdGNoZXI6ZnVuY3Rpb24oaSxuLG8pe3ZhciBsPXQuZ3JlcChyLGZ1bmN0aW9uKHQpe3JldHVybiBhKHQsZS5pZChvKSl9KS5sZW5ndGg7cmV0dXJuIGwmJnMucHVzaChvKSxsfSxjYWxsYmFjazp0LmlzRnVuY3Rpb24obik/ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10saT0wO2k8ci5sZW5ndGg7aSsrKWZvcih2YXIgbz1yW2ldLGw9MDtsPHMubGVuZ3RoO2wrKyl7dmFyIGM9c1tsXTtpZihhKG8sZS5pZChjKSkpe3QucHVzaChjKSxzLnNwbGljZShsLDEpO2JyZWFrfX1uKHQpfTp0Lm5vb3B9KX0pLGV9LHNlbGVjdENob2ljZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNvbnRhaW5lci5maW5kKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWZvY3VzIik7ZS5sZW5ndGgmJnQmJnRbMF09PWVbMF18fChlLmxlbmd0aCYmdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcigiY2hvaWNlLWRlc2VsZWN0ZWQiLGUpLGUucmVtb3ZlQ2xhc3MoInNlbGVjdDItc2VhcmNoLWNob2ljZS1mb2N1cyIpLHQmJnQubGVuZ3RoJiYodGhpcy5jbG9zZSgpLHQuYWRkQ2xhc3MoInNlbGVjdDItc2VhcmNoLWNob2ljZS1mb2N1cyIpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIoImNob2ljZS1zZWxlY3RlZCIsdCkpKX0sZGVzdHJveTpmdW5jdGlvbigpe3QoImxhYmVsW2Zvcj0nIit0aGlzLnNlYXJjaC5hdHRyKCJpZCIpKyInXSIpLmF0dHIoImZvciIsdGhpcy5vcHRzLmVsZW1lbnQuYXR0cigiaWQiKSksdGhpcy5wYXJlbnQuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyksRC5jYWxsKHRoaXMsInNlYXJjaENvbnRhaW5lciIsInNlbGVjdGlvbiIpfSxpbml0Q29udGFpbmVyOmZ1bmN0aW9uKCl7dmFyIGUsaT0iLnNlbGVjdDItY2hvaWNlcyI7dGhpcy5zZWFyY2hDb250YWluZXI9dGhpcy5jb250YWluZXIuZmluZCgiLnNlbGVjdDItc2VhcmNoLWZpZWxkIiksdGhpcy5zZWxlY3Rpb249ZT10aGlzLmNvbnRhaW5lci5maW5kKGkpO3ZhciBuPXRoaXM7dGhpcy5zZWxlY3Rpb24ub24oImNsaWNrIiwiLnNlbGVjdDItY29udGFpbmVyOm5vdCguc2VsZWN0Mi1jb250YWluZXItZGlzYWJsZWQpIC5zZWxlY3QyLXNlYXJjaC1jaG9pY2U6bm90KC5zZWxlY3QyLWxvY2tlZCkiLGZ1bmN0aW9uKGUpe24uc2VhcmNoWzBdLmZvY3VzKCksbi5zZWxlY3RDaG9pY2UodCh0aGlzKSl9KSx0aGlzLnNlYXJjaC5hdHRyKCJpZCIsInMyaWRfYXV0b2dlbiIrSSgpKSx0aGlzLnNlYXJjaC5wcmV2KCkudGV4dCh0KCJsYWJlbFtmb3I9JyIrdGhpcy5vcHRzLmVsZW1lbnQuYXR0cigiaWQiKSsiJ10iKS50ZXh0KCkpLmF0dHIoImZvciIsdGhpcy5zZWFyY2guYXR0cigiaWQiKSksdGhpcy5zZWFyY2gub24oImlucHV0IHBhc3RlIix0aGlzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLnNlYXJjaC5hdHRyKCJwbGFjZWhvbGRlciIpJiYwPT10aGlzLnNlYXJjaC52YWwoKS5sZW5ndGh8fHRoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkmJih0aGlzLm9wZW5lZCgpfHx0aGlzLm9wZW4oKSl9KSksdGhpcy5zZWFyY2guYXR0cigidGFiaW5kZXgiLHRoaXMuZWxlbWVudFRhYkluZGV4KSx0aGlzLmtleWRvd25zPTAsdGhpcy5zZWFyY2gub24oImtleWRvd24iLHRoaXMuYmluZChmdW5jdGlvbih0KXtpZih0aGlzLmlzSW50ZXJmYWNlRW5hYmxlZCgpKXsrK3RoaXMua2V5ZG93bnM7dmFyIGk9ZS5maW5kKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWZvY3VzIiksbj1pLnByZXYoIi5zZWxlY3QyLXNlYXJjaC1jaG9pY2U6bm90KC5zZWxlY3QyLWxvY2tlZCkiKSxyPWkubmV4dCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZTpub3QoLnNlbGVjdDItbG9ja2VkKSIpLHM9bSh0aGlzLnNlYXJjaCk7aWYoaS5sZW5ndGgmJih0LndoaWNoPT1DLkxFRlR8fHQud2hpY2g9PUMuUklHSFR8fHQud2hpY2g9PUMuQkFDS1NQQUNFfHx0LndoaWNoPT1DLkRFTEVURXx8dC53aGljaD09Qy5FTlRFUikpe3ZhciBvPWk7cmV0dXJuIHQud2hpY2g9PUMuTEVGVCYmbi5sZW5ndGg/bz1uOnQud2hpY2g9PUMuUklHSFQ/bz1yLmxlbmd0aD9yOm51bGw6dC53aGljaD09PUMuQkFDS1NQQUNFP3RoaXMudW5zZWxlY3QoaS5maXJzdCgpKSYmKHRoaXMuc2VhcmNoLndpZHRoKDEwKSxvPW4ubGVuZ3RoP246cik6dC53aGljaD09Qy5ERUxFVEU/dGhpcy51bnNlbGVjdChpLmZpcnN0KCkpJiYodGhpcy5zZWFyY2gud2lkdGgoMTApLG89ci5sZW5ndGg/cjpudWxsKTp0LndoaWNoPT1DLkVOVEVSJiYobz1udWxsKSx0aGlzLnNlbGVjdENob2ljZShvKSxfKHQpLHZvaWQobyYmby5sZW5ndGh8fHRoaXMub3BlbigpKX1pZigodC53aGljaD09PUMuQkFDS1NQQUNFJiYxPT10aGlzLmtleWRvd25zfHx0LndoaWNoPT1DLkxFRlQpJiYwPT1zLm9mZnNldCYmIXMubGVuZ3RoKXJldHVybiB0aGlzLnNlbGVjdENob2ljZShlLmZpbmQoIi5zZWxlY3QyLXNlYXJjaC1jaG9pY2U6bm90KC5zZWxlY3QyLWxvY2tlZCkiKS5sYXN0KCkpLHZvaWQgXyh0KTtpZih0aGlzLnNlbGVjdENob2ljZShudWxsKSx0aGlzLm9wZW5lZCgpKXN3aXRjaCh0LndoaWNoKXtjYXNlIEMuVVA6Y2FzZSBDLkRPV046cmV0dXJuIHRoaXMubW92ZUhpZ2hsaWdodCh0LndoaWNoPT09Qy5VUD8tMToxKSx2b2lkIF8odCk7Y2FzZSBDLkVOVEVSOnJldHVybiB0aGlzLnNlbGVjdEhpZ2hsaWdodGVkKCksdm9pZCBfKHQpO2Nhc2UgQy5UQUI6cmV0dXJuIHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoe25vRm9jdXM6ITB9KSx2b2lkIHRoaXMuY2xvc2UoKTtjYXNlIEMuRVNDOnJldHVybiB0aGlzLmNhbmNlbCh0KSx2b2lkIF8odCl9aWYodC53aGljaCE9PUMuVEFCJiYhQy5pc0NvbnRyb2wodCkmJiFDLmlzRnVuY3Rpb25LZXkodCkmJnQud2hpY2ghPT1DLkJBQ0tTUEFDRSYmdC53aGljaCE9PUMuRVNDKXtpZih0LndoaWNoPT09Qy5FTlRFUil7aWYodGhpcy5vcHRzLm9wZW5PbkVudGVyPT09ITEpcmV0dXJuO2lmKHQuYWx0S2V5fHx0LmN0cmxLZXl8fHQuc2hpZnRLZXl8fHQubWV0YUtleSlyZXR1cm59dGhpcy5vcGVuKCksdC53aGljaCE9PUMuUEFHRV9VUCYmdC53aGljaCE9PUMuUEFHRV9ET1dOfHxfKHQpLHQud2hpY2g9PT1DLkVOVEVSJiZfKHQpfX19KSksdGhpcy5zZWFyY2gub24oImtleXVwIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7dGhpcy5rZXlkb3ducz0wLHRoaXMucmVzaXplU2VhcmNoKCl9KSksdGhpcy5zZWFyY2gub24oImJsdXIiLHRoaXMuYmluZChmdW5jdGlvbihlKXt0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1jb250YWluZXItYWN0aXZlIiksdGhpcy5zZWFyY2gucmVtb3ZlQ2xhc3MoInNlbGVjdDItZm9jdXNlZCIpLHRoaXMuc2VsZWN0Q2hvaWNlKG51bGwpLHRoaXMub3BlbmVkKCl8fHRoaXMuY2xlYXJTZWFyY2goKSxlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIodC5FdmVudCgic2VsZWN0Mi1ibHVyIikpfSkpLHRoaXMuY29udGFpbmVyLm9uKCJjbGljayIsaSx0aGlzLmJpbmQoZnVuY3Rpb24oZSl7dGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmKHQoZS50YXJnZXQpLmNsb3Nlc3QoIi5zZWxlY3QyLXNlYXJjaC1jaG9pY2UiKS5sZW5ndGg+MHx8KHRoaXMuc2VsZWN0Q2hvaWNlKG51bGwpLHRoaXMuY2xlYXJQbGFjZWhvbGRlcigpLHRoaXMuY29udGFpbmVyLmhhc0NsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKXx8dGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLWZvY3VzIikpLHRoaXMub3BlbigpLHRoaXMuZm9jdXNTZWFyY2goKSxlLnByZXZlbnREZWZhdWx0KCkpKX0pKSx0aGlzLmNvbnRhaW5lci5vbigiZm9jdXMiLGksdGhpcy5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmKHRoaXMuY29udGFpbmVyLmhhc0NsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKXx8dGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLWZvY3VzIikpLHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLmRyb3Bkb3duLmFkZENsYXNzKCJzZWxlY3QyLWRyb3AtYWN0aXZlIiksdGhpcy5jbGVhclBsYWNlaG9sZGVyKCkpfSkpLHRoaXMuaW5pdENvbnRhaW5lcldpZHRoKCksdGhpcy5vcHRzLmVsZW1lbnQuYWRkQ2xhc3MoInNlbGVjdDItb2Zmc2NyZWVuIiksdGhpcy5jbGVhclNlYXJjaCgpfSxlbmFibGVJbnRlcmZhY2U6ZnVuY3Rpb24oKXt0aGlzLnBhcmVudC5lbmFibGVJbnRlcmZhY2UuYXBwbHkodGhpcyxhcmd1bWVudHMpJiZ0aGlzLnNlYXJjaC5wcm9wKCJkaXNhYmxlZCIsIXRoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkpfSxpbml0U2VsZWN0aW9uOmZ1bmN0aW9uKCl7aWYoIiI9PT10aGlzLm9wdHMuZWxlbWVudC52YWwoKSYmIiI9PT10aGlzLm9wdHMuZWxlbWVudC50ZXh0KCkmJih0aGlzLnVwZGF0ZVNlbGVjdGlvbihbXSksdGhpcy5jbG9zZSgpLHRoaXMuY2xlYXJTZWFyY2goKSksdGhpcy5zZWxlY3R8fCIiIT09dGhpcy5vcHRzLmVsZW1lbnQudmFsKCkpe3ZhciB0PXRoaXM7dGhpcy5vcHRzLmluaXRTZWxlY3Rpb24uY2FsbChudWxsLHRoaXMub3B0cy5lbGVtZW50LGZ1bmN0aW9uKGUpe2UhPT1pJiZudWxsIT09ZSYmKHQudXBkYXRlU2VsZWN0aW9uKGUpLHQuY2xvc2UoKSx0LmNsZWFyU2VhcmNoKCkpfSl9fSxjbGVhclNlYXJjaDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0UGxhY2Vob2xkZXIoKSxlPXRoaXMuZ2V0TWF4U2VhcmNoV2lkdGgoKTt0IT09aSYmMD09PXRoaXMuZ2V0VmFsKCkubGVuZ3RoJiZ0aGlzLnNlYXJjaC5oYXNDbGFzcygic2VsZWN0Mi1mb2N1c2VkIik9PT0hMT8odGhpcy5zZWFyY2gudmFsKHQpLmFkZENsYXNzKCJzZWxlY3QyLWRlZmF1bHQiKSx0aGlzLnNlYXJjaC53aWR0aChlPjA/ZTp0aGlzLmNvbnRhaW5lci5jc3MoIndpZHRoIikpKTp0aGlzLnNlYXJjaC52YWwoIiIpLndpZHRoKDEwKX0sY2xlYXJQbGFjZWhvbGRlcjpmdW5jdGlvbigpe3RoaXMuc2VhcmNoLmhhc0NsYXNzKCJzZWxlY3QyLWRlZmF1bHQiKSYmdGhpcy5zZWFyY2gudmFsKCIiKS5yZW1vdmVDbGFzcygic2VsZWN0Mi1kZWZhdWx0Iil9LG9wZW5pbmc6ZnVuY3Rpb24oKXt0aGlzLmNsZWFyUGxhY2Vob2xkZXIoKSx0aGlzLnJlc2l6ZVNlYXJjaCgpLHRoaXMucGFyZW50Lm9wZW5pbmcuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuZm9jdXNTZWFyY2goKSwiIj09PXRoaXMuc2VhcmNoLnZhbCgpJiZ0aGlzLm5leHRTZWFyY2hUZXJtIT1pJiYodGhpcy5zZWFyY2gudmFsKHRoaXMubmV4dFNlYXJjaFRlcm0pLHRoaXMuc2VhcmNoLnNlbGVjdCgpKSx0aGlzLnVwZGF0ZVJlc3VsdHMoITApLHRoaXMub3B0cy5zaG91bGRGb2N1c0lucHV0KHRoaXMpJiZ0aGlzLnNlYXJjaC5mb2N1cygpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIodC5FdmVudCgic2VsZWN0Mi1vcGVuIikpfSxjbG9zZTpmdW5jdGlvbigpe3RoaXMub3BlbmVkKCkmJnRoaXMucGFyZW50LmNsb3NlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLmNsb3NlKCksdGhpcy5zZWFyY2guZm9jdXMoKX0saXNGb2N1c2VkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VhcmNoLmhhc0NsYXNzKCJzZWxlY3QyLWZvY3VzZWQiKX0sdXBkYXRlU2VsZWN0aW9uOmZ1bmN0aW9uKGUpe3ZhciBpPVtdLG49W10scj10aGlzO3QoZSkuZWFjaChmdW5jdGlvbigpe3Moci5pZCh0aGlzKSxpKTwwJiYoaS5wdXNoKHIuaWQodGhpcykpLG4ucHVzaCh0aGlzKSl9KSxlPW4sdGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZSIpLnJlbW92ZSgpLHQoZSkuZWFjaChmdW5jdGlvbigpe3IuYWRkU2VsZWN0ZWRDaG9pY2UodGhpcyl9KSxyLnBvc3Rwcm9jZXNzUmVzdWx0cygpfSx0b2tlbml6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuc2VhcmNoLnZhbCgpO3Q9dGhpcy5vcHRzLnRva2VuaXplci5jYWxsKHRoaXMsdCx0aGlzLmRhdGEoKSx0aGlzLmJpbmQodGhpcy5vblNlbGVjdCksdGhpcy5vcHRzKSxudWxsIT10JiZ0IT1pJiYodGhpcy5zZWFyY2gudmFsKHQpLHQubGVuZ3RoPjAmJnRoaXMub3BlbigpKX0sb25TZWxlY3Q6ZnVuY3Rpb24odCxlKXt0aGlzLnRyaWdnZXJTZWxlY3QodCkmJiIiIT09dC50ZXh0JiYodGhpcy5hZGRTZWxlY3RlZENob2ljZSh0KSx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHt0eXBlOiJzZWxlY3RlZCIsdmFsOnRoaXMuaWQodCksY2hvaWNlOnR9KSx0aGlzLm5leHRTZWFyY2hUZXJtPXRoaXMub3B0cy5uZXh0U2VhcmNoVGVybSh0LHRoaXMuc2VhcmNoLnZhbCgpKSx0aGlzLmNsZWFyU2VhcmNoKCksdGhpcy51cGRhdGVSZXN1bHRzKCksIXRoaXMuc2VsZWN0JiZ0aGlzLm9wdHMuY2xvc2VPblNlbGVjdHx8dGhpcy5wb3N0cHJvY2Vzc1Jlc3VsdHModCwhMSx0aGlzLm9wdHMuY2xvc2VPblNlbGVjdD09PSEwKSx0aGlzLm9wdHMuY2xvc2VPblNlbGVjdD8odGhpcy5jbG9zZSgpLHRoaXMuc2VhcmNoLndpZHRoKDEwKSk6dGhpcy5jb3VudFNlbGVjdGFibGVSZXN1bHRzKCk+MD8odGhpcy5zZWFyY2gud2lkdGgoMTApLHRoaXMucmVzaXplU2VhcmNoKCksdGhpcy5nZXRNYXhpbXVtU2VsZWN0aW9uU2l6ZSgpPjAmJnRoaXMudmFsKCkubGVuZ3RoPj10aGlzLmdldE1heGltdW1TZWxlY3Rpb25TaXplKCk/dGhpcy51cGRhdGVSZXN1bHRzKCEwKTp0aGlzLm5leHRTZWFyY2hUZXJtIT1pJiYodGhpcy5zZWFyY2gudmFsKHRoaXMubmV4dFNlYXJjaFRlcm0pLHRoaXMudXBkYXRlUmVzdWx0cygpLHRoaXMuc2VhcmNoLnNlbGVjdCgpKSx0aGlzLnBvc2l0aW9uRHJvcGRvd24oKSk6KHRoaXMuY2xvc2UoKSx0aGlzLnNlYXJjaC53aWR0aCgxMCkpLHRoaXMudHJpZ2dlckNoYW5nZSh7YWRkZWQ6dH0pLGUmJmUubm9Gb2N1c3x8dGhpcy5mb2N1c1NlYXJjaCgpKX0sY2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy5jbG9zZSgpLHRoaXMuZm9jdXNTZWFyY2goKX0sYWRkU2VsZWN0ZWRDaG9pY2U6ZnVuY3Rpb24oZSl7dmFyIG4scixzPSFlLmxvY2tlZCxvPXQoIjxsaSBjbGFzcz0nc2VsZWN0Mi1zZWFyY2gtY2hvaWNlJz4gICAgPGRpdj48L2Rpdj4gICAgPGEgaHJlZj0nIycgY2xhc3M9J3NlbGVjdDItc2VhcmNoLWNob2ljZS1jbG9zZScgdGFiaW5kZXg9Jy0xJz48L2E+PC9saT4iKSxhPXQoIjxsaSBjbGFzcz0nc2VsZWN0Mi1zZWFyY2gtY2hvaWNlIHNlbGVjdDItbG9ja2VkJz48ZGl2PjwvZGl2PjwvbGk+IiksbD1zP286YSxjPXRoaXMuaWQoZSksdT10aGlzLmdldFZhbCgpO249dGhpcy5vcHRzLmZvcm1hdFNlbGVjdGlvbihlLGwuZmluZCgiZGl2IiksdGhpcy5vcHRzLmVzY2FwZU1hcmt1cCksbiE9aSYmbC5maW5kKCJkaXYiKS5yZXBsYWNlV2l0aCgiPGRpdj4iK24rIjwvZGl2PiIpLHI9dGhpcy5vcHRzLmZvcm1hdFNlbGVjdGlvbkNzc0NsYXNzKGUsbC5maW5kKCJkaXYiKSksciE9aSYmbC5hZGRDbGFzcyhyKSxzJiZsLmZpbmQoIi5zZWxlY3QyLXNlYXJjaC1jaG9pY2UtY2xvc2UiKS5vbigibW91c2Vkb3duIixfKS5vbigiY2xpY2sgZGJsY2xpY2siLHRoaXMuYmluZChmdW5jdGlvbihlKXt0aGlzLmlzSW50ZXJmYWNlRW5hYmxlZCgpJiYodGhpcy51bnNlbGVjdCh0KGUudGFyZ2V0KSksdGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZS1mb2N1cyIpLnJlbW92ZUNsYXNzKCJzZWxlY3QyLXNlYXJjaC1jaG9pY2UtZm9jdXMiKSxfKGUpLHRoaXMuY2xvc2UoKSx0aGlzLmZvY3VzU2VhcmNoKCkpfSkpLm9uKCJmb2N1cyIsdGhpcy5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmKHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLmRyb3Bkb3duLmFkZENsYXNzKCJzZWxlY3QyLWRyb3AtYWN0aXZlIikpfSkpLGwuZGF0YSgic2VsZWN0Mi1kYXRhIixlKSxsLmluc2VydEJlZm9yZSh0aGlzLnNlYXJjaENvbnRhaW5lciksdS5wdXNoKGMpLHRoaXMuc2V0VmFsKHUpfSx1bnNlbGVjdDpmdW5jdGlvbihlKXt2YXIgaSxuLHI9dGhpcy5nZXRWYWwoKTtpZihlPWUuY2xvc2VzdCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZSIpLDA9PT1lLmxlbmd0aCl0aHJvdyJJbnZhbGlkIGFyZ3VtZW50OiAiK2UrIi4gTXVzdCA=", "base64"));
  res.write(new Buffer("YmUgLnNlbGVjdDItc2VhcmNoLWNob2ljZSI7aWYoaT1lLmRhdGEoInNlbGVjdDItZGF0YSIpKXt2YXIgbz10LkV2ZW50KCJzZWxlY3QyLXJlbW92aW5nIik7aWYoby52YWw9dGhpcy5pZChpKSxvLmNob2ljZT1pLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIobyksby5pc0RlZmF1bHRQcmV2ZW50ZWQoKSlyZXR1cm4hMTtmb3IoOyhuPXModGhpcy5pZChpKSxyKSk+PTA7KXIuc3BsaWNlKG4sMSksdGhpcy5zZXRWYWwociksdGhpcy5zZWxlY3QmJnRoaXMucG9zdHByb2Nlc3NSZXN1bHRzKCk7cmV0dXJuIGUucmVtb3ZlKCksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih7dHlwZToic2VsZWN0Mi1yZW1vdmVkIix2YWw6dGhpcy5pZChpKSxjaG9pY2U6aX0pLHRoaXMudHJpZ2dlckNoYW5nZSh7cmVtb3ZlZDppfSksITB9fSxwb3N0cHJvY2Vzc1Jlc3VsdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuZ2V0VmFsKCkscj10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItcmVzdWx0Iiksbz10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItcmVzdWx0LXdpdGgtY2hpbGRyZW4iKSxhPXRoaXM7ci5lYWNoMihmdW5jdGlvbih0LGUpe3ZhciBpPWEuaWQoZS5kYXRhKCJzZWxlY3QyLWRhdGEiKSk7cyhpLG4pPj0wJiYoZS5hZGRDbGFzcygic2VsZWN0Mi1zZWxlY3RlZCIpLGUuZmluZCgiLnNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiKS5hZGRDbGFzcygic2VsZWN0Mi1zZWxlY3RlZCIpKX0pLG8uZWFjaDIoZnVuY3Rpb24odCxlKXtlLmlzKCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZSIpfHwwIT09ZS5maW5kKCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZTpub3QoLnNlbGVjdDItc2VsZWN0ZWQpIikubGVuZ3RofHxlLmFkZENsYXNzKCJzZWxlY3QyLXNlbGVjdGVkIil9KSx0aGlzLmhpZ2hsaWdodCgpPT0tMSYmaSE9PSExJiZhLmhpZ2hsaWdodCgwKSwhdGhpcy5vcHRzLmNyZWF0ZVNlYXJjaENob2ljZSYmIXIuZmlsdGVyKCIuc2VsZWN0Mi1yZXN1bHQ6bm90KC5zZWxlY3QyLXNlbGVjdGVkKSIpLmxlbmd0aD4wJiYoIXR8fHQmJiF0Lm1vcmUmJjA9PT10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItbm8tcmVzdWx0cyIpLmxlbmd0aCkmJlMoYS5vcHRzLmZvcm1hdE5vTWF0Y2hlcywiZm9ybWF0Tm9NYXRjaGVzIikmJnRoaXMucmVzdWx0cy5hcHBlbmQoIjxsaSBjbGFzcz0nc2VsZWN0Mi1uby1yZXN1bHRzJz4iK0woYS5vcHRzLmZvcm1hdE5vTWF0Y2hlcyxhLm9wdHMuZWxlbWVudCxhLnNlYXJjaC52YWwoKSkrIjwvbGk+Iil9LGdldE1heFNlYXJjaFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0aW9uLndpZHRoKCktYyh0aGlzLnNlYXJjaCl9LHJlc2l6ZVNlYXJjaDpmdW5jdGlvbigpe3ZhciB0LGUsaSxuLHIscz1jKHRoaXMuc2VhcmNoKTt0PXYodGhpcy5zZWFyY2gpKzEwLGU9dGhpcy5zZWFyY2gub2Zmc2V0KCkubGVmdCxpPXRoaXMuc2VsZWN0aW9uLndpZHRoKCksbj10aGlzLnNlbGVjdGlvbi5vZmZzZXQoKS5sZWZ0LHI9aS0oZS1uKS1zLHI8dCYmKHI9aS1zKSxyPDQwJiYocj1pLXMpLHI8PTAmJihyPXQpLHRoaXMuc2VhcmNoLndpZHRoKE1hdGguZmxvb3IocikpfSxnZXRWYWw6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5zZWxlY3Q/KHQ9dGhpcy5zZWxlY3QudmFsKCksbnVsbD09PXQ/W106dCk6KHQ9dGhpcy5vcHRzLmVsZW1lbnQudmFsKCksbCh0LHRoaXMub3B0cy5zZXBhcmF0b3IpKX0sc2V0VmFsOmZ1bmN0aW9uKGUpe3ZhciBpO3RoaXMuc2VsZWN0P3RoaXMuc2VsZWN0LnZhbChlKTooaT1bXSx0KGUpLmVhY2goZnVuY3Rpb24oKXtzKHRoaXMsaSk8MCYmaS5wdXNoKHRoaXMpfSksdGhpcy5vcHRzLmVsZW1lbnQudmFsKDA9PT1pLmxlbmd0aD8iIjppLmpvaW4odGhpcy5vcHRzLnNlcGFyYXRvcikpKX0sYnVpbGRDaGFuZ2VEZXRhaWxzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBlPWUuc2xpY2UoMCksdD10LnNsaWNlKDApLGk9MDtpPGUubGVuZ3RoO2krKylmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKylhKHRoaXMub3B0cy5pZChlW2ldKSx0aGlzLm9wdHMuaWQodFtuXSkpJiYoZS5zcGxpY2UoaSwxKSxpPjAmJmktLSx0LnNwbGljZShuLDEpLG4tLSk7cmV0dXJue2FkZGVkOmUscmVtb3ZlZDp0fX0sdmFsOmZ1bmN0aW9uKGUsbil7dmFyIHIscz10aGlzO2lmKDA9PT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmdldFZhbCgpO2lmKHI9dGhpcy5kYXRhKCksci5sZW5ndGh8fChyPVtdKSwhZSYmMCE9PWUpcmV0dXJuIHRoaXMub3B0cy5lbGVtZW50LnZhbCgiIiksdGhpcy51cGRhdGVTZWxlY3Rpb24oW10pLHRoaXMuY2xlYXJTZWFyY2goKSx2b2lkKG4mJnRoaXMudHJpZ2dlckNoYW5nZSh7YWRkZWQ6dGhpcy5kYXRhKCkscmVtb3ZlZDpyfSkpO2lmKHRoaXMuc2V0VmFsKGUpLHRoaXMuc2VsZWN0KXRoaXMub3B0cy5pbml0U2VsZWN0aW9uKHRoaXMuc2VsZWN0LHRoaXMuYmluZCh0aGlzLnVwZGF0ZVNlbGVjdGlvbikpLG4mJnRoaXMudHJpZ2dlckNoYW5nZSh0aGlzLmJ1aWxkQ2hhbmdlRGV0YWlscyhyLHRoaXMuZGF0YSgpKSk7ZWxzZXtpZih0aGlzLm9wdHMuaW5pdFNlbGVjdGlvbj09PWkpdGhyb3cgbmV3IEVycm9yKCJ2YWwoKSBjYW5ub3QgYmUgY2FsbGVkIGlmIGluaXRTZWxlY3Rpb24oKSBpcyBub3QgZGVmaW5lZCIpO3RoaXMub3B0cy5pbml0U2VsZWN0aW9uKHRoaXMub3B0cy5lbGVtZW50LGZ1bmN0aW9uKGUpe3ZhciBpPXQubWFwKGUscy5pZCk7cy5zZXRWYWwoaSkscy51cGRhdGVTZWxlY3Rpb24oZSkscy5jbGVhclNlYXJjaCgpLG4mJnMudHJpZ2dlckNoYW5nZShzLmJ1aWxkQ2hhbmdlRGV0YWlscyhyLHMuZGF0YSgpKSl9KX10aGlzLmNsZWFyU2VhcmNoKCl9LG9uU29ydFN0YXJ0OmZ1bmN0aW9uKCl7aWYodGhpcy5zZWxlY3QpdGhyb3cgbmV3IEVycm9yKCJTb3J0aW5nIG9mIGVsZW1lbnRzIGlzIG5vdCBzdXBwb3J0ZWQgd2hlbiBhdHRhY2hlZCB0byA8c2VsZWN0Pi4gQXR0YWNoIHRvIDxpbnB1dCB0eXBlPSdoaWRkZW4nLz4gaW5zdGVhZC4iKTt0aGlzLnNlYXJjaC53aWR0aCgwKSx0aGlzLnNlYXJjaENvbnRhaW5lci5oaWRlKCl9LG9uU29ydEVuZDpmdW5jdGlvbigpe3ZhciBlPVtdLGk9dGhpczt0aGlzLnNlYXJjaENvbnRhaW5lci5zaG93KCksdGhpcy5zZWFyY2hDb250YWluZXIuYXBwZW5kVG8odGhpcy5zZWFyY2hDb250YWluZXIucGFyZW50KCkpLHRoaXMucmVzaXplU2VhcmNoKCksdGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZSIpLmVhY2goZnVuY3Rpb24oKXtlLnB1c2goaS5vcHRzLmlkKHQodGhpcykuZGF0YSgic2VsZWN0Mi1kYXRhIikpKX0pLHRoaXMuc2V0VmFsKGUpLHRoaXMudHJpZ2dlckNoYW5nZSgpfSxkYXRhOmZ1bmN0aW9uKGUsaSl7dmFyIG4scixzPXRoaXM7cmV0dXJuIDA9PT1hcmd1bWVudHMubGVuZ3RoP3RoaXMuc2VsZWN0aW9uLmNoaWxkcmVuKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlIikubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHQodGhpcykuZGF0YSgic2VsZWN0Mi1kYXRhIil9KS5nZXQoKToocj10aGlzLmRhdGEoKSxlfHwoZT1bXSksbj10Lm1hcChlLGZ1bmN0aW9uKHQpe3JldHVybiBzLm9wdHMuaWQodCl9KSx0aGlzLnNldFZhbChuKSx0aGlzLnVwZGF0ZVNlbGVjdGlvbihlKSx0aGlzLmNsZWFyU2VhcmNoKCksaSYmdGhpcy50cmlnZ2VyQ2hhbmdlKHRoaXMuYnVpbGRDaGFuZ2VEZXRhaWxzKHIsdGhpcy5kYXRhKCkpKSx2b2lkIDApfX0pLHQuZm4uc2VsZWN0Mj1mdW5jdGlvbigpe3ZhciBuLHIsbyxhLGwsYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksdT1bInZhbCIsImRlc3Ryb3kiLCJvcGVuZWQiLCJvcGVuIiwiY2xvc2UiLCJmb2N1cyIsImlzRm9jdXNlZCIsImNvbnRhaW5lciIsImRyb3Bkb3duIiwib25Tb3J0U3RhcnQiLCJvblNvcnRFbmQiLCJlbmFibGUiLCJkaXNhYmxlIiwicmVhZG9ubHkiLCJwb3NpdGlvbkRyb3Bkb3duIiwiZGF0YSIsInNlYXJjaCJdLGQ9WyJvcGVuZWQiLCJpc0ZvY3VzZWQiLCJjb250YWluZXIiLCJkcm9wZG93biJdLGg9WyJ2YWwiLCJkYXRhIl0scD17c2VhcmNoOiJleHRlcm5hbFNlYXJjaCJ9O3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZigwPT09Yy5sZW5ndGh8fCJvYmplY3QiPT10eXBlb2YgY1swXSluPTA9PT1jLmxlbmd0aD97fTp0LmV4dGVuZCh7fSxjWzBdKSxuLmVsZW1lbnQ9dCh0aGlzKSwic2VsZWN0Ij09PW4uZWxlbWVudC5nZXQoMCkudGFnTmFtZS50b0xvd2VyQ2FzZSgpP2w9bi5lbGVtZW50LnByb3AoIm11bHRpcGxlIik6KGw9bi5tdWx0aXBsZXx8ITEsInRhZ3MiaW4gbiYmKG4ubXVsdGlwbGU9bD0hMCkpLHI9bD9uZXcgZVsiY2xhc3MiXS5tdWx0aTpuZXcgZVsiY2xhc3MiXS5zaW5nbGUsci5pbml0KG4pO2Vsc2V7aWYoInN0cmluZyIhPXR5cGVvZiBjWzBdKXRocm93IkludmFsaWQgYXJndW1lbnRzIHRvIHNlbGVjdDIgcGx1Z2luOiAiK2M7aWYocyhjWzBdLHUpPDApdGhyb3ciVW5rbm93biBtZXRob2Q6ICIrY1swXTtpZihhPWkscj10KHRoaXMpLmRhdGEoInNlbGVjdDIiKSxyPT09aSlyZXR1cm47aWYobz1jWzBdLCJjb250YWluZXIiPT09bz9hPXIuY29udGFpbmVyOiJkcm9wZG93biI9PT1vP2E9ci5kcm9wZG93bjoocFtvXSYmKG89cFtvXSksYT1yW29dLmFwcGx5KHIsYy5zbGljZSgxKSkpLHMoY1swXSxkKT49MHx8cyhjWzBdLGgpPj0wJiYxPT1jLmxlbmd0aClyZXR1cm4hMX19KSxhPT09aT90aGlzOmF9LHQuZm4uc2VsZWN0Mi5kZWZhdWx0cz17d2lkdGg6ImNvcHkiLGxvYWRNb3JlUGFkZGluZzowLGNsb3NlT25TZWxlY3Q6ITAsb3Blbk9uRW50ZXI6ITAsY29udGFpbmVyQ3NzOnt9LGRyb3Bkb3duQ3NzOnt9LGNvbnRhaW5lckNzc0NsYXNzOiIiLGRyb3Bkb3duQ3NzQ2xhc3M6IiIsZm9ybWF0UmVzdWx0OmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPVtdO3JldHVybiBiKHRoaXMudGV4dCh0KSxpLnRlcm0scixuKSxyLmpvaW4oIiIpfSxmb3JtYXRTZWxlY3Rpb246ZnVuY3Rpb24odCxlLG4pe3JldHVybiB0P24odGhpcy50ZXh0KHQpKTppfSxzb3J0UmVzdWx0czpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHR9LGZvcm1hdFJlc3VsdENzc0NsYXNzOmZ1bmN0aW9uKHQpe3JldHVybiB0LmNzc30sZm9ybWF0U2VsZWN0aW9uQ3NzQ2xhc3M6ZnVuY3Rpb24odCxlKXtyZXR1cm4gaX0sbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6MCxtaW5pbXVtSW5wdXRMZW5ndGg6MCxtYXhpbXVtSW5wdXRMZW5ndGg6bnVsbCxtYXhpbXVtU2VsZWN0aW9uU2l6ZTowLGlkOmZ1bmN0aW9uKHQpe3JldHVybiB0PT1pP251bGw6dC5pZH0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5kYXRhJiZ0aGlzLmRhdGEudGV4dD90LmlzRnVuY3Rpb24odGhpcy5kYXRhLnRleHQpP3RoaXMuZGF0YS50ZXh0KGUpOmVbdGhpcy5kYXRhLnRleHRdOmUudGV4dH0sbWF0Y2hlcjpmdW5jdGlvbih0LGUpe3JldHVybiByKCIiK2UpLnRvVXBwZXJDYXNlKCkuaW5kZXhPZihyKCIiK3QpLnRvVXBwZXJDYXNlKCkpPj0wfSxzZXBhcmF0b3I6IiwiLHRva2VuU2VwYXJhdG9yczpbXSx0b2tlbml6ZXI6RSxlc2NhcGVNYXJrdXA6dyxibHVyT25DaGFuZ2U6ITEsc2VsZWN0T25CbHVyOiExLGFkYXB0Q29udGFpbmVyQ3NzQ2xhc3M6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LGFkYXB0RHJvcGRvd25Dc3NDbGFzczpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbH0sbmV4dFNlYXJjaFRlcm06ZnVuY3Rpb24odCxlKXtyZXR1cm4gaX0sc2VhcmNoSW5wdXRQbGFjZWhvbGRlcjoiIixjcmVhdGVTZWFyY2hDaG9pY2VQb3NpdGlvbjoidG9wIixzaG91bGRGb2N1c0lucHV0OmZ1bmN0aW9uKHQpe3ZhciBlPSJvbnRvdWNoc3RhcnQiaW4gd2luZG93fHxuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cz4wO3JldHVybiFlfHwhKHQub3B0cy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaDwwKX19LHQuZm4uc2VsZWN0Mi5sb2NhbGVzPVtdLHQuZm4uc2VsZWN0Mi5sb2NhbGVzLmVuPXtmb3JtYXRNYXRjaGVzOmZ1bmN0aW9uKHQpe3JldHVybiAxPT09dD8iT25lIHJlc3VsdCBpcyBhdmFpbGFibGUsIHByZXNzIGVudGVyIHRvIHNlbGVjdCBpdC4iOnQrIiByZXN1bHRzIGFyZSBhdmFpbGFibGUsIHVzZSB1cCBhbmQgZG93biBhcnJvdyBrZXlzIHRvIG5hdmlnYXRlLiJ9LGZvcm1hdE5vTWF0Y2hlczpmdW5jdGlvbigpe3JldHVybiJObyBtYXRjaGVzIGZvdW5kIn0sZm9ybWF0QWpheEVycm9yOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4iTG9hZGluZyBmYWlsZWQifSxmb3JtYXRJbnB1dFRvb1Nob3J0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS10Lmxlbmd0aDtyZXR1cm4iUGxlYXNlIGVudGVyICIraSsiIG9yIG1vcmUgY2hhcmFjdGVyIisoMT09aT8iIjoicyIpfSxmb3JtYXRJbnB1dFRvb0xvbmc6ZnVuY3Rpb24odCxlKXt2YXIgaT10Lmxlbmd0aC1lO3JldHVybiJQbGVhc2UgZGVsZXRlICIraSsiIGNoYXJhY3RlciIrKDE9PWk/IiI6InMiKX0sZm9ybWF0U2VsZWN0aW9uVG9vQmlnOmZ1bmN0aW9uKHQpe3JldHVybiJZb3UgY2FuIG9ubHkgc2VsZWN0ICIrdCsiIGl0ZW0iKygxPT10PyIiOiJzIil9LGZvcm1hdExvYWRNb3JlOmZ1bmN0aW9uKHQpe3JldHVybiJMb2FkaW5nIG1vcmUgcmVzdWx0c+KApiJ9LGZvcm1hdFNlYXJjaGluZzpmdW5jdGlvbigpe3JldHVybiJTZWFyY2hpbmfigKYifX0sdC5leHRlbmQodC5mbi5zZWxlY3QyLmRlZmF1bHRzLHQuZm4uc2VsZWN0Mi5sb2NhbGVzLmVuKSx0LmZuLnNlbGVjdDIuYWpheERlZmF1bHRzPXt0cmFuc3BvcnQ6dC5hamF4LHBhcmFtczp7dHlwZToiR0VUIixjYWNoZTohMSxkYXRhVHlwZToianNvbiJ9fSxlPXtxdWVyeTp7YWpheDpNLGxvY2FsOmssdGFnczpUfSx1dGlsOntkZWJvdW5jZTpoLG1hcmtNYXRjaDpiLGVzY2FwZU1hcmt1cDp3LHN0cmlwRGlhY3JpdGljczpyfSwiY2xhc3MiOnsiYWJzdHJhY3QiOkEsc2luZ2xlOk8sbXVsdGk6Tn19fX0odCksZX0uYXBwbHkoZSxuKSwvKgoJCUNvcHlyaWdodCAyMDEyIElnb3IgVmF5bmJlcmcKCgkJVmVyc2lvbjogQEB2ZXJAQCBUaW1lc3RhbXA6IEBAdGltZXN0YW1wQEAKCgkJVGhpcyBzb2Z0d2FyZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkFwYWNoZSBMaWNlbnNlIikgb3IgdGhlIEdOVQoJCUdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbiAyICh0aGUgIkdQTCBMaWNlbnNlIikuIFlvdSBtYXkgY2hvb3NlIGVpdGhlciBsaWNlbnNlIHRvIGdvdmVybiB5b3VyCgkJdXNlIG9mIHRoaXMgc29mdHdhcmUgb25seSB1cG9uIHRoZSBjb25kaXRpb24gdGhhdCB5b3UgYWNjZXB0IGFsbCBvZiB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBBcGFjaGUKCQlMaWNlbnNlIG9yIHRoZSBHUEwgTGljZW5zZS4KCgkJWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBBcGFjaGUgTGljZW5zZSBhbmQgdGhlIEdQTCBMaWNlbnNlIGF0OgoKCQkgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkJICAgIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWwKCgkJVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUKCQlBcGFjaGUgTGljZW5zZSBvciB0aGUgR1BMIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SCgkJQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBBcGFjaGUgTGljZW5zZSBhbmQgdGhlIEdQTCBMaWNlbnNlIGZvcgoJCXRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSBhbmQgdGhlIEdQTCBMaWNlbnNlLgoJCSovCgkhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTg1KSxpKDE4NCldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm57VGFiOnQsVGFiczplfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDI4NSksaSgyODYpLGkoMjg3KV0scj1mdW5jdGlvbih0LGUsaSl7cmV0dXJue0ZpbGVVcGxvYWQ6dCxVcGxvYWRlcjplLFVwbG9hZElmcmFtZTppfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMTQ3KSxpKDE0NildLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWUudHBsKCdcdCAgICA8aW5wdXQgdHlwZT0iZmlsZSIgbmFtZT0iZmlsZSIgY2xhc3M9Im0tZmlsZSI+XHQgICAgPGRpdiBjbGFzcz0iZmFjYWRlIj5cdCAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0idGV4dC1maWVsZC1kZWZhdWx0IiBkaXNhYmxlZD5cdCAgICAgIHt7e2ltZyBzcmM9Ii9pbWcvdWkvYnV0dG9uL2ZpbGUtYnJvd3NlLTAxLnBuZyIgYWx0PSJCcm93c2UgZmlsZXMuLi4iIGNsYXNzPSJicm93c2UifX19XHQgICAgPC9kaXY+XHQgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgY2xhc3M9ImhpZGUiIG5hbWU9Il94c3JmVG9rZW4iIHZhbHVlPSJ7e3Rva2VufX0iPlx0ICAnKSxyPWkuZXh0ZW5kKHt0ZW1wbGF0ZTpuLGNsYXNzTmFtZToiZmlsZS1pbnB1dC1mYWNhZGUgbWFyZ2luLXRvcC0xMCBtYXJnaW4tYnRtLTEwIGNsZWFyZml4IixldmVudHM6eyJjaGFuZ2UgLm0tZmlsZSI6InVwZGF0ZURpc3BsYXlWYWwifSx1cGRhdGVEaXNwbGF5VmFsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRGaWxlbmFtZSgpO3QubWF0Y2goL15DOlxcZmFrZXBhdGgvKSYmKHQ9dC5yZXBsYWNlKCJDOlxcZmFrZXBhdGhcXCIsIiIpKSx0aGlzLnVwZGF0ZURpc3BsYXkodCl9LHVwZGF0ZURpc3BsYXk6ZnVuY3Rpb24odCl7dGhpcy4kKCIudGV4dC1maWVsZC1kZWZhdWx0IikudmFsKHQpfSxnZXRGaWxlbmFtZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIi5tLWZpbGUiKS52YWwoKX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGU9dCgiI194c3JmVG9rZW4iKS50ZXh0KCk7cmV0dXJuIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSh7dG9rZW46ZX0pKSx0aGlzfX0pO3JldHVybiByfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTY5KSxpKDE0NiksaSgyODcpLGkoMjg4KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1lLmV4dGVuZCh7Y2xhc3NOYW1lOiJ1cGxvYWQtaG9sZGVyIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWZyYW1lPW5ldyBpKHtuYW1lOnRoaXMuY2lkfSksdGhpcy5hZGQodGhpcy5pZnJhbWUsbnVsbCwhMCksdGhpcy51cGxvYWRGb3JtPW5ldyBuKHt0YXJnZXQ6dGhpcy5jaWQsZW5kcG9pbnQ6dGhpcy5vcHRpb25zLmVuZHBvaW50fSksdGhpcy5hZGQodGhpcy51cGxvYWRGb3JtLG51bGwsITApLHRoaXMubGlzdGVuVG8odGhpcy5pZnJhbWUsdC5VUExPQURfRE9ORSxmdW5jdGlvbigpe3RoaXMudXBsb2FkRm9ybS51cGxvYWREb25lKCl9KSx0aGlzfX0pO3JldHVybiByfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTY5KSxpKDE0NiksaSg3KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPWUuZXh0ZW5kKHt0YWdOYW1lOiJpZnJhbWUiLGNsYXNzTmFtZToiaGlkZSIsYXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybntuYW1lOnRoaXMub3B0aW9ucy5uYW1lLGlkOnRoaXMub3B0aW9ucy5uYW1lfX0sZXZlbnRzOntsb2FkOmZ1bmN0aW9uKCl7dHJ5e3ZhciBlPXRoaXMuJGVsLmNvbnRlbnRzKCkudGV4dCgpO2lmKGUpcmV0dXJuIHZvaWQgdGhpcy50cmlnZ2VyKHQuVVBMT0FEX0RPTkUsSlNPTi5wYXJzZShlKSl9Y2F0Y2goaSl7fXRoaXMudHJpZ2dlcih0LlVQTE9BRF9FTVBUWV9DT05URU5UKX19fSk7cmV0dXJuIGl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpLGkoMjg1KSxpKDI4OSldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQuZXh0ZW5kKHt0YWdOYW1lOiJmb3JtIixjbGFzc05hbWU6ImNsZWFyZml4IHBhZGRpbmctYnRtLTEwIixhdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJue21ldGhvZDoicG9zdCIsZW5jdHlwZToibXVsdGlwYXJ0L2Zvcm0tZGF0YSIsYWN0aW9uOnRoaXMub3B0aW9ucy5lbmRwb2ludCx0YXJnZXQ6dGhpcy5vcHRpb25zLnRhcmdldH19LGV2ZW50czp7c3VibWl0OmZ1bmN0aW9uKCl7dGhpcy5zdWJtaXRCdG4uZGlzYWJsZSghMCl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsZVVwbG9hZD1uZXcgZSx0aGlzLmFkZCh0aGlzLmZpbGVVcGxvYWQpLHRoaXMuc3VibWl0QnRuPW5ldyBpLHRoaXMuYWRkKHRoaXMuc3VibWl0QnRuKSx0aGlzfSx1cGxvYWREb25lOmZ1bmN0aW9uKCl7dGhpcy5zdWJtaXRCdG4uZGlzYWJsZSghMSl9fSk7cmV0dXJuIG59LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZXh0ZW5kKHt0YWdOYW1lOiJpbnB1dCIsY2xhc3NOYW1lOiJidXR0b24iLGF0dHJpYnV0ZXM6e3R5cGU6InN1Ym1pdCIsdmFsdWU6IlVwbG9hZCBMb2dvIn0sZGlzYWJsZTpmdW5jdGlvbih0KXt0aGlzLiRlbC5wcm9wKCJkaXNhYmxlZCIsdCl9fSk7cmV0dXJuIGV9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMDgpLGkoMzU5KSxpKDMxOCksaSgzMjEpLGkoMzMyKSxpKDMzNiksaSgzMzgpLGkoMzQxKSxpKDM0MyksaSgzNDQpLGkoMzQ1KSxpKDM0NiksaSgzNDcpLGkoMzQ4KSxpKDM0OSksaSgzNTIpLGkoMzUzKSxpKDM1NCksaSgzNTUpLGkoMzU3KSxpKDI5MSksaSgzNjUpLGkoMzY2KSxpKDM2NyksaSgzNzApLGkoMzcxKSxpKDM3MyksaSgzNzQpLGkoMzc1KSxpKDM3NiksaSgzNzcpLGkoMzc4KSxpKDM3OSksaSgzODApLGkoMzEwKSxpKDM4MSksaSgzODgpLGkoMzE1KSxpKDM4OSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwsYyx1LGQsaCxwLGYsbSxfLGcsdix5LGIsdyxNLGssVCxTLEwseCxFLEQsWSxDLEEsTyxOLEksUCxSLEgpe3JldHVybiB0LmV4dGVuZCh7cm91dGVzOnsiIjoicHJpbWFyeUF1dGgiLHNpZ25pbjoicHJpbWFyeUF1dGgiLCJzaWduaW4vdmVyaWZ5L2R1by93ZWIiOiJ2ZXJpZnlEdW8iLCJzaWduaW4vdmVyaWZ5L2ZpZG8vd2ViYXV0aG4iOiJ2ZXJpZnlXaW5kb3dzSGVsbG8iLCJzaWduaW4vdmVyaWZ5L2ZpZG8vdTJmIjoidmVyaWZ5VTJGIiwic2lnbmluL3ZlcmlmeS86cHJvdmlkZXIvOmZhY3RvclR5cGUiOiJ2ZXJpZnkiLCJzaWduaW4vZW5yb2xsIjoiZW5yb2xsQ2hvaWNlcyIsInNpZ25pbi9lbnJvbGwvZHVvL3dlYiI6ImVucm9sbER1byIsInNpZ25pbi9lbnJvbGwvb2t0YS9xdWVzdGlvbiI6ImVucm9sbFF1ZXN0aW9uIiwic2lnbmluL2Vucm9sbC9va3RhL3NtcyI6ImVucm9sbFNtcyIsInNpZ25pbi9lbnJvbGwvb2t0YS9jYWxsIjoiZW5yb2xsQ2FsbCIsInNpZ25pbi9lbnJvbGwtYWN0aXZhdGUvb2t0YS9zbXMiOiJlbnJvbGxTbXMiLCJzaWduaW4vZW5yb2xsL3JzYS90b2tlbiI6ImVucm9sbFJzYSIsInNpZ25pbi9lbnJvbGwvZGVsX29hdGgvdG9rZW4iOiJlbnJvbGxPblByZW0iLCJzaWduaW4vZW5yb2xsL3N5bWFudGVjL3Rva2VuIjoiZW5yb2xsU3ltYW50ZWNWaXAiLCJzaWduaW4vZW5yb2xsL3l1Ymljby90b2tlbjpoYXJkd2FyZSI6ImVucm9sbFl1YmlrZXkiLCJzaWduaW4vZW5yb2xsL2ZpZG8vd2ViYXV0aG4iOiJlbnJvbGxXaW5kb3dzSGVsbG8iLCJzaWduaW4vZW5yb2xsL2ZpZG8vdTJmIjoiZW5yb2xsVTJGIiwic2lnbmluL2Vucm9sbC86cHJvdmlkZXIvOmZhY3RvclR5cGUiOiJlbnJvbGxUb3RwRmFjdG9yIiwic2lnbmluL2Vucm9sbC1hY3RpdmF0ZS9va3RhL3B1c2giOiJzY2FuQmFyY29kZVB1c2hGYWN0b3IiLCJzaWduaW4vZW5yb2xsLWFjdGl2YXRlL29rdGEvcHVzaC9tYW51YWwiOiJtYW51YWxTZXR1cFB1c2hGYWN0b3IiLCJzaWduaW4vZW5yb2xsLWFjdGl2YXRlL29rdGEvcHVzaC9zZW50IjoiYWN0aXZhdGlvbkxpbmtTZW50Iiwic2lnbmluL2Vucm9sbC1hY3RpdmF0ZS9va3RhL3Rva2VuOnNvZnR3YXJlOnRvdHAvcGFzc2NvZGUiOiJlbnRlclBhc3Njb2RlSW5QdXNoRW5yb2xsbWVudEZsb3ciLCJzaWduaW4vZW5yb2xsLWFjdGl2YXRlLzpwcm92aWRlci86ZmFjdG9yVHlwZSI6InNjYW5CYXJjb2RlVG90cEZhY3RvciIsInNpZ25pbi9lbnJvbGwtYWN0aXZhdGUvOnByb3ZpZGVyLzpmYWN0b3JUeXBlL2FjdGl2YXRlIjoiYWN0aXZhdGVUb3RwRmFjdG9yIiwic2lnbmluL2Vucm9sbC1hY3RpdmF0ZS86cHJvdmlkZXIvOmZhY3RvclR5cGUvbWFudWFsIjoibWFudWFsU2V0dXBUb3RwRmFjdG9yIiwic2lnbmluL3Bhc3N3b3JkLWV4cGlyZWQiOiJwYXNzd29yZEV4cGlyZWQiLCJzaWduaW4vY3VzdG9tLXBhc3N3b3JkLWV4cGlyZWQiOiJjdXN0b21QYXNzd29yZEV4cGlyZWQiLCJzaWduaW4vZm9yZ290LXBhc3N3b3JkIjoiZm9yZ290UGFzc3dvcmQiLCJzaWduaW4vcmVjb3ZlcnktY2hhbGxlbmdlIjoicmVjb3ZlcnlDaGFsbGVuZ2UiLCJzaWduaW4vcmVjb3ZlcnktZW1haWxlZCI6InJlY292ZXJ5RW1haWxTZW50Iiwic2lnbmluL3JlY292ZXJ5LXF1ZXN0aW9uIjoicmVjb3ZlcnlRdWVzdGlvbiIsInNpZ25pbi9wYXNzd29yZC1yZXNldCI6InBhc3N3b3JkUmVzZXQiLCJzaWduaW4vcmVzZXQtcGFzc3dvcmQvOnRva2VuIjoicmVjb3ZlcnlMb2FkaW5nIiwic2lnbmluL3VzZXItdW5sb2NrLzp0b2tlbiI6InJlY292ZXJ5TG9hZGluZyIsInNpZ25pbi9yZWNvdmVyeS86dG9rZW4iOiJyZWNvdmVyeUxvYWRpbmciLCJzaWduaW4vdW5sb2NrLWVtYWlsZWQiOiJ1bmxvY2tFbWFpbFNlbnQiLCJzaWduaW4vdW5sb2NrIjoidW5sb2NrQWNjb3VudCIsInNpZ25pbi9hY2NvdW50LXVubG9ja2VkIjoiYWNjb3VudFVubG9ja2VkIiwic2lnbmluL3JlZnJlc2gtYXV0aC1zdGF0ZSgvOnRva2VuKSI6InJlZnJlc2hBdXRoU3RhdGUiLCJzaWduaW4vcmVnaXN0ZXIiOiJyZWdpc3RlciIsInNpZ25pbi9yZWdpc3Rlci1jb21wbGV0ZSI6InJlZ2lzdGVyQ29tcGxldGUiLCIqd2lsZGNhcmQiOiJwcmltYXJ5QXV0aCJ9LHN0YXRlTGVzc1JvdXRlSGFuZGxlcnM6WyJwcmltYXJ5QXV0aCIsImZvcmdvdFBhc3N3b3JkIiwicmVjb3ZlcnlMb2FkaW5nIiwidW5sb2NrQWNjb3VudCIsInJlZnJlc2hBdXRoU3RhdGUiLCJyZWdpc3RlciIsInJlZ2lzdGVyQ29tcGxldGUiXSxwcmltYXJ5QXV0aDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGUse0JlYWNvbjpSfSl9LHZlcmlmeUR1bzpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGkse3Byb3ZpZGVyOiJEVU8iLGZhY3RvclR5cGU6IndlYiIsQmVhY29uOkh9KX0sdmVyaWZ5V2luZG93c0hlbGxvOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIocix7cHJvdmlkZXI6IkZJRE8iLGZhY3RvclR5cGU6IndlYmF1dGhuIixCZWFjb246SH0pfSx2ZXJpZnlVMkY6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihzLHtwcm92aWRlcjoiRklETyIsZmFjdG9yVHlwZToidTJmIixCZWFjb246SH0pfSx2ZXJpZnk6ZnVuY3Rpb24odCxlKXt0aGlzLnJlbmRlcihuLHtwcm92aWRlcjp0LnRvVXBwZXJDYXNlKCksZmFjdG9yVHlwZTplLEJlYWNvbjpIfSl9LGVucm9sbENob2ljZXM6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihvLHtCZWFjb246Un0pfSxlbnJvbGxEdW86ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihhLHtwcm92aWRlcjoiRFVPIixmYWN0b3JUeXBlOiJ3ZWIiLEJlYWNvbjpIfSl9LGVucm9sbFF1ZXN0aW9uOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIobCx7cHJvdmlkZXI6Ik9LVEEiLGZhY3RvclR5cGU6InF1ZXN0aW9uIixCZWFjb246SH0pfSxlbnJvbGxTbXM6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcih1LHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToic21zIixCZWFjb246SH0pfSxlbnJvbGxDYWxsOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIodSx7cHJvdmlkZXI6Ik9LVEEiLGZhY3RvclR5cGU6ImNhbGwiLEJlYWNvbjpIfSl9LGVucm9sbFJzYTpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGQse3Byb3ZpZGVyOiJSU0EiLGZhY3RvclR5cGU6InRva2VuIixCZWFjb246SH0pfSxlbnJvbGxPblByZW06ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihkLHtwcm92aWRlcjoiREVMX09BVEgiLGZhY3RvclR5cGU6InRva2VuIixCZWFjb246SH0pfSxlbnJvbGxTeW1hbnRlY1ZpcDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGgse3Byb3ZpZGVyOiJTWU1BTlRFQyIsZmFjdG9yVHlwZToidG9rZW4iLEJlYWNvbjpIfSl9LGVucm9sbFl1YmlrZXk6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihwLHtwcm92aWRlcjoiWVVCSUNPIixmYWN0b3JUeXBlOiJ0b2tlbjpoYXJkd2FyZSIsQmVhY29uOkh9KX0sZW5yb2xsVG90cEZhY3RvcjpmdW5jdGlvbih0LGUpe3RoaXMucmVuZGVyKGYse3Byb3ZpZGVyOnQudG9VcHBlckNhc2UoKSxmYWN0b3JUeXBlOmUsQmVhY29uOkh9KX0sZW5yb2xsV2luZG93c0hlbGxvOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoYyx7cHJvdmlkZXI6IkZJRE8iLGZhY3RvclR5cGU6IndlYmF1dGhuIixCZWFjb246SH0pfSxlbnJvbGxVMkY6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihtLHtwcm92aWRlcjoiRklETyIsZmFjdG9yVHlwZToidTJmIixCZWFjb246SH0pfSxzY2FuQmFyY29kZVRvdHBGYWN0b3I6ZnVuY3Rpb24odCxlKXt0aGlzLnJlbmRlcihfLHtwcm92aWRlcjp0LnRvVXBwZXJDYXNlKCksZmFjdG9yVHlwZTplLEJlYWNvbjpIfSl9LHNjYW5CYXJjb2RlUHVzaEZhY3RvcjpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGcse3Byb3ZpZGVyOiJPS1RBIixmYWN0b3JUeXBlOiJwdXNoIixCZWFjb246SH0pfSxhY3RpdmF0ZVRvdHBGYWN0b3I6ZnVuY3Rpb24odCxlKXt0aGlzLnJlbmRlcih2LHtwcm92aWRlcjp0LnRvVXBwZXJDYXNlKCksZmFjdG9yVHlwZTplLEJlYWNvbjpIfSl9LG1hbnVhbFNldHVwVG90cEZhY3RvcjpmdW5jdGlvbih0LGUpe3RoaXMucmVuZGVyKHkse3Byb3ZpZGVyOnQudG9VcHBlckNhc2UoKSxmYWN0b3JUeXBlOmUsQmVhY29uOkh9KX0sbWFudWFsU2V0dXBQdXNoRmFjdG9yOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoYix7cHJvdmlkZXI6Ik9LVEEiLGZhY3RvclR5cGU6InB1c2giLEJlYWNvbjpIfSl9LGFjdGl2YXRpb25MaW5rU2VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKHcse3Byb3ZpZGVyOiJPS1RBIixmYWN0b3JUeXBlOiJwdXNoIixCZWFjb246SH0pfSxlbnRlclBhc3Njb2RlSW5QdXNoRW5yb2xsbWVudEZsb3c6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihNLHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToidG9rZW46c29mdHdhcmU6dG90cCIsQmVhY29uOkh9KX0scGFzc3dvcmRFeHBpcmVkOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoayx7QmVhY29uOlJ9KX0sY3VzdG9tUGFzc3dvcmRFeHBpcmVkOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoVCx7QmVhY29uOlJ9KX0sZm9yZ290UGFzc3dvcmQ6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihTKX0scmVjb3ZlcnlDaGFsbGVuZ2U6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihMLHtCZWFjb246Un0pfSxyZWNvdmVyeUVtYWlsU2VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKHgse0JlYWNvbjpSfSl9LHVubG9ja0VtYWlsU2VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKE8se0JlYWNvbjpSfSl9LHJlY292ZXJ5UXVlc3Rpb246ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihFLHtCZWFjb246Un0pfSxwYXNzd29yZFJlc2V0OmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoRCx7QmVhY29uOlJ9KX0scmVjb3ZlcnlMb2FkaW5nOmZ1bmN0aW9uKHQpe3RoaXMucmVuZGVyKFkse3Rva2VuOnQsQmVhY29uOlJ9KX0sdW5sb2NrQWNjb3VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKEMpfSxhY2NvdW50VW5sb2NrZWQ6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihBLHtCZWFjb246Un0pfSxyZWZyZXNoQXV0aFN0YXRlOmZ1bmN0aW9uKHQpe3RoaXMucmVuZGVyKE4se3Rva2VuOnQsQmVhY29uOlJ9KX0scmVnaXN0ZXI6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihJKX0scmVnaXN0ZXJDb21wbGV0ZTpmdW5jdGlvbigpe3RoaXMucmVuZGVyKFApfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjkyKSxpKDI5NCksaSgyOTUpLGkoMjk2KSxpKDI5OSksaSgzMDQpLGkoMzA1KSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwpe2Z1bmN0aW9uIGModCxlKXt2YXIgaT1zLmNyZWF0ZUFjdGl2YXRlRmFjdG9yVXJsKHQub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvclByb3ZpZGVyIiksdC5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9yVHlwZSIpLGUpO3Qub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsaSl9ZnVuY3Rpb24gdSh0KXt2YXIgZSxpOyJTTVMiPT09dC5tb2RlbC5nZXQoImFjdGl2YXRpb25UeXBlIikmJihpPXQubW9kZWwuZ2V0KCJjb3VudHJ5Q29kZSIpLGU9dC5tb2RlbC5nZXQoInBob25lTnVtYmVyIikpLHQub3B0aW9ucy5hcHBTdGF0ZS5zZXQoe2ZhY3RvckFjdGl2YXRpb25UeXBlOnQubW9kZWwuZ2V0KCJhY3RpdmF0aW9uVHlwZSIpLHVzZXJDb3VudHJ5Q29kZTppLHVzZXJQaG9uZU51bWJlcjplfSl9ZnVuY3Rpb24gZCh0LGUpe3JldHVybiB0Lm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24oaSl7cmV0dXJuIGkucHJldigpLnRoZW4oZnVuY3Rpb24odCl7dmFyIGk9aC5maW5kV2hlcmUodC5mYWN0b3JzLHtmYWN0b3JUeXBlOmUscHJvdmlkZXI6Ik9LVEEifSk7cmV0dXJuIGkuZW5yb2xsKCl9KS50aGVuKGZ1bmN0aW9uKGUpe3ZhciBpLG4scixzPWUuZGF0YTtpZihzJiZzLl9lbWJlZGRlZCYmcy5fZW1iZWRkZWQuZmFjdG9yJiZzLl9lbWJlZGRlZC5mYWN0b3IuX2VtYmVkZGVkJiZzLl9lbWJlZGRlZC5mYWN0b3IuX2VtYmVkZGVkLmFjdGl2YXRpb24pe3ZhciBvPXMuX2VtYmVkZGVkLmZhY3RvcjtpZihyPW8uX2VtYmVkZGVkLmFjdGl2YXRpb24uc2hhcmVkU2VjcmV0LG8uX2VtYmVkZGVkLmFjdGl2YXRpb24uX2xpbmtzJiZvLl9lbWJlZGRlZC5hY3RpdmF0aW9uLl9saW5rcy5zZW5kKXt2YXIgYT1vLl9lbWJlZGRlZC5hY3RpdmF0aW9uLl9saW5rcy5zZW5kLGw9aC5maW5kV2hlcmUoYSx7bmFtZToic21zIn0pO2k9bD9sLmhyZWY6bnVsbDt2YXIgYz1oLmZpbmRXaGVyZShhLHtuYW1lOiJlbWFpbCJ9KTtuPWM/Yy5ocmVmOm51bGx9fXJldHVybiB0Lm1vZGVsLnNldCh7U01TOmksRU1BSUw6bixzaGFyZWRTZWNyZXQ6cn0pLGV9KX0pfXZhciBoPXQuXztyZXR1cm4gbi5leHRlbmQoe2NsYXNzTmFtZToiZW5yb2xsLW1hbnVhbC1wdXNoIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntsb2NhbDp7YWN0aXZhdGlvblR5cGU6WyJzdHJpbmciLCEwLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvckFjdGl2YXRpb25UeXBlIil8fCJTTVMiXSxjb3VudHJ5Q29kZTpbInN0cmluZyIsITEsIlVTIl0scGhvbmVOdW1iZXI6InN0cmluZyIsU01TOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ0ZXh0QWN0aXZhdGlvbkxpbmtVcmwiKV0sRU1BSUw6WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImVtYWlsQWN0aXZhdGlvbkxpbmtVcmwiKV0sc2hhcmVkU2VjcmV0Olsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJzaGFyZWRTZWNyZXQiKV0sX19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19LGRlcml2ZWQ6e2NvdW50cnlDYWxsaW5nQ29kZTp7ZGVwczpbImNvdW50cnlDb2RlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIisiK2UuZ2V0Q2FsbGluZ0NvZGVGb3JDb3VudHJ5KHQpfX0sZnVsbFBob25lTnVtYmVyOntkZXBzOlsiY291bnRyeUNhbGxpbmdDb2RlIiwicGhvbmVOdW1iZXIiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiB0K2V9fX19fSxGb3JtOnt0aXRsZTpmdW5jdGlvbigpe3ZhciBlPWkuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gdC5sb2MoImVucm9sbC50b3RwLnRpdGxlIiwibG9naW4iLFtlXSl9LHN1YnRpdGxlOmgucGFydGlhbCh0LmxvYywiZW5yb2xsLnRvdHAuY2Fubm90U2NhbkJhcmNvZGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic3RlcC1tYW51YWwtc2V0dXAifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgaT1bci5JbnB1dCh7bmFtZToiYWN0aXZhdGlvblR5cGUiLHR5cGU6InNlbGVjdCIsd2lkZTohMCxvcHRpb25zOntTTVM6dC5sb2MoImVucm9sbC50b3RwLnNlbmRTbXMiLCJsb2dpbiIpLEVNQUlMOnQubG9jKCJlbnJvbGwudG90cC5zZW5kRW1haWwiLCJsb2dpbiIpLE1BTlVBTDp0LmxvYygiZW5yb2xsLnRvdHAuc2V0dXBNYW51YWxseSIsImxvZ2luIil9fSksci5JbnB1dCh7bmFtZToiY291bnRyeUNvZGUiLHR5cGU6InNlbGVjdCIsd2lkZTohMCxvcHRpb25zOmUuZ2V0Q291bnRyaWVzKCksc2hvd1doZW46e2FjdGl2YXRpb25UeXBlOiJTTVMifX0pLHIuSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJtZmEucGhvbmVOdW1iZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiZW5yb2xsLXNtcy1waG9uZSIsbmFtZToicGhvbmVOdW1iZXIiLGlucHV0OmEsdHlwZToidGV4dCIsc2hvd1doZW46e2FjdGl2YXRpb25UeXBlOiJTTVMifX0pLHIuVmlldyh7VmlldzonXHQgICAgICAgICAgICAgIDxwIGNsYXNzPSJva3RhLWZvcm0tc3VidGl0bGUgby1mb3JtLWV4cGxhaW4gdGV4dC1hbGlnbi1jIj5cdCAgICAgICAgICAgICAgICB7e2kxOG4gY29kZT0iZW5yb2xsLnRvdHAuc2hhcmVkU2VjcmV0SW5zdHJ1Y3Rpb25zIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgICAgIDwvcD5cdCAgICAgICAgICAgICcsc2hvd1doZW46e2FjdGl2YXRpb25UeXBlOiJNQU5VQUwifX0pLHIuSW5wdXQoe25hbWU6InNoYXJlZFNlY3JldCIsaW5wdXQ6bCx0eXBlOiJ0ZXh0IixkaXNhYmxlZDohMCxzaG93V2hlbjp7YWN0aXZhdGlvblR5cGU6Ik1BTlVBTCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTpzaGFyZWRTZWNyZXQiLHRoaXMucmVuZGVyKX19KSxyLlZpZXcoe1ZpZXc6JzxkaXYgZGF0YS10eXBlPSJuZXh0LWJ1dHRvbi13cmFwIj48L2Rpdj4nLHNob3dXaGVuOnthY3RpdmF0aW9uVHlwZToiTUFOVUFMIn19KSxyLkJ1dHRvbih7dGl0bGU6dC5sb2MoIm9mb3JtLm5leHQiLCJsb2dpbiIpLGNsYXNzTmFtZToiYnV0dG9uIGJ1dHRvbi1wcmltYXJ5IGJ1dHRvbi13aWRlIGJ1dHRvbi1uZXh0IixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6Im5leHQtYnV0dG9uIn0sY2xpY2s6aC5iaW5kKGZ1bmN0aW9uKCl7dSh0aGlzKSxjKHRoaXMsInBhc3Njb2RlIil9LHRoaXMpfSwnW2RhdGEtdHlwZT0ibmV4dC1idXR0b24td3JhcCJdJyksci5Ub29sYmFyKHtub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnQubG9jKCJvZm9ybS5zZW5kIiwibG9naW4iKSxzaG93V2hlbjp7YWN0aXZhdGlvblR5cGU6ZnVuY3Rpb24odCl7cmV0dXJuIlNNUyI9PT10fHwiRU1BSUwiPT09dH19fSldO3JldHVybiBpfX0sRm9vdGVyOm8saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuc2V0SW5pdGlhbE1vZGVsKCksdGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5nZXQoImFjdGl2YXRpb25UeXBlIikudG9Mb3dlckNhc2UoKSxuPXt9O3JldHVybiJzbXMiPT09aSYmKG4ucHJvZmlsZT17cGhvbmVOdW1iZXI6dGhpcy5nZXQoImZ1bGxQaG9uZU51bWJlciIpfSksZS5mYWN0b3IuYWN0aXZhdGlvbi5zZW5kKGksbikudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdSh0KSxoLmRlZmVyKGZ1bmN0aW9uKCl7Yyh0LCJzZW50Iil9KSxlfSl9KX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOmFjdGl2YXRpb25UeXBlIixmdW5jdGlvbih0LGUpe3RoaXMuZm9ybS5jbGVhckVycm9ycygpLCJNQU5VQUwiPT09ZSYmInRva2VuOnNvZnR3YXJlOnRvdHAiIT09dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9yVHlwZSIpP2QodGhpcywidG9rZW46c29mdHdhcmU6dG90cCIpOiJwdXNoIiE9PXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvclR5cGUiKSYmZCh0aGlzLCJwdXNoIil9KX0sc2V0SW5pdGlhbE1vZGVsOmZ1bmN0aW9uKCl7IlNNUyI9PT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpJiZ0aGlzLm1vZGVsLnNldCh7Y291bnRyeUNvZGU6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckNvdW50cnlDb2RlIil8fCJVUyIscGhvbmVOdW1iZXI6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlclBob25lTnVtYmVyIil9KX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzTWZhRW5yb2xsQWN0aXZhdGUiKXx8dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGwiKSlyZXR1cm4hMH19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTc4KSxpKDI5MyldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXt9O3JldHVybiBuLmdldENvdW50cmllcz1mdW5jdGlvbigpe3ZhciBpPXQub21pdChlLmNvdW50cnksIkhNIiwiQlYiLCJURiIpLG49dC5tYXAoaSxmdW5jdGlvbih0LGUpe3JldHVybntuYW1lOnQsY29kZTplfX0pO249dC5zb3J0QnkobiwibmFtZSIpO3ZhciByPXt9O3JldHVybiB0LmVhY2gobixmdW5jdGlvbih0KXtyW3QuY29kZV09dC5uYW1lfSkscn0sbi5nZXRDYWxsaW5nQ29kZUZvckNvdW50cnk9ZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19LG59LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpeyEodC5leHBvcnRzPXtVUzoiMSIsQUc6IjEiLEFJOiIxIixBUzoiMSIsQkI6IjEiLEJNOiIxIixCUzoiMSIsQ0E6IjEiLERNOiIxIixETzoiMSIsR0Q6IjEiLEdVOiIxIixKTToiMSIsS046IjEiLEtZOiIxIixMQzoiMSIsTVA6IjEiLE1TOiIxIixQUjoiMSIsU1g6IjEiLFRDOiIxIixUVDoiMSIsVkM6IjEiLFZHOiIxIixWSToiMSIsUlU6IjciLEtaOiI3IixFRzoiMjAiLFpBOiIyNyIsR1I6IjMwIixOTDoiMzEiLEJFOiIzMiIsRlI6IjMzIixFUzoiMzQiLEhVOiIzNiIsSVQ6IjM5IixSTzoiNDAiLENIOiI0MSIsQVQ6IjQzIixHQjoiNDQiLEdHOiI0NCIsSU06IjQ0IixKRToiNDQiLERLOiI0NSIsU0U6IjQ2IixOTzoiNDciLFNKOiI0NyIsUEw6IjQ4IixERToiNDkiLFBFOiI1MSIsTVg6IjUyIixDVToiNTMiLEFSOiI1NCIsQlI6IjU1IixDTDoiNTYiLENPOiI1NyIsVkU6IjU4IixNWToiNjAiLEFVOiI2MSIsQ0M6IjYxIixDWDoiNjEiLElEOiI2MiIsUEg6IjYzIixOWjoiNjQiLFNHOiI2NSIsVEg6IjY2IixKUDoiODEiLEtSOiI4MiIsVk46Ijg0IixDTjoiODYiLFRSOiI5MCIsSU46IjkxIixQSzoiOTIiLEFGOiI5MyIsTEs6Ijk0IixNTToiOTUiLElSOiI5OCIsU1M6IjIxMSIsTUE6IjIxMiIsRUg6IjIxMiIsRFo6IjIxMyIsVE46IjIxNiIsTFk6IjIxOCIsR006IjIyMCIsU046IjIyMSIsTVI6IjIyMiIsTUw6IjIyMyIsR046IjIyNCIsQ0k6IjIyNSIsQkY6IjIyNiIsTkU6IjIyNyIsVEc6IjIyOCIsQko6IjIyOSIsTVU6IjIzMCIsTFI6IjIzMSIsU0w6IjIzMiIsR0g6IjIzMyIsTkc6IjIzNCIsVEQ6IjIzNSIsQ0Y6IjIzNiIsQ006IjIzNyIsQ1Y6IjIzOCIsU1Q6IjIzOSIsR1E6IjI0MCIsR0E6IjI0MSIsQ0c6IjI0MiIsQ0Q6IjI0MyIsQU86IjI0NCIsR1c6IjI0NSIsSU86IjI0NiIsQUM6IjI0NyIsU0M6IjI0OCIsU0Q6IjI0OSIsUlc6IjI1MCIsRVQ6IjI1MSIsU086IjI1MiIsREo6IjI1MyIsS0U6IjI1NCIsVFo6IjI1NSIsVUc6IjI1NiIsQkk6IjI1NyIsTVo6IjI1OCIsWk06IjI2MCIsTUc6IjI2MSIsUkU6IjI2MiIsWVQ6IjI2MiIsWlc6IjI2MyIsTkE6IjI2NCIsTVc6IjI2NSIsTFM6IjI2NiIsQlc6IjI2NyIsU1o6IjI2OCIsS006IjI2OSIsU0g6IjI5MCIsVEE6IjI5MCIsRVI6IjI5MSIsQVc6IjI5NyIsRk86IjI5OCIsR0w6IjI5OSIsR0k6IjM1MCIsUFQ6IjM1MSIsTFU6IjM1MiIsSUU6IjM1MyIsSVM6IjM1NCIsQUw6IjM1NSIsTVQ6IjM1NiIsQ1k6IjM1NyIsRkk6IjM1OCIsQVg6IjM1OCIsQkc6IjM1OSIsTFQ6IjM3MCIsTFY6IjM3MSIsRUU6IjM3MiIsTUQ6IjM3MyIsQU06IjM3NCIsQlk6IjM3NSIsQUQ6IjM3NiIsTUM6IjM3NyIsU006IjM3OCIsVkE6IjM3OSIsVUE6IjM4MCIsUlM6IjM4MSIsTUU6IjM4MiIsSFI6IjM4NSIsU0k6IjM4NiIsQkE6IjM4NyIsTUs6IjM4OSIsQ1o6IjQyMCIsU0s6IjQyMSIsTEk6IjQyMyIsRks6IjUwMCIsQlo6IjUwMSIsR1Q6IjUwMiIsU1Y6IjUwMyIsSE46IjUwNCIsTkk6IjUwNSIsQ1I6IjUwNiIsUEE6IjUwNyIsUE06IjUwOCIsSFQ6IjUwOSIsR1A6IjU5MCIsQkw6IjU5MCIsTUY6IjU5MCIsQk86IjU5MSIsR1k6IjU5MiIsRUM6IjU5MyIsR0Y6IjU5NCIsUFk6IjU5NSIsTVE6IjU5NiIsU1I6IjU5NyIsVVk6IjU5OCIsQ1c6IjU5OSIsQlE6IjU5OSIsVEw6IjY3MCIsTkY6IjY3MiIsQk46IjY3MyIsTlI6IjY3NCIsUEc6IjY3NSIsVE86IjY3NiIsU0I6IjY3NyIsVlU6IjY3OCIsRko6IjY3OSIsUFc6IjY4MCIsV0Y6IjY4MSIsQ0s6IjY4MiIsTlU6IjY4MyIsV1M6IjY4NSIsS0k6IjY4NiIsTkM6IjY4NyIsVFY6IjY4OCIsUEY6IjY4OSIsVEs6IjY5MCIsRk06IjY5MSIsTUg6IjY5MiIsIjAwMSI6Ijk3OSIsS1A6Ijg1MCIsSEs6Ijg1MiIsTU86Ijg1MyIsS0g6Ijg1NSIsTEE6Ijg1NiIsQkQ6Ijg4MCIsVFc6Ijg4NiIsTVY6Ijk2MCIsTEI6Ijk2MSIsSk86Ijk2MiIsU1k6Ijk2MyIsSVE6Ijk2NCIsS1c6Ijk2NSIsU0E6Ijk2NiIsWUU6Ijk2NyIsT006Ijk2OCIsUFM6Ijk3MCIsQUU6Ijk3MSIsSUw6Ijk3MiIsQkg6Ijk3MyIsUUE6Ijk3NCIsQlQ6Ijk3NSIsTU46Ijk3NiIsTlA6Ijk3NyIsVEo6Ijk5MiIsVE06Ijk5MyIsQVo6Ijk5NCIsR0U6Ijk5NSIsS0c6Ijk5NiIsVVo6Ijk5OCIsR1M6NTAwLFBOOjY0LEFROjY3MixVTToxLEFOOjU5OX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDE4OCldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll8sbj17fSxyPXtPS1RBX1ZFUklGWTp7bGFiZWw6ImZhY3Rvci50b3RwU29mdC5va3RhVmVyaWZ5IixkZXNjcmlwdGlvbjoiZmFjdG9yLnRvdHBTb2Z0LmRlc2NyaXB0aW9uIixpY29uQ2xhc3NOYW1lOiJtZmEtb2t0YS12ZXJpZnkiLHNvcnRPcmRlcjoxfSxPS1RBX1ZFUklGWV9QVVNIOntsYWJlbDoiZmFjdG9yLm9rdGFWZXJpZnlQdXNoIixkZXNjcmlwdGlvbjoiZmFjdG9yLnB1c2guZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS1va3RhLXZlcmlmeSIsc29ydE9yZGVyOjF9LFNNUzp7bGFiZWw6ImZhY3Rvci5zbXMiLGRlc2NyaXB0aW9uOiJmYWN0b3Iuc21zLmRlc2NyaXB0aW9uIixpY29uQ2xhc3NOYW1lOiJtZmEtb2t0YS1zbXMiLHNvcnRPcmRlcjoyfSxDQUxMOntsYWJlbDoiZmFjdG9yLmNhbGwiLGRlc2NyaXB0aW9uOiJmYWN0b3IuY2FsbC5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLW9rdGEtY2FsbCIsc29ydE9yZGVyOjN9LFdJTkRPV1NfSEVMTE86e2xhYmVsOiJmYWN0b3Iud2luZG93c0hlbGxvIixkZXNjcmlwdGlvbjoiZmFjdG9yLndpbmRvd3NIZWxsby5zaWduaW4uZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS13aW5kb3dzLWhlbGxvIixzb3J0T3JkZXI6NH0sVTJGOntsYWJlbDoiZmFjdG9yLnUyZiIsZGVzY3JpcHRpb246ImZhY3Rvci51MmYuZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS11MmYiLHNvcnRPcmRlcjo1fSxZVUJJS0VZOntsYWJlbDoiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkiLGRlc2NyaXB0aW9uOiJmYWN0b3IudG90cEhhcmQueXViaWtleS5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLXl1YmlrZXkiLHNvcnRPcmRlcjo2fSxEVU86e2xhYmVsOiJmYWN0b3IuZHVvIixkZXNjcmlwdGlvbjoiZmFjdG9yLmR1by5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLWR1byIsc29ydE9yZGVyOjd9LEdPT0dMRV9BVVRIOntsYWJlbDoiZmFjdG9yLnRvdHBTb2Z0Lmdvb2dsZUF1dGhlbnRpY2F0b3IiLGRlc2NyaXB0aW9uOiJmYWN0b3IudG90cFNvZnQuZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS1nb29nbGUtYXV0aCIsc29ydE9yZGVyOjh9LFNZTUFOVEVDX1ZJUDp7bGFiZWw6ImZhY3Rvci50b3RwSGFyZC5zeW1hbnRlY1ZpcCIsZGVzY3JpcHRpb246ImZhY3Rvci50b3RwSGFyZC5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLXN5bWFudGVjIixzb3J0T3JkZXI6OX0sUlNBX1NFQ1VSSUQ6e2xhYmVsOiJmYWN0b3IudG90cEhhcmQucnNhU2VjdXJJZCIsZGVzY3JpcHRpb246ImZhY3Rvci50b3RwSGFyZC5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLXJzYSIsc29ydE9yZGVyOjEwfSxPTl9QUkVNOntsYWJlbDoiIixkZXNjcmlwdGlvbjoiZmFjdG9yLnRvdHBIYXJkLmRlc2NyaXB0aW9uIixpY29uQ2xhc3NOYW1lOiJtZmEtb25wcmVtIixzb3J0T3JkZXI6MTB9LEVNQUlMOntsYWJlbDoiZmFjdG9yLmVtYWlsIixkZXNjcmlwdGlvbjoiIixpY29uQ2xhc3NOYW1lOiJtZmEtb2t0YS1lbWFpbCIsc29ydE9yZGVyOjExfSxRVUVTVElPTjp7bGFiZWw6ImZhY3Rvci5zZWN1cml0eVF1ZXN0aW9uIixkZXNjcmlwdGlvbjoiZmFjdG9yLnNlY3VyaXR5UXVlc3Rpb24uZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS1va3RhLXNlY3VyaXR5LXF1ZXN0aW9uIixzb3J0T3JkZXI6MTJ9fTtyZXR1cm4gbi5nZXRGYWN0b3JOYW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIk9LVEEiPT09dCYmInRva2VuOnNvZnR3YXJlOnRvdHAiPT09ZT8iT0tUQV9WRVJJRlkiOiJPS1RBIj09PXQmJiJwdXNoIj09PWU/Ik9LVEFfVkVSSUZZX1BVU0giOiJHT09HTEUiPT09dD8iR09PR0xFX0FVVEgiOiJTWU1BTlRFQyI9PT10JiYidG9rZW4iPT09ZT8iU1lNQU5URUNfVklQIjoiUlNBIj09PXQmJiJ0b2tlbiI9PT1lPyJSU0FfU0VDVVJJRCI6IkRFTF9PQVRIIj09PXQmJiJ0b2tlbiI9PT1lPyJPTl9QUkVNIjoiRFVPIj09PXQmJiJ3ZWIiPT09ZT8iRFVPIjoiWVVCSUNPIj09PXQmJiJ0b2tlbjpoYXJkd2FyZSI9PT1lPyJZVUJJS0VZIjoiT0tUQSI9PT10JiYic21zIj09PWU/IlNNUyI6Ik9LVEEiPT09dCYmImNhbGwiPT09ZT8iQ0FMTCI6Ik9LVEEiPT09dCYmInF1ZXN0aW9uIj09PWU/IlFVRVNUSU9OIjoiRklETyI9PT10JiYid2ViYXV0aG4iPT09ZT8iV0lORE9XU19IRUxMTyI6IkZJRE8iPT09dCYmInUyZiI9PT1lPyJVMkYiOiJPS1RBIj09PXQmJiJlbWFpbCI9PT1lPyJFTUFJTCI6dm9pZCAwfSxuLmlzT2t0YVZlcmlmeT1mdW5jdGlvbih0LGUpe3JldHVybiJPS1RBIj09PXQmJigidG9rZW46c29mdHdhcmU6dG90cCI9PT1lfHwicHVzaCI9PT1lKX0sbi5nZXRGYWN0b3JMYWJlbD1mdW5jdGlvbihlLGkpe3ZhciBzPXJbbi5nZXRGYWN0b3JOYW1lKGUsaSldLmxhYmVsO3JldHVybiB0LmxvYyhzLCJsb2dpbiIpfSxuLmdldEZhY3RvckRlc2NyaXB0aW9uPWZ1bmN0aW9uKGUsaSl7dmFyIHM9cltuLmdldEZhY3Rvck5hbWUoZSxpKV0uZGVzY3JpcHRpb247cmV0dXJuIHQubG9jKHMsImxvZ2luIil9LG4uZ2V0RmFjdG9ySWNvbkNsYXNzTmFtZT1mdW5jdGlvbih0LGUpe3JldHVybiByW24uZ2V0RmFjdG9yTmFtZSh0LGUpXS5pY29uQ2xhc3NOYW1lfSxuLmdldEZhY3RvclNvcnRPcmRlcj1mdW5jdGlvbih0LGUpe3JldHVybiByW24uZ2V0RmFjdG9yTmFtZSh0LGUpXS5zb3J0T3JkZXJ9LG4uZ2V0UmVtZW1iZXJEZXZpY2VWYWx1ZT1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5nZXQoInJlbWVtYmVyRGV2aWNlQnlEZWZhdWx0Iil9LG4uZ2V0U2VjdXJpdHlRdWVzdGlvbkxhYmVsPWZ1bmN0aW9uKGUpe3ZhciBpPXQubG9jKCJzZWN1cml0eS4iK2UucXVlc3Rpb24pO3JldHVybiBpLmluZGV4T2YoIkwxME5fRVJST1IiKTwwP2k6ZS5xdWVzdGlvblRleHR9LG4uZ2V0UGFzc3dvcmRDb21wbGV4aXR5RGVzY3JpcHRpb249ZnVuY3Rpb24obil7dmFyIHI9W10scz1mdW5jdGlvbihlKXt2YXIgaTtzd2l0Y2goZS51bml0KXtjYXNlIkRBWSI6aT0icGFzc3dvcmQuY29tcGxleGl0eS5taW5BZ2VEYXlzIjticmVhaztjYXNlIkhPVVIiOmk9InBhc3N3b3JkLmNvbXBsZXhpdHkubWluQWdlSG91cnMiO2JyZWFrO2Nhc2UiTUlOVVRFIjppPSJwYXNzd29yZC5jb21wbGV4aXR5Lm1pbkFnZU1pbnV0ZXMifXJldHVybiB0LmxvYyhpLCJsb2dpbiIsW2UudGltZV0pfTtpZihuLmNvbXBsZXhpdHkpe3ZhciBvPXttaW5MZW5ndGg6e2kxOG46InBhc3N3b3JkLmNvbXBsZXhpdHkubGVuZ3RoIixhcmdzOiEwfSxtaW5Mb3dlckNhc2U6e2kxOG46InBhc3N3b3JkLmNvbXBsZXhpdHkubG93ZXJjYXNlIn0sbWluVXBwZXJDYXNlOntpMThuOiJwYXNzd29yZC5jb21wbGV4aXR5LnVwcGVyY2FzZSJ9LG1pbk51bWJlcjp7aTE4bjoicGFzc3dvcmQuY29tcGxleGl0eS5udW1iZXIifSxtaW5TeW1ib2w6e2kxOG46InBhc3N3b3JkLmNvbXBsZXhpdHkuc3ltYm9sIn0sZXhjbHVkZVVzZXJuYW1lOntpMThuOiJwYXNzd29yZC5jb21wbGV4aXR5Lm5vX3VzZXJuYW1lIn19LGE9bi5jb21wbGV4aXR5LGw9aS5tYXAoYSxmdW5jdGlvbihlLGkpe2lmKCEoZTw9MCkpe3ZhciBuPW9baV07cmV0dXJuIG4uYXJncz90LmxvYyhuLmkxOG4sImxvZ2luIixbZV0pOnQubG9jKG4uaTE4biwibG9naW4iKX19KTtsPWkuY29tcGFjdChsKSxsLmxlbmd0aCYmKGw9aS5yZWR1Y2UobCxmdW5jdGlvbihlLGkpe3JldHVybiBlP2UrdC5sb2MoInBhc3N3b3JkLmNvbXBsZXhpdHkubGlzdC5lbGVtZW50IiwibG9naW4iLFtpXSk6aX0pLHIucHVzaCh0LmxvYygicGFzc3dvcmQuY29tcGxleGl0eS5kZXNjcmlwdGlvbiIsImxvZ2luIixbbF0pKSl9aWYobi5hZ2UmJm4uYWdlLmhpc3RvcnlDb3VudD4wJiZyLnB1c2godC5sb2MoInBhc3N3b3JkLmNvbXBsZXhpdHkuaGlzdG9yeSIsImxvZ2luIixbbi5hZ2UuaGlzdG9yeUNvdW50XSkpLG4uYWdlJiZuLmFnZS5taW5BZ2VNaW51dGVzPjApe3ZhciBjPWUuZ2V0VGltZUluSGlnaGVzdFJlbGV2YW50VW5pdChuLmFnZS5taW5BZ2VNaW51dGVzLCJNSU5VVEUiKSx1PXMoYyk7ci5wdXNoKHUpfXJldHVybiByLmpvaW4oIiAiKX0sbn0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NiksaSgyMzYpLGkoMjMzKSxpKDI5NyksaSgyOTgpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXt2YXIgbz10Ll8sYT10LkZvcm0uZXh0ZW5kKHtsYXlvdXQ6Im8tZm9ybS10aGVtZSIsbm9DYW5jZWxCdXR0b246ITAsY29uc3RydWN0b3I6ZnVuY3Rpb24ocil7dC5Gb3JtLmNhbGwodGhpcyxyKSxvLmVhY2goby5yZXN1bHQodGhpcywiZm9ybUNoaWxkcmVuIil8fFtdLGZ1bmN0aW9uKHIpe3N3aXRjaChyLnR5cGUpe2Nhc2UgZS5JTlBVVDp0aGlzLmFkZElucHV0KG8uZXh0ZW5kKHtsYWJlbDohMSwibGFiZWwtdG9wIjohMH0sci52aWV3T3B0aW9ucykpO2JyZWFrO2Nhc2UgZS5CVVRUT046dGhpcy5hZGQodC5jcmVhdGVCdXR0b24oby5leHRlbmQoe21vZGVsOnRoaXMubW9kZWx9LHIudmlld09wdGlvbnMpKSxyLmFkZE9wdGlvbnMpLG4uYXBwbHlTaG93V2hlbih0aGlzLmxhc3QoKSxyLnZpZXdPcHRpb25zJiZyLnZpZXdPcHRpb25zLnNob3dXaGVuKTticmVhaztjYXNlIGUuRElWSURFUjp0aGlzLmFkZERpdmlkZXIoci52aWV3T3B0aW9ucyk7YnJlYWs7Y2FzZSBlLlRPT0xCQVI6dGhpcy5hZGQoaSx7b3B0aW9uczpyLnZpZXdPcHRpb25zfSksbi5hcHBseVNob3dXaGVuKHRoaXMubGFzdCgpLHIudmlld09wdGlvbnMmJnIudmlld09wdGlvbnMuc2hvd1doZW4pO2JyZWFrO2Nhc2UgZS5WSUVXOnRoaXMuYWRkKHIudmlld09wdGlvbnMuVmlldyxyLmFkZE9wdGlvbnMpLG4uYXBwbHlTaG93V2hlbih0aGlzLmxhc3QoKSxyLnZpZXdPcHRpb25zLnNob3dXaGVuKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiVW5yZWNvZ25pemVkIGNoaWxkIHR5cGU6ICIrci50eXBlKX19LHRoaXMpfX0pO3JldHVybiByLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmluaXRpYWxpemU7aWYodGhpcy5pbml0aWFsaXplPWZ1bmN0aW9uKCl7fSxyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLk1vZGVsJiZ0aGlzLkZvcm0pe3ZhciBlPXMuZXh0ZW5kKG8uZXh0ZW5kKHtwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXR0aW5ncz10LnNldHRpbmdzLHRoaXMuYXBwU3RhdGU9dC5hcHBTdGF0ZSxvLm9taXQodCxbInNldHRpbmdzIiwiYXBwU3RhdGUiXSl9fSxvLnJlc3VsdCh0aGlzLCJNb2RlbCIpKSk7dGhpcy5tb2RlbD1uZXcgZSh7c2V0dGluZ3M6dGhpcy5zZXR0aW5ncyxhcHBTdGF0ZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGV9LHtwYXJzZTohMH0pO3ZhciBpPWEuZXh0ZW5kKG8ucmVzdWx0KHRoaXMsIkZvcm0iLHRoaXMpKTt0aGlzLmZvcm09bmV3IGkodGhpcy50b0pTT04oKSksdGhpcy5hZGQodGhpcy5mb3JtKX10aGlzLkZvb3RlciYmKHRoaXMuZm9vdGVyPW5ldyB0aGlzLkZvb3Rlcih0aGlzLnRvSlNPTigpKSx0aGlzLmFkZCh0aGlzLmZvb3RlcikpLHRoaXMuYWRkTGlzdGVuZXJzKCksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHRvSlNPTjpmdW5jdGlvbigpe3ZhciB0PXIucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIG8uZXh0ZW5kKG8ucGljayh0aGlzLm9wdGlvbnMsImFwcFN0YXRlIiksdCl9LGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmZvb3RlciYmdGhpcy5mb290ZXIuYmFjayYmdGhpcy5mb290ZXIuYmFjaygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbjtuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gZnVuY3Rpb24oZSxpKXtyZXR1cm57dHlwZTp0LHZpZXdPcHRpb25zOmUsYWRkT3B0aW9uczppfX19dmFyIGU9IklOUFVUIixpPSJCVVRUT04iLG49IkRJVklERVIiLHI9IlRPT0xCQVIiLHM9IlZJRVciO3JldHVybntJbnB1dDp0KGUpLEJ1dHRvbjp0KGkpLERpdmlkZXI6dChuKSxUb29sYmFyOnQociksVmlldzp0KHMpLElOUFVUOmUsQlVUVE9OOmksRElWSURFUjpuLFRPT0xCQVI6cixWSUVXOnN9fS5jYWxsKGUsaSxlLHQpLCEodm9pZCAwIT09biYmKHQuZXhwb3J0cz1uKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShlKXtyZXR1cm4gbi5maW5kKGUuZ2V0Q2hpbGRyZW4oKSxmdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIHQuRm9ybX0pfXZhciBuPXQuXztyZXR1cm4gdC5Db250cm9sbGVyLmV4dGVuZCh7YWRkTGlzdGVuZXJzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tb2RlbC5nZXQoImJhY2t1cEZhY3RvciIpO3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic2F2ZSIsZnVuY3Rpb24oKXt2YXIgdD1pKHRoaXMpLGU9dC5kaXNhYmxlU3VibWl0QnV0dG9uO2UmJiF0LmRpc2FibGVTdWJtaXRCdXR0b24oKXx8dGhpcy50b2dnbGVCdXR0b25TdGF0ZSghMCl9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImVycm9yIixmdW5jdGlvbigpe3RoaXMudG9nZ2xlQnV0dG9uU3RhdGUoITEpfSk7dmFyIGU9bi5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMub3B0aW9ucy5hcHBTdGF0ZS5zZXQoInRyYW5zYWN0aW9uIix0KX0sdGhpcykscj1uLmJpbmQoZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgidHJhbnNhY3Rpb25FcnJvciIsdCl9LHRoaXMpO3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic2V0VHJhbnNhY3Rpb24iLGUpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic2V0VHJhbnNhY3Rpb25FcnJvciIsciksdCYmKHRoaXMubGlzdGVuVG8odCwic2V0VHJhbnNhY3Rpb24iLGUpLHRoaXMubGlzdGVuVG8odCwic2V0VHJhbnNhY3Rpb25FcnJvciIscikpfSxmZXRjaEluaXRpYWxEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIGUoKX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe3JldHVybiExfSx0b0pTT046ZnVuY3Rpb24oKXt2YXIgZT10LkNvbnRyb2xsZXIucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIG4uZXh0ZW5kKG4ucGljayh0aGlzLm9wdGlvbnMsImFwcFN0YXRlIiksZSl9LHRvZ2dsZUJ1dHRvblN0YXRlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuJGVsLmZpbmQoIi5idXR0b24iKTtlLnRvZ2dsZUNsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIsdCkucHJvcCgiZGlzYWJsZWQiLHQpfSxwb3N0UmVuZGVyQW5pbWF0aW9uOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJwYWdlUmVuZGVyZWQiLHtwYWdlOnRoaXMuY2xhc3NOYW1lfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMSldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll8sbj1bIk9BdXRoRXJyb3IiLCJBdXRoU2RrRXJyb3IiLCJBdXRoUG9sbFN0b3BFcnJvciIsIkF1dGhBcGlFcnJvciJdO3JldHVybiB0Lk1vZGVsLmV4dGVuZCh7ZG9UcmFuc2FjdGlvbjpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXM7cmV0dXJuIHQuY2FsbCh0aGlzLHRoaXMuYXBwU3RhdGUuZ2V0KCJ0cmFuc2FjdGlvbiIpKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiByLnRyaWdnZXIoInNldFRyYW5zYWN0aW9uIix0KSx0fSkuZmFpbChmdW5jdGlvbih0KXtpZigiQXV0aFBvbGxTdG9wRXJyb3IiIT09dC5uYW1lJiYoci50cmlnZ2VyKCJzZXRUcmFuc2FjdGlvbkVycm9yIix0KSxyLnRyaWdnZXIoImVycm9yIixyLHQueGhyKSxlfHxpLmluZGV4T2Yobix0Lm5hbWUpPT09LTEpKXRocm93IHR9KX0sbWFuYWdlVHJhbnNhY3Rpb246ZnVuY3Rpb24odCl7dmFyIG49dGhpcyxyPXQuY2FsbCh0aGlzLHRoaXMuYXBwU3RhdGUuZ2V0KCJ0cmFuc2FjdGlvbiIpLGkuYmluZCh0aGlzLnNldFRyYW5zYWN0aW9uLHRoaXMpKTtyZXR1cm4gZS5pc1Byb21pc2UocikmJnIuZmFpbChmdW5jdGlvbih0KXsiQXV0aFBvbGxTdG9wRXJyb3IiIT09dC5uYW1lJiYobi50cmlnZ2VyKCJzZXRUcmFuc2FjdGlvbkVycm9yIix0KSxuLnRyaWdnZXIoImVycm9yIixuLHQueGhyKSl9KSxlLnJlc29sdmUocil9LHN0YXJ0VHJhbnNhY3Rpb246ZnVuY3Rpb24odCl7dmFyIGk9dGhpcyxuPXQuY2FsbCh0aGlzLHRoaXMuc2V0dGluZ3MuZ2V0QXV0aENsaWVudCgpKTtyZXR1cm4gZS5pc1Byb21pc2Uobik/bi50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBpLnRyaWdnZXIoInNldFRyYW5zYWN0aW9uIix0KSx0fSkuZmFpbChmdW5jdGlvbih0KXt0aHJvdyBpLnRyaWdnZXIoInNldFRyYW5zYWN0aW9uRXJyb3IiLHQpLGkudHJpZ2dlcigiZXJyb3IiLGksdC54aHIpLHR9KTplLnJlc29sdmUobil9LHNldFRyYW5zYWN0aW9uOmZ1bmN0aW9uKHQpe3RoaXMuYXBwU3RhdGUuc2V0KCJ0cmFuc2FjdGlvbiIsdCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgxOTApLGkoMzAwKSxpKDMwMSksaSgxODIpLGkoMzAyKSxpKDMwMyldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7dmFyIGE9e30sbD10LnRwbCgic2lnbmluL3ZlcmlmeS97e3Byb3ZpZGVyfX0ve3tmYWN0b3JUeXBlfX0iKSxjPXQudHBsKCJzaWduaW4vZW5yb2xsL3t7cHJvdmlkZXJ9fS97e2ZhY3RvclR5cGV9fSIpLHU9dC50cGwoInNpZ25pbi9lbnJvbGwtYWN0aXZhdGUve3twcm92aWRlcn19L3t7ZmFjdG9yVHlwZX19e3sjaWYgc3RlcH19L3t7c3RlcH19e3svaWZ9fSIpLGQ9dC50cGwoInNpZ25pbi9yZWNvdmVyeS97e3JlY292ZXJ5VG9rZW59fSIpLGg9dC50cGwoInNpZ25pbi9yZWZyZXNoLWF1dGgtc3RhdGV7eyNpZiB0b2tlbn19L3t7dG9rZW59fXt7L2lmfX0iKSxwPXQudHBsKCJ7e2Jhc2VVcmx9fS9sb2dpbi9zZXNzaW9uQ29va2llUmVkaXJlY3Q/Y2hlY2tBY2NvdW50U2V0dXBDb21wbGV0ZT10cnVlJnRva2VuPXt7e3Rva2VufX19JnJlZGlyZWN0VXJsPXt7e3JlZGlyZWN0VXJsfX19Iik7cmV0dXJuIGEuY3JlYXRlVmVyaWZ5VXJsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGwoe3Byb3ZpZGVyOmVuY29kZVVSSUNvbXBvbmVudCh0LnRvTG93ZXJDYXNlKCkpLGZhY3RvclR5cGU6ZW5jb2RlVVJJQ29tcG9uZW50KGUpfSl9LGEuY3JlYXRlRW5yb2xsRmFjdG9yVXJsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGMoe3Byb3ZpZGVyOmVuY29kZVVSSUNvbXBvbmVudCh0LnRvTG93ZXJDYXNlKCkpLGZhY3RvclR5cGU6ZW5jb2RlVVJJQ29tcG9uZW50KGUpfSl9LGEuY3JlYXRlQWN0aXZhdGVGYWN0b3JVcmw9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1KHtwcm92aWRlcjplbmNvZGVVUklDb21wb25lbnQodC50b0xvd2VyQ2FzZSgpKSxmYWN0b3JUeXBlOmVuY29kZVVSSUNvbXBvbmVudChlKSxzdGVwOiEhaSYmZW5jb2RlVVJJQ29tcG9uZW50KGkpfSl9LGEuY3JlYXRlUmVjb3ZlcnlVcmw9ZnVuY3Rpb24odCl7cmV0dXJuIGQoe3JlY292ZXJ5VG9rZW46ZW5jb2RlVVJJQ29tcG9uZW50KHQpfSl9LGEuY3JlYXRlUmVmcmVzaFVybD1mdW5jdGlvbih0KXt2YXIgZT10P2VuY29kZVVSSUNvbXBvbmVudCh0KTpudWxsO3JldHVybiBoKHt0b2tlbjplfSl9LGEucm91dGVBZnRlckF1dGhTdGF0dXNDaGFuZ2U9ZnVuY3Rpb24obCxjLHUpe2lmKGMmJmMueGhyJiZyLmNvcnNJc05vdEVuYWJsZWQoYy54aHIpKXJldHVybiB2b2lkIGwuc2V0dGluZ3MuY2FsbEdsb2JhbEVycm9yKG5ldyBzLlVuc3VwcG9ydGVkQnJvd3NlckVycm9yKHQubG9jKCJlcnJvci5lbmFibGVkLmNvcnMiKSkpO2lmKGMmJmMuZXJyb3JDb2RlPT09by5JTlZBTElEX1RPS0VOX0VYQ0VQVElPTilyZXR1cm4gbC5hcHBTdGF0ZS5zZXQoImZsYXNoRXJyb3IiLHQubG9jKCJlcnJvci5leHBpcmVkLnNlc3Npb24iKSksbC5jb250cm9sbGVyLnN0YXRlLnNldCgibmF2aWdhdGVEaXIiLG4uRElSRUNUSU9OX0JBQ0spLHZvaWQgbC5uYXZpZ2F0ZSgiIix7dHJpZ2dlcjohMH0pO2lmKCFjJiZ1JiZ1LnN0YXR1cyYmKGwuYXBwU3RhdGUuc2V0QXV0aFJlc3BvbnNlKHUpLCFsLmNvbnRyb2xsZXJ8fCFsLmNvbnRyb2xsZXIudHJhcEF1dGhSZXNwb25zZSh1KSkpc3dpdGNoKHUuc3RhdHVzKXtjYXNlIlNVQ0NFU1MiOmlmKHUucmVjb3ZlcnlUeXBlPT09bi5SRUNPVkVSWV9UWVBFX1VOTE9DSylyZXR1cm4gdm9pZCBsLm5hdmlnYXRlKCJzaWduaW4vYWNjb3VudC11bmxvY2tlZCIse3RyaWdnZXI6ITB9KTtpZihsLnNldHRpbmdzLmdldCgib2F1dGgyRW5hYmxlZCIpKXJldHVybiB2b2lkIGkuZ2V0VG9rZW5zKGwuc2V0dGluZ3Mse3Nlc3Npb25Ub2tlbjp1LnNlc3Npb25Ub2tlbn0sbC5jb250cm9sbGVyKTt2YXIgZD17dXNlcjp1Ll9lbWJlZGRlZC51c2VyLHR5cGU6dS50eXBlfTtpZih1LnR5cGU9PT1uLlNFU1NJT05fU1RFUF9VUCl7dmFyIGg9dS5fbGlua3MmJnUuX2xpbmtzLm5leHQmJnUuX2xpbmtzLm5leHQuaHJlZjtkLnN0ZXBVcD17dXJsOmgsZmluaXNoOmZ1bmN0aW9uKCl7ZS5yZWRpcmVjdChoKX19fWVsc2UgZC50eXBlPW4uU0VTU0lPTl9TU08sZC5zZXNzaW9uPXt0b2tlbjp1LnNlc3Npb25Ub2tlbixzZXRDb29raWVBbmRSZWRpcmVjdDpmdW5jdGlvbih0KXtlLnJlZGlyZWN0KHAoe2Jhc2VVcmw6bC5zZXR0aW5ncy5nZXQoImJhc2VVcmwiKSx0b2tlbjplbmNvZGVVUklDb21wb25lbnQodS5zZXNzaW9uVG9rZW4pLHJlZGlyZWN0VXJsOmVuY29kZVVSSUNvbXBvbmVudCh0KX0pKX19O3JldHVybiB2b2lkIGwuc2V0dGluZ3MuY2FsbEdsb2JhbFN1Y2Nlc3Mobi5TVUNDRVNTLGQpO2Nhc2UiTUZBX1JFUVVJUkVEIjp2YXIgZj1sLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmdldERlZmF1bHRGYWN0b3IoKSxtPWEuY3JlYXRlVmVyaWZ5VXJsKGYuZ2V0KCJwcm92aWRlciIpLGYuZ2V0KCJmYWN0b3JUeXBlIikpO3JldHVybiB2b2lkIGwubmF2aWdhdGUobSx7dHJpZ2dlcjohMH0pO2Nhc2UiTUZBX0NIQUxMRU5HRSI6cmV0dXJuIHZvaWQgbC5hcHBTdGF0ZS5nZXQoInRyYW5zYWN0aW9uIikucHJldigpLnRoZW4oZnVuY3Rpb24odCl7bC5hcHBTdGF0ZS5zZXQoInRyYW5zYWN0aW9uIix0KX0pLmRvbmUoKTtjYXNlIk1GQV9FTlJPTEwiOnJldHVybiB2b2lkIGwubmF2aWdhdGUoInNpZ25pbi9lbnJvbGwiLHt0cmlnZ2VyOiEwfSk7Y2FzZSJNRkFfRU5ST0xMX0FDVElWQVRFIjp2YXIgXz1hLmNyZWF0ZUFjdGl2YXRlRmFjdG9yVXJsKGwuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JQcm92aWRlciIpLGwuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JUeXBlIikpO3JldHVybiB2b2lkIGwubmF2aWdhdGUoXyx7dHJpZ2dlcjohMH0pO2Nhc2UiUEFTU1dPUkRfV0FSTiI6Y2FzZSJQQVNTV09SRF9FWFBJUkVEIjpyZXR1cm4gdm9pZChsLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuY3VzdG9tRXhwaXJlZFBhc3N3b3JkIikmJiFsLmFwcFN0YXRlLmdldCgiaXNQd2RNYW5hZ2VkQnlPa3RhIik/bC5uYXZpZ2F0ZSgic2lnbmluL2N1c3RvbS1wYXNzd29yZC1leHBpcmVkIix7dHJpZ2dlcjohMH0pOmwubmF2aWdhdGUoInNpZ25pbi9wYXNzd29yZC1leHBpcmVkIix7dHJpZ2dlcjohMH0pKTtjYXNlIlJFQ09WRVJZX0NIQUxMRU5HRSI6dmFyIGc9dS5mYWN0b3JUeXBlLnRvTG93ZXJDYXNlKCk9PT1uLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0VNQUlMLnRvTG93ZXJDYXNlKCksdj11LnJlY292ZXJ5VHlwZT09PW4uUkVDT1ZFUllfVFlQRV9QQVNTV09SRCx5PXUucmVjb3ZlcnlUeXBlPT09bi5SRUNPVkVSWV9UWVBFX1VOTE9DSztyZXR1cm4gdm9pZCh2JiZnP2wubmF2aWdhdGUoInNpZ25pbi9yZWNvdmVyeS1lbWFpbGVkIix7dHJpZ2dlcjohMH0pOnkmJmc/bC5uYXZpZ2F0ZSgic2lnbmluL3VubG9jay1lbWFpbGVkIix7dHJpZ2dlcjohMH0pOmwubmF2aWdhdGUoInNpZ25pbi9yZWNvdmVyeS1jaGFsbGVuZ2UiLHt0cmlnZ2VyOiEwfSkpO2Nhc2UiUkVDT1ZFUlkiOnJldHVybiB2b2lkIGwubmF2aWdhdGUoInNpZ25pbi9yZWNvdmVyeS1xdWVzdGlvbiIse3RyaWdnZXI6ITB9KTtjYXNlIlBBU1NXT1JEX1JFU0VUIjpyZXR1cm4gdm9pZCBsLm5hdmlnYXRlKCJzaWduaW4vcGFzc3dvcmQtcmVzZXQiLHt0cmlnZ2VyOiEwfSk7Y2FzZSJMT0NLRURfT1VUIjpyZXR1cm4gdm9pZChsLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuc2VsZlNlcnZpY2VVbmxvY2siKT9sLm5hdmlnYXRlKCJzaWduaW4vdW5sb2NrIix7dHJpZ2dlcjohMH0pOmwuY29udHJvbGxlci5tb2RlbC50cmlnZ2VyKCJlcnJvciIsbC5jb250cm9sbGVyLm1vZGVsLHtyZXNwb25zZUpTT046e2Vycm9yQ2F1c2VzOltdLGVycm9yU3VtbWFyeTp0LmxvYygiZXJyb3IuYXV0aC5sb2NrZWRPdXQiLCJsb2dpbiIpfX0pKTtjYXNlIlVOQVVUSEVOVElDQVRFRCI6cmV0dXJuIHZvaWQgbC5uYXZpZ2F0ZSgic2lnbmluIix7dHJpZ2dlcjohMH0pO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbmtub3duIHN0YXR1czogIit1LnN0YXR1cyl9fSxhfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDMwMildLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlKXtyZXR1cm4gcy5pc0FycmF5KHQucmVzcG9uc2VUeXBlKT9zLmNvbnRhaW5zKHQucmVzcG9uc2VUeXBlLGUpOmU9PT10LnJlc3BvbnNlVHlwZX12YXIgcj17fSxzPXQuXztyZXR1cm4gci5nZXRUb2tlbnM9ZnVuY3Rpb24ocixvLGEpe2Z1bmN0aW9uIGwodCl7ci5jYWxsR2xvYmFsU3VjY2VzcyhlLlNVQ0NFU1MsdCl9ZnVuY3Rpb24gYyh0KXsiYWNjZXNzX2RlbmllZCI9PT10LmVycm9yQ29kZT8oYS5tb2RlbC50cmlnZ2VyKCJlcnJvciIsYS5tb2RlbCx7cmVzcG9uc2VKU09OOnR9KSxhLm1vZGVsLmFwcFN0YXRlLnRyaWdnZXIoInJlbW92ZUxvYWRpbmciKSk6ci5jYWxsR2xvYmFsRXJyb3IobmV3IGkuT0F1dGhFcnJvcih0Lm1lc3NhZ2UpKX12YXIgdT1yLmdldEF1dGhDbGllbnQoKSxkPXIudG9KU09OKHt2ZXJib3NlOiEwfSksaD17fSxwPXt9O3MuZXh0ZW5kKGgscy5waWNrKGQsImNsaWVudElkIiwicmVkaXJlY3RVcmkiKSxzLnBpY2soZC5hdXRoUGFyYW1zLCJyZXNwb25zZVR5cGUiLCJyZXNwb25zZU1vZGUiLCJkaXNwbGF5Iiwic2NvcGVzIiwic3RhdGUiLCJub25jZSIpLG8pLHAucG9wdXBUaXRsZT10LmxvYygic29jaWFsYXV0aC5wb3B1cC50aXRsZSIsImxvZ2luIikscC50aW1lb3V0PWQub0F1dGhUaW1lb3V0LHMuZXh0ZW5kKHAscy5waWNrKGQuYXV0aFBhcmFtcywiaXNzdWVyIiwiYXV0aG9yaXplVXJsIikpLCJwYWdlIj09PWguZGlzcGxheXx8bihoLCJjb2RlIik/dS50b2tlbi5nZXRXaXRoUmVkaXJlY3QoaCxwKTpoLnNlc3Npb25Ub2tlbj91LnRva2VuLmdldFdpdGhvdXRQcm9tcHQoaCxwKS50aGVuKGwpLmZhaWwoYykuZG9uZSgpOnUudG9rZW4uZ2V0V2l0aFBvcHVwKGgscCkudGhlbihsKS5mYWlsKGMpLmRvbmUoKX0scn0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7ISh0LmV4cG9ydHM9e0RJUkVDVElPTl9CQUNLOiJESVJFQ1RJT05fQkFDSyIsUkVDT1ZFUllfVFlQRV9QQVNTV09SRDoiUEFTU1dPUkQiLFJFQ09WRVJZX1RZUEVfVU5MT0NLOiJVTkxPQ0siLFJFQ09WRVJZX0ZBQ1RPUl9UWVBFX1NNUzoiU01TIixSRUNPVkVSWV9GQUNUT1JfVFlQRV9FTUFJTDoiRU1BSUwiLFJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0NBTEw6IkNBTEwiLFNVQ0NFU1M6IlNVQ0NFU1MiLEZPUkdPVF9QQVNTV09SRF9FTUFJTF9TRU5UOiJGT1JHT1RfUEFTU1dPUkRfRU1BSUxfU0VOVCIsVU5MT0NLX0FDQ09VTlRfRU1BSUxfU0VOVDoiVU5MT0NLX0FDQ09VTlRfRU1BSUxfU0VOVCIsQ09ORklHX0VSUk9SOiJDT05GSUdfRVJST1IiLFVOU1VQUE9SVEVEX0JST1dTRVJfRVJST1I6IlVOU1VQUE9SVEVEX0JST1dTRVJfRVJST1IiLE9BVVRIX0VSUk9SOiJPQVVUSF9FUlJPUiIsQUxMX09QVElPTkFMX05PTkVfRU5ST0xMRUQ6IkFMTF9PUFRJT05BTF9OT05FX0VOUk9MTEVEIixBTExfT1BUSU9OQUxfU09NRV9FTlJPTExFRDoiQUxMX09QVElPTkFMX1NPTUVfRU5ST0xMRUQiLEhBU19SRVFVSVJFRF9OT05FX0VOUk9MTEVEOiJIQVNfUkVRVUlSRURfTk9ORV9FTlJPTExFRCIsSEFTX1JFUVVJUkVEX1NPTUVfUkVRVUlSRURfRU5ST0xMRUQ6IkhBU19SRVFVSVJFRF9TT01FX1JFUVVJUkVEX0VOUk9MTEVEIixIQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOiJIQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEIixQUklNQVJZX0FVVEg6IlBSSU1BUllfQVVUSCIsRk9SR09UX1BBU1NXT1JEOiJGT1JHT1RfUEFTU1dPUkQiLFVOTE9DS19BQ0NPVU5UOiJVTkxPQ0tfQUNDT1VOVCIsU0VTU0lPTl9TU086IlNFU1NJT05fU1NPIixTRVNTSU9OX1NURVBfVVA6IlNFU1NJT05fU1RFUF9VUCJ9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMDEpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShpKXt0aGlzLm5hbWU9ZS5DT05GSUdfRVJST1IsdGhpcy5tZXNzYWdlPWl8fHQubG9jKCJlcnJvci5jb25maWciKX1mdW5jdGlvbiBuKGkpe3RoaXMubmFtZT1lLlVOU1VQUE9SVEVEX0JST1dTRVJfRVJST1IsdGhpcy5tZXNzYWdlPWl8fHQubG9jKCJlcnJvci51bnN1cHBvcnRlZC5icm93c2VyIil9ZnVuY3Rpb24gcih0KXt0aGlzLm5hbWU9ZS5PQVVUSF9FUlJPUix0aGlzLm1lc3NhZ2U9dH1yZXR1cm4gaS5wcm90b3R5cGU9bmV3IEVycm9yLG4ucHJvdG90eXBlPW5ldyBFcnJvcixyLnByb3RvdHlwZT1uZXcgRXJyb3Ise0NvbmZpZ0Vycm9yOmksVW5zdXBwb3J0ZWRCcm93c2VyRXJyb3I6bixPQXV0aEVycm9yOnJ9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXshKHQuZXhwb3J0cz17SU5WQUxJRF9UT0tFTl9FWENFUFRJT046IkUwMDAwMDExIn0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5OSldLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQpe3ZhciBpPWUuY3JlYXRlQWN0aXZhdGVGYWN0b3JVcmwodC5nZXQoImFjdGl2YXRlZEZhY3RvclByb3ZpZGVyIiksdC5nZXQoImFjdGl2YXRlZEZhY3RvclR5cGUiKSk7dC50cmlnZ2VyKCJuYXZpZ2F0ZSIsaSl9dmFyIG49dC5fO3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuYmFja1RvRmFjdG9ycyIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgaGVscCBnb3RvIGpzLWdvdG8iIGRhdGEtc2U9ImdvdG8tbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuc2NhbkJhcmNvZGUiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5qcy1iYWNrIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9LCJjbGljayAuanMtZ290byI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpO3ZhciBlPW4ucGFydGlhbChpLHRoaXMub3B0aW9ucy5hcHBTdGF0ZSk7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnVuc2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpLCJwdXNoIiE9PXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvclR5cGUiKT90aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldigpLnRoZW4oZnVuY3Rpb24odCl7dmFyIGU9bi5maW5kV2hlcmUodC5mYWN0b3JzLHtmYWN0b3JUeXBlOiJwdXNoIixwcm92aWRlcjoiT0tUQSJ9KTtyZXR1cm4gZS5lbnJvbGwoKX0pfSkudGhlbihlKTp0aGlzLm1vZGVsLnN0YXJ0VHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQudHgucmVzdW1lKCl9KS50aGVuKGZ1bmN0aW9uKCl7c2V0VGltZW91dChlKX0pfX0sYmFjazpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dC5vcHRpb25zLmFwcFN0YXRlLnVuc2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpLHQub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInByZXZMaW5rIik/dGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnByZXYoKX0pLnRoZW4oZnVuY3Rpb24oKXt0Lm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCJzaWduaW4vZW5yb2xsIik7Cgl9KTp0Lm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCJzaWduaW4vZW5yb2xsIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMDIpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fO3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6dC5IYW5kbGViYXJzLmNvbXBpbGUoJ1x0ICAgICAgPHNwYW4gY2xhc3M9Im9rdGEtZm9ybS1sYWJlbC1pbmxpbmUgby1mb3JtLWxhYmVsLWlubGluZSI+e3tjb3VudHJ5Q2FsbGluZ0NvZGV9fTwvc3Bhbj5cdCAgICAgIDxzcGFuIGNsYXNzPSJva3RhLWZvcm0taW5wdXQtZmllbGQgaW5wdXQtZml4IG8tZm9ybS1jb250cm9sIj5cdCAgICAgICAgPGlucHV0IHR5cGU9Int7dHlwZX19IiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBuYW1lPSJ7e25hbWV9fSIgXHQgICAgICAgICAgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19IiBhdXRvY29tcGxldGU9Im9mZiIvPlx0ICAgICAgPC9zcGFuPlx0ICAgICcpLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTpjb3VudHJ5Q2FsbGluZ0NvZGUiLGZ1bmN0aW9uKCl7dGhpcy4kKCIuby1mb3JtLWxhYmVsLWlubGluZSIpLnRleHQodGhpcy5tb2RlbC5nZXQoImNvdW50cnlDYWxsaW5nQ29kZSIpKX0pfSxwcmVSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuY291bnRyeUNhbGxpbmdDb2RlPXRoaXMubW9kZWwuZ2V0KCJjb3VudHJ5Q2FsbGluZ0NvZGUiKX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKCJpbnB1dC1maXggby1mb3JtLWNvbnRyb2wiKSxpLmRlZmVyKGkuYmluZChmdW5jdGlvbigpe3RoaXMuJGVsLnBhcmVudCgpLmFkZENsYXNzKCJvLWZvcm0taW5wdXQtZ3JvdXAiKX0sdGhpcykpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgzMDcpLGkoMTgyKSxpKDIwMiksaSgyMzEpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe2Z1bmN0aW9uIHIodCl7dmFyIGU9dC50aXRsZSxpPXQudGV4dDtyZXR1cm4hKCFlfHwhaXx8ZT09PWkpfWZ1bmN0aW9uIHModCl7cmV0dXJuIHIodCk/dDp7dGV4dDp0LnRleHR8fHR9fXJldHVybiBuLmV4dGVuZCh7dGVtcGxhdGU6ZS5jb21waWxlKCdcdCAgICAgIHt7I2lmIHBhcmFtc319XHQgICAgICAgIHt7I2lmIHBhcmFtcy5pbm5lclRvb2x0aXB9fVx0ICAgICAgICAgIDxzcGFuIGNsYXNzPSJpbnB1dC10b29sdGlwIGljb24gZm9ybS1oZWxwLTE2Ij48L3NwYW4+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgICAge3sjaWYgcGFyYW1zLmljb259fVx0ICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIGlucHV0LWljb24ge3twYXJhbXMuaWNvbn19Ij48L3NwYW4+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxpbnB1dCB0eXBlPSJ7e3R5cGV9fSIgcGxhY2Vob2xkZXI9Int7cGxhY2Vob2xkZXJ9fSIgYXJpYS1sYWJlbD0ie3twbGFjZWhvbGRlcn19Ilx0ICAgICAgICBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19IiBhdXRvY29tcGxldGU9Im9mZiIvPlx0ICAgICcpLHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZSxpPXRoaXMub3B0aW9ucy5wYXJhbXM7aWYoIm51bWJlciI9PT10aGlzLm9wdGlvbnMudHlwZSl7dmFyIG49dGhpcy4kKCJpbnB1dCIpO24uYXR0cih7cGF0dGVybjoiWzAtOV0qIixpbnB1dG1vZGU6Im51bWVyaWMifSl9aSYmaS5pbm5lclRvb2x0aXAmJihlPXMoaS5pbm5lclRvb2x0aXApLHRoaXMuJCgiLmlucHV0LXRvb2x0aXAiKS5xdGlwKHtjb250ZW50OmUsc3R5bGU6e2NsYXNzZXM6Im9rdGEtc2lnbi1pbi10b29sdGlwIHF0aXAtY3VzdG9tIHF0aXAtc2hhZG93In0scG9zaXRpb246e215OiJib3R0b20gbGVmdCIsdGFyZ2V0OiJtb3VzZSIsYWRqdXN0OnttZXRob2Q6ImZsaXAiLG1vdXNlOiEwLHk6LTUseDo1fSx2aWV3cG9ydDp0KCJib2R5Iil9fSkpfSxmb2N1czpmdW5jdGlvbigpe2lmKCFpLmlzSUUoKSlyZXR1cm4gbi5wcm90b3R5cGUuZm9jdXMuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNCksaSgyKSxpKDUpLGkoMTc3KSxpKDEzOSksaSgzNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe2Z1bmN0aW9uIG8odCxlKXtyZXR1cm4gcy51dGMoZSkuem9uZSgiLTA3OjAwIikuZm9ybWF0KHQpfWZ1bmN0aW9uIGEodCl7cmV0dXJuIHQmJnQucmVwbGFjZSgvXlxzK3xccyskL2csIiIpfWZ1bmN0aW9uIGwodCl7cmV0dXJuIDA9PT10LmluZGV4T2YoYyk/dDpjK3R9dmFyIGM9Ii9hc3NldHMiO3JldHVybiB0LnJlZ2lzdGVySGVscGVyKCJpMThuIixmdW5jdGlvbih0KXt2YXIgaSxyPWEodC5oYXNoLmNvZGUpLHM9YSh0Lmhhc2guYnVuZGxlKSxvPWEodC5oYXNoLmFyZ3VtZW50cyk7cmV0dXJuIG8mJihpPWUubWFwKGEobykuc3BsaXQoIjsiKSxmdW5jdGlvbih0KXt0PWEodCk7dmFyIGksbj10aGlzO3JldHVybiBlLmVhY2godC5zcGxpdCgiLiIpLGZ1bmN0aW9uKHQpe2k9aT9pW3RdOm5bdF19KSxpfSx0aGlzKSksbi5sb2NhbGl6ZShyLHMsaSl9KSx0LnJlZ2lzdGVySGVscGVyKCJ4c3JmVG9rZW5JbnB1dCIsZnVuY3Rpb24oKXtyZXR1cm4nPGlucHV0IHR5cGU9ImhpZGRlbiIgY2xhc3M9ImhpZGUiIG5hbWU9Il94c3JmVG9rZW4iIHZhbHVlPSInK2koIiNfeHNyZlRva2VuIikudGV4dCgpKyciPid9KSx0LnJlZ2lzdGVySGVscGVyKCJpbWciLGZ1bmN0aW9uKHQpe3ZhciBpPSJ1bmRlZmluZWQiIT10eXBlb2Ygb2t0YSYmb2t0YS5jZG5VcmxIb3N0bmFtZXx8IiIsbj1lLnBpY2sodC5oYXNoLFsic3JjIiwiYWx0Iiwid2lkdGgiLCJoZWlnaHQiLCJjbGFzcyIsInRpdGxlIl0pO24uc3JjPSIiK2krbChuLnNyYyk7dmFyIHI9ZS5tYXAobixmdW5jdGlvbih0LGkpe3JldHVybiBpKyc9IicrZS5lc2NhcGUodCkrJyInfSk7cmV0dXJuIjxpbWcgIityLmpvaW4oIiAiKSsiLz4ifSksdC5yZWdpc3RlckhlbHBlcigic2hvcnREYXRlIixlLnBhcnRpYWwobywiTU1NIEREIikpLHQucmVnaXN0ZXJIZWxwZXIoIm1lZGl1bURhdGUiLGUucGFydGlhbChvLCJNTU1NIERELCBZWVlZIikpLHQucmVnaXN0ZXJIZWxwZXIoImxvbmdEYXRlIixlLnBhcnRpYWwobywiTU1NTSBERCwgWVlZWSwgaDptbWEiKSksdC5yZWdpc3RlckhlbHBlcigiZm9ybWF0RGF0ZSIsbyksdC5yZWdpc3RlckhlbHBlcigibWFya2Rvd24iLGZ1bmN0aW9uKGUpe3JldHVybiByKHQsZSl9KSx0fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzUpLGkoMTgyKSxpKDMxMCksaSgzMTEpLGkoMzEyKSxpKDMxNSksaSgzMDkpLGkoMzE2KSxpKDI5OSksaSgzMTMpLGkoMzAyKSxpKDE3OCldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwsYyx1LGQsaCl7ZnVuY3Rpb24gcCh0LGUpe3JldHVybiBfLmZpbmQodC5zdGF0ZUxlc3NSb3V0ZUhhbmRsZXJzLGZ1bmN0aW9uKGkpe3JldHVybiBlPT09dFtpXX0pfWZ1bmN0aW9uIGYodCxlKXtyZXR1cm4hIXQmJih0IT09b3x8ZS5nZXQoImZlYXR1cmVzLnNlY3VyaXR5SW1hZ2UiKSl9ZnVuY3Rpb24gbSh0LGUsaSxuKXt2YXIgcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC50cmlnZ2VyKCJsb2FkaW5nIiwhMCl9LDIwMCk7cmV0dXJuIGgubG9hZExhbmd1YWdlKHQuZ2V0KCJsYW5ndWFnZUNvZGUiKSxlLHtiYXNlVXJsOmkscmV3cml0ZTpufSkudGhlbihmdW5jdGlvbigpe2NsZWFyVGltZW91dChyKSx0LnRyaWdnZXIoImxvYWRpbmciLCExKX0pfXZhciBfPXQuXyxnPXQuJDtyZXR1cm4gdC5Sb3V0ZXIuZXh0ZW5kKHtFdmVudHM6ZS5FdmVudHMsaW5pdGlhbGl6ZTpmdW5jdGlvbihlKXt0aGlzLnNldHRpbmdzPW5ldyByKF8ub21pdChlLCJlbCIsImF1dGhDbGllbnQiKSx7cGFyc2U6ITB9KSx0aGlzLnNldHRpbmdzLnNldEF1dGhDbGllbnQoZS5hdXRoQ2xpZW50KSxlLmVsfHx0aGlzLnNldHRpbmdzLmNhbGxHbG9iYWxFcnJvcihuZXcgZC5Db25maWdFcnJvcih0LmxvYygiZXJyb3IucmVxdWlyZWQuZWwiKSkpLGcoImJvZHkgPiBkaXYiKS5vbigiY2xpY2siLGZ1bmN0aW9uKCl7fSksdGhpcy5hcHBTdGF0ZT1uZXcgbCh7YmFzZVVybDp0aGlzLnNldHRpbmdzLmdldCgiYmFzZVVybCIpLHNldHRpbmdzOnRoaXMuc2V0dGluZ3N9LHtwYXJzZTohMH0pO3ZhciBpPW5ldyBhKHthcHBTdGF0ZTp0aGlzLmFwcFN0YXRlfSk7dC4kKGUuZWwpLmFwcGVuZChpLnJlbmRlcigpLiRlbCksdGhpcy5lbD0iI29rdGEtc2lnbi1pbiIsdGhpcy5oZWFkZXI9bmV3IHMoe2VsOnRoaXMuZWwsYXBwU3RhdGU6dGhpcy5hcHBTdGF0ZSxzZXR0aW5nczp0aGlzLnNldHRpbmdzfSksdGhpcy5saXN0ZW5Ubyh0aGlzLmFwcFN0YXRlLCJjaGFuZ2U6dHJhbnNhY3Rpb25FcnJvciIsZnVuY3Rpb24odCxlKXtjLnJvdXRlQWZ0ZXJBdXRoU3RhdHVzQ2hhbmdlKHRoaXMsZSl9KSx0aGlzLmxpc3RlblRvKHRoaXMuYXBwU3RhdGUsImNoYW5nZTp0cmFuc2FjdGlvbiIsZnVuY3Rpb24odCxlKXtjLnJvdXRlQWZ0ZXJBdXRoU3RhdHVzQ2hhbmdlKHRoaXMsbnVsbCxlLmRhdGEpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLmFwcFN0YXRlLCJuYXZpZ2F0ZSIsZnVuY3Rpb24odCl7dGhpcy5uYXZpZ2F0ZSh0LHt0cmlnZ2VyOiEwfSl9KX0sZXhlY3V0ZTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuc2V0dGluZ3MuZ2V0KCJyZWNvdmVyeVRva2VuIik7aWYoaSlyZXR1cm4gdGhpcy5zZXR0aW5ncy51bnNldCgicmVjb3ZlcnlUb2tlbiIpLHZvaWQgdGhpcy5uYXZpZ2F0ZShjLmNyZWF0ZVJlY292ZXJ5VXJsKGkpLHt0cmlnZ2VyOiEwfSk7dmFyIG49dGhpcy5zZXR0aW5ncy5nZXQoInN0YXRlVG9rZW4iKTtpZihuKXJldHVybiB0aGlzLnNldHRpbmdzLnVuc2V0KCJzdGF0ZVRva2VuIiksdm9pZCB0aGlzLm5hdmlnYXRlKGMuY3JlYXRlUmVmcmVzaFVybChuKSx7dHJpZ2dlcjohMH0pO3ZhciByPXRoaXMuYXBwU3RhdGUuZ2V0KCJ0cmFuc2FjdGlvbiIpO3JldHVybiByJiZyLmRhdGF8fHAodGhpcyx0KT92b2lkIHQuYXBwbHkodGhpcyxlKTp0aGlzLnNldHRpbmdzLmdldEF1dGhDbGllbnQoKS50eC5leGlzdHMoKT92b2lkIHRoaXMubmF2aWdhdGUoYy5jcmVhdGVSZWZyZXNoVXJsKCkse3RyaWdnZXI6ITB9KTp2b2lkIHRoaXMubmF2aWdhdGUoIiIse3RyaWdnZXI6ITB9KX0sbmF2aWdhdGU6ZnVuY3Rpb24oaSxuKXtyZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnJvdXRlciIpP3QuUm91dGVyLnByb3RvdHlwZS5uYXZpZ2F0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6biYmbi50cmlnZ2VyP2UuaGlzdG9yeS5sb2FkVXJsKGkpOnZvaWQgMH0scmVuZGVyOmZ1bmN0aW9uKHQsZSl7ZXx8KGU9e30pO3ZhciBpPWUuQmVhY29uLG49Xy5leHRlbmQoe3NldHRpbmdzOnRoaXMuc2V0dGluZ3MsYXBwU3RhdGU6dGhpcy5hcHBTdGF0ZX0sXy5vbWl0KGUsIkJlYWNvbiIpKTtpZih0aGlzLmhlYWRlci5yZW5kZXJlZCgpfHwodGhpcy5lbD10aGlzLmhlYWRlci5yZW5kZXIoKS5nZXRDb250ZW50RWwoKSksIWguaXNMb2FkZWQodGhpcy5hcHBTdGF0ZS5nZXQoImxhbmd1YWdlQ29kZSIpKSlyZXR1cm4gbSh0aGlzLmFwcFN0YXRlLHRoaXMuc2V0dGluZ3MuZ2V0KCJpMThuIiksdGhpcy5zZXR0aW5ncy5nZXQoImFzc2V0cy5iYXNlVXJsIiksdGhpcy5zZXR0aW5ncy5nZXQoImFzc2V0cy5yZXdyaXRlIikpLnRoZW4oXy5iaW5kKHRoaXMucmVuZGVyLHRoaXMsdCxlKSkuZG9uZSgpO3ZhciByPXRoaXMuY29udHJvbGxlcjt0aGlzLmNvbnRyb2xsZXI9bmV3IHQobiksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbnRyb2xsZXIsImFsbCIsdGhpcy50cmlnZ2VyKSx0aGlzLmNvbnRyb2xsZXIuZmV0Y2hJbml0aWFsRGF0YSgpLnRoZW4oXy5iaW5kKGZ1bmN0aW9uKCl7cmV0dXJuIGYoaSx0aGlzLnNldHRpbmdzKXx8KGk9bnVsbCksdGhpcy5oZWFkZXIuc2V0QmVhY29uKGksbiksdGhpcy5jb250cm9sbGVyLnJlbmRlcigpLHI/dS5zd2FwUGFnZXMoeyRwYXJlbnQ6dGhpcy5lbCwkb2xkUm9vdDpyLiRlbCwkbmV3Um9vdDp0aGlzLmNvbnRyb2xsZXIuJGVsLGRpcjpyLnN0YXRlLmdldCgibmF2aWdhdGVEaXIiKSxjdHg6dGhpcyxzdWNjZXNzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5hcHBTdGF0ZS5nZXQoImZsYXNoRXJyb3IiKSxlPXRoaXMuY29udHJvbGxlci5tb2RlbDtyLnJlbW92ZSgpLHIuJGVsLnJlbW92ZSgpLHRoaXMuY29udHJvbGxlci5wb3N0UmVuZGVyQW5pbWF0aW9uKCksdCYmKGUudHJpZ2dlcigiZXJyb3IiLGUse3Jlc3BvbnNlSlNPTjp7ZXJyb3JTdW1tYXJ5OnR9fSksdGhpcy5hcHBTdGF0ZS51bnNldCgiZmxhc2hFcnJvciIpKX19KToodGhpcy5lbC5hcHBlbmQodGhpcy5jb250cm9sbGVyLmVsKSx2b2lkIHRoaXMuY29udHJvbGxlci5wb3N0UmVuZGVyQW5pbWF0aW9uKCkpfSx0aGlzKSkuZmFpbChmdW5jdGlvbigpe3ImJihyLnJlbW92ZSgpLHIuJGVsLnJlbW92ZSgpKX0pLmRvbmUoKX0sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgZT0hMTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciYmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb3BzdGF0ZSIsXy5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMuY29udHJvbGxlci5iYWNrJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5jb250cm9sbGVyLmJhY2soKSl9LHRoaXMpKSxlPWkuc3VwcG9ydHNQdXNoU3RhdGUoKSksdC5Sb3V0ZXIucHJvdG90eXBlLnN0YXJ0LmNhbGwodGhpcyx7cHVzaFN0YXRlOmV9KX0saGlkZTpmdW5jdGlvbigpe3RoaXMuaGVhZGVyLiRlbC5oaWRlKCl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLmhlYWRlci4kZWwuc2hvdygpfSxyZW1vdmU6ZnVuY3Rpb24oKXt0aGlzLmNvbnRyb2xsZXIucmVtb3ZlKCksdGhpcy5oZWFkZXIuJGVsLnJlbW92ZSgpLGUuaGlzdG9yeS5zdG9wKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9ImNhbi1yZW1vdmUtYmVhY29uIjtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJhdXRoLWNvbnRhaW5lciBtYWluLWNvbnRhaW5lciIsaWQ6Im9rdGEtc2lnbi1pbiIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJhdXRoLWNvbnRhaW5lciJ9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJjaGFuZ2U6YmVhY29uVHlwZSIsZnVuY3Rpb24odCxpKXt0aGlzLiRlbC50b2dnbGVDbGFzcyhlLCJzZWN1cml0eSI9PT1pKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJyZWZyZXNoLWF1dGgtc3RhdGUiLE1vZGVsOnt9LEZvcm06e25vQnV0dG9uQmFyOiEwfSxwcmVSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMudG9rZW4sZT10aGlzLm9wdGlvbnMuYXBwU3RhdGU7dGhpcy5tb2RlbC5zdGFydFRyYW5zYWN0aW9uKGZ1bmN0aW9uKGkpe3JldHVybiB0PyhlLnRyaWdnZXIoImxvYWRpbmciLCEwKSxpLnR4LnJlc3VtZSh7c3RhdGVUb2tlbjp0fSkpOmkudHguZXhpc3RzKCk/KGUudHJpZ2dlcigibG9hZGluZyIsITApLGkudHgucmVzdW1lKCkpOnZvaWQgZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsIiIpfSl9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibG9hZGluZyIsITEpLGUucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMSksaSgzMDIpLGkoMTgyKSxpKDMxKSxpKDE4MSksaSgzMDApLGkoMSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXt2YXIgbD0iZW4iLGM9WyJmYWNlYm9vayIsImdvb2dsZSIsImxpbmtlZGluIiwibWljcm9zb2Z0Il0sdT1bInRva2VuIiwiaWRfdG9rZW4iLCJjb2RlIl0sZD10LnRwbCgie3tvcmlnaW59fSIpLGg9dC5fLHA9aS5Db25maWdFcnJvcixmPWkuVW5zdXBwb3J0ZWRCcm93c2VyRXJyb3IsbT10LnRwbCgiaHR0cHM6Ly9vazFzdGF0aWMub2t0YWNkbi5jb20vYXNzZXRzL2pzL3Nkay9va3RhLXNpZ25pbi13aWRnZXQve3t2ZXJzaW9ufX0iKTtyZXR1cm4gdC5Nb2RlbC5leHRlbmQoe2ZsYXQ6ITAsYXV0aENsaWVudDp2b2lkIDAsbG9jYWw6e2Jhc2VVcmw6WyJzdHJpbmciLCEwXSxyZWNvdmVyeVRva2VuOlsic3RyaW5nIiwhMSx2b2lkIDBdLHN0YXRlVG9rZW46WyJzdHJpbmciLCExLHZvaWQgMF0sdXNlcm5hbWU6WyJzdHJpbmciLCExXSxzaWduT3V0TGluazpbInN0cmluZyIsITFdLHRyYW5zZm9ybVVzZXJuYW1lOlsiZnVuY3Rpb24iLCExXSxnbG9iYWxTdWNjZXNzRm46ImZ1bmN0aW9uIixnbG9iYWxFcnJvckZuOiJmdW5jdGlvbiIscHJvY2Vzc0NyZWRzOiJmdW5jdGlvbiIsbG9nbzoic3RyaW5nIixsb2dvVGV4dDpbInN0cmluZyIsITFdLGhlbHBTdXBwb3J0TnVtYmVyOiJzdHJpbmciLCJmZWF0dXJlcy5yb3V0ZXIiOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy5zZWN1cml0eUltYWdlIjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMucmVtZW1iZXJNZSI6WyJib29sZWFuIiwhMCwhMF0sImZlYXR1cmVzLmF1dG9QdXNoIjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMuc21zUmVjb3ZlcnkiOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy5jYWxsUmVjb3ZlcnkiOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy53aW5kb3dzVmVyaWZ5IjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMuc2VsZlNlcnZpY2VVbmxvY2siOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy5tdWx0aU9wdGlvbmFsRmFjdG9yRW5yb2xsIjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMucHJldmVudEJyb3dzZXJGcm9tU2F2aW5nT2t0YVBhc3N3b3JkIjpbImJvb2xlYW4iLCEwLCEwXSwiZmVhdHVyZXMuZGV2aWNlRmluZ2VycHJpbnRpbmciOlsiYm9vbGVhbiIsITEsITFdLCJmZWF0dXJlcy5oaWRlU2lnbk91dExpbmtJbk1GQSI6WyJib29sZWFuIiwhMSwhMV0sImZlYXR1cmVzLmN1c3RvbUV4cGlyZWRQYXNzd29yZCI6WyJib29sZWFuIiwhMCwhMV0sImZlYXR1cmVzLnJlZ2lzdHJhdGlvbiI6WyJib29sZWFuIiwhMSwhMV0sbGFuZ3VhZ2U6WyJhbnkiLCExXSxpMThuOlsib2JqZWN0IiwhMV0sImFzc2V0cy5iYXNlVXJsIjpbInN0cmluZyIsITFdLCJhc3NldHMucmV3cml0ZSI6e3R5cGU6ImZ1bmN0aW9uIix2YWx1ZTpoLmlkZW50aXR5fSxhdXRoU2NoZW1lOlsic3RyaW5nIiwhMSwiT0FVVEgyIl0sImF1dGhQYXJhbXMuZGlzcGxheSI6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsibm9uZSIsInBvcHVwIiwicGFnZSJdfSwiYXV0aFBhcmFtcy5yZXNwb25zZU1vZGUiOnt0eXBlOiJzdHJpbmciLHZhbHVlczpbInF1ZXJ5IiwiZnJhZ21lbnQiLCJmb3JtX3Bvc3QiLCJva3RhX3Bvc3RfbWVzc2FnZSJdfSwiYXV0aFBhcmFtcy5yZXNwb25zZVR5cGUiOlsiYW55IiwhMSwiaWRfdG9rZW4iXSwiYXV0aFBhcmFtcy5zY29wZXMiOlsiYXJyYXkiLCExXSwiYXV0aFBhcmFtcy5pc3N1ZXIiOlsic3RyaW5nIiwhMV0sImF1dGhQYXJhbXMuYXV0aG9yaXplVXJsIjpbInN0cmluZyIsITFdLCJhdXRoUGFyYW1zLnN0YXRlIjpbInN0cmluZyIsITFdLCJhdXRoUGFyYW1zLm5vbmNlIjpbInN0cmluZyIsITFdLGNsaWVudElkOiJzdHJpbmciLHJlZGlyZWN0VXJpOiJzdHJpbmciLGlkcHM6WyJhcnJheSIsITEsW11dLGlkcERpc3BsYXk6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiUFJJTUFSWSIsIlNFQ09OREFSWSJdLHZhbHVlOiJTRUNPTkRBUlkifSxvQXV0aFRpbWVvdXQ6WyJudW1iZXIiLCExXSwiaGVscExpbmtzLmhlbHAiOiJzdHJpbmciLCJoZWxwTGlua3MuZm9yZ290UGFzc3dvcmQiOiJzdHJpbmciLCJoZWxwTGlua3MudW5sb2NrIjoic3RyaW5nIiwiaGVscExpbmtzLmN1c3RvbSI6ImFycmF5IixjdXN0b21CdXR0b25zOlsiYXJyYXkiLCExLFtdXSwicmVnaXN0cmF0aW9uLmNsaWNrIjoiZnVuY3Rpb24ifSxkZXJpdmVkOntzdXBwb3J0ZWRMYW5ndWFnZXM6e2RlcHM6WyJpMThuIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIGgudW5pb24oYS5zdXBwb3J0ZWRMYW5ndWFnZXMsaC5rZXlzKHQpKX0sY2FjaGU6ITB9LGxhbmd1YWdlQ29kZTp7ZGVwczpbImxhbmd1YWdlIiwic3VwcG9ydGVkTGFuZ3VhZ2VzIl0sZm46ZnVuY3Rpb24odCxlKXt2YXIgaSxzPW4uZ2V0VXNlckxhbmd1YWdlcygpLG89aC5jbG9uZShzKSxhPXIudG9Mb3dlcihlKTtoLmlzU3RyaW5nKHQpP28udW5zaGlmdCh0KTpoLmlzRnVuY3Rpb24odCkmJm8udW5zaGlmdCh0KGUscykpLG8ucHVzaChsKSxpPXIudG9Mb3dlcihyLmV4cGFuZExhbmd1YWdlcyhvKSk7dmFyIGMsdTtmb3IoYz0wO2M8aS5sZW5ndGg7YysrKWlmKHU9YS5pbmRleE9mKGlbY10pLHU+LTEpcmV0dXJuIGVbdV19fSxvYXV0aDJFbmFibGVkOntkZXBzOlsiY2xpZW50SWQiLCJhdXRoU2NoZW1lIiwiYXV0aFBhcmFtcy5yZXNwb25zZVR5cGUiXSxmbjpmdW5jdGlvbih0LGUsaSl7aWYoIXQpcmV0dXJuITE7aWYoIm9hdXRoMiIhPT1lLnRvTG93ZXJDYXNlKCkpcmV0dXJuITE7dmFyIG49aC5pc0FycmF5KGkpP2k6W2ldO3JldHVybiBoLmludGVyc2VjdGlvbihuLHUpLmxlbmd0aD4wfSxjYWNoZTohMH0sb2F1dGhSZWRpcmVjdFVyaTp7ZGVwczpbInJlZGlyZWN0VXJpIl0sZm46ZnVuY3Rpb24odCl7aWYodClyZXR1cm4gdDt2YXIgZT13aW5kb3cubG9jYXRpb24ub3JpZ2luO2lmKCFlKXt2YXIgaT13aW5kb3cubG9jYXRpb24uaHJlZixuPXdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTsiIiE9PW4mJihlPWkuc3Vic3RyaW5nKDAsaS5sYXN0SW5kZXhPZihuKSkpfXJldHVybiBkKHtvcmlnaW46ZX0pfX0sY29uZmlndXJlZFNvY2lhbElkcHM6e2RlcHM6WyJpZHBzIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIGguZmlsdGVyKHQsZnVuY3Rpb24odCl7cmV0dXJuIGguY29udGFpbnMoYyx0LnR5cGUudG9Mb3dlckNhc2UoKSl9KX0sY2FjaGU6ITB9LHNvY2lhbEF1dGhQb3NpdGlvblRvcDp7ZGVwczpbImNvbmZpZ3VyZWRTb2NpYWxJZHBzIiwiaWRwRGlzcGxheSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIWguaXNFbXB0eSh0KSYmIlBSSU1BUlkiPT09ZS50b1VwcGVyQ2FzZSgpfSxjYWNoZTohMH0sY29uZmlndXJlZEJ1dHRvbnM6e2RlcHM6WyJjb25maWd1cmVkU29jaWFsSWRwcyIsImN1c3RvbUJ1dHRvbnMiXSxmbjpmdW5jdGlvbihlLGkpe3ZhciBuPXRoaXMscj1bXTtyZXR1cm4gaC5lYWNoKGUsZnVuY3Rpb24oZSl7dmFyIGk9ZS50eXBlLnRvTG93ZXJDYXNlKCkscz0ic29jaWFsLWF1dGgtIitpKyItYnV0dG9uIixhPXtpZDplLmlkLHR5cGU6ZS50eXBlLGRhdGFBdHRyOnMsY2xhc3NOYW1lOiJzb2NpYWwtYXV0aC1idXR0b24gIitzLHRpdGxlOmUudGl0bGU9dC5sb2MoInNvY2lhbGF1dGguIitpKyIubGFiZWwiKSxjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksby5nZXRUb2tlbnMobix7aWRwOmUuaWR9KX19O3IucHVzaChhKX0pLGguaXNBcnJheShpKSYmaC5lYWNoKGksZnVuY3Rpb24odCl7dmFyIGU9e3RpdGxlOnQudGl0bGUsY2xhc3NOYW1lOnQuY2xhc3NOYW1lKyIgZGVmYXVsdC1jdXN0b20tYnV0dG9uIixjbGljazp0LmNsaWNrfTtyLnB1c2goZSl9KSxyfSxjYWNoZTohMH0saGFzQ29uZmlndXJlZEJ1dHRvbnM6e2RlcHM6WyJjb25maWd1cmVkQnV0dG9ucyJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiFoLmlzRW1wdHkodCl9LGNhY2hlOiEwfX0saW5pdGlhbGl6ZTpmdW5jdGlvbihlKXtlLmJhc2VVcmw/ZS5nbG9iYWxTdWNjZXNzRm4/bi5jb3JzSXNOb3RTdXBwb3J0ZWQoKSYmdGhpcy5jYWxsR2xvYmFsRXJyb3IobmV3IGYodC5sb2MoImVycm9yLnVuc3VwcG9ydGVkLmNvcnMiKSkpOnRoaXMuY2FsbEdsb2JhbEVycm9yKG5ldyBwKHQubG9jKCJlcnJvci5yZXF1aXJlZC5zdWNjZXNzIikpKTp0aGlzLmNhbGxHbG9iYWxFcnJvcihuZXcgcCh0LmxvYygiZXJyb3IucmVxdWlyZWQuYmFzZVVybCIpKSl9LHNldEF1dGhDbGllbnQ6ZnVuY3Rpb24odCl7dGhpcy5hdXRoQ2xpZW50PXR9LGdldEF1dGhDbGllbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdXRoQ2xpZW50fSxzZXQ6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHQuTW9kZWwucHJvdG90eXBlLnNldC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9Y2F0Y2goZSl7dmFyIGk9ZS5tZXNzYWdlP2UubWVzc2FnZTplO3RoaXMuY2FsbEdsb2JhbEVycm9yKG5ldyBwKGkpKX19LGNhbGxHbG9iYWxTdWNjZXNzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9aC5leHRlbmQoZSx7c3RhdHVzOnR9KTtoLmRlZmVyKGgucGFydGlhbCh0aGlzLmdldCgiZ2xvYmFsU3VjY2Vzc0ZuIiksaSkpfSxjYWxsR2xvYmFsRXJyb3I6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXQoImdsb2JhbEVycm9yRm4iKXx8dGhpcy5vcHRpb25zLmdsb2JhbEVycm9yRm47aWYoIWUpdGhyb3cgdDtlKHQpfSx0cmFuc2Zvcm1Vc2VybmFtZTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0KCJ0cmFuc2Zvcm1Vc2VybmFtZSIpO3JldHVybiBpJiZoLmlzRnVuY3Rpb24oaSk/aSh0LGUpOnR9LHByb2Nlc3NDcmVkczpmdW5jdGlvbih0KXt2YXIgaT10aGlzLmdldCgicHJvY2Vzc0NyZWRzIik7cmV0dXJuIGUuUHJvbWlzZShmdW5jdGlvbihlKXtoLmlzRnVuY3Rpb24oaSk/Mj09PWkubGVuZ3RoP2kodCxlKTooaSh0KSxlKCkpOmUoKX0pfSxwYXJzZTpmdW5jdGlvbih0KXtpZih0LmF1dGhQYXJhbXMmJnQuYXV0aFBhcmFtcy5zY29wZSYmKHMuZGVwcmVjYXRlKCdVc2UgInNjb3BlcyIgaW5zdGVhZCBvZiAic2NvcGUiJyksdC5hdXRoUGFyYW1zLnNjb3Blcz10LmF1dGhQYXJhbXMuc2NvcGUsZGVsZXRlIHQuYXV0aFBhcmFtcy5zY29wZSksdC5sYWJlbHN8fHQuY291bnRyeSl7cy5kZXByZWNhdGUoJ1VzZSAiaTE4biIgaW5zdGVhZCBvZiAibGFiZWxzIiBhbmQgImNvdW50cnkiJyk7dmFyIGU9dC5sYWJlbHN8fHt9O2guZWFjaCh0LmNvdW50cnksZnVuY3Rpb24odCxpKXtlWyJjb3VudHJ5LiIraV09dH0pLHQuaTE4bj17fSxoLmVhY2goYS5zdXBwb3J0ZWRMYW5ndWFnZXMsZnVuY3Rpb24oaSl7dC5pMThuW2ldPWV9KSxkZWxldGUgdC5sYWJlbHMsZGVsZXRlIHQuY291bnRyeX10LmFzc2V0c3x8KHQuYXNzZXRzPXt9KTt2YXIgaT10LmFzc2V0cy5iYXNlVXJsO3JldHVybiBpPyIvIj09PWlbaS5sZW5ndGgtMV0mJih0LmFzc2V0cy5iYXNlVXJsPWkuc3Vic3RyaW5nKDAsaS5sZW5ndGgtMSkpOnQuYXNzZXRzLmJhc2VVcmw9bSh7dmVyc2lvbjphLnZlcnNpb259KSx0fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzEzKSxpKDMxNCldLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7cmV0dXJuIHQmJnQuZXF1YWxzKGkpfWZ1bmN0aW9uIHIodCl7dC5jdXJyZW50QmVhY29uJiYodC5jdXJyZW50QmVhY29uLnJlbW92ZSgpLHQuY3VycmVudEJlYWNvbj1udWxsKX1mdW5jdGlvbiBzKHQsZSxpLG4pe3QuYWRkKGUse3NlbGVjdG9yOmksb3B0aW9uczpufSksdC5jdXJyZW50QmVhY29uPXQuZmlyc3QoKX1mdW5jdGlvbiBvKHQsZSxpKXtyZXR1cm4gdHx8ZT8hdCYmaS5sb2FkaW5nPyJsb2FkIjp0JiZuKHQpP2U/InN3YXAiOiJ1bmxvYWQiOnQmJnQuZXF1YWxzKGUsaSk/InNhbWUiOiF0JiZlPyJhZGQiOnQmJiFlPyJyZW1vdmUiOnQgaW5zdGFuY2VvZiBlPyJmYWRlIjoic3dhcCI6Im5vbmUifXZhciBhPSJuby1iZWFjb24iLGw9ImJlYWNvbi1zbWFsbCBiZWFjb24tbG9hZGluZyI7cmV0dXJuIHQuVmlldy5leHRlbmQoe2N1cnJlbnRCZWFjb246bnVsbCx0ZW1wbGF0ZTonXHQgICAgICA8ZGl2IGNsYXNzPSJva3RhLXNpZ24taW4taGVhZGVyIGF1dGgtaGVhZGVyIj5cdCAgICAgICAge3sjaWYgbG9nb319XHQgICAgICAgIDxpbWcgc3JjPSJ7e2xvZ299fSIgY2xhc3M9ImF1dGgtb3JnLWxvZ28iIGFsdD0ie3tsb2dvVGV4dH19Ii8+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgICAgPGRpdiBkYXRhLXR5cGU9ImJlYWNvbi1jb250YWluZXIiIGNsYXNzPSJiZWFjb24tY29udGFpbmVyIj48L2Rpdj5cdCAgICAgIDwvZGl2Plx0ICAgICAgPGRpdiBjbGFzcz0iYXV0aC1jb250ZW50Ij48ZGl2IGNsYXNzPSJhdXRoLWNvbnRlbnQtaW5uZXIiPjwvZGl2PjwvZGl2Plx0ICAgICcsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0LnNldHRpbmdzLmdldCgiZmVhdHVyZXMuc2VjdXJpdHlJbWFnZSIpfHwodGhpcy4kZWwuYWRkQ2xhc3MoYSksdGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJsb2FkaW5nIix0aGlzLnNldExvYWRpbmdCZWFjb24pLHRoaXMubGlzdGVuVG8odC5hcHBTdGF0ZSwicmVtb3ZlTG9hZGluZyIsdGhpcy5yZW1vdmVMb2FkaW5nQmVhY29uKSl9LHNldEJlYWNvbjpmdW5jdGlvbih0LGkpe3ZhciBjPSdbZGF0YS10eXBlPSJiZWFjb24tY29udGFpbmVyIl0nLHU9dGhpcy4kKGMpLGQ9byh0aGlzLmN1cnJlbnRCZWFjb24sdCxpKSxoPXRoaXM7c3dpdGNoKGQpe2Nhc2Uibm9uZSI6cmV0dXJuIHZvaWQgdGhpcy4kZWwuYWRkQ2xhc3MoYSk7Y2FzZSJzYW1lIjpyZXR1cm47Y2FzZSJhZGQiOnJldHVybiB0aGlzLiRlbC5yZW1vdmVDbGFzcyhhKSxzKHRoaXMsdCxjLGkpLGUuZXhwbG9kZSh1KTtjYXNlInJlbW92ZSI6cmV0dXJuIHRoaXMuJGVsLmFkZENsYXNzKGEpLGUuaW1wbG9kZSh1KS50aGVuKGZ1bmN0aW9uKCl7cihoKX0pLmRvbmUoKTtjYXNlImZhZGUiOmlmKCF0aGlzLmN1cnJlbnRCZWFjb24uZmFkZU91dCl0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjdXJyZW50IGJlYWNvbiBpcyBtaXNzaW5nIHRoZSAiZmFkZU91dCIgbWV0aG9kJyk7cmV0dXJuIGkuYW5pbWF0ZT0hMCx0aGlzLmN1cnJlbnRCZWFjb24uZmFkZU91dCgpLnRoZW4oZnVuY3Rpb24oKXtyKGgpLHMoaCx0LGMsaSl9KS5kb25lKCk7Y2FzZSJzd2FwIjpyZXR1cm4gZS5zd2FwQmVhY29ucyh7JGVsOnUsc3dhcDpmdW5jdGlvbigpe3ZhciBlPW4oaC5jdXJyZW50QmVhY29uKTtyKGgpLGUmJih1LnJlbW92ZUNsYXNzKGwpLGguJGVsLnJlbW92ZUNsYXNzKGEpKSxzKGgsdCxjLGkpfX0pLmRvbmUoKTtjYXNlImxvYWQiOnJldHVybiB1LmFkZENsYXNzKGwpLHMoaCx0LGMsaSksZS5leHBsb2RlKHUpO2Nhc2UidW5sb2FkIjpyZXR1cm4gdGhpcy5yZW1vdmVMb2FkaW5nQmVhY29uKCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoJ3RoZSAiJytkKyciIGlzIG5vdCByZWNvZ25pemVkJyl9fSxzZXRMb2FkaW5nQmVhY29uOmZ1bmN0aW9uKHQpe3QmJiFuKHRoaXMuY3VycmVudEJlYWNvbikmJnRoaXMuc2V0QmVhY29uKGkse2xvYWRpbmc6ITB9KX0scmVtb3ZlTG9hZGluZ0JlYWNvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMsaT10aGlzLiQoJ1tkYXRhLXR5cGU9ImJlYWNvbi1jb250YWluZXIiXScpO3JldHVybiBlLmltcGxvZGUoaSkudGhlbihmdW5jdGlvbigpe3IodCksaS5yZW1vdmVDbGFzcyhsKX0pLmRvbmUoKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MudG9KU09OKHt2ZXJib3NlOiEwfSl9LGdldENvbnRlbnRFbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIi5hdXRoLWNvbnRlbnQtaW5uZXIiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIxKSxpKDMwMSldLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKGUsaSxuKXt2YXIgcj10LmRlZmVyKCk7cmV0dXJuIGUuYW5pbWF0ZSh7InRleHQtaW5kZW50IjoxfSx7ZHVyYXRpb246MjAwLGVhc2luZzoic3dpbmciLHN0ZXA6ZnVuY3Rpb24odCxyKXtyLnN0YXJ0PWksci5lbmQ9bixlLmNzcygidHJhbnNmb3JtIiwic2NhbGUoIit0KyIsICIrdCsiKSIpfSxhbHdheXM6ZnVuY3Rpb24oKXtyLnJlc29sdmUoZSl9fSksci5wcm9taXNlfWZ1bmN0aW9uIG4oZSxpLG4pe3ZhciByPXQuZGVmZXIoKTtyZXR1cm4gZS5hbmltYXRlKHsidGV4dC1pbmRlbnQiOjF9LHtkdXJhdGlvbjoxNTAsZWFzaW5nOiJzd2luZyIsc3RlcDpmdW5jdGlvbih0LHIpe3Iuc3RhcnQ9aSxyLmVuZD1uLGUuY3NzKCJ0cmFuc2Zvcm0iLCJyb3RhdGUoIit0KyJkZWcpIil9LGFsd2F5czpmdW5jdGlvbigpe3IucmVzb2x2ZShlKX19KSxyLnByb21pc2V9dmFyIHI9MjAwLHM9e307cmV0dXJuIHMuc3dhcFBhZ2VzPWZ1bmN0aW9uKGkpe3ZhciBuPXQuZGVmZXIoKSxzPWkuJHBhcmVudCxvPWkuJG9sZFJvb3QsYT1pLiRuZXdSb290LGw9aS5zdWNjZXNzLGM9aS5jdHgsdT0idHJhbnNpdGlvbi1mcm9tLXJpZ2h0IjtyZXR1cm4gaS5kaXImJmkuZGlyPT09ZS5ESVJFQ1RJT05fQkFDSyYmKHU9InRyYW5zaXRpb24tZnJvbS1sZWZ0IiksYS5hZGRDbGFzcyh1KSxzLmFwcGVuZChhKSxzLmFkZENsYXNzKCJhbmltYXRpb24tY29udGFpbmVyLW92ZXJmbG93IiksYS5hbmltYXRlKHtsZWZ0OiIwcHgiLHRvcDoiMHB4IixvcGFjaXR5OjF9LHIsZnVuY3Rpb24oKXtzLnJlbW92ZUNsYXNzKCJhbmltYXRpb24tY29udGFpbmVyLW92ZXJmbG93IiksYS5yZW1vdmVDbGFzcyh1KSxhLnJlbW92ZUF0dHIoInN0eWxlIiksbC5jYWxsKGMpLG4ucmVzb2x2ZSgpfSksby5hbmltYXRlKHtoZWlnaHQ6YS5oZWlnaHQoKSxvcGFjaXR5OjB9LC44KnIpLG4ucHJvbWlzZX0scy5zd2FwQmVhY29ucz1mdW5jdGlvbih0KXt2YXIgZT10LiRlbCxpPXQuc3dhcCxuPXQuY3R4O3JldHVybiB0aGlzLmltcGxvZGUoZSkudGhlbihmdW5jdGlvbigpe3JldHVybiBpLmNhbGwobiksZX0pLnRoZW4odGhpcy5leHBsb2RlKX0scy5leHBsb2RlPWZ1bmN0aW9uKHQpe3JldHVybiBpKHQsMCwxKX0scy5pbXBsb2RlPWZ1bmN0aW9uKHQpe3JldHVybiBpKHQsMSwwKX0scy5yYWRpYWxQcm9ncmVzc0Jhcj1mdW5jdGlvbih0KXt2YXIgZT10LiRlbCxpPXQuc3dhcCxyPWUuY2hpbGRyZW4oKTtyZXR1cm4gbihyLDAsMTgwKS50aGVuKGZ1bmN0aW9uKCl7ZS5jc3Moe2NsaXA6ImF1dG8ifSl9KS50aGVuKGZ1bmN0aW9uKCl7dmFyIHQ9ci5lcSgwKTtyZXR1cm4gaSgpLG4odCwxODAsMzYwKX0pLnRoZW4oZnVuY3Rpb24oKXtlLmNzcyh7Y2xpcDoicmVjdCgwcHgsIDk2cHgsIDk2cHgsIDQ4cHgpIn0pLHIuY3NzKHt0cmFuc2Zvcm06InJvdGF0ZSgwZGVnKSIsInRleHQtaW5kZW50IjoiMXB4In0pfSl9LHN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9ImJlYWNvbi1ibGFuayIvPlx0ICAgICAgPGRpdiBjbGFzcz0iYmctaGVscGVyIGF1dGgtYmVhY29uIGF1dGgtYmVhY29uLXNlY3VyaXR5IiBkYXRhLXNlPSJsb2FkaW5nLWJlYWNvbiI+XHQgICAgICA8ZGl2IGNsYXNzPSJva3RhLXNpZ24taW4tYmVhY29uLWJvcmRlciBhdXRoLWJlYWNvbi1ib3JkZXIganMtYXV0aC1iZWFjb24tYm9yZGVyIi8+XHQgICAgICA8L2Rpdj5cdCAgICAnLGVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcyBpbnN0YW5jZW9mIHR9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMTMpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0LGUpe3ZhciBpPWUuZ2V0KCJzZWN1cml0eUltYWdlIiksbj1lLmdldCgic2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uIikscj1lLmdldCgiaXNVbmRlZmluZWRVc2VyIikscz1lLmdldCgiaXNOZXdVc2VyIiksYT0hciYmIXM7cmV0dXJuIHQuY3NzKCJiYWNrZ3JvdW5kLWltYWdlIiwiIiksdC5yZW1vdmVDbGFzcygibmV3LXVzZXIgdW5kZWZpbmVkLXVzZXIiKSxzP3ZvaWQgdC5hZGRDbGFzcygibmV3LXVzZXIiKTpyP3ZvaWQgdC5hZGRDbGFzcygidW5kZWZpbmVkLXVzZXIiKTphPyh0LnJlbW92ZUF0dHIoImFyaWEtZGVzY3JpYmVkYnkiKSx0LmZpbmQoIi5hY2Nlc3NpYmlsaXR5LXRleHQiKS50ZXh0KG4pLHZvaWQgdC5jc3MoImJhY2tncm91bmQtaW1hZ2UiLCJ1cmwoIitvLmVzY2FwZShpKSsiKSIpKTp2b2lkIDB9ZnVuY3Rpb24gbihlLGkpe2Eod2luZG93KS5vbigicmVzaXplLnNlY3VyaXR5QmVhY29uUXRpcCIsby5kZWJvdW5jZShmdW5jdGlvbigpe2UuaXMoIjp2aXNpYmxlIikmJmUucXRpcCgic2hvdyIpfSwzMDApKSxlLnF0aXAoe3ByZXJlbmRlcjohMCxjb250ZW50Ont0ZXh0OnQubG9jKCJwcmltYXJ5YXV0aC5uZXdVc2VyLnRvb2x0aXAiLCJsb2dpbiIsW28uZXNjYXBlKGkpXSksYnV0dG9uOnQubG9jKCJwcmltYXJ5YXV0aC5uZXdVc2VyLnRvb2x0aXAuY2xvc2UiLCJsb2dpbiIpfSxzdHlsZTp7Y2xhc3Nlczoib2t0YS1zZWN1cml0eS1pbWFnZS10b29sdGlwIHNlY3VyaXR5LWltYWdlLXF0aXAgcXRpcC1jdXN0b20gcXRpcC1zaGFkb3cgcXRpcC1yb3VuZGVkIix0aXA6e2hlaWdodDoxMix3aWR0aDoxNn19LHBvc2l0aW9uOntteToidG9wIGNlbnRlciIsYXQ6ImNlbnRlciIsdGFyZ2V0OmEoIi5hdXRoLWJlYWNvbi1zZWN1cml0eSIpLGFkanVzdDp7bWV0aG9kOiJmbGlwIixzY3JvbGw6ITEscmVzaXplOiEwfSxlZmZlY3Q6ITF9LGhpZGU6e2V2ZW50OiExLGZpeGVkOiEwfSxzaG93OntldmVudDohMSxkZWxheToyMDB9LGV2ZW50czp7bW92ZTpmdW5jdGlvbih0LGUpe2UuZWxlbWVudHMudGFyZ2V0LmlzKCI6dmlzaWJsZSIpfHwoZS5zZXQoImhpZGUuZWZmZWN0IiwhMSksZS5oaWRlKCksZS5zZXQoImhpZGUuZWZmZWN0IiwhMCkpfX19KSxlLnF0aXAoInRvZ2dsZSIsZS5pcygiOnZpc2libGUiKSl9ZnVuY3Rpb24gcih0KXt0LnF0aXAoImRlc3Ryb3kiKSxhKHdpbmRvdykub2ZmKCJyZXNpemUuc2VjdXJpdHlCZWFjb25RdGlwIil9ZnVuY3Rpb24gcyh0LHMsbyl7dmFyIGE9dC5maW5kKCIuYXV0aC1iZWFjb24tc2VjdXJpdHkiKSxsPXQuZmluZCgiLmpzLWF1dGgtYmVhY29uLWJvcmRlciIpLGM9IXMuZ2V0KCJpc1VuZGVmaW5lZFVzZXIiKSx1PXMuZ2V0KCJpc05ld1VzZXIiKSxkPXQuZmluZCgiLnJhZGlhbC1wcm9ncmVzcy1iYXIiKSxoPXMuZ2V0KCJiYXNlVXJsIikubWF0Y2goL2h0dHBzPzpcL1wvKC5bXlwvXSspLylbMV0scD0yMDA7cmV0dXJuIG8/KHIoYSksdm9pZChjPyhsLnJlbW92ZUNsYXNzKCJhdXRoLWJlYWNvbi1ib3JkZXIiKSxlLnJhZGlhbFByb2dyZXNzQmFyKHskZWw6ZCxzd2FwOmZ1bmN0aW9uKCl7YS5mYWRlT3V0KHAsZnVuY3Rpb24oKXtpKGEscyksYS5mYWRlSW4ocCl9KX19KS50aGVuKGZ1bmN0aW9uKCl7bC5hZGRDbGFzcygiYXV0aC1iZWFjb24tYm9yZGVyIil9KS50aGVuKGZ1bmN0aW9uKCl7dSYmbihhLGgpfSkpOmEuZmFkZU91dChwLGZ1bmN0aW9uKCl7aShhLHMpLGwucmVtb3ZlQ2xhc3MoImF1dGgtYmVhY29uLWJvcmRlciIpLGEuZmFkZUluKHApfSkpKTooaShhLHMpLHZvaWQgbC50b2dnbGVDbGFzcygiYXV0aC1iZWFjb24tYm9yZGVyIixjKSl9dmFyIG89dC5fLGE9dC4kO3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgPGRpdiBjbGFzcz0iYmVhY29uLWJsYW5rIj5cdCAgICAgIDxkaXYgY2xhc3M9InJhZGlhbC1wcm9ncmVzcy1iYXIiPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJjaXJjbGUgbGVmdCI+PC9kaXY+XHQgICAgICAgIDxkaXYgY2xhc3M9ImNpcmNsZSByaWdodCI+PC9kaXY+XHQgICAgICA8L2Rpdj5cdCAgICA8L2Rpdj5cdCAgICA8ZGl2IGFyaWEtbGl2ZT0icG9saXRlIiByb2xlPSJpbWFnZSIgY2xhc3M9ImJnLWhlbHBlciBhdXRoLWJlYWNvbiBhdXRoLWJlYWNvbi1zZWN1cml0eSIgZGF0YS1zZT0ic2VjdXJpdHktYmVhY29uIj5cdCAgICAgIDxzcGFuIGNsYXNzPSJhY2Nlc3NpYmlsaXR5LXRleHQiPjwvc3Bhbj5cdCAgICAgIDxkaXYgY2xhc3M9Im9rdGEtc2lnbi1pbi1iZWFjb24tYm9yZGVyIGF1dGgtYmVhY29uLWJvcmRlciBqcy1hdXRoLWJlYWNvbi1ib3JkZXIiPlx0ICAgICAgPC9kaXY+XHQgICAgPC9kaXY+XHQgICAgJyxjbGFzc05hbWU6ImpzLXNlY3VyaXR5LWJlYWNvbiIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLnVwZGF0ZT1vLnBhcnRpYWwocyx0aGlzLiRlbCx0LmFwcFN0YXRlKSx0aGlzLmxpc3RlblRvKHQuYXBwU3RhdGUsImNoYW5nZTpzZWN1cml0eUltYWdlIix0aGlzLnVwZGF0ZSksdGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJsb2FkaW5nIixmdW5jdGlvbih0KXt0aGlzLiRlbC50b2dnbGVDbGFzcygiYmVhY29uLWxvYWRpbmciLHQpLHRoaXMucmVtb3ZlQW50aVBoaXNoaW5nTWVzc2FnZSgpfSksdGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgiYmVhY29uVHlwZSIsInNlY3VyaXR5IiksdGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJuYXZpZ2F0ZSIsdGhpcy5yZW1vdmVBbnRpUGhpc2hpbmdNZXNzYWdlKX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMudXBkYXRlKCExKX0sZXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzIGluc3RhbmNlb2YgdH0scmVtb3ZlQW50aVBoaXNoaW5nTWVzc2FnZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuJGVsLmZpbmQoIi5hdXRoLWJlYWNvbi1zZWN1cml0eSIpO3QucXRpcCgiZGVzdHJveSIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpLGkoMzE3KSxpKDE4MiksaSgzMDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7ZnVuY3Rpb24gcyh0LGkpe3ZhciBuPV8oe2Jhc2VVcmw6dCx1c2VybmFtZTppfSk7cmV0dXJuIGEuaXNFbXB0eShpKXx8YS5pc1VuZGVmaW5lZChpKT9lKHtzZWN1cml0eUltYWdlOmQsc2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uOmZ9KTplKGwuZ2V0KG4pKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiB0LnB3ZEltZz09PXU/e3NlY3VyaXR5SW1hZ2U6aCxzZWN1cml0eUltYWdlRGVzY3JpcHRpb246cH06e3NlY3VyaXR5SW1hZ2U6dC5wd2RJbWcsc2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uOnQuaW1hZ2VEZXNjcmlwdGlvbnx8bX19KX1mdW5jdGlvbiBvKGUpe2lmKGU+NjAmJmU8PTE0NDApe3ZhciBpPWUvNjA7cmV0dXJuIHQubG9jKCJob3VycyIsImxvZ2luIixbaV0pfWlmKGU+MTQ0MCl7dmFyIG49ZS8xNDQwO3JldHVybiB0LmxvYygiZGF5cyIsImxvZ2luIixbbl0pfXJldHVybiAxPT09ZT90LmxvYygibWludXRlcy5vbmVNaW51dGUiLCJsb2dpbiIpOnQubG9jKCJtaW51dGVzIiwibG9naW4iLFtlXSl9dmFyIGE9dC5fLGw9dC4kLGM9dC5IYW5kbGViYXJzLmNvbXBpbGUsdT0iL2ltZy9zZWN1cml0eS91bmtub3duLnBuZyIsZD0iL2ltZy9zZWN1cml0eS9kZWZhdWx0LnBuZyIsaD0iL2ltZy9zZWN1cml0eS91bmtub3duLWRldmljZS5wbmciLHA9IiIsZj0iIixtPSIiLF89Yygie3tiYXNlVXJsfX0vbG9naW4vZ2V0aW1hZ2U/dXNlcm5hbWU9e3t1c2VybmFtZX19Iik7cmV0dXJuIHQuTW9kZWwuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7aWYodGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnNlY3VyaXR5SW1hZ2UiKSl7dmFyIGU9dGhpczt0aGlzLmxpc3RlblRvKHRoaXMsImNoYW5nZTp1c2VybmFtZSIsZnVuY3Rpb24oaSxvKXtzKHRoaXMuZ2V0KCJiYXNlVXJsIiksbykudGhlbihmdW5jdGlvbih0KXtpLnNldCgic2VjdXJpdHlJbWFnZSIsdC5zZWN1cml0eUltYWdlKSxpLnNldCgic2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uIix0LnNlY3VyaXR5SW1hZ2VEZXNjcmlwdGlvbil9KS5mYWlsKGZ1bmN0aW9uKGkpe2lmKCFuLmNvcnNJc05vdEVuYWJsZWQoaSkpdGhyb3cgaTtlLnNldHRpbmdzLmNhbGxHbG9iYWxFcnJvcihuZXcgci5VbnN1cHBvcnRlZEJyb3dzZXJFcnJvcih0LmxvYygiZXJyb3IuZW5hYmxlZC5jb3JzIikpKX0pLmRvbmUoKX0pfX0sbG9jYWw6e2Jhc2VVcmw6InN0cmluZyIsbGFzdEF1dGhSZXNwb25zZTpbIm9iamVjdCIsITAse31dLHRyYW5zYWN0aW9uOiJvYmplY3QiLHRyYW5zYWN0aW9uRXJyb3I6Im9iamVjdCIsdXNlcm5hbWU6InN0cmluZyIsZmFjdG9yczoib2JqZWN0Iixwb2xpY3k6Im9iamVjdCIsc2VjdXJpdHlJbWFnZTpbInN0cmluZyIsITAsZF0sc2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uOlsic3RyaW5nIiwhMCxmXSx1c2VyQ291bnRyeUNvZGU6InN0cmluZyIsdXNlclBob25lTnVtYmVyOiJzdHJpbmciLGZhY3RvckFjdGl2YXRpb25UeXBlOiJzdHJpbmciLGZsYXNoRXJyb3I6Im9iamVjdCIsYmVhY29uVHlwZToic3RyaW5nIixsYW5ndWFnZUNvZGU6WyJzdHJpbmciLCEwXX0sc2V0QXV0aFJlc3BvbnNlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYodC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLnBvbGljeSYmdGhpcy5zZXQoInBvbGljeSIsdC5fZW1iZWRkZWQucG9saWN5KSx0Ll9lbWJlZGRlZCYmdC5fZW1iZWRkZWQuZmFjdG9ycyl7dmFyIG49dGhpcy5zZXR0aW5ncyxyPWEubWFwKHQuX2VtYmVkZGVkLmZhY3RvcnMsZnVuY3Rpb24odCl7cmV0dXJuIHQuc2V0dGluZ3M9bix0LmFwcFN0YXRlPWUsdH0pO3RoaXMuc2V0KCJmYWN0b3JzIixuZXcgaS5Db2xsZWN0aW9uKHIse3BhcnNlOiEwfSkpfXRoaXMuc2V0KCJsYXN0QXV0aFJlc3BvbnNlIix0KX0sZGVyaXZlZDp7aXNTdWNjZXNzUmVzcG9uc2U6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlNVQ0NFU1MiPT09dC5zdGF0dXN9fSxpc01mYVJlcXVpcmVkOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiJNRkFfUkVRVUlSRUQiPT09dC5zdGF0dXN9fSxpc01mYUVucm9sbDp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4iTUZBX0VOUk9MTCI9PT10LnN0YXR1c319LGlzTWZhQ2hhbGxlbmdlOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiJNRkFfQ0hBTExFTkdFIj09PXQuc3RhdHVzfX0saXNVbmF1dGhlbnRpY2F0ZWQ6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlVOQVVUSEVOVElDQVRFRCI9PT10LnN0YXR1c319LGlzTWZhUmVqZWN0ZWRCeVVzZXI6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlJFSkVDVEVEIj09PXQuZmFjdG9yUmVzdWx0fX0saXNNZmFUaW1lb3V0OntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiJUSU1FT1VUIj09PXQuZmFjdG9yUmVzdWx0fX0saXNNZmFFbnJvbGxBY3RpdmF0ZTp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4iTUZBX0VOUk9MTF9BQ1RJVkFURSI9PT10LnN0YXR1c319LGlzV2FpdGluZ0ZvckFjdGl2YXRpb246e2RlcHM6WyJpc01mYUVucm9sbEFjdGl2YXRlIiwibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQmJiJXQUlUSU5HIj09PWUuZmFjdG9yUmVzdWx0fX0saGFzTWZhUmVxdWlyZWRPcHRpb25zOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSIsImZhY3RvcnMiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybigiTUZBX1JFUVVJUkVEIj09PXQuc3RhdHVzfHwiTUZBX0NIQUxMRU5HRSI9PT10LnN0YXR1cykmJihlJiZlLmxlbmd0aD4xKX19LHVzZXJJZDp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLnVzZXI/dC5fZW1iZWRkZWQudXNlci5pZDpudWxsfX0saXNQd2RFeHBpcmluZ1Nvb246e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlBBU1NXT1JEX1dBUk4iPT09dC5zdGF0dXN9fSxwYXNzd29yZEV4cGlyZURheXM6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2VtYmVkZGVkJiZ0Ll9lbWJlZGRlZC5wb2xpY3kmJnQuX2VtYmVkZGVkLnBvbGljeS5leHBpcmF0aW9uP3QuX2VtYmVkZGVkLnBvbGljeS5leHBpcmF0aW9uLnBhc3N3b3JkRXhwaXJlRGF5czpudWxsfX0saXNQd2RNYW5hZ2VkQnlPa3RhOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiEodC5fbGlua3MmJnQuX2xpbmtzLm5leHQmJnQuX2xpbmtzLm5leHQudGl0bGUpfX0scGFzc3dvcmRFeHBpcmVkV2Vic2l0ZU5hbWU6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xpbmtzJiZ0Ll9saW5rcy5uZXh0JiZ0Ll9saW5rcy5uZXh0LnRpdGxlP3QuX2xpbmtzLm5leHQudGl0bGU6bnVsbH19LHBhc3N3b3JkRXhwaXJlZExpbmtVcmw6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xpbmtzJiZ0Ll9saW5rcy5uZXh0JiZ0Ll9saW5rcy5uZXh0LnRpdGxlJiZ0Ll9saW5rcy5uZXh0LmhyZWY/dC5fbGlua3MubmV4dC5ocmVmOm51bGx9fSxyZWNvdmVyeVR5cGU6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVjb3ZlcnlUeXBlfX0sZmFjdG9yVHlwZTp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5mYWN0b3JUeXBlfX0sZmFjdG9yOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0Ll9lbWJlZGRlZCYmdC5fZW1iZWRkZWQuZmFjdG9yP3QuX2VtYmVkZGVkLmZhY3RvcjpudWxsfX0sYWN0aXZhdGVkRmFjdG9ySWQ6e2RlcHM6WyJmYWN0b3IiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdD90LmlkOm51bGx9fSxhY3RpdmF0ZWRGYWN0b3JUeXBlOntkZXBzOlsiZmFjdG9yIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQ/dC5mYWN0b3JUeXBlOm51bGx9fSxhY3RpdmF0ZWRGYWN0b3JQcm92aWRlcjp7ZGVwczpbImZhY3RvciJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0P3QucHJvdmlkZXI6bnVsbH19LHFyY29kZTp7ZGVwczpbImZhY3RvciJdLGZuOmZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4gdC5fZW1iZWRkZWQuYWN0aXZhdGlvbi5fbGlua3MucXJjb2RlLmhyZWZ9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fX0sYWN0aXZhdGlvblNlbmRMaW5rczp7ZGVwczpbImZhY3RvciJdLGZuOmZ1bmN0aW9uKHQpe3ZhciBlO3RyeXtlPXQuX2VtYmVkZGVkLmFjdGl2YXRpb24uX2xpbmtzLnNlbmR9Y2F0Y2goaSl7ZT1bXQ==", "base64"));
  res.write(new Buffer("fXJldHVybiBlfX0sdGV4dEFjdGl2YXRpb25MaW5rVXJsOntkZXBzOlsiYWN0aXZhdGlvblNlbmRMaW5rcyJdLGZuOmZ1bmN0aW9uKHQpe3ZhciBlPWEuZmluZFdoZXJlKHQse25hbWU6InNtcyJ9KTtyZXR1cm4gZT9lLmhyZWY6bnVsbH19LGVtYWlsQWN0aXZhdGlvbkxpbmtVcmw6e2RlcHM6WyJhY3RpdmF0aW9uU2VuZExpbmtzIl0sZm46ZnVuY3Rpb24odCl7dmFyIGU9YS5maW5kV2hlcmUodCx7bmFtZToiZW1haWwifSk7cmV0dXJuIGU/ZS5ocmVmOm51bGx9fSxzaGFyZWRTZWNyZXQ6e2RlcHM6WyJmYWN0b3IiXSxmbjpmdW5jdGlvbih0KXt0cnl7cmV0dXJuIHQuX2VtYmVkZGVkLmFjdGl2YXRpb24uc2hhcmVkU2VjcmV0fWNhdGNoKGUpe3JldHVybiBudWxsfX19LGR1b0Vucm9sbEFjdGl2YXRpb246e2RlcHM6WyJmYWN0b3IiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLmFjdGl2YXRpb24/dC5fZW1iZWRkZWQuYWN0aXZhdGlvbjpudWxsfX0scHJldkxpbms6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xpbmtzJiZ0Ll9saW5rcy5wcmV2P3QuX2xpbmtzLnByZXYuaHJlZjpudWxsfX0sdXNlcjp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLnVzZXI/dC5fZW1iZWRkZWQudXNlcjpudWxsfX0scmVjb3ZlcnlRdWVzdGlvbjp7ZGVwczpbInVzZXIiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5yZWNvdmVyeV9xdWVzdGlvbj90LnJlY292ZXJ5X3F1ZXN0aW9uLnF1ZXN0aW9uOm51bGx9fSx1c2VyUHJvZmlsZTp7ZGVwczpbInVzZXIiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5wcm9maWxlP3QucHJvZmlsZTpudWxsfX0sdXNlckVtYWlsOntkZXBzOlsidXNlclByb2ZpbGUiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5sb2dpbj90LmxvZ2luOm51bGx9fSx1c2VyRnVsbE5hbWU6e2RlcHM6WyJ1c2VyUHJvZmlsZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0JiYodC5maXJzdE5hbWV8fHQubGFzdE5hbWUpP3QuZmlyc3ROYW1lKyIgIit0Lmxhc3ROYW1lOiIifX0saGFzRXhpc3RpbmdQaG9uZXM6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7aWYoIXQuX2VtYmVkZGVkfHwhdC5fZW1iZWRkZWQuZmFjdG9ycylyZXR1cm4hMTt2YXIgZT10Ll9lbWJlZGRlZC5mYWN0b3JzLGk9YS5maW5kV2hlcmUoZSx7ZmFjdG9yVHlwZToic21zIixwcm92aWRlcjoiT0tUQSJ9KTtyZXR1cm4hKCFpfHwhaS5fZW1iZWRkZWQpJiYhIWkuX2VtYmVkZGVkLnBob25lcy5sZW5ndGh9fSxoYXNFeGlzdGluZ1Bob25lc0ZvckNhbGw6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7aWYoIXQuX2VtYmVkZGVkfHwhdC5fZW1iZWRkZWQuZmFjdG9ycylyZXR1cm4hMTt2YXIgZT10Ll9lbWJlZGRlZC5mYWN0b3JzLGk9YS5maW5kV2hlcmUoZSx7ZmFjdG9yVHlwZToiY2FsbCIscHJvdmlkZXI6Ik9LVEEifSk7cmV0dXJuISghaXx8IWkuX2VtYmVkZGVkKSYmISFpLl9lbWJlZGRlZC5waG9uZXMubGVuZ3RofX0saXNVbmRlZmluZWRVc2VyOntkZXBzOlsic2VjdXJpdHlJbWFnZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0PT09ZH19LGlzTmV3VXNlcjp7ZGVwczpbInNlY3VyaXR5SW1hZ2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdD09PWh9fSxhbGxvd1JlbWVtYmVyRGV2aWNlOntkZXBzOlsicG9saWN5Il0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuYWxsb3dSZW1lbWJlckRldmljZX19LHJlbWVtYmVyRGV2aWNlTGFiZWw6e2RlcHM6WyJwb2xpY3kiXSxmbjpmdW5jdGlvbihlKXtpZihlJiZlLnJlbWVtYmVyRGV2aWNlTGlmZXRpbWVJbk1pbnV0ZXM+MCl7dmFyIGk9byhlLnJlbWVtYmVyRGV2aWNlTGlmZXRpbWVJbk1pbnV0ZXMpO3JldHVybiB0LmxvYygicmVtZW1iZXJEZXZpY2UudGltZWJhc2VkIiwibG9naW4iLFtpXSl9cmV0dXJuIGUmJjA9PT1lLnJlbWVtYmVyRGV2aWNlTGlmZXRpbWVJbk1pbnV0ZXM/dC5sb2MoInJlbWVtYmVyRGV2aWNlLmRldmljZWJhc2VkIiwibG9naW4iKTp0LmxvYygicmVtZW1iZXJEZXZpY2UiLCJsb2dpbiIpfX0scmVtZW1iZXJEZXZpY2VCeURlZmF1bHQ6e2RlcHM6WyJwb2xpY3kiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5yZW1lbWJlckRldmljZUJ5RGVmYXVsdH19fSxwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXR0aW5ncz10LnNldHRpbmdzLGEuZXh0ZW5kKGEub21pdCh0LCJzZXR0aW5ncyIpLHtsYW5ndWFnZUNvZGU6dGhpcy5zZXR0aW5ncy5nZXQoImxhbmd1YWdlQ29kZSIpfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMSksaSgyOTQpLGkoMjk4KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll8scz02ZTMsbz1uLmV4dGVuZCh7ZXh0cmFQcm9wZXJ0aWVzOiEwLGZsYXQ6ITEscHJvcHM6e2lkOiJzdHJpbmciLGZhY3RvclR5cGU6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsic21zIiwiY2FsbCIsImVtYWlsIiwidG9rZW4iLCJ0b2tlbjpzb2Z0d2FyZTp0b3RwIiwidG9rZW46aGFyZHdhcmUiLCJxdWVzdGlvbiIsInB1c2giLCJ1MmYiXX0scHJvdmlkZXI6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiT0tUQSIsIlJTQSIsIkRFTF9PQVRIIiwiU1lNQU5URUMiLCJHT09HTEUiLCJZVUJJQ08iLCJGSURPIl19LGVucm9sbG1lbnQ6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiT1BUSU9OQUwiLCJSRVFVSVJFRCJdfSxzdGF0dXM6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiTk9UX1NFVFVQIiwiQUNUSVZFIl19LHByb2ZpbGU6WyJvYmplY3QiXSx2ZW5kb3JOYW1lOiJzdHJpbmcifSxsb2NhbDp7YW5zd2VyOiJzdHJpbmciLGJhY2t1cEZhY3Rvcjoib2JqZWN0IixzaG93QW5zd2VyOiJib29sZWFuIixyZW1lbWJlckRldmljZToiYm9vbGVhbiIsYXV0b1B1c2g6WyJib29sZWFuIiwhMCwhMV19LGRlcml2ZWQ6e2lzT2t0YUZhY3Rvcjp7ZGVwczpbInByb3ZpZGVyIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIk9LVEEiPT09dH19LGZhY3Rvck5hbWU6e2RlcHM6WyJwcm92aWRlciIsImZhY3RvclR5cGUiXSxmbjppLmdldEZhY3Rvck5hbWV9LGZhY3RvckxhYmVsOntkZXBzOlsicHJvdmlkZXIiLCJmYWN0b3JUeXBlIiwidmVuZG9yTmFtZSJdLGZuOmZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4iREVMX09BVEgiPT09dD9uOmkuZ2V0RmFjdG9yTGFiZWwodCxlKX19LGZhY3RvckRlc2NyaXB0aW9uOntkZXBzOlsicHJvdmlkZXIiLCJmYWN0b3JUeXBlIl0sZm46aS5nZXRGYWN0b3JEZXNjcmlwdGlvbn0sc29ydE9yZGVyOntkZXBzOlsicHJvdmlkZXIiLCJmYWN0b3JUeXBlIl0sZm46aS5nZXRGYWN0b3JTb3J0T3JkZXJ9LGljb25DbGFzc05hbWU6e2RlcHM6WyJwcm92aWRlciIsImZhY3RvclR5cGUiXSxmbjppLmdldEZhY3Rvckljb25DbGFzc05hbWV9LHNlY3VyaXR5UXVlc3Rpb246e2RlcHM6WyJwcm9maWxlIiwiZmFjdG9yVHlwZSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInF1ZXN0aW9uIiE9PWU/bnVsbDp0JiZpLmdldFNlY3VyaXR5UXVlc3Rpb25MYWJlbCh0KX19LHBob25lTnVtYmVyOntkZXBzOlsicHJvZmlsZSIsImZhY3RvclR5cGUiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiByLmNvbnRhaW5zKFsic21zIiwiY2FsbCJdLGUpP3QmJnQucGhvbmVOdW1iZXI6bnVsbH19LGVtYWlsOntkZXBzOlsicHJvZmlsZSIsImZhY3RvclR5cGUiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiJlbWFpbCI9PT1lP3QmJnQuZW1haWw6bnVsbH19LGRldmljZU5hbWU6e2RlcHM6WyJwcm9maWxlIiwiZmFjdG9yVHlwZSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInB1c2giIT09ZT9udWxsOnQmJnQubmFtZX19LGVucm9sbGVkOntkZXBzOlsic3RhdHVzIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIkFDVElWRSI9PT10fX0scmVxdWlyZWQ6e2RlcHM6WyJlbnJvbGxtZW50Il0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlJFUVVJUkVEIj09PXR9fSxjYW5Vc2VSZXNlbmQ6e2RlcHM6WyJwcm92aWRlciIsImZhY3RvclR5cGUiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiJPS1RBIj09PXQmJnIuY29udGFpbnMoWyJwdXNoIiwic21zIiwiY2FsbCIsImVtYWlsIl0sZSl9fSxpc1NNU0NhbGxvckVtYWlsOntkZXBzOlsiZmFjdG9yVHlwZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiByLmNvbnRhaW5zKFsic21zIiwiY2FsbCIsImVtYWlsIl0sdCl9fX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0dGluZ3M9dC5zZXR0aW5ncyx0aGlzLmFwcFN0YXRlPXQuYXBwU3RhdGUsdC5yZW1lbWJlckRldmljZT1pLmdldFJlbWVtYmVyRGV2aWNlVmFsdWUodGhpcy5hcHBTdGF0ZSksci5vbWl0KHQsWyJzZXR0aW5ncyIsImFwcFN0YXRlIl0pfSx2YWxpZGF0ZTpmdW5jdGlvbigpe2lmKHRoaXMuZ2V0KCJpc1NNU0NhbGxvckVtYWlsIikmJiF0aGlzLmdldCgiYW5zd2VyIikpcmV0dXJue2Fuc3dlcjp0LmxvYygibW9kZWwudmFsaWRhdGlvbi5maWVsZC5ibGFuayIpfX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PSEhdGhpcy5nZXQoInJlbWVtYmVyRGV2aWNlIik7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbihpKXt2YXIgbj17cmVtZW1iZXJEZXZpY2U6dH07InF1ZXN0aW9uIj09PXRoaXMuZ2V0KCJmYWN0b3JUeXBlIik/bi5hbnN3ZXI9dGhpcy5nZXQoImFuc3dlciIpOm4ucGFzc0NvZGU9dGhpcy5nZXQoImFuc3dlciIpO3ZhciBvO2lmKCJNRkFfUkVRVUlSRUQiPT09aS5zdGF0dXMpe3ZhciBhPXIuZmluZFdoZXJlKGkuZmFjdG9ycyx7aWQ6dGhpcy5nZXQoImlkIil9KTtvPWEudmVyaWZ5KG4pfWVsc2UgaWYodGhpcy5nZXQoImNhblVzZVJlc2VuZCIpJiYhdGhpcy5nZXQoImFuc3dlciIpJiZpLnJlc2VuZCl7dmFyIGw9aS5kYXRhLl9saW5rcy5yZXNlbmRbMF07bz1pLnJlc2VuZChsLm5hbWUpfWVsc2Ugbz1pLnZlcmlmeShuKTtyZXR1cm4gdGhpcy50cmlnZ2VyKCJzYXZlIiksby50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiJNRkFfQ0hBTExFTkdFIj09PXQuc3RhdHVzJiZ0LnBvbGw/ZS5kZWxheShzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHQucG9sbChzKX0pOnR9KS5mYWlsKGZ1bmN0aW9uKHQpe3Rocm93IHR9KX0pfX0pLGE9dC5Db2xsZWN0aW9uLmV4dGVuZCh7bW9kZWw6byxjb21wYXJhdG9yOiJzb3J0T3JkZXIiLHBhcnNlOmZ1bmN0aW9uKHQpe3RoaXMubGFzdFVzZWRGYWN0b3I9dFswXTt2YXIgZT1yLmZpbmRXaGVyZSh0LHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToicHVzaCJ9KTtpZighZSlyZXR1cm4gdDt2YXIgaT1yLmZpbmRXaGVyZSh0LHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToidG9rZW46c29mdHdhcmU6dG90cCJ9KSxuPWk9PT10WzBdLHM9ci5yZWR1Y2UodCxmdW5jdGlvbih0LG4pe3ZhciByPSJPS1RBIj09PW4ucHJvdmlkZXIscz1yJiYidG9rZW46c29mdHdhcmU6dG90cCI9PT1uLmZhY3RvclR5cGUsYT1yJiYicHVzaCI9PT1uLmZhY3RvclR5cGUsbD0iQUNUSVZFIiE9PW4uc3RhdHVzLGM9cyYmKGx8fCJBQ1RJVkUiPT09ZS5zdGF0dXMpLHU9YSYmbCYmIkFDVElWRSI9PT1pLnN0YXR1cztyZXR1cm4gY3x8dT90OihhJiYobi5iYWNrdXBGYWN0b3I9bmV3IG8oaSx7cGFyc2U6ITB9KSksdC5wdXNoKG4pLHQpfSxbXSk7cmV0dXJuIG4mJih0aGlzLmxhc3RVc2VkRmFjdG9yPWUpLHN9LGdldERlZmF1bHRGYWN0b3I6ZnVuY3Rpb24oKXt2YXIgdD1yLnBpY2sodGhpcy5sYXN0VXNlZEZhY3RvciwiZmFjdG9yVHlwZSIsInByb3ZpZGVyIik7cmV0dXJuIHRoaXMuZmluZFdoZXJlKHQpfSxnZXRGaXJzdFVuZW5yb2xsZWRSZXF1aXJlZEZhY3RvcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbmRXaGVyZSh7cmVxdWlyZWQ6ITAsZW5yb2xsZWQ6ITF9KX19KTtyZXR1cm57TW9kZWw6byxDb2xsZWN0aW9uOmF9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzE5KSxpKDIxKSxpKDI5NCksaSgyOTUpLGkoMzAxKSxpKDI5NiksaSgzMjApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7dmFyIGw9dC4kLGM9dC5fO3JldHVybiByLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LWR1byBkdW8tZm9ybSIsTW9kZWw6e3Byb3BzOntob3N0OiJzdHJpbmciLHNpZ25hdHVyZToic3RyaW5nIixwb3N0QWN0aW9uOiJzdHJpbmciLGZhY3RvcklkOiJzdHJpbmciLHN0YXRlVG9rZW46InN0cmluZyIscmVtZW1iZXJEZXZpY2U6ImJvb2xlYW4ifSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9bi5nZXRSZW1lbWJlckRldmljZVZhbHVlKHRoaXMuYXBwU3RhdGUpO3RoaXMuc2V0KCJyZW1lbWJlckRldmljZSIsdCk7Cgl9LGdldEluaXRPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9ISF0aGlzLmdldCgicmVtZW1iZXJEZXZpY2UiKTtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPXtyZW1lbWJlckRldmljZTp0fSxuPWMuZmluZFdoZXJlKGUuZmFjdG9ycyx7cHJvdmlkZXI6IkRVTyIsZmFjdG9yVHlwZToid2ViIn0pO3JldHVybiBuLnZlcmlmeShpKS5mYWlsKGZ1bmN0aW9uKHQpe3Rocm93IHR9KX0pfSx2ZXJpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXQoInBvc3RBY3Rpb24iKSxuPXRoaXMuZ2V0KCJmYWN0b3JJZCIpLHI9dGhpcyxzPXtpZDpuLHN0YXRlVG9rZW46dGhpcy5nZXQoInN0YXRlVG9rZW4iKSxzaWdfcmVzcG9uc2U6dH0sbz10aGlzLmdldCgicmVtZW1iZXJEZXZpY2UiKTtyZXR1cm4gaShsLnBvc3QoZSxzKSkudGhlbihmdW5jdGlvbigpe3JldHVybiByLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG8mJihlPXtyZW1lbWJlckRldmljZTpvfSksdC5wb2xsKGUpfSl9KS5mYWlsKGZ1bmN0aW9uKHQpe3IudHJpZ2dlcigiZXJyb3IiLHIsdC54aHIpfSl9fSxGb3JtOnthdXRvU2F2ZTohMCxub0J1dHRvbkJhcjohMCx0aXRsZTpjLnBhcnRpYWwodC5sb2MsImZhY3Rvci5kdW8iKSxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImZhY3Rvci1kdW8ifSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5hZGQoJzxpZnJhbWUgZnJhbWVib3JkZXI9IjAiIHRpdGxlPSInK3RoaXMudGl0bGUoKSsnIj48L2lmcmFtZT4nKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pLGUuaW5pdCh7aG9zdDp0aGlzLm1vZGVsLmdldCgiaG9zdCIpLHNpZ19yZXF1ZXN0OnRoaXMubW9kZWwuZ2V0KCJzaWduYXR1cmUiKSxpZnJhbWU6dGhpcy4kKCJpZnJhbWUiKS5nZXQoMCkscG9zdF9hY3Rpb246Yy5iaW5kKHRoaXMubW9kZWwudmVyaWZ5LHRoaXMubW9kZWwpfSl9fSxGb290ZXI6YSxmZXRjaEluaXRpYWxEYXRhOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5tb2RlbC5nZXRJbml0T3B0aW9ucygpLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9ZS5kYXRhO2lmKCEoaS5fZW1iZWRkZWQmJmkuX2VtYmVkZGVkLmZhY3RvciYmaS5fZW1iZWRkZWQuZmFjdG9yLl9lbWJlZGRlZCYmaS5fZW1iZWRkZWQuZmFjdG9yLl9lbWJlZGRlZC52ZXJpZmljYXRpb24pKXRocm93IG5ldyBFcnJvcigiUmVzcG9uc2UgZG9lcyBub3QgaGF2ZSBkdW8gdmVyaWZpY2F0aW9uIG9wdGlvbnMiKTt2YXIgbj1pLl9lbWJlZGRlZC5mYWN0b3IuX2VtYmVkZGVkLnZlcmlmaWNhdGlvbjt0Lm1vZGVsLnNldCh7aG9zdDpuLmhvc3Qsc2lnbmF0dXJlOm4uc2lnbmF0dXJlLHBvc3RBY3Rpb246bi5fbGlua3MuY29tcGxldGUuaHJlZixmYWN0b3JJZDppLl9lbWJlZGRlZC5mYWN0b3IuaWQsc3RhdGVUb2tlbjppLnN0YXRlVG9rZW59KX0pfSx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFDaGFsbGVuZ2UiKSlyZXR1cm4hMH0sYmFjazpmdW5jdGlvbigpe319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG47bj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt0aHJvdyBuZXcgRXJyb3IoIkR1byBXZWIgU0RLIGVycm9yOiAiK3QrKGU/IlxuU2VlICIrZSsiIGZvciBtb3JlIGluZm9ybWF0aW9uIjoiIikpfWZ1bmN0aW9uIGUodCl7cmV0dXJuIHQucmVwbGFjZSgvKFthLXpdKShbQS1aXSkvLCIkMS0kMiIpLnRvTG93ZXJDYXNlKCl9ZnVuY3Rpb24gaSh0LGkpe3JldHVybiJkYXRhc2V0ImluIHQ/dC5kYXRhc2V0W2ldOnQuZ2V0QXR0cmlidXRlKCJkYXRhLSIrZShpKSl9ZnVuY3Rpb24gbih0LGUsaSxuKXsiYWRkRXZlbnRMaXN0ZW5lciJpbiB3aW5kb3c/dC5hZGRFdmVudExpc3RlbmVyKGUsbiwhMSk6dC5hdHRhY2hFdmVudChpLG4pfWZ1bmN0aW9uIHIodCxlLGksbil7InJlbW92ZUV2ZW50TGlzdGVuZXIiaW4gd2luZG93P3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4sITEpOnQuZGV0YWNoRXZlbnQoaSxuKX1mdW5jdGlvbiBzKHQpe24oZG9jdW1lbnQsIkRPTUNvbnRlbnRMb2FkZWQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLHQpfWZ1bmN0aW9uIG8odCl7cihkb2N1bWVudCwiRE9NQ29udGVudExvYWRlZCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsdCl9ZnVuY3Rpb24gYSh0KXtuKHdpbmRvdywibWVzc2FnZSIsIm9ubWVzc2FnZSIsdCl9ZnVuY3Rpb24gbCh0KXtyKHdpbmRvdywibWVzc2FnZSIsIm9ubWVzc2FnZSIsdCl9ZnVuY3Rpb24gYyhlKXtpZihlKXswPT09ZS5pbmRleE9mKCJFUlJ8IikmJnQoZS5zcGxpdCgifCIpWzFdKSxlLmluZGV4T2YoIjoiKSE9PS0xJiYyPT09ZS5zcGxpdCgiOiIpLmxlbmd0aHx8dCgiRHVvIHdhcyBnaXZlbiBhIGJhZCB0b2tlbi4gIFRoaXMgbWlnaHQgaW5kaWNhdGUgYSBjb25maWd1cmF0aW9uIHByb2JsZW0gd2l0aCBvbmUgb2YgRHVvJ3MgY2xpZW50IGxpYnJhcmllcy4iLCJodHRwczovL3d3dy5kdW9zZWN1cml0eS5jb20vZG9jcy9kdW93ZWIjZmlyc3Qtc3RlcHMiKTt2YXIgaT1lLnNwbGl0KCI6Iik7cmV0dXJuIGc9ZSx2PWlbMF0seT1pWzFdLHtzaWdSZXF1ZXN0OmUsZHVvU2lnOmlbMF0sYXBwU2lnOmlbMV19fX1mdW5jdGlvbiB1KCl7aWYoYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChrKSwhYil0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgcGFnZSBkb2VzIG5vdCBjb250YWluIGFuIGlmcmFtZSBmb3IgRHVvIHRvIHVzZS5BZGQgYW4gZWxlbWVudCBsaWtlIDxpZnJhbWUgaWQ9ImR1b19pZnJhbWUiPjwvaWZyYW1lPiB0byB0aGlzIHBhZ2UuICBTZWUgaHR0cHM6Ly93d3cuZHVvc2VjdXJpdHkuY29tL2RvY3MvZHVvd2ViIzMuLXNob3ctdGhlLWlmcmFtZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4nKTtmKCksbyh1KX1mdW5jdGlvbiBkKHQpe3JldHVybiBCb29sZWFuKHQub3JpZ2luPT09Imh0dHBzOi8vIitfJiYic3RyaW5nIj09dHlwZW9mIHQuZGF0YSYmKHQuZGF0YS5tYXRjaCh3KXx8dC5kYXRhLm1hdGNoKE0pKSl9ZnVuY3Rpb24gaCh0KXt0JiYodC5ob3N0JiYoXz10Lmhvc3QpLHQuc2lnX3JlcXVlc3QmJmModC5zaWdfcmVxdWVzdCksdC5wb3N0X2FjdGlvbiYmKFQ9dC5wb3N0X2FjdGlvbiksdC5wb3N0X2FyZ3VtZW50JiYoUz10LnBvc3RfYXJndW1lbnQpLHQuaWZyYW1lJiYoInRhZ05hbWUiaW4gdC5pZnJhbWU/Yj10LmlmcmFtZToic3RyaW5nIj09dHlwZW9mIHQuaWZyYW1lJiYoaz10LmlmcmFtZSkpKSxiP2YoKTooYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChrKSxiP2YoKTpzKHUpKSxvKGgpfWZ1bmN0aW9uIHAodCl7ZCh0KSYmKG0odC5kYXRhKSxsKHApKX1mdW5jdGlvbiBmKCl7X3x8KF89aShiLCJob3N0IiksX3x8dCgiTm8gQVBJIGhvc3RuYW1lIGlzIGdpdmVuIGZvciBEdW8gdG8gdXNlLiAgQmUgc3VyZSB0byBwYXNzIGEgYGhvc3RgIHBhcmFtZXRlciB0byBEdW8uaW5pdCwgb3IgdGhyb3VnaCB0aGUgYGRhdGEtaG9zdGAgYXR0cmlidXRlIG9uIHRoZSBpZnJhbWUgZWxlbWVudC4iLCJodHRwczovL3d3dy5kdW9zZWN1cml0eS5jb20vZG9jcy9kdW93ZWIjMy4tc2hvdy10aGUtaWZyYW1lIikpLHYmJnl8fChjKGkoYiwic2lnUmVxdWVzdCIpKSx2JiZ5fHx0KCJObyB2YWxpZCBzaWduZWQgcmVxdWVzdCBpcyBnaXZlbi4gIEJlIHN1cmUgdG8gZ2l2ZSB0aGUgYHNpZ19yZXF1ZXN0YCBwYXJhbWV0ZXIgdG8gRHVvLmluaXQsIG9yIHVzZSB0aGUgYGRhdGEtc2lnLXJlcXVlc3RgIGF0dHJpYnV0ZSBvbiB0aGUgaWZyYW1lIGVsZW1lbnQuIiwiaHR0cHM6Ly93d3cuZHVvc2VjdXJpdHkuY29tL2RvY3MvZHVvd2ViIzMuLXNob3ctdGhlLWlmcmFtZSIpKSwiIj09PVQmJihUPWkoYiwicG9zdEFjdGlvbiIpfHxUKSwic2lnX3Jlc3BvbnNlIj09PVMmJihTPWkoYiwicG9zdEFyZ3VtZW50Iil8fFMpLGIuc3JjPVsiaHR0cHM6Ly8iLF8sIi9mcmFtZS93ZWIvdjEvYXV0aD90eD0iLHYsIiZwYXJlbnQ9Iixkb2N1bWVudC5sb2NhdGlvbi5ocmVmXS5qb2luKCIiKSxhKHApfWZ1bmN0aW9uIG0odCl7VCh0KyI6Iit5KX12YXIgXyxnLHYseSxiLHc9L14oPzpBVVRIfEVOUk9MTCkrXHxbQS1aYS16MC05XCtcLz1dK1x8W0EtWmEtejAtOVwrXC89XSskLyxNPS9eRVJSXHxbXHdcc1wuXChcKV0rJC8saz0iZHVvX2lmcmFtZSIsVD0iIixTPSJzaWdfcmVzcG9uc2UiO3JldHVybiBzKGgpLHtpbml0OmgsX3BhcnNlU2lnUmVxdWVzdDpjLF9pc0R1b01lc3NhZ2U6ZH19LmNhbGwoZSxpLGUsdCksLyoqCgkJICogRHVvIFdlYiBTREsgdjIKCQkgKiBDb3B5cmlnaHQgMjAxNSwgRHVvIFNlY3VyaXR5CgkJICovCgkhKHZvaWQgMCE9PW4mJih0LmV4cG9ydHM9bikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMwMSksaSgxOTApXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll87cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIHt7bGlua0NsYXNzTmFtZX19IiBkYXRhLXNlPSJzaWdub3V0LWxpbmsiPlx0ICAgICAgICB7e2xpbmtUZXh0fX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIgY2xlYXJmaXgiLGV2ZW50czp7ImNsaWNrIGEiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKTt2YXIgbj10aGlzO3RoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5jYW5jZWwoKX0pLnRoZW4oZnVuY3Rpb24oKXtuLnNldHRpbmdzLmdldCgic2lnbk91dExpbmsiKT9pLnJlZGlyZWN0KG4uc2V0dGluZ3MuZ2V0KCJzaWduT3V0TGluayIpKToobi5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSxuLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKSl9KX19LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3JldHVybntsaW5rQ2xhc3NOYW1lOm4uaXNVbmRlZmluZWQodGhpcy5vcHRpb25zLmxpbmtDbGFzc05hbWUpPyJnb3RvIjp0aGlzLm9wdGlvbnMubGlua0NsYXNzTmFtZSxsaW5rVGV4dDp0aGlzLm9wdGlvbnMubGlua1RleHR8fHQubG9jKCJzaWdub3V0IiwibG9naW4iKX19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMTApLGkoMjk3KSxpKDMyNCksaSgzMjcpLGkoMzI4KSxpKDMyMiksaSgzMjkpLGkoMzMwKSxpKDMzMSksaSgzMjApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMsdSl7cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6Im1mYS12ZXJpZnkiLGluaXRpYWxpemU6ZnVuY3Rpb24oaSl7dmFyIG4sZD1pLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLGg9aS5mYWN0b3JUeXBlLHA9aS5wcm92aWRlcjtzd2l0Y2goaCl7Y2FzZSJxdWVzdGlvbiI6bj1vO2JyZWFrO2Nhc2Uic21zIjpjYXNlImNhbGwiOmNhc2UiZW1haWwiOm49YTticmVhaztjYXNlInRva2VuIjpjYXNlInRva2VuOnNvZnR3YXJlOnRvdHAiOm49cjticmVhaztjYXNlInRva2VuOmhhcmR3YXJlIjpuPXM7YnJlYWs7Y2FzZSJwdXNoIjpuPWw7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVucmVjb2duaXplZCBmYWN0b3IgdHlwZSIpfWlmKHRoaXMubW9kZWw9ZC5maW5kV2hlcmUoe3Byb3ZpZGVyOnAsZmFjdG9yVHlwZTpofSksIXRoaXMubW9kZWwpdGhyb3cgbmV3IEVycm9yKCJVbnJlY29nbml6ZWQgZmFjdG9yL3Byb3ZpZGVyIik7dGhpcy5hZGRMaXN0ZW5lcnMoKSx0aGlzLmFkZChuZXcgbih0aGlzLnRvSlNPTigpKSksInB1c2giPT09aCYmdGhpcy5tb2RlbC5nZXQoImlzT2t0YUZhY3RvciIpJiYodGhpcy5hZGQoYyx7b3B0aW9uczp7bW9kZWw6dGhpcy5tb2RlbC5nZXQoImJhY2t1cEZhY3RvciIpfX0pLHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5hdXRvUHVzaCIpJiZ0aGlzLmFkZChlLHtvcHRpb25zOnttb2RlbDp0aGlzLm1vZGVsLG5hbWU6ImF1dG9QdXNoIixwbGFjZWhvbGRlcjp0LmxvYygiYXV0b1B1c2giLCJsb2dpbiIpLGxhYmVsOiExLCJsYWJlbC10b3AiOiExLGNsYXNzTmFtZToibWFyZ2luLWJ0bS0wIn19KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkKGUse29wdGlvbnM6e21vZGVsOnRoaXMubW9kZWwsbmFtZToicmVtZW1iZXJEZXZpY2UiLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxsYWJlbDohMSwibGFiZWwtdG9wIjohMCxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCJ9fSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6cmVtZW1iZXJEZXZpY2UiLGZ1bmN0aW9uKHQsZSl7dC5nZXQoImJhY2t1cEZhY3RvciIpLnNldCgicmVtZW1iZXJEZXZpY2UiLGUpfSkpLHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5oaWRlU2lnbk91dExpbmtJbk1GQSIpfHx0aGlzLmFkZChuZXcgdSh0aGlzLnRvSlNPTigpKSl9LHRyYXBBdXRoUmVzcG9uc2U6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUNoYWxsZW5nZSIpJiYhdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFSZXF1aXJlZCIpKXx8KCJwdXNoIj09dGhpcy5vcHRpb25zLmZhY3RvclR5cGUmJih0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuYXV0b1B1c2giKSYmdGhpcy5tb2RlbC5nZXQoImF1dG9QdXNoIik/bi5zZXRBdXRvUHVzaENvb2tpZSh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VySWQiKSk6bi5yZW1vdmVBdXRvUHVzaENvb2tpZSh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VySWQiKSkpLCExKX0sYmFjazpmdW5jdGlvbigpe319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMyMyldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll87cmV0dXJuIHQuRm9ybS5leHRlbmQoe2NsYXNzTmFtZToibWZhLXZlcmlmeS1xdWVzdGlvbiIsYXV0b1NhdmU6ITAsbm9DYW5jZWxCdXR0b246ITAsc2F2ZTppLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxzY3JvbGxPbkVycm9yOiExLGxheW91dDoiby1mb3JtLXRoZW1lIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImZhY3Rvci1xdWVzdGlvbiJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLnRpdGxlPXRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpLHRoaXMuYWRkSW5wdXQoe2xhYmVsOnRoaXMubW9kZWwuZ2V0KCJzZWN1cml0eVF1ZXN0aW9uIiksImxhYmVsLXRvcCI6ITAscGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuYW5zd2VyLnBsYWNlaG9sZGVyIiwibG9naW4iKSxjbGFzc05hbWU6ImF1dGgtcGFzc2NvZGUiLG5hbWU6ImFuc3dlciIsdHlwZToicGFzc3dvcmQiLGlucHV0OmV9KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzA2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6dC50cGwoJ1x0ICAgICAgPGlucHV0IHR5cGU9InBhc3N3b3JkIiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19Ii8+XHQgICAgICA8c3BhbiBjbGFzcz0icGFzc3dvcmQtdG9nZ2xlIj5cdCAgICAgICAgPHNwYW4gY2xhc3M9ImJ1dHRvbiBidXR0b24tZGFyayBidXR0b24tc2hvdyI+XHQgICAgICAgICAge3tpMThuIGNvZGU9Im1mYS5jaGFsbGVuZ2UuYW5zd2VyLnNob3dBbnN3ZXIiIGJ1bmRsZT0ibG9naW4ifX08L3NwYW4+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJidXR0b24gYnV0dG9uLWhpZGUiPnt7aTE4biBjb2RlPSJtZmEuY2hhbGxlbmdlLmFuc3dlci5oaWRlQW5zd2VyIiBidW5kbGU9ImxvZ2luIn19PC9zcGFuPlx0ICAgICAgPC9zcGFuPicpLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmV2ZW50c1siY2xpY2sgLnBhc3N3b3JkLXRvZ2dsZSAuYnV0dG9uLXNob3ciXT0iX3Nob3dQYXNzd29yZCIsdGhpcy5ldmVudHNbImNsaWNrIC5wYXNzd29yZC10b2dnbGUgLmJ1dHRvbi1oaWRlIl09Il9oaWRlUGFzc3dvcmQiLHRoaXMuZGVsZWdhdGVFdmVudHMoKX0sY2hhbmdlVHlwZTpmdW5jdGlvbih0KXtlLnByb3RvdHlwZS5jaGFuZ2VUeXBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiQoIi5wYXNzd29yZC10b2dnbGUiKS50b2dnbGVDbGFzcygicGFzc3dvcmQtdG9nZ2xlLW9uIiwicGFzc3dvcmQiIT09dCl9LF9zaG93UGFzc3dvcmQ6ZnVuY3Rpb24oKXt0aGlzLmNoYW5nZVR5cGUoInRleHQiKX0sX2hpZGVQYXNzd29yZDpmdW5jdGlvbigpe3RoaXMuY2hhbmdlVHlwZSgicGFzc3dvcmQiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMyNSksaSgzMjYpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0KXtzLnJlbW92ZUNvb2tpZSh0LHtwYXRoOiIvIn0pfWZ1bmN0aW9uIG4odCxlKXtzLmNvb2tpZSh0LGUse2V4cGlyZXM6bCxwYXRoOiIvIn0pfWZ1bmN0aW9uIHIodCl7cmV0dXJuIGErZS5nZXRTdHJpbmdIYXNoKHQpfXZhciBzPXQuJCxvPSJsbiIsYT0iYXV0b19wdXNoXyIsbD0zNjUsYz17fTtyZXR1cm4gYy5nZXRDb29raWVVc2VybmFtZT1mdW5jdGlvbigpe3JldHVybiBzLmNvb2tpZShvKX0sYy5zZXRVc2VybmFtZUNvb2tpZT1mdW5jdGlvbih0KXtuKG8sdCl9LGMucmVtb3ZlVXNlcm5hbWVDb29raWU9ZnVuY3Rpb24oKXtpKG8pfSxjLmlzQXV0b1B1c2hFbmFibGVkPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDAhPT10JiYidHJ1ZSI9PT1zLmNvb2tpZShyKHQpKX0sYy5zZXRBdXRvUHVzaENvb2tpZT1mdW5jdGlvbih0KXt2b2lkIDAhPT10JiZuKHIodCksITApfSxjLnJlbW92ZUF1dG9QdXNoQ29va2llPWZ1bmN0aW9uKHQpe3ZvaWQgMCE9PXQmJmkocih0KSl9LGN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuO249ZnVuY3Rpb24oKXt2YXIgdD17fTtyZXR1cm4gdC5nZXRTdHJpbmdIYXNoPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT01MzgxLGk9dC5sZW5ndGg7aTspZT0zMyplXnQuY2hhckNvZGVBdCgtLWkpO3JldHVybiBlPj4+MH0sdH0uY2FsbChlLGksZSx0KSwhKHZvaWQgMCE9PW4mJih0LmV4cG9ydHM9bikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOy8qIQoJCSAqIGpRdWVyeSBDb29raWUgUGx1Z2luIHYxLjQuMQoJCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9jYXJoYXJ0bC9qcXVlcnktY29va2llCgkJICoKCQkgKiBDb3B5cmlnaHQgMjAxMyBLbGF1cyBIYXJ0bAoJCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJCSAqLwoJIWZ1bmN0aW9uKG8pe3I9W2koNildLG49byxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCl7cmV0dXJuIGEucmF3P3Q6ZW5jb2RlVVJJQ29tcG9uZW50KHQpfWZ1bmN0aW9uIGkodCl7cmV0dXJuIGEucmF3P3Q6ZGVjb2RlVVJJQ29tcG9uZW50KHQpfWZ1bmN0aW9uIG4odCl7cmV0dXJuIGUoYS5qc29uP0pTT04uc3RyaW5naWZ5KHQpOlN0cmluZyh0KSl9ZnVuY3Rpb24gcih0KXswPT09dC5pbmRleE9mKCciJykmJih0PXQuc2xpY2UoMSwtMSkucmVwbGFjZSgvXFwiL2csJyInKS5yZXBsYWNlKC9cXFxcL2csIlxcIikpO3RyeXtyZXR1cm4gdD1kZWNvZGVVUklDb21wb25lbnQodC5yZXBsYWNlKG8sIiAiKSksYS5qc29uP0pTT04ucGFyc2UodCk6dH1jYXRjaChlKXt9fWZ1bmN0aW9uIHMoZSxpKXt2YXIgbj1hLnJhdz9lOnIoZSk7cmV0dXJuIHQuaXNGdW5jdGlvbihpKT9pKG4pOm59dmFyIG89L1wrL2csYT10LmNvb2tpZT1mdW5jdGlvbihyLG8sbCl7aWYodm9pZCAwIT09byYmIXQuaXNGdW5jdGlvbihvKSl7aWYobD10LmV4dGVuZCh7fSxhLmRlZmF1bHRzLGwpLCJudW1iZXIiPT10eXBlb2YgbC5leHBpcmVzKXt2YXIgYz1sLmV4cGlyZXMsdT1sLmV4cGlyZXM9bmV3IERhdGU7dS5zZXRUaW1lKCt1Kzg2NGU1KmMpfXJldHVybiBkb2N1bWVudC5jb29raWU9W2UociksIj0iLG4obyksbC5leHBpcmVzPyI7IGV4cGlyZXM9IitsLmV4cGlyZXMudG9VVENTdHJpbmcoKToiIixsLnBhdGg/IjsgcGF0aD0iK2wucGF0aDoiIixsLmRvbWFpbj8iOyBkb21haW49IitsLmRvbWFpbjoiIixsLnNlY3VyZT8iOyBzZWN1cmUiOiIiXS5qb2luKCIiKX1mb3IodmFyIGQ9cj92b2lkIDA6e30saD1kb2N1bWVudC5jb29raWU/ZG9jdW1lbnQuY29va2llLnNwbGl0KCI7ICIpOltdLHA9MCxmPWgubGVuZ3RoO3A8ZjtwKyspe3ZhciBtPWhbcF0uc3BsaXQoIj0iKSxfPWkobS5zaGlmdCgpKSxnPW0uam9pbigiPSIpO2lmKHImJnI9PT1fKXtkPXMoZyxvKTticmVha31yfHx2b2lkIDA9PT0oZz1zKGcpKXx8KGRbX109Zyl9cmV0dXJuIGR9O2EuZGVmYXVsdHM9e30sdC5yZW1vdmVDb29raWU9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdm9pZCAwIT09dC5jb29raWUoZSkmJih0LmNvb2tpZShlLCIiLHQuZXh0ZW5kKHt9LGkse2V4cGlyZXM6LTF9KSksIXQuY29va2llKGUpKX19KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fO3JldHVybiB0LkZvcm0uZXh0ZW5kKHtjbGFzc05hbWU6Im1mYS12ZXJpZnktdG90cCIsYXV0b1NhdmU6ITAsbm9DYW5jZWxCdXR0b246ITAsc2F2ZTppLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxzY3JvbGxPbkVycm9yOiExLGxheW91dDoiby1mb3JtLXRoZW1lIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImZhY3Rvci10b3RwIn0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBpPXRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpLG49IlJTQSI9PT10aGlzLm1vZGVsLmdldCgicHJvdmlkZXIiKXx8IkRFTF9PQVRIIj09PXRoaXMubW9kZWwuZ2V0KCJwcm92aWRlciIpO3RoaXMudGl0bGU9aSx0aGlzLnN1YnRpdGxlPXQubG9jKCJtZmEuY2hhbGxlbmdlLnRpdGxlIiwibG9naW4iLFtpXSksdGhpcy5hZGRJbnB1dCh7bGFiZWw6ITEsImxhYmVsLXRvcCI6ITAscGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuZW50ZXJDb2RlLnBsYWNlaG9sZGVyIiwibG9naW4iKSxjbGFzc05hbWU6Im8tZm9ybS1maWVsZHNldCBvLWZvcm0tbGFiZWwtdG9wIGF1dGgtcGFzc2NvZGUiLG5hbWU6ImFuc3dlciIsaW5wdXQ6ZSx0eXBlOm4/InBhc3N3b3JkIjoidGV4dCJ9KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzA2KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXQuXztyZXR1cm4gdC5Gb3JtLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LXl1YmlrZXkiLGF1dG9TYXZlOiEwLG5vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6aS5wYXJ0aWFsKHQubG9jLCJtZmEuY2hhbGxlbmdlLnZlcmlmeSIsImxvZ2luIiksc2Nyb2xsT25FcnJvcjohMSxsYXlvdXQ6Im8tZm9ybS10aGVtZSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJmYWN0b3IteXViaWtleSJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgaT10aGlzLm1vZGVsLmdldCgiZmFjdG9yTGFiZWwiKTt0aGlzLnRpdGxlPWksdGhpcy5zdWJ0aXRsZT10LmxvYygiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkuZGVzY3JpcHRpb24iLCJsb2dpbiIpLHRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLGNsYXNzTmFtZToiby1mb3JtLWZpZWxkc2V0IG8tZm9ybS1sYWJlbC10b3AgYXV0aC1wYXNzY29kZSIsbmFtZToiYW5zd2VyIixpbnB1dDplLHR5cGU6InBhc3N3b3JkIixwbGFjZWhvbGRlcjp0LmxvYygiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkucGxhY2Vob2xkZXIiLCJsb2dpbiIpfSksdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWxsb3dSZW1lbWJlckRldmljZSIpJiZ0aGlzLmFkZElucHV0KHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIscGxhY2Vob2xkZXI6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicmVtZW1iZXJEZXZpY2VMYWJlbCIpLG5hbWU6InJlbWVtYmVyRGV2aWNlIix0eXBlOiJjaGVja2JveCJ9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDIxKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4oZSl7c3dpdGNoKGUpe2Nhc2Uic21zIjpyZXR1cm57YnV0dG9uRGF0YVNlOiJzbXMtc2VuZC1jb2RlIixidXR0b25DbGFzc05hbWU6InNtcy1yZXF1ZXN0LWJ1dHRvbiIsZm9ybVN1Ym1pdDp0LmxvYygibWZhLnNlbmRDb2RlIiwibG9naW4iKSxmb3JtUmV0cnk6dC5sb2MoIm1mYS5yZXNlbmRDb2RlIiwibG9naW4iKSxmb3JtU3VibWl0dGVkOnQubG9jKCJtZmEuc2VudCIsImxvZ2luIiksc3VidGl0bGU6cih7c3VidGl0bGU6dGhpcy5tb2RlbC5nZXQoInBob25lTnVtYmVyIil9KX07Y2FzZSJjYWxsIjpyZXR1cm57YnV0dG9uRGF0YVNlOiJtYWtlLWNhbGwiLGJ1dHRvbkNsYXNzTmFtZToiY2FsbC1yZXF1ZXN0LWJ1dHRvbiIsZm9ybVN1Ym1pdDp0LmxvYygibWZhLmNhbGwiLCJsb2dpbiIpLGZvcm1SZXRyeTp0LmxvYygibWZhLnJlZGlhbCIsImxvZ2luIiksZm9ybVN1Ym1pdHRlZDp0LmxvYygibWZhLmNhbGxpbmciLCJsb2dpbiIpLHN1YnRpdGxlOnIoe3N1YnRpdGxlOnRoaXMubW9kZWwuZ2V0KCJwaG9uZU51bWJlciIpfSl9O2Nhc2UiZW1haWwiOnJldHVybntidXR0b25EYXRhU2U6ImVtYWlsLXNlbmQtY29kZSIsYnV0dG9uQ2xhc3NOYW1lOiJlbWFpbC1yZXF1ZXN0LWJ1dHRvbiIsZm9ybVN1Ym1pdDp0LmxvYygibWZhLnNlbmRFbWFpbCIsImxvZ2luIiksZm9ybVJldHJ5OnQubG9jKCJtZmEucmVzZW5kRW1haWwiLCJsb2dpbiIpLGZvcm1TdWJtaXR0ZWQ6dC5sb2MoIm1mYS5zZW50IiwibG9naW4iKSxzdWJ0aXRsZTpyKHtzdWJ0aXRsZTp0aGlzLm1vZGVsLmdldCgiZW1haWwiKX0pfTtkZWZhdWx0OnJldHVybntidXR0b25EYXRhU2U6IiIsYnV0dG9uQ2xhc3NOYW1lOiIiLGZvcm1TdWJtaXQ6IiIsZm9ybVJldHJ5OiIiLGZvcm1TdWJtaXR0ZWQ6IiJ9fX12YXIgcj10LkhhbmRsZWJhcnMuY29tcGlsZSgiKHt7c3VidGl0bGV9fSkiKSxzPXQuXyxvPTNlNDtyZXR1cm4gdC5Gb3JtLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LXBhc3Njb2RlIixhdXRvU2F2ZTohMCxub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnMucGFydGlhbCh0LmxvYywibWZhLmNoYWxsZW5nZS52ZXJpZnkiLCJsb2dpbiIpLHNjcm9sbE9uRXJyb3I6ITEsbGF5b3V0OiJvLWZvcm0tdGhlbWUiLGRpc2FibGVTdWJtaXRCdXR0b246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5hcHBTdGF0ZS5nZXQoImlzTWZhQ2hhbGxlbmdlIikmJnRoaXMubW9kZWwuZ2V0KCJhbnN3ZXIiKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciByPXRoaXM7dGhpcy50aXRsZT10aGlzLm1vZGVsLmdldCgiZmFjdG9yTGFiZWwiKTt2YXIgYT10aGlzLm1vZGVsLmdldCgiZmFjdG9yVHlwZSIpLGw9bi5jYWxsKHRoaXMsYSk7dGhpcy4kZWwuYXR0cigiZGF0YS1zZSIsImZhY3Rvci0iK2EpLHRoaXMuc3VidGl0bGU9bC5zdWJ0aXRsZSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImVycm9yIixmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKX0pLHRoaXMuYWRkKHQuY3JlYXRlQnV0dG9uKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6bC5idXR0b25EYXRhU2V9LGNsYXNzTmFtZToiYnV0dG9uICIrbC5idXR0b25DbGFzc05hbWUsdGl0bGU6bC5mb3JtU3VibWl0LGNsaWNrOmZ1bmN0aW9uKCl7ci5jbGVhckVycm9ycygpLHRoaXMuZGlzYWJsZSgpLHRoaXMub3B0aW9ucy50aXRsZT1sLmZvcm1TdWJtaXR0ZWQsdGhpcy5yZW5kZXIoKSx0aGlzLm1vZGVsLnNldCgiYW5zd2VyIiwiIiksdGhpcy5tb2RlbC5zYXZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiByLmdldElucHV0cygpLmZpcnN0KCkucmVuZGVyKCkuZm9jdXMoKSxlLmRlbGF5KG8pfSkudGhlbihzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMudGl0bGU9bC5mb3JtUmV0cnksdGhpcy5lbmFibGUoKSx0aGlzLnJlbmRlcigpfSx0aGlzKSl9fSkpLHRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnQubG9jKCJtZmEuY2hhbGxlbmdlLmVudGVyQ29kZS5wbGFjZWhvbGRlciIsImxvZ2luIiksY2xhc3NOYW1lOiJvLWZvcm0tZmllbGRzZXQgby1mb3JtLWxhYmVsLXRvcCBhdXRoLXBhc3Njb2RlIixuYW1lOiJhbnN3ZXIiLGlucHV0OmksdHlwZToidGV4dCJ9KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzI0KSxpKDMxKV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49dC5fLHI9dC5IYW5kbGViYXJzLmNvbXBpbGUoInt7ZmFjdG9yTmFtZX19ICh7e3tkZXZpY2VOYW1lfX19KSIpLHM9M2U0LG89JzxkaXYgY2xhc3M9Im9rdGEtZm9ybS1pbmZvYm94LXdhcm5pbmcgaW5mb2JveCBpbmZvYm94LXdhcm5pbmciPlx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24gd2FybmluZy0xNiI+PC9zcGFuPlx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+e3t3YXJuaW5nfX08L3A+XHQgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+JztyZXR1cm4gdC5Gb3JtLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LXB1c2giLGF1dG9TYXZlOiEwLG5vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6bi5wYXJ0aWFsKHQubG9jLCJva3RhdmVyaWZ5LnNlbmQiLCJsb2dpbiIpLHNjcm9sbE9uRXJyb3I6ITEsbGF5b3V0OiJvLWZvcm0tdGhlbWUiLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZmFjdG9yLXB1c2gifSxldmVudHM6e3N1Ym1pdDoic3VibWl0In0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuZW5hYmxlZD0hMCx0aGlzLmxpc3RlblRvKHRoaXMub3B0aW9ucy5hcHBTdGF0ZSwiY2hhbmdlOmlzTWZhUmVqZWN0ZWRCeVVzZXIiLGZ1bmN0aW9uKGUsaSl7dGhpcy5zZXRTdWJtaXRTdGF0ZShpKSxpJiZ0aGlzLnNob3dFcnJvcih0LmxvYygib2t0YXZlcmlmeS5yZWplY3RlZCIsImxvZ2luIikpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm9wdGlvbnMuYXBwU3RhdGUsImNoYW5nZTppc01mYVRpbWVvdXQiLGZ1bmN0aW9uKGUsaSl7dGhpcy5zZXRTdWJtaXRTdGF0ZShpKSxpJiZ0aGlzLnNob3dFcnJvcih0LmxvYygib2t0YXZlcmlmeS50aW1lb3V0IiwibG9naW4iKSl9KSx0aGlzLmxpc3RlblRvKHRoaXMub3B0aW9ucy5hcHBTdGF0ZSwiY2hhbmdlOmlzTWZhUmVxdWlyZWQiLGZ1bmN0aW9uKHQsZSl7ZSYmKHRoaXMuY2xlYXJFcnJvcnMoKSx0aGlzLmNsZWFyV2FybmluZ3MoKSl9KSx0aGlzLnRpdGxlPXIoe2ZhY3Rvck5hbWU6dGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIiksZGV2aWNlTmFtZTp0aGlzLm1vZGVsLmdldCgiZGV2aWNlTmFtZSIpfSl9LHNldFN1Ym1pdFN0YXRlOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuJGVsLmZpbmQoIi5idXR0b24iKTt0aGlzLmVuYWJsZWQ9ZSxlPyhpLnJlbW92ZUNsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIpLGkucHJvcCgidmFsdWUiLHQubG9jKCJva3RhdmVyaWZ5LnNlbmQiLCJsb2dpbiIpKSxpLnByb3AoImRpc2FibGVkIiwhMSkpOihpLmFkZENsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIpLGkucHJvcCgidmFsdWUiLHQubG9jKCJva3RhdmVyaWZ5LnNlbnQiLCJsb2dpbiIpKSxpLnByb3AoImRpc2FibGVkIiwhMCkpfSxzdWJtaXQ6ZnVuY3Rpb24odCl7dm9pZCAwIT09dCYmdC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZW5hYmxlZCYmKHRoaXMuc2V0U3VibWl0U3RhdGUoITEpLHRoaXMuZG9TYXZlKCkpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLmF1dG9QdXNoIikmJmUuaXNBdXRvUHVzaEVuYWJsZWQodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlcklkIikpJiYodGhpcy5tb2RlbC5zZXQoImF1dG9QdXNoIiwhMCksbi5kZWZlcihuLmJpbmQodGhpcy5zdWJtaXQsdGhpcykpKX0sZG9TYXZlOmZ1bmN0aW9uKCl7dmFyIGU7dGhpcy5jbGVhckVycm9ycygpLHRoaXMuY2xlYXJXYXJuaW5ncygpLHRoaXMubW9kZWwuaXNWYWxpZCgpJiYodGhpcy5saXN0ZW5Ub09uY2UodGhpcy5tb2RlbCwiZXJyb3IiLGZ1bmN0aW9uKCl7dGhpcy5zZXRTdWJtaXRTdGF0ZSghMCksdGhpcy5jbGVhcldhcm5pbmdzKCksY2xlYXJUaW1lb3V0KGUpfSksdGhpcy50cmlnZ2VyKCJzYXZlIix0aGlzLm1vZGVsKSxlPWkuY2FsbEFmdGVyVGltZW91dChuLmJpbmQoZnVuY3Rpb24oKXt0aGlzLnNob3dXYXJuaW5nKHQubG9jKCJva3RhdmVyaWZ5Lndhcm5pbmciLCJsb2dpbiIpKX0sdGhpcykscykpfSxzaG93RXJyb3I6ZnVuY3Rpb24odCl7dGhpcy5jbGVhcldhcm5pbmdzKCksdGhpcy5tb2RlbC50cmlnZ2VyKCJlcnJvciIsdGhpcy5tb2RlbCx7cmVzcG9uc2VKU09OOntlcnJvclN1bW1hcnk6dH19KX0sc2hvd1dhcm5pbmc6ZnVuY3Rpb24odCl7dGhpcy5jbGVhcldhcm5pbmdzKCksdGhpcy5hZGQobywiLm8tZm9ybS1lcnJvci1jb250YWluZXIiLHtvcHRpb25zOnt3YXJuaW5nOnR9fSl9LGNsZWFyV2FybmluZ3M6ZnVuY3Rpb24oKXt0aGlzLiQoIi5va3RhLWZvcm0taW5mb2JveC13YXJuaW5nIikucmVtb3ZlKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShpKXtpLmFkZERpdmlkZXIoKSxpLmFkZElucHV0KHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiby1mb3JtLWZpZWxkc2V0IG8tZm9ybS1sYWJlbC10b3AgaW5saW5lLWlucHV0IGF1dGgtcGFzc2NvZGUiLG5hbWU6ImFuc3dlciIsaW5wdXQ6ZSx0eXBlOiJ0ZXh0In0pLGkuYWRkKHQuY3JlYXRlQnV0dG9uKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImlubGluZS10b3RwLXZlcmlmeSJ9LGNsYXNzTmFtZToiYnV0dG9uIGlubGluZS10b3RwLXZlcmlmeSIsdGl0bGU6dC5sb2MoIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxjbGljazpmdW5jdGlvbigpe2kubW9kZWwubWFuYWdlVHJhbnNhY3Rpb24oZnVuY3Rpb24odCxlKXtyZXR1cm4iTUZBX0NIQUxMRU5HRSI9PT10LnN0YXR1cyYmdC5wcmV2P3QucHJldigpLnRoZW4oZnVuY3Rpb24odCl7ZSh0KSxpLm1vZGVsLnNhdmUoKX0pOnZvaWQgaS5tb2RlbC5zYXZlKCl9KX19KSksaS5hdCgxKS5mb2N1cygpfXJldHVybiB0LkZvcm0uZXh0ZW5kKHthdXRvU2F2ZTohMCxub0J1dHRvbkJhcjohMCxzY3JvbGxPbkVycm9yOiExLGxheW91dDoiby1mb3JtLXRoZW1lIixjbGFzc05hbWU6Im1mYS12ZXJpZnktdG90cC1pbmxpbmUiLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZmFjdG9yLWlubGluZS10b3RwIn0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJlcnJvciIsZnVuY3Rpb24oKXt0aGlzLmNsZWFyRXJyb3JzKCl9KSx0aGlzLmFkZCh0LmNyZWF0ZUJ1dHRvbih7Y2xhc3NOYW1lOiJsaW5rIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImlubGluZS10b3RwLWFkZCJ9LHRpdGxlOnQubG9jKCJtZmEuY2hhbGxlbmdlLm9yRW50ZXJDb2RlIiwibG9naW4iKSxjbGljazpmdW5jdGlvbigpe3RoaXMucmVtb3ZlKCksaShlKX19KSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMjk2KSxpKDMzMyksaSgzMzQpLGkoMzIwKSxpKDMzNSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7dmFyIGE9dC5fO3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5IHZlcmlmeS13aW5kb3dzLWhlbGxvIixNb2RlbDp7bG9jYWw6e19fYXV0b1RyaWdnZXJlZF9fOiJib29sZWFuIn0sc2F2ZTpmdW5jdGlvbigpe2lmKG4uaXNBdmFpbGFibGUoKSl7dGhpcy50cmlnZ2VyKCJyZXF1ZXN0Iik7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPWEuZmluZFdoZXJlKGUuZmFjdG9ycyx7ZmFjdG9yVHlwZToid2ViYXV0aG4iLHByb3ZpZGVyOiJGSURPIn0pO3JldHVybiBpLnZlcmlmeSgpLnRoZW4oZnVuY3Rpb24ocil7dmFyIHM9ci5mYWN0b3I7cmV0dXJuIG4uZ2V0QXNzZXJ0aW9uKHMuY2hhbGxlbmdlLm5vbmNlLFt7aWQ6cy5wcm9maWxlLmNyZWRlbnRpYWxJZH1dKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBpLnZlcmlmeSh7YXV0aGVudGljYXRvckRhdGE6dC5hdXRoZW50aWNhdG9yRGF0YSxjbGllbnREYXRhOnQuY2xpZW50RGF0YSxzaWduYXR1cmVEYXRhOnQuc2lnbmF0dXJlfSl9KS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiB0LnRyaWdnZXIoInN5bmMiKSx0LnRyaWdnZXIoInNpZ25JbiIpLGV9KS5mYWlsKGZ1bmN0aW9uKGkpe3N3aXRjaChpLm1lc3NhZ2Upe2Nhc2UiQWJvcnRFcnJvciI6Y2FzZSJOb3RGb3VuZEVycm9yIjpjYXNlIk5vdFN1cHBvcnRlZEVycm9yIjpyZXR1cm4gdC50cmlnZ2VyKCJhYm9ydCIsaS5tZXNzYWdlKSxlfXRocm93IGl9KX0pfSl9fX0sRm9ybTp7YXV0b1NhdmU6ITAsaGFzU2F2aW5nU3RhdGU6ITEsdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJmYWN0b3Iud2luZG93c0hlbGxvIiwibG9naW4iKSxzdWJ0aXRsZTpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/dC5sb2MoInZlcmlmeS53aW5kb3dzSGVsbG8uc3VidGl0bGUiLCJsb2dpbiIpOiIifSxzYXZlOmEucGFydGlhbCh0LmxvYywidmVyaWZ5LndpbmRvd3NIZWxsby5zYXZlIiwibG9naW4iKSxjdXN0b21TYXZpbmdTdGF0ZTp7c3RvcDoiYWJvcnQifSxtb2RlbEV2ZW50czpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQiLGFib3J0OiJfc3RvcEVucm9sbG1lbnQiLHNpZ25JbjoiX3N1Y2Nlc3NFbnJvbGxtZW50In06e319LG5vQnV0dG9uQmFyOmZ1bmN0aW9uKCl7cmV0dXJuIW4uaXNBdmFpbGFibGUoKX0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIGU9W107cmV0dXJuIG4uaXNBdmFpbGFibGUoKXx8ZS5wdXNoKGkuVmlldyh7VmlldzpuZXcgbyh7bWVzc2FnZTp0LmxvYygiZW5yb2xsLndpbmRvd3NIZWxsby5lcnJvci5ub3RXaW5kb3dzIiwibG9naW4iKX0pfSx7c2VsZWN0b3I6Ii5vLWZvcm0tZXJyb3ItY29udGFpbmVyIn0pKSxlLnB1c2goaS5WaWV3KHtWaWV3Om5ldyByKHttb2RlbDp0aGlzLm1vZGVsLHZpc2libGU6ITF9KX0pKSxlfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7MSE9PXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvcnMiKS5sZW5ndGh8fHRoaXMubW9kZWwuZ2V0KCJfX2F1dG9UcmlnZ2VyZWRfXyIpfHwodGhpcy5tb2RlbC5zZXQoIl9fYXV0b1RyaWdnZXJlZF9fIiwhMCksdGhpcy5tb2RlbC5zYXZlKCkpfSxfc3RhcnRFbnJvbGxtZW50OmZ1bmN0aW9uKCl7dGhpcy5zdWJ0aXRsZT10LmxvYygidmVyaWZ5LndpbmRvd3NIZWxsby5zdWJ0aXRsZS5sb2FkaW5nIiwibG9naW4iKSx0aGlzLm1vZGVsLnRyaWdnZXIoInNwaW5uZXI6c2hvdyIpLHRoaXMuX3Jlc2V0RXJyb3JNZXNzYWdlKCksdGhpcy5yZW5kZXIoKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLmFkZENsYXNzKCJoaWRlIil9LF9zdG9wRW5yb2xsbWVudDpmdW5jdGlvbihlKXt0aGlzLnN1YnRpdGxlPXQubG9jKCJ2ZXJpZnkud2luZG93c0hlbGxvLnN1YnRpdGxlIiwibG9naW4iKSx0aGlzLm1vZGVsLnRyaWdnZXIoInNwaW5uZXI6aGlkZSIpLHRoaXMuJCgiLm8tZm9ybS1idXR0b24tYmFyIikucmVtb3ZlQ2xhc3MoImhpZGUiKTt2YXIgaTtzd2l0Y2goZSl7Y2FzZSJOb3RGb3VuZEVycm9yIjppPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvcnMiKS5sZW5ndGg+MT90LmxvYygidmVyaWZ5LndpbmRvd3NIZWxsby5lcnJvci5ub3RGb3VuZC5zZWxlY3RBbm90aGVyIiwibG9naW4iKTp0LmxvYygidmVyaWZ5LndpbmRvd3NIZWxsby5lcnJvci5ub3RGb3VuZCIsImxvZ2luIik7YnJlYWs7Y2FzZSJOb3RTdXBwb3J0ZWRFcnJvciI6aT10LmxvYygiZW5yb2xsLndpbmRvd3NIZWxsby5lcnJvci5ub3RDb25maWd1cmVkSHRtbCIsImxvZ2luIil9aWYodGhpcy5fcmVzZXRFcnJvck1lc3NhZ2UoKSxpKXt2YXIgbj1uZXcgbyh7bWVzc2FnZTppfSk7dGhpcy4kKCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpLmFkZENsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpLHRoaXMuYWRkKG4se3NlbGVjdG9yOiIuby1mb3JtLWVycm9yLWNvbnRhaW5lciJ9KSx0aGlzLl9lcnJvck1lc3NhZ2VWaWV3PXRoaXMubGFzdCgpfXRoaXMucmVuZGVyKCl9LF9zdWNjZXNzRW5yb2xsbWVudDpmdW5jdGlvbigpe3RoaXMuc3VidGl0bGU9dC5sb2MoInZlcmlmeS53aW5kb3dzSGVsbG8uc3VidGl0bGUuc2lnbmluZ0luIiwibG9naW4iKSx0aGlzLnJlbmRlcigpLHRoaXMuJCgiLm8tZm9ybS1idXR0b24tYmFyIikuYWRkQ2xhc3MoImhpZGUiKX0sX3Jlc2V0RXJyb3JNZXNzYWdlOmZ1bmN0aW9uKCl7dGhpcy5fZXJyb3JNZXNzYWdlVmlldyYmdGhpcy5fZXJyb3JNZXNzYWdlVmlldy5yZW1vdmUoKSx0aGlzLl9lcnJvck1lc3NhZ2VWaWV3PXZvaWQgMCx0aGlzLmNsZWFyRXJyb3JzKCl9fSxiYWNrOmZ1bmN0aW9uKCl7fSxGb290ZXI6c30pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0KXtyZXR1cm4gbmV3IGUodCl9ZnVuY3Rpb24gbih0LGUsbil7ZT1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm57dHlwZToiRklET18yXzAiLGFsZ29yaXRobTp0LmFsZ29yaXRobX19KTt2YXIgcj13aW5kb3cubXNDcmVkZW50aWFscy5tYWtlQ3JlZGVudGlhbCh0LGUsbikudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7Y3JlZGVudGlhbDp7aWQ6dC5pZH0scHVibGljS2V5OkpTT04ucGFyc2UodC5wdWJsaWNLZXkpLGF0dGVzdGF0aW9uOnQuYXR0ZXN0YXRpb259KX0pO3JldHVybiBpKHIpfWZ1bmN0aW9uIHIodCxlKXt2YXIgbj1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm57dHlwZToiRklET18yXzAiLGlkOnQuaWR9fSkscj17YWNjZXB0Om59LHM9d2luZG93Lm1zQ3JlZGVudGlhbHMuZ2V0QXNzZXJ0aW9uKHQscikudGhlbihmdW5jdGlvbih0KXt2YXIgZT10LnNpZ25hdHVyZTtyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7Y3JlZGVudGlhbDp7aWQ6dC5pZH0sY2xpZW50RGF0YTplLmNsaWVudERhdGEsYXV0aGVudGljYXRvckRhdGE6ZS5hdXRobnJEYXRhLHNpZ25hdHVyZTplLnNpZ25hdHVyZX0pfSk7cmV0dXJuIGkocyl9cmV0dXJue21ha2VDcmVkZW50aWFsOm4sZ2V0QXNzZXJ0aW9uOnIsaXNBdmFpbGFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93Lmhhc093blByb3BlcnR5KCJtc0NyZWRlbnRpYWxzIil9fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKV0scj1mdW5jdGlvbih0KXtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJva3RhLXdhaXRpbmctc3Bpbm5lciIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJvLWZvcm0tb2t0YS13YWl0aW5nLXNwaW5uZXIifSxtb2RlbEV2ZW50czp7InNwaW5uZXI6c2hvdyI6InNob3ciLCJzcGlubmVyOmhpZGUiOiJoaWRlIn0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0JiZ0LnZpc2libGU9PT0hMSYmdGhpcy5oaWRlKCl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmVDbGFzcygiaGlkZSIpfSxoaWRlOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MoImhpZGUiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDE0NildLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT0nXHQgICAgPHNwYW4gY2xhc3M9Imljb24gZXJyb3ItMjQiPjwvc3Bhbj5cdCAgICA8aDQ+PHN0cm9uZz57e3ttZXNzYWdlfX19PC9zdHJvbmc+PC9oND5cdCAgJztyZXR1cm4gZS5leHRlbmQoe3RlbXBsYXRlOmksY2xhc3NOYW1lOiJva3RhLWluZm9ib3gtZXJyb3IgaW5mb2JveCBpbmZvYm94LWVycm9yIGluZm9ib3gtbWQgbWFyZ2luLWJ0bS0yNSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJvLWZvcm0tZXJyb3ItaHRtbCJ9LG1lc3NhZ2U6IiIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0JiZ0Lm1lc3NhZ2UmJih0aGlzLm1lc3NhZ2U9dC5tZXNzYWdlKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue21lc3NhZ2U6dGhpcy5tZXNzYWdlfX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTYpLGkoMzIwKSxpKDIxKSxpKDMzNSksaSgxODIpLGkoMzM3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXtmdW5jdGlvbiBhKHQsZSl7c3dpdGNoKHQpe2Nhc2UgMTpyZXR1cm4gZT8idTJmLmVycm9yLm90aGVyLm9uZUZhY3RvciI6InUyZi5lcnJvci5vdGhlciI7Y2FzZSAyOmNhc2UgMzpyZXR1cm4gZT8idTJmLmVycm9yLmJhZFJlcXVlc3Qub25lRmFjdG9yIjoidTJmLmVycm9yLmJhZFJlcXVlc3QiO2Nhc2UgNDpyZXR1cm4gZT8idTJmLmVycm9yLnVuc3VwcG9ydGVkLm9uZUZhY3RvciI6InUyZi5lcnJvci51bnN1cHBvcnRlZCI7Y2FzZSA1OnJldHVybiJ1MmYuZXJyb3IudGltZW91dCJ9fXZhciBsPXQuXztyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToidmVyaWZ5LXUyZiIsTW9kZWw6e3NhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmlnZ2VyKCJyZXF1ZXN0IiksdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPWwuZmluZFdoZXJlKGUuZmFjdG9ycyx7ZmFjdG9yVHlwZToidTJmIixwcm92aWRlcjoiRklETyJ9KSxuPXRoaXM7cmV0dXJuIGkudmVyaWZ5KCkudGhlbihmdW5jdGlvbihlKXt2YXIgcz1lLmZhY3RvcixvPXMucHJvZmlsZS5hcHBJZCxsPVt7dmVyc2lvbjpzLnByb2ZpbGUudmVyc2lvbixrZXlIYW5kbGU6cy5wcm9maWxlLmNyZWRlbnRpYWxJZH1dO24udHJpZ2dlcigicmVxdWVzdCIpO3ZhciBjPXIuZGVmZXIoKTtyZXR1cm4gdTJmLnNpZ24obyxzLmNoYWxsZW5nZS5ub25jZSxsLGZ1bmN0aW9uKGUpe2lmKG4udHJpZ2dlcigiZXJyb3JzOmNsZWFyIiksIWUuZXJyb3JDb2RlfHwwPT09ZS5lcnJvckNvZGUpcmV0dXJuIGkudmVyaWZ5KHtjbGllbnREYXRhOmUuY2xpZW50RGF0YSxzaWduYXR1cmVEYXRhOmUuc2lnbmF0dXJlRGF0YX0pLnRoZW4oYy5yZXNvbHZlKTt2YXIgcj0xPT09bi5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmxlbmd0aDtjLnJlamVjdCh7eGhyOntyZXNwb25zZUpTT046e2Vycm9yU3VtbWFyeTp0LmxvYyhhKGUuZXJyb3JDb2RlLHIpLCJsb2dpbiIpfX19KX0pLGMucHJvbWlzZX0pfSl9fSxGb3JtOnthdXRvU2F2ZTohMCxoYXNTYXZpbmdTdGF0ZTohMSx0aXRsZTpsLnBhcnRpYWwodC5sb2MsImZhY3Rvci51MmYiLCJsb2dpbiIpLGNsYXNzTmFtZToidmVyaWZ5LXUyZi1mb3JtIixub0NhbmNlbEJ1dHRvbjohMCxzYXZlOmwucGFydGlhbCh0LmxvYywidmVyaWZ5LnUyZi5yZXRyeSIsImxvZ2luIiksbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hd2luZG93Lmhhc093blByb3BlcnR5KCJ1MmYiKX0sbW9kZWxFdmVudHM6e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgZT1bXTtpZih3aW5kb3cuaGFzT3duUHJvcGVydHkoInUyZiIpKWUucHVzaChpLlZpZXcoe1ZpZXc6J1x0ICAgICAgICAgICAgPGRpdiBjbGFzcz0idTJmLXZlcmlmeS10ZXh0Ij5cdCAgICAgICAgICAgICAgPHA+e3tpMThuIGNvZGU9InZlcmlmeS51MmYuaW5zdHJ1Y3Rpb25zIiBidW5kbGU9ImxvZ2luIn19PC9wPlx0ICAgICAgICAgICAgICA8cD57e2kxOG4gY29kZT0idmVyaWZ5LnUyZi5pbnN0cnVjdGlvbnNCbHVldG9vdGgiIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICAgIDxkaXYgZGF0YS1zZT0idTJmLXdhaXRpbmciIGNsYXNzPSJva3RhLXdhaXRpbmctc3Bpbm5lciI+PC9kaXY+XHQgICAgICAgICAgICA8L2Rpdj4nfSkpO2Vsc2V7dmFyIG49InUyZi5lcnJvci5ub3RTdXBwb3J0ZWRCcm93c2VyIjtvLmlzRmlyZWZveCgpP249InUyZi5lcnJvci5ub0ZpcmVmb3hFeHRlbnNpb24iOjE9PT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIikubGVuZ3RoJiYobj0idTJmLmVycm9yLm5vdFN1cHBvcnRlZEJyb3dzZXIub25lRmFjdG9yIiksZS5wdXNoKGkuVmlldyh7VmlldzpuZXcgcyh7bWVzc2FnZTp0LmxvYyhuLCJsb2dpbiIpfSl9LHtzZWxlY3RvcjoiLm8tZm9ybS1lcnJvci1jb250YWluZXIifSkpfXJldHVybiBlfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7bC5kZWZlcihsLmJpbmQoZnVuY3Rpb24oKXt3aW5kb3cuaGFzT3duUHJvcGVydHkoInUyZiIpP3RoaXMubW9kZWwuc2F2ZSgpOnRoaXMuJCgnW2RhdGEtc2U9InUyZi13YWl0aW5nIl0nKS5hZGRDbGFzcygiaGlkZSIpfSx0aGlzKSl9LF9zdGFydEVucm9sbG1lbnQ6ZnVuY3Rpb24oKXt0aGlzLiQoIi5va3RhLXdhaXRpbmctc3Bpbm5lciIpLnJlbW92ZUNsYXNzKCJoaWRlIiksdGhpcy4kKCIuby1mb3JtLWJ1dHRvbi1iYXIiKS5oaWRlKCl9LF9zdG9wRW5yb2xsbWVudDpmdW5jdGlvbigpe3RoaXMuJCgiLm9rdGEtd2FpdGluZy1zcGlubmVyIikuYWRkQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLnNob3coKX19LGJhY2s6ZnVuY3Rpb24oKXt9LEZvb3RlcjpufSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXsKCS8vQ29weXJpZ2h0IDIwMTQtMjAxNSBHb29nbGUgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLgoJLy9saWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgb3IgYXQKCS8vaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vb3Blbi1zb3VyY2UvbGljZW5zZXMvYnNkCgkidXNlIHN0cmljdCI7IWZ1bmN0aW9uKCl7aWYoISgidTJmImluIHdpbmRvdykmJiJjaHJvbWUiaW4gd2luZG93KXt2YXIgdCxlPXdpbmRvdy51MmY9e307ZS5FWFRFTlNJT05fSUQ9ImttZW5kZmFwZ2dqZWhvZG5kZmxtbWdhZ2RiYW1obmZkIixlLk1lc3NhZ2VUeXBlcz17VTJGX1JFR0lTVEVSX1JFUVVFU1Q6InUyZl9yZWdpc3Rlcl9yZXF1ZXN0IixVMkZfUkVHSVNURVJfUkVTUE9OU0U6InUyZl9yZWdpc3Rlcl9yZXNwb25zZSIsVTJGX1NJR05fUkVRVUVTVDoidTJmX3NpZ25fcmVxdWVzdCIsVTJGX1NJR05fUkVTUE9OU0U6InUyZl9zaWduX3Jlc3BvbnNlIixVMkZfR0VUX0FQSV9WRVJTSU9OX1JFUVVFU1Q6InUyZl9nZXRfYXBpX3ZlcnNpb25fcmVxdWVzdCIsVTJGX0dFVF9BUElfVkVSU0lPTl9SRVNQT05TRToidTJmX2dldF9hcGlfdmVyc2lvbl9yZXNwb25zZSJ9LGUuRXJyb3JDb2Rlcz17T0s6MCxPVEhFUl9FUlJPUjoxLEJBRF9SRVFVRVNUOjIsQ09ORklHVVJBVElPTl9VTlNVUFBPUlRFRDozLERFVklDRV9JTkVMSUdJQkxFOjQsVElNRU9VVDo1fSxlLlUyZlJlcXVlc3QsZS5VMmZSZXNwb25zZSxlLkVycm9yLGUuVHJhbnNwb3J0LGUuVHJhbnNwb3J0cyxlLlNpZ25SZXF1ZXN0LGUuU2lnblJlc3BvbnNlLGUuUmVnaXN0ZXJSZXF1ZXN0LGUuUmVnaXN0ZXJSZXNwb25zZSxlLlJlZ2lzdGVyZWRLZXksZS5HZXRKc0FwaVZlcnNpb25SZXNwb25zZSxlLmdldE1lc3NhZ2VQb3J0PWZ1bmN0aW9uKHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgY2hyb21lJiZjaHJvbWUucnVudGltZSl7dmFyIGk9e3R5cGU6ZS5NZXNzYWdlVHlwZXMuVTJGX1NJR05fUkVRVUVTVCxzaWduUmVxdWVzdHM6W119O2Nocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKGUuRVhURU5TSU9OX0lELGksZnVuY3Rpb24oKXtjaHJvbWUucnVudGltZS5sYXN0RXJyb3I/ZS5nZXRJZnJhbWVQb3J0Xyh0KTplLmdldENocm9tZVJ1bnRpbWVQb3J0Xyh0KX0pfWVsc2UgZS5pc0FuZHJvaWRDaHJvbWVfKCk/ZS5nZXRBdXRoZW50aWNhdG9yUG9ydF8odCk6ZS5pc0lvc0Nocm9tZV8oKT9lLmdldElvc1BvcnRfKHQpOmUuZ2V0SWZyYW1lUG9ydF8odCl9LGUuaXNBbmRyb2lkQ2hyb21lXz1mdW5jdGlvbigpe3ZhciB0PW5hdmlnYXRvci51c2VyQWdlbnQ7cmV0dXJuIHQuaW5kZXhPZigiQ2hyb21lIikhPS0xJiZ0LmluZGV4T2YoIkFuZHJvaWQiKSE9LTF9LGUuaXNJb3NDaHJvbWVfPWZ1bmN0aW9uKCl7cmV0dXJuICQuaW5BcnJheShuYXZpZ2F0b3IucGxhdGZvcm0sWyJpUGhvbmUiLCJpUGFkIiwiaVBvZCJdKT4tMX0sZS5nZXRDaHJvbWVSdW50aW1lUG9ydF89ZnVuY3Rpb24odCl7dmFyIGk9Y2hyb21lLnJ1bnRpbWUuY29ubmVjdChlLkVYVEVOU0lPTl9JRCx7aW5jbHVkZVRsc0NoYW5uZWxJZDohMH0pO3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0KG5ldyBlLldyYXBwZWRDaHJvbWVSdW50aW1lUG9ydF8oaSkpfSwwKX0sZS5nZXRBdXRoZW50aWNhdG9yUG9ydF89ZnVuY3Rpb24odCl7c2V0VGltZW91dChmdW5jdGlvbigpe3QobmV3IGUuV3JhcHBlZEF1dGhlbnRpY2F0b3JQb3J0Xyl9LDApfSxlLmdldElvc1BvcnRfPWZ1bmN0aW9uKHQpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0KG5ldyBlLldyYXBwZWRJb3NQb3J0Xyl9LDApfSxlLldyYXBwZWRDaHJvbWVSdW50aW1lUG9ydF89ZnVuY3Rpb24odCl7dGhpcy5wb3J0Xz10fSxlLmZvcm1hdFNpZ25SZXF1ZXN0Xz1mdW5jdGlvbihpLG4scixzLG8pe2lmKHZvaWQgMD09PXR8fHQ8MS4xKXtmb3IodmFyIGE9W10sbD0wO2w8ci5sZW5ndGg7bCsrKWFbbF09e3ZlcnNpb246cltsXS52ZXJzaW9uLGNoYWxsZW5nZTpuLGtleUhhbmRsZTpyW2xdLmtleUhhbmRsZSxhcHBJZDppfTtyZXR1cm57dHlwZTplLk1lc3NhZ2VUeXBlcy5VMkZfU0lHTl9SRVFVRVNULHNpZ25SZXF1ZXN0czphLHRpbWVvdXRTZWNvbmRzOnMscmVxdWVzdElkOm99fXJldHVybnt0eXBlOmUuTWVzc2FnZVR5cGVzLlUyRl9TSUdOX1JFUVVFU1QsYXBwSWQ6aSxjaGFsbGVuZ2U6bixyZWdpc3RlcmVkS2V5czpyLHRpbWVvdXRTZWNvbmRzOnMscmVxdWVzdElkOm99fSxlLmZvcm1hdFJlZ2lzdGVyUmVxdWVzdF89ZnVuY3Rpb24oaSxuLHIscyxvKXtpZih2b2lkIDA9PT10fHx0PDEuMSl7Zm9yKHZhciBhPTA7YTxyLmxlbmd0aDthKyspclthXS5hcHBJZD1pO2Zvcih2YXIgbD1bXSxhPTA7YTxuLmxlbmd0aDthKyspbFthXT17dmVyc2lvbjpuW2FdLnZlcnNpb24sY2hhbGxlbmdlOnJbMF0sa2V5SGFuZGxlOm5bYV0ua2V5SGFuZGxlLGFwcElkOml9O3JldHVybnt0eXBlOmUuTWVzc2FnZVR5cGVzLlUyRl9SRUdJU1RFUl9SRVFVRVNULHNpZ25SZXF1ZXN0czpsLHJlZ2lzdGVyUmVxdWVzdHM6cix0aW1lb3V0U2Vjb25kczpzLHJlcXVlc3RJZDpvfX1yZXR1cm57dHlwZTplLk1lc3NhZ2VUeXBlcy5VMkZfUkVHSVNURVJfUkVRVUVTVCxhcHBJZDppLHJlZ2lzdGVyUmVxdWVzdHM6cixyZWdpc3RlcmVkS2V5czpuLHRpbWVvdXRTZWNvbmRzOnMscmVxdWVzdElkOm99fSxlLldyYXBwZWRDaHJvbWVSdW50aW1lUG9ydF8ucHJvdG90eXBlLnBvc3RNZXNzYWdlPWZ1bmN0aW9uKHQpe3RoaXMucG9ydF8ucG9zdE1lc3NhZ2UodCl9LGUuV3JhcHBlZENocm9tZVJ1bnRpbWVQb3J0Xy5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbih0LGUpe3ZhciBpPXQudG9Mb3dlckNhc2UoKTsibWVzc2FnZSI9PWl8fCJvbm1lc3NhZ2UiPT1pP3RoaXMucG9ydF8ub25NZXNzYWdlLmFkZExpc3RlbmVyKGZ1bmN0aW9uKHQpe2Uoe2RhdGE6dH0pfSk6Y29uc29sZS5lcnJvcigiV3JhcHBlZENocm9tZVJ1bnRpbWVQb3J0IG9ubHkgc3VwcG9ydHMgb25NZXNzYWdlIil9LGUuV3JhcHBlZEF1dGhlbnRpY2F0b3JQb3J0Xz1mdW5jdGlvbigpe3RoaXMucmVxdWVzdElkXz0tMSx0aGlzLnJlcXVlc3RPYmplY3RfPW51bGx9LGUuV3JhcHBlZEF1dGhlbnRpY2F0b3JQb3J0Xy5wcm90b3R5cGUucG9zdE1lc3NhZ2U9ZnVuY3Rpb24odCl7dmFyIGk9ZS5XcmFwcGVkQXV0aGVudGljYXRvclBvcnRfLklOVEVOVF9VUkxfQkFTRV8rIjtTLnJlcXVlc3Q9IitlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkodCkpKyI7ZW5kIjtkb2N1bWVudC5sb2NhdGlvbj1pfSxlLldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8ucHJvdG90eXBlLmdldFBvcnRUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuIldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8ifSxlLldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8ucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24odCxlKXt2YXIgaT10LnRvTG93ZXJDYXNlKCk7aWYoIm1lc3NhZ2UiPT1pKXt2YXIgbj10aGlzO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixuLm9uUmVxdWVzdFVwZGF0ZV8uYmluZChuLGUpLCExKX1lbHNlIGNvbnNvbGUuZXJyb3IoIldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydCBvbmx5IHN1cHBvcnRzIG1lc3NhZ2UiKX0sZS5XcmFwcGVkQXV0aGVudGljYXRvclBvcnRfLnByb3RvdHlwZS5vblJlcXVlc3RVcGRhdGVfPWZ1bmN0aW9uKHQsZSl7dmFyIGk9SlNPTi5wYXJzZShlLmRhdGEpLG49KGkuaW50ZW50VVJMLGkuZXJyb3JDb2RlLG51bGwpO2kuaGFzT3duUHJvcGVydHkoImRhdGEiKSYmKG49SlNPTi5wYXJzZShpLmRhdGEpKSx0KHtkYXRhOm59KX0sZS5XcmFwcGVkQXV0aGVudGljYXRvclBvcnRfLklOVEVOVF9VUkxfQkFTRV89ImludGVudDojSW50ZW50O2FjdGlvbj1jb20uZ29vZ2xlLmFuZHJvaWQuYXBwcy5hdXRoZW50aWNhdG9yLkFVVEhFTlRJQ0FURSIsZS5XcmFwcGVkSW9zUG9ydF89ZnVuY3Rpb24oKXt9LGUuV3JhcHBlZElvc1BvcnRfLnByb3RvdHlwZS5wb3N0TWVzc2FnZT1mdW5jdGlvbih0KXt2YXIgZT1KU09OLnN0cmluZ2lmeSh0KSxpPSJ1MmY6Ly9hdXRoPyIrZW5jb2RlVVJJKGUpO2xvY2F0aW9uLnJlcGxhY2UoaSl9LGUuV3JhcHBlZElvc1BvcnRfLnByb3RvdHlwZS5nZXRQb3J0VHlwZT1mdW5jdGlvbigpe3JldHVybiJXcmFwcGVkSW9zUG9ydF8ifSxlLldyYXBwZWRJb3NQb3J0Xy5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbih0LGUpe3ZhciBpPXQudG9Mb3dlckNhc2UoKTsibWVzc2FnZSIhPT1pJiZjb25zb2xlLmVycm9yKCJXcmFwcGVkSW9zUG9ydCBvbmx5IHN1cHBvcnRzIG1lc3NhZ2UiKX0sZS5nZXRJZnJhbWVQb3J0Xz1mdW5jdGlvbih0KXt2YXIgaT0iY2hyb21lLWV4dGVuc2lvbjovLyIrZS5FWFRFTlNJT05fSUQsbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTtuLnNyYz1pKyIvdTJmLWNvbW1zLmh0bWwiLG4uc2V0QXR0cmlidXRlKCJzdHlsZSIsImRpc3BsYXk6bm9uZSIpLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobik7dmFyIHI9bmV3IE1lc3NhZ2VDaGFubmVsLHM9ZnVuY3Rpb24oZSl7InJlYWR5Ij09ZS5kYXRhPyhyLnBvcnQxLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLHMpLHQoci5wb3J0MSkpOmNvbnNvbGUuZXJyb3IoJ0ZpcnN0IGV2ZW50IG9uIGlmcmFtZSBwb3J0IHdhcyBub3QgInJlYWR5IicpfTtyLnBvcnQxLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLHMpLHIucG9ydDEuc3RhcnQoKSxuLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLGZ1bmN0aW9uKCl7bi5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKCJpbml0IixpLFtyLnBvcnQyXSl9KX0sZS5FWFRFTlNJT05fVElNRU9VVF9TRUM9MzAsZS5wb3J0Xz1udWxsLGUud2FpdGluZ0ZvclBvcnRfPVtdLGUucmVxQ291bnRlcl89MCxlLmNhbGxiYWNrTWFwXz17fSxlLmdldFBvcnRTaW5nbGV0b25fPWZ1bmN0aW9uKHQpe2UucG9ydF8/dChlLnBvcnRfKTooMD09ZS53YWl0aW5nRm9yUG9ydF8ubGVuZ3RoJiZlLmdldE1lc3NhZ2VQb3J0KGZ1bmN0aW9uKHQpe2ZvcihlLnBvcnRfPXQsZS5wb3J0Xy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixlLnJlc3BvbnNlSGFuZGxlcl8pO2Uud2FpdGluZ0ZvclBvcnRfLmxlbmd0aDspZS53YWl0aW5nRm9yUG9ydF8uc2hpZnQoKShlLnBvcnRfKX0pLGUud2FpdGluZ0ZvclBvcnRfLnB1c2godCkpfSxlLnJlc3BvbnNlSGFuZGxlcl89ZnVuY3Rpb24odCl7dmFyIGk9dC5kYXRhLG49aS5yZXF1ZXN0SWQ7aWYoIW58fCFlLmNhbGxiYWNrTWFwX1tuXSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKCJVbmtub3duIG9yIG1pc3NpbmcgcmVxdWVzdElkIGluIHJlc3BvbnNlLiIpO3ZhciByPWUuY2FsbGJhY2tNYXBfW25dO2RlbGV0ZSBlLmNhbGxiYWNrTWFwX1tuXSxyKGkucmVzcG9uc2VEYXRhKX0sZS5zaWduPWZ1bmN0aW9uKGksbixyLHMsbyl7dm9pZCAwPT09dD9lLmdldEFwaVZlcnNpb24oZnVuY3Rpb24oYSl7dD12b2lkIDA9PT1hLmpzX2FwaV92ZXJzaW9uPzA6YS5qc19hcGlfdmVyc2lvbixjb25zb2xlLmxvZygiRXh0ZW5zaW9uIEpTIEFQSSBWZXJzaW9uOiAiLHQpLGUuc2VuZFNpZ25SZXF1ZXN0KGksbixyLHMsbyl9KTplLnNlbmRTaWduUmVxdWVzdChpLG4scixzLG8pfSxlLnNlbmRTaWduUmVxdWVzdD1mdW5jdGlvbih0LGksbixyLHMpe2UuZ2V0UG9ydFNpbmdsZXRvbl8oZnVuY3Rpb24obyl7dmFyIGE9KytlLnJlcUNvdW50ZXJfO2UuY2FsbGJhY2tNYXBfW2FdPXI7dmFyIGw9InVuZGVmaW5lZCIhPXR5cGVvZiBzP3M6ZS5FWFRFTlNJT05fVElNRU9VVF9TRUMsYz1lLmZvcm1hdFNpZ25SZXF1ZXN0Xyh0LGksbixsLGEpO28ucG9zdE1lc3NhZ2UoYyl9KX0sZS5yZWdpc3Rlcj1mdW5jdGlvbihpLG4scixzLG8pe3ZvaWQgMD09PXQ/ZS5nZXRBcGlWZXJzaW9uKGZ1bmN0aW9uKGEpe3Q9dm9pZCAwPT09YS5qc19hcGlfdmVyc2lvbj8wOmEuanNfYXBpX3ZlcnNpb24sY29uc29sZS5sb2coIkV4dGVuc2lvbiBKUyBBUEkgVmVyc2lvbjogIix0KSxlLnNlbmRSZWdpc3RlclJlcXVlc3QoaSxuLHIscyxvKX0pOmUuc2VuZFJlZ2lzdGVyUmVxdWVzdChpLG4scixzLG8pfSxlLnNlbmRSZWdpc3RlclJlcXVlc3Q9ZnVuY3Rpb24odCxpLG4scixzKXtlLmdldFBvcnRTaW5nbGV0b25fKGZ1bmN0aW9uKG8pe3ZhciBhPSsrZS5yZXFDb3VudGVyXztlLmNhbGxiYWNrTWFwX1thXT1yO3ZhciBsPSJ1bmRlZmluZWQiIT10eXBlb2Ygcz9zOmUuRVhURU5TSU9OX1RJTUVPVVRfU0VDLGM9ZS5mb3JtYXRSZWdpc3RlclJlcXVlc3RfKHQsbixpLGwsYSk7by5wb3N0TWVzc2FnZShjKX0pfSxlLmdldEFwaVZlcnNpb249ZnVuY3Rpb24odCxpKXtlLmdldFBvcnRTaW5nbGV0b25fKGZ1bmN0aW9uKG4pe2lmKG4uZ2V0UG9ydFR5cGUpe3ZhciByO3N3aXRjaChuLmdldFBvcnRUeXBlKCkpe2Nhc2UiV3JhcHBlZElvc1BvcnRfIjpjYXNlIldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8iOnI9MS4xO2JyZWFrO2RlZmF1bHQ6cj0wfXJldHVybiB2b2lkIHQoe2pzX2FwaV92ZXJzaW9uOnJ9KX12YXIgcz0rK2UucmVxQ291bnRlcl87ZS5jYWxsYmFja01hcF9bc109dDt2YXIgbz17dHlwZTplLk1lc3NhZ2VUeXBlcy5VMkZfR0VUX0FQSV9WRVJTSU9OX1JFUVVFU1QsdGltZW91dFNlY29uZHM6InVuZGVmaW5lZCIhPXR5cGVvZiBpP2k6ZS5FWFRFTlNJT05fVElNRU9VVF9TRUMscmVxdWVzdElkOnN9O24ucG9zdE1lc3NhZ2Uobyl9KX19fSgpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgzMDEpLGkoMjk5KSxpKDIzNiksaSgzMzkpLGkoMzQwKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC1jaG9pY2VzIixzdGF0ZTp7cGFnZVR5cGU6bnVsbH0sTW9kZWw6e30sRm9ybTp7bm9DYW5jZWxCdXR0b246ITAsdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJlbnJvbGwuY2hvaWNlcy50aXRsZSIsImxvZ2luIiksbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZS5nZXQoInBhZ2VUeXBlIik9PT1pLkFMTF9PUFRJT05BTF9OT05FX0VOUk9MTEVEfSxzdWJ0aXRsZTpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLnN0YXRlLmdldCgicGFnZVR5cGUiKSl7Y2FzZSBpLkFMTF9PUFRJT05BTF9TT01FX0VOUk9MTEVEOmNhc2UgaS5IQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOnJldHVybiB0LmxvYygiZW5yb2xsLmNob2ljZXMub3B0aW9uYWwiLCJsb2dpbiIpO2RlZmF1bHQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5kZXNjcmlwdGlvbiIsImxvZ2luIil9fSxzYXZlOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuc3RhdGUuZ2V0KCJwYWdlVHlwZSIpKXtjYXNlIGkuQUxMX09QVElPTkFMX1NPTUVfRU5ST0xMRUQ6Y2FzZSBpLkhBU19SRVFVSVJFRF9BTExfUkVRVUlSRURfRU5ST0xMRUQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQuZmluaXNoIiwibG9naW4iKTtjYXNlIGkuSEFTX1JFUVVJUkVEX05PTkVfRU5ST0xMRUQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQuY29uZmlndXJlIiwibG9naW4iKTtjYXNlIGkuSEFTX1JFUVVJUkVEX1NPTUVfUkVRVUlSRURfRU5ST0xMRUQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQubmV4dCIsImxvZ2luIik7ZGVmYXVsdDpyZXR1cm4iIn19LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbigpe3ZhciBlO3N3aXRjaCh0aGlzLnN0YXRlLmdldCgicGFnZVR5cGUiKSl7Y2FzZSBpLkhBU19SRVFVSVJFRF9OT05FX0VOUk9MTEVEOmNhc2UgaS5IQVNfUkVRVUlSRURfU09NRV9SRVFVSVJFRF9FTlJPTExFRDplPXQuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIikuZ2V0Rmlyc3RVbmVucm9sbGVkUmVxdWlyZWRGYWN0b3IoKSx0LmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIixuLmNyZWF0ZUVucm9sbEZhY3RvclVybChlLmdldCgicHJvdmlkZXIiKSxlLmdldCgiZmFjdG9yVHlwZSIpKSk7YnJlYWs7ZGVmYXVsdDpyZXR1cm4gdGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnNraXAoKX0pfX0pfSxwcmVSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIik7c3dpdGNoKHRoaXMuc3RhdGUuZ2V0KCJwYWdlVHlwZSIpKXtjYXNlIGkuSEFTX1JFUVVJUkVEX05PTkVfRU5ST0xMRUQ6Y2FzZSBpLkhBU19SRVFVSVJFRF9TT01FX1JFUVVJUkVEX0VOUk9MTEVEOnRoaXMuYWRkKG5ldyBvKHttaW5pbWl6ZTohMCxjb2xsZWN0aW9uOm5ldyB0LkNvbGxlY3Rpb24oZS53aGVyZSh7cmVxdWlyZWQ6ITB9KSksYXBwU3RhdGU6dGhpcy5vcHRpb25zLmFwcFN0YXRlfSkpO2JyZWFrO2Nhc2UgaS5IQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOmNhc2UgaS5BTExfT1BUSU9OQUxfU09NRV9FTlJPTExFRDpjYXNlIGkuQUxMX09QVElPTkFMX05PTkVfRU5ST0xMRUQ6dmFyIG4scj1lLndoZXJlKHtlbnJvbGxlZDohMH0pLGE9ZS53aGVyZSh7ZW5yb2xsZWQ6ITF9KTtyLmxlbmd0aD4wJiYobj10LmxvYygiZW5yb2xsLmNob2ljZXMubGlzdC5vcHRpb25hbCIsImxvZ2luIiksdGhpcy5hZGQobmV3IHMoe2xpc3RUaXRsZTp0LmxvYygiZW5yb2xsLmNob2ljZXMubGlzdC5lbnJvbGxlZCIsImxvZ2luIiksbWluaW1pemU6ITAsY29sbGVjdGlvbjpuZXcgdC5Db2xsZWN0aW9uKHIpLGFwcFN0YXRlOnRoaXMub3B0aW9ucy5hcHBTdGF0ZX0pKSksdGhpcy5hZGQobmV3IHMoe2xpc3RUaXRsZTpuLGNvbGxlY3Rpb246bmV3IHQuQ29sbGVjdGlvbihhKSxhcHBTdGF0ZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGV9KSl9fX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt2YXIgZSxuLHI9MCxzPTAsbz0wLGE9MDt0LmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmVhY2goZnVuY3Rpb24odCl7dmFyIGU9dC5nZXQoInJlcXVpcmVkIiksaT10LmdldCgiZW5yb2xsZWQiKTtlJiZpP3IrKzplJiYhaT9zKys6IWUmJmk/bysrOmV8fGl8fGErK30pLGU9cj4wfHxzPjAsZSYmMD09PXI/bj1pLkhBU19SRVFVSVJFRF9OT05FX0VOUk9MTEVEOmUmJnM+MD9uPWkuSEFTX1JFUVVJUkVEX1NPTUVfUkVRVUlSRURfRU5ST0xMRUQ6ZSYmYT4wP249aS5IQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOjA9PT1vJiZhPjA/bj1pLkFMTF9PUFRJT05BTF9OT05FX0VOUk9MTEVEOmE+MD9uPWkuQUxMX09QVElPTkFMX1NPTUVfRU5ST0xMRUQ6dGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnNraXAoKX0pLHRoaXMuc3RhdGUuc2V0KCJwYWdlVHlwZSIsbil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTkpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fLG49dC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtZmFjdG9yLXJvdyBjbGVhcmZpeCIsdGVtcGxhdGU6J1x0ICAgICAgPGRpdiBjbGFzcz0iZW5yb2xsLWZhY3Rvci1pY29uLWNvbnRhaW5lciI+XHQgICAgICAgIDxkaXYgY2xhc3M9ImZhY3Rvci1pY29uIGVucm9sbC1mYWN0b3ItaWNvbiB7e2ljb25DbGFzc05hbWV9fSI+XHQgICAgICAgIDwvZGl2Plx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGNsYXNzPSJlbnJvbGwtZmFjdG9yLWRlc2NyaXB0aW9uIj5cdCAgICAgICAgPGgzIGNsYXNzPSJlbnJvbGwtZmFjdG9yLWxhYmVsIj57e2ZhY3RvckxhYmVsfX08L2gzPlx0ICAgICAgICB7eyNpZiBmYWN0b3JEZXNjcmlwdGlvbn19XHQgICAgICAgICAgPHA+e3tmYWN0b3JEZXNjcmlwdGlvbn19PC9wPlx0ICAgICAgICB7ey9pZn19XHQgICAgICAgIDxkaXYgY2xhc3M9ImVucm9sbC1mYWN0b3ItYnV0dG9uIj48L2Rpdj5cdCAgICAgIDwvZGl2Plx0ICAgICcsYXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybnsiZGF0YS1zZSI6dGhpcy5tb2RlbC5nZXQoImZhY3Rvck5hbWUiKX19LGNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJlbnJvbGxlZCIpP1tbJzxzcGFuIGNsYXNzPSJpY29uIHN1Y2Nlc3MtMTYtZ3JlZW4iPjwvc3Bhbj4nLCIuZW5yb2xsLWZhY3Rvci1sYWJlbCJdXToiUkVRVUlSRUQiPT09dGhpcy5tb2RlbC5nZXQoImVucm9sbG1lbnQiKT9bWyc8c3BhbiBjbGFzcz0iaWNvbiBzdWNjZXNzLTE2LWdyYXkiPjwvc3Bhbj4nLCIuZW5yb2xsLWZhY3Rvci1sYWJlbCJdXTpbW3QuY3JlYXRlQnV0dG9uKHtjbGFzc05hbWU6ImJ1dHRvbiIsdGl0bGU6dC5sb2MoImVucm9sbC5jaG9pY2VzLnNldHVwIiwibG9naW4iKSxjbGljazpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsZS5jcmVhdGVFbnJvbGxGYWN0b3JVcmwodGhpcy5tb2RlbC5nZXQoInByb3ZpZGVyIiksdGhpcy5tb2RlbC5nZXQoImZhY3RvclR5cGUiKSkpfX0pLCIuZW5yb2xsLWZhY3Rvci1idXR0b24iXV19LG1pbmltaXplOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MoImVucm9sbC1mYWN0b3Itcm93LW1pbiIpfSxtYXhpbWl6ZTpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKCJlbnJvbGwtZmFjdG9yLXJvdy1taW4iKX19KTtyZXR1cm4gdC5MaXN0Vmlldy5leHRlbmQoe2NsYXNzTmFtZToiZW5yb2xsLWZhY3Rvci1saXN0IixpdGVtOm4saXRlbVNlbGVjdG9yOiIubGlzdC1jb250ZW50Iix0ZW1wbGF0ZTonXHQgICAgICB7eyNpZiBsaXN0U3VidGl0bGV9fVx0ICAgICAgICA8ZGl2IGNsYXNzPSJsaXN0LXN1YnRpdGxlIj57e2xpc3RTdWJ0aXRsZX19PC9kaXY+XHQgICAgICB7ey9pZn19XHQgICAgICB7eyNpZiBsaXN0VGl0bGV9fVx0ICAgICAgICA8ZGl2IGNsYXNzPSJsaXN0LXRpdGxlIj57e2xpc3RUaXRsZX19PC9kaXY+XHQgICAgICB7ey9pZn19XHQgICAgICA8ZGl2IGNsYXNzPSJsaXN0LWNvbnRlbnQiPjwvZGl2Plx0ICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU9dC5MaXN0Vmlldy5wcm90b3R5cGUuZ2V0VGVtcGxhdGVEYXRhLmNhbGwodGhpcyk7cmV0dXJuIGkuZXh0ZW5kKGUsdGhpcyksZX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5taW5pbWl6ZSYmdGhpcy5pbnZva2UoIm1pbmltaXplIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMzkpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fO3JldHVybiBlLmV4dGVuZCh7bGlzdFRpdGxlOmkucGFydGlhbCh0LmxvYywiZW5yb2xsLmNob2ljZXMubGlzdC5zZXR1cCIsImxvZ2luIiksY2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGUucHJvdG90eXBlLmNsYXNzTmFtZSsiIGVucm9sbC1yZXF1aXJlZC1mYWN0b3ItbGlzdCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmNvbGxlY3Rpb24ubGVuZ3RoLGk9dGhpcy5jb2xsZWN0aW9uLndoZXJlKHtlbnJvbGxlZDohMH0pLmxlbmd0aCxuPWkrMTt0aGlzLmxpc3RTdWJ0aXRsZT10LmxvYygiZW5yb2xsLmNob2ljZXMuc3RlcCIsImxvZ2luIixbbixlXSl9LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdCxpO2UucHJvdG90eXBlLnBvc3RSZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQ9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmdldEZpcnN0VW5lbnJvbGxlZFJlcXVpcmVkRmFjdG9yKCksaT10aGlzLmZpbmQoZnVuY3Rpb24oZSl7cmV0dXJuIGUubW9kZWw9PT10fSksaS5tYXhpbWl6ZSgpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzE5KSxpKDIxKSxpKDI5NSksaSgzNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC4kLG89dC5fO3JldHVybiBuLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtZHVvIGR1by1mb3JtIixNb2RlbDp7cHJvcHM6e2hvc3Q6InN0cmluZyIsc2lnbmF0dXJlOiJzdHJpbmciLHBvc3RBY3Rpb246InN0cmluZyIsZmFjdG9ySWQ6InN0cmluZyIsc3RhdGVUb2tlbjoic3RyaW5nIn0sZ2V0SW5pdE9wdGlvbnM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPW8uZmluZFdoZXJlKHQuZmFjdG9ycyx7ZmFjdG9yVHlwZToid2ViIixwcm92aWRlcjoiRFVPIn0pO3JldHVybiBlLmVucm9sbCgpfSl9LGFjdGl2YXRlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0KCJwb3N0QWN0aW9uIiksbj10aGlzLmdldCgiZmFjdG9ySWQiKSxyPXRoaXMsbz17aWQ6bixzdGF0ZVRva2VuOnRoaXMuZ2V0KCJzdGF0ZVRva2VuIiksc2lnX3Jlc3BvbnNlOnR9O3JldHVybiBpKHMucG9zdChlLG8pKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHIuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5wb2xsKCl9KX0pLmZhaWwoZnVuY3Rpb24odCl7ci50cmlnZ2VyKCJlcnJvciIscix0Lnhocil9KX19LEZvcm06e2F1dG9TYXZlOiEwLG5vQnV0dG9uQmFyOiEwLHRpdGxlOm8ucGFydGlhbCh0LmxvYywiZW5yb2xsLmR1by50aXRsZSIsImxvZ2luIikscG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuYWRkKCc8aWZyYW1lIGZyYW1lYm9yZGVyPSIwIiB0aXRsZT0iJyt0aGlzLnRpdGxlKCkrJyI+PC9pZnJhbWU+JyksZS5pbml0KHtob3N0OnRoaXMubW9kZWwuZ2V0KCJob3N0Iiksc2lnX3JlcXVlc3Q6dGhpcy5tb2RlbC5nZXQoInNpZ25hdHVyZSIpLGlmcmFtZTp0aGlzLiQoImlmcmFtZSIpLmdldCgwKSxwb3N0X2FjdGlvbjpvLmJpbmQodGhpcy5tb2RlbC5hY3RpdmF0ZSx0aGlzLm1vZGVsKX0pfX0sRm9vdGVyOnIsZmV0Y2hJbml0aWFsRGF0YTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMubW9kZWwuZ2V0SW5pdE9wdGlvbnModGhpcy5vcHRpb25zLmFwcFN0YXRlKS50aGVuKGZ1bmN0aW9uKGUpe3ZhciBpPWUuZGF0YTtpZighKGkmJmkuX2VtYmVkZGVkJiZpLl9lbWJlZGRlZC5mYWN0b3ImJmkuX2VtYmVkZGVkLmZhY3Rvci5fZW1iZWRkZWQmJmkuX2VtYmVkZGVkLmZhY3Rvci5fZW1iZWRkZWQuYWN0aXZhdGlvbikpdGhyb3cgbmV3IEVycm9yKCJSZXNwb25zZSBkb2VzIG5vdCBoYXZlIGR1byBhY3RpdmF0aW9uIG9wdGlvbnMiKTt2YXIgbj1pLl9lbWJlZGRlZC5mYWN0b3Iscj1uLl9lbWJlZGRlZC5hY3RpdmF0aW9uO3QubW9kZWwuc2V0KHtob3N0OnIuaG9zdCxzaWduYXR1cmU6ci5zaWduYXR1cmUscG9zdEFjdGlvbjpyLl9saW5rcy5jb21wbGV0ZS5ocmVmLGZhY3RvcklkOm4uaWQsc3RhdGVUb2tlbjppLnN0YXRlVG9rZW59KX0pfSx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpKXJldHVybiEwfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKV0scj1mdW5jdGlvbih0LGUpe3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuYmFja1RvRmFjdG9ycyIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsZXZlbnRzOnsiY2xpY2sgLmpzLWJhY2siOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmJhY2soKX19LGJhY2s6ZnVuY3Rpb24oKXt0aGlzLnN0YXRlLnNldCgibmF2aWdhdGVEaXIiLGUuRElSRUNUSU9OX0JBQ0spLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInByZXZMaW5rIik/dGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnByZXYoKX0pOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsInNpZ25pbi9lbnJvbGwiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTQpLGkoMzQyKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC1xdWVzdGlvbiIsTW9kZWw6e3Byb3BzOntxdWVzdGlvbjoic3RyaW5nIixhbnN3ZXI6WyJzdHJpbmciLCEwXX0sbG9jYWw6e3NlY3VyaXR5UXVlc3Rpb25zOiJvYmplY3QifSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXt2YXIgZT1zLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6InF1ZXN0aW9uIixwcm92aWRlcjoiT0tUQSJ9KTtyZXR1cm4gZS5lbnJvbGwoe3Byb2ZpbGU6e3F1ZXN0aW9uOnRoaXMuZ2V0KCJxdWVzdGlvbiIpLGFuc3dlcjp0aGlzLmdldCgiYW5zd2VyIil9fSl9KX19LEZvcm06e2F1dG9TYXZlOiEwLHRpdGxlOnMucGFydGlhbCh0LmxvYywiZW5yb2xsLnNlY3VyaXR5UXVlc3Rpb24uc2V0dXAiLCJsb2dpbiIpLGlucHV0czpmdW5jdGlvbigpe3JldHVyblt7bGFiZWw6ITEsImxhYmVsLXRvcCI6ITAsbmFtZToicXVlc3Rpb24iLHR5cGU6InNlbGVjdCIsd2lkZTohMCxvcHRpb25zOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJzZWN1cml0eVF1ZXN0aW9ucyIpfSxwYXJhbXM6e3NlYXJjaFRocmVzaG9sZDoyNX19LHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5hbnN3ZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiby1mb3JtLWZpZWxkc2V0IG8tZm9ybS1sYWJlbC10b3AgYXV0aC1wYXNzY29kZSIsbmFtZToiYW5zd2VyIixpbnB1dDpyLHR5cGU6InRleHQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJtZmEuY2hhbGxlbmdlLmFuc3dlci50b29sdGlwIiwibG9naW4iKX19XX19LEZvb3RlcjpuLGZldGNoSW5pdGlhbERhdGE6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3JldHVybiB0aGlzLm1vZGVsLm1hbmFnZVRyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPXMuZmluZFdoZXJlKHQuZmFjdG9ycyx7ZmFjdG9yVHlwZToicXVlc3Rpb24iLHByb3ZpZGVyOiJPS1RBIn0pO3JldHVybiBlLnF1ZXN0aW9ucygpfSkudGhlbihmdW5jdGlvbihlKXt2YXIgbj17fTtzLmVhY2goZSxmdW5jdGlvbih0KXtuW3QucXVlc3Rpb25dPWkuZ2V0U2VjdXJpdHlRdWVzdGlvbkxhYmVsKHQpfSksdC5tb2RlbC5zZXQoInNlY3VyaXR5UXVlc3Rpb25zIixuKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDI5NiksaSgzMzMpLGkoMzM0KSxpKDM0MiksaSgzMzUpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXztyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiZW5yb2xsLXdpbmRvd3MtaGVsbG8iLE1vZGVsOntsb2NhbDp7X19pc0Vucm9sbGVkX186ImJvb2xlYW4ifSxzYXZlOmZ1bmN0aW9uKCl7aWYobi5pc0F2YWlsYWJsZSgpKXJldHVybiB0aGlzLnRyaWdnZXIoInJlcXVlc3QiKSx0aGlzLmdldCgiX19pc0Vucm9sbGVkX18iKT90aGlzLmFjdGl2YXRlKCk6dGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9lbnJvbGwodCl9KX0sX2Vucm9sbDpmdW5jdGlvbih0KXt2YXIgZT1hLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6IndlYmF1dGhuIixwcm92aWRlcjoiRklETyJ9KTtyZXR1cm4gZS5lbnJvbGwoKX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXQoIl9faXNFbnJvbGxlZF9fIiwhMCksdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPXQuZmFjdG9yLmFjdGl2YXRpb24saT10LnVzZXIscj10aGlzLHM9e3JwRGlzcGxheU5hbWU6ZS5ycERpc3BsYXlOYW1lLHVzZXJEaXNwbGF5TmFtZTppLnByb2ZpbGUuZGlzcGxheU5hbWUsYWNjb3VudE5hbWU6aS5wcm9maWxlLmxvZ2luLHVzZXJJZDppLmlkfSxvPVt7YWxnb3JpdGhtOmUuYWxnb3JpdGhtfV0sYT1lLm5vbmNlO3JldHVybiBuLm1ha2VDcmVkZW50aWFsKHMsbyxhKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiB0LmFjdGl2YXRlKHtjcmVkZW50aWFsSWQ6ZS5jcmVkZW50aWFsLmlkLHB1YmxpY0tleTplLnB1YmxpY0tleSxhdHRlc3RhdGlvbjpudWxsfSl9KS5mYWlsKGZ1bmN0aW9uKGUpe3N3aXRjaChlLm1lc3NhZ2Upe2Nhc2UiQWJvcnRFcnJvciI6Y2FzZSJOb3RGb3VuZEVycm9yIjpjYXNlIk5vdFN1cHBvcnRlZEVycm9yIjpyZXR1cm4gci50cmlnZ2VyKCJhYm9ydCIsZS5tZXNzYWdlKSx0fXRocm93IGV9KX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsaGFzU2F2aW5nU3RhdGU6ITEsdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJlbnJvbGwud2luZG93c0hlbGxvLnRpdGxlIiwibG9naW4iKSxzdWJ0aXRsZTpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/dC5sb2MoImVucm9sbC53aW5kb3dzSGVsbG8uc3VidGl0bGUiLCJsb2dpbiIpOiIifSxzYXZlOmEucGFydGlhbCh0LmxvYywiZW5yb2xsLndpbmRvd3NIZWxsby5zYXZlIiwibG9naW4iKSxjdXN0b21TYXZpbmdTdGF0ZTp7c3RvcDoiYWJvcnQifSxtb2RlbEV2ZW50czpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQiLGFib3J0OiJfc3RvcEVucm9sbG1lbnQifTp7fX0sbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hbi5pc0F2YWlsYWJsZSgpfSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gbi5pc0F2YWlsYWJsZSgpfHxlLnB1c2goaS5WaWV3KHtWaWV3Om5ldyBvKHttZXNzYWdlOnQubG9jKCJlbnJvbGwud2luZG93c0hlbGxvLmVycm9yLm5vdFdpbmRvd3MiLCJsb2dpbiIpfSl9LHtzZWxlY3RvcjoiLm8tZm9ybS1lcnJvci1jb250YWluZXIifSkpLGUucHVzaChpLlZpZXcoe1ZpZXc6bmV3IHIoe21vZGVsOnRoaXMubW9kZWwsdmlzaWJsZTohMX0pfSkpLGV9LF9zdGFydEVucm9sbG1lbnQ6ZnVuY3Rpb24oKXt0aGlzLnN1YnRpdGxlPXQubG9jKCJlbnJvbGwud2luZG93c0hlbGxvLnN1YnRpdGxlLmxvYWRpbmciLCJsb2dpbiIpLHRoaXMubW9kZWwudHJpZ2dlcigic3Bpbm5lcjpzaG93IiksdGhpcy5fcmVzZXRFcnJvck1lc3NhZ2UoKSx0aGlzLnJlbmRlcigpLHRoaXMuJCgiLm8tZm9ybS1idXR0b24tYmFyIikuYWRkQ2xhc3MoImhpZGUiKX0sX3N0b3BFbnJvbGxtZW50OmZ1bmN0aW9uKGUpe3RoaXMuc3VidGl0bGU9dC5sb2MoImVucm9sbC53aW5kb3dzSGVsbG8uc3VidGl0bGUiLCJsb2dpbiIpLHRoaXMubW9kZWwudHJpZ2dlcigic3Bpbm5lcjpoaWRlIiksdGhpcy4kKCIuby1mb3JtLWJ1dHRvbi1iYXIiKS5yZW1vdmVDbGFzcygiaGlkZSIpO3ZhciBpO3N3aXRjaChlKXtjYXNlIk5vdFN1cHBvcnRlZEVycm9yIjppPXQubG9jKCJlbnJvbGwud2luZG93c0hlbGxvLmVycm9yLm5vdENvbmZpZ3VyZWRIdG1sIiwibG9naW4iKX1pZih0aGlzLl9yZXNldEVycm9yTWVzc2FnZSgpLGkpe3ZhciBuPW5ldyBvKHttZXNzYWdlOml9KTt0aGlzLiQoIi5vLWZvcm0tZXJyb3ItY29udGFpbmVyIikuYWRkQ2xhc3MoIm8tZm9ybS1oYXMtZXJyb3JzIiksdGhpcy5hZGQobix7c2VsZWN0b3I6Ii5vLWZvcm0tZXJyb3ItY29udGFpbmVyIn0pLHRoaXMuX2Vycm9yTWVzc2FnZVZpZXc9dGhpcy5sYXN0KCl9dGhpcy5yZW5kZXIoKX0sX3Jlc2V0RXJyb3JNZXNzYWdlOmZ1bmN0aW9uKCl7dGhpcy5fZXJyb3JNZXNzYWdlVmlldyYmdGhpcy5fZXJyb3JNZXNzYWdlVmlldy5yZW1vdmUoKSx0aGlzLl9lcnJvck1lc3NhZ2VWaWV3PXZvaWQgMCx0aGlzLmNsZWFyRXJyb3JzKCl9fSxGb290ZXI6cyx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpKXJldHVybiB0aGlzLm1vZGVsLmFjdGl2YXRlKCksITB9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMzQyKSxpKDMwNSksaSgzMDYpLGkoMjkyKSxpKDI5NiksaSgxNzMpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7ZnVuY3Rpb24gbCh0KXtyZXR1cm4iY2FsbCI9PT10fWZ1bmN0aW9uIGModCl7cmV0dXJuIGwodCk/ImVucm9sbC1jYWxsIjoiZW5yb2xsLXNtcyJ9ZnVuY3Rpb24gdSh0KXthLmlzRW50ZXIodCkmJih0LnN0b3BQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSwia2V5dXAiPT09dC50eXBlJiZ0LmRhdGEmJnQuZGF0YS5tb2RlbCYmdC5kYXRhLm1vZGVsLnNlbmRDb2RlKCkpfXZhciBkPXQuXyxoPTNlNCxwPXtmYWN0b3JJZDpmdW5jdGlvbih0KXtyZXR1cm4hZC5pc1VuZGVmaW5lZCh0KX19O3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGModGhpcy5vcHRpb25zLmZhY3RvclR5cGUpfSxNb2RlbDp7cHJvcHM6e2NvdW50cnlDb2RlOlsic3RyaW5nIiwhMCwiVVMiXSxwaG9uZU51bWJlcjpbInN0cmluZyIsITBdLHBob25lRXh0ZW5zaW9uOlsic3RyaW5nIiwhMV0sbGFzdEVucm9sbGVkUGhvbmVOdW1iZXI6InN0cmluZyIscGFzc0NvZGU6WyJzdHJpbmciLCEwXSxmYWN0b3JJZDoic3RyaW5nIn0sbG9jYWw6e2hhc0V4aXN0aW5nUGhvbmVzOiJib29sZWFuIix0cmFwRW5yb2xsbWVudDoiYm9vbGVhbiIsYWJsZVRvUmVzZW5kOiJib29sZWFuIixmYWN0b3JUeXBlOiJzdHJpbmciLHNraXBQaG9uZVZhbGlkYXRpb246ImJvb2xlYW4ifSxkZXJpdmVkOntjb3VudHJ5Q2FsbGluZ0NvZGU6e2RlcHM6WyJjb3VudHJ5Q29kZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiIrIitzLmdldENhbGxpbmdDb2RlRm9yQ291bnRyeSh0KX19LGZ1bGxQaG9uZU51bWJlcjp7ZGVwczpbImNvdW50cnlDYWxsaW5nQ29kZSIsInBob25lTnVtYmVyIl0sZm46ZnVuY3Rpb24odCxlKXtyZXR1cm4gZT90K2U6IiJ9fSxlbnJvbGxlZDp7ZGVwczpbImxhc3RFbnJvbGxlZFBob25lTnVtYmVyIiwiZnVsbFBob25lTnVtYmVyIl0sZm46ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD09PWV9fX0sbGltaXRSZXNlbmRpbmc6ZnVuY3Rpb24oKXt0aGlzLnNldCh7YWJsZVRvUmVzZW5kOiExfSksZC5kZWxheShkLmJpbmQodGhpcy5zZXQsdGhpcyksaCx7YWJsZVRvUmVzZW5kOiEwfSl9LHNlbmRDb2RlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxpPXRoaXMuZ2V0KCJmdWxsUGhvbmVOdW1iZXIiKSxuPXRoaXMuZ2V0KCJwaG9uZUV4dGVuc2lvbiIpO3JldHVybiBlLnRyaWdnZXIoImVycm9yczpjbGVhciIpLGkubGVuZ3RoP3RoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbihyKXt2YXIgcz0iTUZBX0VOUk9MTCI9PT1yLnN0YXR1cyxvPXtwaG9uZU51bWJlcjppLHVwZGF0ZVBob25lOiFzfHxlLmdldCgiaGFzRXhpc3RpbmdQaG9uZXMiKX07bChlLmdldCgiZmFjdG9yVHlwZSIpKSYmKG8ucGhvbmVFeHRlbnNpb249biksZS5nZXQoInNraXBQaG9uZVZhbGlkYXRpb24iKSYmKG8udmFsaWRhdGVQaG9uZT0hMSk7dmFyIGE9ZnVuY3Rpb24oaSl7dmFyIG49ZC5maW5kV2hlcmUoaS5mYWN0b3JzLHtmYWN0b3JUeXBlOmUuZ2V0KCJmYWN0b3JUeXBlIikscHJvdmlkZXI6Ik9LVEEifSk7cmV0dXJuIG4uZW5yb2xsKHtwcm9maWxlOm99KS5mYWlsKGZ1bmN0aW9uKGkpe3Rocm93IkUwMDAwMDk4Ij09PWkuZXJyb3JDb2RlJiYoZS5zZXQoInNraXBQaG9uZVZhbGlkYXRpb24iLCEwKSxpLnhoci5yZXNwb25zZUpTT04uZXJyb3JTdW1tYXJ5PXQubG9jKCJlbnJvbGwuc21zLnRyeV9hZ2FpbiIsImxvZ2luIikpLGl9KX07cmV0dXJuIHM/YShyKTooZS5zZXQoInRyYXBFbnJvbGxtZW50IiwhMCksci5wcmV2KCkudGhlbihhKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBlLnNldCgidHJhcEVucm9sbG1lbnQiLCExKSx0fSkpfSwhMCkudGhlbihmdW5jdGlvbigpe2Uuc2V0KCJsYXN0RW5yb2xsZWRQaG9uZU51bWJlciIsaSksZS5saW1pdFJlc2VuZGluZygpfSkuZmFpbChmdW5jdGlvbigpe2Uuc2V0KCJhYmxlVG9SZXNlbmQiLCEwKSxlLnNldCgidHJhcEVucm9sbG1lbnQiLCExKX0pOnZvaWQgZS50cmlnZ2VyKCJpbnZhbGlkIixlLHtwaG9uZU51bWJlcjoibW9kZWwudmFsaWRhdGlvbi5maWVsZC5ibGFuayJ9KX0scmVzZW5kQ29kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRyaWdnZXIoImVycm9yczpjbGVhciIpLHRoaXMubGltaXRSZXNlbmRpbmcoKSx0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucmVzZW5kKHRoaXMuZ2V0KCJmYWN0b3JUeXBlIikpfSl9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LmFjdGl2YXRlKHtwYXNzQ29kZTp0aGlzLmdldCgicGFzc0NvZGUiKX0pfSl9fSxGb3JtOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmZhY3RvclR5cGUsaT1sKGUpLGE9dC5sb2MoaT8iZW5yb2xsLmNhbGwuc2V0dXAiOiJlbnJvbGwuc21zLnNldHVwIiwibG9naW4iKSxkPXQubG9jKGk/Im1mYS5jYWxsIjoibWZhLnNlbmRDb2RlIiwibG9naW4iKSxoPXQubG9jKGk/Im1mYS5yZWRpYWwiOiJtZmEucmVzZW5kQ29kZSIsImxvZ2luIiksZj10LmxvYyhpPyJtZmEuY2FsbGluZyI6Im1mYS5zZW50IiwibG9naW4iKSxtPWk/ImVucm9sbC1jYWxsLXBob25lIjoiZW5yb2xsLXNtcy1waG9uZSIsXz1pPyJjYWxsLXJlcXVlc3QtYnV0dG9uIjoic21zLXJlcXVlc3QtYnV0dG9uIixnPVtvLklucHV0KHtuYW1lOiJjb3VudHJ5Q29kZSIsdHlwZToic2VsZWN0Iix3aWRlOiEwLG9wdGlvbnM6cy5nZXRDb3VudHJpZXMoKX0pLG8uSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJtZmEucGhvbmVOdW1iZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZTptLG5hbWU6InBob25lTnVtYmVyIixpbnB1dDpuLHR5cGU6InRleHQiLHJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJCgnaW5wdXRbbmFtZT0icGhvbmVOdW1iZXIiXScpLm9mZigia2V5ZG93biBrZXl1cCIsdSkua2V5ZG93bih1KS5rZXl1cCh7bW9kZWw6dGhpcy5tb2RlbH0sdSl9fSldO3JldHVybiBpJiZnLnB1c2goby5JbnB1dCh7cGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5waG9uZU51bWJlci5leHQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiZW5yb2xsLWNhbGwtZXh0ZW5zaW9uIixuYW1lOiJwaG9uZUV4dGVuc2lvbiIsaW5wdXQ6cix0eXBlOiJ0ZXh0In0pKSxnLnB1c2goby5CdXR0b24oe3RpdGxlOmQsYXR0cmlidXRlczp7ImRhdGEtc2UiOl99LGNsYXNzTmFtZToiYnV0dG9uIGJ1dHRvbi1wcmltYXJ5IGpzLWVucm9sbC1waG9uZSAiK18sY2xpY2s6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnNlbmRDb2RlKCl9fSksby5CdXR0b24oe3RpdGxlOmgsYXR0cmlidXRlczp7ImRhdGEtc2UiOl99LGNsYXNzTmFtZToiYnV0dG9uIGpzLWVucm9sbC1waG9uZSAiK18sY2xpY2s6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnJlc2VuZENvZGUoKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuJGVsLmNzcyh7ZGlzcGxheToibm9uZSJ9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTphYmxlVG9SZXNlbmQiLGZ1bmN0aW9uKHQsZSl7ZT8odGhpcy5vcHRpb25zLnRpdGxlPWgsdGhpcy5lbmFibGUoKSk6KHRoaXMub3B0aW9ucy50aXRsZT1mLHRoaXMuZGlzYWJsZSgpKSx0aGlzLnJlbmRlcigpfSl9fSksby5EaXZpZGVyKHtzaG93V2hlbjpwfSksby5JbnB1dCh7cGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuZW50ZXJDb2RlLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJwYXNzQ29kZSIsaW5wdXQ6cix0eXBlOiJudW1iZXIiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJtZmEuY2hhbGxlbmdlLmVudGVyQ29kZS50b29sdGlwIiwibG9naW4iKX0sc2hvd1doZW46cH0pLG8uVG9vbGJhcih7bm9DYW5jZWxCdXR0b246ITAsc2F2ZTp0LmxvYygibWZhLmNoYWxsZW5nZS52ZXJpZnkiLCJsb2dpbiIpLHNob3dXaGVuOnB9KSkse3RpdGxlOmEsbm9CdXR0b25CYXI6ITAsYXV0b1NhdmU6ITAsY2xhc3NOYW1lOmMoZSksaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IgZXJyb3JzOmNsZWFyIixmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOmVucm9sbGVkIixmdW5jdGlvbigpe3RoaXMuJCgiLmpzLWVucm9sbC1waG9uZSIpLnRvZ2dsZSgpfSl9LGZvcm1DaGlsZHJlbjpnfX0sRm9vdGVyOmksdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUVucm9sbEFjdGl2YXRlIik/KHRoaXMubW9kZWwuc2V0KCJmYWN0b3JJZCIsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9ySWQiKSksITApOiEoIXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzTWZhRW5yb2xsIil8fCF0aGlzLm1vZGVsLmdldCgidHJhcEVucm9sbG1lbnQiKSl8fHZvaWQgMH0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe2wodGhpcy5vcHRpb25zLmZhY3RvclR5cGUpP3RoaXMubW9kZWwuc2V0KCJoYXNFeGlzdGluZ1Bob25lcyIsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaGFzRXhpc3RpbmdQaG9uZXNGb3JDYWxsIikpOnRoaXMubW9kZWwuc2V0KCJoYXNFeGlzdGluZ1Bob25lcyIsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaGFzRXhpc3RpbmdQaG9uZXMiKSksdGhpcy5tb2RlbC5zZXQoImZhY3RvclR5cGUiLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NiksaSgyOTUpLGkoMzQyKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyKXtmdW5jdGlvbiBzKHQpe3JldHVybiJSU0EiPT09dH1mdW5jdGlvbiBvKHQpe3JldHVybiBzKHQpPyJlbnJvbGwtcnNhIjoiZW5yb2xsLW9ucHJlbSJ9dmFyIGE9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIG8odGhpcy5vcHRpb25zLnByb3ZpZGVyKX0sTW9kZWw6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMucHJvdmlkZXIsZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIiksaT1lLmZpbmRXaGVyZShhLnBpY2sodGhpcy5vcHRpb25zLCJwcm92aWRlciIsImZhY3RvclR5cGUiKSksbj1pLmdldCgicHJvZmlsZSIpLHI9biYmbi5jcmVkZW50aWFsSWQ/bi5jcmVkZW50aWFsSWQ6IiI7cmV0dXJue3Byb3BzOntjcmVkZW50aWFsSWQ6WyJzdHJpbmciLCEwLHJdLHBhc3NDb2RlOlsic3RyaW5nIiwhMF0sZmFjdG9ySWQ6InN0cmluZyJ9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPWEuZmluZFdoZXJlKGUuZmFjdG9ycyx7ZmFjdG9yVHlwZToidG9rZW4iLHByb3ZpZGVyOnR9KTtyZXR1cm4gaS5lbnJvbGwoe3Bhc3NDb2RlOnRoaXMuZ2V0KCJwYXNzQ29kZSIpLHByb2ZpbGU6e2NyZWRlbnRpYWxJZDp0aGlzLmdldCgiY3JlZGVudGlhbElkIil9fSl9KX19fSxGb3JtOmZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5vcHRpb25zLnByb3ZpZGVyLG49dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLGw9bi5maW5kV2hlcmUoYS5waWNrKHRoaXMub3B0aW9ucywicHJvdmlkZXIiLCJmYWN0b3JUeXBlIikpLGM9bC5nZXQoInZlbmRvck5hbWUiKSx1PXMoaSk/dC5sb2MoImZhY3Rvci50b3RwSGFyZC5yc2FTZWN1cklkIiwibG9naW4iKTpjO3JldHVybnt0aXRsZTp1LG5vQnV0dG9uQmFyOiEwLGF1dG9TYXZlOiEwLGNsYXNzTmFtZTpvKGkpLGZvcm1DaGlsZHJlbjpbZS5JbnB1dCh7bmFtZToiY3JlZGVudGlhbElkIixpbnB1dDpyLHR5cGU6InRleHQiLHBsYWNlaG9sZGVyOnQubG9jKCJlbnJvbGwub25wcmVtLnVzZXJuYW1lLnBsYWNlaG9sZGVyIiwibG9naW4iLFtjXSkscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoImVucm9sbC5vbnByZW0udXNlcm5hbWUudG9vbHRpcCIsImxvZ2luIixbY10pfX0pLGUuSW5wdXQoe25hbWU6InBhc3NDb2RlIixpbnB1dDpyLHR5cGU6InBhc3N3b3JkIixwbGFjZWhvbGRlcjp0LmxvYygiZW5yb2xsLm9ucHJlbS5wYXNzY29kZS5wbGFjZWhvbGRlciIsImxvZ2luIixbY10pLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJlbnJvbGwub25wcmVtLnBhc3Njb2RlLnRvb2x0aXAiLCJsb2dpbiIsW2NdKX19KSxlLlRvb2xiYXIoe25vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6dC5sb2MoIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKX0pXX19LEZvb3RlcjpufSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTYpLGkoMjk1KSxpKDM0MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtc3ltYW50ZWMiLE1vZGVsOntwcm9wczp7Y3JlZGVudGlhbElkOlsic3RyaW5nIiwhMF0scGFzc0NvZGU6WyJzdHJpbmciLCEwXSxuZXh0UGFzc0NvZGU6WyJzdHJpbmciLCEwXSxmYWN0b3JJZDoic3RyaW5nIn0sc2F2ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7dmFyIGU9cy5maW5kV2hlcmUodC5mYWN0b3JzLHtmYWN0b3JUeXBlOiJ0b2tlbiIscHJvdmlkZXI6IlNZTUFOVEVDIn0pO3JldHVybiBlLmVucm9sbCh7cGFzc0NvZGU6dGhpcy5nZXQoInBhc3NDb2RlIiksbmV4dFBhc3NDb2RlOnRoaXMuZ2V0KCJuZXh0UGFzc0NvZGUiKSxwcm9maWxlOntjcmVkZW50aWFsSWQ6dGhpcy5nZXQoImNyZWRlbnRpYWxJZCIpfX0pfSl9fSxGb3JtOnt0aXRsZTpzLnBhcnRpYWwodC5sb2MsImZhY3Rvci50b3RwSGFyZC5zeW1hbnRlY1ZpcCIsImxvZ2luIiksc3VidGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwuc3ltYW50ZWNWaXAuc3VidGl0bGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF1dG9TYXZlOiEwLGNsYXNzTmFtZToiZW5yb2xsLXN5bWFudGVjIixmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bZS5JbnB1dCh7bmFtZToiY3JlZGVudGlhbElkIixpbnB1dDpyLHR5cGU6InRleHQiLHBsYWNlaG9sZGVyOnQubG9jKCJlbnJvbGwuc3ltYW50ZWNWaXAuY3JlZGVudGlhbElkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygiZW5yb2xsLnN5bWFudGVjVmlwLmNyZWRlbnRpYWxJZC50b29sdGlwIiwibG9naW4iKX19KSxlLklucHV0KHtuYW1lOiJwYXNzQ29kZSIsaW5wdXQ6cix0eXBlOiJ0ZXh0IixwbGFjZWhvbGRlcjp0LmxvYygiZW5yb2xsLnN5bWFudGVjVmlwLnBhc3Njb2RlMS5wbGFjZWhvbGRlciIsImxvZ2luIikscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoImVucm9sbC5zeW1hbnRlY1ZpcC5wYXNzY29kZTEudG9vbHRpcCIsImxvZ2luIil9fSksZS5JbnB1dCh7bmFtZToibmV4dFBhc3NDb2RlIixpbnB1dDpyLHR5cGU6InRleHQiLHBsYWNlaG9sZGVyOnQubG9jKCJlbnJvbGwuc3ltYW50ZWNWaXAucGFzc2NvZGUyLnBsYWNlaG9sZGVyIiwibG9naW4iKSxwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygiZW5yb2xsLnN5bWFudGVjVmlwLnBhc3Njb2RlMi50b29sdGlwIiwibG9naW4iKX19KSxlLlRvb2xiYXIoe25vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6dC5sb2MoIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKX0pXX19LEZvb3RlcjpufSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTYpLGkoMjk1KSxpKDM0MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwteXViaWtleSIsTW9kZWw6e3Byb3BzOntwYXNzQ29kZTpbInN0cmluZyIsITBdLGZhY3RvcklkOiJzdHJpbmcifSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXt2YXIgZT1zLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6InRva2VuOmhhcmR3YXJlIixwcm92aWRlcjoiWVVCSUNPIn0pO3JldHVybiBlLmVucm9sbCh7cGFzc0NvZGU6dGhpcy5nZXQoInBhc3NDb2RlIil9KX0pfX0sRm9ybTp7dGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwueXViaWtleS50aXRsZSIsImxvZ2luIiksc3VidGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwueXViaWtleS5zdWJ0aXRsZSIsImxvZ2luIiksbm9DYW5jZWxCdXR0b246ITAsc2F2ZTpzLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxhdXRvU2F2ZTohMCxjbGFzc05hbWU6ImVucm9sbC15dWJpa2V5Iixmb3JtQ2hpbGRyZW46W2UuVmlldyh7VmlldzonPGRpdiBjbGFzcz0ieXViaWtleS1kZW1vIiBkYXRhLXR5cGU9Inl1YmlrZXktZXhhbXBsZSI+PC9kaXY+J30pLGUuSW5wdXQoe25hbWU6InBhc3NDb2RlIixpbnB1dDpyLHR5cGU6InBhc3N3b3JkIn0pXX0sRm9vdGVyOm59KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTUpLGkoMjk2KSxpKDI5OSksaSgzNTApLGkoMzUxKSxpKDM0MildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXt2YXIgbD10Ll8sYz17X19kZXZpY2VUeXBlX186ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMCE9PXR9fSx1PXQuVmlldy5leHRlbmQoe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiYXBwLWRvd25sb2FkLWluc3RydWN0aW9ucyJ9LGNsYXNzTmFtZToiYXBwLWRvd25sb2FkLWluc3RydWN0aW9ucyIsdGVtcGxhdGU6J1x0ICAgICAgPHAgY2xhc3M9Imluc3RydWN0aW9ucy10aXRsZSI+e3t0aXRsZX19PC9wPlx0ICAgICAgPHNwYW4gY2xhc3M9ImFwcC1sb2dvIHt7YXBwSWNvbn19Ij48L3NwYW4+XHQgICAgICA8cCBjbGFzcz0iaW5zdHJ1Y3Rpb25zIj57e3thcHBTdG9yZUxpbmtUZXh0fX19PC9wPlx0ICAgICcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOl9fZGV2aWNlVHlwZV9fIix0aGlzLnJlbmRlcil9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBpLG4scixvPWUuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gcj1zLlNUT1JFW3RoaXMubW9kZWwuZ2V0KCJfX2RldmljZVR5cGVfXyIpXSwiR09PR0xFIj09PXRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKT8oaT1zLkdPT0dMRVt0aGlzLm1vZGVsLmdldCgiX19kZXZpY2VUeXBlX18iKV0sbj0iZ29vZ2xlLWF1dGgtMzgiKTooaT1zLk9LVEFbdGhpcy5tb2RlbC5nZXQoIl9fZGV2aWNlVHlwZV9fIildLG49Im9rdGEtdmVyaWZ5LTM4Iikse3RpdGxlOnQubG9jKCJlbnJvbGwudG90cC5pbnN0YWxsQXBwIiwibG9naW4iLFtvXSksYXBwU3RvcmVMaW5rVGV4dDp0LmxvYygiZW5yb2xsLnRvdHAuZG93bmxvYWRBcHAiLCJsb2dpbiIsW2ksbyxyXSksYXBwSWNvbjpufX19KSxkPWkuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC10b3RwIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntsb2NhbDp7X19kZXZpY2VUeXBlX186InN0cmluZyIsX19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPWwuZmluZFdoZXJlKHQuZmFjdG9ycyx7ZmFjdG9yVHlwZTp0aGlzLmdldCgiX19mYWN0b3JUeXBlX18iKSxwcm92aWRlcjp0aGlzLmdldCgiX19wcm92aWRlcl9fIil9KTtyZXR1cm4gZS5lbnJvbGwoKX0pfX19LEZvcm06e3RpdGxlOmZ1bmN0aW9uKCl7dmFyIGk9ZS5nZXRGYWN0b3JMYWJlbCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIikpO3JldHVybiB0LmxvYygiZW5yb2xsLnRvdHAudGl0bGUiLCJsb2dpbiIsW2ldKX0sc3VidGl0bGU6bC5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudG90cC5zZWxlY3REZXZpY2UiLCJsb2dpbiIpLGF1dG9TYXZlOiEwLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic3RlcC1kZXZpY2UtdHlwZSJ9LGZvcm1DaGlsZHJlbjpmdW5jdGlvbigpe3ZhciBlPXtBUFBMRToiIixBTkRST0lEOiIifTt0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMud2luZG93c1ZlcmlmeSIpJiYiT0tUQSI9PT10aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIik/ZS5XSU5ET1dTPSIiOiJHT09HTEUiPT09dGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpJiYoZS5CTEFDS0JFUlJZPSIiKTt2YXIgaT1bbi5JbnB1dCh7bmFtZToiX19kZXZpY2VUeXBlX18iLHR5cGU6InJhZGlvIixvcHRpb25zOmUsY2xhc3NOYW1lOiJkZXZpY2UtdHlwZS1pbnB1dCJ9KSxuLkRpdmlkZXIoe3Nob3dXaGVuOmN9KSxuLlZpZXcoe1ZpZXc6dSxzaG93V2hlbjpjfSksbi5Ub29sYmFyKHtub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnQubG9jKCJvZm9ybS5uZXh0IiwibG9naW4iKSxzaG93V2hlbjpjfSldO3JldHVybiBpfX0sRm9vdGVyOmF9KTtyZXR1cm4gZH0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7ISh0LmV4cG9ydHM9e09LVEE6e0FQUExFOiJodHRwczovL2l0dW5lcy5hcHBsZS5jb20vdXMvYXBwL29rdGEtdmVyaWZ5L2lkNDkwMTc5NDA1IixBTkRST0lEOiJodHRwczovL3BsYXkuZ29vZ2xlLmNvbS9zdG9yZS9hcHBzL2RldGFpbHM/aWQ9Y29tLm9rdGEuYW5kcm9pZC5hdXRoIixXSU5ET1dTOiJodHRwOi8vd3d3LndpbmRvd3NwaG9uZS5jb20vZW4tdXMvc3RvcmUvYXBwL29rdGEtdmVyaWZ5LzlkZjBlMmM0LTczMDEtNDExZi04MGU1LTYyZmNmNjY3OTY2NiJ9LEdPT0dMRTp7QVBQTEU6Imh0dHBzOi8vaXR1bmVzLmFwcGxlLmNvbS91cy9hcHAvZ29vZ2xlLWF1dGhlbnRpY2F0b3IvaWQzODg0OTc2MDUiLEFORFJPSUQ6Imh0dHBzOi8vcGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD1jb20uZ29vZ2xlLmFuZHJvaWQuYXBwcy5hdXRoZW50aWNhdG9yMiIsQkxBQ0tCRVJSWToiaHR0cHM6Ly9zdXBwb3J0Lmdvb2dsZS5jb20vYWNjb3VudHMvYW5zd2VyLzEwNjY0NDcifSxTVE9SRTp7QVBQTEU6IkFwcCBTdG9yZSIsQU5EUk9JRDoiR29vZ2xlIFBsYXkgU3RvcmUiLFdJTkRPV1M6IldpbmRvd3MgU3RvcmUiLEJMQUNLQkVSUlk6IkJsYWNrYmVycnkgV29ybGQgU3RvcmUifX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTkpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll87cmV0dXJuIHQuVmlldy5leHRlbmQoe2NsYXNzTmFtZToic2Nhbi1pbnN0cnVjdGlvbnMgY2xlYXJmaXgiLHRlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9InNjYW4taW5zdHJ1Y3Rpb25zLWRldGFpbHMtd3JhcHBlciI+XHQgICAgICAgICAgPGRpdiBjbGFzcz0ic2Nhbi1pbnN0cnVjdGlvbnMtZGV0YWlscyI+XHQgICAgICAgICAgICAgIDxwPnt7aW5zdHJ1Y3Rpb25zfX08L3A+XHQgICAgICAgICAgPC9kaXY+XHQgICAgICA8L2Rpdj5cdCAgICAgIDxkaXYgY2xhc3M9InNjYW4taW5zdHJ1Y3Rpb25zLXFyY29kZS13cmFwcGVyIj5cdCAgICAgICAgICA8ZGl2IGNsYXNzPSJxcmNvZGUtd3JhcCI+XHQgICAgICAgICAgICAgIDxpbWcgZGF0YS1zZT0icXJjb2RlIiBjbGFzcz0icXJjb2RlLWltYWdlIiBzcmM9Int7cXJjb2RlfX0iPlx0ICAgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InFyY29kZS1zdWNjZXNzIiBjbGFzcz0icXJjb2RlLXN1Y2Nlc3MiPjwvZGl2Plx0ICAgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InFyY29kZS1lcnJvciIgY2xhc3M9InFyY29kZS1lcnJvciI+PC9kaXY+XHQgICAgICAgICAgPC9kaXY+XHQgICAgICAgICAgPGEgaHJlZj0iIyIgZGF0YS10eXBlPSJtYW51YWwtc2V0dXAiIGRhdGEtc2U9Im1hbnVhbC1zZXR1cCIgY2xhc3M9ImxpbmsgbWFudWFsLXNldHVwIj5cdCAgICAgICAgICAgIHt7aTE4biBjb2RlPSJlbnJvbGwudG90cC5jYW5ub3RTY2FuIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgPC9hPlx0ICAgICAgICAgIDxhIGhyZWY9IiMiIGRhdGEtdHlwZT0icmVmcmVzaC1xcmNvZGUiIGRhdGEtc2U9InJlZnJlc2gtcXJjb2RlIiBjbGFzcz0ibGluayByZWZyZXNoLXFyY29kZSI+XHQgICAgICAgICAgICB7e2kxOG4gY29kZT0iZW5yb2xsLnRvdHAucmVmcmVzaEJhcmNvZGUiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgICAgICA8L2E+XHQgICAgICA8L2Rpdj5cdCAgICAnLGV2ZW50czp7J2NsaWNrIFtkYXRhLXR5cGU9Im1hbnVhbC1zZXR1cCJdJzpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIGU9aS5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIiksIm1hbnVhbCIpO3RoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsZSl9LCdjbGljayBbZGF0YS10eXBlPSJyZWZyZXNoLXFyY29kZSJdJzpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5tb2RlbC50cmlnZ2VyKCJlcnJvcnM6Y2xlYXIiKTt2YXIgZT10aGlzO3RoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hcHBTdGF0ZS5nZXQoImlzV2FpdGluZ0ZvckFjdGl2YXRpb24iKT90LnBvbGwoKTp0LmFjdGl2YXRlKCl9KS50aGVuKGZ1bmN0aW9uKHQpe3ZhciBpPXQuZGF0YTsiTUZBX0VOUk9MTF9BQ1RJVkFURSI9PT1pLnN0YXR1cyYmIldBSVRJTkciPT09aS5mYWN0b3JSZXN1bHQmJm4uZGVmZXIobi5iaW5kKGUucmVuZGVyLGUpKX0pfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5vcHRpb25zLmFwcFN0YXRlLCJjaGFuZ2U6bGFzdEF1dGhSZXNwb25zZSIsZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUVucm9sbEFjdGl2YXRlIik/dGhpcy4kZWwudG9nZ2xlQ2xhc3MoInFyY29kZS1leHBpcmVkIiwhdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNXYWl0aW5nRm9yQWN0aXZhdGlvbiIpKTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc1N1Y2Nlc3NSZXNwb25zZSIpJiZ0aGlzLiRlbC5hZGRDbGFzcygicXJjb2RlLXN1Y2Nlc3MiKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IiLGZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpJiZ0aGlzLiRlbC50b2dnbGVDbGFzcygicXJjb2RlLWV4cGlyZWQiLCEwKX0pfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgaSxuPWUuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gaT0iR09PR0xFIj09PXRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKT90LmxvYygiZW5yb2xsLnRvdHAuc2V0dXBHb29nbGVBdXRoQXBwIiwibG9naW4iLFtuXSk6dC5sb2MoImVucm9sbC50b3RwLnNldHVwQXBwIiwibG9naW4iLFtuXSkse2luc3RydWN0aW9uczppLHFyY29kZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJxcmNvZGUiKX19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7CgluPVtpKDMyKSxpKDI5NiksaSgyOTUpLGkoMzQyKSxpKDIxKSxpKDMzNSksaSgxODIpLGkoMzM3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXtmdW5jdGlvbiBhKHQpe3N3aXRjaCh0KXtkZWZhdWx0OmNhc2UgMTpyZXR1cm4idTJmLmVycm9yLm90aGVyIjtjYXNlIDI6Y2FzZSAzOnJldHVybiJ1MmYuZXJyb3IuYmFkUmVxdWVzdCI7Y2FzZSA0OnJldHVybiJ1MmYuZXJyb3IudW5zdXBwb3J0ZWQiO2Nhc2UgNTpyZXR1cm4idTJmLmVycm9yLnRpbWVvdXQifX12YXIgbD10Ll87cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC11MmYiLE1vZGVsOntsb2NhbDp7X19lbnJvbGxlZF9fOiJib29sZWFuIn0sc2F2ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRyaWdnZXIoInJlcXVlc3QiKSx0aGlzLmdldCgiX19lbnJvbGxlZF9fIik/dGhpcy5hY3RpdmF0ZSgpOnRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXt2YXIgZT1sLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6InUyZiIscHJvdmlkZXI6IkZJRE8ifSk7cmV0dXJuIGUuZW5yb2xsKCl9KX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXQoIl9fZW5yb2xsZWRfXyIsITApLHRoaXMudHJpZ2dlcigiZXJyb3JzOmNsZWFyIiksdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpew==", "base64"));
  res.write(new Buffer("dmFyIGk9ZS5mYWN0b3IuYWN0aXZhdGlvbixuPWkuYXBwSWQscz1be3ZlcnNpb246aS52ZXJzaW9uLGNoYWxsZW5nZTppLm5vbmNlfV0sbz10aGlzLGw9ci5kZWZlcigpO3JldHVybiB1MmYucmVnaXN0ZXIobixzLFtdLGZ1bmN0aW9uKGkpe28udHJpZ2dlcigiZXJyb3JzOmNsZWFyIiksaS5lcnJvckNvZGUmJjAhPT1pLmVycm9yQ29kZT9sLnJlamVjdCh7eGhyOntyZXNwb25zZUpTT046e2Vycm9yU3VtbWFyeTp0LmxvYyhhKGkuZXJyb3JDb2RlKSwibG9naW4iKX19fSk6bC5yZXNvbHZlKGUuYWN0aXZhdGUoe3JlZ2lzdHJhdGlvbkRhdGE6aS5yZWdpc3RyYXRpb25EYXRhLHZlcnNpb246aS52ZXJzaW9uLGNoYWxsZW5nZTppLmNoYWxsZW5nZSxjbGllbnREYXRhOmkuY2xpZW50RGF0YX0pKX0pLGwucHJvbWlzZX0pfX0sRm9ybTp7dGl0bGU6bC5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudTJmLnRpdGxlIiwibG9naW4iKSxzYXZlOmwucGFydGlhbCh0LmxvYywiZW5yb2xsLnUyZi5zYXZlIiwibG9naW4iKSxub0NhbmNlbEJ1dHRvbjohMCxoYXNTYXZpbmdTdGF0ZTohMSxhdXRvU2F2ZTohMCxjbGFzc05hbWU6ImVucm9sbC11MmYtZm9ybSIsbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hd2luZG93Lmhhc093blByb3BlcnR5KCJ1MmYiKX0sbW9kZWxFdmVudHM6e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgaT1bXTtpZih3aW5kb3cuaGFzT3duUHJvcGVydHkoInUyZiIpKWkucHVzaChlLlZpZXcoe1ZpZXc6JzxkaXYgY2xhc3M9InUyZi1pbnN0cnVjdGlvbnMiPjxvbD5cdCAgICAgICAgICA8bGk+e3tpMThuIGNvZGU9ImVucm9sbC51MmYuZ2VuZXJhbDEiIGJ1bmRsZT0ibG9naW4ifX08L2xpPlx0ICAgICAgICAgIDxsaT57e3tpMThuIGNvZGU9ImVucm9sbC51MmYuZ2VuZXJhbDIiIGJ1bmRsZT0ibG9naW4ifX19PC9saT5cdCAgICAgICAgICA8bGk+e3tpMThuIGNvZGU9ImVucm9sbC51MmYuZ2VuZXJhbDMiIGJ1bmRsZT0ibG9naW4ifX08L2xpPlx0ICAgICAgICAgIDwvb2w+PC9kaXY+J30pKSxpLnB1c2goZS5WaWV3KHtWaWV3OidcdCAgICAgICAgICA8ZGl2IGNsYXNzPSJ1MmYtZW5yb2xsLXRleHQgaGlkZSI+XHQgICAgICAgICAgICA8cD57e2kxOG4gY29kZT0iZW5yb2xsLnUyZi5pbnN0cnVjdGlvbnMiIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8cD57e2kxOG4gY29kZT0iZW5yb2xsLnUyZi5pbnN0cnVjdGlvbnNCbHVldG9vdGgiIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InUyZi1kZXZpY2VzIiBjbGFzcz0idTJmLWRldmljZXMtaW1hZ2VzIj5cdCAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idTJmLXVzYiI+PC9kaXY+XHQgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InUyZi1ibHVldG9vdGgiPjwvZGl2Plx0ICAgICAgICAgICAgPC9kaXY+XHQgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InUyZi13YWl0aW5nIiBjbGFzcz0ib2t0YS13YWl0aW5nLXNwaW5uZXIiPjwvZGl2Plx0ICAgICAgICAgIDwvZGl2Pid9KSk7ZWxzZXt2YXIgbj0idTJmLmVycm9yLm5vdFN1cHBvcnRlZEJyb3dzZXIiO28uaXNGaXJlZm94KCkmJihuPSJ1MmYuZXJyb3Iubm9GaXJlZm94RXh0ZW5zaW9uIiksaS5wdXNoKGUuVmlldyh7VmlldzpuZXcgcyh7bWVzc2FnZTp0LmxvYyhuLCJsb2dpbiIpfSl9LHtzZWxlY3RvcjoiLm8tZm9ybS1lcnJvci1jb250YWluZXIifSkpfXJldHVybiBpfSxfc3RhcnRFbnJvbGxtZW50OmZ1bmN0aW9uKCl7dGhpcy4kKCIudTJmLWluc3RydWN0aW9ucyIpLmFkZENsYXNzKCJoaWRlIiksdGhpcy4kKCIudTJmLWVucm9sbC10ZXh0IikucmVtb3ZlQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLmhpZGUoKX0sX3N0b3BFbnJvbGxtZW50OmZ1bmN0aW9uKCl7dGhpcy4kKCIudTJmLWluc3RydWN0aW9ucyIpLnJlbW92ZUNsYXNzKCJoaWRlIiksdGhpcy4kKCIudTJmLWVucm9sbC10ZXh0IikuYWRkQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLnNob3coKX19LEZvb3RlcjpuLHRyYXBBdXRoUmVzcG9uc2U6ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUVucm9sbEFjdGl2YXRlIikpcmV0dXJuIHRoaXMubW9kZWwuYWN0aXZhdGUoKSwhMH19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTUpLGkoMjk2KSxpKDI5OSksaSgzNTEpLGkoMzQyKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT10Ll87cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImJhcmNvZGUtdG90cCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e19fZmFjdG9yVHlwZV9fOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuZmFjdG9yVHlwZV0sX19wcm92aWRlcl9fOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMucHJvdmlkZXJdfX19LEZvcm06e3RpdGxlOmZ1bmN0aW9uKCl7dmFyIGk9ZS5nZXRGYWN0b3JMYWJlbCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIikpO3JldHVybiB0LmxvYygiZW5yb2xsLnRvdHAudGl0bGUiLCJsb2dpbiIsW2ldKX0sc3VidGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJtZmEuc2NhbkJhcmNvZGUiLCJsb2dpbiIpLHNhdmU6YS5wYXJ0aWFsKHQubG9jLCJvZm9ybS5uZXh0IiwibG9naW4iKSxub0NhbmNlbEJ1dHRvbjohMCxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6InN0ZXAtc2NhbiJ9LGNsYXNzTmFtZToiYmFyY29kZS1zY2FuIixmb3JtQ2hpbGRyZW46W24uVmlldyh7VmlldzpzfSldfSxGb290ZXI6byxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9ci5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIiksImFjdGl2YXRlIik7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIix0KX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk0KSxpKDI5NSksaSgyOTYpLGkoMjk5KSxpKDM1MSksaSgzNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPTZlMztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiYmFyY29kZS1wdXNoIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntsb2NhbDp7X19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19fX0sRm9ybTp7dGl0bGU6ZnVuY3Rpb24oKXt2YXIgaT1lLmdldEZhY3RvckxhYmVsKHRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKSx0aGlzLm1vZGVsLmdldCgiX19mYWN0b3JUeXBlX18iKSk7cmV0dXJuIHQubG9jKCJlbnJvbGwudG90cC50aXRsZSIsImxvZ2luIixbaV0pfSxzdWJ0aXRsZTphLnBhcnRpYWwodC5sb2MsIm1mYS5zY2FuQmFyY29kZSIsImxvZ2luIiksbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJzdGVwLXNjYW4ifSxjbGFzc05hbWU6ImJhcmNvZGUtc2NhbiIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IgZXJyb3JzOmNsZWFyIixmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKX0pfSxmb3JtQ2hpbGRyZW46W24uVmlldyh7VmlldzpzfSldfSxGb290ZXI6byxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5wb2xsRm9yRW5yb2xsbWVudCgpfSxwb2xsRm9yRW5yb2xsbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucG9sbChsKX0pfSx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpKXJldHVybiEwfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDM1NiksaSgzNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJhY3RpdmF0ZS10b3RwIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntwcm9wczp7ZmFjdG9ySWQ6WyJzdHJpbmciLCEwLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvcklkIildLHBhc3NDb2RlOlsic3RyaW5nIiwhMF19LGxvY2FsOntfX2ZhY3RvclR5cGVfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmZhY3RvclR5cGVdLF9fcHJvdmlkZXJfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLnByb3ZpZGVyXX0sc2F2ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQuYWN0aXZhdGUoe3Bhc3NDb2RlOnRoaXMuZ2V0KCJwYXNzQ29kZSIpfSl9KX19fSxGb3JtOmksRm9vdGVyOm59KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTYpLGkoMzA2KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll8scz17dGl0bGU6ZnVuY3Rpb24oKXt2YXIgaT1lLmdldEZhY3RvckxhYmVsKHRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKSx0aGlzLm1vZGVsLmdldCgiX19mYWN0b3JUeXBlX18iKSk7cmV0dXJuIHQubG9jKCJlbnJvbGwudG90cC50aXRsZSIsImxvZ2luIixbaV0pfSxzdWJ0aXRsZTpyLnBhcnRpYWwodC5sb2MsImVucm9sbC50b3RwLmVudGVyQ29kZSIsImxvZ2luIiksYXV0b1NhdmU6ITAsbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJzdGVwLXNlbmRjb2RlIn0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW2kuSW5wdXQoe25hbWU6InBhc3NDb2RlIixpbnB1dDpuLHR5cGU6Im51bWJlciIscGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuZW50ZXJDb2RlLnBsYWNlaG9sZGVyIiwibG9naW4iKSxwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUudG9vbHRpcCIsImxvZ2luIil9fSksaS5Ub29sYmFyKHtub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnQubG9jKCJvZm9ybS52ZXJpZnkiLCJsb2dpbiIpfSldfX07cmV0dXJuIHN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTQpLGkoMjk1KSxpKDI5NiksaSgyOTkpLGkoMzU4KSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7dmFyIGE9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtbWFudWFsLXRvdHAiLE1vZGVsOmZ1bmN0aW9uKCl7cmV0dXJue2xvY2FsOntzaGFyZWRTZWNyZXQ6WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInNoYXJlZFNlY3JldCIpXSxfX2ZhY3RvclR5cGVfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmZhY3RvclR5cGVdLF9fcHJvdmlkZXJfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLnByb3ZpZGVyXX19fSxGb3JtOnt0aXRsZTpmdW5jdGlvbigpe3ZhciBpPWUuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gdC5sb2MoImVucm9sbC50b3RwLnRpdGxlIiwibG9naW4iLFtpXSl9LHN1YnRpdGxlOmEucGFydGlhbCh0LmxvYywiZW5yb2xsLnRvdHAuY2Fubm90U2NhbkJhcmNvZGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic3RlcC1tYW51YWwtc2V0dXAifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5WaWV3KHtWaWV3OidcdCAgICAgICAgICAgIDxwIGNsYXNzPSJva3RhLWZvcm0tc3VidGl0bGUgby1mb3JtLWV4cGxhaW4gdGV4dC1hbGlnbi1jIj5cdCAgICAgICAgICAgICAge3tpMThuIGNvZGU9ImVucm9sbC50b3RwLm1hbnVhbFNldHVwSW5zdHJ1Y3Rpb25zIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgICA8L3A+XHQgICAgICAgICAgJ30pLG4uSW5wdXQoe25hbWU6InNoYXJlZFNlY3JldCIsaW5wdXQ6byx0eXBlOiJ0ZXh0IixkaXNhYmxlZDohMH0pLG4uVG9vbGJhcih7bm9DYW5jZWxCdXR0b246ITAsc2F2ZTp0LmxvYygib2Zvcm0ubmV4dCIsImxvZ2luIil9KV19fSxGb290ZXI6cyxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9ci5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIiksImFjdGl2YXRlIik7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIix0KX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk5KSxpKDMwMSldLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuYmFja1RvRmFjdG9ycyIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgaGVscCBnb3RvIGpzLWdvdG8iIGRhdGEtc2U9ImdvdG8tbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuc2NhbkJhcmNvZGUiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5qcy1iYWNrIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9LCJjbGljayAuanMtZ290byI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMubW9kZWwuc3RhcnRUcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC50eC5yZXN1bWUoKX0pfX0sYmFjazpmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJuYXZpZ2F0ZURpciIsaS5ESVJFQ1RJT05fQkFDSyksdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicHJldkxpbmsiKT90aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldigpfSk6dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwic2lnbmluL2Vucm9sbCIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzYwKSxpKDM2MiksaSgzNjMpLGkoMzY0KSxpKDE5MCksaSgyOTcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuSGFuZGxlYmFycy5jb21waWxlLGw9dC5fLGM9dC4kLHU9dC5WaWV3LmV4dGVuZCh7dGVtcGxhdGU6J1x0ICAgICAgPGEgaHJlZj0iIyIgZGF0YS1zZT0ibmVlZGhlbHAiIGNsYXNzPSJsaW5rIGhlbHAganMtaGVscCI+XHQgICAgICB7e2kxOG4gY29kZT0ibmVlZGhlbHAiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAgIDx1bCBjbGFzcz0iaGVscC1saW5rcyBqcy1oZWxwLWxpbmtzIj5cdCAgICAgICAgPGxpPlx0ICAgICAgICA8YSBocmVmPSIjIiBkYXRhLXNlPSJmb3Jnb3QtcGFzc3dvcmQiIGNsYXNzPSJsaW5rIGpzLWZvcmdvdC1wYXNzd29yZCI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJmb3Jnb3RwYXNzd29yZCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgICA8L2E+XHQgICAgICAgIDwvbGk+XHQgICAgICAgIHt7I2lmIGZlYXR1cmVzLnNlbGZTZXJ2aWNlVW5sb2NrfX1cdCAgICAgICAgICA8bGk+XHQgICAgICAgICAgPGEgaHJlZj0iIyIgZGF0YS1zZT0idW5sb2NrIiBjbGFzcz0ibGluayBqcy11bmxvY2siPlx0ICAgICAgICAgIHt7aTE4biBjb2RlPSJ1bmxvY2thY2NvdW50IiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgPC9hPlx0ICAgICAgICAgIDwvbGk+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgICAge3sjZWFjaCBoZWxwTGlua3MuY3VzdG9tfX1cdCAgICAgICAgICA8bGk+XHQgICAgICAgICAgPGEgaHJlZj0ie3tocmVmfX0iIGNsYXNzPSJsaW5rIGpzLWN1c3RvbSI+e3t0ZXh0fX08L2E+PC9saT5cdCAgICAgICAge3svZWFjaH19XHQgICAgICAgIDxsaT5cdCAgICAgICAgPGEgaHJlZj0ie3toZWxwTGlua1VybH19IiBkYXRhLXNlPSJoZWxwLWxpbmsiIGNsYXNzPSJsaW5rIGpzLWhlbHAtbGluayIgdGFyZ2V0PSJfYmxhbmsiPlx0ICAgICAgICB7e2kxOG4gY29kZT0iaGVscCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgICA8L2E+XHQgICAgICAgIDwvbGk+XHQgICAgICA8L3VsPlx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY2hhbmdlOmVuYWJsZWQiLGZ1bmN0aW9uKHQsZSl7dGhpcy4kKCI6bGluayIpLnRvZ2dsZUNsYXNzKCJvLWZvcm0tZGlzYWJsZWQiLCFlKX0pfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMuc2V0dGluZ3MuZ2V0KCJoZWxwTGlua3MuaGVscCIpO3JldHVybiB0PWU/ZTphKCJ7e2Jhc2VVcmx9fS9oZWxwL2xvZ2luIikoe2Jhc2VVcmw6dGhpcy5zZXR0aW5ncy5nZXQoImJhc2VVcmwiKX0pLGwuZXh0ZW5kKHRoaXMuc2V0dGluZ3MudG9KU09OKHt2ZXJib3NlOiEwfSkse2hlbHBMaW5rVXJsOnR9KX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJCgiLmpzLWhlbHAtbGlua3MiKS5oaWRlKCl9LHRvZ2dsZUxpbmtzOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLiQoIi5qcy1oZWxwLWxpbmtzIikuc2xpZGVUb2dnbGUoMjAwKX0sZXZlbnRzOnsiY2xpY2sgLmpzLWhlbHAiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLmdldCgiZW5hYmxlZCIpJiZ0aGlzLnRvZ2dsZUxpbmtzKHQpfSwiY2xpY2sgLmpzLWZvcmdvdC1wYXNzd29yZCI6ZnVuY3Rpb24odCl7aWYodC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuc3RhdGUuZ2V0KCJlbmFibGVkIikpe3ZhciBlPXRoaXMuc2V0dGluZ3MuZ2V0KCJoZWxwTGlua3MuZm9yZ290UGFzc3dvcmQiKTtlP3MucmVkaXJlY3QoZSk6dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwic2lnbmluL2ZvcmdvdC1wYXNzd29yZCIpfX0sImNsaWNrIC5qcy11bmxvY2siOmZ1bmN0aW9uKHQpe2lmKHQucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLmdldCgiZW5hYmxlZCIpKXt2YXIgZT10aGlzLnNldHRpbmdzLmdldCgiaGVscExpbmtzLnVubG9jayIpO2U/cy5yZWRpcmVjdChlKTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCJzaWduaW4vdW5sb2NrIil9fX19KTtyZXR1cm4gby5leHRlbmQoe2NsYXNzTmFtZToicHJpbWFyeS1hdXRoIixzdGF0ZTp7ZW5hYmxlZDohMH0sVmlldzplLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKHQpe3ZhciBlO3QuYXBwU3RhdGUudW5zZXQoInVzZXJuYW1lIiksdGhpcy5tb2RlbD1uZXcgcih7bXVsdGlPcHRpb25hbEZhY3RvckVucm9sbDp0LnNldHRpbmdzLmdldCgiZmVhdHVyZXMubXVsdGlPcHRpb25hbEZhY3RvckVucm9sbCIpLHNldHRpbmdzOnQuc2V0dGluZ3MsYXBwU3RhdGU6dC5hcHBTdGF0ZX0se3BhcnNlOiEwfSksby5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5hZGRMaXN0ZW5lcnMoKSx0LnNldHRpbmdzLmdldCgiaGFzQ29uZmlndXJlZEJ1dHRvbnMiKSYmdGhpcy5hZGQoaSx7cHJlcGVuZDp0LnNldHRpbmdzLmdldCgic29jaWFsQXV0aFBvc2l0aW9uVG9wIil9KSx0aGlzLmFkZChuZXcgdSh0aGlzLnRvSlNPTih7YXBwU3RhdGU6dC5hcHBTdGF0ZX0pKSksdC5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnJlZ2lzdHJhdGlvbiIpJiZ0aGlzLmFkZChuZXcgbih7c2V0dGluZ3M6dGhpcy5zZXR0aW5ncyxhcHBTdGF0ZTp0LmFwcFN0YXRlfSkpLGU9dGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIiksZSYmdGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgidXNlcm5hbWUiLGUpfSxldmVudHM6eyJmb2N1c291dCBpbnB1dFtuYW1lPXVzZXJuYW1lXSI6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUuc2V0KCJ1c2VybmFtZSIsdGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIikpfSwiZm9jdXNpbiBpbnB1dCI6ZnVuY3Rpb24odCl7Yyh0LnRhcmdldC5wYXJlbnRFbGVtZW50KS5hZGRDbGFzcygiZm9jdXNlZC1pbnB1dCIpfSwiZm9jdXNvdXQgaW5wdXQiOmZ1bmN0aW9uKHQpe2ModC50YXJnZXQucGFyZW50RWxlbWVudCkucmVtb3ZlQ2xhc3MoImZvY3VzZWQtaW5wdXQiKX19LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTp1c2VybmFtZSIsZnVuY3Rpb24odCxlKXtlfHx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuc2V0KCJ1c2VybmFtZSIsIiIpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJzYXZlIixmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJlbmFibGVkIiwhMSl9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImVycm9yIixmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJlbmFibGVkIiwhMCl9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMwNiksaSgzNjEpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll87cmV0dXJuIHQuRm9ybS5leHRlbmQoe2NsYXNzTmFtZToicHJpbWFyeS1hdXRoLWZvcm0iLG5vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6bi5wYXJ0aWFsKHQubG9jLCJwcmltYXJ5YXV0aC5zdWJtaXQiLCJsb2dpbiIpLHNhdmVJZDoib2t0YS1zaWduaW4tc3VibWl0IixsYXlvdXQ6Im8tZm9ybS10aGVtZSIsdGl0bGU6ZnVuY3Rpb24oKXt2YXIgZT10LmxvYygicHJpbWFyeWF1dGgudGl0bGUiLCJsb2dpbiIpO3JldHVybiB0aGlzLnNldHRpbmdzLmdldCgic29jaWFsQXV0aFBvc2l0aW9uVG9wIikmJihlPSIiKSxlfSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT17dXNlcm5hbWU6dGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIikscGFzc3dvcmQ6dGhpcy5tb2RlbC5nZXQoInBhc3N3b3JkIil9O3RoaXMuc2V0dGluZ3MucHJvY2Vzc0NyZWRzKGUpLnRoZW4oZnVuY3Rpb24oKXtpZih0LnNldHRpbmdzLmdldCgiZmVhdHVyZXMuZGV2aWNlRmluZ2VycHJpbnRpbmciKSlyZXR1cm4gaS5nZW5lcmF0ZURldmljZUZpbmdlcnByaW50KHQuc2V0dGluZ3MuZ2V0KCJiYXNlVXJsIiksdC4kZWwpLnRoZW4oZnVuY3Rpb24oZSl7dC5tb2RlbC5zZXQoImRldmljZUZpbmdlcnByaW50IixlKX0pLmZhaWwoZnVuY3Rpb24oKXt9KX0pLnRoZW4obi5iaW5kKHRoaXMubW9kZWwuc2F2ZSx0aGlzLm1vZGVsKSl9KSx0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZTplbmFibGVkIixmdW5jdGlvbih0LGUpe2U/dGhpcy5lbmFibGUoKTp0aGlzLmRpc2FibGUoKX0pfSxpbnB1dHM6ZnVuY3Rpb24oKXt2YXIgaT1be2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnQubG9jKCJwcmltYXJ5YXV0aC51c2VybmFtZS5wbGFjZWhvbGRlciIsImxvZ2luIiksbmFtZToidXNlcm5hbWUiLGlucHV0OmUsaW5wdXRJZDoib2t0YS1zaWduaW4tdXNlcm5hbWUiLHR5cGU6InRleHQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnt0aXRsZTp0LmxvYygicHJpbWFyeWF1dGgudXNlcm5hbWUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLHRleHQ6dC5sb2MoInByaW1hcnlhdXRoLnVzZXJuYW1lLnRvb2x0aXAiLCJsb2dpbiIpfSxpY29uOiJwZXJzb24tMTYtZ3JheSJ9fSx7bGFiZWw6ITEsImxhYmVsLXRvcCI6ITAscGxhY2Vob2xkZXI6dC5sb2MoInByaW1hcnlhdXRoLnBhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJwYXNzd29yZCIsaW5wdXQ6ZSxpbnB1dElkOiJva3RhLXNpZ25pbi1wYXNzd29yZCIsdHlwZToicGFzc3dvcmQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnt0aXRsZTp0LmxvYygicHJpbWFyeWF1dGgucGFzc3dvcmQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLHRleHQ6dC5sb2MoInByaW1hcnlhdXRoLnBhc3N3b3JkLnRvb2x0aXAiLCJsb2dpbiIpfSxpY29uOiJyZW1vdGUtbG9jay0xNiJ9fV07cmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5yZW1lbWJlck1lIikmJmkucHVzaCh7bGFiZWw6ITEscGxhY2Vob2xkZXI6dC5sb2MoInJlbWVtYmVyIiwibG9naW4iKSxuYW1lOiJyZW1lbWJlciIsdHlwZToiY2hlY2tib3giLCJsYWJlbC10b3AiOiEwLGNsYXNzTmFtZToibWFyZ2luLWJ0bS0wIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6cmVtZW1iZXIiLGZ1bmN0aW9uKHQsZSl7dGhpcy4kKCI6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIixlKS50cmlnZ2VyKCJ1cGRhdGVTdGF0ZSIpfSl9fSksaX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLmdldCgidXNlcm5hbWUiKT90aGlzLmdldElucHV0cygpLnRvQXJyYXkoKVsxXS5mb2N1cygpOnRoaXMuZ2V0SW5wdXRzKCkuZmlyc3QoKS5mb2N1cygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMjEpLGkoNSldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm57Z2VuZXJhdGVEZXZpY2VGaW5nZXJwcmludDpmdW5jdGlvbihpLG4pe2Z1bmN0aW9uIHIoKXtjLm9mZigpLGMucmVtb3ZlKCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLG8sITEpfWZ1bmN0aW9uIHModCl7cigpLGwucmVqZWN0KHQpfWZ1bmN0aW9uIG8odCl7aWYoIXR8fCF0LmRhdGF8fHQub3JpZ2luIT1pKXJldHVybiB2b2lkIHMoIm5vIGRhdGEiKTt0cnl7dmFyIGU9SlNPTi5wYXJzZSh0LmRhdGEpO2UmJiJGaW5nZXJwcmludFNlcnZpY2VSZWFkeSI9PT1lLnR5cGU/YSh7dHlwZToiR2V0RmluZ2VycHJpbnQifSk6ZSYmIkZpbmdlcnByaW50QXZhaWxhYmxlIj09PWUudHlwZT8ocigpLGwucmVzb2x2ZShlLmZpbmdlcnByaW50KSk6cygibm8gZGF0YSIpfWNhdGNoKG4pe319ZnVuY3Rpb24gYSh0KXt2YXIgZT1jWzBdLmNvbnRlbnRXaW5kb3c7ZSYmZS5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeSh0KSxpKX12YXIgbD10LmRlZmVyKCksYz1lKCI8aWZyYW1lPiIse3N0eWxlOiJkaXNwbGF5OiBub25lOyJ9KTtyZXR1cm4gYy5hcHBlbmRUbyhuKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsbywhMSksYy5hdHRyKCJzcmMiLGkrIi9hdXRoL3NlcnZpY2VzL2RldmljZWZpbmdlcnByaW50IiksbC5wcm9taXNlfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9dC5fLGk9dC50cGwoJzxkaXYgY2xhc3M9ImF1dGgtZGl2aWRlciI+XHQgICAgICA8c3BhbiBjbGFzcz0iYXV0aC1kaXZpZGVyLXRleHQiPnt7dGV4dH19PC9zcGFuPlx0ICAgIDwvZGl2PicpLG49dC50cGwoJzxoMiBkYXRhLXNlPSJvLWZvcm0taGVhZCIgY2xhc3M9Im9rdGEtZm9ybS10aXRsZSBvLWZvcm0taGVhZCI+e3t0aXRsZX19PC9oMj4nKTtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJwcmltYXJ5LWF1dGgtY29udGFpbmVyIixjaGlsZHJlbjpmdW5jdGlvbigpe3ZhciByPVtdLHM9dGhpcy5zZXR0aW5ncy5nZXQoImNvbmZpZ3VyZWRCdXR0b25zIiksbz1pKHt0ZXh0OnQubG9jKCJzb2NpYWxhdXRoLmRpdmlkZXIudGV4dCIsImxvZ2luIil9KTtyZXR1cm4gZS5lYWNoKHMsZnVuY3Rpb24odCl7ci5wdXNoKHRoaXMuX2NyZWF0ZUJ1dHRvbih0KSl9LHRoaXMpLHRoaXMuc2V0dGluZ3MuZ2V0KCJzb2NpYWxBdXRoUG9zaXRpb25Ub3AiKT8oci51bnNoaWZ0KG4oe3RpdGxlOnQubG9jKCJwcmltYXJ5YXV0aC50aXRsZSIsImxvZ2luIil9KSksci5wdXNoKG8pKTpyLnVuc2hpZnQobykscn0sX2NyZWF0ZUJ1dHRvbjpmdW5jdGlvbihlKXtyZXR1cm4gdC5jcmVhdGVCdXR0b24oe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjplLmRhdGFBdHRyfSxjbGFzc05hbWU6ZS5jbGFzc05hbWUsdGl0bGU6ZS50aXRsZSxjbGljazplLmNsaWNrfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudCI+XHQgICAgICAgICAgPHNwYW4gY2xhc3M9InJlZ2lzdHJhdGlvbi1sYWJlbCI+e3tsYWJlbH19PC9zcGFuPlx0ICAgICAgICAgIDxhIHRpdGxlPSJ7e3RleHR9fSIgYXJpYS1sYWJlbD0ie3t0ZXh0fX0iIGNsYXNzPSJyZWdpc3RyYXRpb24tbGluayIgaHJlZj0iIyI+e3t0ZXh0fX08L2E+XHQgICAgICAgIDwvZGl2Plx0ICAgICAgICAnLGNsYXNzTmFtZToicmVnaXN0cmF0aW9uLWNvbnRhaW5lciIsZXZlbnRzOnsiY2xpY2sgYS5yZWdpc3RyYXRpb24tbGluayI6ImhhbmRsZUNsaWNrRXZlbnQifSxoYW5kbGVDbGlja0V2ZW50OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5zZXR0aW5ncy5nZXQoInJlZ2lzdHJhdGlvbi5jbGljayIpO3JldHVybiB0JiZ0KCksITF9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBlPXtsYWJlbDp0LmxvYygicmVnaXN0cmF0aW9uLnNpZ251cC5sYWJlbCIsImxvZ2luIiksdGV4dDp0LmxvYygicmVnaXN0cmF0aW9uLnNpZ251cC50ZXh0IiwibG9naW4iKX07cmV0dXJuIGV9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTgpLGkoMzI0KSxpKDMwMSldLHI9ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dC5fO3JldHVybiBlLmV4dGVuZCh7cHJvcHM6ZnVuY3Rpb24oKXt2YXIgZSxuPXRoaXMuc2V0dGluZ3MmJnRoaXMuc2V0dGluZ3MuZ2V0KCJ1c2VybmFtZSIpLHM9aS5nZXRDb29raWVVc2VybmFtZSgpLG89ITE7cmV0dXJuIG4/KGU9bixvPWU9PT1zKTpzJiYoZT1zLG89ITApLHt1c2VybmFtZTp7dHlwZToic3RyaW5nIix2YWxpZGF0ZTpmdW5jdGlvbihlKXtpZihyLmlzRW1wdHkoZSkpcmV0dXJuIHQubG9jKCJlcnJvci51c2VybmFtZS5yZXF1aXJlZCIsImxvZ2luIil9LHZhbHVlOmV9LGxhc3RVc2VybmFtZTpbInN0cmluZyIsITEsc10scGFzc3dvcmQ6e3R5cGU6InN0cmluZyIsdmFsaWRhdGU6ZnVuY3Rpb24oZSl7aWYoci5pc0VtcHR5KGUpKXJldHVybiB0LmxvYygiZXJyb3IucGFzc3dvcmQucmVxdWlyZWQiLCJsb2dpbiIpfX0sY29udGV4dDpbIm9iamVjdCIsITFdLHJlbWVtYmVyOlsiYm9vbGVhbiIsITAsb10sbXVsdGlPcHRpb25hbEZhY3RvckVucm9sbDpbImJvb2xlYW4iLCEwXX19LGxvY2FsOntkZXZpY2VGaW5nZXJwcmludDpbInN0cmluZyIsITFdfSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihlKXt0aGlzLnNldHRpbmdzPWUmJmUuc2V0dGluZ3MsdGhpcy5hcHBTdGF0ZT1lJiZlLmFwcFN0YXRlLHQuTW9kZWwuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGlzdGVuVG8odGhpcywiY2hhbmdlOnVzZXJuYW1lIixmdW5jdGlvbih0LGUpe3RoaXMuc2V0KHtyZW1lbWJlcjplPT09dGhpcy5nZXQoImxhc3RVc2VybmFtZSIpfSl9KX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHIub21pdCh0LFsic2V0dGluZ3MiLCJhcHBTdGF0ZSJdKX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuc2V0dGluZ3MudHJhbnNmb3JtVXNlcm5hbWUodGhpcy5nZXQoInVzZXJuYW1lIiksbi5QUklNQVJZX0FVVEgpLGU9dGhpcy5nZXQoInBhc3N3b3JkIikscz10aGlzLmdldCgicmVtZW1iZXIiKSxvPXRoaXMuZ2V0KCJsYXN0VXNlcm5hbWUiKSxhPXRoaXMuZ2V0KCJtdWx0aU9wdGlvbmFsRmFjdG9yRW5yb2xsIiksbD10aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuZGV2aWNlRmluZ2VycHJpbnRpbmciKTtzfHxvIT09dD9zJiZpLnNldFVzZXJuYW1lQ29va2llKHQpOmkucmVtb3ZlVXNlcm5hbWVDb29raWUoKSx0aGlzLnRyaWdnZXIoInNhdmUiKSx0aGlzLmFwcFN0YXRlLnRyaWdnZXIoImxvYWRpbmciLCEwKTt2YXIgYyx1PXt1c2VybmFtZTp0LHBhc3N3b3JkOmUsb3B0aW9uczp7d2FybkJlZm9yZVBhc3N3b3JkRXhwaXJlZDohMCxtdWx0aU9wdGlvbmFsRmFjdG9yRW5yb2xsOmF9fTtyZXR1cm4gYz10aGlzLmFwcFN0YXRlLmdldCgiaXNVbmF1dGhlbnRpY2F0ZWQiKT90aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hcHBTdGF0ZS5zZXR0aW5ncy5hdXRoQ2xpZW50O3JldHVybiB0aGlzLmRvUHJpbWFyeUF1dGgoZSxsLHUsdC5hdXRoZW50aWNhdGUpfSk6dGhpcy5zdGFydFRyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRvUHJpbWFyeUF1dGgodCxsLHUsci5iaW5kKHQuc2lnbkluLHQpKX0pLGMuZmFpbChyLmJpbmQoZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoImVycm9yIiksdGhpcy5hcHBTdGF0ZS50cmlnZ2VyKCJyZW1vdmVMb2FkaW5nIiksaS5yZW1vdmVVc2VybmFtZUNvb2tpZSgpfSx0aGlzKSkuZmluKHIuYmluZChmdW5jdGlvbigpe3RoaXMuYXBwU3RhdGUudHJpZ2dlcigibG9hZGluZyIsITEpfSx0aGlzKSl9LGRvUHJpbWFyeUF1dGg6ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIGUmJih0Lm9wdGlvbnMuaGVhZGVyc1siWC1EZXZpY2UtRmluZ2VycHJpbnQiXT10aGlzLmdldCgiZGV2aWNlRmluZ2VycHJpbnQiKSksbihpKS5maW4oZnVuY3Rpb24oKXtlJiZkZWxldGUgdC5vcHRpb25zLmhlYWRlcnNbIlgtRGV2aWNlLUZpbmdlcnByaW50Il19KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5MiksaSgyOTUpLGkoMjk2KSxpKDI5OSldLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz10Ll8sbz02ZTMsYT10LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJvZm9ybS5iYWNrIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICA8L2E+XHQgICAgJyxjbGFzc05hbWU6ImF1dGgtZm9vdGVyIixldmVudHM6eyJjbGljayAuanMtYmFjayI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuYmFjaygpfX0sYmFjazpmdW5jdGlvbigpe3ZhciB0PXIuY3JlYXRlQWN0aXZhdGVGYWN0b3JVcmwodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9yUHJvdmlkZXIiKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JUeXBlIiksIm1hbnVhbCIpO3RoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsdCl9fSksbD17dGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudG90cC5lbnJvbGxWaWFFbWFpbC50aXRsZSIsImxvZ2luIiksbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJzZW50LWVtYWlsLWFjdGl2YXRpb24tbGluayJ9LGZvcm1DaGlsZHJlbjpbbi5WaWV3KHtWaWV3OnQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgICAgICAgIDxwPnt7aTE4biBjb2RlPSJlbnJvbGwudG90cC5lbnJvbGxWaWFFbWFpbC5tc2ciIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8cCBjbGFzcz0iZW1haWwtYWRkcmVzcyI+e3tlbWFpbH19PC9wPlx0ICAgICAgICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2VtYWlsOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJFbWFpbCIpfX19KX0pXX0sYz17dGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudG90cC5lbnJvbGxWaWFTbXMudGl0bGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic2VudC1zbXMtYWN0aXZhdGlvbi1saW5rIn0sZm9ybUNoaWxkcmVuOltuLlZpZXcoe1ZpZXc6dC5WaWV3LmV4dGVuZCh7dGVtcGxhdGU6J1x0ICAgICAgICAgICAgPHA+e3tpMThuIGNvZGU9ImVucm9sbC50b3RwLmVucm9sbFZpYVNtcy5tc2ciIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8cCBjbGFzcz0icGhvbmUtbnVtYmVyIj57e3Bob25lTnVtYmVyfX08L3A+XHQgICAgICAgICAgJyxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm57cGhvbmVOdW1iZXI6dGhpcy5tb2RlbC5nZXQoImZ1bGxQaG9uZU51bWJlciIpfX19KX0pXX07cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC1hY3RpdmF0aW9uLWxpbmstc2VudCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e2NvdW50cnlDb2RlOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VyQ291bnRyeUNvZGUiKV0scGhvbmVOdW1iZXI6WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJQaG9uZU51bWJlciIpXSxfX2ZhY3RvclR5cGVfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmZhY3RvclR5cGVdLF9fcHJvdmlkZXJfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLnByb3ZpZGVyXX0sZGVyaXZlZDp7Y291bnRyeUNhbGxpbmdDb2RlOntkZXBzOlsiY291bnRyeUNvZGUiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4iKyIrZS5nZXRDYWxsaW5nQ29kZUZvckNvdW50cnkodCl9fSxmdWxsUGhvbmVOdW1iZXI6e2RlcHM6WyJjb3VudHJ5Q2FsbGluZ0NvZGUiLCJwaG9uZU51bWJlciJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZX19fX19LEZvcm06ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpO3N3aXRjaCh0KXtjYXNlIlNNUyI6cmV0dXJuIGM7Y2FzZSJFTUFJTCI6cmV0dXJuIGw7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gYWN0aXZhdGlvbiBvcHRpb246ICIrdCl9fSxGb290ZXI6YSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5wb2xsRm9yRW5yb2xsbWVudCgpfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gaS5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scG9sbEZvckVucm9sbG1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnBvbGwobyl9KX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzV2FpdGluZ0ZvckFjdGl2YXRpb24iKSlyZXR1cm4gdGhpcy5wb2xsRm9yRW5yb2xsbWVudCgpLCEwfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDI5OSksaSgzNTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAganMtYmFjayIgZGF0YS1zZT0iYmFjay1saW5rIj5cdCAgICAgICAge3tpMThuIGNvZGU9Im9mb3JtLmJhY2siIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5qcy1iYWNrIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9fSxiYWNrOmZ1bmN0aW9uKCl7dmFyIHQ9aS5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JQcm92aWRlciIpLCJwdXNoIiwibWFudWFsIik7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIix0KX19KTtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiYWN0aXZhdGUtcHVzaCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57cHJvcHM6e2ZhY3RvcklkOlsic3RyaW5nIiwhMCx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JJZCIpXSxwYXNzQ29kZTpbInN0cmluZyIsITBdfSxsb2NhbDp7X19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LmFjdGl2YXRlKHtwYXNzQ29kZTp0aGlzLmdldCgicGFzc0NvZGUiKX0pfSl9fX0sRm9ybTpuLEZvb3RlcjpyfSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMzAxKSxpKDI5NiksaSgzNjgpLGkoMjk0KSxpKDM2OSksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7dmFyIGw9dC5fO3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJwYXNzd29yZC1leHBpcmVkIixNb2RlbDp7cHJvcHM6e29sZFBhc3N3b3JkOlsic3RyaW5nIiwhMF0sbmV3UGFzc3dvcmQ6WyJzdHJpbmciLCEwXSxjb25maXJtUGFzc3dvcmQ6WyJzdHJpbmciLCEwXX0sdmFsaWRhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gci52YWxpZGF0ZVBhc3N3b3JkTWF0Y2godGhpcyl9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LmNoYW5nZVBhc3N3b3JkKHtvbGRQYXNzd29yZDp0aGlzLmdldCgib2xkUGFzc3dvcmQiKSxuZXdQYXNzd29yZDp0aGlzLmdldCgibmV3UGFzc3dvcmQiKX0pfSl9fSxGb3JtOntzYXZlOmwucGFydGlhbCh0LmxvYywicGFzc3dvcmQuZXhwaXJlZC5zdWJtaXQiLCJsb2dpbiIpLHRpdGxlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNQd2RFeHBpcmluZ1Nvb24iKSxpPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInBhc3N3b3JkRXhwaXJlRGF5cyIpO3JldHVybiBlJiZpPjA/dC5sb2MoInBhc3N3b3JkLmV4cGlyaW5nLnRpdGxlIiwibG9naW4iLFtpXSk6ZSYmMD09PWk/dC5sb2MoInBhc3N3b3JkLmV4cGlyaW5nLnRvZGF5IiwibG9naW4iKTp0LmxvYygicGFzc3dvcmQuZXhwaXJlZC50aXRsZSIsImxvZ2luIil9LHN1YnRpdGxlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNQd2RFeHBpcmluZ1Nvb24iKSlyZXR1cm4gdC5sb2MoInBhc3N3b3JkLmV4cGlyaW5nLnN1YnRpdGxlIiwibG9naW4iKTt2YXIgZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJwb2xpY3kiKTtpZihlKXJldHVybiBzLmdldFBhc3N3b3JkQ29tcGxleGl0eURlc2NyaXB0aW9uKGUpfSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5JbnB1dCh7ImxhYmVsLXRvcCI6ITAsbGFiZWw6ITEscGxhY2Vob2xkZXI6dC5sb2MoInBhc3N3b3JkLm9sZFBhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJvbGRQYXNzd29yZCIsaW5wdXQ6YSx0eXBlOiJwYXNzd29yZCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoInBhc3N3b3JkLm9sZFBhc3N3b3JkLnRvb2x0aXAiLCJsb2dpbiIpLGljb246ImNyZWRlbnRpYWxzLTE2In19KSxuLkRpdmlkZXIoKSxuLklucHV0KHsibGFiZWwtdG9wIjohMCxsYWJlbDohMSxwbGFjZWhvbGRlcjp0LmxvYygicGFzc3dvcmQubmV3UGFzc3dvcmQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6Im5ld1Bhc3N3b3JkIixpbnB1dDphLHR5cGU6InBhc3N3b3JkIixwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygicGFzc3dvcmQubmV3UGFzc3dvcmQudG9vbHRpcCIsImxvZ2luIiksaWNvbjoiY3JlZGVudGlhbHMtMTYifX0pLG4uSW5wdXQoeyJsYWJlbC10b3AiOiEwLGxhYmVsOiExLHBsYWNlaG9sZGVyOnQubG9jKCJwYXNzd29yZC5jb25maXJtUGFzc3dvcmQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6ImNvbmZpcm1QYXNzd29yZCIsaW5wdXQ6YSx0eXBlOiJwYXNzd29yZCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoInBhc3N3b3JkLmNvbmZpcm1QYXNzd29yZC50b29sdGlwIiwibG9naW4iKSxpY29uOiJjcmVkZW50aWFscy0xNiJ9fSldfX0sRm9vdGVyOm8saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5mb3JtLCJzYXZlIixmdW5jdGlvbigpe3ZhciB0PXt1c2VybmFtZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VyRW1haWwiKSxwYXNzd29yZDp0aGlzLm1vZGVsLmdldCgibmV3UGFzc3dvcmQiKX07dGhpcy5zZXR0aW5ncy5wcm9jZXNzQ3JlZHModCkudGhlbihsLmJpbmQodGhpcy5tb2RlbC5zYXZlLHRoaXMubW9kZWwpKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXt9O3JldHVybiBlLnZhbGlkYXRlVXNlcm5hbWU9ZnVuY3Rpb24oZSl7dmFyIGk9ZS5nZXQoInVzZXJuYW1lIik7aWYoaSYmaS5sZW5ndGg+MjU2KXJldHVybnt1c2VybmFtZTp0LmxvYygibW9kZWwudmFsaWRhdGlvbi5maWVsZC51c2VybmFtZSIsImxvZ2luIil9fSxlLnZhbGlkYXRlUGFzc3dvcmRNYXRjaD1mdW5jdGlvbihlKXtpZihlLmdldCgibmV3UGFzc3dvcmQiKSE9PWUuZ2V0KCJjb25maXJtUGFzc3dvcmQiKSlyZXR1cm57Y29uZmlybVBhc3N3b3JkOnQubG9jKCJwYXNzd29yZC5lcnJvci5tYXRjaCIsImxvZ2luIil9fSxlfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDE5MCldLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICB7eyNpZiBwYXNzd29yZFdhcm59fVx0ICAgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLXNraXAiIGRhdGEtc2U9InNraXAtbGluayI+XHQgICAgICAgICAge3tpMThuIGNvZGU9InBhc3N3b3JkLmV4cGlyaW5nLmxhdGVyIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgIDwvYT5cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAgZ290byBqcy1zaWdub3V0IiBkYXRhLXNlPSJzaWdub3V0LWxpbmsiPnt7aTE4biBjb2RlPSJzaWdub3V0IiBidW5kbGU9ImxvZ2luIn19PC9hPlx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciBjbGVhcmZpeCIsZXZlbnRzOnsiY2xpY2sgLmpzLXNpZ25vdXQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKTt2YXIgbj10aGlzO3RoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5jYW5jZWwoKX0pLnRoZW4oZnVuY3Rpb24oKXtuLnNldHRpbmdzLmdldCgic2lnbk91dExpbmsiKT9pLnJlZGlyZWN0KG4uc2V0dGluZ3MuZ2V0KCJzaWduT3V0TGluayIpKToobi5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSxuLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKSl9KX0sImNsaWNrIC5qcy1za2lwIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnNraXAoKX0pfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue3Bhc3N3b3JkV2Fybjp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc1B3ZEV4cGlyaW5nU29vbiIpfX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTYpLGkoMzY5KSxpKDE5MCldLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImN1c3RvbS1wYXNzd29yZC1leHBpcmVkIixNb2RlbDp7fSxGb3JtOntub0J1dHRvbkJhcjohMCx0aXRsZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzUHdkRXhwaXJpbmdTb29uIiksaT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJwYXNzd29yZEV4cGlyZURheXMiKTtyZXR1cm4gZSYmaT4wP3QubG9jKCJwYXNzd29yZC5leHBpcmluZy50aXRsZSIsImxvZ2luIixbaV0pOmUmJjA9PT1pP3QubG9jKCJwYXNzd29yZC5leHBpcmluZy50b2RheSIsImxvZ2luIik6dC5sb2MoInBhc3N3b3JkLmV4cGlyZWQudGl0bGUiLCJsb2dpbiIpfSxzdWJ0aXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc1B3ZEV4cGlyaW5nU29vbiIpP3QubG9jKCJwYXNzd29yZC5leHBpcmluZy5zdWJ0aXRsZSIsImxvZ2luIikrIiAiK3QubG9jKCJwYXNzd29yZC5leHBpcmVkLmN1c3RvbS5zdWJ0aXRsZSIsImxvZ2luIik6dC5sb2MoInBhc3N3b3JkLmV4cGlyZWQuY3VzdG9tLnN1YnRpdGxlIiwibG9naW4iKX0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW2kuQnV0dG9uKHt0aXRsZTpzLnBhcnRpYWwodC5sb2MsInBhc3N3b3JkLmV4cGlyZWQuY3VzdG9tLnN1Ym1pdCIsImxvZ2luIixbdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicGFzc3dvcmRFeHBpcmVkV2Vic2l0ZU5hbWUiKV0pLGNsYXNzTmFtZToiYnV0dG9uIGJ1dHRvbi1wcmltYXJ5IGJ1dHRvbi13aWRlIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImN1c3RvbS1idXR0b24ifSxjbGljazpmdW5jdGlvbigpe3IucmVkaXJlY3QodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicGFzc3dvcmRFeHBpcmVkTGlua1VybCIpKX19KV19fSxGb290ZXI6bn0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDMwMSksaSgyOTYpLGkoMzY4KSxpKDM3MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAganMtYmFjayIgZGF0YS1zZT0iYmFjay1saW5rIj5cdCAgICAgICAge3tpMThuIGNvZGU9ImdvYmFjayIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3sjaWYgaGVscFN1cHBvcnROdW1iZXJ9fVx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgZ290byBqcy1jb250YWN0LXN1cHBvcnQiPlx0ICAgICAgICB7e2kxOG4gY29kZT0ibWZhLm5vQWNjZXNzVG9FbWFpbCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3svaWZ9fVx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsZXZlbnRzOnsiY2xpY2sgLmpzLWJhY2siOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmJhY2soKX0sImNsaWNrIC5qcy1jb250YWN0LXN1cHBvcnQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLnRyaWdnZXIoImNvbnRhY3RTdXBwb3J0IiksdGhpcy4kKCIuanMtY29udGFjdC1zdXBwb3J0IikuaGlkZSgpfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MucGljaygiaGVscFN1cHBvcnROdW1iZXIiKX0sYmFjazpmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJuYXZpZ2F0ZURpciIsaS5ESVJFQ1RJT05fQkFDSyksdGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwiIil9fSk7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImZvcmdvdC1wYXNzd29yZCIsTW9kZWw6e3Byb3BzOnt1c2VybmFtZTpbInN0cmluZyIsITBdLGZhY3RvclR5cGU6WyJzdHJpbmciLCEwLGkuUkVDT1ZFUllfRkFDVE9SX1RZUEVfRU1BSUxdfSx2YWxpZGF0ZTpmdW5jdGlvbigpe3JldHVybiByLnZhbGlkYXRlVXNlcm5hbWUodGhpcyl9LHNhdmU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3RoaXMuc3RhcnRUcmFuc2FjdGlvbihmdW5jdGlvbihlKXtyZXR1cm4gZS5mb3Jnb3RQYXNzd29yZCh7dXNlcm5hbWU6dC5zZXR0aW5ncy50cmFuc2Zvcm1Vc2VybmFtZSh0LmdldCgidXNlcm5hbWUiKSxpLkZPUkdPVF9QQVNTV09SRCksZmFjdG9yVHlwZTp0LmdldCgiZmFjdG9yVHlwZSIpfSl9KS5mYWlsKGZ1bmN0aW9uKCl7dC5zZXQoImZhY3RvclR5cGUiLGkuUkVDT1ZFUllfRkFDVE9SX1RZUEVfRU1BSUwpfSl9fSxGb3JtOnthdXRvU2F2ZTohMCxzYXZlOmEucGFydGlhbCh0LmxvYywicGFzc3dvcmQuZm9yZ290LnNlbmRFbWFpbCIsImxvZ2luIiksdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJwYXNzd29yZC5yZXNldCIsImxvZ2luIiksZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIGU9W24uSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJwYXNzd29yZC5mb3Jnb3QuZW1haWwub3IudXNlcm5hbWUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6InVzZXJuYW1lIixpbnB1dDpvLHR5cGU6InRleHQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJwYXNzd29yZC5mb3Jnb3QuZW1haWwub3IudXNlcm5hbWUudG9vbHRpcCIsImxvZ2luIiksaWNvbjoicGVyc29uLTE2LWdyYXkifX0pXSxpPXRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5zbXNSZWNvdmVyeSIpLHI9dGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLmNhbGxSZWNvdmVyeSIpO3JldHVybihpfHxyKSYmZS5wdXNoKG4uVmlldyh7Vmlldzp0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICAgICAgICAgICAgPHAgY2xhc3M9Im1vYmlsZS1yZWNvdmVyeS1oaW50Ij5cdCAgICAgICAgICAgICAgICAgIHt7aTE4biBjb2RlPSJyZWNvdmVyeS5tb2JpbGUuaGludCIgYnVuZGxlPSJsb2dpbiIgYXJndW1lbnRzPSJtb2JpbGVGYWN0b3JzIn19XHQgICAgICAgICAgICAgICAgPC9wPicsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIGU9aSYmcj90LmxvYygicmVjb3Zlcnkuc21zT3JDYWxsIik6cj90LmxvYygicmVjb3ZlcnkuY2FsbCIpOnQubG9jKCJyZWNvdmVyeS5zbXMiKSx7bW9iaWxlRmFjdG9yczplfX19KX0pKSxlfSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuY2FsbFJlY292ZXJ5IikmJih0aGlzLiRlbC5hZGRDbGFzcygiZm9yZ290LXBhc3N3b3JkLWNhbGwtZW5hYmxlZCIpLHRoaXMuYWRkUmVjb3ZlcnlGYWN0b3JCdXR0b24oImNhbGwtYnV0dG9uIiwicGFzc3dvcmQuZm9yZ290LmNhbGwiLGkuUkVDT1ZFUllfRkFDVE9SX1RZUEVfQ0FMTCx0KSksdGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnNtc1JlY292ZXJ5IikmJih0aGlzLiRlbC5hZGRDbGFzcygiZm9yZ290LXBhc3N3b3JkLXNtcy1lbmFibGVkIiksdGhpcy5hZGRSZWNvdmVyeUZhY3RvckJ1dHRvbigic21zLWJ1dHRvbiIsInBhc3N3b3JkLmZvcmdvdC5zZW5kVGV4dCIsaS5SRUNPVkVSWV9GQUNUT1JfVFlQRV9TTVMsdCkpLHRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY29udGFjdFN1cHBvcnQiLGZ1bmN0aW9uKCl7dGhpcy5hZGQocywiLm8tZm9ybS1lcnJvci1jb250YWluZXIiKX0pLHRoaXMubGlzdGVuVG8odGhpcywic2F2ZSIsZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUuc2V0KCJ1c2VybmFtZSIsdGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIikpfSl9LGFkZFJlY292ZXJ5RmFjdG9yQnV0dG9uOmZ1bmN0aW9uKGUsaSxuLHIpe3RoaXMuYWRkQnV0dG9uKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ZX0sdHlwZToiYnV0dG9uIixjbGFzc05hbWU6ImJ1dHRvbi1wcmltYXJ5ICIrZSx0ZXh0OnQubG9jKGksImxvZ2luIiksYWN0aW9uOmZ1bmN0aW9uKCl7ci5jbGVhckVycm9ycygpLHRoaXMubW9kZWwuaXNWYWxpZCgpJiYodGhpcy5tb2RlbC5zZXQoImZhY3RvclR5cGUiLG4pLHIudHJpZ2dlcigic2F2ZSIsdGhpcy5tb2RlbCkpfX0se3ByZXBlbmQ6ITB9KX19LEZvb3RlcjpsLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUudW5zZXQoInVzZXJuYW1lIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9ImluZm9ib3giPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiBpbmZvLTE2Ij48L3NwYW4+XHQgICAgICAgIDxwPnt7aTE4biBjb2RlPSJjb250YWN0LnN1cHBvcnQiIGJ1bmRsZT0ibG9naW4iIGFyZ3VtZW50cz0iaGVscFN1cHBvcnROdW1iZXIifX08L3A+XHQgICAgICA8L2Rpdj4nLGNsYXNzTmFtZToiY29udGFjdC1zdXBwb3J0IixnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXR0aW5ncy5waWNrKCJoZWxwU3VwcG9ydE51bWJlciIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDI5NiksaSgzMDEpLGkoMzIwKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe3ZhciBvPXQuXyxhPTNlNDtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToicmVjb3ZlcnktY2hhbGxlbmdlIixNb2RlbDp7cHJvcHM6e3Bhc3NDb2RlOlsic3RyaW5nIiwhMF19LGxvY2FsOnthYmxlVG9SZXNlbmQ6ImJvb2xlYW4ifSxyZXNlbmRDb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGltaXRSZXNlbmRpbmcoKSx0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucmVzZW5kKCl9KX0sbGltaXRSZXNlbmRpbmc6ZnVuY3Rpb24oKXt0aGlzLnNldCh7YWJsZVRvUmVzZW5kOiExfSksby5kZWxheShvLmJpbmQodGhpcy5zZXQsdGhpcyksYSx7YWJsZVRvUmVzZW5kOiEwfSl9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnZlcmlmeSh7cGFzc0NvZGU6dGhpcy5nZXQoInBhc3NDb2RlIil9KX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsc2F2ZTpvLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSx0aXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JUeXBlIik9PT1uLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0NBTEw/dC5sb2MoInJlY292ZXJ5Q2hhbGxlbmdlLmNhbGwudGl0bGUiLCJsb2dpbiIpOnQubG9jKCJyZWNvdmVyeUNoYWxsZW5nZS5zbXMudGl0bGUiLCJsb2dpbiIpfSxjbGFzc05hbWU6InJlY292ZXJ5LWNoYWxsZW5nZSIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IiLGZ1bmN0aW9uKCl7dGhpcy5jbGVhckVycm9ycygpfSl9LGZvcm1DaGlsZHJlbjpmdW5jdGlvbigpe3JldHVybltpLkJ1dHRvbih7dGl0bGU6dC5sb2MoIm1mYS5yZXNlbmRDb2RlIiwibG9naW4iKSxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6InJlc2VuZC1idXR0b24ifSxjbGFzc05hbWU6ImJ1dHRvbiBzbXMtcmVxdWVzdC1idXR0b24iLGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC5yZXNlbmRDb2RlKCl9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTphYmxlVG9SZXNlbmQiLGZ1bmN0aW9uKGUsaSl7aT8odGhpcy5vcHRpb25zLnRpdGxlPXQubG9jKCJtZmEucmVzZW5kQ29kZSIsImxvZ2luIiksdGhpcy5lbmFibGUoKSx0aGlzLnJlbmRlcigpKToodGhpcy5vcHRpb25zLnRpdGxlPXQubG9jKCJtZmEuc2VudCIsImxvZ2luIiksdGhpcy5kaXNhYmxlKCksdGhpcy5yZW5kZXIoKSl9KX19KSxpLklucHV0KHtwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiZW5yb2xsLXNtcy1waG9uZSIsbmFtZToicGFzc0NvZGUiLGlucHV0OnMsdHlwZToidGV4dCJ9KV19fSxldmVudHM6eyJjbGljayAuc2VuZC1lbWFpbC1saW5rIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIGU9dGhpcy5tb2RlbC5zZXR0aW5ncyxpPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJuYW1lIikscj10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKTt0aGlzLm1vZGVsLnN0YXJ0VHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7c3dpdGNoKHIpe2Nhc2Ugbi5SRUNPVkVSWV9UWVBFX1BBU1NXT1JEOnJldHVybiB0LmZvcmdvdFBhc3N3b3JkKHt1c2VybmFtZTplLnRyYW5zZm9ybVVzZXJuYW1lKGksbi5GT1JHT1RfUEFTU1dPUkQpLGZhY3RvclR5cGU6bi5SRUNPVkVSWV9GQUNUT1JfVFlQRV9FTUFJTH0pO2Nhc2Ugbi5SRUNPVkVSWV9UWVBFX1VOTE9DSzpyZXR1cm4gdC51bmxvY2tBY2NvdW50KHt1c2VybmFtZTplLnRyYW5zZm9ybVVzZXJuYW1lKGksbi5VTkxPQ0tfQUNDT1VOVCksZmFjdG9yVHlwZTpuLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0VNQUlMfSk7ZGVmYXVsdDpyZXR1cm59fSl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIGUsaT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKTtzd2l0Y2goaSl7Y2FzZSBuLlJFQ09WRVJZX1RZUEVfUEFTU1dPUkQ6ZT0nXHQgICAgICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9Imxpbmsgc2VuZC1lbWFpbC1saW5rIiBkYXRhLXNlPSJzZW5kLWVtYWlsLWxpbmsiPlx0ICAgICAgICAgICAge3tpMThuIGNvZGU9InBhc3N3b3JkLmZvcmdvdC5jb2RlLm5vdFJlY2VpdmVkIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgPC9hPic7YnJlYWs7Y2FzZSBuLlJFQ09WRVJZX1RZUEVfVU5MT0NLOmU9J1x0ICAgICAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIHNlbmQtZW1haWwtbGluayIgZGF0YS1zZT0ic2VuZC1lbWFpbC1saW5rIj5cdCAgICAgICAgICAgIHt7aTE4biBjb2RlPSJhY2NvdW50LnVubG9jay5zbXMubm90UmVjZWl2ZWQiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgICAgICA8L2E+J31lJiZ0aGlzLmFkZChlKSwKCXRoaXMuYWRkKG5ldyByKG8uZXh0ZW5kKHRoaXMudG9KU09OKCkse2xpbmtUZXh0OnQubG9jKCJnb2JhY2siLCJsb2dpbiIpLGxpbmtDbGFzc05hbWU6IiJ9KSkpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC5saW1pdFJlc2VuZGluZygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDI5NSksaSgyOTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuXztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToicGFzc3dvcmQtcmVzZXQtZW1haWwtc2VudCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e3VzZXJGdWxsTmFtZTpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckZ1bGxOYW1lIildfX19LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywicGFzc3dvcmQuZm9yZ290LmVtYWlsU2VudC50aXRsZSIsImxvZ2luIiksc3VidGl0bGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VybmFtZSIpO3JldHVybiB0LmxvYygicGFzc3dvcmQuZm9yZ290LmVtYWlsU2VudC5kZXNjIiwibG9naW4iLFtlXSl9LG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoicHdkLXJlc2V0LWVtYWlsLXNlbnQifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5WaWV3KHtWaWV3OnQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImFjY2Vzc2liaWxpdHktdGV4dCIgcm9sZT0ic3RhdHVzIj57e2FsZXJ0fX08L3NwYW4+XHQgICAgICAgICAgICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2FsZXJ0OnQubG9jKCJwYXNzd29yZC5mb3Jnb3QuZW1haWxTZW50LnRpdGxlIiwibG9naW4iKX19fSl9KSxuLkJ1dHRvbih7dGl0bGU6dC5sb2MoImdvYmFjayIsImxvZ2luIiksY2xhc3NOYW1lOiJidXR0b24gYnV0dG9uLXByaW1hcnkgYnV0dG9uLXdpZGUiLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiYmFjay1idXR0b24ifSxjbGljazpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5jYW5jZWwoKX0pLnRoZW4oZnVuY3Rpb24oKXt0LnN0YXRlLnNldCgibmF2aWdhdGVEaXIiLGUuRElSRUNUSU9OX0JBQ0spLHQub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsIiIpfSl9fSldfX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLnNldHRpbmdzLmNhbGxHbG9iYWxTdWNjZXNzKGUuRk9SR09UX1BBU1NXT1JEX0VNQUlMX1NFTlQse3VzZXJuYW1lOnQuYXBwU3RhdGUuZ2V0KCJ1c2VybmFtZSIpfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMjk2KSxpKDMyMCksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6InJlY292ZXJ5LXF1ZXN0aW9uIixNb2RlbDp7cHJvcHM6e2Fuc3dlcjpbInN0cmluZyIsITBdLHNob3dBbnN3ZXI6ImJvb2xlYW4ifSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5hbnN3ZXIoe2Fuc3dlcjp0aGlzLmdldCgiYW5zd2VyIil9KX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsc2F2ZTpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKSl7Y2FzZSJQQVNTV09SRCI6cmV0dXJuIHQubG9jKCJwYXNzd29yZC5mb3Jnb3QucXVlc3Rpb24uc3VibWl0IiwibG9naW4iKTtjYXNlIlVOTE9DSyI6cmV0dXJuIHQubG9jKCJhY2NvdW50LnVubG9jay5xdWVzdGlvbi5zdWJtaXQiLCJsb2dpbiIpO2RlZmF1bHQ6cmV0dXJuIHQubG9jKCJtZmEuY2hhbGxlbmdlLnZlcmlmeSIsImxvZ2luIil9fSx0aXRsZTpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKSl7Y2FzZSJQQVNTV09SRCI6cmV0dXJuIHQubG9jKCJwYXNzd29yZC5mb3Jnb3QucXVlc3Rpb24udGl0bGUiLCJsb2dpbiIpO2Nhc2UiVU5MT0NLIjpyZXR1cm4gdC5sb2MoImFjY291bnQudW5sb2NrLnF1ZXN0aW9uLnRpdGxlIiwibG9naW4iKTtkZWZhdWx0OnJldHVybiIifX0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW2kuSW5wdXQoe2xhYmVsOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlY292ZXJ5UXVlc3Rpb24iKSxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5hbnN3ZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6ImFuc3dlciIsaW5wdXQ6cix0eXBlOiJwYXNzd29yZCIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOnNob3dBbnN3ZXIiLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tb2RlbC5nZXQoInNob3dBbnN3ZXIiKT8idGV4dCI6InBhc3N3b3JkIjt0aGlzLmdldElucHV0cygpWzBdLmNoYW5nZVR5cGUodCl9KX19KSxpLklucHV0KHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5hbnN3ZXIuc2hvd0Fuc3dlciIsImxvZ2luIiksY2xhc3NOYW1lOiJyZWNvdmVyeS1xdWVzdGlvbi1zaG93IG1hcmdpbi1idG0tMCIsbmFtZToic2hvd0Fuc3dlciIsdHlwZToiY2hlY2tib3gifSldfX0sRm9vdGVyOm59KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTYpLGkoMzY4KSxpKDI5NCksaSgzMjApLGkoMzA2KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6InBhc3N3b3JkLXJlc2V0IixNb2RlbDp7cHJvcHM6e25ld1Bhc3N3b3JkOlsic3RyaW5nIiwhMF0sY29uZmlybVBhc3N3b3JkOlsic3RyaW5nIiwhMF19LHZhbGlkYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIG4udmFsaWRhdGVQYXNzd29yZE1hdGNoKHRoaXMpfSxzYXZlOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJzYXZlIik7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3JldHVybiBlLnJlc2V0UGFzc3dvcmQoe25ld1Bhc3N3b3JkOnQuZ2V0KCJuZXdQYXNzd29yZCIpfSl9KX19LEZvcm06e3NhdmU6YS5wYXJ0aWFsKHQubG9jLCJwYXNzd29yZC5yZXNldCIsImxvZ2luIiksdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJwYXNzd29yZC5yZXNldC50aXRsZSIsImxvZ2luIiksc3VidGl0bGU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJwb2xpY3kiKTtpZih0KXJldHVybiByLmdldFBhc3N3b3JkQ29tcGxleGl0eURlc2NyaXB0aW9uKHQpfSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5baS5JbnB1dCh7cGxhY2Vob2xkZXI6dC5sb2MoInBhc3N3b3JkLm5ld1Bhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJuZXdQYXNzd29yZCIsaW5wdXQ6byx0eXBlOiJwYXNzd29yZCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoInBhc3N3b3JkLm5ld1Bhc3N3b3JkLnRvb2x0aXAiLCJsb2dpbiIpLGljb246ImNyZWRlbnRpYWxzLTE2In19KSxpLklucHV0KHtwbGFjZWhvbGRlcjp0LmxvYygicGFzc3dvcmQuY29uZmlybVBhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJjb25maXJtUGFzc3dvcmQiLGlucHV0Om8sdHlwZToicGFzc3dvcmQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJwYXNzd29yZC5jb25maXJtUGFzc3dvcmQudG9vbHRpcCIsImxvZ2luIiksaWNvbjoiY3JlZGVudGlhbHMtMTYifX0pXX19LEZvb3RlcjpzLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMuZm9ybSwic2F2ZSIsZnVuY3Rpb24oKXt2YXIgdD17dXNlcm5hbWU6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckVtYWlsIikscGFzc3dvcmQ6dGhpcy5tb2RlbC5nZXQoIm5ld1Bhc3N3b3JkIil9O3RoaXMuc2V0dGluZ3MucHJvY2Vzc0NyZWRzKHQpLnRoZW4oYS5iaW5kKHRoaXMubW9kZWwuc2F2ZSx0aGlzLm1vZGVsKSl9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToicmVjb3ZlcnktbG9hZGluZyIsTW9kZWw6e30sRm9ybTp7bm9CdXR0b25CYXI6ITB9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5tb2RlbC5zdGFydFRyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3JldHVybiBlLnZlcmlmeVJlY292ZXJ5VG9rZW4oe3JlY292ZXJ5VG9rZW46dC50b2tlbn0pfSkuZmFpbChmdW5jdGlvbigpe2Uub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJsb2FkaW5nIiwhMSl9KX0scHJlUmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoImxvYWRpbmciLCEwKX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibG9hZGluZyIsITEpLCExfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDMwMSksaSgyOTYpLGkoMzY4KSxpKDM3MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAganMtYmFjayIgZGF0YS1zZT0iYmFjay1saW5rIj5cdCAgICAgICAge3tpMThuIGNvZGU9ImdvYmFjayIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3sjaWYgaGVscFN1cHBvcnROdW1iZXJ9fVx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgZ290byBqcy1jb250YWN0LXN1cHBvcnQiPlx0ICAgICAgICB7e2kxOG4gY29kZT0ibWZhLm5vQWNjZXNzVG9FbWFpbCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3svaWZ9fVx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsZXZlbnRzOnsiY2xpY2sgLmpzLWJhY2siOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmJhY2soKX0sImNsaWNrIC5qcy1jb250YWN0LXN1cHBvcnQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLnRyaWdnZXIoImNvbnRhY3RTdXBwb3J0IiksdGhpcy4kKCIuanMtY29udGFjdC1zdXBwb3J0IikuaGlkZSgpfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MucGljaygiaGVscFN1cHBvcnROdW1iZXIiKX0sYmFjazpmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJuYXZpZ2F0ZURpciIsaS5ESVJFQ1RJT05fQkFDSyksdGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwiIil9fSk7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImFjY291bnQtdW5sb2NrIixNb2RlbDp7cHJvcHM6e3VzZXJuYW1lOlsic3RyaW5nIiwhMF0sZmFjdG9yVHlwZTpbInN0cmluZyIsITAsaS5SRUNPVkVSWV9GQUNUT1JfVFlQRV9FTUFJTF19LHZhbGlkYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHIudmFsaWRhdGVVc2VybmFtZSh0aGlzKX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMuc3RhcnRUcmFuc2FjdGlvbihmdW5jdGlvbihlKXtyZXR1cm4gZS51bmxvY2tBY2NvdW50KHt1c2VybmFtZTp0LnNldHRpbmdzLnRyYW5zZm9ybVVzZXJuYW1lKHQuZ2V0KCJ1c2VybmFtZSIpLGkuVU5MT0NLX0FDQ09VTlQpLGZhY3RvclR5cGU6dC5nZXQoImZhY3RvclR5cGUiKX0pfSkuZmFpbChmdW5jdGlvbigpe3Quc2V0KCJmYWN0b3JUeXBlIixpLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0VNQUlMKX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsc2F2ZTphLnBhcnRpYWwodC5sb2MsImFjY291bnQudW5sb2NrLnNlbmRFbWFpbCIsImxvZ2luIiksdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJhY2NvdW50LnVubG9jay50aXRsZSIsImxvZ2luIiksZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIGU9W24uSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJhY2NvdW50LnVubG9jay5lbWFpbC5vci51c2VybmFtZS5wbGFjZWhvbGRlciIsImxvZ2luIiksbmFtZToidXNlcm5hbWUiLGlucHV0Om8sdHlwZToidGV4dCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoImFjY291bnQudW5sb2NrLmVtYWlsLm9yLnVzZXJuYW1lLnRvb2x0aXAiLCJsb2dpbiIpLGljb246InBlcnNvbi0xNi1ncmF5In19KV07cmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5zbXNSZWNvdmVyeSIpJiZlLnB1c2gobi5WaWV3KHtWaWV3OidcdCAgICAgICAgICAgIDxwIGNsYXNzPSJzbXMtaGludCI+XHQgICAgICAgICAgICAgIHt7aTE4biBjb2RlPSJyZWNvdmVyeS5zbXMuaGludCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgICAgICAgPC9wPlx0ICAgICAgICAgICd9KSksZX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hcHBTdGF0ZS5zZXQoInVzZXJuYW1lIix0aGlzLm1vZGVsLmdldCgidXNlcm5hbWUiKSl9KSx0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuc21zUmVjb3ZlcnkiKSYmKHRoaXMuJGVsLmFkZENsYXNzKCJmb3Jnb3QtcGFzc3dvcmQtc21zLWVuYWJsZWQiKSx0aGlzLmFkZEJ1dHRvbih7YXR0cmlidXRlczp7ImRhdGEtc2UiOiJzbXMtYnV0dG9uIn0sdHlwZToiYnV0dG9uIixjbGFzc05hbWU6ImJ1dHRvbi1wcmltYXJ5IHNtcy1idXR0b24iLHRleHQ6dC5sb2MoImFjY291bnQudW5sb2NrLnNlbmRUZXh0IiwibG9naW4iKSxhY3Rpb246ZnVuY3Rpb24oKXtlLmNsZWFyRXJyb3JzKCksdGhpcy5tb2RlbC5pc1ZhbGlkKCkmJih0aGlzLm1vZGVsLnNldCgiZmFjdG9yVHlwZSIsaS5SRUNPVkVSWV9GQUNUT1JfVFlQRV9TTVMpLGUudHJpZ2dlcigic2F2ZSIsdGhpcy5tb2RlbCkpfX0se3ByZXBlbmQ6ITB9KSksdGhpcy5saXN0ZW5Ubyh0aGlzLnN0YXRlLCJjb250YWN0U3VwcG9ydCIsZnVuY3Rpb24oKXt0aGlzLmFkZChzLCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpfSl9fSxGb290ZXI6bH0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDI5NSksaSgyOTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuXztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiYWNjb3VudC11bmxvY2tlZCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e3VzZXJGdWxsTmFtZTpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckZ1bGxOYW1lIildfX19LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywiYWNjb3VudC51bmxvY2sudW5sb2NrZWQudGl0bGUiLCJsb2dpbiIpLHN1YnRpdGxlOnIucGFydGlhbCh0LmxvYywiYWNjb3VudC51bmxvY2sudW5sb2NrZWQuZGVzYyIsImxvZ2luIiksbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJhY2NvdW50LXVubG9ja2VkIn0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW24uQnV0dG9uKHt0aXRsZTp0LmxvYygiZ29iYWNrIiwibG9naW4iKSxjbGFzc05hbWU6ImJ1dHRvbiBidXR0b24tcHJpbWFyeSBidXR0b24td2lkZSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJiYWNrLWJ1dHRvbiJ9LGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKX19KV19fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDI5NSksaSgyOTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuXztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiYWNjb3VudC11bmxvY2stZW1haWwtc2VudCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e3VzZXJGdWxsTmFtZTpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckZ1bGxOYW1lIildfX19LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywiYWNjb3VudC51bmxvY2suZW1haWxTZW50LnRpdGxlIiwibG9naW4iKSxzdWJ0aXRsZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJuYW1lIik7cmV0dXJuIHQubG9jKCJhY2NvdW50LnVubG9jay5lbWFpbFNlbnQuZGVzYyIsImxvZ2luIixbZV0pfSxub0J1dHRvbkJhcjohMCxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6InVubG9jay1lbWFpbC1zZW50In0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW24uQnV0dG9uKHt0aXRsZTp0LmxvYygiZ29iYWNrIiwibG9naW4iKSxjbGFzc05hbWU6ImJ1dHRvbiBidXR0b24tcHJpbWFyeSBidXR0b24td2lkZSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJiYWNrLWJ1dHRvbiJ9LGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKX19KV19fSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuc2V0dGluZ3MuY2FsbEdsb2JhbFN1Y2Nlc3MoZS5VTkxPQ0tfQUNDT1VOVF9FTUFJTF9TRU5ULHt1c2VybmFtZTp0LmFwcFN0YXRlLmdldCgidXNlcm5hbWUiKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzgyKSxpKDI5NyksaSgzMDEpLGkoMzgzKSxpKDM4NiksaSgzODcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAiIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJnb2JhY2siIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5oZWxwIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9fSxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixuLkRJUkVDVElPTl9CQUNLKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKX19KSxjPXQuRm9ybS5leHRlbmQoe2xheW91dDoiby1mb3JtLXRoZW1lIixhdXRvU2F2ZTohMCxub0NhbmNlbEJ1dHRvbjohMCx0aXRsZTp0LmxvYygicmVnaXN0cmF0aW9uLmZvcm0udGl0bGUiLCJsb2dpbiIpLHNhdmU6dC5sb2MoInJlZ2lzdHJhdGlvbi5mb3JtLnN1Ym1pdCIsImxvZ2luIil9KTtyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToicmVnaXN0cmF0aW9uIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIGk9ZS5leHRlbmQoe3VybDoiYXBpL3YxL3NjaGVtYSJ9KSxuPW5ldyBpKHtzY2hlbWE6e3Byb3BlcnRpZXM6e2ZpcnN0TmFtZTp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiRmlyc3QgTmFtZSIsImRlZmF1bHQiOiJFbnRlciB5b3VyIGZpcnN0IG5hbWUiLG1heExlbmd0aDoyNTV9LGxhc3ROYW1lOnt0eXBlOiJzdHJpbmciLGRlc2NyaXB0aW9uOiJMYXN0IE5hbWUiLCJkZWZhdWx0IjoiRW50ZXIgeW91ciBsYXN0IG5hbWUiLG1heExlbmd0aDoyNTV9LGxvZ2luOnt0eXBlOiJzdHJpbmciLGRlc2NyaXB0aW9uOiJFbWFpbCBBZGRyZXNzIixmb3JtYXQ6ImVtYWlsIiwiZGVmYXVsdCI6IkVudGVyIHlvdXIgZW1haWwiLG1heExlbmd0aDoyNTV9LGFjY291bnRMZXZlbDp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiQWNjb3VudCBMZXZlbCIsImVudW0iOlsiRnJlZSIsIlByZW1pdW0iLCJQbGF0aW51bSJdfSxyZWZlcnJlcjp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiSG93IGRpZCB5b3UgaGVhciBhYm91dCB1cz8iLG1heExlbmd0aDoxMDI0fSxwYXNzd29yZDp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiUGFzc3dvcmQifX0scmVxdWlyZWQ6WyJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImxvZ2luIiwicGFzc3dvcmQiLCJhY2NvdW50TGV2ZWwiXSxmaWVsZE9yZGVyOlsibG9naW4iLCJwYXNzd29yZCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiYWNjb3VudExldmVsIiwicmVmZXJyZXIiXX0scGFzc3dvcmRDb21wbGV4aXR5OnttaW5MZW5ndGg6OCxtaW5Mb3dlckNhc2U6MSxtaW5VcHBlckNhc2U6MSxtaW5OdW1iZXI6MSxtaW5TeW1ib2w6MCxleGNsdWRlVXNlcm5hbWU6ITB9fSx7cGFyc2U6ITB9KSxsPW4ucHJvcGVydGllcyx1PWwuY3JlYXRlTW9kZWxQcm9wZXJ0aWVzKCksZD10Lk1vZGVsLmV4dGVuZCh7c2V0dGluZ3M6dGhpcy5zZXR0aW5ncyxhcHBTdGF0ZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUscHJvcHM6dSxzYXZlOmZ1bmN0aW9uKCl7dGhpcy5hcHBTdGF0ZS5zZXQoInVzZXJuYW1lIix0aGlzLmdldCgiZW1haWwiKSksdGhpcy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsInNpZ25pbi9yZWdpc3Rlci1jb21wbGV0ZSIpfX0pO3RoaXMubW9kZWw9bmV3IGQ7dmFyIGg9ZnVuY3Rpb24oZSxpKXt2YXIgcz1lLmdldCgicGFzc3dvcmQiKXx8IiI7YS5lYWNoKG4ucGFzc3dvcmRDb21wbGV4aXR5LmVuYWJsZWRDb21wbGV4aXRpZXMsZnVuY3Rpb24obil7dmFyIG89dC4kKCIjcGFzc3dvcmQtY29tcGxleGl0eS0iK24pLGE9dGhpcy5nZXQobik7by5yZW1vdmVDbGFzcygicGFzc3dvcmQtY29tcGxleGl0eS1zYXRpc2ZpZWQgcGFzc3dvcmQtY29tcGxleGl0eS11bnNhdGlzZmllZCBwYXNzd29yZC1jb21wbGV4aXR5LWVycm9yIiksci5jb21wbGV4aXRpZXNbbl0uZG9lc0NvbXBsZXhpdHlNZWV0KGEscyxlKT9vLmFkZENsYXNzKCJwYXNzd29yZC1jb21wbGV4aXR5LXNhdGlzZmllZCIpOmk/by5hZGRDbGFzcygicGFzc3dvcmQtY29tcGxleGl0eS1lcnJvciIpOm8uYWRkQ2xhc3MoInBhc3N3b3JkLWNvbXBsZXhpdHktdW5zYXRpc2ZpZWQiKX0sbi5wYXNzd29yZENvbXBsZXhpdHkpfSxwPW5ldyBjKHRoaXMudG9KU09OKCkpO2wuZWFjaChmdW5jdGlvbih0KXt2YXIgZT1zLmNyZWF0ZUlucHV0T3B0aW9ucyh0KSxpPXQuZ2V0KCJuYW1lIik7InBhc3N3b3JkIiE9PWkmJiJsb2dpbiIhPT1pfHwoZS5ldmVudHM9e2lucHV0OmZ1bmN0aW9uKCl7aCh0aGlzLm1vZGVsKX19KSwicGFzc3dvcmQiPT09aSYmKGUuZXZlbnRzLmZvY3Vzb3V0PWZ1bmN0aW9uKCl7aCh0aGlzLm1vZGVsLCEwKX0pLHAuYWRkSW5wdXQoZSl9KSxwLmFkZChvLmV4dGVuZCh7cGFzc3dvcmRDb21wbGV4aXR5Om4ucGFzc3dvcmRDb21wbGV4aXR5fSkpLHRoaXMuYWRkKHApLHRoaXMuZm9vdGVyPW5ldyB0aGlzLkZvb3Rlcih0aGlzLnRvSlNPTigpKSx0aGlzLmFkZCh0aGlzLmZvb3RlciksdGhpcy5hZGRMaXN0ZW5lcnMoKX0sRm9vdGVyOmx9KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDM4MyksaSgzODQpLGkoMzg1KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll8scz10Lk1vZGVsLmV4dGVuZCh7cHJvcHM6ZS5tb2RlbFByb3BzLHBhcnNlOmZ1bmN0aW9uKGkpe3ZhciBuPXQuTW9kZWwucHJvdG90eXBlLnBhcnNlLmFwcGx5KHRoaXMsW2ldKTtyZXR1cm4gdGhpcy5lbmFibGVkQ29tcGxleGl0aWVzPVtdLHIubWFwKG4sZnVuY3Rpb24odCxpKXtlLmNvbXBsZXhpdGllc1tpXS5pc0VuYWJsZWQodCkmJnRoaXMuZW5hYmxlZENvbXBsZXhpdGllcy5wdXNoKGkpfSx0aGlzKSxufX0pLG89bi5Db2xsZWN0aW9uLmV4dGVuZCh7Y3JlYXRlTW9kZWxQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dmFyIHQ9bi5Db2xsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVNb2RlbFByb3BlcnRpZXMuYXBwbHkodGhpcyk7cmV0dXJuIHIuZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dC5yZXF1aXJlZD0hIXRoaXMuZ2V0KGUpLmdldCgicmVxdWlyZWQiKX0sdGhpcyksdH19KTtyZXR1cm4gaS5Nb2RlbC5leHRlbmQoe2V4cGFuZDpbInNjaGVtYSJdLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5wcm9wZXJ0aWVzPW5ldyBvLHQuQmFzZU1vZGVsLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scGFyc2U6ZnVuY3Rpb24odCl7dmFyIGU9aS5Nb2RlbC5wcm90b3R5cGUucGFyc2UuYXBwbHkodGhpcyxbdF0pLG49dC5zY2hlbWEucmVxdWlyZWQ7ci5pc0FycmF5KG4pJiZyLmVhY2gobixmdW5jdGlvbih0KXt2YXIgZT10aGlzLnByb3BlcnRpZXMuZ2V0KHQpO2UmJmUuc2V0KCJyZXF1aXJlZCIsITApfSx0aGlzKTt2YXIgbz10LnNjaGVtYS5maWVsZE9yZGVyO3JldHVybiByLmlzQXJyYXkobykmJihyLmVhY2gobyxmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMucHJvcGVydGllcy5nZXQodCk7aSYmaS5zZXQoInNvcnRPcmRlciIsZSl9LHRoaXMpLHRoaXMucHJvcGVydGllcy5jb21wYXJhdG9yPSJzb3J0T3JkZXIiLHRoaXMucHJvcGVydGllcy5zb3J0KCkpLHIuaXNPYmplY3QodC5wYXNzd29yZENvbXBsZXhpdHkpPyh0aGlzLnBhc3N3b3JkQ29tcGxleGl0eT1uZXcgcyh0LnBhc3N3b3JkQ29tcGxleGl0eSx7cGFyc2U6ITB9KSxlPXIub21pdChlLCJwYXNzd29yZENvbXBsZXhpdHkiKSk6dGhpcy5wYXNzd29yZENvbXBsZXhpdHk9bmV3IHMoe30se3BhcnNlOiEwfSksZX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKV0scj1mdW5jdGlvbih0KXt2YXIgZT10Ll8saT1mdW5jdGlvbih0KXtyZXR1cm4gdD4wfSxuPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pLm1hdGNoKHQpO3JldHVybiBuPW51bGwhPW4/bi5sZW5ndGg6MCxuPj1lfSxyPXttaW5MZW5ndGg6e21vZGVsUHJvcDpbIm51bWJlciIsITEsOF0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUubGVuZ3RoPj10fSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTGVuZ3RoIiwibG9naW4iLFtlXSl9fSxtaW5Mb3dlckNhc2U6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9bYS16XS9nKSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTG93ZXJDYXNlIiwibG9naW4iLFtlXSl9fSxtaW5VcHBlckNhc2U6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9bQS1aXS9nKSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluVXBwZXJDYXNlIiwibG9naW4iLFtlXSl9fSxtaW5OdW1iZXI6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9cZC9nKSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTnVtYmVyIiwibG9naW4iLFtlXSl9fSxtaW5TeW1ib2w6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9bXmEtelx1MDBFMC1cdTAwRkNcZF0vZ2kpLGdldEkxOG5NZXNzYWdlOmZ1bmN0aW9uKGUpe3JldHVybiB0LmxvYygicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5taW5TeW1ib2wiLCJsb2dpbiIsW2VdKX19LGV4Y2x1ZGVVc2VybmFtZTp7bW9kZWxQcm9wOlsiYm9vbGVhbiIsITEsITBdLGlzRW5hYmxlZDpmdW5jdGlvbih0KXtyZXR1cm4hIXR9LGRvZXNDb21wbGV4aXR5TWVldDpmdW5jdGlvbih0LGksbil7aWYoZS5pc0VtcHR5KGkpKXJldHVybiExO3ZhciByPW4uZ2V0KCJsb2dpbiIpO3JldHVybiFlLmlzRW1wdHkocikmJmkuaW5kZXhPZihyKT09PS0xfSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbigpe3JldHVybiB0LmxvYygicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5leGNsdWRlVXNlcm5hbWUiLCJsb2dpbiIpfX19O3JldHVybnttb2RlbFByb3BzOmUubWFwT2JqZWN0KHIsZnVuY3Rpb24odCl7cmV0dXJuIHQubW9kZWxQcm9wfSksY29tcGxleGl0aWVzOnJ9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxMzgpLGkoMzMpLGkoMzg1KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1mdW5jdGlvbihlKXt2YXIgaT10LnBpY2soZSwiaWQiLCJuYW1lIiwiZGlzcGxheU5hbWUiKSxuPXQubWFwKGUuc2NoZW1hLnByb3BlcnRpZXMsZnVuY3Rpb24oZSxpKXtyZXR1cm4gdCh7bmFtZTppfSkuY2hhaW4oKS5leHRlbmQoZSkub21pdCgiX19tZXRhZGF0YSIpLnZhbHVlKCl9KTtyZXR1cm4gdC5lYWNoKG4sZnVuY3Rpb24odCl7dC5fX3NjaGVtYU1ldGFfXz1pfSksbn0scz1lLmV4dGVuZCh7ZGVmYXVsdHM6e2lkOnZvaWQgMCxkaXNwbGF5TmFtZTp2b2lkIDAsbmFtZTp2b2lkIDB9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5wcm9wZXJ0aWVzPW5ldyBuLkNvbGxlY3Rpb24sZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGdldFByb3BlcnRpZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcm9wZXJ0aWVzfSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PWUucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdC5nZXRQcm9wZXJ0aWVzKCkuc2V0KHRoaXMuZ2V0UHJvcGVydGllcygpLnRvSlNPTih7dmVyYm9zZTohMH0pKSx0fSxwYXJzZTpmdW5jdGlvbihlKXt2YXIgaT1yKGUpO3JldHVybiB0aGlzLnByb3BlcnRpZXMuc2V0KGkse3BhcnNlOiEwfSksdC5vbWl0KGUsInNjaGVtYSIpfSx0cmltUHJvcGVydHk6ZnVuY3Rpb24oZSl7cmV0dXJuIHQub21pdChlLCJuYW1lIil9LHRvSlNPTjpmdW5jdGlvbigpe3ZhciB0PWUucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHQuc2NoZW1hPXtwcm9wZXJ0aWVzOnt9fSx0aGlzLmdldFByb3BlcnRpZXMoKS5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBpPWUudG9KU09OKCk7dC5zY2hlbWEucHJvcGVydGllc1tpLm5hbWVdPXRoaXMudHJpbVByb3BlcnR5KGkpfSx0aGlzKSx0fSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0UHJvcGVydGllcygpLmVhY2goZnVuY3Rpb24odCl7dC5jbGVhbnVwKCl9KSxlLnByb3RvdHlwZS5zYXZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KSxvPWkuZXh0ZW5kKHttb2RlbDpzfSk7cmV0dXJue3BhcnNlUHJvcGVydGllczpyLE1vZGVsOnMsQ29sbGVjdGlvbjpvfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMzQpLGkoMTM4KSxpKDE0NCksaSgxNzYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9ci5TVFJJTkcsbz1yLk5VTUJFUixhPXIuSU5URUdFUixsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrIm9mIitlfSxjPWkuZXh0ZW5kKHtjb25zdHJhaW50SGFuZGxlcnM6e2JldHdlZW46Il9jaGVja0JldHdlZW5Db25zdHJhaW50cyIsZ3JlYXRlclRoYW46Il9jaGVja0dyZWF0ZXJUaGFuQ29uc3RyYWludCIsbGVzc1RoYW46Il9jaGVja0xlc3NUaGFuQ29uc3RyYWludCIsZXF1YWxzOiJfY2hlY2tFcXVhbHNDb25zdHJhaW50In0saWRBdHRyaWJ1dGU6Im5hbWUiLGRlZmF1bHRzOntuYW1lOiIiLHRpdGxlOnZvaWQgMCx0eXBlOnZvaWQgMCxkZXNjcmlwdGlvbjp2b2lkIDAscmVxdWlyZWQ6ITEsZm9ybWF0OnZvaWQgMCx1bmlvbjp2b2lkIDAsc2V0dGluZ3M6e3Blcm1pc3Npb25zOntTRUxGOnIuUEVSTUlTU0lPTi5SRUFEX09OTFl9fSxfX2lzU2Vuc2l0aXZlX186aS5Db21wdXRlZFByb3BlcnR5KFsic2V0dGluZ3MiXSxmdW5jdGlvbih0KXtyZXR1cm4hKCF0fHwhdC5zZW5zaXRpdmUpfSksX191c2VyUGVybWlzc2lvbl9fOnIuUEVSTUlTU0lPTi5SRUFEX09OTFksX19kaXNwbGF5VHlwZV9fOnZvaWQgMCxfX2Rpc3BsYXlUeXBlTGFiZWxfXzppLkNvbXB1dGVkUHJvcGVydHkoWyJfX2Rpc3BsYXlUeXBlX18iXSxmdW5jdGlvbih0KXtyZXR1cm4gci5EQVRBVFlQRVt0XXx8dH0pLF9fc3VwcG9ydHNNaW5NYXhfXzohMSxfX2lzUmVhZE9ubHlfXzppLkNvbXB1dGVkUHJvcGVydHkoWyJtdXRhYmlsaXR5Il0sZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT1yLk1VVEFCSUxJVFkuUkVBRE9OTFl9KSxfX2lzV3JpdGVPbmx5X186aS5Db21wdXRlZFByb3BlcnR5KFsibXV0YWJpbGl0eSJdLGZ1bmN0aW9uKHQpe3JldHVybiB0PT09ci5NVVRBQklMSVRZLldSSVRFT05MWX0pLF9fZGlzcGxheVNjb3BlX186dm9pZCAwLF9faXNTY29wZVNlbGZfXzppLkNvbXB1dGVkUHJvcGVydHkoWyJzY29wZSJdLGZ1bmN0aW9uKHQpe3JldHVybiB0PT09ci5TQ09QRS5TRUxGfSksX19pc05vbmVTY29wZUFycmF5VHlwZV9fOmkuQ29tcHV0ZWRQcm9wZXJ0eShbIl9faXNTY29wZVNlbGZfXyIsIl9fZGlzcGxheVR5cGVfXyJdLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIXQmJnIuaXNBcnJheURhdGFUeXBlKGUpfSksX19pc0ltcG9ydGVkX186aS5Db21wdXRlZFByb3BlcnR5KFsiZXh0ZXJuYWxOYW1lIl0sZnVuY3Rpb24odCl7cmV0dXJuISF0fSksX19pc0Zyb21CYXNlU2NoZW1hX186aS5Db21wdXRlZFByb3BlcnR5KFsiX19zY2hlbWFNZXRhX18iXSxmdW5jdGlvbih0KXtyZXR1cm4gdCYmImJhc2UiPT09dC5uYW1lfSl9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXtpLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmxpc3RlblRvKHRoaXMsImNoYW5nZTpfX2Rpc3BsYXlUeXBlX18iLHRoaXMuX3VwZGF0ZVR5cGVGb3JtYXRDb25zdHJhaW50cyksdGhpcy5saXN0ZW5Ubyh0aGlzLCJjaGFuZ2U6dHlwZSBjaGFuZ2U6Zm9ybWF0IGNoYW5nZTppdGVtcyIsdGhpcy5fdXBkYXRlRGlzcGxheVR5cGUpLHRoaXMubGlzdGVuVG8odGhpcywiY2hhbmdlOl9fbWluVmFsX18gY2hhbmdlOl9fbWF4VmFsX18iLHRoaXMuX3VwZGF0ZU1pbk1heCksdGhpcy5saXN0ZW5Ubyh0aGlzLCJjaGFuZ2U6X19lcXVhbHNfXyIsdGhpcy5fY29udmVydEVxdWFsc1RvTWluTWF4KSx0aGlzLmxpc3RlblRvKHRoaXMsImNoYW5nZTpfX2NvbnN0cmFpbnRfXyIsdGhpcy5fc2V0Q29uc3RyYWludFRleHQpLHRoaXMuX3NldENvbnN0cmFpbnRUZXh0KCl9LHBhcnNlOmZ1bmN0aW9uKGUpe3JldHVybiBlPXQuY2xvbmUoZSksIm9iamVjdCI9PT1lLnR5cGUmJiJpbWFnZSI9PT1lLmV4dGVuZGVkVHlwZSYmKGUudHlwZT0iaW1hZ2UiKSxlLl9fZGlzcGxheVR5cGVfXz1yLmdldERpc3BsYXlUeXBlKGUudHlwZSxlLmZvcm1hdCxlLml0ZW1zP2UuaXRlbXMudHlwZTp2b2lkIDApLHRoaXMuX3NldFJhbmdlQ29uc3RyYWludHMoZSksZS5fX3N1cHBvcnRzTWluTWF4X189ci5TVVBQT1JUU01JTk1BWC5pbmRleE9mKGUuX19kaXNwbGF5VHlwZV9fKSE9LTEsZS5fX2Rpc3BsYXlTY29wZV9fPXIuRElTUExBWVNDT1BFW2Uuc2NvcGVdfHxyLkRJU1BMQVlTQ09QRS5OQSxlLnNldHRpbmdzJiZlLnNldHRpbmdzLnBlcm1pc3Npb25zJiZlLnNldHRpbmdzLnBlcm1pc3Npb25zLlNFTEYmJihlLl9fdXNlclBlcm1pc3Npb25fXz1lLnNldHRpbmdzLnBlcm1pc3Npb25zLlNFTEYpLHRoaXMuX3NldE1hc3Rlck92ZXJyaWRlKGUpLGV9LHZhbGlkYXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5nZXQoIl9fc3VwcG9ydHNNaW5NYXhfXyIpJiZ0aGlzLmdldCgiX19jb25zdHJhaW50X18iKSl7dmFyIGU9dGhpcy5nZXQoIl9fY29uc3RyYWludF9fIiksaT10aGlzW3RoaXMuY29uc3RyYWludEhhbmRsZXJzW2VdXTtyZXR1cm4gdC5pc0Z1bmN0aW9uKGkpP2kuY2FsbCh0aGlzKTp2b2lkIG4ud2FybigiTm8gY29uc3RyYWludCBoYW5kbGVyIGZvdW5kIGZvcjogIitlKX19LF9jaGVja0JldHdlZW5Db25zdHJhaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX21pblZhbF9fIiksZT10aGlzLmdldCgiX19tYXhWYWxfXyIpO2lmKHR8fGUpe2lmKCF0KXJldHVybntfX21pblZhbF9fOiJNaW4gdmFsdWUgaXMgcmVxdWlyZWQifTtpZighZSlyZXR1cm57X19tYXhWYWxfXzoiTWF4IHZhbHVlIGlzIHJlcXVpcmVkIn07dmFyIGk9dGhpcy5fY2hlY2tJbnRlZ2VyQ29uc3RyYWludHMoIl9fbWluVmFsX18iLCJNaW4gdmFsdWUiKTtyZXR1cm4gaT9pOihpPXRoaXMuX2NoZWNrSW50ZWdlckNvbnN0cmFpbnRzKCJfX21heFZhbF9fIiwiTWF4IHZhbHVlIiksaT9pOit0Pj0rZT97X19tYXhWYWxfXzoiTWF4IHZhbCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBtaW4gdmFsIn06dm9pZCAwKX19LF9jaGVja0dyZWF0ZXJUaGFuQ29uc3RyYWludDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX21pblZhbF9fIik7aWYodCl7dmFyIGU9dGhpcy5fY2hlY2tJbnRlZ2VyQ29uc3RyYWludHMoIl9fbWluVmFsX18iLCJNaW4gdmFsdWUiKTtyZXR1cm4gZT9lOnZvaWQgMH19LF9jaGVja0xlc3NUaGFuQ29uc3RyYWludDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX21heFZhbF9fIik7aWYodCl7dmFyIGU9dGhpcy5fY2hlY2tJbnRlZ2VyQ29uc3RyYWludHMoIl9fbWF4VmFsX18iLCJNYXggdmFsdWUiKTtyZXR1cm4gZT9lOnZvaWQgMH19LF9jaGVja0VxdWFsc0NvbnN0cmFpbnQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldCgiX19lcXVhbHNfXyIpO2lmKHQpe3ZhciBlPXRoaXMuX2NoZWNrSW50ZWdlckNvbnN0cmFpbnRzKCJfX2VxdWFsc19fIiwiQ29uc3RyYWludCIpO3JldHVybiBlP2U6dm9pZCAwfX0sX2NoZWNrSW50ZWdlckNvbnN0cmFpbnRzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXQodCksbj17fTtyZXR1cm4gaXNOYU4oaSk/KG5bdF09ZSsiIG11c3QgYmUgYSBudW1iZXIiLG4pOitpPDA/KG5bdF09ZSsiIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAiLG4pOnZvaWQgMH0sX3NldE1hc3Rlck92ZXJyaWRlOmZ1bmN0aW9uKGUpe2lmKGUuc2V0dGluZ3MmJmUuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUmJmUuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUpe3ZhciBpPWUuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUudmFsdWU7dC5pc0FycmF5KGkpJiYhdC5pc0VtcHR5KGkpPyhlLl9fbWFzdGVyT3ZlcnJpZGVUeXBlX189Ik9WRVJSSURFIixlLl9fbWFzdGVyT3ZlcnJpZGVWYWx1ZV9fPWl8fFtdKTplLl9fbWFzdGVyT3ZlcnJpZGVUeXBlX189ZS5zZXR0aW5ncy5tYXN0ZXJPdmVycmlkZS50eXBlfWVsc2UgZS5fX21hc3Rlck92ZXJyaWRlVHlwZV9fPSJJTkhFUklUIn0sX3NldFJhbmdlQ29uc3RyYWludHM6ZnVuY3Rpb24odCl7dC5fX2Rpc3BsYXlUeXBlX189PXM/KHQuX19taW5WYWxfXz10Lm1pbkxlbmd0aCx0Ll9fbWF4VmFsX189dC5tYXhMZW5ndGgpOnQuX19kaXNwbGF5VHlwZV9fIT1hJiZ0Ll9fZGlzcGxheVR5cGVfXyE9b3x8KHQuX19taW5WYWxfXz10Lm1pbmltdW0sdC5fX21heFZhbF9fPXQubWF4aW11bSksdC5fX21pblZhbF9fJiZ0Ll9fbWF4VmFsX18/dC5fX21pblZhbF9fPT09dC5fX21heFZhbF9fPyh0Ll9fY29uc3RyYWludF9fPSJlcXVhbHMiLHQuX19lcXVhbHNfXz10Ll9fbWluVmFsX18pOnQuX19jb25zdHJhaW50X189ImJldHdlZW4iOiF0Ll9fbWluVmFsX18mJnQuX19tYXhWYWxfXz90Ll9fY29uc3RyYWludF9fPSJsZXNzVGhhbiI6IXQuX19tYXhWYWxfXyYmdC5fX21pblZhbF9fJiYodC5fX2NvbnN0cmFpbnRfXz0iZ3JlYXRlclRoYW4iKX0sX3VwZGF0ZURpc3BsYXlUeXBlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXQoInR5cGUiKTtpZih0PT09cyYmdGhpcy5nZXQoImZvcm1hdCIpKXRoaXMuc2V0KCJfX2Rpc3BsYXlUeXBlX18iLHIuRk9STUFURElTUExBWVRZUEVbdGhpcy5nZXQoImZvcm1hdCIpXSk7ZWxzZXt2YXIgZT10aGlzLmdldCgiaXRlbXMiKT90aGlzLmdldCgiaXRlbXMiKS50eXBlOnZvaWQgMDt0JiZlP3RoaXMuc2V0KCJfX2Rpc3BsYXlUeXBlX18iLHIuQVJSQVlESVNQTEFZVFlQRVtsKHQsZSldKTp0aGlzLnNldCgiX19kaXNwbGF5VHlwZV9fIix0KX19LHRvSlNPTjpmdW5jdGlvbigpe3ZhciB0PWkucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHQuc2V0dGluZ3M9e3Blcm1pc3Npb25zOnt9fSx0LnNldHRpbmdzLnBlcm1pc3Npb25zLlNFTEY9dGhpcy5nZXQoIl9fdXNlclBlcm1pc3Npb25fXyIpLHRoaXMuZ2V0KCJfX2lzU2Vuc2l0aXZlX18iKSYmKHQuc2V0dGluZ3Muc2Vuc2l0aXZlPXRoaXMuZ2V0KCJfX2lzU2Vuc2l0aXZlX18iKSksImltYWdlIj09PXRoaXMuZ2V0KCJ0eXBlIikmJih0LnR5cGU9Im9iamVjdCIsdC5leHRlbmRlZFR5cGU9ImltYWdlIiksdD10aGlzLl9hdHRyaWJ1dGVPdmVycmlkZVRvSnNvbih0KSx0PXRoaXMuX25vcm1hbGl6ZVVuaW9uVmFsdWUodCl9LF9hdHRyaWJ1dGVPdmVycmlkZVRvSnNvbjpmdW5jdGlvbihpKXt2YXIgbj10aGlzLmdldCgiX19tYXN0ZXJPdmVycmlkZVR5cGVfXyIpLHI9dGhpcy5nZXQoIl9fbWFzdGVyT3ZlcnJpZGVWYWx1ZV9fIik7cmV0dXJuIk9LVEFfTUFTVEVSRUQiPT09bj9pLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlPXt0eXBlOiJPS1RBX01BU1RFUkVEIn06Ik9WRVJSSURFIj09PW4mJihpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlPXt0eXBlOiJPUkRFUkVEX0xJU1QiLHZhbHVlOltdfSxyIGluc3RhbmNlb2YgZT90LmVhY2goci50b0pTT04oKSxmdW5jdGlvbih0KXtpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLnZhbHVlLnB1c2godC5pZCl9KTpyIGluc3RhbmNlb2YgQXJyYXkmJihpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLnZhbHVlPXIpLHQuaXNFbXB0eShpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLnZhbHVlKSYmZGVsZXRlIGkuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUpLCJJTkhFUklUIj09PW4mJmRlbGV0ZSBpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLGl9LF9ub3JtYWxpemVVbmlvblZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldCgiX19pc05vbmVTY29wZUFycmF5VHlwZV9fIil8fCh0LnVuaW9uPXZvaWQgMCksdH0sX3VwZGF0ZVR5cGVGb3JtYXRDb25zdHJhaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX2Rpc3BsYXlUeXBlX18iKTt0aGlzLnVuc2V0KCJmb3JtYXQiLHtzaWxlbnQ6ITB9KSx0aGlzLnVuc2V0KCJpdGVtcyIse3NpbGVudDohMH0pLHRoaXMuc2V0KHIuRElTUExBWVRZUEVTW3RdKSx0IT1vJiZ0IT1hJiYodGhpcy51bnNldCgibWluaW11bSIpLHRoaXMudW5zZXQoIm1heGltdW0iKSksdCE9cyYmKHRoaXMudW5zZXQoIm1pbkxlbmd0aCIpLHRoaXMudW5zZXQoIm1heExlbmd0aCIpKSx0aGlzLnVuc2V0KCJfX21pblZhbF9fIiksdGhpcy51bnNldCgiX19tYXhWYWxfXyIpLHRoaXMudW5zZXQoIl9fZXF1YWxzX18iKSx0aGlzLnNldCgiX19zdXBwb3J0c01pbk1heF9fIixyLlNVUFBPUlRTTUlOTUFYLmluZGV4T2YodGhpcy5nZXQoIl9fZGlzcGxheVR5cGVfXyIpKSE9LTEpfSxfdXBkYXRlTWluTWF4OmZ1bmN0aW9uKCl7dmFyIHQsZSxpPXRoaXMuZ2V0KCJfX2Rpc3BsYXlUeXBlX18iKTtpPT09cz8odD0ibWluTGVuZ3RoIixlPSJtYXhMZW5ndGgiKTppIT1hJiZpIT1vfHwodD0ibWluaW11bSIsZT0ibWF4aW11bSIpLHRoaXMuZ2V0KCJfX21pblZhbF9fIik/dGhpcy5zZXQodCxwYXJzZUludCh0aGlzLmdldCgiX19taW5WYWxfXyIpLDEwKSk6dGhpcy51bnNldCh0KSx0aGlzLmdldCgiX19tYXhWYWxfXyIpP3RoaXMuc2V0KGUscGFyc2VJbnQodGhpcy5nZXQoIl9fbWF4VmFsX18iKSwxMCkpOnRoaXMudW5zZXQoZSl9LF9jb252ZXJ0RXF1YWxzVG9NaW5NYXg6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldCgiX19lcXVhbHNfXyIpO3QmJih0aGlzLnNldCgiX19taW5WYWxfXyIsdCksdGhpcy5zZXQoIl9fbWF4VmFsX18iLHQpKX0sX3NldENvbnN0cmFpbnRUZXh0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXQoIl9fY29uc3RyYWludF9fIiksZT10aGlzLmdldCgiX19taW5WYWxfXyIpLGk9dGhpcy5nZXQoIl9fbWF4VmFsX18iKSxuPXRoaXMuZ2V0KCJfX2VxdWFsc19fIik7c3dpdGNoKHQpe2Nhc2UiYmV0d2VlbiI6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIkJldHdlZW4gIitlKyIgYW5kICIraSk7YnJlYWs7Y2FzZSJncmVhdGVyVGhhbiI6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIkdyZWF0ZXIgdGhhbiAiK2UpO2JyZWFrO2Nhc2UibGVzc1RoYW4iOnRoaXMuc2V0KCJfX2NvbnN0cmFpbnRUZXh0X18iLCJMZXNzIHRoYW4gIitpKTticmVhaztjYXNlImVxdWFscyI6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIkVxdWFscyAiK24pO2JyZWFrO2RlZmF1bHQ6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIiIpfX0sY2xlYW51cDpmdW5jdGlvbigpeyJsZXNzVGhhbiI9PT10aGlzLmdldCgiX19jb25zdHJhaW50X18iKT90aGlzLnVuc2V0KCJfX21pblZhbF9fIik6ImdyZWF0ZXJUaGFuIj09PXRoaXMuZ2V0KCJfX2NvbnN0cmFpbnRfXyIpJiZ0aGlzLnVuc2V0KCJfX21heFZhbF9fIiksdGhpcy5nZXQoInNjb3BlIikhPT1yLlNDT1BFLlNZU1RFTSYmKHRoaXMuZ2V0KCJfX2lzU2NvcGVTZWxmX18iKT09PSEwP3RoaXMuc2V0KHtzY29wZTpyLlNDT1BFLlNFTEZ9LHtzaWxlbnQ6ITB9KTp0aGlzLnVuc2V0KCJzY29wZSIpKX0saXNFbnVtVHlwZTpmdW5jdGlvbigpe3JldHVybiEhdGhpcy5nZXRFbnVtVmFsdWVzKCl9LGdldEVudW1WYWx1ZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoImVudW0iKXx8dGhpcy5nZXQoIml0ZW1zIikmJnRoaXMuZ2V0KCJpdGVtcyIpWyJlbnVtIl19fSksdT1lLmV4dGVuZCh7bW9kZWw6YyxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnRvSlNPTih7dmVyYm9zZTohMH0pLHtwYXJzZTohMH0pfSxhcmVBbGxSZWFkT25seTpmdW5jdGlvbigpe3JldHVybiB0LmFsbCh0aGlzLnBsdWNrKCJfX2lzUmVhZE9ubHlfXyIpKX0sY3JlYXRlTW9kZWxQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVkdWNlKGZ1bmN0aW9uKGUsaSl7dmFyIG49aS5nZXQoInR5cGUiKTtyZXR1cm4gZVtpLmlkXT10LmNsb25lKHIuRElTUExBWVRZUEVTW25dKSxyLlNVUFBPUlRTTUlOTUFYLmluZGV4T2YobikhPS0xJiYoZVtpLmlkXS5taW5MZW5ndGg9aS5nZXQoIm1pbkxlbmd0aCIpLGVbaS5pZF0ubWF4TGVuZ3RoPWkuZ2V0KCJtYXhMZW5ndGgiKSksInN0cmluZyI9PT1uJiYoZVtpLmlkXS5mb3JtYXQ9aS5nZXQoImZvcm1hdCIpKSxlfSx7fSl9fSk7cmV0dXJue01vZGVsOmMsQ29sbGVjdGlvbjp1fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI3MSksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll8scj1mdW5jdGlvbih0KXt2YXIgcj1lLmNyZWF0ZUlucHV0T3B0aW9ucyh0KTtzd2l0Y2gocj0ic2VsZWN0Ij09PXIudHlwZT9uLmV4dGVuZChyLHtsYWJlbDp0LmdldCgiZGVzY3JpcHRpb24iKX0pOm4uZXh0ZW5kKHIse2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnQuZ2V0KCJkZXNjcmlwdGlvbiIpfSksdC5nZXQoIm5hbWUiKSl7Y2FzZSJsb2dpbiI6ci5pbnB1dD1pLHIucGFyYW1zPXtpY29uOiJwZXJzb24tMTYtZ3JheSJ9O2JyZWFrO2Nhc2UicGFzc3dvcmQiOnIudHlwZT0icGFzc3dvcmQiLHIuaW5wdXQ9aSxyLnBhcmFtcz17aWNvbjoicmVtb3RlLWxvY2stMTYifX1yZXR1cm4gcn07cmV0dXJue2NyZWF0ZUlucHV0T3B0aW9uczpyfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDM4MyldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll8sbj10LlZpZXcuZXh0ZW5kKHtuYW1lOiIiLG1lc3NhZ2U6IiIsaWQ6ZnVuY3Rpb24oKXtyZXR1cm4icGFzc3dvcmQtY29tcGxleGl0eS0iK3RoaXMubmFtZX0sY2xhc3NOYW1lOiJwYXNzd29yZC1jb21wbGV4aXR5LXVuc2F0aXNmaWVkIix0ZW1wbGF0ZTonXHQgICAgICA8cD5cdCAgICAgICAgPHNwYW4gY2xhc3M9Imljb24gaWNvbi0xNiBlcnJvci0xNi1zbWFsbCIvPlx0ICAgICAgICB7e21lc3NhZ2V9fVx0ICAgICAgPC9wPlx0ICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue21lc3NhZ2U6dGhpcy5tZXNzYWdlfX19KTtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJwYXNzd29yZC1jb21wbGV4aXR5IixjaGlsZHJlbjpmdW5jdGlvbigpe3JldHVybiBpLm1hcCh0aGlzLnBhc3N3b3JkQ29tcGxleGl0eS5lbmFibGVkQ29tcGxleGl0aWVzLGZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuZ2V0KHQpLHI9ZS5jb21wbGV4aXRpZXNbdF0uZ2V0STE4bk1lc3NhZ2UoaSk7cmV0dXJuIG4uZXh0ZW5kKHtuYW1lOnQsbWVzc2FnZTpyfSl9LHRoaXMucGFzc3dvcmRDb21wbGV4aXR5KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMwMSksaSgyOTUpLGkoMjk2KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll87cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6InJlZ2lzdHJhdGlvbi1jb21wbGV0ZSIsTW9kZWw6ZnVuY3Rpb24oKXt9LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywicmVnaXN0cmF0aW9uLmNvbXBsZXRlLnRpdGxlIiwibG9naW4iKSxub0J1dHRvbkJhcjohMCxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5WaWV3KHtWaWV3OnQuVmlldy5leHRlbmQoe3RlbXBsYXRlOiJcdCAgICAgICAgICAgICAgPHNwYW4+e3tkZXNjfX08L3NwYW4+XHQgICAgICAgICAgICAgICIsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlcm5hbWUiKTtyZXR1cm57ZGVzYzp0LmxvYygicmVnaXN0cmF0aW9uLmNvbXBsZXRlLmRlc2MiLCJsb2dpbiIsW2VdKX19fSl9KV19fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpLGkoMjk0KSxpKDM5MCksaSgzMTcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC5fO3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8ZGl2IGNsYXNzPSJiZWFjb24tYmxhbmsgYXV0aC1iZWFjb24iPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJiZWFjb24tYmxhbmsganMtYmxhbmstYmVhY29uLWJvcmRlciBhdXRoLWJlYWNvbi1ib3JkZXIiPjwvZGl2Plx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGNsYXNzPSJiZy1oZWxwZXIgYXV0aC1iZWFjb24gYXV0aC1iZWFjb24tZmFjdG9yIHt7Y2xhc3NOYW1lfX0iIGRhdGEtc2U9ImZhY3Rvci1iZWFjb24iPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJva3RhLXNpZ24taW4tYmVhY29uLWJvcmRlciBhdXRoLWJlYWNvbi1ib3JkZXIiPjwvZGl2Plx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGRhdGEtdHlwZT0iZmFjdG9yLXR5cGVzLWRyb3Bkb3duIiBjbGFzcz0iZmFjdG9ycy1kcm9wZG93bi13cmFwIj48L2Rpdj5cdCAgICAnLGV2ZW50czp7ImNsaWNrIC5hdXRoLWJlYWNvbi1mYWN0b3IiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMuJCgiLmRyb3Bkb3duIC5vcHRpb25zIikudG9nZ2xlKCl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgiYmVhY29uVHlwZSIsImZhY3RvciIpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgdCxlLGk9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpO3JldHVybiB0PWk/aS5maW5kV2hlcmUocy5waWNrKHRoaXMub3B0aW9ucywicHJvdmlkZXIiLCJmYWN0b3JUeXBlIikpOm5ldyByLk1vZGVsKHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvciIpLHRoaXMudG9KU09OKCkpLGU9dC5nZXQoImljb25DbGFzc05hbWUiKSx7Y2xhc3NOYW1lOmV8fCIifX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hbmltYXRlJiZ0aGlzLiQoIi5hdXRoLWJlYWNvbi1mYWN0b3IiKS5mYWRlSW4oMjAwKTt2YXIgdD10aGlzLm9wdGlvbnMuYXBwU3RhdGU7dC5nZXQoImhhc01mYVJlcXVpcmVkT3B0aW9ucyIpJiZ0aGlzLmFkZChuLCdbZGF0YS10eXBlPSJmYWN0b3ItdHlwZXMtZHJvcGRvd24iXScpfSxmYWRlT3V0OmZ1bmN0aW9uKCl7dmFyIHQ9ZS5kZWZlcigpO3JldHVybiB0aGlzLiQoIi5hdXRoLWJlYWNvbi1mYWN0b3IiKS5mYWRlT3V0KDIwMCxmdW5jdGlvbigpe3QucmVzb2x2ZSgpfSksdC5wcm9taXNlfSxlcXVhbHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCYmdGhpcyBpbnN0YW5jZW9mIHQmJmUucHJvdmlkZXI9PT10aGlzLm9wdGlvbnMucHJvdmlkZXImJihlLmZhY3RvclR5cGU9PT10aGlzLm9wdGlvbnMuZmFjdG9yVHlwZXx8aS5pc09rdGFWZXJpZnkoZS5wcm92aWRlcixlLmZhY3RvclR5cGUpJiZpLmlzT2t0YVZlcmlmeSh0aGlzLm9wdGlvbnMucHJvdmlkZXIsdGhpcy5vcHRpb25zLmZhY3RvclR5cGUpKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDM5MSksaSgxOTYpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll8scj10LiQ7cmV0dXJuIHIoZG9jdW1lbnQpLmNsaWNrKGZ1bmN0aW9uKHQpe3ZhciBlPXIodC50YXJnZXQpLGk9ZS5jbG9zZXN0KCIub3B0aW9uLXNlbGVjdGVkIikubGVuZ3RoPjAmJmUuY2xvc2VzdCgiLmRyb3Bkb3duIikubGVuZ3RoPjA7aXx8cigiLmRyb3Bkb3duIC5vcHRpb25zIikuaGlkZSgpfSksaS5leHRlbmQoe2NsYXNzTmFtZToiYmctaGVscGVyIGljb24tYnV0dG9uIixldmVudHM6eyJjbGljayBhLm9wdGlvbi1zZWxlY3RlZCI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLG4ucmVzdWx0KHRoaXMsImRpc2FibGVkIik/dC5zdG9wUHJvcGFnYXRpb24oKTp0aGlzLiQoIi5vcHRpb25zIikudG9nZ2xlKCl9LCJjbGljayAuZHJvcGRvd24tZGlzYWJsZWQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuYWRkT3B0aW9uKGUuZ2V0RHJvcGRvd25PcHRpb24oIlRJVExFIikpLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvcnMiKS5lYWNoKGZ1bmN0aW9uKHQpe3RoaXMuYWRkT3B0aW9uKGUuZ2V0RHJvcGRvd25PcHRpb24odC5nZXQoImZhY3Rvck5hbWUiKSkse21vZGVsOnR9KSx0aGlzLmxpc3RlblRvKHRoaXMubGFzdCgpLCJvcHRpb25zOnRvZ2dsZSIsZnVuY3Rpb24oKXt0aGlzLiQoIi5vcHRpb25zIikuaGlkZSgpfSl9LHRoaXMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk5KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXQuXyxuPWZ1bmN0aW9uKHQpe3ZhciBpPWUuY3JlYXRlVmVyaWZ5VXJsKHQuZ2V0KCJwcm92aWRlciIpLHQuZ2V0KCJmYWN0b3JUeXBlIikpLG49dGhpczt0aGlzLm1vZGVsLm1hbmFnZVRyYW5zYWN0aW9uKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIk1GQV9DSEFMTEVOR0UiPT09dC5zdGF0dXMmJnQucHJldj90LnByZXYoKS50aGVuKGZ1bmN0aW9uKHQpe24udHJpZ2dlcigib3B0aW9uczp0b2dnbGUiKSxlKHQpLG4ub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsaSl9KToobi50cmlnZ2VyKCJvcHRpb25zOnRvZ2dsZSIpLHZvaWQgbi5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIixpKSl9KX0scj17VElUTEU6e3RpdGxlOmkucGFydGlhbCh0LmxvYywibWZhLmZhY3RvcnMuZHJvcGRvd24udGl0bGUiLCJsb2dpbiIpLGNsYXNzTmFtZToiZHJvcGRvd24tbGlzdC10aXRsZSJ9LE9LVEFfVkVSSUZZOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtb2t0YS12ZXJpZnktMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LE9LVEFfVkVSSUZZX1BVU0g6e2ljb246ImZhY3Rvci1pY29uIG1mYS1va3RhLXZlcmlmeS0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sR09PR0xFX0FVVEg6e2ljb246ImZhY3Rvci1pY29uIG1mYS1nb29nbGUtYXV0aC0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sU1lNQU5URUNfVklQOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtc3ltYW50ZWMtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFJTQV9TRUNVUklEOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtcnNhLTMwIix0aXRsZTppLnBhcnRpYWwodC5sb2MsImZhY3Rvci50b3RwSGFyZC5yc2FTZWN1cklkIiwibG9naW4iKSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LE9OX1BSRU06e2ljb246ImZhY3Rvci1pY29uIG1mYS1vbnByZW0tMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LERVTzp7aWNvbjoiZmFjdG9yLWljb24gbWZhLWR1by0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sRFVPX1BVU0g6e2ljb246ImR1by1wdXNoLTE2IixjbGFzc05hbWU6InN1Ym9wdGlvbiIsdGl0bGU6aS5wYXJ0aWFsKHQubG9jLCJtZmEuZHVvU2VjdXJpdHkucHVzaCIsImxvZ2luIixbIlhYWC1YWFgtNzg5MCJdKX0sRFVPX1NNUzp7aWNvbjoiZHVvLXNtcy0xNiIsY2xhc3NOYW1lOiJzdWJvcHRpb24iLHRpdGxlOmkucGFydGlhbCh0LmxvYywibWZhLmR1b1NlY3VyaXR5LnNtcyIsImxvZ2luIixbIlhYWC1YWFgtNzg5MCJdKX0sRFVPX0NBTEw6e2ljb246ImR1by1jYWxsLTE2IixjbGFzc05hbWU6InN1Ym9wdGlvbiIsdGl0bGU6aS5wYXJ0aWFsKHQubG9jLCJtZmEuZHVvU2VjdXJpdHkuY2FsbCIsImxvZ2luIixbIlhYWC1YWFgtNzg5MCJdKX0sWVVCSUtFWTp7aWNvbjoiZmFjdG9yLWljb24gbWZhLXl1YmlrZXktMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFNNUzp7aWNvbjoiZmFjdG9yLWljb24gbWZhLXNtcy0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sQ0FMTDp7aWNvbjoiZmFjdG9yLWljb24gbWZhLWNhbGwtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFFVRVNUSU9OOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtcXVlc3Rpb24tMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFdJTkRPV1NfSEVMTE86e2ljb246ImZhY3Rvci1pY29uIG1mYS13aW5kb3dzLWhlbGxvLTMwIix0aXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmdldCgiZmFjdG9yTGFiZWwiKX0sYWN0aW9uOmZ1bmN0aW9uKCl7bi5jYWxsKHRoaXMsdGhpcy5tb2RlbCl9fSxVMkY6e2ljb246ImZhY3Rvci1pY29uIG1mYS11MmYtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LEVNQUlMOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtZW1haWwtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19fTtyZXR1cm57Z2V0RHJvcGRvd25PcHRpb246ZnVuY3Rpb24odCl7cmV0dXJuIHJbdF19fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfV0pfSk7CgovKioqLyB9LAovKiAyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuMTIuMQoJICogaHR0cDovL2pxdWVyeS5jb20vCgkgKgoJICogSW5jbHVkZXMgU2l6emxlLmpzCgkgKiBodHRwOi8vc2l6emxlanMuY29tLwoJICoKCSAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzCgkgKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UKCSAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UKCSAqCgkgKiBEYXRlOiAyMDE2LTAyLTIyVDE5OjA3WgoJICovCgoJKGZ1bmN0aW9uKCBnbG9iYWwsIGZhY3RvcnkgKSB7CgoJCWlmICggdHlwZW9mIG1vZHVsZSA9PT0gIm9iamVjdCIgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAib2JqZWN0IiApIHsKCQkJLy8gRm9yIENvbW1vbkpTIGFuZCBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB3aGVyZSBhIHByb3BlciBgd2luZG93YAoJCQkvLyBpcyBwcmVzZW50LCBleGVjdXRlIHRoZSBmYWN0b3J5IGFuZCBnZXQgalF1ZXJ5LgoJCQkvLyBGb3IgZW52aXJvbm1lbnRzIHRoYXQgZG8gbm90IGhhdmUgYSBgd2luZG93YCB3aXRoIGEgYGRvY3VtZW50YAoJCQkvLyAoc3VjaCBhcyBOb2RlLmpzKSwgZXhwb3NlIGEgZmFjdG9yeSBhcyBtb2R1bGUuZXhwb3J0cy4KCQkJLy8gVGhpcyBhY2NlbnR1YXRlcyB0aGUgbmVlZCBmb3IgdGhlIGNyZWF0aW9uIG9mIGEgcmVhbCBgd2luZG93YC4KCQkJLy8gZS5nLiB2YXIgalF1ZXJ5ID0gcmVxdWlyZSgianF1ZXJ5Iikod2luZG93KTsKCQkJLy8gU2VlIHRpY2tldCAjMTQ1NDkgZm9yIG1vcmUgaW5mby4KCQkJbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWwuZG9jdW1lbnQgPwoJCQkJZmFjdG9yeSggZ2xvYmFsLCB0cnVlICkgOgoJCQkJZnVuY3Rpb24oIHcgKSB7CgkJCQkJaWYgKCAhdy5kb2N1bWVudCApIHsKCQkJCQkJdGhyb3cgbmV3IEVycm9yKCAialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIgKTsKCQkJCQl9CgkJCQkJcmV0dXJuIGZhY3RvcnkoIHcgKTsKCQkJCX07CgkJfSBlbHNlIHsKCQkJZmFjdG9yeSggZ2xvYmFsICk7CgkJfQoKCS8vIFBhc3MgdGhpcyBpZiB3aW5kb3cgaXMgbm90IGRlZmluZWQgeWV0Cgl9KHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24oIHdpbmRvdywgbm9HbG9iYWwgKSB7CgoJLy8gU3VwcG9ydDogRmlyZWZveCAxOCsKCS8vIENhbid0IGJlIGluIHN0cmljdCBtb2RlLCBzZXZlcmFsIGxpYnMgaW5jbHVkaW5nIEFTUC5ORVQgdHJhY2UKCS8vIHRoZSBzdGFjayB2aWEgYXJndW1lbnRzLmNhbGxlci5jYWxsZWUgYW5kIEZpcmVmb3ggZGllcyBpZgoJLy8geW91IHRyeSB0byB0cmFjZSB0aHJvdWdoICJ1c2Ugc3RyaWN0IiBjYWxsIGNoYWlucy4gKCMxMzMzNSkKCS8vInVzZSBzdHJpY3QiOwoJdmFyIGRlbGV0ZWRJZHMgPSBbXTsKCgl2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7CgoJdmFyIHNsaWNlID0gZGVsZXRlZElkcy5zbGljZTsKCgl2YXIgY29uY2F0ID0gZGVsZXRlZElkcy5jb25jYXQ7CgoJdmFyIHB1c2ggPSBkZWxldGVkSWRzLnB1c2g7CgoJdmFyIGluZGV4T2YgPSBkZWxldGVkSWRzLmluZGV4T2Y7CgoJdmFyIGNsYXNzMnR5cGUgPSB7fTsKCgl2YXIgdG9TdHJpbmcgPSBjbGFzczJ0eXBlLnRvU3RyaW5nOwoKCXZhciBoYXNPd24gPSBjbGFzczJ0eXBlLmhhc093blByb3BlcnR5OwoKCXZhciBzdXBwb3J0ID0ge307CgoKCgl2YXIKCQl2ZXJzaW9uID0gIjEuMTIuMSIsCgoJCS8vIERlZmluZSBhIGxvY2FsIGNvcHkgb2YgalF1ZXJ5CgkJalF1ZXJ5ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkgewoKCQkJLy8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnCgkJCS8vIE5lZWQgaW5pdCBpZiBqUXVlcnkgaXMgY2FsbGVkIChqdXN0IGFsbG93IGVycm9yIHRvIGJlIHRocm93biBpZiBub3QgaW5jbHVkZWQpCgkJCXJldHVybiBuZXcgalF1ZXJ5LmZuLmluaXQoIHNlbGVjdG9yLCBjb250ZXh0ICk7CgkJfSwKCgkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIElFPDkKCQkvLyBNYWtlIHN1cmUgd2UgdHJpbSBCT00gYW5kIE5CU1AKCQlydHJpbSA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywKCgkJLy8gTWF0Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nCgkJcm1zUHJlZml4ID0gL14tbXMtLywKCQlyZGFzaEFscGhhID0gLy0oW1xkYS16XSkvZ2ksCgoJCS8vIFVzZWQgYnkgalF1ZXJ5LmNhbWVsQ2FzZSBhcyBjYWxsYmFjayB0byByZXBsYWNlKCkKCQlmY2FtZWxDYXNlID0gZnVuY3Rpb24oIGFsbCwgbGV0dGVyICkgewoJCQlyZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CgkJfTsKCglqUXVlcnkuZm4gPSBqUXVlcnkucHJvdG90eXBlID0gewoKCQkvLyBUaGUgY3VycmVudCB2ZXJzaW9uIG9mIGpRdWVyeSBiZWluZyB1c2VkCgkJanF1ZXJ5OiB2ZXJzaW9uLAoKCQljb25zdHJ1Y3RvcjogalF1ZXJ5LAoKCQkvLyBTdGFydCB3aXRoIGFuIGVtcHR5IHNlbGVjdG9yCgkJc2VsZWN0b3I6ICIiLAoKCQkvLyBUaGUgZGVmYXVsdCBsZW5ndGggb2YgYSBqUXVlcnkgb2JqZWN0IGlzIDAKCQlsZW5ndGg6IDAsCgoJCXRvQXJyYXk6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gc2xpY2UuY2FsbCggdGhpcyApOwoJCX0sCgoJCS8vIEdldCB0aGUgTnRoIGVsZW1lbnQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBzZXQgT1IKCQkvLyBHZXQgdGhlIHdob2xlIG1hdGNoZWQgZWxlbWVudCBzZXQgYXMgYSBjbGVhbiBhcnJheQoJCWdldDogZnVuY3Rpb24oIG51bSApIHsKCQkJcmV0dXJuIG51bSAhPSBudWxsID8KCgkJCQkvLyBSZXR1cm4ganVzdCB0aGUgb25lIGVsZW1lbnQgZnJvbSB0aGUgc2V0CgkJCQkoIG51bSA8IDAgPyB0aGlzWyBudW0gKyB0aGlzLmxlbmd0aCBdIDogdGhpc1sgbnVtIF0gKSA6CgoJCQkJLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgaW4gYSBjbGVhbiBhcnJheQoJCQkJc2xpY2UuY2FsbCggdGhpcyApOwoJCX0sCgoJCS8vIFRha2UgYW4gYXJyYXkgb2YgZWxlbWVudHMgYW5kIHB1c2ggaXQgb250byB0aGUgc3RhY2sKCQkvLyAocmV0dXJuaW5nIHRoZQ==", "base64"));
  res.write(new Buffer("IG5ldyBtYXRjaGVkIGVsZW1lbnQgc2V0KQoJCXB1c2hTdGFjazogZnVuY3Rpb24oIGVsZW1zICkgewoKCQkJLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKCQkJdmFyIHJldCA9IGpRdWVyeS5tZXJnZSggdGhpcy5jb25zdHJ1Y3RvcigpLCBlbGVtcyApOwoKCQkJLy8gQWRkIHRoZSBvbGQgb2JqZWN0IG9udG8gdGhlIHN0YWNrIChhcyBhIHJlZmVyZW5jZSkKCQkJcmV0LnByZXZPYmplY3QgPSB0aGlzOwoJCQlyZXQuY29udGV4dCA9IHRoaXMuY29udGV4dDsKCgkJCS8vIFJldHVybiB0aGUgbmV3bHktZm9ybWVkIGVsZW1lbnQgc2V0CgkJCXJldHVybiByZXQ7CgkJfSwKCgkJLy8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC4KCQllYWNoOiBmdW5jdGlvbiggY2FsbGJhY2sgKSB7CgkJCXJldHVybiBqUXVlcnkuZWFjaCggdGhpcywgY2FsbGJhY2sgKTsKCQl9LAoKCQltYXA6IGZ1bmN0aW9uKCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkubWFwKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgaSApIHsKCQkJCXJldHVybiBjYWxsYmFjay5jYWxsKCBlbGVtLCBpLCBlbGVtICk7CgkJCX0gKSApOwoJCX0sCgoJCXNsaWNlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBzbGljZS5hcHBseSggdGhpcywgYXJndW1lbnRzICkgKTsKCQl9LAoKCQlmaXJzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAwICk7CgkJfSwKCgkJbGFzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAtMSApOwoJCX0sCgoJCWVxOiBmdW5jdGlvbiggaSApIHsKCQkJdmFyIGxlbiA9IHRoaXMubGVuZ3RoLAoJCQkJaiA9ICtpICsgKCBpIDwgMCA/IGxlbiA6IDAgKTsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqID49IDAgJiYgaiA8IGxlbiA/IFsgdGhpc1sgaiBdIF0gOiBbXSApOwoJCX0sCgoJCWVuZDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLnByZXZPYmplY3QgfHwgdGhpcy5jb25zdHJ1Y3RvcigpOwoJCX0sCgoJCS8vIEZvciBpbnRlcm5hbCB1c2Ugb25seS4KCQkvLyBCZWhhdmVzIGxpa2UgYW4gQXJyYXkncyBtZXRob2QsIG5vdCBsaWtlIGEgalF1ZXJ5IG1ldGhvZC4KCQlwdXNoOiBwdXNoLAoJCXNvcnQ6IGRlbGV0ZWRJZHMuc29ydCwKCQlzcGxpY2U6IGRlbGV0ZWRJZHMuc3BsaWNlCgl9OwoKCWpRdWVyeS5leHRlbmQgPSBqUXVlcnkuZm4uZXh0ZW5kID0gZnVuY3Rpb24oKSB7CgkJdmFyIHNyYywgY29weUlzQXJyYXksIGNvcHksIG5hbWUsIG9wdGlvbnMsIGNsb25lLAoJCQl0YXJnZXQgPSBhcmd1bWVudHNbIDAgXSB8fCB7fSwKCQkJaSA9IDEsCgkJCWxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsCgkJCWRlZXAgPSBmYWxzZTsKCgkJLy8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvbgoJCWlmICggdHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4iICkgewoJCQlkZWVwID0gdGFyZ2V0OwoKCQkJLy8gc2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldAoJCQl0YXJnZXQgPSBhcmd1bWVudHNbIGkgXSB8fCB7fTsKCQkJaSsrOwoJCX0KCgkJLy8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpCgkJaWYgKCB0eXBlb2YgdGFyZ2V0ICE9PSAib2JqZWN0IiAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24oIHRhcmdldCApICkgewoJCQl0YXJnZXQgPSB7fTsKCQl9CgoJCS8vIGV4dGVuZCBqUXVlcnkgaXRzZWxmIGlmIG9ubHkgb25lIGFyZ3VtZW50IGlzIHBhc3NlZAoJCWlmICggaSA9PT0gbGVuZ3RoICkgewoJCQl0YXJnZXQgPSB0aGlzOwoJCQlpLS07CgkJfQoKCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCgkJCS8vIE9ubHkgZGVhbCB3aXRoIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXMKCQkJaWYgKCAoIG9wdGlvbnMgPSBhcmd1bWVudHNbIGkgXSApICE9IG51bGwgKSB7CgoJCQkJLy8gRXh0ZW5kIHRoZSBiYXNlIG9iamVjdAoJCQkJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCQkJCXNyYyA9IHRhcmdldFsgbmFtZSBdOwoJCQkJCWNvcHkgPSBvcHRpb25zWyBuYW1lIF07CgoJCQkJCS8vIFByZXZlbnQgbmV2ZXItZW5kaW5nIGxvb3AKCQkJCQlpZiAoIHRhcmdldCA9PT0gY29weSApIHsKCQkJCQkJY29udGludWU7CgkJCQkJfQoKCQkJCQkvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKCQkJCQlpZiAoIGRlZXAgJiYgY29weSAmJiAoIGpRdWVyeS5pc1BsYWluT2JqZWN0KCBjb3B5ICkgfHwKCQkJCQkJKCBjb3B5SXNBcnJheSA9IGpRdWVyeS5pc0FycmF5KCBjb3B5ICkgKSApICkgewoKCQkJCQkJaWYgKCBjb3B5SXNBcnJheSApIHsKCQkJCQkJCWNvcHlJc0FycmF5ID0gZmFsc2U7CgkJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNBcnJheSggc3JjICkgPyBzcmMgOiBbXTsKCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdCggc3JjICkgPyBzcmMgOiB7fTsKCQkJCQkJfQoKCQkJCQkJLy8gTmV2ZXIgbW92ZSBvcmlnaW5hbCBvYmplY3RzLCBjbG9uZSB0aGVtCgkJCQkJCXRhcmdldFsgbmFtZSBdID0galF1ZXJ5LmV4dGVuZCggZGVlcCwgY2xvbmUsIGNvcHkgKTsKCgkJCQkJLy8gRG9uJ3QgYnJpbmcgaW4gdW5kZWZpbmVkIHZhbHVlcwoJCQkJCX0gZWxzZSBpZiAoIGNvcHkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJdGFyZ2V0WyBuYW1lIF0gPSBjb3B5OwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJLy8gUmV0dXJuIHRoZSBtb2RpZmllZCBvYmplY3QKCQlyZXR1cm4gdGFyZ2V0OwoJfTsKCglqUXVlcnkuZXh0ZW5kKCB7CgoJCS8vIFVuaXF1ZSBmb3IgZWFjaCBjb3B5IG9mIGpRdWVyeSBvbiB0aGUgcGFnZQoJCWV4cGFuZG86ICJqUXVlcnkiICsgKCB2ZXJzaW9uICsgTWF0aC5yYW5kb20oKSApLnJlcGxhY2UoIC9cRC9nLCAiIiApLAoKCQkvLyBBc3N1bWUgalF1ZXJ5IGlzIHJlYWR5IHdpdGhvdXQgdGhlIHJlYWR5IG1vZHVsZQoJCWlzUmVhZHk6IHRydWUsCgoJCWVycm9yOiBmdW5jdGlvbiggbXNnICkgewoJCQl0aHJvdyBuZXcgRXJyb3IoIG1zZyApOwoJCX0sCgoJCW5vb3A6IGZ1bmN0aW9uKCkge30sCgoJCS8vIFNlZSB0ZXN0L3VuaXQvY29yZS5qcyBmb3IgZGV0YWlscyBjb25jZXJuaW5nIGlzRnVuY3Rpb24uCgkJLy8gU2luY2UgdmVyc2lvbiAxLjMsIERPTSBtZXRob2RzIGFuZCBmdW5jdGlvbnMgbGlrZSBhbGVydAoJCS8vIGFyZW4ndCBzdXBwb3J0ZWQuIFRoZXkgcmV0dXJuIGZhbHNlIG9uIElFICgjMjk2OCkuCgkJaXNGdW5jdGlvbjogZnVuY3Rpb24oIG9iaiApIHsKCQkJcmV0dXJuIGpRdWVyeS50eXBlKCBvYmogKSA9PT0gImZ1bmN0aW9uIjsKCQl9LAoKCQlpc0FycmF5OiBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKCBvYmogKSB7CgkJCXJldHVybiBqUXVlcnkudHlwZSggb2JqICkgPT09ICJhcnJheSI7CgkJfSwKCgkJaXNXaW5kb3c6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCS8qIGpzaGludCBlcWVxZXE6IGZhbHNlICovCgkJCXJldHVybiBvYmogIT0gbnVsbCAmJiBvYmogPT0gb2JqLndpbmRvdzsKCQl9LAoKCQlpc051bWVyaWM6IGZ1bmN0aW9uKCBvYmogKSB7CgoJCQkvLyBwYXJzZUZsb2F0IE5hTnMgbnVtZXJpYy1jYXN0IGZhbHNlIHBvc2l0aXZlcyAobnVsbHx0cnVlfGZhbHNlfCIiKQoJCQkvLyAuLi5idXQgbWlzaW50ZXJwcmV0cyBsZWFkaW5nLW51bWJlciBzdHJpbmdzLCBwYXJ0aWN1bGFybHkgaGV4IGxpdGVyYWxzICgiMHguLi4iKQoJCQkvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU4KCQkJLy8gYWRkaW5nIDEgY29ycmVjdHMgbG9zcyBvZiBwcmVjaXNpb24gZnJvbSBwYXJzZUZsb2F0ICgjMTUxMDApCgkJCXZhciByZWFsU3RyaW5nT2JqID0gb2JqICYmIG9iai50b1N0cmluZygpOwoJCQlyZXR1cm4gIWpRdWVyeS5pc0FycmF5KCBvYmogKSAmJiAoIHJlYWxTdHJpbmdPYmogLSBwYXJzZUZsb2F0KCByZWFsU3RyaW5nT2JqICkgKyAxICkgPj0gMDsKCQl9LAoKCQlpc0VtcHR5T2JqZWN0OiBmdW5jdGlvbiggb2JqICkgewoJCQl2YXIgbmFtZTsKCQkJZm9yICggbmFtZSBpbiBvYmogKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJcmV0dXJuIHRydWU7CgkJfSwKCgkJaXNQbGFpbk9iamVjdDogZnVuY3Rpb24oIG9iaiApIHsKCQkJdmFyIGtleTsKCgkJCS8vIE11c3QgYmUgYW4gT2JqZWN0LgoJCQkvLyBCZWNhdXNlIG9mIElFLCB3ZSBhbHNvIGhhdmUgdG8gY2hlY2sgdGhlIHByZXNlbmNlIG9mIHRoZSBjb25zdHJ1Y3RvciBwcm9wZXJ0eS4KCQkJLy8gTWFrZSBzdXJlIHRoYXQgRE9NIG5vZGVzIGFuZCB3aW5kb3cgb2JqZWN0cyBkb24ndCBwYXNzIHRocm91Z2gsIGFzIHdlbGwKCQkJaWYgKCAhb2JqIHx8IGpRdWVyeS50eXBlKCBvYmogKSAhPT0gIm9iamVjdCIgfHwgb2JqLm5vZGVUeXBlIHx8IGpRdWVyeS5pc1dpbmRvdyggb2JqICkgKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCXRyeSB7CgoJCQkJLy8gTm90IG93biBjb25zdHJ1Y3RvciBwcm9wZXJ0eSBtdXN0IGJlIE9iamVjdAoJCQkJaWYgKCBvYmouY29uc3RydWN0b3IgJiYKCQkJCQkhaGFzT3duLmNhbGwoIG9iaiwgImNvbnN0cnVjdG9yIiApICYmCgkJCQkJIWhhc093bi5jYWxsKCBvYmouY29uc3RydWN0b3IucHJvdG90eXBlLCAiaXNQcm90b3R5cGVPZiIgKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0gY2F0Y2ggKCBlICkgewoKCQkJCS8vIElFOCw5IFdpbGwgdGhyb3cgZXhjZXB0aW9ucyBvbiBjZXJ0YWluIGhvc3Qgb2JqZWN0cyAjOTg5NwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIEhhbmRsZSBpdGVyYXRpb24gb3ZlciBpbmhlcml0ZWQgcHJvcGVydGllcyBiZWZvcmUgb3duIHByb3BlcnRpZXMuCgkJCWlmICggIXN1cHBvcnQub3duRmlyc3QgKSB7CgkJCQlmb3IgKCBrZXkgaW4gb2JqICkgewoJCQkJCXJldHVybiBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQkJCX0KCQkJfQoKCQkJLy8gT3duIHByb3BlcnRpZXMgYXJlIGVudW1lcmF0ZWQgZmlyc3RseSwgc28gdG8gc3BlZWQgdXAsCgkJCS8vIGlmIGxhc3Qgb25lIGlzIG93biwgdGhlbiBhbGwgcHJvcGVydGllcyBhcmUgb3duLgoJCQlmb3IgKCBrZXkgaW4gb2JqICkge30KCgkJCXJldHVybiBrZXkgPT09IHVuZGVmaW5lZCB8fCBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQl9LAoKCQl0eXBlOiBmdW5jdGlvbiggb2JqICkgewoJCQlpZiAoIG9iaiA9PSBudWxsICkgewoJCQkJcmV0dXJuIG9iaiArICIiOwoJCQl9CgkJCXJldHVybiB0eXBlb2Ygb2JqID09PSAib2JqZWN0IiB8fCB0eXBlb2Ygb2JqID09PSAiZnVuY3Rpb24iID8KCQkJCWNsYXNzMnR5cGVbIHRvU3RyaW5nLmNhbGwoIG9iaiApIF0gfHwgIm9iamVjdCIgOgoJCQkJdHlwZW9mIG9iajsKCQl9LAoKCQkvLyBXb3JrYXJvdW5kcyBiYXNlZCBvbiBmaW5kaW5ncyBieSBKaW0gRHJpc2NvbGwKCQkvLyBodHRwOi8vd2VibG9ncy5qYXZhLm5ldC9ibG9nL2RyaXNjb2xsL2FyY2hpdmUvMjAwOS8wOS8wOC9ldmFsLWphdmFzY3JpcHQtZ2xvYmFsLWNvbnRleHQKCQlnbG9iYWxFdmFsOiBmdW5jdGlvbiggZGF0YSApIHsKCQkJaWYgKCBkYXRhICYmIGpRdWVyeS50cmltKCBkYXRhICkgKSB7CgoJCQkJLy8gV2UgdXNlIGV4ZWNTY3JpcHQgb24gSW50ZXJuZXQgRXhwbG9yZXIKCQkJCS8vIFdlIHVzZSBhbiBhbm9ueW1vdXMgZnVuY3Rpb24gc28gdGhhdCBjb250ZXh0IGlzIHdpbmRvdwoJCQkJLy8gcmF0aGVyIHRoYW4galF1ZXJ5IGluIEZpcmVmb3gKCQkJCSggd2luZG93LmV4ZWNTY3JpcHQgfHwgZnVuY3Rpb24oIGRhdGEgKSB7CgkJCQkJd2luZG93WyAiZXZhbCIgXS5jYWxsKCB3aW5kb3csIGRhdGEgKTsgLy8ganNjczppZ25vcmUgcmVxdWlyZURvdE5vdGF0aW9uCgkJCQl9ICkoIGRhdGEgKTsKCQkJfQoJCX0sCgoJCS8vIENvbnZlcnQgZGFzaGVkIHRvIGNhbWVsQ2FzZTsgdXNlZCBieSB0aGUgY3NzIGFuZCBkYXRhIG1vZHVsZXMKCQkvLyBNaWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1NzIpCgkJY2FtZWxDYXNlOiBmdW5jdGlvbiggc3RyaW5nICkgewoJCQlyZXR1cm4gc3RyaW5nLnJlcGxhY2UoIHJtc1ByZWZpeCwgIm1zLSIgKS5yZXBsYWNlKCByZGFzaEFscGhhLCBmY2FtZWxDYXNlICk7CgkJfSwKCgkJbm9kZU5hbWU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQlyZXR1cm4gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUudG9Mb3dlckNhc2UoKTsKCQl9LAoKCQllYWNoOiBmdW5jdGlvbiggb2JqLCBjYWxsYmFjayApIHsKCQkJdmFyIGxlbmd0aCwgaSA9IDA7CgoJCQlpZiAoIGlzQXJyYXlMaWtlKCBvYmogKSApIHsKCQkJCWxlbmd0aCA9IG9iai5sZW5ndGg7CgkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCQlpZiAoIGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApID09PSBmYWxzZSApIHsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZm9yICggaSBpbiBvYmogKSB7CgkJCQkJaWYgKCBjYWxsYmFjay5jYWxsKCBvYmpbIGkgXSwgaSwgb2JqWyBpIF0gKSA9PT0gZmFsc2UgKSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG9iajsKCQl9LAoKCQkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMSwgSUU8OQoJCXRyaW06IGZ1bmN0aW9uKCB0ZXh0ICkgewoJCQlyZXR1cm4gdGV4dCA9PSBudWxsID8KCQkJCSIiIDoKCQkJCSggdGV4dCArICIiICkucmVwbGFjZSggcnRyaW0sICIiICk7CgkJfSwKCgkJLy8gcmVzdWx0cyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seQoJCW1ha2VBcnJheTogZnVuY3Rpb24oIGFyciwgcmVzdWx0cyApIHsKCQkJdmFyIHJldCA9IHJlc3VsdHMgfHwgW107CgoJCQlpZiAoIGFyciAhPSBudWxsICkgewoJCQkJaWYgKCBpc0FycmF5TGlrZSggT2JqZWN0KCBhcnIgKSApICkgewoJCQkJCWpRdWVyeS5tZXJnZSggcmV0LAoJCQkJCQl0eXBlb2YgYXJyID09PSAic3RyaW5nIiA/CgkJCQkJCVsgYXJyIF0gOiBhcnIKCQkJCQkpOwoJCQkJfSBlbHNlIHsKCQkJCQlwdXNoLmNhbGwoIHJldCwgYXJyICk7CgkJCQl9CgkJCX0KCgkJCXJldHVybiByZXQ7CgkJfSwKCgkJaW5BcnJheTogZnVuY3Rpb24oIGVsZW0sIGFyciwgaSApIHsKCQkJdmFyIGxlbjsKCgkJCWlmICggYXJyICkgewoJCQkJaWYgKCBpbmRleE9mICkgewoJCQkJCXJldHVybiBpbmRleE9mLmNhbGwoIGFyciwgZWxlbSwgaSApOwoJCQkJfQoKCQkJCWxlbiA9IGFyci5sZW5ndGg7CgkJCQlpID0gaSA/IGkgPCAwID8gTWF0aC5tYXgoIDAsIGxlbiArIGkgKSA6IGkgOiAwOwoKCQkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoKCQkJCQkvLyBTa2lwIGFjY2Vzc2luZyBpbiBzcGFyc2UgYXJyYXlzCgkJCQkJaWYgKCBpIGluIGFyciAmJiBhcnJbIGkgXSA9PT0gZWxlbSApIHsKCQkJCQkJcmV0dXJuIGk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gLTE7CgkJfSwKCgkJbWVyZ2U6IGZ1bmN0aW9uKCBmaXJzdCwgc2Vjb25kICkgewoJCQl2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsCgkJCQlqID0gMCwKCQkJCWkgPSBmaXJzdC5sZW5ndGg7CgoJCQl3aGlsZSAoIGogPCBsZW4gKSB7CgkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGorKyBdOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIFdvcmthcm91bmQgY2FzdGluZyBvZiAubGVuZ3RoIHRvIE5hTiBvbiBvdGhlcndpc2UgYXJyYXlsaWtlIG9iamVjdHMgKGUuZy4sIE5vZGVMaXN0cykKCQkJaWYgKCBsZW4gIT09IGxlbiApIHsKCQkJCXdoaWxlICggc2Vjb25kWyBqIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGorKyBdOwoJCQkJfQoJCQl9CgoJCQlmaXJzdC5sZW5ndGggPSBpOwoKCQkJcmV0dXJuIGZpcnN0OwoJCX0sCgoJCWdyZXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGludmVydCApIHsKCQkJdmFyIGNhbGxiYWNrSW52ZXJzZSwKCQkJCW1hdGNoZXMgPSBbXSwKCQkJCWkgPSAwLAoJCQkJbGVuZ3RoID0gZWxlbXMubGVuZ3RoLAoJCQkJY2FsbGJhY2tFeHBlY3QgPSAhaW52ZXJ0OwoKCQkJLy8gR28gdGhyb3VnaCB0aGUgYXJyYXksIG9ubHkgc2F2aW5nIHRoZSBpdGVtcwoJCQkvLyB0aGF0IHBhc3MgdGhlIHZhbGlkYXRvciBmdW5jdGlvbgoJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCWNhbGxiYWNrSW52ZXJzZSA9ICFjYWxsYmFjayggZWxlbXNbIGkgXSwgaSApOwoJCQkJaWYgKCBjYWxsYmFja0ludmVyc2UgIT09IGNhbGxiYWNrRXhwZWN0ICkgewoJCQkJCW1hdGNoZXMucHVzaCggZWxlbXNbIGkgXSApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gbWF0Y2hlczsKCQl9LAoKCQkvLyBhcmcgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHkKCQltYXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGFyZyApIHsKCQkJdmFyIGxlbmd0aCwgdmFsdWUsCgkJCQlpID0gMCwKCQkJCXJldCA9IFtdOwoKCQkJLy8gR28gdGhyb3VnaCB0aGUgYXJyYXksIHRyYW5zbGF0aW5nIGVhY2ggb2YgdGhlIGl0ZW1zIHRvIHRoZWlyIG5ldyB2YWx1ZXMKCQkJaWYgKCBpc0FycmF5TGlrZSggZWxlbXMgKSApIHsKCQkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aDsKCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJCXZhbHVlID0gY2FsbGJhY2soIGVsZW1zWyBpIF0sIGksIGFyZyApOwoKCQkJCQlpZiAoIHZhbHVlICE9IG51bGwgKSB7CgkJCQkJCXJldC5wdXNoKCB2YWx1ZSApOwoJCQkJCX0KCQkJCX0KCgkJCS8vIEdvIHRocm91Z2ggZXZlcnkga2V5IG9uIHRoZSBvYmplY3QsCgkJCX0gZWxzZSB7CgkJCQlmb3IgKCBpIGluIGVsZW1zICkgewoJCQkJCXZhbHVlID0gY2FsbGJhY2soIGVsZW1zWyBpIF0sIGksIGFyZyApOwoKCQkJCQlpZiAoIHZhbHVlICE9IG51bGwgKSB7CgkJCQkJCXJldC5wdXNoKCB2YWx1ZSApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gRmxhdHRlbiBhbnkgbmVzdGVkIGFycmF5cwoJCQlyZXR1cm4gY29uY2F0LmFwcGx5KCBbXSwgcmV0ICk7CgkJfSwKCgkJLy8gQSBnbG9iYWwgR1VJRCBjb3VudGVyIGZvciBvYmplY3RzCgkJZ3VpZDogMSwKCgkJLy8gQmluZCBhIGZ1bmN0aW9uIHRvIGEgY29udGV4dCwgb3B0aW9uYWxseSBwYXJ0aWFsbHkgYXBwbHlpbmcgYW55CgkJLy8gYXJndW1lbnRzLgoJCXByb3h5OiBmdW5jdGlvbiggZm4sIGNvbnRleHQgKSB7CgkJCXZhciBhcmdzLCBwcm94eSwgdG1wOwoKCQkJaWYgKCB0eXBlb2YgY29udGV4dCA9PT0gInN0cmluZyIgKSB7CgkJCQl0bXAgPSBmblsgY29udGV4dCBdOwoJCQkJY29udGV4dCA9IGZuOwoJCQkJZm4gPSB0bXA7CgkJCX0KCgkJCS8vIFF1aWNrIGNoZWNrIHRvIGRldGVybWluZSBpZiB0YXJnZXQgaXMgY2FsbGFibGUsIGluIHRoZSBzcGVjCgkJCS8vIHRoaXMgdGhyb3dzIGEgVHlwZUVycm9yLCBidXQgd2Ugd2lsbCBqdXN0IHJldHVybiB1bmRlZmluZWQuCgkJCWlmICggIWpRdWVyeS5pc0Z1bmN0aW9uKCBmbiApICkgewoJCQkJcmV0dXJuIHVuZGVmaW5lZDsKCQkJfQoKCQkJLy8gU2ltdWxhdGVkIGJpbmQKCQkJYXJncyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMiApOwoJCQlwcm94eSA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIGZuLmFwcGx5KCBjb250ZXh0IHx8IHRoaXMsIGFyZ3MuY29uY2F0KCBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSApICk7CgkJCX07CgoJCQkvLyBTZXQgdGhlIGd1aWQgb2YgdW5pcXVlIGhhbmRsZXIgdG8gdGhlIHNhbWUgb2Ygb3JpZ2luYWwgaGFuZGxlciwgc28gaXQgY2FuIGJlIHJlbW92ZWQKCQkJcHJveHkuZ3VpZCA9IGZuLmd1aWQgPSBmbi5ndWlkIHx8IGpRdWVyeS5ndWlkKys7CgoJCQlyZXR1cm4gcHJveHk7CgkJfSwKCgkJbm93OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuICsoIG5ldyBEYXRlKCkgKTsKCQl9LAoKCQkvLyBqUXVlcnkuc3VwcG9ydCBpcyBub3QgdXNlZCBpbiBDb3JlIGJ1dCBvdGhlciBwcm9qZWN0cyBhdHRhY2ggdGhlaXIKCQkvLyBwcm9wZXJ0aWVzIHRvIGl0IHNvIGl0IG5lZWRzIHRvIGV4aXN0LgoJCXN1cHBvcnQ6IHN1cHBvcnQKCX0gKTsKCgkvLyBKU0hpbnQgd291bGQgZXJyb3Igb24gdGhpcyBjb2RlIGR1ZSB0byB0aGUgU3ltYm9sIG5vdCBiZWluZyBkZWZpbmVkIGluIEVTNS4KCS8vIERlZmluaW5nIHRoaXMgZ2xvYmFsIGluIC5qc2hpbnRyYyB3b3VsZCBjcmVhdGUgYSBkYW5nZXIgb2YgdXNpbmcgdGhlIGdsb2JhbAoJLy8gdW5ndWFyZGVkIGluIGFub3RoZXIgcGxhY2UsIGl0IHNlZW1zIHNhZmVyIHRvIGp1c3QgZGlzYWJsZSBKU0hpbnQgZm9yIHRoZXNlCgkvLyB0aHJlZSBsaW5lcy4KCS8qIGpzaGludCBpZ25vcmU6IHN0YXJ0ICovCglpZiAoIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgKSB7CgkJalF1ZXJ5LmZuWyBTeW1ib2wuaXRlcmF0b3IgXSA9IGRlbGV0ZWRJZHNbIFN5bWJvbC5pdGVyYXRvciBdOwoJfQoJLyoganNoaW50IGlnbm9yZTogZW5kICovCgoJLy8gUG9wdWxhdGUgdGhlIGNsYXNzMnR5cGUgbWFwCglqUXVlcnkuZWFjaCggIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCggIiAiICksCglmdW5jdGlvbiggaSwgbmFtZSApIHsKCQljbGFzczJ0eXBlWyAiW29iamVjdCAiICsgbmFtZSArICJdIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpOwoJfSApOwoKCWZ1bmN0aW9uIGlzQXJyYXlMaWtlKCBvYmogKSB7CgoJCS8vIFN1cHBvcnQ6IGlPUyA4LjIgKG5vdCByZXByb2R1Y2libGUgaW4gc2ltdWxhdG9yKQoJCS8vIGBpbmAgY2hlY2sgdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMjE0NSkKCQkvLyBoYXNPd24gaXNuJ3QgdXNlZCBoZXJlIGR1ZSB0byBmYWxzZSBuZWdhdGl2ZXMKCQkvLyByZWdhcmRpbmcgTm9kZWxpc3QgbGVuZ3RoIGluIElFCgkJdmFyIGxlbmd0aCA9ICEhb2JqICYmICJsZW5ndGgiIGluIG9iaiAmJiBvYmoubGVuZ3RoLAoJCQl0eXBlID0galF1ZXJ5LnR5cGUoIG9iaiApOwoKCQlpZiAoIHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJcmV0dXJuIHR5cGUgPT09ICJhcnJheSIgfHwgbGVuZ3RoID09PSAwIHx8CgkJCXR5cGVvZiBsZW5ndGggPT09ICJudW1iZXIiICYmIGxlbmd0aCA+IDAgJiYgKCBsZW5ndGggLSAxICkgaW4gb2JqOwoJfQoJdmFyIFNpenpsZSA9CgkvKiEKCSAqIFNpenpsZSBDU1MgU2VsZWN0b3IgRW5naW5lIHYyLjIuMQoJICogaHR0cDovL3NpenpsZWpzLmNvbS8KCSAqCgkgKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycwoJICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlCgkgKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCgkgKgoJICogRGF0ZTogMjAxNS0xMC0xNwoJICovCgkoZnVuY3Rpb24oIHdpbmRvdyApIHsKCgl2YXIgaSwKCQlzdXBwb3J0LAoJCUV4cHIsCgkJZ2V0VGV4dCwKCQlpc1hNTCwKCQl0b2tlbml6ZSwKCQljb21waWxlLAoJCXNlbGVjdCwKCQlvdXRlcm1vc3RDb250ZXh0LAoJCXNvcnRJbnB1dCwKCQloYXNEdXBsaWNhdGUsCgoJCS8vIExvY2FsIGRvY3VtZW50IHZhcnMKCQlzZXREb2N1bWVudCwKCQlkb2N1bWVudCwKCQlkb2NFbGVtLAoJCWRvY3VtZW50SXNIVE1MLAoJCXJidWdneVFTQSwKCQlyYnVnZ3lNYXRjaGVzLAoJCW1hdGNoZXMsCgkJY29udGFpbnMsCgoJCS8vIEluc3RhbmNlLXNwZWNpZmljIGRhdGEKCQlleHBhbmRvID0gInNpenpsZSIgKyAxICogbmV3IERhdGUoKSwKCQlwcmVmZXJyZWREb2MgPSB3aW5kb3cuZG9jdW1lbnQsCgkJZGlycnVucyA9IDAsCgkJZG9uZSA9IDAsCgkJY2xhc3NDYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgkJdG9rZW5DYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgkJY29tcGlsZXJDYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgkJc29ydE9yZGVyID0gZnVuY3Rpb24oIGEsIGIgKSB7CgkJCWlmICggYSA9PT0gYiApIHsKCQkJCWhhc0R1cGxpY2F0ZSA9IHRydWU7CgkJCX0KCQkJcmV0dXJuIDA7CgkJfSwKCgkJLy8gR2VuZXJhbC1wdXJwb3NlIGNvbnN0YW50cwoJCU1BWF9ORUdBVElWRSA9IDEgPDwgMzEsCgoJCS8vIEluc3RhbmNlIG1ldGhvZHMKCQloYXNPd24gPSAoe30pLmhhc093blByb3BlcnR5LAoJCWFyciA9IFtdLAoJCXBvcCA9IGFyci5wb3AsCgkJcHVzaF9uYXRpdmUgPSBhcnIucHVzaCwKCQlwdXNoID0gYXJyLnB1c2gsCgkJc2xpY2UgPSBhcnIuc2xpY2UsCgkJLy8gVXNlIGEgc3RyaXBwZWQtZG93biBpbmRleE9mIGFzIGl0J3MgZmFzdGVyIHRoYW4gbmF0aXZlCgkJLy8gaHR0cDovL2pzcGVyZi5jb20vdGhvci1pbmRleG9mLXZzLWZvci81CgkJaW5kZXhPZiA9IGZ1bmN0aW9uKCBsaXN0LCBlbGVtICkgewoJCQl2YXIgaSA9IDAsCgkJCQlsZW4gPSBsaXN0Lmxlbmd0aDsKCQkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCQlpZiAoIGxpc3RbaV0gPT09IGVsZW0gKSB7CgkJCQkJcmV0dXJuIGk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIC0xOwoJCX0sCgoJCWJvb2xlYW5zID0gImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkIiwKCgkJLy8gUmVndWxhciBleHByZXNzaW9ucwoKCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jd2hpdGVzcGFjZQoJCXdoaXRlc3BhY2UgPSAiW1xceDIwXFx0XFxyXFxuXFxmXSIsCgoJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCN2YWx1ZS1kZWYtaWRlbnRpZmllcgoJCWlkZW50aWZpZXIgPSAiKD86XFxcXC58W1xcdy1dfFteXFx4MDAtXFx4YTBdKSsiLAoKCQkvLyBBdHRyaWJ1dGUgc2VsZWN0b3JzOiBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2F0dHJpYnV0ZS1zZWxlY3RvcnMKCQlhdHRyaWJ1dGVzID0gIlxcWyIgKyB3aGl0ZXNwYWNlICsgIiooIiArIGlkZW50aWZpZXIgKyAiKSg/OiIgKyB3aGl0ZXNwYWNlICsKCQkJLy8gT3BlcmF0b3IgKGNhcHR1cmUgMikKCQkJIiooWypeJHwhfl0/PSkiICsgd2hpdGVzcGFjZSArCgkJCS8vICJBdHRyaWJ1dGUgdmFsdWVzIG11c3QgYmUgQ1NTIGlkZW50aWZpZXJzIFtjYXB0dXJlIDVdIG9yIHN0cmluZ3MgW2NhcHR1cmUgMyBvciBjYXB0dXJlIDRdIgoJCQkiKig/OicoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwifCgiICsgaWRlbnRpZmllciArICIpKXwpIiArIHdoaXRlc3BhY2UgKwoJCQkiKlxcXSIsCgoJCXBzZXVkb3MgPSAiOigiICsgaWRlbnRpZmllciArICIpKD86XFwoKCIgKwoJCQkvLyBUbyByZWR1Y2UgdGhlIG51bWJlciBvZiBzZWxlY3RvcnMgbmVlZGluZyB0b2tlbml6ZSBpbiB0aGUgcHJlRmlsdGVyLCBwcmVmZXIgYXJndW1lbnRzOgoJCQkvLyAxLiBxdW90ZWQgKGNhcHR1cmUgMzsgY2FwdHVyZSA0IG9yIGNhcHR1cmUgNSkKCQkJIignKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8IiArCgkJCS8vIDIuIHNpbXBsZSAoY2FwdHVyZSA2KQoJCQkiKCg/OlxcXFwufFteXFxcXCgpW1xcXV18IiArIGF0dHJpYnV0ZXMgKyAiKSopfCIgKwoJCQkvLyAzLiBhbnl0aGluZyBlbHNlIChjYXB0dXJlIDIpCgkJCSIuKiIgKwoJCQkiKVxcKXwpIiwKCgkJLy8gTGVhZGluZyBhbmQgbm9uLWVzY2FwZWQgdHJhaWxpbmcgd2hpdGVzcGFjZSwgY2FwdHVyaW5nIHNvbWUgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBwcmVjZWRpbmcgdGhlIGxhdHRlcgoJCXJ3aGl0ZXNwYWNlID0gbmV3IFJlZ0V4cCggd2hpdGVzcGFjZSArICIrIiwgImciICksCgkJcnRyaW0gPSBuZXcgUmVnRXhwKCAiXiIgKyB3aGl0ZXNwYWNlICsgIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIgKyB3aGl0ZXNwYWNlICsgIiskIiwgImciICksCgoJCXJjb21tYSA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKiwiICsgd2hpdGVzcGFjZSArICIqIiApLAoJCXJjb21iaW5hdG9ycyA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKihbPit+XXwiICsgd2hpdGVzcGFjZSArICIpIiArIHdoaXRlc3BhY2UgKyAiKiIgKSwKCgkJcmF0dHJpYnV0ZVF1b3RlcyA9IG5ldyBSZWdFeHAoICI9IiArIHdoaXRlc3BhY2UgKyAiKihbXlxcXSdcIl0qPykiICsgd2hpdGVzcGFjZSArICIqXFxdIiwgImciICksCgoJCXJwc2V1ZG8gPSBuZXcgUmVnRXhwKCBwc2V1ZG9zICksCgkJcmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCAiXiIgKyBpZGVudGlmaWVyICsgIiQiICksCgoJCW1hdGNoRXhwciA9IHsKCQkJIklEIjogbmV3IFJlZ0V4cCggIl4jKCIgKyBpZGVudGlmaWVyICsgIikiICksCgkJCSJDTEFTUyI6IG5ldyBSZWdFeHAoICJeXFwuKCIgKyBpZGVudGlmaWVyICsgIikiICksCgkJCSJUQUciOiBuZXcgUmVnRXhwKCAiXigiICsgaWRlbnRpZmllciArICJ8WypdKSIgKSwKCQkJIkFUVFIiOiBuZXcgUmVnRXhwKCAiXiIgKyBhdHRyaWJ1dGVzICksCgkJCSJQU0VVRE8iOiBuZXcgUmVnRXhwKCAiXiIgKyBwc2V1ZG9zICksCgkJCSJDSElMRCI6IG5ldyBSZWdFeHAoICJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiICsgd2hpdGVzcGFjZSArCgkJCQkiKihldmVufG9kZHwoKFsrLV18KShcXGQqKW58KSIgKyB3aGl0ZXNwYWNlICsgIiooPzooWystXXwpIiArIHdoaXRlc3BhY2UgKwoJCQkJIiooXFxkKyl8KSkiICsgd2hpdGVzcGFjZSArICIqXFwpfCkiLCAiaSIgKSwKCQkJImJvb2wiOiBuZXcgUmVnRXhwKCAiXig/OiIgKyBib29sZWFucyArICIpJCIsICJpIiApLAoJCQkvLyBGb3IgdXNlIGluIGxpYnJhcmllcyBpbXBsZW1lbnRpbmcgLmlzKCkKCQkJLy8gV2UgdXNlIHRoaXMgZm9yIFBPUyBtYXRjaGluZyBpbiBgc2VsZWN0YAoJCQkibmVlZHNDb250ZXh0IjogbmV3IFJlZ0V4cCggIl4iICsgd2hpdGVzcGFjZSArICIqWz4rfl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiICsKCQkJCXdoaXRlc3BhY2UgKyAiKigoPzotXFxkKT9cXGQqKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSg/PVteLV18JCkiLCAiaSIgKQoJCX0sCgoJCXJpbnB1dHMgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLAoJCXJoZWFkZXIgPSAvXmhcZCQvaSwKCgkJcm5hdGl2ZSA9IC9eW157XStce1xzKlxbbmF0aXZlIFx3LywKCgkJLy8gRWFzaWx5LXBhcnNlYWJsZS9yZXRyaWV2YWJsZSBJRCBvciBUQUcgb3IgQ0xBU1Mgc2VsZWN0b3JzCgkJcnF1aWNrRXhwciA9IC9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sCgoJCXJzaWJsaW5nID0gL1srfl0vLAoJCXJlc2NhcGUgPSAvJ3xcXC9nLAoKCQkvLyBDU1MgZXNjYXBlcyBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjZXNjYXBlZC1jaGFyYWN0ZXJzCgkJcnVuZXNjYXBlID0gbmV3IFJlZ0V4cCggIlxcXFwoW1xcZGEtZl17MSw2fSIgKyB3aGl0ZXNwYWNlICsgIj98KCIgKyB3aGl0ZXNwYWNlICsgIil8LikiLCAiaWciICksCgkJZnVuZXNjYXBlID0gZnVuY3Rpb24oIF8sIGVzY2FwZWQsIGVzY2FwZWRXaGl0ZXNwYWNlICkgewoJCQl2YXIgaGlnaCA9ICIweCIgKyBlc2NhcGVkIC0gMHgxMDAwMDsKCQkJLy8gTmFOIG1lYW5zIG5vbi1jb2RlcG9pbnQKCQkJLy8gU3VwcG9ydDogRmlyZWZveDwyNAoJCQkvLyBXb3JrYXJvdW5kIGVycm9uZW91cyBudW1lcmljIGludGVycHJldGF0aW9uIG9mICsiMHgiCgkJCXJldHVybiBoaWdoICE9PSBoaWdoIHx8IGVzY2FwZWRXaGl0ZXNwYWNlID8KCQkJCWVzY2FwZWQgOgoJCQkJaGlnaCA8IDAgPwoJCQkJCS8vIEJNUCBjb2RlcG9pbnQKCQkJCQlTdHJpbmcuZnJvbUNoYXJDb2RlKCBoaWdoICsgMHgxMDAwMCApIDoKCQkJCQkvLyBTdXBwbGVtZW50YWwgUGxhbmUgY29kZXBvaW50IChzdXJyb2dhdGUgcGFpcikKCQkJCQlTdHJpbmcuZnJvbUNoYXJDb2RlKCBoaWdoID4+IDEwIHwgMHhEODAwLCBoaWdoICYgMHgzRkYgfCAweERDMDAgKTsKCQl9LAoKCQkvLyBVc2VkIGZvciBpZnJhbWVzCgkJLy8gU2VlIHNldERvY3VtZW50KCkKCQkvLyBSZW1vdmluZyB0aGUgZnVuY3Rpb24gd3JhcHBlciBjYXVzZXMgYSAiUGVybWlzc2lvbiBEZW5pZWQiCgkJLy8gZXJyb3IgaW4gSUUKCQl1bmxvYWRIYW5kbGVyID0gZnVuY3Rpb24oKSB7CgkJCXNldERvY3VtZW50KCk7CgkJfTsKCgkvLyBPcHRpbWl6ZSBmb3IgcHVzaC5hcHBseSggXywgTm9kZUxpc3QgKQoJdHJ5IHsKCQlwdXNoLmFwcGx5KAoJCQkoYXJyID0gc2xpY2UuY2FsbCggcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMgKSksCgkJCXByZWZlcnJlZERvYy5jaGlsZE5vZGVzCgkJKTsKCQkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMAoJCS8vIERldGVjdCBzaWxlbnRseSBmYWlsaW5nIHB1c2guYXBwbHkKCQlhcnJbIHByZWZlcnJlZERvYy5jaGlsZE5vZGVzLmxlbmd0aCBdLm5vZGVUeXBlOwoJfSBjYXRjaCAoIGUgKSB7CgkJcHVzaCA9IHsgYXBwbHk6IGFyci5sZW5ndGggPwoKCQkJLy8gTGV2ZXJhZ2Ugc2xpY2UgaWYgcG9zc2libGUKCQkJZnVuY3Rpb24oIHRhcmdldCwgZWxzICkgewoJCQkJcHVzaF9uYXRpdmUuYXBwbHkoIHRhcmdldCwgc2xpY2UuY2FsbChlbHMpICk7CgkJCX0gOgoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBPdGhlcndpc2UgYXBwZW5kIGRpcmVjdGx5CgkJCWZ1bmN0aW9uKCB0YXJnZXQsIGVscyApIHsKCQkJCXZhciBqID0gdGFyZ2V0Lmxlbmd0aCwKCQkJCQlpID0gMDsKCQkJCS8vIENhbid0IHRydXN0IE5vZGVMaXN0Lmxlbmd0aAoJCQkJd2hpbGUgKCAodGFyZ2V0W2orK10gPSBlbHNbaSsrXSkgKSB7fQoJCQkJdGFyZ2V0Lmxlbmd0aCA9IGogLSAxOwoJCQl9CgkJfTsKCX0KCglmdW5jdGlvbiBTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICkgewoJCXZhciBtLCBpLCBlbGVtLCBuaWQsIG5pZHNlbGVjdCwgbWF0Y2gsIGdyb3VwcywgbmV3U2VsZWN0b3IsCgkJCW5ld0NvbnRleHQgPSBjb250ZXh0ICYmIGNvbnRleHQub3duZXJEb2N1bWVudCwKCgkJCS8vIG5vZGVUeXBlIGRlZmF1bHRzIHRvIDksIHNpbmNlIGNvbnRleHQgZGVmYXVsdHMgdG8gZG9jdW1lbnQKCQkJbm9kZVR5cGUgPSBjb250ZXh0ID8gY29udGV4dC5ub2RlVHlwZSA6IDk7CgoJCXJlc3VsdHMgPSByZXN1bHRzIHx8IFtdOwoKCQkvLyBSZXR1cm4gZWFybHkgZnJvbSBjYWxscyB3aXRoIGludmFsaWQgc2VsZWN0b3Igb3IgY29udGV4dAoJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiB8fCAhc2VsZWN0b3IgfHwKCQkJbm9kZVR5cGUgIT09IDEgJiYgbm9kZVR5cGUgIT09IDkgJiYgbm9kZVR5cGUgIT09IDExICkgewoKCQkJcmV0dXJuIHJlc3VsdHM7CgkJfQoKCQkvLyBUcnkgdG8gc2hvcnRjdXQgZmluZCBvcGVyYXRpb25zIChhcyBvcHBvc2VkIHRvIGZpbHRlcnMpIGluIEhUTUwgZG9jdW1lbnRzCgkJaWYgKCAhc2VlZCApIHsKCgkJCWlmICggKCBjb250ZXh0ID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBwcmVmZXJyZWREb2MgKSAhPT0gZG9jdW1lbnQgKSB7CgkJCQlzZXREb2N1bWVudCggY29udGV4dCApOwoJCQl9CgkJCWNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50OwoKCQkJaWYgKCBkb2N1bWVudElzSFRNTCApIHsKCgkJCQkvLyBJZiB0aGUgc2VsZWN0b3IgaXMgc3VmZmljaWVudGx5IHNpbXBsZSwgdHJ5IHVzaW5nIGEgImdldCpCeSoiIERPTSBtZXRob2QKCQkJCS8vIChleGNlcHRpbmcgRG9jdW1lbnRGcmFnbWVudCBjb250ZXh0LCB3aGVyZSB0aGUgbWV0aG9kcyBkb24ndCBleGlzdCkKCQkJCWlmICggbm9kZVR5cGUgIT09IDExICYmIChtYXRjaCA9IHJxdWlja0V4cHIuZXhlYyggc2VsZWN0b3IgKSkgKSB7CgoJCQkJCS8vIElEIHNlbGVjdG9yCgkJCQkJaWYgKCAobSA9IG1hdGNoWzFdKSApIHsKCgkJCQkJCS8vIERvY3VtZW50IGNvbnRleHQKCQkJCQkJaWYgKCBub2RlVHlwZSA9PT0gOSApIHsKCQkJCQkJCWlmICggKGVsZW0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBtICkpICkgewoKCQkJCQkJCQkvLyBTdXBwb3J0OiBJRSwgT3BlcmEsIFdlYmtpdAoJCQkJCQkJCS8vIFRPRE86IGlkZW50aWZ5IHZlcnNpb25zCgkJCQkJCQkJLy8gZ2V0RWxlbWVudEJ5SWQgY2FuIG1hdGNoIGVsZW1lbnRzIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAoJCQkJCQkJCWlmICggZWxlbS5pZCA9PT0gbSApIHsKCQkJCQkJCQkJcmVzdWx0cy5wdXNoKCBlbGVtICk7CgkJCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCQl9CgoJCQkJCQkvLyBFbGVtZW50IGNvbnRleHQKCQkJCQkJfSBlbHNlIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRSwgT3BlcmEsIFdlYmtpdAoJCQkJCQkJLy8gVE9ETzogaWRlbnRpZnkgdmVyc2lvbnMKCQkJCQkJCS8vIGdldEVsZW1lbnRCeUlkIGNhbiBtYXRjaCBlbGVtZW50cyBieSBuYW1lIGluc3RlYWQgb2YgSUQKCQkJCQkJCWlmICggbmV3Q29udGV4dCAmJiAoZWxlbSA9IG5ld0NvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIG0gKSkgJiYKCQkJCQkJCQljb250YWlucyggY29udGV4dCwgZWxlbSApICYmCgkJCQkJCQkJZWxlbS5pZCA9PT0gbSApIHsKCgkJCQkJCQkJcmVzdWx0cy5wdXNoKCBlbGVtICk7CgkJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJLy8gVHlwZSBzZWxlY3RvcgoJCQkJCX0gZWxzZSBpZiAoIG1hdGNoWzJdICkgewoJCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCBzZWxlY3RvciApICk7CgkJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCQkvLyBDbGFzcyBzZWxlY3RvcgoJCQkJCX0gZWxzZSBpZiAoIChtID0gbWF0Y2hbM10pICYmIHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJgoJCQkJCQljb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKSB7CgoJCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIG0gKSApOwoJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gVGFrZSBhZHZhbnRhZ2Ugb2YgcXVlcnlTZWxlY3RvckFsbAoJCQkJaWYgKCBzdXBwb3J0LnFzYSAmJgoJCQkJCSFjb21waWxlckNhY2hlWyBzZWxlY3RvciArICIgIiBdICYmCgkJCQkJKCFyYnVnZ3lRU0EgfHwgIXJidWdneVFTQS50ZXN0KCBzZWxlY3RvciApKSApIHsKCgkJCQkJaWYgKCBub2RlVHlwZSAhPT0gMSApIHsKCQkJCQkJbmV3Q29udGV4dCA9IGNvbnRleHQ7CgkJCQkJCW5ld1NlbGVjdG9yID0gc2VsZWN0b3I7CgoJCQkJCS8vIHFTQSBsb29rcyBvdXRzaWRlIEVsZW1lbnQgY29udGV4dCwgd2hpY2ggaXMgbm90IHdoYXQgd2Ugd2FudAoJCQkJCS8vIFRoYW5rcyB0byBBbmRyZXcgRHVwb250IGZvciB0aGlzIHdvcmthcm91bmQgdGVjaG5pcXVlCgkJCQkJLy8gU3VwcG9ydDogSUUgPD04CgkJCQkJLy8gRXhjbHVkZSBvYmplY3QgZWxlbWVudHMKCQkJCQl9IGVsc2UgaWYgKCBjb250ZXh0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICJvYmplY3QiICkgewoKCQkJCQkJLy8gQ2FwdHVyZSB0aGUgY29udGV4dCBJRCwgc2V0dGluZyBpdCBmaXJzdCBpZiBuZWNlc3NhcnkKCQkJCQkJaWYgKCAobmlkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoICJpZCIgKSkgKSB7CgkJCQkJCQluaWQgPSBuaWQucmVwbGFjZSggcmVzY2FwZSwgIlxcJCYiICk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb250ZXh0LnNldEF0dHJpYnV0ZSggImlkIiwgKG5pZCA9IGV4cGFuZG8pICk7CgkJCQkJCX0KCgkJCQkJCS8vIFByZWZpeCBldmVyeSBzZWxlY3RvciBpbiB0aGUgbGlzdAoJCQkJCQlncm91cHMgPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCQkJCQkJaSA9IGdyb3Vwcy5sZW5ndGg7CgkJCQkJCW5pZHNlbGVjdCA9IHJpZGVudGlmaWVyLnRlc3QoIG5pZCApID8gIiMiICsgbmlkIDogIltpZD0nIiArIG5pZCArICInXSI7CgkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJZ3JvdXBzW2ldID0gbmlkc2VsZWN0ICsgIiAiICsgdG9TZWxlY3RvciggZ3JvdXBzW2ldICk7CgkJCQkJCX0KCQkJCQkJbmV3U2VsZWN0b3IgPSBncm91cHMuam9pbiggIiwiICk7CgoJCQkJCQkvLyBFeHBhbmQgY29udGV4dCBmb3Igc2libGluZyBzZWxlY3RvcnMKCQkJCQkJbmV3Q29udGV4dCA9IHJzaWJsaW5nLnRlc3QoIHNlbGVjdG9yICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8CgkJCQkJCQljb250ZXh0OwoJCQkJCX0KCgkJCQkJaWYgKCBuZXdTZWxlY3RvciApIHsKCQkJCQkJdHJ5IHsKCQkJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsCgkJCQkJCQkJbmV3Q29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKCBuZXdTZWxlY3RvciApCgkJCQkJCQkpOwoJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCX0gY2F0Y2ggKCBxc2FFcnJvciApIHsKCQkJCQkJfSBmaW5hbGx5IHsKCQkJCQkJCWlmICggbmlkID09PSBleHBhbmRvICkgewoJCQkJCQkJCWNvbnRleHQucmVtb3ZlQXR0cmlidXRlKCAiaWQiICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIEFsbCBvdGhlcnMKCQlyZXR1cm4gc2VsZWN0KCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgIiQxIiApLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICk7Cgl9CgoJLyoqCgkgKiBDcmVhdGUga2V5LXZhbHVlIGNhY2hlcyBvZiBsaW1pdGVkIHNpemUKCSAqIEByZXR1cm5zIHtmdW5jdGlvbihzdHJpbmcsIG9iamVjdCl9IFJldHVybnMgdGhlIE9iamVjdCBkYXRhIGFmdGVyIHN0b3JpbmcgaXQgb24gaXRzZWxmIHdpdGgKCSAqCXByb3BlcnR5IG5hbWUgdGhlIChzcGFjZS1zdWZmaXhlZCkgc3RyaW5nIGFuZCAoaWYgdGhlIGNhY2hlIGlzIGxhcmdlciB0aGFuIEV4cHIuY2FjaGVMZW5ndGgpCgkgKglkZWxldGluZyB0aGUgb2xkZXN0IGVudHJ5CgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkgewoJCXZhciBrZXlzID0gW107CgoJCWZ1bmN0aW9uIGNhY2hlKCBrZXksIHZhbHVlICkgewoJCQkvLyBVc2UgKGtleSArICIgIikgdG8gYXZvaWQgY29sbGlzaW9uIHdpdGggbmF0aXZlIHByb3RvdHlwZSBwcm9wZXJ0aWVzIChzZWUgSXNzdWUgIzE1NykKCQkJaWYgKCBrZXlzLnB1c2goIGtleSArICIgIiApID4gRXhwci5jYWNoZUxlbmd0aCApIHsKCQkJCS8vIE9ubHkga2VlcCB0aGUgbW9zdCByZWNlbnQgZW50cmllcwoJCQkJZGVsZXRlIGNhY2hlWyBrZXlzLnNoaWZ0KCkgXTsKCQkJfQoJCQlyZXR1cm4gKGNhY2hlWyBrZXkgKyAiICIgXSA9IHZhbHVlKTsKCQl9CgkJcmV0dXJuIGNhY2hlOwoJfQoKCS8qKgoJICogTWFyayBhIGZ1bmN0aW9uIGZvciBzcGVjaWFsIHVzZSBieSBTaXp6bGUKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBtYXJrCgkgKi8KCWZ1bmN0aW9uIG1hcmtGdW5jdGlvbiggZm4gKSB7CgkJZm5bIGV4cGFuZG8gXSA9IHRydWU7CgkJcmV0dXJuIGZuOwoJfQoKCS8qKgoJICogU3VwcG9ydCB0ZXN0aW5nIHVzaW5nIGFuIGVsZW1lbnQKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFBhc3NlZCB0aGUgY3JlYXRlZCBkaXYgYW5kIGV4cGVjdHMgYSBib29sZWFuIHJlc3VsdAoJICovCglmdW5jdGlvbiBhc3NlcnQoIGZuICkgewoJCXZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKCgkJdHJ5IHsKCQkJcmV0dXJuICEhZm4oIGRpdiApOwoJCX0gY2F0Y2ggKGUpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0gZmluYWxseSB7CgkJCS8vIFJlbW92ZSBmcm9tIGl0cyBwYXJlbnQgYnkgZGVmYXVsdAoJCQlpZiAoIGRpdi5wYXJlbnROb2RlICkgewoJCQkJZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGRpdiApOwoJCQl9CgkJCS8vIHJlbGVhc2UgbWVtb3J5IGluIElFCgkJCWRpdiA9IG51bGw7CgkJfQoJfQoKCS8qKgoJICogQWRkcyB0aGUgc2FtZSBoYW5kbGVyIGZvciBhbGwgb2YgdGhlIHNwZWNpZmllZCBhdHRycwoJICogQHBhcmFtIHtTdHJpbmd9IGF0dHJzIFBpcGUtc2VwYXJhdGVkIGxpc3Qgb2YgYXR0cmlidXRlcwoJICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciBUaGUgbWV0aG9kIHRoYXQgd2lsbCBiZSBhcHBsaWVkCgkgKi8KCWZ1bmN0aW9uIGFkZEhhbmRsZSggYXR0cnMsIGhhbmRsZXIgKSB7CgkJdmFyIGFyciA9IGF0dHJzLnNwbGl0KCJ8IiksCgkJCWkgPSBhcnIubGVuZ3RoOwoKCQl3aGlsZSAoIGktLSApIHsKCQkJRXhwci5hdHRySGFuZGxlWyBhcnJbaV0gXSA9IGhhbmRsZXI7CgkJfQoJfQoKCS8qKgoJICogQ2hlY2tzIGRvY3VtZW50IG9yZGVyIG9mIHR3byBzaWJsaW5ncwoJICogQHBhcmFtIHtFbGVtZW50fSBhCgkgKiBAcGFyYW0ge0VsZW1lbnR9IGIKCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgbGVzcyB0aGFuIDAgaWYgYSBwcmVjZWRlcyBiLCBncmVhdGVyIHRoYW4gMCBpZiBhIGZvbGxvd3MgYgoJICovCglmdW5jdGlvbiBzaWJsaW5nQ2hlY2soIGEsIGIgKSB7CgkJdmFyIGN1ciA9IGIgJiYgYSwKCQkJZGlmZiA9IGN1ciAmJiBhLm5vZGVUeXBlID09PSAxICYmIGIubm9kZVR5cGUgPT09IDEgJiYKCQkJCSggfmIuc291cmNlSW5kZXggfHwgTUFYX05FR0FUSVZFICkgLQoJCQkJKCB+YS5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKTsKCgkJLy8gVXNlIElFIHNvdXJjZUluZGV4IGlmIGF2YWlsYWJsZSBvbiBib3RoIG5vZGVzCgkJaWYgKCBkaWZmICkgewoJCQlyZXR1cm4gZGlmZjsKCQl9CgoJCS8vIENoZWNrIGlmIGIgZm9sbG93cyBhCgkJaWYgKCBjdXIgKSB7CgkJCXdoaWxlICggKGN1ciA9IGN1ci5uZXh0U2libGluZykgKSB7CgkJCQlpZiAoIGN1ciA9PT0gYiApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBhID8gMSA6IC0xOwoJfQoKCS8qKgoJICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBpbnB1dCB0eXBlcwoJICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKCSAqLwoJZnVuY3Rpb24gY3JlYXRlSW5wdXRQc2V1ZG8oIHR5cGUgKSB7CgkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQl2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCQkJcmV0dXJuIG5hbWUgPT09ICJpbnB1dCIgJiYgZWxlbS50eXBlID09PSB0eXBlOwoJCX07Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGJ1dHRvbnMKCSAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlCgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZUJ1dHRvblBzZXVkbyggdHlwZSApIHsKCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmIGVsZW0udHlwZSA9PT0gdHlwZTsKCQl9OwoJfQoKCS8qKgoJICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBwb3NpdGlvbmFscwoJICogQHBhcmFtIHtGdW5jdGlvbn0gZm4KCSAqLwoJZnVuY3Rpb24gY3JlYXRlUG9zaXRpb25hbFBzZXVkbyggZm4gKSB7CgkJcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiggYXJndW1lbnQgKSB7CgkJCWFyZ3VtZW50ID0gK2FyZ3VtZW50OwoJCQlyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzICkgewoJCQkJdmFyIGosCgkJCQkJbWF0Y2hJbmRleGVzID0gZm4oIFtdLCBzZWVkLmxlbmd0aCwgYXJndW1lbnQgKSwKCQkJCQlpID0gbWF0Y2hJbmRleGVzLmxlbmd0aDsKCgkJCQkvLyBNYXRjaCBlbGVtZW50cyBmb3VuZCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4ZXMKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggc2VlZFsgKGogPSBtYXRjaEluZGV4ZXNbaV0pIF0gKSB7CgkJCQkJCXNlZWRbal0gPSAhKG1hdGNoZXNbal0gPSBzZWVkW2pdKTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCX0pOwoJfQoKCS8qKgoJICogQ2hlY2tzIGEgbm9kZSBmb3IgdmFsaWRpdHkgYXMgYSBTaXp6bGUgY29udGV4dAoJICogQHBhcmFtIHtFbGVtZW50fE9iamVjdD19IGNvbnRleHQKCSAqIEByZXR1cm5zIHtFbGVtZW50fE9iamVjdHxCb29sZWFufSBUaGUgaW5wdXQgbm9kZSBpZiBhY2NlcHRhYmxlLCBvdGhlcndpc2UgYSBmYWxzeSB2YWx1ZQoJICovCglmdW5jdGlvbiB0ZXN0Q29udGV4dCggY29udGV4dCApIHsKCQlyZXR1cm4gY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgJiYgY29udGV4dDsKCX0KCgkvLyBFeHBvc2Ugc3VwcG9ydCB2YXJzIGZvciBjb252ZW5pZW5jZQoJc3VwcG9ydCA9IFNpenpsZS5zdXBwb3J0ID0ge307CgoJLyoqCgkgKiBEZXRlY3RzIFhNTCBub2RlcwoJICogQHBhcmFtIHtFbGVtZW50fE9iamVjdH0gZWxlbSBBbiBlbGVtZW50IG9yIGEgZG9jdW1lbnQKCSAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmZiBlbGVtIGlzIGEgbm9uLUhUTUwgWE1MIG5vZGUKCSAqLwoJaXNYTUwgPSBTaXp6bGUuaXNYTUwgPSBmdW5jdGlvbiggZWxlbSApIHsKCQkvLyBkb2N1bWVudEVsZW1lbnQgaXMgdmVyaWZpZWQgZm9yIGNhc2VzIHdoZXJlIGl0IGRvZXNuJ3QgeWV0IGV4aXN0CgkJLy8gKHN1Y2ggYXMgbG9hZGluZyBpZnJhbWVzIGluIElFIC0gIzQ4MzMpCgkJdmFyIGRvY3VtZW50RWxlbWVudCA9IGVsZW0gJiYgKGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtKS5kb2N1bWVudEVsZW1lbnQ7CgkJcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhUTUwiIDogZmFsc2U7Cgl9OwoKCS8qKgoJICogU2V0cyBkb2N1bWVudC1yZWxhdGVkIHZhcmlhYmxlcyBvbmNlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGRvY3VtZW50CgkgKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBbZG9jXSBBbiBlbGVtZW50IG9yIGRvY3VtZW50IG9iamVjdCB0byB1c2UgdG8gc2V0IHRoZSBkb2N1bWVudAoJICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY3VycmVudCBkb2N1bWVudAoJICovCglzZXREb2N1bWVudCA9IFNpenpsZS5zZXREb2N1bWVudCA9IGZ1bmN0aW9uKCBub2RlICkgewoJCXZhciBoYXNDb21wYXJlLCBwYXJlbnQsCgkJCWRvYyA9IG5vZGUgPyBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSA6IHByZWZlcnJlZERvYzsKCgkJLy8gUmV0dXJuIGVhcmx5IGlmIGRvYyBpcyBpbnZhbGlkIG9yIGFscmVhZHkgc2VsZWN0ZWQKCQlpZiAoIGRvYyA9PT0gZG9jdW1lbnQgfHwgZG9jLm5vZGVUeXBlICE9PSA5IHx8ICFkb2MuZG9jdW1lbnRFbGVtZW50ICkgewoJCQlyZXR1cm4gZG9jdW1lbnQ7CgkJfQoKCQkvLyBVcGRhdGUgZ2xvYmFsIHZhcmlhYmxlcwoJCWRvY3VtZW50ID0gZG9jOwoJCWRvY0VsZW0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgkJZG9jdW1lbnRJc0hUTUwgPSAhaXNYTUwoIGRvY3VtZW50ICk7CgoJCS8vIFN1cHBvcnQ6IElFIDktMTEsIEVkZ2UKCQkvLyBBY2Nlc3NpbmcgaWZyYW1lIGRvY3VtZW50cyBhZnRlciB1bmxvYWQgdGhyb3dzICJwZXJtaXNzaW9uIGRlbmllZCIgZXJyb3JzIChqUXVlcnkgIzEzOTM2KQoJCWlmICggKHBhcmVudCA9IGRvY3VtZW50LmRlZmF1bHRWaWV3KSAmJiBwYXJlbnQudG9wICE9PSBwYXJlbnQgKSB7CgkJCS8vIFN1cHBvcnQ6IElFIDExCgkJCWlmICggcGFyZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQlwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciggInVubG9hZCIsIHVubG9hZEhhbmRsZXIsIGZhbHNlICk7CgoJCQkvLyBTdXBwb3J0OiBJRSA5IC0gMTAgb25seQoJCQl9IGVsc2UgaWYgKCBwYXJlbnQuYXR0YWNoRXZlbnQgKSB7CgkJCQlwYXJlbnQuYXR0YWNoRXZlbnQoICJvbnVubG9hZCIsIHVubG9hZEhhbmRsZXIgKTsKCQkJfQoJCX0KCgkJLyogQXR0cmlidXRlcwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkJLy8gU3VwcG9ydDogSUU8OAoJCS8vIFZlcmlmeSB0aGF0IGdldEF0dHJpYnV0ZSByZWFsbHkgcmV0dXJucyBhdHRyaWJ1dGVzIGFuZCBub3QgcHJvcGVydGllcwoJCS8vIChleGNlcHRpbmcgSUU4IGJvb2xlYW5zKQoJCXN1cHBvcnQuYXR0cmlidXRlcyA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQlkaXYuY2xhc3NOYW1lID0gImkiOwoJCQlyZXR1cm4gIWRpdi5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpOwoJCX0pOwoKCQkvKiBnZXRFbGVtZW50KHMpQnkqCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBDaGVjayBpZiBnZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpIHJldHVybnMgb25seSBlbGVtZW50cwoJCXN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVDb21tZW50KCIiKSApOwoJCQlyZXR1cm4gIWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aDsKCQl9KTsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCXN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IHJuYXRpdmUudGVzdCggZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApOwoKCQkvLyBTdXBwb3J0OiBJRTwxMAoJCS8vIENoZWNrIGlmIGdldEVsZW1lbnRCeUlkIHJldHVybnMgZWxlbWVudHMgYnkgbmFtZQoJCS8vIFRoZSBicm9rZW4gZ2V0RWxlbWVudEJ5SWQgbWV0aG9kcyBkb24ndCBwaWNrIHVwIHByb2dyYW1hdGljYWxseS1zZXQgbmFtZXMsCgkJLy8gc28gdXNlIGEgcm91bmRhYm91dCBnZXRFbGVtZW50c0J5TmFtZSB0ZXN0CgkJc3VwcG9ydC5nZXRCeUlkID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCWRvY0VsZW0uYXBwZW5kQ2hpbGQoIGRpdiApLmlkID0gZXhwYW5kbzsKCQkJcmV0dXJuICFkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSB8fCAhZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIGV4cGFuZG8gKS5sZW5ndGg7CgkJfSk7CgoJCS8vIElEIGZpbmQgYW5kIGZpbHRlcgoJCWlmICggc3VwcG9ydC5nZXRCeUlkICkgewoJCQlFeHByLmZpbmRbIklEIl0gPSBmdW5jdGlvbiggaWQsIGNvbnRleHQgKSB7CgkJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRCeUlkICE9PSAidW5kZWZpbmVkIiAmJiBkb2N1bWVudElzSFRNTCApIHsKCQkJCQl2YXIgbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7CgkJCQkJcmV0dXJuIG0gPyBbIG0gXSA6IFtdOwoJCQkJfQoJCQl9OwoJCQlFeHByLmZpbHRlclsiSUQiXSA9IGZ1bmN0aW9uKCBpZCApIHsKCQkJCXZhciBhdHRySWQgPSBpZC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoJCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgiaWQiKSA9PT0gYXR0cklkOwoJCQkJfTsKCQkJfTsKCQl9IGVsc2UgewoJCQkvLyBTdXBwb3J0OiBJRTYvNwoJCQkvLyBnZXRFbGVtZW50QnlJZCBpcyBub3QgcmVsaWFibGUgYXMgYSBmaW5kIHNob3J0Y3V0CgkJCWRlbGV0ZSBFeHByLmZpbmRbIklEIl07CgoJCQlFeHByLmZpbHRlclsiSUQiXSA9ICBmdW5jdGlvbiggaWQgKSB7CgkJCQl2YXIgYXR0cklkID0gaWQucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQl2YXIgbm9kZSA9IHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUgIT09ICJ1bmRlZmluZWQiICYmCgkJCQkJCWVsZW0uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTsKCQkJCQlyZXR1cm4gbm9kZSAmJiBub2RlLnZhbHVlID09PSBhdHRySWQ7CgkJCQl9OwoJCQl9OwoJCX0KCgkJLy8gVGFnCgkJRXhwci5maW5kWyJUQUciXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPwoJCQlmdW5jdGlvbiggdGFnLCBjb250ZXh0ICkgewoJCQkJaWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgKSB7CgkJCQkJcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyApOwoKCQkJCS8vIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgZG9uJ3QgaGF2ZSBnRUJUTgoJCQkJfSBlbHNlIGlmICggc3VwcG9ydC5xc2EgKSB7CgkJCQkJcmV0dXJuIGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnICk7CgkJCQl9CgkJCX0gOgoKCQkJZnVuY3Rpb24oIHRhZywgY29udGV4dCApIHsKCQkJCXZhciBlbGVtLAoJCQkJCXRtcCA9IFtdLAoJCQkJCWkgPSAwLAoJCQkJCS8vIEJ5IGhhcHB5IGNvaW5jaWRlbmNlLCBhIChicm9rZW4pIGdFQlROIGFwcGVhcnMgb24gRG9jdW1lbnRGcmFnbWVudCBub2RlcyB0b28KCQkJCQlyZXN1bHRzID0gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggdGFnICk7CgoJCQkJLy8gRmlsdGVyIG91dCBwb3NzaWJsZSBjb21tZW50cwoJCQkJaWYgKCB0YWcgPT09ICIqIiApIHsKCQkJCQl3aGlsZSAoIChlbGVtID0gcmVzdWx0c1tpKytdKSApIHsKCQkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQkJCQkJdG1wLnB1c2goIGVsZW0gKTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJcmV0dXJuIHRtcDsKCQkJCX0KCQkJCXJldHVybiByZXN1bHRzOwoJCQl9OwoKCQkvLyBDbGFzcwoJCUV4cHIuZmluZFsiQ0xBU1MiXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiBmdW5jdGlvbiggY2xhc3NOYW1lLCBjb250ZXh0ICkgewoJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgIT09ICJ1bmRlZmluZWQiICYmIGRvY3VtZW50SXNIVE1MICkgewoJCQkJcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggY2xhc3NOYW1lICk7CgkJCX0KCQl9OwoKCQkvKiBRU0EvbWF0Y2hlc1NlbGVjdG9yCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBRU0EgYW5kIG1hdGNoZXNTZWxlY3RvciBzdXBwb3J0CgoJCS8vIG1hdGNoZXNTZWxlY3Rvcig6YWN0aXZlKSByZXBvcnRzIGZhbHNlIHdoZW4gdHJ1ZSAoSUU5L09wZXJhIDExLjUpCgkJcmJ1Z2d5TWF0Y2hlcyA9IFtdOwoKCQkvLyBxU2EoOmZvY3VzKSByZXBvcnRzIGZhbHNlIHdoZW4gdHJ1ZSAoQ2hyb21lIDIxKQoJCS8vIFdlIGFsbG93IHRoaXMgYmVjYXVzZSBvZiBhIGJ1ZyBpbiBJRTgvOSB0aGF0IHRocm93cyBhbiBlcnJvcgoJCS8vIHdoZW5ldmVyIGBkb2N1bWVudC5hY3RpdmVFbGVtZW50YCBpcyBhY2Nlc3NlZCBvbiBhbiBpZnJhbWUKCQkvLyBTbywgd2UgYWxsb3cgOmZvY3VzIHRvIHBhc3MgdGhyb3VnaCBRU0EgYWxsIHRoZSB0aW1lIHRvIGF2b2lkIHRoZSBJRSBlcnJvcgoJCS8vIFNlZSBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMzM3OAoJCXJidWdneVFTQSA9IFtdOwoKCQlpZiAoIChzdXBwb3J0LnFzYSA9IHJuYXRpdmUudGVzdCggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCApKSApIHsKCQkJLy8gQnVpbGQgUVNBIHJlZ2V4CgkJCS8vIFJlZ2V4IHN0cmF0ZWd5IGFkb3B0ZWQgZnJvbSBEaWVnbyBQZXJpbmkKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBTZWxlY3QgaXMgc2V0IHRvIGVtcHR5IHN0cmluZyBvbiBwdXJwb3NlCgkJCQkvLyBUaGlzIGlzIHRvIHRlc3QgSUUncyB0cmVhdG1lbnQgb2Ygbm90IGV4cGxpY2l0bHkKCQkJCS8vIHNldHRpbmcgYSBib29sZWFuIGNvbnRlbnQgYXR0cmlidXRlLAoJCQkJLy8gc2luY2UgaXRzIHByZXNlbmNlIHNob3VsZCBiZSBlbm91Z2gKCQkJCS8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMzU5CgkJCQlkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pbm5lckhUTUwgPSAiPGEgaWQ9JyIgKyBleHBhbmRvICsgIic+PC9hPiIgKwoJCQkJCSI8c2VsZWN0IGlkPSciICsgZXhwYW5kbyArICItXHJcXCcgbXNhbGxvd2NhcHR1cmU9Jyc+IiArCgkJCQkJIjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IjsKCgkJCQkvLyBTdXBwb3J0OiBJRTgsIE9wZXJhIDExLTEyLjE2CgkJCQkvLyBOb3RoaW5nIHNob3VsZCBiZSBzZWxlY3RlZCB3aGVuIGVtcHR5IHN0cmluZ3MgZm9sbG93IF49IG9yICQ9IG9yICo9CgkJCQkvLyBUaGUgdGVzdCBhdHRyaWJ1dGUgbXVzdCBiZSB1bmtub3duIGluIE9wZXJhIGJ1dCAic2FmZSIgZm9yIFdpblJUCgkJCQkvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvaGg0NjUzODguYXNweCNhdHRyaWJ1dGVfc2VjdGlvbgoJCQkJaWYgKCBkaXYucXVlcnlTZWxlY3RvckFsbCgiW21zYWxsb3djYXB0dXJlXj0nJ10iKS5sZW5ndGggKSB7CgkJCQkJcmJ1Z2d5UVNBLnB1c2goICJbKl4kXT0iICsgd2hpdGVzcGFjZSArICIqKD86Jyd8XCJcIikiICk7CgkJCQl9CgoJCQkJLy8gU3VwcG9ydDogSUU4CgkJCQkvLyBCb29sZWFuIGF0dHJpYnV0ZXMgYW5kICJ2YWx1ZSIgYXJlIG5vdCB0cmVhdGVkIGNvcnJlY3RseQoJCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGggKSB7CgkJCQkJcmJ1Z2d5UVNBLnB1c2goICJcXFsiICsgd2hpdGVzcGFjZSArICIqKD86dmFsdWV8IiArIGJvb2xlYW5zICsgIikiICk7CgkJCQl9CgoJCQkJLy8gU3VwcG9ydDogQ2hyb21lPDI5LCBBbmRyb2lkPDQuNCwgU2FmYXJpPDcuMCssIGlPUzw3LjArLCBQaGFudG9tSlM8MS45LjgrCgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggIltpZH49IiArIGV4cGFuZG8gKyAiLV0iICkubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCJ+PSIpOwoJCQkJfQoKCQkJCS8vIFdlYmtpdC9PcGVyYSAtIDpjaGVja2VkIHNob3VsZCByZXR1cm4gc2VsZWN0ZWQgb3B0aW9uIGVsZW1lbnRzCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZAoJCQkJLy8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHMKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCgiOmNoZWNrZWQiKTsKCQkJCX0KCgkJCQkvLyBTdXBwb3J0OiBTYWZhcmkgOCssIGlPUyA4KwoJCQkJLy8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEzNjg1MQoJCQkJLy8gSW4tcGFnZSBgc2VsZWN0b3IjaWQgc2liaW5nLWNvbWJpbmF0b3Igc2VsZWN0b3JgIGZhaWxzCgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggImEjIiArIGV4cGFuZG8gKyAiKyoiICkubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCIuIy4rWyt+XSIpOwoJCQkJfQoJCQl9KTsKCgkJCWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQkJLy8gU3VwcG9ydDogV2luZG93cyA4IE5hdGl2ZSBBcHBzCgkJCQkvLyBUaGUgdHlwZSBhbmQgbmFtZSBhdHRyaWJ1dGVzIGFyZSByZXN0cmljdGVkIGR1cmluZyAuaW5uZXJIVE1MIGFzc2lnbm1lbnQKCQkJCXZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CgkJCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ0eXBlIiwgImhpZGRlbiIgKTsKCQkJCWRpdi5hcHBlbmRDaGlsZCggaW5wdXQgKS5zZXRBdHRyaWJ1dGUoICJuYW1lIiwgIkQiICk7CgoJCQkJLy8gU3VwcG9ydDogSUU4CgkJCQkvLyBFbmZvcmNlIGNhc2Utc2Vuc2l0aXZpdHkgb2YgbmFtZSBhdHRyaWJ1dGUKCQkJCWlmICggZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAibmFtZSIgKyB3aGl0ZXNwYWNlICsgIipbKl4kfCF+XT89IiApOwoJCQkJfQoKCQkJCS8vIEZGIDMuNSAtIDplbmFibGVkLzpkaXNhYmxlZCBhbmQgaGlkZGVuIGVsZW1lbnRzIChoaWRkZW4gZWxlbWVudHMgYXJlIHN0aWxsIGVuYWJsZWQpCgkJCQkvLyBJRTggdGhyb3dzIGVycm9yIGhlcmUgYW5kIHdpbGwgbm90IHNlZSBsYXRlciB0ZXN0cwoJCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIjplbmFibGVkIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAiOmVuYWJsZWQiLCAiOmRpc2FibGVkIiApOwoJCQkJfQoKCQkJCS8vIE9wZXJhIDEwLTExIGRvZXMgbm90IHRocm93IG9uIHBvc3QtY29tbWEgaW52YWxpZCBwc2V1ZG9zCgkJCQlkaXYucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpOwoJCQkJcmJ1Z2d5UVNBLnB1c2goIiwuKjoiKTsKCQkJfSk7CgkJfQoKCQlpZiAoIChzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciA9IHJuYXRpdmUudGVzdCggKG1hdGNoZXMgPSBkb2NFbGVtLm1hdGNoZXMgfHwKCQkJZG9jRWxlbS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwKCQkJZG9jRWxlbS5tb3pNYXRjaGVzU2VsZWN0b3IgfHwKCQkJZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yIHx8CgkJCWRvY0VsZW0ubXNNYXRjaGVzU2VsZWN0b3IpICkpICkgewoKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBDaGVjayB0byBzZWUgaWYgaXQncyBwb3NzaWJsZSB0byBkbyBtYXRjaGVzU2VsZWN0b3IKCQkJCS8vIG9uIGEgZGlzY29ubmVjdGVkIG5vZGUgKElFIDkpCgkJCQlzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoID0gbWF0Y2hlcy5jYWxsKCBkaXYsICJkaXYiICk7CgoJCQkJLy8gVGhpcyBzaG91bGQgZmFpbCB3aXRoIGFuIGV4Y2VwdGlvbgoJCQkJLy8gR2Vja28gZG9lcyBub3QgZXJyb3IsIHJldHVybnMgZmFsc2UgaW5zdGVhZAoJCQkJbWF0Y2hlcy5jYWxsKCBkaXYsICJbcyE9JyddOngiICk7CgkJCQlyYnVnZ3lNYXRjaGVzLnB1c2goICIhPSIsIHBzZXVkb3MgKTsKCQkJfSk7CgkJfQoKCQlyYnVnZ3lRU0EgPSByYnVnZ3lRU0EubGVuZ3RoICYmIG5ldyBSZWdFeHAoIHJidWdneVFTQS5qb2luKCJ8IikgKTsKCQlyYnVnZ3lNYXRjaGVzID0gcmJ1Z2d5TWF0Y2hlcy5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5TWF0Y2hlcy5qb2luKCJ8IikgKTsKCgkJLyogQ29udGFpbnMKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgkJaGFzQ29tcGFyZSA9IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiApOwoKCQkvLyBFbGVtZW50IGNvbnRhaW5zIGFub3RoZXIKCQkvLyBQdXJwb3NlZnVsbHkgc2VsZi1leGNsdXNpdmUKCQkvLyBBcyBpbiwgYW4gZWxlbWVudCBkb2VzIG5vdCBjb250YWluIGl0c2VsZgoJCWNvbnRhaW5zID0gaGFzQ29tcGFyZSB8fCBybmF0aXZlLnRlc3QoIGRvY0VsZW0uY29udGFpbnMgKSA/CgkJCWZ1bmN0aW9uKCBhLCBiICkgewoJCQkJdmFyIGFkb3duID0gYS5ub2RlVHlwZSA9PT0gOSA/IGEuZG9jdW1lbnRFbGVtZW50IDogYSwKCQkJCQlidXAgPSBiICYmIGIucGFyZW50Tm9kZTsKCQkJCXJldHVybiBhID09PSBidXAgfHwgISEoIGJ1cCAmJiBidXAubm9kZVR5cGUgPT09IDEgJiYgKAoJCQkJCWFkb3duLmNvbnRhaW5zID8KCQkJCQkJYWRvd24uY29udGFpbnMoIGJ1cCApIDoKCQkJCQkJYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAmJiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBidXAgKSAmIDE2CgkJCQkpKTsKCQkJfSA6CgkJCWZ1bmN0aW9uKCBhLCBiICkgewoJCQkJaWYgKCBiICkgewoJCQkJCXdoaWxlICggKGIgPSBiLnBhcmVudE5vZGUpICkgewoJCQkJCQlpZiAoIGIgPT09IGEgKSB7CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBmYWxzZTsKCQkJfTsKCgkJLyogU29ydGluZwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkJLy8gRG9jdW1lbnQgb3JkZXIgc29ydGluZwoJCXNvcnRPcmRlciA9IGhhc0NvbXBhcmUgPwoJCWZ1bmN0aW9uKCBhLCBiICkgewoKCQkJLy8gRmxhZyBmb3IgZHVwbGljYXRlIHJlbW92YWwKCQkJaWYgKCBhID09PSBiICkgewoJCQkJaGFzRHVwbGljYXRlID0gdHJ1ZTsKCQkJCXJldHVybiAwOwoJCQl9CgoJCQkvLyBTb3J0IG9uIG1ldGhvZCBleGlzdGVuY2UgaWYgb25seSBvbmUgaW5wdXQgaGFzIGNvbXBhcmVEb2N1bWVudFBvc2l0aW9uCgkJCXZhciBjb21wYXJlID0gIWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gLSAhYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjsKCQkJaWYgKCBjb21wYXJlICkgewoJCQkJcmV0dXJuIGNvbXBhcmU7CgkJCX0KCgkJCS8vIENhbGN1bGF0ZSBwb3NpdGlvbiBpZiBib3RoIGlucHV0cyBiZWxvbmcgdG8gdGhlIHNhbWUgZG9jdW1lbnQKCQkJY29tcGFyZSA9ICggYS5vd25lckRvY3VtZW50IHx8IGEgKSA9PT0gKCBiLm93bmVyRG9jdW1lbnQgfHwgYiApID8KCQkJCWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGIgKSA6CgoJCQkJLy8gT3RoZXJ3aXNlIHdlIGtub3cgdGhleSBhcmUgZGlzY29ubmVjdGVkCgkJCQkxOwoKCQkJLy8gRGlzY29ubmVjdGVkIG5vZGVzCgkJCWlmICggY29tcGFyZSAmIDEgfHwKCQkJCSghc3VwcG9ydC5zb3J0RGV0YWNoZWQgJiYgYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYSApID09PSBjb21wYXJlKSApIHsKCgkJCQkvLyBDaG9vc2UgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBpcyByZWxhdGVkIHRvIG91ciBwcmVmZXJyZWQgZG9jdW1lbnQKCQkJCWlmICggYSA9PT0gZG9jdW1lbnQgfHwgYS5vd25lckRvY3VtZW50ID09PSBwcmVmZXJyZWREb2MgJiYgY29udGFpbnMocHJlZmVycmVkRG9jLCBhKSApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCQlpZiAoIGIgPT09IGRvY3VtZW50IHx8IGIub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYikgKSB7CgkJCQkJcmV0dXJuIDE7CgkJCQl9CgoJCQkJLy8gTWFpbnRhaW4gb3JpZ2luYWwgb3JkZXIKCQkJCXJldHVybiBzb3J0SW5wdXQgPwoJCQkJCSggaW5kZXhPZiggc29ydElucHV0LCBhICkgLSBpbmRleE9mKCBzb3J0SW5wdXQsIGIgKSApIDoKCQkJCQkwOwoJCQl9CgoJCQlyZXR1cm4gY29tcGFyZSAmIDQgPyAtMSA6IDE7CgkJfSA6CgkJZnVuY3Rpb24oIGEsIGIgKSB7CgkJCS8vIEV4aXQgZWFybHkgaWYgdGhlIG5vZGVzIGFyZSBpZGVudGljYWwKCQkJaWYgKCBhID09PSBiICkgewoJCQkJaGFzRHVwbGljYXRlID0gdHJ1ZTsKCQkJCXJldHVybiAwOwoJCQl9CgoJCQl2YXIgY3VyLAoJCQkJaSA9IDAsCgkJCQlhdXAgPSBhLnBhcmVudE5vZGUsCgkJCQlidXAgPSBiLnBhcmVudE5vZGUsCgkJCQlhcCA9IFsgYSBdLAoJCQkJYnAgPSBbIGIgXTsKCgkJCS8vIFBhcmVudGxlc3Mgbm9kZXMgYXJlIGVpdGhlciBkb2N1bWVudHMgb3IgZGlzY29ubmVjdGVkCgkJCWlmICggIWF1cCB8fCAhYnVwICkgewoJCQkJcmV0dXJuIGEgPT09IGRvY3VtZW50ID8gLTEgOgoJCQkJCWIgPT09IGRvY3VtZW50ID8gMSA6CgkJCQkJYXVwID8gLTEgOgoJCQkJCWJ1cCA/IDEgOgoJCQkJCXNvcnRJbnB1dCA/CgkJCQkJKCBpbmRleE9mKCBzb3J0SW5wdXQsIGEgKSAtIGluZGV4T2YoIHNvcnRJbnB1dCwgYiApICkgOgoJCQkJCTA7CgoJCQkvLyBJZiB0aGUgbm9kZXMgYXJlIHNpYmxpbmdzLCB3ZSBjYW4gZG8gYSBxdWljayBjaGVjawoJCQl9IGVsc2UgaWYgKCBhdXAgPT09IGJ1cCApIHsKCQkJCXJldHVybiBzaWJsaW5nQ2hlY2soIGEsIGIgKTsKCQkJfQoKCQkJLy8gT3RoZXJ3aXNlIHdlIG5lZWQgZnVsbCBsaXN0cyBvZiB0aGVpciBhbmNlc3RvcnMgZm9yIGNvbXBhcmlzb24KCQkJY3VyID0gYTsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkgewoJCQkJYXAudW5zaGlmdCggY3VyICk7CgkJCX0KCQkJY3VyID0gYjsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkgewoJCQkJYnAudW5zaGlmdCggY3VyICk7CgkJCX0KCgkJCS8vIFdhbGsgZG93biB0aGUgdHJlZSBsb29raW5nIGZvciBhIGRpc2NyZXBhbmN5CgkJCXdoaWxlICggYXBbaV0gPT09IGJwW2ldICkgewoJCQkJaSsrOwoJCQl9CgoJCQlyZXR1cm4gaSA/CgkJCQkvLyBEbyBhIHNpYmxpbmcgY2hlY2sgaWYgdGhlIG5vZGVzIGhhdmUgYSBjb21tb24gYW5jZXN0b3IKCQkJCXNpYmxpbmdDaGVjayggYXBbaV0sIGJwW2ldICkgOgoKCQkJCS8vIE90aGVyd2lzZSBub2RlcyBpbiBvdXIgZG9jdW1lbnQgc29ydCBmaXJzdAoJCQkJYXBbaV0gPT09IHByZWZlcnJlZERvYyA/IC0xIDoKCQkJCWJwW2ldID09PSBwcmVmZXJyZWREb2MgPyAxIDoKCQkJCTA7CgkJfTsKCgkJcmV0dXJuIGRvY3VtZW50OwoJfTsKCglTaXp6bGUubWF0Y2hlcyA9IGZ1bmN0aW9uKCBleHByLCBlbGVtZW50cyApIHsKCQlyZXR1cm4gU2l6emxlKCBleHByLCBudWxsLCBudWxsLCBlbGVtZW50cyApOwoJfTsKCglTaXp6bGUubWF0Y2hlc1NlbGVjdG9yID0gZnVuY3Rpb24oIGVsZW0sIGV4cHIgKSB7CgkJLy8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkCgkJaWYgKCAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtICkgIT09IGRvY3VtZW50ICkgewoJCQlzZXREb2N1bWVudCggZWxlbSApOwoJCX0KCgkJLy8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRlIHNlbGVjdG9ycyBhcmUgcXVvdGVkCgkJZXhwciA9IGV4cHIucmVwbGFjZSggcmF0dHJpYnV0ZVF1b3RlcywgIj0nJDEnXSIgKTsKCgkJaWYgKCBzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciAmJiBkb2N1bWVudElzSFRNTCAmJgoJCQkhY29tcGlsZXJDYWNoZVsgZXhwciArICIgIiBdICYmCgkJCSggIXJidWdneU1hdGNoZXMgfHwgIXJidWdneU1hdGNoZXMudGVzdCggZXhwciApICkgJiYKCQkJKCAhcmJ1Z2d5UVNBICAgICB8fCAhcmJ1Z2d5UVNBLnRlc3QoIGV4cHIgKSApICkgewoKCQkJdHJ5IHsKCQkJCXZhciByZXQgPSBtYXRjaGVzLmNhbGwoIGVsZW0sIGV4cHIgKTsKCgkJCQkvLyBJRSA5J3MgbWF0Y2hlc1NlbGVjdG9yIHJldHVybnMgZmFsc2Ugb24gZGlzY29ubmVjdGVkIG5vZGVzCgkJCQlpZiAoIHJldCB8fCBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoIHx8CgkJCQkJCS8vIEFzIHdlbGwsIGRpc2Nvbm5lY3RlZCBub2RlcyBhcmUgc2FpZCB0byBiZSBpbiBhIGRvY3VtZW50CgkJCQkJCS8vIGZyYWdtZW50IGluIElFIDkKCQkJCQkJZWxlbS5kb2N1bWVudCAmJiBlbGVtLmRvY3VtZW50Lm5vZGVUeXBlICE9PSAxMSApIHsKCQkJCQlyZXR1cm4gcmV0OwoJCQkJfQoJCQl9IGNhdGNoIChlKSB7fQoJCX0KCgkJcmV0dXJuIFNpenpsZSggZXhwciwgZG9jdW1lbnQsIG51bGwsIFsgZWxlbSBdICkubGVuZ3RoID4gMDsKCX07CgoJU2l6emxlLmNvbnRhaW5zID0gZnVuY3Rpb24oIGNvbnRleHQsIGVsZW0gKSB7CgkJLy8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkCgkJaWYgKCAoIGNvbnRleHQub3duZXJEb2N1bWVudCB8fCBjb250ZXh0ICkgIT09IGRvY3VtZW50ICkgewoJCQlzZXREb2N1bWVudCggY29udGV4dCApOwoJCX0KCQlyZXR1cm4gY29udGFpbnMoIGNvbnRleHQsIGVsZW0gKTsKCX07CgoJU2l6emxlLmF0dHIgPSBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkvLyBTZXQgZG9jdW1lbnQgdmFycyBpZiBuZWVkZWQKCQlpZiAoICggZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0gKSAhPT0gZG9jdW1lbnQgKSB7CgkJCXNldERvY3VtZW50KCBlbGVtICk7CgkJfQoKCQl2YXIgZm4gPSBFeHByLmF0dHJIYW5kbGVbIG5hbWUudG9Mb3dlckNhc2UoKSBdLAoJCQkvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IE9iamVjdC5wcm90b3R5cGUgcHJvcGVydGllcyAoalF1ZXJ5ICMxMzgwNykKCQkJdmFsID0gZm4gJiYgaGFzT3duLmNhbGwoIEV4cHIuYXR0ckhhbmRsZSwgbmFtZS50b0xvd2VyQ2FzZSgpICkgPwoJCQkJZm4oIGVsZW0sIG5hbWUsICFkb2N1bWVudElzSFRNTCApIDoKCQkJCXVuZGVmaW5lZDsKCgkJcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkID8KCQkJdmFsIDoKCQkJc3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFkb2N1bWVudElzSFRNTCA/CgkJCQllbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApIDoKCQkJCSh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpICYmIHZhbC5zcGVjaWZpZWQgPwoJCQkJCXZhbC52YWx1ZSA6CgkJCQkJbnVsbDsKCX07CgoJU2l6emxlLmVycm9yID0gZnVuY3Rpb24oIG1zZyApIHsKCQl0aHJvdyBuZXcgRXJyb3IoICJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiICsgbXNnICk7Cgl9OwoKCS8qKgoJICogRG9jdW1lbnQgc29ydGluZyBhbmQgcmVtb3ZpbmcgZHVwbGljYXRlcwoJICogQHBhcmFtIHtBcnJheUxpa2V9IHJlc3VsdHMKCSAqLwoJU2l6emxlLnVuaXF1ZVNvcnQgPSBmdW5jdGlvbiggcmVzdWx0cyApIHsKCQl2YXIgZWxlbSwKCQkJZHVwbGljYXRlcyA9IFtdLAoJCQlqID0gMCwKCQkJaSA9IDA7CgoJCS8vIFVubGVzcyB3ZSAqa25vdyogd2UgY2FuIGRldGVjdCBkdXBsaWNhdGVzLCBhc3N1bWUgdGhlaXIgcHJlc2VuY2UKCQloYXNEdXBsaWNhdGUgPSAhc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzOwoJCXNvcnRJbnB1dCA9ICFzdXBwb3J0LnNvcnRTdGFibGUgJiYgcmVzdWx0cy5zbGljZSggMCApOwoJCXJlc3VsdHMuc29ydCggc29ydE9yZGVyICk7CgoJCWlmICggaGFzRHVwbGljYXRlICkgewoJCQl3aGlsZSAoIChlbGVtID0gcmVzdWx0c1tpKytdKSApIHsKCQkJCWlmICggZWxlbSA9PT0gcmVzdWx0c1sgaSBdICkgewoJCQkJCWogPSBkdXBsaWNhdGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJfQoJCQl3aGlsZSAoIGotLSApIHsKCQkJCXJlc3VsdHMuc3BsaWNlKCBkdXBsaWNhdGVzWyBqIF0sIDEgKTsKCQkJfQoJCX0KCgkJLy8gQ2xlYXIgaW5wdXQgYWZ0ZXIgc29ydGluZyB0byByZWxlYXNlIG9iamVjdHMKCQkvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9zaXp6bGUvcHVsbC8yMjUKCQlzb3J0SW5wdXQgPSBudWxsOwoKCQlyZXR1cm4gcmVzdWx0czsKCX07CgoJLyoqCgkgKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciByZXRyaWV2aW5nIHRoZSB0ZXh0IHZhbHVlIG9mIGFuIGFycmF5IG9mIERPTSBub2RlcwoJICogQHBhcmFtIHtBcnJheXxFbGVtZW50fSBlbGVtCgkgKi8KCWdldFRleHQgPSBTaXp6bGUuZ2V0VGV4dCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXZhciBub2RlLAoJCQlyZXQgPSAiIiwKCQkJaSA9IDAsCgkJCW5vZGVUeXBlID0gZWxlbS5ub2RlVHlwZTsKCgkJaWYgKCAhbm9kZVR5cGUgKSB7CgkJCS8vIElmIG5vIG5vZGVUeXBlLCB0aGlzIGlzIGV4cGVjdGVkIHRvIGJlIGFuIGFycmF5CgkJCXdoaWxlICggKG5vZGUgPSBlbGVtW2krK10pICkgewoJCQkJLy8gRG8gbm90IHRyYXZlcnNlIGNvbW1lbnQgbm9kZXMKCQkJCXJldCArPSBnZXRUZXh0KCBub2RlICk7CgkJCX0KCQl9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMSB8fCBub2RlVHlwZSA9PT0gOSB8fCBub2RlVHlwZSA9PT0gMTEgKSB7CgkJCS8vIFVzZSB0ZXh0Q29udGVudCBmb3IgZWxlbWVudHMKCQkJLy8gaW5uZXJUZXh0IHVzYWdlIHJlbW92ZWQgZm9yIGNvbnNpc3RlbmN5IG9mIG5ldyBsaW5lcyAoalF1ZXJ5ICMxMTE1MykKCQkJaWYgKCB0eXBlb2YgZWxlbS50ZXh0Q29udGVudCA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXR1cm4gZWxlbS50ZXh0Q29udGVudDsKCQkJfSBlbHNlIHsKCQkJCS8vIFRyYXZlcnNlIGl0cyBjaGlsZHJlbgoJCQkJZm9yICggZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcgKSB7CgkJCQkJcmV0ICs9IGdldFRleHQoIGVsZW0gKTsKCQkJCX0KCQkJfQoJCX0gZWxzZSBpZiAoIG5vZGVUeXBlID09PSAzIHx8IG5vZGVUeXBlID09PSA0ICkgewoJCQlyZXR1cm4gZWxlbS5ub2RlVmFsdWU7CgkJfQoJCS8vIERvIG5vdCBpbmNsdWRlIGNvbW1lbnQgb3IgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbiBub2RlcwoKCQlyZXR1cm4gcmV0OwoJfTsKCglFeHByID0gU2l6emxlLnNlbGVjdG9ycyA9IHsKCgkJLy8gQ2FuIGJlIGFkanVzdGVkIGJ5IHRoZSB1c2VyCgkJY2FjaGVMZW5ndGg6IDUwLAoKCQljcmVhdGVQc2V1ZG86IG1hcmtGdW5jdGlvbiwKCgkJbWF0Y2g6IG1hdGNoRXhwciwKCgkJYXR0ckhhbmRsZToge30sCgoJCWZpbmQ6IHt9LAoKCQlyZWxhdGl2ZTogewoJCQkiPiI6IHsgZGlyOiAicGFyZW50Tm9kZSIsIGZpcnN0OiB0cnVlIH0sCgkJCSIgIjogeyBkaXI6ICJwYXJlbnROb2RlIiB9LAoJCQkiKyI6IHsgZGlyOiAicHJldmlvdXNTaWJsaW5nIiwgZmlyc3Q6IHRydWUgfSwKCQkJIn4iOiB7IGRpcjogInByZXZpb3VzU2libGluZyIgfQoJCX0sCgoJCXByZUZpbHRlcjogewoJCQkiQVRUUiI6IGZ1bmN0aW9uKCBtYXRjaCApIHsKCQkJCW1hdGNoWzFdID0gbWF0Y2hbMV0ucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCgkJCQkvLyBNb3ZlIHRoZSBnaXZlbiB2YWx1ZSB0byBtYXRjaFszXSB3aGV0aGVyIHF1b3RlZCBvciB1bnF1b3RlZAoJCQkJbWF0Y2hbM10gPSAoIG1hdGNoWzNdIHx8IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8ICIiICkucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCgkJCQlpZiAoIG1hdGNoWzJdID09PSAifj0iICkgewoJCQkJCW1hdGNoWzNdID0gIiAiICsgbWF0Y2hbM10gKyAiICI7CgkJCQl9CgoJCQkJcmV0dXJuIG1hdGNoLnNsaWNlKCAwLCA0ICk7CgkJCX0sCgoJCQkiQ0hJTEQiOiBmdW5jdGlvbiggbWF0Y2ggKSB7CgkJCQkvKiBtYXRjaGVzIGZyb20gbWF0Y2hFeHByWyJDSElMRCJdCgkJCQkJMSB0eXBlIChvbmx5fG50aHwuLi4pCgkJCQkJMiB3aGF0IChjaGlsZHxvZi10eXBlKQoJCQkJCTMgYXJndW1lbnQgKGV2ZW58b2RkfFxkKnxcZCpuKFsrLV1cZCspP3wuLi4pCgkJCQkJNCB4bi1jb21wb25lbnQgb2YgeG4reSBhcmd1bWVudCAoWystXT9cZCpufCkKCQkJCQk1IHNpZ24gb2YgeG4tY29tcG9uZW50CgkJCQkJNiB4IG9mIHhuLWNvbXBvbmVudAoJCQkJCTcgc2lnbiBvZiB5LWNvbXBvbmVudAoJCQkJCTggeSBvZiB5LWNvbXBvbmVudAoJCQkJKi8KCQkJCW1hdGNoWzFdID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTsKCgkJCQlpZiAoIG1hdGNoWzFdLnNsaWNlKCAwLCAzICkgPT09ICJudGgiICkgewoJCQkJCS8vIG50aC0qIHJlcXVpcmVzIGFyZ3VtZW50CgkJCQkJaWYgKCAhbWF0Y2hbM10gKSB7CgkJCQkJCVNpenpsZS5lcnJvciggbWF0Y2hbMF0gKTsKCQkJCQl9CgoJCQkJCS8vIG51bWVyaWMgeCBhbmQgeSBwYXJhbWV0ZXJzIGZvciBFeHByLmZpbHRlci5DSElMRAoJCQkJCS8vIHJlbWVtYmVyIHRoYXQgZmFsc2UvdHJ1ZSBjYXN0IHJlc3BlY3RpdmVseSB0byAwLzEKCQkJCQltYXRjaFs0XSA9ICsoIG1hdGNoWzRdID8gbWF0Y2hbNV0gKyAobWF0Y2hbNl0gfHwgMSkgOiAyICogKCBtYXRjaFszXSA9PT0gImV2ZW4iIHx8IG1hdGNoWzNdID09PSAib2RkIiApICk7CgkJCQkJbWF0Y2hbNV0gPSArKCAoIG1hdGNoWzddICsgbWF0Y2hbOF0gKSB8fCBtYXRjaFszXSA9PT0gIm9kZCIgKTsKCgkJCQkvLyBvdGhlciB0eXBlcyBwcm9oaWJpdCBhcmd1bWVudHMKCQkJCX0gZWxzZSBpZiAoIG1hdGNoWzNdICkgewoJCQkJCVNpenpsZS5lcnJvciggbWF0Y2hbMF0gKTsKCQkJCX0KCgkJCQlyZXR1cm4gbWF0Y2g7CgkJCX0sCgoJCQkiUFNFVURPIjogZnVuY3Rpb24oIG1hdGNoICkgewoJCQkJdmFyIGV4Y2VzcywKCQkJCQl1bnF1b3RlZCA9ICFtYXRjaFs2XSAmJiBtYXRjaFsyXTsKCgkJCQlpZiAoIG1hdGNoRXhwclsiQ0hJTEQiXS50ZXN0KCBtYXRjaFswXSApICkgewoJCQkJCXJldHVybiBudWxsOwoJCQkJfQoKCQkJCS8vIEFjY2VwdCBxdW90ZWQgYXJndW1lbnRzIGFzLWlzCgkJCQlpZiAoIG1hdGNoWzNdICkgewoJCQkJCW1hdGNoWzJdID0gbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgIiI7CgoJCQkJLy8gU3RyaXAgZXhjZXNzIGNoYXJhY3RlcnMgZnJvbSB1bnF1b3RlZCBhcmd1bWVudHMKCQkJCX0gZWxzZSBpZiAoIHVucXVvdGVkICYmIHJwc2V1ZG8udGVzdCggdW5xdW90ZWQgKSAmJgoJCQkJCS8vIEdldCBleGNlc3MgZnJvbSB0b2tlbml6ZSAocmVjdXJzaXZlbHkpCgkJCQkJKGV4Y2VzcyA9IHRva2VuaXplKCB1bnF1b3RlZCwgdHJ1ZSApKSAmJgoJCQkJCS8vIGFkdmFuY2UgdG8gdGhlIG5leHQgY2xvc2luZyBwYXJlbnRoZXNpcwoJCQkJCShleGNlc3MgPSB1bnF1b3RlZC5pbmRleE9mKCAiKSIsIHVucXVvdGVkLmxlbmd0aCAtIGV4Y2VzcyApIC0gdW5xdW90ZWQubGVuZ3RoKSApIHsKCgkJCQkJLy8gZXhjZXNzIGlzIGEgbmVnYXRpdmUgaW5kZXgKCQkJCQltYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwLCBleGNlc3MgKTsKCQkJCQltYXRjaFsyXSA9IHVucXVvdGVkLnNsaWNlKCAwLCBleGNlc3MgKTsKCQkJCX0KCgkJCQkvLyBSZXR1cm4gb25seSBjYXB0dXJlcyBuZWVkZWQgYnkgdGhlIHBzZXVkbyBmaWx0ZXIgbWV0aG9kICh0eXBlIGFuZCBhcmd1bWVudCkKCQkJCXJldHVybiBtYXRjaC5zbGljZSggMCwgMyApOwoJCQl9CgkJfSwKCgkJZmlsdGVyOiB7CgoJCQkiVEFHIjogZnVuY3Rpb24oIG5vZGVOYW1lU2VsZWN0b3IgKSB7CgkJCQl2YXIgbm9kZU5hbWUgPSBub2RlTmFtZVNlbGVjdG9yLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICkudG9Mb3dlckNhc2UoKTsKCQkJCXJldHVybiBub2RlTmFtZVNlbGVjdG9yID09PSAiKiIgPwoJCQkJCWZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSA6CgkJCQkJZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJCXJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZU5hbWU7CgkJCQkJfTsKCQkJfSwKCgkJCSJDTEFTUyI6IGZ1bmN0aW9uKCBjbGFzc05hbWUgKSB7CgkJCQl2YXIgcGF0dGVybiA9IGNsYXNzQ2FjaGVbIGNsYXNzTmFtZSArICIgIiBdOwoKCQkJCXJldHVybiBwYXR0ZXJuIHx8CgkJCQkJKHBhdHRlcm4gPSBuZXcgUmVnRXhwKCAiKF58IiArIHdoaXRlc3BhY2UgKyAiKSIgKyBjbGFzc05hbWUgKyAiKCIgKyB3aGl0ZXNwYWNlICsgInwkKSIgKSkgJiYKCQkJCQljbGFzc0NhY2hlKCBjbGFzc05hbWUsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQlyZXR1cm4gcGF0dGVybi50ZXN0KCB0eXBlb2YgZWxlbS5jbGFzc05hbWUgPT09ICJzdHJpbmciICYmIGVsZW0uY2xhc3NOYW1lIHx8IHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZSAhPT0gInVuZGVmaW5lZCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoImNsYXNzIikgfHwgIiIgKTsKCQkJCQl9KTsKCQkJfSwKCgkJCSJBVFRSIjogZnVuY3Rpb24oIG5hbWUsIG9wZXJhdG9yLCBjaGVjayApIHsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQl2YXIgcmVzdWx0ID0gU2l6emxlLmF0dHIoIGVsZW0sIG5hbWUgKTsKCgkJCQkJaWYgKCByZXN1bHQgPT0gbnVsbCApIHsKCQkJCQkJcmV0dXJuIG9wZXJhdG9yID09PSAiIT0iOwoJCQkJCX0KCQkJCQlpZiAoICFvcGVyYXRvciApIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoKCQkJCQlyZXN1bHQgKz0gIiI7CgoJCQkJCXJldHVybiBvcGVyYXRvciA9PT0gIj0iID8gcmVzdWx0ID09PSBjaGVjayA6CgkJCQkJCW9wZXJhdG9yID09PSAiIT0iID8gcmVzdWx0ICE9PSBjaGVjayA6CgkJCQkJCW9wZXJhdG9yID09PSAiXj0iID8gY2hlY2sgJiYgcmVzdWx0LmluZGV4T2YoIGNoZWNrICkgPT09IDAgOgoJCQkJCQlvcGVyYXRvciA9PT0gIio9IiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID4gLTEgOgoJCQkJCQlvcGVyYXRvciA9PT0gIiQ9IiA/IGNoZWNrICYmIHJlc3VsdC5zbGljZSggLWNoZWNrLmxlbmd0aCApID09PSBjaGVjayA6CgkJCQkJCW9wZXJhdG9yID09PSAifj0iID8gKCAiICIgKyByZXN1bHQucmVwbGFjZSggcndoaXRlc3BhY2UsICIgIiApICsgIiAiICkuaW5kZXhPZiggY2hlY2sgKSA+IC0xIDoKCQkJCQkJb3BlcmF0b3IgPT09ICJ8PSIgPyByZXN1bHQgPT09IGNoZWNrIHx8IHJlc3VsdC5zbGljZSggMCwgY2hlY2subGVuZ3RoICsgMSApID09PSBjaGVjayArICItIiA6CgkJCQkJCWZhbHNlOwoJCQkJfTsKCQkJfSwKCgkJCSJDSElMRCI6IGZ1bmN0aW9uKCB0eXBlLCB3aGF0LCBhcmd1bWVudCwgZmlyc3QsIGxhc3QgKSB7CgkJCQl2YXIgc2ltcGxlID0gdHlwZS5zbGljZSggMCwgMyApICE9PSAibnRoIiwKCQkJCQlmb3J3YXJkID0gdHlwZS5zbGljZSggLTQgKSAhPT0gImxhc3QiLAoJCQkJCW9mVHlwZSA9IHdoYXQgPT09ICJvZi10eXBlIjsKCgkJCQlyZXR1cm4gZmlyc3QgPT09IDEgJiYgbGFzdCA9PT0gMCA/CgoJCQkJCS8vIFNob3J0Y3V0IGZvciA6bnRoLSoobikKCQkJCQlmdW5jdGlvbiggZWxlbSApIHsKCQkJCQkJcmV0dXJuICEhZWxlbS5wYXJlbnROb2RlOwoJCQkJCX0gOgoKCQkJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJCQl2YXIgY2FjaGUsIHVuaXF1ZUNhY2hlLCBvdXRlckNhY2hlLCBub2RlLCBub2RlSW5kZXgsIHN0YXJ0LAoJCQkJCQkJZGlyID0gc2ltcGxlICE9PSBmb3J3YXJkID8gIm5leHRTaWJsaW5nIiA6ICJwcmV2aW91c1NpYmxpbmciLAoJCQkJCQkJcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlLAoJCQkJCQkJbmFtZSA9IG9mVHlwZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksCgkJCQkJCQl1c2VDYWNoZSA9ICF4bWwgJiYgIW9mVHlwZSwKCQkJCQkJCWRpZmYgPSBmYWxzZTsKCgkJCQkJCWlmICggcGFyZW50ICkgewoKCQkJCQkJCS8vIDooZmlyc3R8bGFzdHxvbmx5KS0oY2hpbGR8b2YtdHlwZSkKCQkJCQkJCWlmICggc2ltcGxlICkgewoJCQkJCQkJCXdoaWxlICggZGlyICkgewoJCQkJCQkJCQlub2RlID0gZWxlbTsKCQkJCQkJCQkJd2hpbGUgKCAobm9kZSA9IG5vZGVbIGRpciBdKSApIHsKCQkJCQkJCQkJCWlmICggb2ZUeXBlID8KCQkJCQkJCQkJCQlub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOgoJCQkJCQkJCQkJCW5vZGUubm9kZVR5cGUgPT09IDEgKSB7CgoJCQkJCQkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCQkvLyBSZXZlcnNlIGRpcmVjdGlvbiBmb3IgOm9ubHktKiAoaWYgd2UgaGF2ZW4ndCB5ZXQgZG9uZSBzbykKCQkJCQkJCQkJc3RhcnQgPSBkaXIgPSB0eXBlID09PSAib25seSIgJiYgIXN0YXJ0ICYmICJuZXh0U2libGluZyI7CgkJCQkJCQkJfQoJCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQkJfQoKCQkJCQkJCXN0YXJ0ID0gWyBmb3J3YXJkID8gcGFyZW50LmZpcnN0Q2hpbGQgOiBwYXJlbnQubGFzdENoaWxkIF07CgoJCQkJCQkJLy8gbm9uLXhtbCA6bnRoLWNoaWxkKC4uLikgc3RvcmVzIGNhY2hlIGRhdGEgb24gYHBhcmVudGAKCQkJCQkJCWlmICggZm9yd2FyZCAmJiB1c2VDYWNoZSApIHsKCgkJCQkJCQkJLy8gU2VlayBgZWxlbWAgZnJvbSBhIHByZXZpb3VzbHktY2FjaGVkIGluZGV4CgoJCQkJCQkJCS8vIC4uLmluIGEgZ3ppcC1mcmllbmRseSB3YXkKCQkJCQkJCQlub2RlID0gcGFyZW50OwoJCQkJCQkJCW91dGVyQ2FjaGUgPSBub2RlWyBleHBhbmRvIF0gfHwgKG5vZGVbIGV4cGFuZG8gXSA9IHt9KTsKCgkJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJCS8vIERlZmVuZCBhZ2FpbnN0IGNsb25lZCBhdHRyb3BlcnRpZXMgKGpRdWVyeSBnaC0xNzA5KQoJCQkJCQkJCXVuaXF1ZUNhY2hlID0gb3V0ZXJDYWNoZVsgbm9kZS51bmlxdWVJRCBdIHx8CgkJCQkJCQkJCShvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQkJCWNhY2hlID0gdW5pcXVlQ2FjaGVbIHR5cGUgXSB8fCBbXTsKCQkJCQkJCQlub2RlSW5kZXggPSBjYWNoZVsgMCBdID09PSBkaXJydW5zICYmIGNhY2hlWyAxIF07CgkJCQkJCQkJZGlmZiA9IG5vZGVJbmRleCAmJiBjYWNoZVsgMiBdOwoJCQkJCQkJCW5vZGUgPSBub2RlSW5kZXggJiYgcGFyZW50LmNoaWxkTm9kZXNbIG5vZGVJbmRleCBdOwoKCQkJCQkJCQl3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fAoKCQkJCQkJCQkJLy8gRmFsbGJhY2sgdG8gc2Vla2luZyBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQkJKGRpZmYgPSBub2RlSW5kZXggPSAwKSB8fCBzdGFydC5wb3AoKSkgKSB7CgoJCQkJCQkJCQkvLyBXaGVuIGZvdW5kLCBjYWNoZSBpbmRleGVzIG9uIGBwYXJlbnRgIGFuZCBicmVhawoJCQkJCQkJCQlpZiAoIG5vZGUubm9kZVR5cGUgPT09IDEgJiYgKytkaWZmICYmIG5vZGUgPT09IGVsZW0gKSB7CgkJCQkJCQkJCQl1bmlxdWVDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBub2RlSW5kZXgsIGRpZmYgXTsKCQkJCQkJCQkJCWJyZWFrOwoJCQkJCQkJCQl9CgkJCQkJCQkJfQoKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJLy8gVXNlIHByZXZpb3VzbHktY2FjaGVkIGVsZW1lbnQgaW5kZXggaWYgYXZhaWxhYmxlCgkJCQkJCQkJaWYgKCB1c2VDYWNoZSApIHsKCQkJCQkJCQkJLy8gLi4uaW4gYSBnemlwLWZyaWVuZGx5IHdheQoJCQkJCQkJCQlub2RlID0gZWxlbTsKCQkJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJCQkvLyBEZWZlbmQgYWdhaW5zdCBjbG9uZWQgYXR0cm9wZXJ0aWVzIChqUXVlcnkgZ2gtMTcwOSkKCQkJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkJCShvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQkJCQljYWNoZSA9IHVuaXF1ZUNhY2hlWyB0eXBlIF0gfHwgW107CgkJCQkJCQkJCW5vZGVJbmRleCA9IGNhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbIDEgXTsKCQkJCQkJCQkJZGlmZiA9IG5vZGVJbmRleDsKCQkJCQkJCQl9CgoJCQkJCQkJCS8vIHhtbCA6bnRoLWNoaWxkKC4uLikKCQkJCQkJCQkvLyBvciA6bnRoLWxhc3QtY2hpbGQoLi4uKSBvciA6bnRoKC1sYXN0KT8tb2YtdHlwZSguLi4pCgkJCQkJCQkJaWYgKCBkaWZmID09PSBmYWxzZSApIHsKCQkJCQkJCQkJLy8gVXNlIHRoZSBzYW1lIGxvb3AgYXMgYWJvdmUgdG8gc2VlayBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQkJd2hpbGUgKCAobm9kZSA9ICsrbm9kZUluZGV4ICYmIG5vZGUgJiYgbm9kZVsgZGlyIF0gfHwKCQkJCQkJCQkJCShkaWZmID0gbm9kZUluZGV4ID0gMCkgfHwgc3RhcnQucG9wKCkpICkgewoKCQkJCQkJCQkJCWlmICggKCBvZlR5cGUgPwoJCQkJCQkJCQkJCW5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6CgkJCQkJCQkJCQkJbm9kZS5ub2RlVHlwZSA9PT0gMSApICYmCgkJCQkJCQkJCQkJKytkaWZmICkgewoKCQkJCQkJCQkJCQkvLyBDYWNoZSB0aGUgaW5kZXggb2YgZWFjaCBlbmNvdW50ZXJlZCBlbGVtZW50CgkJCQkJCQkJCQkJaWYgKCB1c2VDYWNoZSApIHsKCQkJCQkJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJCQkJCQkvLyBEZWZlbmQgYWdhaW5zdCBjbG9uZWQgYXR0cm9wZXJ0aWVzIChqUXVlcnkgZ2gtMTcwOSkKCQkJCQkJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkJCQkJCShvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQkJCQkJCQl1bmlxdWVDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBkaWZmIF07CgkJCQkJCQkJCQkJfQoKCQkJCQkJCQkJCQlpZiAoIG5vZGUgPT09IGVsZW0gKSB7CgkJCQkJCQkJCQkJCWJyZWFrOwoJCQkJCQkJCQkJCX0KCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQkvLyBJbmNvcnBvcmF0ZSB0aGUgb2Zmc2V0LCB0aGVuIGNoZWNrIGFnYWluc3QgY3ljbGUgc2l6ZQoJCQkJCQkJZGlmZiAtPSBsYXN0OwoJCQkJCQkJcmV0dXJuIGRpZmYgPT09IGZpcnN0IHx8ICggZGlmZiAlIGZpcnN0ID09PSAwICYmIGRpZmYgLyBmaXJzdCA+PSAwICk7CgkJCQkJCX0KCQkJCQl9OwoJCQl9LAoKCQkJIlBTRVVETyI6IGZ1bmN0aW9uKCBwc2V1ZG8sIGFyZ3VtZW50ICkgewoJCQkJLy8gcHNldWRvLWNsYXNzIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI3BzZXVkby1jbGFzc2VzCgkJCQkvLyBQcmlvcml0aXplIGJ5IGNhc2Ugc2Vuc2l0aXZpdHkgaW4gY2FzZSBjdXN0b20gcHNldWRvcyBhcmUgYWRkZWQgd2l0aCB1cHBlcmNhc2UgbGV0dGVycwoJCQkJLy8gUmVtZW1iZXIgdGhhdCBzZXRGaWx0ZXJzIGluaGVyaXRzIGZyb20gcHNldWRvcwoJCQkJdmFyIGFyZ3MsCgkJCQkJZm4gPSBFeHByLnBzZXVkb3NbIHBzZXVkbyBdIHx8IEV4cHIuc2V0RmlsdGVyc1sgcHNldWRvLnRvTG93ZXJDYXNlKCkgXSB8fAoJCQkJCQlTaXp6bGUuZXJyb3IoICJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIgKyBwc2V1ZG8gKTsKCgkJCQkvLyBUaGUgdXNlciBtYXkgdXNlIGNyZWF0ZVBzZXVkbyB0byBpbmRpY2F0ZSB0aGF0CgkJCQkvLyBhcmd1bWVudHMgYXJlIG5lZWRlZCB0byBjcmVhdGUgdGhlIGZpbHRlciBmdW5jdGlvbgoJCQkJLy8ganVzdCBhcyBTaXp6bGUgZG9lcwoJCQkJaWYgKCBmblsgZXhwYW5kbyBdICkgewoJCQkJCXJldHVybiBmbiggYXJndW1lbnQgKTsKCQkJCX0KCgkJCQkvLyBCdXQgbWFpbnRhaW4gc3VwcG9ydCBmb3Igb2xkIHNpZ25hdHVyZXMKCQkJCWlmICggZm4ubGVuZ3RoID4gMSApIHsKCQkJCQlhcmdzID0gWyBwc2V1ZG8sIHBzZXVkbywgIiIsIGFyZ3VtZW50IF07CgkJCQkJcmV0dXJuIEV4cHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eSggcHNldWRvLnRvTG93ZXJDYXNlKCkgKSA/CgkJCQkJCW1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgbWF0Y2hlcyApIHsKCQkJCQkJCXZhciBpZHgsCgkJCQkJCQkJbWF0Y2hlZCA9IGZuKCBzZWVkLCBhcmd1bWVudCApLAoJCQkJCQkJCWkgPSBtYXRjaGVkLmxlbmd0aDsKCQkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJCWlkeCA9IGluZGV4T2YoIHNlZWQsIG1hdGNoZWRbaV0gKTsKCQkJCQkJCQlzZWVkWyBpZHggXSA9ICEoIG1hdGNoZXNbIGlkeCBdID0gbWF0Y2hlZFtpXSApOwoJCQkJCQkJfQoJCQkJCQl9KSA6CgkJCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQkJcmV0dXJuIGZuKCBlbGVtLCAwLCBhcmdzICk7CgkJCQkJCX07CgkJCQl9CgoJCQkJcmV0dXJuIGZuOwoJCQl9CgkJfSwKCgkJcHNldWRvczogewoJCQkvLyBQb3RlbnRpYWxseSBjb21wbGV4IHBzZXVkb3MKCQkJIm5vdCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCQkvLyBUcmltIHRoZSBzZWxlY3RvciBwYXNzZWQgdG8gY29tcGlsZQoJCQkJLy8gdG8gYXZvaWQgdHJlYXRpbmcgbGVhZGluZyBhbmQgdHJhaWxpbmcKCQkJCS8vIHNwYWNlcyBhcyBjb21iaW5hdG9ycwoJCQkJdmFyIGlucHV0ID0gW10sCgkJCQkJcmVzdWx0cyA9IFtdLAoJCQkJCW1hdGNoZXIgPSBjb21waWxlKCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgIiQxIiApICk7CgoJCQkJcmV0dXJuIG1hdGNoZXJbIGV4cGFuZG8gXSA/CgkJCQkJbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzLCBjb250ZXh0LCB4bWwgKSB7CgkJCQkJCXZhciBlbGVtLAoJCQkJCQkJdW5tYXRjaGVkID0gbWF0Y2hlciggc2VlZCwgbnVsbCwgeG1sLCBbXSApLAoJCQkJCQkJaSA9IHNlZWQubGVuZ3RoOwoKCQkJCQkJLy8gTWF0Y2ggZWxlbWVudHMgdW5tYXRjaGVkIGJ5IGBtYXRjaGVyYAoJCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJCWlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkgewoJCQkJCQkJCXNlZWRbaV0gPSAhKG1hdGNoZXNbaV0gPSBlbGVtKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0pIDoKCQkJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJCQlpbnB1dFswXSA9IGVsZW07CgkJCQkJCW1hdGNoZXIoIGlucHV0LCBudWxsLCB4bWwsIHJlc3VsdHMgKTsKCQkJCQkJLy8gRG9uJ3Qga2VlcCB0aGUgZWxlbWVudCAoaXNzdWUgIzI5OSkKCQkJCQkJaW5wdXRbMF0gPSBudWxsOwoJCQkJCQlyZXR1cm4gIXJlc3VsdHMucG9wKCk7CgkJCQkJfTsKCQkJfSksCgoJCQkiaGFzIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQlyZXR1cm4gU2l6emxlKCBzZWxlY3RvciwgZWxlbSApLmxlbmd0aCA+IDA7CgkJCQl9OwoJCQl9KSwKCgkJCSJjb250YWlucyI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggdGV4dCApIHsKCQkJCXRleHQgPSB0ZXh0LnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuICggZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVyVGV4dCB8fCBnZXRUZXh0KCBlbGVtICkgKS5pbmRleE9mKCB0ZXh0ICkgPiAtMTsKCQkJCX07CgkJCX0pLAoKCQkJLy8gIldoZXRoZXIgYW4gZWxlbWVudCBpcyByZXByZXNlbnRlZCBieSBhIDpsYW5nKCkgc2VsZWN0b3IKCQkJLy8gaXMgYmFzZWQgc29sZWx5IG9uIHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUKCQkJLy8gYmVpbmcgZXF1YWwgdG8gdGhlIGlkZW50aWZpZXIgQywKCQkJLy8gb3IgYmVnaW5uaW5nIHdpdGggdGhlIGlkZW50aWZpZXIgQyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSAiLSIuCgkJCS8vIFRoZSBtYXRjaGluZyBvZiBDIGFnYWluc3QgdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZSBpcyBwZXJmb3JtZWQgY2FzZS1pbnNlbnNpdGl2ZWx5LgoJCQkvLyBUaGUgaWRlbnRpZmllciBDIGRvZXMgbm90IGhhdmUgdG8gYmUgYSB2YWxpZCBsYW5ndWFnZSBuYW1lLiIKCQkJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNsYW5nLXBzZXVkbwoJCQkibGFuZyI6IG1hcmtGdW5jdGlvbiggZnVuY3Rpb24oIGxhbmcgKSB7CgkJCQkvLyBsYW5nIHZhbHVlIG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyCgkJCQlpZiAoICFyaWRlbnRpZmllci50ZXN0KGxhbmcgfHwgIiIpICkgewoJCQkJCVNpenpsZS5lcnJvciggInVuc3VwcG9ydGVkIGxhbmc6ICIgKyBsYW5nICk7CgkJCQl9CgkJCQlsYW5nID0gbGFuZy5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIGVsZW1MYW5nOwoJCQkJCWRvIHsKCQkJCQkJaWYgKCAoZWxlbUxhbmcgPSBkb2N1bWVudElzSFRNTCA/CgkJCQkJCQllbGVtLmxhbmcgOgoJCQkJCQkJZWxlbS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIikgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoImxhbmciKSkgKSB7CgoJCQkJCQkJZWxlbUxhbmcgPSBlbGVtTGFuZy50b0xvd2VyQ2FzZSgpOwoJCQkJCQkJcmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YoIGxhbmcgKyAiLSIgKSA9PT0gMDsKCQkJCQkJfQoJCQkJCX0gd2hpbGUgKCAoZWxlbSA9IGVsZW0ucGFyZW50Tm9kZSkgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX07CgkJCX0pLAoKCQkJLy8gTWlzY2VsbGFuZW91cwoJCQkidGFyZ2V0IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQl2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbiAmJiB3aW5kb3cubG9jYXRpb24uaGFzaDsKCQkJCXJldHVybiBoYXNoICYmIGhhc2guc2xpY2UoIDEgKSA9PT0gZWxlbS5pZDsKCQkJfSwKCgkJCSJyb290IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbSA9PT0gZG9jRWxlbTsKCQkJfSwKCgkJCSJmb2N1cyI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKCFkb2N1bWVudC5oYXNGb2N1cyB8fCBkb2N1bWVudC5oYXNGb2N1cygpKSAmJiAhIShlbGVtLnR5cGUgfHwgZWxlbS5ocmVmIHx8IH5lbGVtLnRhYkluZGV4KTsKCQkJfSwKCgkJCS8vIEJvb2xlYW4gcHJvcGVydGllcwoJCQkiZW5hYmxlZCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IGZhbHNlOwoJCQl9LAoKCQkJImRpc2FibGVkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTsKCQkJfSwKCgkJCSJjaGVja2VkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBJbiBDU1MzLCA6Y2hlY2tlZCBzaG91bGQgcmV0dXJuIGJvdGggY2hlY2tlZCBhbmQgc2VsZWN0ZWQgZWxlbWVudHMKCQkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkCgkJCQl2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gKG5vZGVOYW1lID09PSAiaW5wdXQiICYmICEhZWxlbS5jaGVja2VkKSB8fCAobm9kZU5hbWUgPT09ICJvcHRpb24iICYmICEhZWxlbS5zZWxlY3RlZCk7CgkJCX0sCgoJCQkic2VsZWN0ZWQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCS8vIEFjY2Vzc2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHQKCQkJCS8vIG9wdGlvbnMgaW4gU2FmYXJpIHdvcmsgcHJvcGVybHkKCQkJCWlmICggZWxlbS5wYXJlbnROb2RlICkgewoJCQkJCWVsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4OwoJCQkJfQoKCQkJCXJldHVybiBlbGVtLnNlbGVjdGVkID09PSB0cnVlOwoJCQl9LAoKCQkJLy8gQ29udGVudHMKCQkJImVtcHR5IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2VtcHR5LXBzZXVkbwoJCQkJLy8gOmVtcHR5IGlzIG5lZ2F0ZWQgYnkgZWxlbWVudCAoMSkgb3IgY29udGVudCBub2RlcyAodGV4dDogMzsgY2RhdGE6IDQ7IGVudGl0eSByZWY6IDUpLAoJCQkJLy8gICBidXQgbm90IGJ5IG90aGVycyAoY29tbWVudDogODsgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbjogNzsgZXRjLikKCQkJCS8vIG5vZGVUeXBlIDwgNiB3b3JrcyBiZWNhdXNlIGF0dHJpYnV0ZXMgKDIpIGRvIG5vdCBhcHBlYXIgYXMgY2hpbGRyZW4KCQkJCWZvciAoIGVsZW0gPSBlbGVtLmZpcnN0Q2hpbGQ7IGVsZW07IGVsZW0gPSBlbGVtLm5leHRTaWJsaW5nICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA8IDYgKSB7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfSwKCgkJCSJwYXJlbnQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiAhRXhwci5wc2V1ZG9zWyJlbXB0eSJdKCBlbGVtICk7CgkJCX0sCgoJCQkvLyBFbGVtZW50L2lucHV0IHR5cGVzCgkJCSJoZWFkZXIiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiByaGVhZGVyLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTsKCQkJfSwKCgkJCSJpbnB1dCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIHJpbnB1dHMudGVzdCggZWxlbS5ub2RlTmFtZSApOwoJCQl9LAoKCQkJImJ1dHRvbiI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gbmFtZSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09ICJidXR0b24iIHx8IG5hbWUgPT09ICJidXR0b24iOwoJCQl9LAoKCQkJInRleHQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciBhdHRyOwoJCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiAmJgoJCQkJCWVsZW0udHlwZSA9PT0gInRleHQiICYmCgoJCQkJCS8vIFN1cHBvcnQ6IElFPDgKCQkJCQkvLyBOZXcgSFRNTDUgYXR0cmlidXRlIHZhbHVlcyAoZS5nLiwgInNlYXJjaCIpIGFwcGVhciB3aXRoIGVsZW0udHlwZSA9PT0gInRleHQiCgkJCQkJKCAoYXR0ciA9IGVsZW0uZ2V0QXR0cmlidXRlKCJ0eXBlIikpID09IG51bGwgfHwgYXR0ci50b0xvd2VyQ2FzZSgpID09PSAidGV4dCIgKTsKCQkJfSwKCgkJCS8vIFBvc2l0aW9uLWluLWNvbGxlY3Rpb24KCQkJImZpcnN0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbigpIHsKCQkJCXJldHVybiBbIDAgXTsKCQkJfSksCgoJCQkibGFzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJcmV0dXJuIFsgbGVuZ3RoIC0gMSBdOwoJCQl9KSwKCgkJCSJlcSI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHsKCQkJCXJldHVybiBbIGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQgXTsKCQkJfSksCgoJCQkiZXZlbiI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJdmFyIGkgPSAwOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJIm9kZCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJdmFyIGkgPSAxOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJImx0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkgewoJCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQkJZm9yICggOyAtLWkgPj0gMDsgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJImd0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkgewoJCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQkJZm9yICggOyArK2kgPCBsZW5ndGg7ICkgewoJCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCQl9CgkJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCQl9KQoJCX0KCX07CgoJRXhwci5wc2V1ZG9zWyJudGgiXSA9IEV4cHIucHNldWRvc1siZXEiXTsKCgkvLyBBZGQgYnV0dG9uL2lucHV0IHR5cGUgcHNldWRvcwoJZm9yICggaSBpbiB7IHJhZGlvOiB0cnVlLCBjaGVja2JveDogdHJ1ZSwgZmlsZTogdHJ1ZSwgcGFzc3dvcmQ6IHRydWUsIGltYWdlOiB0cnVlIH0gKSB7CgkJRXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVJbnB1dFBzZXVkbyggaSApOwoJfQoJZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgcmVzZXQ6IHRydWUgfSApIHsKCQlFeHByLnBzZXVkb3NbIGkgXSA9IGNyZWF0ZUJ1dHRvblBzZXVkbyggaSApOwoJfQoKCS8vIEVhc3kgQVBJIGZvciBjcmVhdGluZyBuZXcgc2V0RmlsdGVycwoJZnVuY3Rpb24gc2V0RmlsdGVycygpIHt9CglzZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvczsKCUV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7CgoJdG9rZW5pemUgPSBTaXp6bGUudG9rZW5pemUgPSBmdW5jdGlvbiggc2VsZWN0b3IsIHBhcnNlT25seSApIHsKCQl2YXIgbWF0Y2hlZCwgbWF0Y2gsIHRva2VucywgdHlwZSwKCQkJc29GYXIsIGdyb3VwcywgcHJlRmlsdGVycywKCQkJY2FjaGVkID0gdG9rZW5DYWNoZVsgc2VsZWN0b3IgKyAiICIgXTsKCgkJaWYgKCBjYWNoZWQgKSB7CgkJCXJldHVybiBwYXJzZU9ubHkgPyAwIDogY2FjaGVkLnNsaWNlKCAwICk7CgkJfQoKCQlzb0ZhciA9IHNlbGVjdG9yOwoJCWdyb3VwcyA9IFtdOwoJCXByZUZpbHRlcnMgPSBFeHByLnByZUZpbHRlcjsKCgkJd2hpbGUgKCBzb0ZhciApIHsKCgkJCS8vIENvbW1hIGFuZCBmaXJzdCBydW4KCQkJaWYgKCAhbWF0Y2hlZCB8fCAobWF0Y2ggPSByY29tbWEuZXhlYyggc29GYXIgKSkgKSB7CgkJCQlpZiAoIG1hdGNoICkgewoJCQkJCS8vIERvbid0IGNvbnN1bWUgdHJhaWxpbmcgY29tbWFzIGFzIHZhbGlkCgkJCQkJc29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hbMF0ubGVuZ3RoICkgfHwgc29GYXI7CgkJCQl9CgkJCQlncm91cHMucHVzaCggKHRva2VucyA9IFtdKSApOwoJCQl9CgoJCQltYXRjaGVkID0gZmFsc2U7CgoJCQkvLyBDb21iaW5hdG9ycwoJCQlpZiAoIChtYXRjaCA9IHJjb21iaW5hdG9ycy5leGVjKCBzb0ZhciApKSApIHsKCQkJCW1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpOwoJCQkJdG9rZW5zLnB1c2goewoJCQkJCXZhbHVlOiBtYXRjaGVkLAoJCQkJCS8vIENhc3QgZGVzY2VuZGFudCBjb21iaW5hdG9ycyB0byBzcGFjZQoJCQkJCXR5cGU6IG1hdGNoWzBdLnJlcGxhY2UoIHJ0cmltLCAiICIgKQoJCQkJfSk7CgkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQl9CgoJCQkvLyBGaWx0ZXJzCgkJCWZvciAoIHR5cGUgaW4gRXhwci5maWx0ZXIgKSB7CgkJCQlpZiAoIChtYXRjaCA9IG1hdGNoRXhwclsgdHlwZSBdLmV4ZWMoIHNvRmFyICkpICYmICghcHJlRmlsdGVyc1sgdHlwZSBdIHx8CgkJCQkJKG1hdGNoID0gcHJlRmlsdGVyc1sgdHlwZSBdKCBtYXRjaCApKSkgKSB7CgkJCQkJbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7CgkJCQkJdG9rZW5zLnB1c2goewoJCQkJCQl2YWx1ZTogbWF0Y2hlZCwKCQkJCQkJdHlwZTogdHlwZSwKCQkJCQkJbWF0Y2hlczogbWF0Y2gKCQkJCQl9KTsKCQkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQkJfQoJCQl9CgoJCQlpZiAoICFtYXRjaGVkICkgewoJCQkJYnJlYWs7CgkJCX0KCQl9CgoJCS8vIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBpbnZhbGlkIGV4Y2VzcwoJCS8vIGlmIHdlJ3JlIGp1c3QgcGFyc2luZwoJCS8vIE90aGVyd2lzZSwgdGhyb3cgYW4gZXJyb3Igb3IgcmV0dXJuIHRva2VucwoJCXJldHVybiBwYXJzZU9ubHkgPwoJCQlzb0Zhci5sZW5ndGggOgoJCQlzb0ZhciA/CgkJCQlTaXp6bGUuZXJyb3IoIHNlbGVjdG9yICkgOgoJCQkJLy8gQ2FjaGUgdGhlIHRva2VucwoJCQkJdG9rZW5DYWNoZSggc2VsZWN0b3IsIGdyb3VwcyApLnNsaWNlKCAwICk7Cgl9OwoKCWZ1bmN0aW9uIHRvU2VsZWN0b3IoIHRva2VucyApIHsKCQl2YXIgaSA9IDAsCgkJCWxlbiA9IHRva2Vucy5sZW5ndGgsCgkJCXNlbGVjdG9yID0gIiI7CgkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCXNlbGVjdG9yICs9IHRva2Vuc1tpXS52YWx1ZTsKCQl9CgkJcmV0dXJuIHNlbGVjdG9yOwoJfQoKCWZ1bmN0aW9uIGFkZENvbWJpbmF0b3IoIG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UgKSB7CgkJdmFyIGRpciA9IGNvbWJpbmF0b3IuZGlyLAoJCQljaGVja05vbkVsZW1lbnRzID0gYmFzZSAmJiBkaXIgPT09ICJwYXJlbnROb2RlIiwKCQkJZG9uZU5hbWUgPSBkb25lKys7CgoJCXJldHVybiBjb21iaW5hdG9yLmZpcnN0ID8KCQkJLy8gQ2hlY2sgYWdhaW5zdCBjbG9zZXN0IGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50CgkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkgewoJCQkJCQlyZXR1cm4gbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICk7CgkJCQkJfQoJCQkJfQoJCQl9IDoKCgkJCS8vIENoZWNrIGFnYWluc3QgYWxsIGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50cwoJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJdmFyIG9sZENhY2hlLCB1bmlxdWVDYWNoZSwgb3V0ZXJDYWNoZSwKCQkJCQluZXdDYWNoZSA9IFsgZGlycnVucywgZG9uZU5hbWUgXTsKCgkJCQkvLyBXZSBjYW4ndCBzZXQgYXJiaXRyYXJ5IGRhdGEgb24gWE1MIG5vZGVzLCBzbyB0aGV5IGRvbid0IGJlbmVmaXQgZnJvbSBjb21iaW5hdG9yIGNhY2hpbmcKCQkJCWlmICggeG1sICkgewoJCQkJCXdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7CgkJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkgewoJCQkJCQkJaWYgKCBtYXRjaGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJd2hpbGUgKCAoZWxlbSA9IGVsZW1bIGRpciBdKSApIHsKCQkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7CgkJCQkJCQlvdXRlckNhY2hlID0gZWxlbVsgZXhwYW5kbyBdIHx8IChlbGVtWyBleHBhbmRvIF0gPSB7fSk7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJLy8gRGVmZW5kIGFnYWluc3QgY2xvbmVkIGF0dHJvcGVydGllcyAoalF1ZXJ5IGdoLTE3MDkpCgkJCQkJCQl1bmlxdWVDYWNoZSA9IG91dGVyQ2FjaGVbIGVsZW0udW5pcXVlSUQgXSB8fCAob3V0ZXJDYWNoZVsgZWxlbS51bmlxdWVJRCBdID0ge30pOwoKCQkJCQkJCWlmICggKG9sZENhY2hlID0gdW5pcXVlQ2FjaGVbIGRpciBdKSAmJgoJCQkJCQkJCW9sZENhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgb2xkQ2FjaGVbIDEgXSA9PT0gZG9uZU5hbWUgKSB7CgoJCQkJCQkJCS8vIEFzc2lnbiB0byBuZXdDYWNoZSBzbyByZXN1bHRzIGJhY2stcHJvcGFnYXRlIHRvIHByZXZpb3VzIGVsZW1lbnRzCgkJCQkJCQkJcmV0dXJuIChuZXdDYWNoZVsgMiBdID0gb2xkQ2FjaGVbIDIgXSk7CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCS8vIFJldXNlIG5ld2NhY2hlIHNvIHJlc3VsdHMgYmFjay1wcm9wYWdhdGUgdG8gcHJldmlvdXMgZWxlbWVudHMKCQkJCQkJCQl1bmlxdWVDYWNoZVsgZGlyIF0gPSBuZXdDYWNoZTsKCgkJCQkJCQkJLy8gQSBtYXRjaCBtZWFucyB3ZSdyZSBkb25lOyBhIGZhaWwgbWVhbnMgd2UgaGF2ZSB0byBrZWVwIGNoZWNraW5nCgkJCQkJCQkJaWYgKCAobmV3Q2FjaGVbIDIgXSA9IG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApKSApIHsKCQkJCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9OwoJfQoKCWZ1bmN0aW9uIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApIHsKCQlyZXR1cm4gbWF0Y2hlcnMubGVuZ3RoID4gMSA/CgkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggIW1hdGNoZXJzW2ldKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiB0cnVlOwoJCQl9IDoKCQkJbWF0Y2hlcnNbMF07Cgl9CgoJZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IsIGNvbnRleHRzLCByZXN1bHRzICkgewoJCXZhciBpID0gMCwKCQkJbGVuID0gY29udGV4dHMubGVuZ3RoOwoJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQlTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0c1tpXSwgcmVzdWx0cyApOwoJCX0KCQlyZXR1cm4gcmVzdWx0czsKCX0KCglmdW5jdGlvbiBjb25kZW5zZSggdW5tYXRjaGVkLCBtYXAsIGZpbHRlciwgY29udGV4dCwgeG1sICkgewoJCXZhciBlbGVtLAoJCQluZXdVbm1hdGNoZWQgPSBbXSwKCQkJaSA9IDAsCgkJCWxlbiA9IHVubWF0Y2hlZC5sZW5ndGgsCgkJCW1hcHBlZCA9IG1hcCAhPSBudWxsOwoKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgKSB7CgkJCQlpZiAoICFmaWx0ZXIgfHwgZmlsdGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQluZXdVbm1hdGNoZWQucHVzaCggZWxlbSApOwoJCQkJCWlmICggbWFwcGVkICkgewoJCQkJCQltYXAucHVzaCggaSApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIG5ld1VubWF0Y2hlZDsKCX0KCglmdW5jdGlvbiBzZXRNYXRjaGVyKCBwcmVGaWx0ZXIsIHNlbGVjdG9yLCBtYXRjaGVyLCBwb3N0RmlsdGVyLCBwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IgKSB7CgkJaWYgKCBwb3N0RmlsdGVyICYmICFwb3N0RmlsdGVyWyBleHBhbmRvIF0gKSB7CgkJCXBvc3RGaWx0ZXIgPSBzZXRNYXRjaGVyKCBwb3N0RmlsdGVyICk7CgkJfQoJCWlmICggcG9zdEZpbmRlciAmJiAhcG9zdEZpbmRlclsgZXhwYW5kbyBdICkgewoJCQlwb3N0RmluZGVyID0gc2V0TWF0Y2hlciggcG9zdEZpbmRlciwgcG9zdFNlbGVjdG9yICk7CgkJfQoJCXJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIHJlc3VsdHMsIGNvbnRleHQsIHhtbCApIHsKCQkJdmFyIHRlbXAsIGksIGVsZW0sCgkJCQlwcmVNYXAgPSBbXSwKCQkJCXBvc3RNYXAgPSBbXSwKCQkJCXByZWV4aXN0aW5nID0gcmVzdWx0cy5sZW5ndGgsCgoJCQkJLy8gR2V0IGluaXRpYWwgZWxlbWVudHMgZnJvbSBzZWVkIG9yIGNvbnRleHQKCQkJCWVsZW1zID0gc2VlZCB8fCBtdWx0aXBsZUNvbnRleHRzKCBzZWxlY3RvciB8fCAiKiIsIGNvbnRleHQubm9kZVR5cGUgPyBbIGNvbnRleHQgXSA6IGNvbnRleHQsIFtdICksCgoJCQkJLy8gUHJlZmlsdGVyIHRvIGdldCBtYXRjaGVyIGlucHV0LCBwcmVzZXJ2aW5nIGEgbWFwIGZvciBzZWVkLXJlc3VsdHMgc3luY2hyb25pemF0aW9uCgkJCQltYXRjaGVySW4gPSBwcmVGaWx0ZXIgJiYgKCBzZWVkIHx8ICFzZWxlY3RvciApID8KCQkJCQljb25kZW5zZSggZWxlbXMsIHByZU1hcCwgcHJlRmlsdGVyLCBjb250ZXh0LCB4bWwgKSA6CgkJCQkJZWxlbXMsCgoJCQkJbWF0Y2hlck91dCA9IG1hdGNoZXIgPwoJCQkJCS8vIElmIHdlIGhhdmUgYSBwb3N0RmluZGVyLCBvciBmaWx0ZXJlZCBzZWVkLCBvciBub24tc2VlZCBwb3N0RmlsdGVyIG9yIHByZWV4aXN0aW5nIHJlc3VsdHMsCgkJCQkJcG9zdEZpbmRlciB8fCAoIHNlZWQgPyBwcmVGaWx0ZXIgOiBwcmVleGlzdGluZyB8fCBwb3N0RmlsdGVyICkgPwoKCQkJCQkJLy8gLi4uaW50ZXJtZWRpYXRlIHByb2Nlc3NpbmcgaXMgbmVjZXNzYXJ5CgkJCQkJCVtdIDoKCgkJCQkJCS8vIC4uLm90aGVyd2lzZSB1c2UgcmVzdWx0cyBkaXJlY3RseQoJCQkJCQlyZXN1bHRzIDoKCQkJCQltYXRjaGVySW47CgoJCQkvLyBGaW5kIHByaW1hcnkgbWF0Y2hlcwoJCQlpZiAoIG1hdGNoZXIgKSB7CgkJCQltYXRjaGVyKCBtYXRjaGVySW4sIG1hdGNoZXJPdXQsIGNvbnRleHQsIHhtbCApOwoJCQl9CgoJCQkvLyBBcHBseSBwb3N0RmlsdGVyCgkJCWlmICggcG9zdEZpbHRlciApIHsKCQkJCXRlbXAgPSBjb25kZW5zZSggbWF0Y2hlck91dCwgcG9zdE1hcCApOwoJCQkJcG9zdEZpbHRlciggdGVtcCwgW10sIGNvbnRleHQsIHhtbCApOwoKCQkJCS8vIFVuLW1hdGNoIGZhaWxpbmcgZWxlbWVudHMgYnkgbW92aW5nIHRoZW0gYmFjayB0byBtYXRjaGVySW4KCQkJCWkgPSB0ZW1wLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggKGVsZW0gPSB0ZW1wW2ldKSApIHsKCQkJCQkJbWF0Y2hlck91dFsgcG9zdE1hcFtpXSBdID0gIShtYXRjaGVySW5bIHBvc3RNYXBbaV0gXSA9IGVsZW0pOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKCBzZWVkICkgewoJCQkJaWYgKCBwb3N0RmluZGVyIHx8IHByZUZpbHRlciApIHsKCQkJCQlpZiAoIHBvc3RGaW5kZXIgKSB7CgkJCQkJCS8vIEdldCB0aGUgZmluYWwgbWF0Y2hlck91dCBieSBjb25kZW5zaW5nIHRoaXMgaW50ZXJtZWRpYXRlIGludG8gcG9zdEZpbmRlciBjb250ZXh0cwoJCQkJCQl0ZW1wID0gW107CgkJCQkJCWkgPSBtYXRjaGVyT3V0Lmxlbmd0aDsKCQkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgKSB7CgkJCQkJCQkJLy8gUmVzdG9yZSBtYXRjaGVySW4gc2luY2UgZWxlbSBpcyBub3QgeWV0IGEgZmluYWwgbWF0Y2gKCQkJCQkJCQl0ZW1wLnB1c2goIChtYXRjaGVySW5baV0gPSBlbGVtKSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXBvc3RGaW5kZXIoIG51bGwsIChtYXRjaGVyT3V0ID0gW10pLCB0ZW1wLCB4bWwgKTsKCQkJCQl9CgoJCQkJCS8vIE1vdmUgbWF0Y2hlZCBlbGVtZW50cyBmcm9tIHNlZWQgdG8gcmVzdWx0cyB0byBrZWVwIHRoZW0gc3luY2hyb25pemVkCgkJCQkJaSA9IG1hdGNoZXJPdXQubGVuZ3RoOwoJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgJiYKCQkJCQkJCSh0ZW1wID0gcG9zdEZpbmRlciA/IGluZGV4T2YoIHNlZWQsIGVsZW0gKSA6IHByZU1hcFtpXSkgPiAtMSApIHsKCgkJCQkJCQlzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkvLyBBZGQgZWxlbWVudHMgdG8gcmVzdWx0cywgdGhyb3VnaCBwb3N0RmluZGVyIGlmIGRlZmluZWQKCQkJfSBlbHNlIHsKCQkJCW1hdGNoZXJPdXQgPSBjb25kZW5zZSgKCQkJCQltYXRjaGVyT3V0ID09PSByZXN1bHRzID8KCQkJCQkJbWF0Y2hlck91dC5zcGxpY2UoIHByZWV4aXN0aW5nLCBtYXRjaGVyT3V0Lmxlbmd0aCApIDoKCQkJCQkJbWF0Y2hlck91dAoJCQkJKTsKCQkJCWlmICggcG9zdEZpbmRlciApIHsKCQkJCQlwb3N0RmluZGVyKCBudWxsLCByZXN1bHRzLCBtYXRjaGVyT3V0LCB4bWwgKTsKCQkJCX0gZWxzZSB7CgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgbWF0Y2hlck91dCApOwoJCQkJfQoJCQl9CgkJfSk7Cgl9CgoJZnVuY3Rpb24gbWF0Y2hlckZyb21Ub2tlbnMoIHRva2VucyApIHsKCQl2YXIgY2hlY2tDb250ZXh0LCBtYXRjaGVyLCBqLAoJCQlsZW4gPSB0b2tlbnMubGVuZ3RoLAoJCQlsZWFkaW5nUmVsYXRpdmUgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbMF0udHlwZSBdLAoJCQlpbXBsaWNpdFJlbGF0aXZlID0gbGVhZGluZ1JlbGF0aXZlIHx8IEV4cHIucmVsYXRpdmVbIiAiXSwKCQkJaSA9IGxlYWRpbmdSZWxhdGl2ZSA/IDEgOiAwLAoKCQkJLy8gVGhlIGZvdW5kYXRpb25hbCBtYXRjaGVyIGVuc3VyZXMgdGhhdCBlbGVtZW50cyBhcmUgcmVhY2hhYmxlIGZyb20gdG9wLWxldmVsIGNvbnRleHQocykKCQkJbWF0Y2hDb250ZXh0ID0gYWRkQ29tYmluYXRvciggZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbSA9PT0gY2hlY2tDb250ZXh0OwoJCQl9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlICksCgkJCW1hdGNoQW55Q29udGV4dCA9IGFkZENvbWJpbmF0b3IoIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGluZGV4T2YoIGNoZWNrQ29udGV4dCwgZWxlbSApID4gLTE7CgkJCX0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUgKSwKCQkJbWF0Y2hlcnMgPSBbIGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl2YXIgcmV0ID0gKCAhbGVhZGluZ1JlbGF0aXZlICYmICggeG1sIHx8IGNvbnRleHQgIT09IG91dGVybW9zdENvbnRleHQgKSApIHx8ICgKCQkJCQkoY2hlY2tDb250ZXh0ID0gY29udGV4dCkubm9kZVR5cGUgPwoJCQkJCQltYXRjaENvbnRleHQoIGVsZW0sIGNvbnRleHQsIHhtbCApIDoKCQkJCQkJbWF0Y2hBbnlDb250ZXh0KCBlbGVtLCBjb250ZXh0LCB4bWwgKSApOwoJCQkJLy8gQXZvaWQgaGFuZ2luZyBvbnRvIGVsZW1lbnQgKGlzc3VlICMyOTkpCgkJCQljaGVja0NvbnRleHQgPSBudWxsOwoJCQkJcmV0dXJuIHJldDsKCQkJfSBdOwoKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCAobWF0Y2hlciA9IEV4cHIucmVsYXRpdmVbIHRva2Vuc1tpXS50eXBlIF0pICkgewoJCQkJbWF0Y2hlcnMgPSBbIGFkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICksIG1hdGNoZXIpIF07CgkJCX0gZWxzZSB7CgkJCQltYXRjaGVyID0gRXhwci5maWx0ZXJbIHRva2Vuc1tpXS50eXBlIF0uYXBwbHkoIG51bGwsIHRva2Vuc1tpXS5tYXRjaGVzICk7CgoJCQkJLy8gUmV0dXJuIHNwZWNpYWwgdXBvbiBzZWVpbmcgYSBwb3NpdGlvbmFsIG1hdGNoZXIKCQkJCWlmICggbWF0Y2hlclsgZXhwYW5kbyBdICkgewoJCQkJCS8vIEZpbmQgdGhlIG5leHQgcmVsYXRpdmUgb3BlcmF0b3IgKGlmIGFueSkgZm9yIHByb3BlciBoYW5kbGluZwoJCQkJCWogPSArK2k7CgkJCQkJZm9yICggOyBqIDwgbGVuOyBqKysgKSB7CgkJCQkJCWlmICggRXhwci5yZWxhdGl2ZVsgdG9rZW5zW2pdLnR5cGUgXSApIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJCXJldHVybiBzZXRNYXRjaGVyKAoJCQkJCQlpID4gMSAmJiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKSwKCQkJCQkJaSA+IDEgJiYgdG9TZWxlY3RvcigKCQkJCQkJCS8vIElmIHRoZSBwcmVjZWRpbmcgdG9rZW4gd2FzIGEgZGVzY2VuZGFudCBjb21iaW5hdG9yLCBpbnNlcnQgYW4gaW1wbGljaXQgYW55LWVsZW1lbnQgYCpgCgkJCQkJCQl0b2tlbnMuc2xpY2UoIDAsIGkgLSAxICkuY29uY2F0KHsgdmFsdWU6IHRva2Vuc1sgaSAtIDIgXS50eXBlID09PSAiICIgPyAiKiIgOiAiIiB9KQoJCQkJCQkpLnJlcGxhY2UoIHJ0cmltLCAiJDEiICksCgkJCQkJCW1hdGNoZXIsCgkJCQkJCWkgPCBqICYmIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMuc2xpY2UoIGksIGogKSApLAoJCQkJCQlqIDwgbGVuICYmIG1hdGNoZXJGcm9tVG9rZW5zKCAodG9rZW5zID0gdG9rZW5zLnNsaWNlKCBqICkpICksCgkJCQkJCWogPCBsZW4gJiYgdG9TZWxlY3RvciggdG9rZW5zICkKCQkJCQkpOwoJCQkJfQoJCQkJbWF0Y2hlcnMucHVzaCggbWF0Y2hlciApOwoJCQl9CgkJfQoKCQlyZXR1cm4gZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICk7Cgl9CgoJZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKCBlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzICkgewoJCXZhciBieVNldCA9IHNldE1hdGNoZXJzLmxlbmd0aCA+IDAsCgkJCWJ5RWxlbWVudCA9IGVsZW1lbnRNYXRjaGVycy5sZW5ndGggPiAwLAoJCQlzdXBlck1hdGNoZXIgPSBmdW5jdGlvbiggc2VlZCwgY29udGV4dCwgeG1sLCByZXN1bHRzLCBvdXRlcm1vc3QgKSB7CgkJCQl2YXIgZWxlbSwgaiwgbWF0Y2hlciwKCQkJCQltYXRjaGVkQ291bnQgPSAwLAoJCQ==", "base64"));
  res.write(new Buffer("CQkJaSA9ICIwIiwKCQkJCQl1bm1hdGNoZWQgPSBzZWVkICYmIFtdLAoJCQkJCXNldE1hdGNoZWQgPSBbXSwKCQkJCQljb250ZXh0QmFja3VwID0gb3V0ZXJtb3N0Q29udGV4dCwKCQkJCQkvLyBXZSBtdXN0IGFsd2F5cyBoYXZlIGVpdGhlciBzZWVkIGVsZW1lbnRzIG9yIG91dGVybW9zdCBjb250ZXh0CgkJCQkJZWxlbXMgPSBzZWVkIHx8IGJ5RWxlbWVudCAmJiBFeHByLmZpbmRbIlRBRyJdKCAiKiIsIG91dGVybW9zdCApLAoJCQkJCS8vIFVzZSBpbnRlZ2VyIGRpcnJ1bnMgaWZmIHRoaXMgaXMgdGhlIG91dGVybW9zdCBtYXRjaGVyCgkJCQkJZGlycnVuc1VuaXF1ZSA9IChkaXJydW5zICs9IGNvbnRleHRCYWNrdXAgPT0gbnVsbCA/IDEgOiBNYXRoLnJhbmRvbSgpIHx8IDAuMSksCgkJCQkJbGVuID0gZWxlbXMubGVuZ3RoOwoKCQkJCWlmICggb3V0ZXJtb3N0ICkgewoJCQkJCW91dGVybW9zdENvbnRleHQgPSBjb250ZXh0ID09PSBkb2N1bWVudCB8fCBjb250ZXh0IHx8IG91dGVybW9zdDsKCQkJCX0KCgkJCQkvLyBBZGQgZWxlbWVudHMgcGFzc2luZyBlbGVtZW50TWF0Y2hlcnMgZGlyZWN0bHkgdG8gcmVzdWx0cwoJCQkJLy8gU3VwcG9ydDogSUU8OSwgU2FmYXJpCgkJCQkvLyBUb2xlcmF0ZSBOb2RlTGlzdCBwcm9wZXJ0aWVzIChJRTogImxlbmd0aCI7IFNhZmFyaTogPG51bWJlcj4pIG1hdGNoaW5nIGVsZW1lbnRzIGJ5IGlkCgkJCQlmb3IgKCA7IGkgIT09IGxlbiAmJiAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7CgkJCQkJaWYgKCBieUVsZW1lbnQgJiYgZWxlbSApIHsKCQkJCQkJaiA9IDA7CgkJCQkJCWlmICggIWNvbnRleHQgJiYgZWxlbS5vd25lckRvY3VtZW50ICE9PSBkb2N1bWVudCApIHsKCQkJCQkJCXNldERvY3VtZW50KCBlbGVtICk7CgkJCQkJCQl4bWwgPSAhZG9jdW1lbnRJc0hUTUw7CgkJCQkJCX0KCQkJCQkJd2hpbGUgKCAobWF0Y2hlciA9IGVsZW1lbnRNYXRjaGVyc1tqKytdKSApIHsKCQkJCQkJCWlmICggbWF0Y2hlciggZWxlbSwgY29udGV4dCB8fCBkb2N1bWVudCwgeG1sKSApIHsKCQkJCQkJCQlyZXN1bHRzLnB1c2goIGVsZW0gKTsKCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlpZiAoIG91dGVybW9zdCApIHsKCQkJCQkJCWRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBUcmFjayB1bm1hdGNoZWQgZWxlbWVudHMgZm9yIHNldCBmaWx0ZXJzCgkJCQkJaWYgKCBieVNldCApIHsKCQkJCQkJLy8gVGhleSB3aWxsIGhhdmUgZ29uZSB0aHJvdWdoIGFsbCBwb3NzaWJsZSBtYXRjaGVycwoJCQkJCQlpZiAoIChlbGVtID0gIW1hdGNoZXIgJiYgZWxlbSkgKSB7CgkJCQkJCQltYXRjaGVkQ291bnQtLTsKCQkJCQkJfQoKCQkJCQkJLy8gTGVuZ3RoZW4gdGhlIGFycmF5IGZvciBldmVyeSBlbGVtZW50LCBtYXRjaGVkIG9yIG5vdAoJCQkJCQlpZiAoIHNlZWQgKSB7CgkJCQkJCQl1bm1hdGNoZWQucHVzaCggZWxlbSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIGBpYCBpcyBub3cgdGhlIGNvdW50IG9mIGVsZW1lbnRzIHZpc2l0ZWQgYWJvdmUsIGFuZCBhZGRpbmcgaXQgdG8gYG1hdGNoZWRDb3VudGAKCQkJCS8vIG1ha2VzIHRoZSBsYXR0ZXIgbm9ubmVnYXRpdmUuCgkJCQltYXRjaGVkQ291bnQgKz0gaTsKCgkJCQkvLyBBcHBseSBzZXQgZmlsdGVycyB0byB1bm1hdGNoZWQgZWxlbWVudHMKCQkJCS8vIE5PVEU6IFRoaXMgY2FuIGJlIHNraXBwZWQgaWYgdGhlcmUgYXJlIG5vIHVubWF0Y2hlZCBlbGVtZW50cyAoaS5lLiwgYG1hdGNoZWRDb3VudGAKCQkJCS8vIGVxdWFscyBgaWApLCB1bmxlc3Mgd2UgZGlkbid0IHZpc2l0IF9hbnlfIGVsZW1lbnRzIGluIHRoZSBhYm92ZSBsb29wIGJlY2F1c2Ugd2UgaGF2ZQoJCQkJLy8gbm8gZWxlbWVudCBtYXRjaGVycyBhbmQgbm8gc2VlZC4KCQkJCS8vIEluY3JlbWVudGluZyBhbiBpbml0aWFsbHktc3RyaW5nICIwIiBgaWAgYWxsb3dzIGBpYCB0byByZW1haW4gYSBzdHJpbmcgb25seSBpbiB0aGF0CgkJCQkvLyBjYXNlLCB3aGljaCB3aWxsIHJlc3VsdCBpbiBhICIwMCIgYG1hdGNoZWRDb3VudGAgdGhhdCBkaWZmZXJzIGZyb20gYGlgIGJ1dCBpcyBhbHNvCgkJCQkvLyBudW1lcmljYWxseSB6ZXJvLgoJCQkJaWYgKCBieVNldCAmJiBpICE9PSBtYXRjaGVkQ291bnQgKSB7CgkJCQkJaiA9IDA7CgkJCQkJd2hpbGUgKCAobWF0Y2hlciA9IHNldE1hdGNoZXJzW2orK10pICkgewoJCQkJCQltYXRjaGVyKCB1bm1hdGNoZWQsIHNldE1hdGNoZWQsIGNvbnRleHQsIHhtbCApOwoJCQkJCX0KCgkJCQkJaWYgKCBzZWVkICkgewoJCQkJCQkvLyBSZWludGVncmF0ZSBlbGVtZW50IG1hdGNoZXMgdG8gZWxpbWluYXRlIHRoZSBuZWVkIGZvciBzb3J0aW5nCgkJCQkJCWlmICggbWF0Y2hlZENvdW50ID4gMCApIHsKCQkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJCWlmICggISh1bm1hdGNoZWRbaV0gfHwgc2V0TWF0Y2hlZFtpXSkgKSB7CgkJCQkJCQkJCXNldE1hdGNoZWRbaV0gPSBwb3AuY2FsbCggcmVzdWx0cyApOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gRGlzY2FyZCBpbmRleCBwbGFjZWhvbGRlciB2YWx1ZXMgdG8gZ2V0IG9ubHkgYWN0dWFsIG1hdGNoZXMKCQkJCQkJc2V0TWF0Y2hlZCA9IGNvbmRlbnNlKCBzZXRNYXRjaGVkICk7CgkJCQkJfQoKCQkJCQkvLyBBZGQgbWF0Y2hlcyB0byByZXN1bHRzCgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgc2V0TWF0Y2hlZCApOwoKCQkJCQkvLyBTZWVkbGVzcyBzZXQgbWF0Y2hlcyBzdWNjZWVkaW5nIG11bHRpcGxlIHN1Y2Nlc3NmdWwgbWF0Y2hlcnMgc3RpcHVsYXRlIHNvcnRpbmcKCQkJCQlpZiAoIG91dGVybW9zdCAmJiAhc2VlZCAmJiBzZXRNYXRjaGVkLmxlbmd0aCA+IDAgJiYKCQkJCQkJKCBtYXRjaGVkQ291bnQgKyBzZXRNYXRjaGVycy5sZW5ndGggKSA+IDEgKSB7CgoJCQkJCQlTaXp6bGUudW5pcXVlU29ydCggcmVzdWx0cyApOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBPdmVycmlkZSBtYW5pcHVsYXRpb24gb2YgZ2xvYmFscyBieSBuZXN0ZWQgbWF0Y2hlcnMKCQkJCWlmICggb3V0ZXJtb3N0ICkgewoJCQkJCWRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwoJCQkJCW91dGVybW9zdENvbnRleHQgPSBjb250ZXh0QmFja3VwOwoJCQkJfQoKCQkJCXJldHVybiB1bm1hdGNoZWQ7CgkJCX07CgoJCXJldHVybiBieVNldCA/CgkJCW1hcmtGdW5jdGlvbiggc3VwZXJNYXRjaGVyICkgOgoJCQlzdXBlck1hdGNoZXI7Cgl9CgoJY29tcGlsZSA9IFNpenpsZS5jb21waWxlID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBtYXRjaCAvKiBJbnRlcm5hbCBVc2UgT25seSAqLyApIHsKCQl2YXIgaSwKCQkJc2V0TWF0Y2hlcnMgPSBbXSwKCQkJZWxlbWVudE1hdGNoZXJzID0gW10sCgkJCWNhY2hlZCA9IGNvbXBpbGVyQ2FjaGVbIHNlbGVjdG9yICsgIiAiIF07CgoJCWlmICggIWNhY2hlZCApIHsKCQkJLy8gR2VuZXJhdGUgYSBmdW5jdGlvbiBvZiByZWN1cnNpdmUgZnVuY3Rpb25zIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2hlY2sgZWFjaCBlbGVtZW50CgkJCWlmICggIW1hdGNoICkgewoJCQkJbWF0Y2ggPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCQkJfQoJCQlpID0gbWF0Y2gubGVuZ3RoOwoJCQl3aGlsZSAoIGktLSApIHsKCQkJCWNhY2hlZCA9IG1hdGNoZXJGcm9tVG9rZW5zKCBtYXRjaFtpXSApOwoJCQkJaWYgKCBjYWNoZWRbIGV4cGFuZG8gXSApIHsKCQkJCQlzZXRNYXRjaGVycy5wdXNoKCBjYWNoZWQgKTsKCQkJCX0gZWxzZSB7CgkJCQkJZWxlbWVudE1hdGNoZXJzLnB1c2goIGNhY2hlZCApOwoJCQkJfQoJCQl9CgoJCQkvLyBDYWNoZSB0aGUgY29tcGlsZWQgZnVuY3Rpb24KCQkJY2FjaGVkID0gY29tcGlsZXJDYWNoZSggc2VsZWN0b3IsIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyggZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycyApICk7CgoJCQkvLyBTYXZlIHNlbGVjdG9yIGFuZCB0b2tlbml6YXRpb24KCQkJY2FjaGVkLnNlbGVjdG9yID0gc2VsZWN0b3I7CgkJfQoJCXJldHVybiBjYWNoZWQ7Cgl9OwoKCS8qKgoJICogQSBsb3ctbGV2ZWwgc2VsZWN0aW9uIGZ1bmN0aW9uIHRoYXQgd29ya3Mgd2l0aCBTaXp6bGUncyBjb21waWxlZAoJICogIHNlbGVjdG9yIGZ1bmN0aW9ucwoJICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHNlbGVjdG9yIEEgc2VsZWN0b3Igb3IgYSBwcmUtY29tcGlsZWQKCSAqICBzZWxlY3RvciBmdW5jdGlvbiBidWlsdCB3aXRoIFNpenpsZS5jb21waWxlCgkgKiBAcGFyYW0ge0VsZW1lbnR9IGNvbnRleHQKCSAqIEBwYXJhbSB7QXJyYXl9IFtyZXN1bHRzXQoJICogQHBhcmFtIHtBcnJheX0gW3NlZWRdIEEgc2V0IG9mIGVsZW1lbnRzIHRvIG1hdGNoIGFnYWluc3QKCSAqLwoJc2VsZWN0ID0gU2l6emxlLnNlbGVjdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHsKCQl2YXIgaSwgdG9rZW5zLCB0b2tlbiwgdHlwZSwgZmluZCwKCQkJY29tcGlsZWQgPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICJmdW5jdGlvbiIgJiYgc2VsZWN0b3IsCgkJCW1hdGNoID0gIXNlZWQgJiYgdG9rZW5pemUoIChzZWxlY3RvciA9IGNvbXBpbGVkLnNlbGVjdG9yIHx8IHNlbGVjdG9yKSApOwoKCQlyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTsKCgkJLy8gVHJ5IHRvIG1pbmltaXplIG9wZXJhdGlvbnMgaWYgdGhlcmUgaXMgb25seSBvbmUgc2VsZWN0b3IgaW4gdGhlIGxpc3QgYW5kIG5vIHNlZWQKCQkvLyAodGhlIGxhdHRlciBvZiB3aGljaCBndWFyYW50ZWVzIHVzIGNvbnRleHQpCgkJaWYgKCBtYXRjaC5sZW5ndGggPT09IDEgKSB7CgoJCQkvLyBSZWR1Y2UgY29udGV4dCBpZiB0aGUgbGVhZGluZyBjb21wb3VuZCBzZWxlY3RvciBpcyBhbiBJRAoJCQl0b2tlbnMgPSBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwICk7CgkJCWlmICggdG9rZW5zLmxlbmd0aCA+IDIgJiYgKHRva2VuID0gdG9rZW5zWzBdKS50eXBlID09PSAiSUQiICYmCgkJCQkJc3VwcG9ydC5nZXRCeUlkICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDkgJiYgZG9jdW1lbnRJc0hUTUwgJiYKCQkJCQlFeHByLnJlbGF0aXZlWyB0b2tlbnNbMV0udHlwZSBdICkgewoKCQkJCWNvbnRleHQgPSAoIEV4cHIuZmluZFsiSUQiXSggdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKSwgY29udGV4dCApIHx8IFtdIClbMF07CgkJCQlpZiAoICFjb250ZXh0ICkgewoJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCS8vIFByZWNvbXBpbGVkIG1hdGNoZXJzIHdpbGwgc3RpbGwgdmVyaWZ5IGFuY2VzdHJ5LCBzbyBzdGVwIHVwIGEgbGV2ZWwKCQkJCX0gZWxzZSBpZiAoIGNvbXBpbGVkICkgewoJCQkJCWNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7CgkJCQl9CgoJCQkJc2VsZWN0b3IgPSBzZWxlY3Rvci5zbGljZSggdG9rZW5zLnNoaWZ0KCkudmFsdWUubGVuZ3RoICk7CgkJCX0KCgkJCS8vIEZldGNoIGEgc2VlZCBzZXQgZm9yIHJpZ2h0LXRvLWxlZnQgbWF0Y2hpbmcKCQkJaSA9IG1hdGNoRXhwclsibmVlZHNDb250ZXh0Il0udGVzdCggc2VsZWN0b3IgKSA/IDAgOiB0b2tlbnMubGVuZ3RoOwoJCQl3aGlsZSAoIGktLSApIHsKCQkJCXRva2VuID0gdG9rZW5zW2ldOwoKCQkJCS8vIEFib3J0IGlmIHdlIGhpdCBhIGNvbWJpbmF0b3IKCQkJCWlmICggRXhwci5yZWxhdGl2ZVsgKHR5cGUgPSB0b2tlbi50eXBlKSBdICkgewoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJaWYgKCAoZmluZCA9IEV4cHIuZmluZFsgdHlwZSBdKSApIHsKCQkJCQkvLyBTZWFyY2gsIGV4cGFuZGluZyBjb250ZXh0IGZvciBsZWFkaW5nIHNpYmxpbmcgY29tYmluYXRvcnMKCQkJCQlpZiAoIChzZWVkID0gZmluZCgKCQkJCQkJdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLAoJCQkJCQlyc2libGluZy50ZXN0KCB0b2tlbnNbMF0udHlwZSApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0CgkJCQkJKSkgKSB7CgoJCQkJCQkvLyBJZiBzZWVkIGlzIGVtcHR5IG9yIG5vIHRva2VucyByZW1haW4sIHdlIGNhbiByZXR1cm4gZWFybHkKCQkJCQkJdG9rZW5zLnNwbGljZSggaSwgMSApOwoJCQkJCQlzZWxlY3RvciA9IHNlZWQubGVuZ3RoICYmIHRvU2VsZWN0b3IoIHRva2VucyApOwoJCQkJCQlpZiAoICFzZWxlY3RvciApIHsKCQkJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsIHNlZWQgKTsKCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQl9CgoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZAoJCS8vIFByb3ZpZGUgYG1hdGNoYCB0byBhdm9pZCByZXRva2VuaXphdGlvbiBpZiB3ZSBtb2RpZmllZCB0aGUgc2VsZWN0b3IgYWJvdmUKCQkoIGNvbXBpbGVkIHx8IGNvbXBpbGUoIHNlbGVjdG9yLCBtYXRjaCApICkoCgkJCXNlZWQsCgkJCWNvbnRleHQsCgkJCSFkb2N1bWVudElzSFRNTCwKCQkJcmVzdWx0cywKCQkJIWNvbnRleHQgfHwgcnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dAoJCSk7CgkJcmV0dXJuIHJlc3VsdHM7Cgl9OwoKCS8vIE9uZS10aW1lIGFzc2lnbm1lbnRzCgoJLy8gU29ydCBzdGFiaWxpdHkKCXN1cHBvcnQuc29ydFN0YWJsZSA9IGV4cGFuZG8uc3BsaXQoIiIpLnNvcnQoIHNvcnRPcmRlciApLmpvaW4oIiIpID09PSBleHBhbmRvOwoKCS8vIFN1cHBvcnQ6IENocm9tZSAxNC0zNSsKCS8vIEFsd2F5cyBhc3N1bWUgZHVwbGljYXRlcyBpZiB0aGV5IGFyZW4ndCBwYXNzZWQgdG8gdGhlIGNvbXBhcmlzb24gZnVuY3Rpb24KCXN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcyA9ICEhaGFzRHVwbGljYXRlOwoKCS8vIEluaXRpYWxpemUgYWdhaW5zdCB0aGUgZGVmYXVsdCBkb2N1bWVudAoJc2V0RG9jdW1lbnQoKTsKCgkvLyBTdXBwb3J0OiBXZWJraXQ8NTM3LjMyIC0gU2FmYXJpIDYuMC4zL0Nocm9tZSAyNSAoZml4ZWQgaW4gQ2hyb21lIDI3KQoJLy8gRGV0YWNoZWQgbm9kZXMgY29uZm91bmRpbmdseSBmb2xsb3cgKmVhY2ggb3RoZXIqCglzdXBwb3J0LnNvcnREZXRhY2hlZCA9IGFzc2VydChmdW5jdGlvbiggZGl2MSApIHsKCQkvLyBTaG91bGQgcmV0dXJuIDEsIGJ1dCByZXR1cm5zIDQgKGZvbGxvd2luZykKCQlyZXR1cm4gZGl2MS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikgKSAmIDE7Cgl9KTsKCgkvLyBTdXBwb3J0OiBJRTw4CgkvLyBQcmV2ZW50IGF0dHJpYnV0ZS9wcm9wZXJ0eSAiaW50ZXJwb2xhdGlvbiIKCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKCWlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCWRpdi5pbm5lckhUTUwgPSAiPGEgaHJlZj0nIyc+PC9hPiI7CgkJcmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpID09PSAiIyIgOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCAidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsIGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHsKCQkJaWYgKCAhaXNYTUwgKSB7CgkJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gInR5cGUiID8gMSA6IDIgKTsKCQkJfQoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpCglpZiAoICFzdXBwb3J0LmF0dHJpYnV0ZXMgfHwgIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCWRpdi5pbm5lckhUTUwgPSAiPGlucHV0Lz4iOwoJCWRpdi5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSggInZhbHVlIiwgIiIgKTsKCQlyZXR1cm4gZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCAidmFsdWUiICkgPT09ICIiOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCAidmFsdWUiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCWlmICggIWlzWE1MICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiApIHsKCQkJCXJldHVybiBlbGVtLmRlZmF1bHRWYWx1ZTsKCQkJfQoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIFVzZSBnZXRBdHRyaWJ1dGVOb2RlIHRvIGZldGNoIGJvb2xlYW5zIHdoZW4gZ2V0QXR0cmlidXRlIGxpZXMKCWlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCXJldHVybiBkaXYuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpID09IG51bGw7Cgl9KSApIHsKCQlhZGRIYW5kbGUoIGJvb2xlYW5zLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCXZhciB2YWw7CgkJCWlmICggIWlzWE1MICkgewoJCQkJcmV0dXJuIGVsZW1bIG5hbWUgXSA9PT0gdHJ1ZSA/IG5hbWUudG9Mb3dlckNhc2UoKSA6CgkJCQkJCSh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKSkgJiYgdmFsLnNwZWNpZmllZCA/CgkJCQkJCXZhbC52YWx1ZSA6CgkJCQkJbnVsbDsKCQkJfQoJCX0pOwoJfQoKCXJldHVybiBTaXp6bGU7CgoJfSkoIHdpbmRvdyApOwoKCgoJalF1ZXJ5LmZpbmQgPSBTaXp6bGU7CglqUXVlcnkuZXhwciA9IFNpenpsZS5zZWxlY3RvcnM7CglqUXVlcnkuZXhwclsgIjoiIF0gPSBqUXVlcnkuZXhwci5wc2V1ZG9zOwoJalF1ZXJ5LnVuaXF1ZVNvcnQgPSBqUXVlcnkudW5pcXVlID0gU2l6emxlLnVuaXF1ZVNvcnQ7CglqUXVlcnkudGV4dCA9IFNpenpsZS5nZXRUZXh0OwoJalF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MOwoJalF1ZXJ5LmNvbnRhaW5zID0gU2l6emxlLmNvbnRhaW5zOwoKCgoJdmFyIGRpciA9IGZ1bmN0aW9uKCBlbGVtLCBkaXIsIHVudGlsICkgewoJCXZhciBtYXRjaGVkID0gW10sCgkJCXRydW5jYXRlID0gdW50aWwgIT09IHVuZGVmaW5lZDsKCgkJd2hpbGUgKCAoIGVsZW0gPSBlbGVtWyBkaXIgXSApICYmIGVsZW0ubm9kZVR5cGUgIT09IDkgKSB7CgkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCWlmICggdHJ1bmNhdGUgJiYgalF1ZXJ5KCBlbGVtICkuaXMoIHVudGlsICkgKSB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQltYXRjaGVkLnB1c2goIGVsZW0gKTsKCQkJfQoJCX0KCQlyZXR1cm4gbWF0Y2hlZDsKCX07CgoKCXZhciBzaWJsaW5ncyA9IGZ1bmN0aW9uKCBuLCBlbGVtICkgewoJCXZhciBtYXRjaGVkID0gW107CgoJCWZvciAoIDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcgKSB7CgkJCWlmICggbi5ub2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtICkgewoJCQkJbWF0Y2hlZC5wdXNoKCBuICk7CgkJCX0KCQl9CgoJCXJldHVybiBtYXRjaGVkOwoJfTsKCgoJdmFyIHJuZWVkc0NvbnRleHQgPSBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7CgoJdmFyIHJzaW5nbGVUYWcgPSAoIC9ePChbXHctXSspXHMqXC8/Pig/OjxcL1wxPnwpJC8gKTsKCgoKCXZhciByaXNTaW1wbGUgPSAvXi5bXjojXFtcLixdKiQvOwoKCS8vIEltcGxlbWVudCB0aGUgaWRlbnRpY2FsIGZ1bmN0aW9uYWxpdHkgZm9yIGZpbHRlciBhbmQgbm90CglmdW5jdGlvbiB3aW5ub3coIGVsZW1lbnRzLCBxdWFsaWZpZXIsIG5vdCApIHsKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBxdWFsaWZpZXIgKSApIHsKCQkJcmV0dXJuIGpRdWVyeS5ncmVwKCBlbGVtZW50cywgZnVuY3Rpb24oIGVsZW0sIGkgKSB7CgkJCQkvKiBqc2hpbnQgLVcwMTggKi8KCQkJCXJldHVybiAhIXF1YWxpZmllci5jYWxsKCBlbGVtLCBpLCBlbGVtICkgIT09IG5vdDsKCQkJfSApOwoKCQl9CgoJCWlmICggcXVhbGlmaWVyLm5vZGVUeXBlICkgewoJCQlyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiAoIGVsZW0gPT09IHF1YWxpZmllciApICE9PSBub3Q7CgkJCX0gKTsKCgkJfQoKCQlpZiAoIHR5cGVvZiBxdWFsaWZpZXIgPT09ICJzdHJpbmciICkgewoJCQlpZiAoIHJpc1NpbXBsZS50ZXN0KCBxdWFsaWZpZXIgKSApIHsKCQkJCXJldHVybiBqUXVlcnkuZmlsdGVyKCBxdWFsaWZpZXIsIGVsZW1lbnRzLCBub3QgKTsKCQkJfQoKCQkJcXVhbGlmaWVyID0galF1ZXJ5LmZpbHRlciggcXVhbGlmaWVyLCBlbGVtZW50cyApOwoJCX0KCgkJcmV0dXJuIGpRdWVyeS5ncmVwKCBlbGVtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiAoIGpRdWVyeS5pbkFycmF5KCBlbGVtLCBxdWFsaWZpZXIgKSA+IC0xICkgIT09IG5vdDsKCQl9ICk7Cgl9CgoJalF1ZXJ5LmZpbHRlciA9IGZ1bmN0aW9uKCBleHByLCBlbGVtcywgbm90ICkgewoJCXZhciBlbGVtID0gZWxlbXNbIDAgXTsKCgkJaWYgKCBub3QgKSB7CgkJCWV4cHIgPSAiOm5vdCgiICsgZXhwciArICIpIjsKCQl9CgoJCXJldHVybiBlbGVtcy5sZW5ndGggPT09IDEgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSA/CgkJCWpRdWVyeS5maW5kLm1hdGNoZXNTZWxlY3RvciggZWxlbSwgZXhwciApID8gWyBlbGVtIF0gOiBbXSA6CgkJCWpRdWVyeS5maW5kLm1hdGNoZXMoIGV4cHIsIGpRdWVyeS5ncmVwKCBlbGVtcywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMTsKCQkJfSApICk7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlmaW5kOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBpLAoJCQkJcmV0ID0gW10sCgkJCQlzZWxmID0gdGhpcywKCQkJCWxlbiA9IHNlbGYubGVuZ3RoOwoKCQkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciICkgewoJCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkoIHNlbGVjdG9yICkuZmlsdGVyKCBmdW5jdGlvbigpIHsKCQkJCQlmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCQlpZiAoIGpRdWVyeS5jb250YWlucyggc2VsZlsgaSBdLCB0aGlzICkgKSB7CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gKSApOwoJCQl9CgoJCQlmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkgewoJCQkJalF1ZXJ5LmZpbmQoIHNlbGVjdG9yLCBzZWxmWyBpIF0sIHJldCApOwoJCQl9CgoJCQkvLyBOZWVkZWQgYmVjYXVzZSAkKCBzZWxlY3RvciwgY29udGV4dCApIGJlY29tZXMgJCggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICkKCQkJcmV0ID0gdGhpcy5wdXNoU3RhY2soIGxlbiA+IDEgPyBqUXVlcnkudW5pcXVlKCByZXQgKSA6IHJldCApOwoJCQlyZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yID8gdGhpcy5zZWxlY3RvciArICIgIiArIHNlbGVjdG9yIDogc2VsZWN0b3I7CgkJCXJldHVybiByZXQ7CgkJfSwKCQlmaWx0ZXI6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3coIHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSApICk7CgkJfSwKCQlub3Q6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3coIHRoaXMsIHNlbGVjdG9yIHx8IFtdLCB0cnVlICkgKTsKCQl9LAoJCWlzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiAhIXdpbm5vdygKCQkJCXRoaXMsCgoJCQkJLy8gSWYgdGhpcyBpcyBhIHBvc2l0aW9uYWwvcmVsYXRpdmUgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhlIHJldHVybmVkIHNldAoJCQkJLy8gc28gJCgicDpmaXJzdCIpLmlzKCJwOmxhc3QiKSB3b24ndCByZXR1cm4gdHJ1ZSBmb3IgYSBkb2Mgd2l0aCB0d28gInAiLgoJCQkJdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiAmJiBybmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICkgPwoJCQkJCWpRdWVyeSggc2VsZWN0b3IgKSA6CgkJCQkJc2VsZWN0b3IgfHwgW10sCgkJCQlmYWxzZQoJCQkpLmxlbmd0aDsKCQl9Cgl9ICk7CgoKCS8vIEluaXRpYWxpemUgYSBqUXVlcnkgb2JqZWN0CgoKCS8vIEEgY2VudHJhbCByZWZlcmVuY2UgdG8gdGhlIHJvb3QgalF1ZXJ5KGRvY3VtZW50KQoJdmFyIHJvb3RqUXVlcnksCgoJCS8vIEEgc2ltcGxlIHdheSB0byBjaGVjayBmb3IgSFRNTCBzdHJpbmdzCgkJLy8gUHJpb3JpdGl6ZSAjaWQgb3ZlciA8dGFnPiB0byBhdm9pZCBYU1MgdmlhIGxvY2F0aW9uLmhhc2ggKCM5NTIxKQoJCS8vIFN0cmljdCBIVE1MIHJlY29nbml0aW9uICgjMTEyOTA6IG11c3Qgc3RhcnQgd2l0aCA8KQoJCXJxdWlja0V4cHIgPSAvXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSopKSQvLAoKCQlpbml0ID0galF1ZXJ5LmZuLmluaXQgPSBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQsIHJvb3QgKSB7CgkJCXZhciBtYXRjaCwgZWxlbTsKCgkJCS8vIEhBTkRMRTogJCgiIiksICQobnVsbCksICQodW5kZWZpbmVkKSwgJChmYWxzZSkKCQkJaWYgKCAhc2VsZWN0b3IgKSB7CgkJCQlyZXR1cm4gdGhpczsKCQkJfQoKCQkJLy8gaW5pdCBhY2NlcHRzIGFuIGFsdGVybmF0ZSByb290alF1ZXJ5CgkJCS8vIHNvIG1pZ3JhdGUgY2FuIHN1cHBvcnQgalF1ZXJ5LnN1YiAoZ2gtMjEwMSkKCQkJcm9vdCA9IHJvb3QgfHwgcm9vdGpRdWVyeTsKCgkJCS8vIEhhbmRsZSBIVE1MIHN0cmluZ3MKCQkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICkgewoJCQkJaWYgKCBzZWxlY3Rvci5jaGFyQXQoIDAgKSA9PT0gIjwiICYmCgkJCQkJc2VsZWN0b3IuY2hhckF0KCBzZWxlY3Rvci5sZW5ndGggLSAxICkgPT09ICI+IiAmJgoJCQkJCXNlbGVjdG9yLmxlbmd0aCA+PSAzICkgewoKCQkJCQkvLyBBc3N1bWUgdGhhdCBzdHJpbmdzIHRoYXQgc3RhcnQgYW5kIGVuZCB3aXRoIDw+IGFyZSBIVE1MIGFuZCBza2lwIHRoZSByZWdleCBjaGVjawoJCQkJCW1hdGNoID0gWyBudWxsLCBzZWxlY3RvciwgbnVsbCBdOwoKCQkJCX0gZWxzZSB7CgkJCQkJbWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkJLy8gTWF0Y2ggaHRtbCBvciBtYWtlIHN1cmUgbm8gY29udGV4dCBpcyBzcGVjaWZpZWQgZm9yICNpZAoJCQkJaWYgKCBtYXRjaCAmJiAoIG1hdGNoWyAxIF0gfHwgIWNvbnRleHQgKSApIHsKCgkJCQkJLy8gSEFORExFOiAkKGh0bWwpIC0+ICQoYXJyYXkpCgkJCQkJaWYgKCBtYXRjaFsgMSBdICkgewoJCQkJCQljb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRleHRbIDAgXSA6IGNvbnRleHQ7CgoJCQkJCQkvLyBzY3JpcHRzIGlzIHRydWUgZm9yIGJhY2stY29tcGF0CgkJCQkJCS8vIEludGVudGlvbmFsbHkgbGV0IHRoZSBlcnJvciBiZSB0aHJvd24gaWYgcGFyc2VIVE1MIGlzIG5vdCBwcmVzZW50CgkJCQkJCWpRdWVyeS5tZXJnZSggdGhpcywgalF1ZXJ5LnBhcnNlSFRNTCgKCQkJCQkJCW1hdGNoWyAxIF0sCgkJCQkJCQljb250ZXh0ICYmIGNvbnRleHQubm9kZVR5cGUgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IGRvY3VtZW50LAoJCQkJCQkJdHJ1ZQoJCQkJCQkpICk7CgoJCQkJCQkvLyBIQU5ETEU6ICQoaHRtbCwgcHJvcHMpCgkJCQkJCWlmICggcnNpbmdsZVRhZy50ZXN0KCBtYXRjaFsgMSBdICkgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvbnRleHQgKSApIHsKCQkJCQkJCWZvciAoIG1hdGNoIGluIGNvbnRleHQgKSB7CgoJCQkJCQkJCS8vIFByb3BlcnRpZXMgb2YgY29udGV4dCBhcmUgY2FsbGVkIGFzIG1ldGhvZHMgaWYgcG9zc2libGUKCQkJCQkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB0aGlzWyBtYXRjaCBdICkgKSB7CgkJCQkJCQkJCXRoaXNbIG1hdGNoIF0oIGNvbnRleHRbIG1hdGNoIF0gKTsKCgkJCQkJCQkJLy8gLi4uYW5kIG90aGVyd2lzZSBzZXQgYXMgYXR0cmlidXRlcwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCXRoaXMuYXR0ciggbWF0Y2gsIGNvbnRleHRbIG1hdGNoIF0gKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCXJldHVybiB0aGlzOwoKCQkJCQkvLyBIQU5ETEU6ICQoI2lkKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggbWF0Y2hbIDIgXSApOwoKCQkJCQkJLy8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnMKCQkJCQkJLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2MwoJCQkJCQlpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkgewoKCQkJCQkJCS8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBJRSBhbmQgT3BlcmEgcmV0dXJuIGl0ZW1zCgkJCQkJCQkvLyBieSBuYW1lIGluc3RlYWQgb2YgSUQKCQkJCQkJCWlmICggZWxlbS5pZCAhPT0gbWF0Y2hbIDIgXSApIHsKCQkJCQkJCQlyZXR1cm4gcm9vdGpRdWVyeS5maW5kKCBzZWxlY3RvciApOwoJCQkJCQkJfQoKCQkJCQkJCS8vIE90aGVyd2lzZSwgd2UgaW5qZWN0IHRoZSBlbGVtZW50IGRpcmVjdGx5IGludG8gdGhlIGpRdWVyeSBvYmplY3QKCQkJCQkJCXRoaXMubGVuZ3RoID0gMTsKCQkJCQkJCXRoaXNbIDAgXSA9IGVsZW07CgkJCQkJCX0KCgkJCQkJCXRoaXMuY29udGV4dCA9IGRvY3VtZW50OwoJCQkJCQl0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0KCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKQoJCQkJfSBlbHNlIGlmICggIWNvbnRleHQgfHwgY29udGV4dC5qcXVlcnkgKSB7CgkJCQkJcmV0dXJuICggY29udGV4dCB8fCByb290ICkuZmluZCggc2VsZWN0b3IgKTsKCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dCkKCQkJCS8vICh3aGljaCBpcyBqdXN0IGVxdWl2YWxlbnQgdG86ICQoY29udGV4dCkuZmluZChleHByKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkvLyBIQU5ETEU6ICQoRE9NRWxlbWVudCkKCQkJfSBlbHNlIGlmICggc2VsZWN0b3Iubm9kZVR5cGUgKSB7CgkJCQl0aGlzLmNvbnRleHQgPSB0aGlzWyAwIF0gPSBzZWxlY3RvcjsKCQkJCXRoaXMubGVuZ3RoID0gMTsKCQkJCXJldHVybiB0aGlzOwoKCQkJLy8gSEFORExFOiAkKGZ1bmN0aW9uKQoJCQkvLyBTaG9ydGN1dCBmb3IgZG9jdW1lbnQgcmVhZHkKCQkJfSBlbHNlIGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHNlbGVjdG9yICkgKSB7CgkJCQlyZXR1cm4gdHlwZW9mIHJvb3QucmVhZHkgIT09ICJ1bmRlZmluZWQiID8KCQkJCQlyb290LnJlYWR5KCBzZWxlY3RvciApIDoKCgkJCQkJLy8gRXhlY3V0ZSBpbW1lZGlhdGVseSBpZiByZWFkeSBpcyBub3QgcHJlc2VudAoJCQkJCXNlbGVjdG9yKCBqUXVlcnkgKTsKCQkJfQoKCQkJaWYgKCBzZWxlY3Rvci5zZWxlY3RvciAhPT0gdW5kZWZpbmVkICkgewoJCQkJdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yLnNlbGVjdG9yOwoJCQkJdGhpcy5jb250ZXh0ID0gc2VsZWN0b3IuY29udGV4dDsKCQkJfQoKCQkJcmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoIHNlbGVjdG9yLCB0aGlzICk7CgkJfTsKCgkvLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9uIHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uCglpbml0LnByb3RvdHlwZSA9IGpRdWVyeS5mbjsKCgkvLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlCglyb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApOwoKCgl2YXIgcnBhcmVudHNwcmV2ID0gL14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sCgoJCS8vIG1ldGhvZHMgZ3VhcmFudGVlZCB0byBwcm9kdWNlIGEgdW5pcXVlIHNldCB3aGVuIHN0YXJ0aW5nIGZyb20gYSB1bmlxdWUgc2V0CgkJZ3VhcmFudGVlZFVuaXF1ZSA9IHsKCQkJY2hpbGRyZW46IHRydWUsCgkJCWNvbnRlbnRzOiB0cnVlLAoJCQluZXh0OiB0cnVlLAoJCQlwcmV2OiB0cnVlCgkJfTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJaGFzOiBmdW5jdGlvbiggdGFyZ2V0ICkgewoJCQl2YXIgaSwKCQkJCXRhcmdldHMgPSBqUXVlcnkoIHRhcmdldCwgdGhpcyApLAoJCQkJbGVuID0gdGFyZ2V0cy5sZW5ndGg7CgoJCQlyZXR1cm4gdGhpcy5maWx0ZXIoIGZ1bmN0aW9uKCkgewoJCQkJZm9yICggaSA9IDA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQlpZiAoIGpRdWVyeS5jb250YWlucyggdGhpcywgdGFyZ2V0c1sgaSBdICkgKSB7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfSApOwoJCX0sCgoJCWNsb3Nlc3Q6IGZ1bmN0aW9uKCBzZWxlY3RvcnMsIGNvbnRleHQgKSB7CgkJCXZhciBjdXIsCgkJCQlpID0gMCwKCQkJCWwgPSB0aGlzLmxlbmd0aCwKCQkJCW1hdGNoZWQgPSBbXSwKCQkJCXBvcyA9IHJuZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3JzICkgfHwgdHlwZW9mIHNlbGVjdG9ycyAhPT0gInN0cmluZyIgPwoJCQkJCWpRdWVyeSggc2VsZWN0b3JzLCBjb250ZXh0IHx8IHRoaXMuY29udGV4dCApIDoKCQkJCQkwOwoKCQkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQkJZm9yICggY3VyID0gdGhpc1sgaSBdOyBjdXIgJiYgY3VyICE9PSBjb250ZXh0OyBjdXIgPSBjdXIucGFyZW50Tm9kZSApIHsKCgkJCQkJLy8gQWx3YXlzIHNraXAgZG9jdW1lbnQgZnJhZ21lbnRzCgkJCQkJaWYgKCBjdXIubm9kZVR5cGUgPCAxMSAmJiAoIHBvcyA/CgkJCQkJCXBvcy5pbmRleCggY3VyICkgPiAtMSA6CgoJCQkJCQkvLyBEb24ndCBwYXNzIG5vbi1lbGVtZW50cyB0byBTaXp6bGUKCQkJCQkJY3VyLm5vZGVUeXBlID09PSAxICYmCgkJCQkJCQlqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoIGN1ciwgc2VsZWN0b3JzICkgKSApIHsKCgkJCQkJCW1hdGNoZWQucHVzaCggY3VyICk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBtYXRjaGVkLmxlbmd0aCA+IDEgPyBqUXVlcnkudW5pcXVlU29ydCggbWF0Y2hlZCApIDogbWF0Y2hlZCApOwoJCX0sCgoJCS8vIERldGVybWluZSB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCB3aXRoaW4KCQkvLyB0aGUgbWF0Y2hlZCBzZXQgb2YgZWxlbWVudHMKCQlpbmRleDogZnVuY3Rpb24oIGVsZW0gKSB7CgoJCQkvLyBObyBhcmd1bWVudCwgcmV0dXJuIGluZGV4IGluIHBhcmVudAoJCQlpZiAoICFlbGVtICkgewoJCQkJcmV0dXJuICggdGhpc1sgMCBdICYmIHRoaXNbIDAgXS5wYXJlbnROb2RlICkgPyB0aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aCA6IC0xOwoJCQl9CgoJCQkvLyBpbmRleCBpbiBzZWxlY3RvcgoJCQlpZiAoIHR5cGVvZiBlbGVtID09PSAic3RyaW5nIiApIHsKCQkJCXJldHVybiBqUXVlcnkuaW5BcnJheSggdGhpc1sgMCBdLCBqUXVlcnkoIGVsZW0gKSApOwoJCQl9CgoJCQkvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBkZXNpcmVkIGVsZW1lbnQKCQkJcmV0dXJuIGpRdWVyeS5pbkFycmF5KAoKCQkJCS8vIElmIGl0IHJlY2VpdmVzIGEgalF1ZXJ5IG9iamVjdCwgdGhlIGZpcnN0IGVsZW1lbnQgaXMgdXNlZAoJCQkJZWxlbS5qcXVlcnkgPyBlbGVtWyAwIF0gOiBlbGVtLCB0aGlzICk7CgkJfSwKCgkJYWRkOiBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjaygKCQkJCWpRdWVyeS51bmlxdWVTb3J0KAoJCQkJCWpRdWVyeS5tZXJnZSggdGhpcy5nZXQoKSwgalF1ZXJ5KCBzZWxlY3RvciwgY29udGV4dCApICkKCQkJCSkKCQkJKTsKCQl9LAoKCQlhZGRCYWNrOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiB0aGlzLmFkZCggc2VsZWN0b3IgPT0gbnVsbCA/CgkJCQl0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKCBzZWxlY3RvciApCgkJCSk7CgkJfQoJfSApOwoKCWZ1bmN0aW9uIHNpYmxpbmcoIGN1ciwgZGlyICkgewoJCWRvIHsKCQkJY3VyID0gY3VyWyBkaXIgXTsKCQl9IHdoaWxlICggY3VyICYmIGN1ci5ub2RlVHlwZSAhPT0gMSApOwoKCQlyZXR1cm4gY3VyOwoJfQoKCWpRdWVyeS5lYWNoKCB7CgkJcGFyZW50OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKCQkJcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgIT09IDExID8gcGFyZW50IDogbnVsbDsKCQl9LAoJCXBhcmVudHM6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIgKTsKCQl9LAoJCXBhcmVudHNVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIsIHVudGlsICk7CgkJfSwKCQluZXh0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIHNpYmxpbmcoIGVsZW0sICJuZXh0U2libGluZyIgKTsKCQl9LAoJCXByZXY6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZyggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCQl9LAoJCW5leHRBbGw6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciICk7CgkJfSwKCQlwcmV2QWxsOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGRpciggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCQl9LAoJCW5leHRVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciLCB1bnRpbCApOwoJCX0sCgkJcHJldlVudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7CgkJCXJldHVybiBkaXIoIGVsZW0sICJwcmV2aW91c1NpYmxpbmciLCB1bnRpbCApOwoJCX0sCgkJc2libGluZ3M6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZ3MoICggZWxlbS5wYXJlbnROb2RlIHx8IHt9ICkuZmlyc3RDaGlsZCwgZWxlbSApOwoJCX0sCgkJY2hpbGRyZW46IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZ3MoIGVsZW0uZmlyc3RDaGlsZCApOwoJCX0sCgkJY29udGVudHM6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAiaWZyYW1lIiApID8KCQkJCWVsZW0uY29udGVudERvY3VtZW50IHx8IGVsZW0uY29udGVudFdpbmRvdy5kb2N1bWVudCA6CgkJCQlqUXVlcnkubWVyZ2UoIFtdLCBlbGVtLmNoaWxkTm9kZXMgKTsKCQl9Cgl9LCBmdW5jdGlvbiggbmFtZSwgZm4gKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggdW50aWwsIHNlbGVjdG9yICkgewoJCQl2YXIgcmV0ID0galF1ZXJ5Lm1hcCggdGhpcywgZm4sIHVudGlsICk7CgoJCQlpZiAoIG5hbWUuc2xpY2UoIC01ICkgIT09ICJVbnRpbCIgKSB7CgkJCQlzZWxlY3RvciA9IHVudGlsOwoJCQl9CgoJCQlpZiAoIHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXQgPSBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgcmV0ICk7CgkJCX0KCgkJCWlmICggdGhpcy5sZW5ndGggPiAxICkgewoKCQkJCS8vIFJlbW92ZSBkdXBsaWNhdGVzCgkJCQlpZiAoICFndWFyYW50ZWVkVW5pcXVlWyBuYW1lIF0gKSB7CgkJCQkJcmV0ID0galF1ZXJ5LnVuaXF1ZVNvcnQoIHJldCApOwoJCQkJfQoKCQkJCS8vIFJldmVyc2Ugb3JkZXIgZm9yIHBhcmVudHMqIGFuZCBwcmV2LWRlcml2YXRpdmVzCgkJCQlpZiAoIHJwYXJlbnRzcHJldi50ZXN0KCBuYW1lICkgKSB7CgkJCQkJcmV0ID0gcmV0LnJldmVyc2UoKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCByZXQgKTsKCQl9OwoJfSApOwoJdmFyIHJub3R3aGl0ZSA9ICggL1xTKy9nICk7CgoKCgkvLyBDb252ZXJ0IFN0cmluZy1mb3JtYXR0ZWQgb3B0aW9ucyBpbnRvIE9iamVjdC1mb3JtYXR0ZWQgb25lcwoJZnVuY3Rpb24gY3JlYXRlT3B0aW9ucyggb3B0aW9ucyApIHsKCQl2YXIgb2JqZWN0ID0ge307CgkJalF1ZXJ5LmVhY2goIG9wdGlvbnMubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdLCBmdW5jdGlvbiggXywgZmxhZyApIHsKCQkJb2JqZWN0WyBmbGFnIF0gPSB0cnVlOwoJCX0gKTsKCQlyZXR1cm4gb2JqZWN0OwoJfQoKCS8qCgkgKiBDcmVhdGUgYSBjYWxsYmFjayBsaXN0IHVzaW5nIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoKCSAqCgkgKglvcHRpb25zOiBhbiBvcHRpb25hbCBsaXN0IG9mIHNwYWNlLXNlcGFyYXRlZCBvcHRpb25zIHRoYXQgd2lsbCBjaGFuZ2UgaG93CgkgKgkJCXRoZSBjYWxsYmFjayBsaXN0IGJlaGF2ZXMgb3IgYSBtb3JlIHRyYWRpdGlvbmFsIG9wdGlvbiBvYmplY3QKCSAqCgkgKiBCeSBkZWZhdWx0IGEgY2FsbGJhY2sgbGlzdCB3aWxsIGFjdCBsaWtlIGFuIGV2ZW50IGNhbGxiYWNrIGxpc3QgYW5kIGNhbiBiZQoJICogImZpcmVkIiBtdWx0aXBsZSB0aW1lcy4KCSAqCgkgKiBQb3NzaWJsZSBvcHRpb25zOgoJICoKCSAqCW9uY2U6CQkJd2lsbCBlbnN1cmUgdGhlIGNhbGxiYWNrIGxpc3QgY2FuIG9ubHkgYmUgZmlyZWQgb25jZSAobGlrZSBhIERlZmVycmVkKQoJICoKCSAqCW1lbW9yeToJCQl3aWxsIGtlZXAgdHJhY2sgb2YgcHJldmlvdXMgdmFsdWVzIGFuZCB3aWxsIGNhbGwgYW55IGNhbGxiYWNrIGFkZGVkCgkgKgkJCQkJYWZ0ZXIgdGhlIGxpc3QgaGFzIGJlZW4gZmlyZWQgcmlnaHQgYXdheSB3aXRoIHRoZSBsYXRlc3QgIm1lbW9yaXplZCIKCSAqCQkJCQl2YWx1ZXMgKGxpa2UgYSBEZWZlcnJlZCkKCSAqCgkgKgl1bmlxdWU6CQkJd2lsbCBlbnN1cmUgYSBjYWxsYmFjayBjYW4gb25seSBiZSBhZGRlZCBvbmNlIChubyBkdXBsaWNhdGUgaW4gdGhlIGxpc3QpCgkgKgoJICoJc3RvcE9uRmFsc2U6CWludGVycnVwdCBjYWxsaW5ncyB3aGVuIGEgY2FsbGJhY2sgcmV0dXJucyBmYWxzZQoJICoKCSAqLwoJalF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uKCBvcHRpb25zICkgewoKCQkvLyBDb252ZXJ0IG9wdGlvbnMgZnJvbSBTdHJpbmctZm9ybWF0dGVkIHRvIE9iamVjdC1mb3JtYXR0ZWQgaWYgbmVlZGVkCgkJLy8gKHdlIGNoZWNrIGluIGNhY2hlIGZpcnN0KQoJCW9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gInN0cmluZyIgPwoJCQljcmVhdGVPcHRpb25zKCBvcHRpb25zICkgOgoJCQlqUXVlcnkuZXh0ZW5kKCB7fSwgb3B0aW9ucyApOwoKCQl2YXIgLy8gRmxhZyB0byBrbm93IGlmIGxpc3QgaXMgY3VycmVudGx5IGZpcmluZwoJCQlmaXJpbmcsCgoJCQkvLyBMYXN0IGZpcmUgdmFsdWUgZm9yIG5vbi1mb3JnZXR0YWJsZSBsaXN0cwoJCQltZW1vcnksCgoJCQkvLyBGbGFnIHRvIGtub3cgaWYgbGlzdCB3YXMgYWxyZWFkeSBmaXJlZAoJCQlmaXJlZCwKCgkJCS8vIEZsYWcgdG8gcHJldmVudCBmaXJpbmcKCQkJbG9ja2VkLAoKCQkJLy8gQWN0dWFsIGNhbGxiYWNrIGxpc3QKCQkJbGlzdCA9IFtdLAoKCQkJLy8gUXVldWUgb2YgZXhlY3V0aW9uIGRhdGEgZm9yIHJlcGVhdGFibGUgbGlzdHMKCQkJcXVldWUgPSBbXSwKCgkJCS8vIEluZGV4IG9mIGN1cnJlbnRseSBmaXJpbmcgY2FsbGJhY2sgKG1vZGlmaWVkIGJ5IGFkZC9yZW1vdmUgYXMgbmVlZGVkKQoJCQlmaXJpbmdJbmRleCA9IC0xLAoKCQkJLy8gRmlyZSBjYWxsYmFja3MKCQkJZmlyZSA9IGZ1bmN0aW9uKCkgewoKCQkJCS8vIEVuZm9yY2Ugc2luZ2xlLWZpcmluZwoJCQkJbG9ja2VkID0gb3B0aW9ucy5vbmNlOwoKCQkJCS8vIEV4ZWN1dGUgY2FsbGJhY2tzIGZvciBhbGwgcGVuZGluZyBleGVjdXRpb25zLAoJCQkJLy8gcmVzcGVjdGluZyBmaXJpbmdJbmRleCBvdmVycmlkZXMgYW5kIHJ1bnRpbWUgY2hhbmdlcwoJCQkJZmlyZWQgPSBmaXJpbmcgPSB0cnVlOwoJCQkJZm9yICggOyBxdWV1ZS5sZW5ndGg7IGZpcmluZ0luZGV4ID0gLTEgKSB7CgkJCQkJbWVtb3J5ID0gcXVldWUuc2hpZnQoKTsKCQkJCQl3aGlsZSAoICsrZmlyaW5nSW5kZXggPCBsaXN0Lmxlbmd0aCApIHsKCgkJCQkJCS8vIFJ1biBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGVhcmx5IHRlcm1pbmF0aW9uCgkJCQkJCWlmICggbGlzdFsgZmlyaW5nSW5kZXggXS5hcHBseSggbWVtb3J5WyAwIF0sIG1lbW9yeVsgMSBdICkgPT09IGZhbHNlICYmCgkJCQkJCQlvcHRpb25zLnN0b3BPbkZhbHNlICkgewoKCQkJCQkJCS8vIEp1bXAgdG8gZW5kIGFuZCBmb3JnZXQgdGhlIGRhdGEgc28gLmFkZCBkb2Vzbid0IHJlLWZpcmUKCQkJCQkJCWZpcmluZ0luZGV4ID0gbGlzdC5sZW5ndGg7CgkJCQkJCQltZW1vcnkgPSBmYWxzZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBGb3JnZXQgdGhlIGRhdGEgaWYgd2UncmUgZG9uZSB3aXRoIGl0CgkJCQlpZiAoICFvcHRpb25zLm1lbW9yeSApIHsKCQkJCQltZW1vcnkgPSBmYWxzZTsKCQkJCX0KCgkJCQlmaXJpbmcgPSBmYWxzZTsKCgkJCQkvLyBDbGVhbiB1cCBpZiB3ZSdyZSBkb25lIGZpcmluZyBmb3IgZ29vZAoJCQkJaWYgKCBsb2NrZWQgKSB7CgoJCQkJCS8vIEtlZXAgYW4gZW1wdHkgbGlzdCBpZiB3ZSBoYXZlIGRhdGEgZm9yIGZ1dHVyZSBhZGQgY2FsbHMKCQkJCQlpZiAoIG1lbW9yeSApIHsKCQkJCQkJbGlzdCA9IFtdOwoKCQkJCQkvLyBPdGhlcndpc2UsIHRoaXMgb2JqZWN0IGlzIHNwZW50CgkJCQkJfSBlbHNlIHsKCQkJCQkJbGlzdCA9ICIiOwoJCQkJCX0KCQkJCX0KCQkJfSwKCgkJCS8vIEFjdHVhbCBDYWxsYmFja3Mgb2JqZWN0CgkJCXNlbGYgPSB7CgoJCQkJLy8gQWRkIGEgY2FsbGJhY2sgb3IgYSBjb2xsZWN0aW9uIG9mIGNhbGxiYWNrcyB0byB0aGUgbGlzdAoJCQkJYWRkOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGxpc3QgKSB7CgoJCQkJCQkvLyBJZiB3ZSBoYXZlIG1lbW9yeSBmcm9tIGEgcGFzdCBydW4sIHdlIHNob3VsZCBmaXJlIGFmdGVyIGFkZGluZwoJCQkJCQlpZiAoIG1lbW9yeSAmJiAhZmlyaW5nICkgewoJCQkJCQkJZmlyaW5nSW5kZXggPSBsaXN0Lmxlbmd0aCAtIDE7CgkJCQkJCQlxdWV1ZS5wdXNoKCBtZW1vcnkgKTsKCQkJCQkJfQoKCQkJCQkJKCBmdW5jdGlvbiBhZGQoIGFyZ3MgKSB7CgkJCQkJCQlqUXVlcnkuZWFjaCggYXJncywgZnVuY3Rpb24oIF8sIGFyZyApIHsKCQkJCQkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBhcmcgKSApIHsKCQkJCQkJCQkJaWYgKCAhb3B0aW9ucy51bmlxdWUgfHwgIXNlbGYuaGFzKCBhcmcgKSApIHsKCQkJCQkJCQkJCWxpc3QucHVzaCggYXJnICk7CgkJCQkJCQkJCX0KCQkJCQkJCQl9IGVsc2UgaWYgKCBhcmcgJiYgYXJnLmxlbmd0aCAmJiBqUXVlcnkudHlwZSggYXJnICkgIT09ICJzdHJpbmciICkgewoKCQkJCQkJCQkJLy8gSW5zcGVjdCByZWN1cnNpdmVseQoJCQkJCQkJCQlhZGQoIGFyZyApOwoJCQkJCQkJCX0KCQkJCQkJCX0gKTsKCQkJCQkJfSApKCBhcmd1bWVudHMgKTsKCgkJCQkJCWlmICggbWVtb3J5ICYmICFmaXJpbmcgKSB7CgkJCQkJCQlmaXJlKCk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoKCQkJCS8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3QKCQkJCXJlbW92ZTogZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5LmVhY2goIGFyZ3VtZW50cywgZnVuY3Rpb24oIF8sIGFyZyApIHsKCQkJCQkJdmFyIGluZGV4OwoJCQkJCQl3aGlsZSAoICggaW5kZXggPSBqUXVlcnkuaW5BcnJheSggYXJnLCBsaXN0LCBpbmRleCApICkgPiAtMSApIHsKCQkJCQkJCWxpc3Quc3BsaWNlKCBpbmRleCwgMSApOwoKCQkJCQkJCS8vIEhhbmRsZSBmaXJpbmcgaW5kZXhlcwoJCQkJCQkJaWYgKCBpbmRleCA8PSBmaXJpbmdJbmRleCApIHsKCQkJCQkJCQlmaXJpbmdJbmRleC0tOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfSApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBDaGVjayBpZiBhIGdpdmVuIGNhbGxiYWNrIGlzIGluIHRoZSBsaXN0LgoJCQkJLy8gSWYgbm8gYXJndW1lbnQgaXMgZ2l2ZW4sIHJldHVybiB3aGV0aGVyIG9yIG5vdCBsaXN0IGhhcyBjYWxsYmFja3MgYXR0YWNoZWQuCgkJCQloYXM6IGZ1bmN0aW9uKCBmbiApIHsKCQkJCQlyZXR1cm4gZm4gPwoJCQkJCQlqUXVlcnkuaW5BcnJheSggZm4sIGxpc3QgKSA+IC0xIDoKCQkJCQkJbGlzdC5sZW5ndGggPiAwOwoJCQkJfSwKCgkJCQkvLyBSZW1vdmUgYWxsIGNhbGxiYWNrcyBmcm9tIHRoZSBsaXN0CgkJCQllbXB0eTogZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCBsaXN0ICkgewoJCQkJCQlsaXN0ID0gW107CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBEaXNhYmxlIC5maXJlIGFuZCAuYWRkCgkJCQkvLyBBYm9ydCBhbnkgY3VycmVudC9wZW5kaW5nIGV4ZWN1dGlvbnMKCQkJCS8vIENsZWFyIGFsbCBjYWxsYmFja3MgYW5kIHZhbHVlcwoJCQkJZGlzYWJsZTogZnVuY3Rpb24oKSB7CgkJCQkJbG9ja2VkID0gcXVldWUgPSBbXTsKCQkJCQlsaXN0ID0gbWVtb3J5ID0gIiI7CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJZGlzYWJsZWQ6IGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiAhbGlzdDsKCQkJCX0sCgoJCQkJLy8gRGlzYWJsZSAuZmlyZQoJCQkJLy8gQWxzbyBkaXNhYmxlIC5hZGQgdW5sZXNzIHdlIGhhdmUgbWVtb3J5IChzaW5jZSBpdCB3b3VsZCBoYXZlIG5vIGVmZmVjdCkKCQkJCS8vIEFib3J0IGFueSBwZW5kaW5nIGV4ZWN1dGlvbnMKCQkJCWxvY2s6IGZ1bmN0aW9uKCkgewoJCQkJCWxvY2tlZCA9IHRydWU7CgkJCQkJaWYgKCAhbWVtb3J5ICkgewoJCQkJCQlzZWxmLmRpc2FibGUoKTsKCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJbG9ja2VkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gISFsb2NrZWQ7CgkJCQl9LAoKCQkJCS8vIENhbGwgYWxsIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBjb250ZXh0IGFuZCBhcmd1bWVudHMKCQkJCWZpcmVXaXRoOiBmdW5jdGlvbiggY29udGV4dCwgYXJncyApIHsKCQkJCQlpZiAoICFsb2NrZWQgKSB7CgkJCQkJCWFyZ3MgPSBhcmdzIHx8IFtdOwoJCQkJCQlhcmdzID0gWyBjb250ZXh0LCBhcmdzLnNsaWNlID8gYXJncy5zbGljZSgpIDogYXJncyBdOwoJCQkJCQlxdWV1ZS5wdXNoKCBhcmdzICk7CgkJCQkJCWlmICggIWZpcmluZyApIHsKCQkJCQkJCWZpcmUoKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgoJCQkJLy8gQ2FsbCBhbGwgdGhlIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBhcmd1bWVudHMKCQkJCWZpcmU6IGZ1bmN0aW9uKCkgewoJCQkJCXNlbGYuZmlyZVdpdGgoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBUbyBrbm93IGlmIHRoZSBjYWxsYmFja3MgaGF2ZSBhbHJlYWR5IGJlZW4gY2FsbGVkIGF0IGxlYXN0IG9uY2UKCQkJCWZpcmVkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gISFmaXJlZDsKCQkJCX0KCQkJfTsKCgkJcmV0dXJuIHNlbGY7Cgl9OwoKCglqUXVlcnkuZXh0ZW5kKCB7CgoJCURlZmVycmVkOiBmdW5jdGlvbiggZnVuYyApIHsKCQkJdmFyIHR1cGxlcyA9IFsKCgkJCQkJLy8gYWN0aW9uLCBhZGQgbGlzdGVuZXIsIGxpc3RlbmVyIGxpc3QsIGZpbmFsIHN0YXRlCgkJCQkJWyAicmVzb2x2ZSIsICJkb25lIiwgalF1ZXJ5LkNhbGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLCAicmVzb2x2ZWQiIF0sCgkJCQkJWyAicmVqZWN0IiwgImZhaWwiLCBqUXVlcnkuQ2FsbGJhY2tzKCAib25jZSBtZW1vcnkiICksICJyZWplY3RlZCIgXSwKCQkJCQlbICJub3RpZnkiLCAicHJvZ3Jlc3MiLCBqUXVlcnkuQ2FsbGJhY2tzKCAibWVtb3J5IiApIF0KCQkJCV0sCgkJCQlzdGF0ZSA9ICJwZW5kaW5nIiwKCQkJCXByb21pc2UgPSB7CgkJCQkJc3RhdGU6IGZ1bmN0aW9uKCkgewoJCQkJCQlyZXR1cm4gc3RhdGU7CgkJCQkJfSwKCQkJCQlhbHdheXM6IGZ1bmN0aW9uKCkgewoJCQkJCQlkZWZlcnJlZC5kb25lKCBhcmd1bWVudHMgKS5mYWlsKCBhcmd1bWVudHMgKTsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfSwKCQkJCQl0aGVuOiBmdW5jdGlvbiggLyogZm5Eb25lLCBmbkZhaWwsIGZuUHJvZ3Jlc3MgKi8gKSB7CgkJCQkJCXZhciBmbnMgPSBhcmd1bWVudHM7CgkJCQkJCXJldHVybiBqUXVlcnkuRGVmZXJyZWQoIGZ1bmN0aW9uKCBuZXdEZWZlciApIHsKCQkJCQkJCWpRdWVyeS5lYWNoKCB0dXBsZXMsIGZ1bmN0aW9uKCBpLCB0dXBsZSApIHsKCQkJCQkJCQl2YXIgZm4gPSBqUXVlcnkuaXNGdW5jdGlvbiggZm5zWyBpIF0gKSAmJiBmbnNbIGkgXTsKCgkJCQkJCQkJLy8gZGVmZXJyZWRbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSBmb3IgZm9yd2FyZGluZyBhY3Rpb25zIHRvIG5ld0RlZmVyCgkJCQkJCQkJZGVmZXJyZWRbIHR1cGxlWyAxIF0gXSggZnVuY3Rpb24oKSB7CgkJCQkJCQkJCXZhciByZXR1cm5lZCA9IGZuICYmIGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCQkJCQkJaWYgKCByZXR1cm5lZCAmJiBqUXVlcnkuaXNGdW5jdGlvbiggcmV0dXJuZWQucHJvbWlzZSApICkgewoJCQkJCQkJCQkJcmV0dXJuZWQucHJvbWlzZSgpCgkJCQkJCQkJCQkJLnByb2dyZXNzKCBuZXdEZWZlci5ub3RpZnkgKQoJCQkJCQkJCQkJCS5kb25lKCBuZXdEZWZlci5yZXNvbHZlICkKCQkJCQkJCQkJCQkuZmFpbCggbmV3RGVmZXIucmVqZWN0ICk7CgkJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCQluZXdEZWZlclsgdHVwbGVbIDAgXSArICJXaXRoIiBdKAoJCQkJCQkJCQkJCXRoaXMgPT09IHByb21pc2UgPyBuZXdEZWZlci5wcm9taXNlKCkgOiB0aGlzLAoJCQkJCQkJCQkJCWZuID8gWyByZXR1cm5lZCBdIDogYXJndW1lbnRzCgkJCQkJCQkJCQkpOwoJCQkJCQkJCQl9CgkJCQkJCQkJfSApOwoJCQkJCQkJfSApOwoJCQkJCQkJZm5zID0gbnVsbDsKCQkJCQkJfSApLnByb21pc2UoKTsKCQkJCQl9LAoKCQkJCQkvLyBHZXQgYSBwcm9taXNlIGZvciB0aGlzIGRlZmVycmVkCgkJCQkJLy8gSWYgb2JqIGlzIHByb3ZpZGVkLCB0aGUgcHJvbWlzZSBhc3BlY3QgaXMgYWRkZWQgdG8gdGhlIG9iamVjdAoJCQkJCXByb21pc2U6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCQkJCXJldHVybiBvYmogIT0gbnVsbCA/IGpRdWVyeS5leHRlbmQoIG9iaiwgcHJvbWlzZSApIDogcHJvbWlzZTsKCQkJCQl9CgkJCQl9LAoJCQkJZGVmZXJyZWQgPSB7fTsKCgkJCS8vIEtlZXAgcGlwZSBmb3IgYmFjay1jb21wYXQKCQkJcHJvbWlzZS5waXBlID0gcHJvbWlzZS50aGVuOwoKCQkJLy8gQWRkIGxpc3Qtc3BlY2lmaWMgbWV0aG9kcwoJCQlqUXVlcnkuZWFjaCggdHVwbGVzLCBmdW5jdGlvbiggaSwgdHVwbGUgKSB7CgkJCQl2YXIgbGlzdCA9IHR1cGxlWyAyIF0sCgkJCQkJc3RhdGVTdHJpbmcgPSB0dXBsZVsgMyBdOwoKCQkJCS8vIHByb21pc2VbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSA9IGxpc3QuYWRkCgkJCQlwcm9taXNlWyB0dXBsZVsgMSBdIF0gPSBsaXN0LmFkZDsKCgkJCQkvLyBIYW5kbGUgc3RhdGUKCQkJCWlmICggc3RhdGVTdHJpbmcgKSB7CgkJCQkJbGlzdC5hZGQoIGZ1bmN0aW9uKCkgewoKCQkJCQkJLy8gc3RhdGUgPSBbIHJlc29sdmVkIHwgcmVqZWN0ZWQgXQoJCQkJCQlzdGF0ZSA9IHN0YXRlU3RyaW5nOwoKCQkJCQkvLyBbIHJlamVjdF9saXN0IHwgcmVzb2x2ZV9saXN0IF0uZGlzYWJsZTsgcHJvZ3Jlc3NfbGlzdC5sb2NrCgkJCQkJfSwgdHVwbGVzWyBpIF4gMSBdWyAyIF0uZGlzYWJsZSwgdHVwbGVzWyAyIF1bIDIgXS5sb2NrICk7CgkJCQl9CgoJCQkJLy8gZGVmZXJyZWRbIHJlc29sdmUgfCByZWplY3QgfCBub3RpZnkgXQoJCQkJZGVmZXJyZWRbIHR1cGxlWyAwIF0gXSA9IGZ1bmN0aW9uKCkgewoJCQkJCWRlZmVycmVkWyB0dXBsZVsgMCBdICsgIldpdGgiIF0oIHRoaXMgPT09IGRlZmVycmVkID8gcHJvbWlzZSA6IHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfTsKCQkJCWRlZmVycmVkWyB0dXBsZVsgMCBdICsgIldpdGgiIF0gPSBsaXN0LmZpcmVXaXRoOwoJCQl9ICk7CgoJCQkvLyBNYWtlIHRoZSBkZWZlcnJlZCBhIHByb21pc2UKCQkJcHJvbWlzZS5wcm9taXNlKCBkZWZlcnJlZCApOwoKCQkJLy8gQ2FsbCBnaXZlbiBmdW5jIGlmIGFueQoJCQlpZiAoIGZ1bmMgKSB7CgkJCQlmdW5jLmNhbGwoIGRlZmVycmVkLCBkZWZlcnJlZCApOwoJCQl9CgoJCQkvLyBBbGwgZG9uZSEKCQkJcmV0dXJuIGRlZmVycmVkOwoJCX0sCgoJCS8vIERlZmVycmVkIGhlbHBlcgoJCXdoZW46IGZ1bmN0aW9uKCBzdWJvcmRpbmF0ZSAvKiAsIC4uLiwgc3Vib3JkaW5hdGVOICovICkgewoJCQl2YXIgaSA9IDAsCgkJCQlyZXNvbHZlVmFsdWVzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksCgkJCQlsZW5ndGggPSByZXNvbHZlVmFsdWVzLmxlbmd0aCwKCgkJCQkvLyB0aGUgY291bnQgb2YgdW5jb21wbGV0ZWQgc3Vib3JkaW5hdGVzCgkJCQlyZW1haW5pbmcgPSBsZW5ndGggIT09IDEgfHwKCQkJCQkoIHN1Ym9yZGluYXRlICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCBzdWJvcmRpbmF0ZS5wcm9taXNlICkgKSA/IGxlbmd0aCA6IDAsCgoJCQkJLy8gdGhlIG1hc3RlciBEZWZlcnJlZC4KCQkJCS8vIElmIHJlc29sdmVWYWx1ZXMgY29uc2lzdCBvZiBvbmx5IGEgc2luZ2xlIERlZmVycmVkLCBqdXN0IHVzZSB0aGF0LgoJCQkJZGVmZXJyZWQgPSByZW1haW5pbmcgPT09IDEgPyBzdWJvcmRpbmF0ZSA6IGpRdWVyeS5EZWZlcnJlZCgpLAoKCQkJCS8vIFVwZGF0ZSBmdW5jdGlvbiBmb3IgYm90aCByZXNvbHZlIGFuZCBwcm9ncmVzcyB2YWx1ZXMKCQkJCXVwZGF0ZUZ1bmMgPSBmdW5jdGlvbiggaSwgY29udGV4dHMsIHZhbHVlcyApIHsKCQkJCQlyZXR1cm4gZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJCQljb250ZXh0c1sgaSBdID0gdGhpczsKCQkJCQkJdmFsdWVzWyBpIF0gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApIDogdmFsdWU7CgkJCQkJCWlmICggdmFsdWVzID09PSBwcm9ncmVzc1ZhbHVlcyApIHsKCQkJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTsKCgkJCQkJCX0gZWxzZSBpZiAoICEoIC0tcmVtYWluaW5nICkgKSB7CgkJCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggY29udGV4dHMsIHZhbHVlcyApOwoJCQkJCQl9CgkJCQkJfTsKCQkJCX0sCgoJCQkJcHJvZ3Jlc3NWYWx1ZXMsIHByb2dyZXNzQ29udGV4dHMsIHJlc29sdmVDb250ZXh0czsKCgkJCS8vIGFkZCBsaXN0ZW5lcnMgdG8gRGVmZXJyZWQgc3Vib3JkaW5hdGVzOyB0cmVhdCBvdGhlcnMgYXMgcmVzb2x2ZWQKCQkJaWYgKCBsZW5ndGggPiAxICkgewoJCQkJcHJvZ3Jlc3NWYWx1ZXMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJcHJvZ3Jlc3NDb250ZXh0cyA9IG5ldyBBcnJheSggbGVuZ3RoICk7CgkJCQlyZXNvbHZlQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJaWYgKCByZXNvbHZlVmFsdWVzWyBpIF0gJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlICkgKSB7CgkJCQkJCXJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlKCkKCQkJCQkJCS5wcm9ncmVzcyggdXBkYXRlRnVuYyggaSwgcHJvZ3Jlc3NDb250ZXh0cywgcHJvZ3Jlc3NWYWx1ZXMgKSApCgkJCQkJCQkuZG9uZSggdXBkYXRlRnVuYyggaSwgcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICkgKQoJCQkJCQkJLmZhaWwoIGRlZmVycmVkLnJlamVjdCApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCS0tcmVtYWluaW5nOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gaWYgd2UncmUgbm90IHdhaXRpbmcgb24gYW55dGhpbmcsIHJlc29sdmUgdGhlIG1hc3RlcgoJCQlpZiAoICFyZW1haW5pbmcgKSB7CgkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICk7CgkJCX0KCgkJCXJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7CgkJfQoJfSApOwoKCgkvLyBUaGUgZGVmZXJyZWQgdXNlZCBvbiBET00gcmVhZHkKCXZhciByZWFkeUxpc3Q7CgoJalF1ZXJ5LmZuLnJlYWR5ID0gZnVuY3Rpb24oIGZuICkgewoKCQkvLyBBZGQgdGhlIGNhbGxiYWNrCgkJalF1ZXJ5LnJlYWR5LnByb21pc2UoKS5kb25lKCBmbiApOwoKCQlyZXR1cm4gdGhpczsKCX07CgoJalF1ZXJ5LmV4dGVuZCggewoKCQkvLyBJcyB0aGUgRE9NIHJlYWR5IHRvIGJlIHVzZWQ/IFNldCB0byB0cnVlIG9uY2UgaXQgb2NjdXJzLgoJCWlzUmVhZHk6IGZhbHNlLAoKCQkvLyBBIGNvdW50ZXIgdG8gdHJhY2sgaG93IG1hbnkgaXRlbXMgdG8gd2FpdCBmb3IgYmVmb3JlCgkJLy8gdGhlIHJlYWR5IGV2ZW50IGZpcmVzLiBTZWUgIzY3ODEKCQlyZWFkeVdhaXQ6IDEsCgoJCS8vIEhvbGQgKG9yIHJlbGVhc2UpIHRoZSByZWFkeSBldmVudAoJCWhvbGRSZWFkeTogZnVuY3Rpb24oIGhvbGQgKSB7CgkJCWlmICggaG9sZCApIHsKCQkJCWpRdWVyeS5yZWFkeVdhaXQrKzsKCQkJfSBlbHNlIHsKCQkJCWpRdWVyeS5yZWFkeSggdHJ1ZSApOwoJCQl9CgkJfSwKCgkJLy8gSGFuZGxlIHdoZW4gdGhlIERPTSBpcyByZWFkeQoJCXJlYWR5OiBmdW5jdGlvbiggd2FpdCApIHsKCgkJCS8vIEFib3J0IGlmIHRoZXJlIGFyZSBwZW5kaW5nIGhvbGRzIG9yIHdlJ3JlIGFscmVhZHkgcmVhZHkKCQkJaWYgKCB3YWl0ID09PSB0cnVlID8gLS1qUXVlcnkucmVhZHlXYWl0IDogalF1ZXJ5LmlzUmVhZHkgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIFJlbWVtYmVyIHRoYXQgdGhlIERPTSBpcyByZWFkeQoJCQlqUXVlcnkuaXNSZWFkeSA9IHRydWU7CgoJCQkvLyBJZiBhIG5vcm1hbCBET00gUmVhZHkgZXZlbnQgZmlyZWQsIGRlY3JlbWVudCwgYW5kIHdhaXQgaWYgbmVlZCBiZQoJCQlpZiAoIHdhaXQgIT09IHRydWUgJiYgLS1qUXVlcnkucmVhZHlXYWl0ID4gMCApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gSWYgdGhlcmUgYXJlIGZ1bmN0aW9ucyBib3VuZCwgdG8gZXhlY3V0ZQoJCQlyZWFkeUxpc3QucmVzb2x2ZVdpdGgoIGRvY3VtZW50LCBbIGpRdWVyeSBdICk7CgoJCQkvLyBUcmlnZ2VyIGFueSBib3VuZCByZWFkeSBldmVudHMKCQkJaWYgKCBqUXVlcnkuZm4udHJpZ2dlckhhbmRsZXIgKSB7CgkJCQlqUXVlcnkoIGRvY3VtZW50ICkudHJpZ2dlckhhbmRsZXIoICJyZWFkeSIgKTsKCQkJCWpRdWVyeSggZG9jdW1lbnQgKS5vZmYoICJyZWFkeSIgKTsKCQkJfQoJCX0KCX0gKTsKCgkvKioKCSAqIENsZWFuLXVwIG1ldGhvZCBmb3IgZG9tIHJlYWR5IGV2ZW50cwoJICovCglmdW5jdGlvbiBkZXRhY2goKSB7CgkJaWYgKCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICkgewoJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAiRE9NQ29udGVudExvYWRlZCIsIGNvbXBsZXRlZCApOwoJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggImxvYWQiLCBjb21wbGV0ZWQgKTsKCgkJfSBlbHNlIHsKCQkJZG9jdW1lbnQuZGV0YWNoRXZlbnQoICJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBjb21wbGV0ZWQgKTsKCQkJd2luZG93LmRldGFjaEV2ZW50KCAib25sb2FkIiwgY29tcGxldGVkICk7CgkJfQoJfQoKCS8qKgoJICogVGhlIHJlYWR5IGV2ZW50IGhhbmRsZXIgYW5kIHNlbGYgY2xlYW51cCBtZXRob2QKCSAqLwoJZnVuY3Rpb24gY29tcGxldGVkKCkgewoKCQkvLyByZWFkeVN0YXRlID09PSAiY29tcGxldGUiIGlzIGdvb2QgZW5vdWdoIGZvciB1cyB0byBjYWxsIHRoZSBkb20gcmVhZHkgaW4gb2xkSUUKCQlpZiAoIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgfHwKCQkJd2luZG93LmV2ZW50LnR5cGUgPT09ICJsb2FkIiB8fAoJCQlkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiICkgewoKCQkJZGV0YWNoKCk7CgkJCWpRdWVyeS5yZWFkeSgpOwoJCX0KCX0KCglqUXVlcnkucmVhZHkucHJvbWlzZSA9IGZ1bmN0aW9uKCBvYmogKSB7CgkJaWYgKCAhcmVhZHlMaXN0ICkgewoKCQkJcmVhZHlMaXN0ID0galF1ZXJ5LkRlZmVycmVkKCk7CgoJCQkvLyBDYXRjaCBjYXNlcyB3aGVyZSAkKGRvY3VtZW50KS5yZWFkeSgpIGlzIGNhbGxlZAoJCQkvLyBhZnRlciB0aGUgYnJvd3NlciBldmVudCBoYXMgYWxyZWFkeSBvY2N1cnJlZC4KCQkJLy8gU3VwcG9ydDogSUU2LTEwCgkJCS8vIE9sZGVyIElFIHNvbWV0aW1lcyBzaWduYWxzICJpbnRlcmFjdGl2ZSIgdG9vIHNvb24KCQkJaWYgKCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiIHx8CgkJCQkoIGRvY3VtZW50LnJlYWR5U3RhdGUgIT09ICJsb2FkaW5nIiAmJiAhZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsICkgKSB7CgoJCQkJLy8gSGFuZGxlIGl0IGFzeW5jaHJvbm91c2x5IHRvIGFsbG93IHNjcmlwdHMgdGhlIG9wcG9ydHVuaXR5IHRvIGRlbGF5IHJlYWR5CgkJCQl3aW5kb3cuc2V0VGltZW91dCggalF1ZXJ5LnJlYWR5ICk7CgoJCQkvLyBTdGFuZGFyZHMtYmFzZWQgYnJvd3NlcnMgc3VwcG9ydCBET01Db250ZW50TG9hZGVkCgkJCX0gZWxzZSBpZiAoIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7CgoJCQkJLy8gVXNlIHRoZSBoYW5keSBldmVudCBjYWxsYmFjawoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggIkRPTUNvbnRlbnRMb2FkZWQiLCBjb21wbGV0ZWQgKTsKCgkJCQkvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29yawoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICJsb2FkIiwgY29tcGxldGVkICk7CgoJCQkvLyBJZiBJRSBldmVudCBtb2RlbCBpcyB1c2VkCgkJCX0gZWxzZSB7CgoJCQkJLy8gRW5zdXJlIGZpcmluZyBiZWZvcmUgb25sb2FkLCBtYXliZSBsYXRlIGJ1dCBzYWZlIGFsc28gZm9yIGlmcmFtZXMKCQkJCWRvY3VtZW50LmF0dGFjaEV2ZW50KCAib25yZWFkeXN0YXRlY2hhbmdlIiwgY29tcGxldGVkICk7CgoJCQkJLy8gQSBmYWxsYmFjayB0byB3aW5kb3cub25sb2FkLCB0aGF0IHdpbGwgYWx3YXlzIHdvcmsKCQkJCXdpbmRvdy5hdHRhY2hFdmVudCggIm9ubG9hZCIsIGNvbXBsZXRlZCApOwoKCQkJCS8vIElmIElFIGFuZCBub3QgYSBmcmFtZQoJCQkJLy8gY29udGludWFsbHkgY2hlY2sgdG8gc2VlIGlmIHRoZSBkb2N1bWVudCBpcyByZWFkeQoJCQkJdmFyIHRvcCA9IGZhbHNlOwoKCQkJCXRyeSB7CgkJCQkJdG9wID0gd2luZG93LmZyYW1lRWxlbWVudCA9PSBudWxsICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCQkJCX0gY2F0Y2ggKCBlICkge30KCgkJCQlpZiAoIHRvcCAmJiB0b3AuZG9TY3JvbGwgKSB7CgkJCQkJKCBmdW5jdGlvbiBkb1Njcm9sbENoZWNrKCkgewoJCQkJCQlpZiAoICFqUXVlcnkuaXNSZWFkeSApIHsKCgkJCQkJCQl0cnkgewoKCQkJCQkJCQkvLyBVc2UgdGhlIHRyaWNrIGJ5IERpZWdvIFBlcmluaQoJCQkJCQkJCS8vIGh0dHA6Ly9qYXZhc2NyaXB0Lm53Ym94LmNvbS9JRUNvbnRlbnRMb2FkZWQvCgkJCQkJCQkJdG9wLmRvU2Nyb2xsKCAibGVmdCIgKTsKCQkJCQkJCX0gY2F0Y2ggKCBlICkgewoJCQkJCQkJCXJldHVybiB3aW5kb3cuc2V0VGltZW91dCggZG9TY3JvbGxDaGVjaywgNTAgKTsKCQkJCQkJCX0KCgkJCQkJCQkvLyBkZXRhY2ggYWxsIGRvbSByZWFkeSBldmVudHMKCQkJCQkJCWRldGFjaCgpOwoKCQkJCQkJCS8vIGFuZCBleGVjdXRlIGFueSB3YWl0aW5nIGZ1bmN0aW9ucwoJCQkJCQkJalF1ZXJ5LnJlYWR5KCk7CgkJCQkJCX0KCQkJCQl9ICkoKTsKCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gcmVhZHlMaXN0LnByb21pc2UoIG9iaiApOwoJfTsKCgkvLyBLaWNrIG9mZiB0aGUgRE9NIHJlYWR5IGNoZWNrIGV2ZW4gaWYgdGhlIHVzZXIgZG9lcyBub3QKCWpRdWVyeS5yZWFkeS5wcm9taXNlKCk7CgoKCgoJLy8gU3VwcG9ydDogSUU8OQoJLy8gSXRlcmF0aW9uIG92ZXIgb2JqZWN0J3MgaW5oZXJpdGVkIHByb3BlcnRpZXMgYmVmb3JlIGl0cyBvd24KCXZhciBpOwoJZm9yICggaSBpbiBqUXVlcnkoIHN1cHBvcnQgKSApIHsKCQlicmVhazsKCX0KCXN1cHBvcnQub3duRmlyc3QgPSBpID09PSAiMCI7CgoJLy8gTm90ZTogbW9zdCBzdXBwb3J0IHRlc3RzIGFyZSBkZWZpbmVkIGluIHRoZWlyIHJlc3BlY3RpdmUgbW9kdWxlcy4KCS8vIGZhbHNlIHVudGlsIHRoZSB0ZXN0IGlzIHJ1bgoJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gZmFsc2U7CgoJLy8gRXhlY3V0ZSBBU0FQIGluIGNhc2Ugd2UgbmVlZCB0byBzZXQgYm9keS5zdHlsZS56b29tCglqUXVlcnkoIGZ1bmN0aW9uKCkgewoKCQkvLyBNaW5pZmllZDogdmFyIGEsYixjLGQKCQl2YXIgdmFsLCBkaXYsIGJvZHksIGNvbnRhaW5lcjsKCgkJYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYm9keSIgKVsgMCBdOwoJCWlmICggIWJvZHkgfHwgIWJvZHkuc3R5bGUgKSB7CgoJCQkvLyBSZXR1cm4gZm9yIGZyYW1lc2V0IGRvY3MgdGhhdCBkb24ndCBoYXZlIGEgYm9keQoJCQlyZXR1cm47CgkJfQoKCQkvLyBTZXR1cAoJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweCI7CgkJYm9keS5hcHBlbmRDaGlsZCggY29udGFpbmVyICkuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQlpZiAoIHR5cGVvZiBkaXYuc3R5bGUuem9vbSAhPT0gInVuZGVmaW5lZCIgKSB7CgoJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCS8vIENoZWNrIGlmIG5hdGl2ZWx5IGJsb2NrLWxldmVsIGVsZW1lbnRzIGFjdCBsaWtlIGlubGluZS1ibG9jawoJCQkvLyBlbGVtZW50cyB3aGVuIHNldHRpbmcgdGhlaXIgZGlzcGxheSB0byAnaW5saW5lJyBhbmQgZ2l2aW5nCgkJCS8vIHRoZW0gbGF5b3V0CgkJCWRpdi5zdHlsZS5jc3NUZXh0ID0gImRpc3BsYXk6aW5saW5lO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MXB4O3dpZHRoOjFweDt6b29tOjEiOwoKCQkJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gdmFsID0gZGl2Lm9mZnNldFdpZHRoID09PSAzOwoJCQlpZiAoIHZhbCApIHsKCgkJCQkvLyBQcmV2ZW50IElFIDYgZnJvbSBhZmZlY3RpbmcgbGF5b3V0IGZvciBwb3NpdGlvbmVkIGVsZW1lbnRzICMxMTA0OAoJCQkJLy8gUHJldmVudCBJRSBmcm9tIHNocmlua2luZyB0aGUgYm9keSBpbiBJRSA3IG1vZGUgIzEyODY5CgkJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCQlib2R5LnN0eWxlLnpvb20gPSAxOwoJCQl9CgkJfQoKCQlib2R5LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCX0gKTsKCgoJKCBmdW5jdGlvbigpIHsKCQl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCXN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9IHRydWU7CgkJdHJ5IHsKCQkJZGVsZXRlIGRpdi50ZXN0OwoJCX0gY2F0Y2ggKCBlICkgewoJCQlzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPSBmYWxzZTsKCQl9CgoJCS8vIE51bGwgZWxlbWVudHMgdG8gYXZvaWQgbGVha3MgaW4gSUUuCgkJZGl2ID0gbnVsbDsKCX0gKSgpOwoJdmFyIGFjY2VwdERhdGEgPSBmdW5jdGlvbiggZWxlbSApIHsKCQl2YXIgbm9EYXRhID0galF1ZXJ5Lm5vRGF0YVsgKCBlbGVtLm5vZGVOYW1lICsgIiAiICkudG9Mb3dlckNhc2UoKSBdLAoJCQlub2RlVHlwZSA9ICtlbGVtLm5vZGVUeXBlIHx8IDE7CgoJCS8vIERvIG5vdCBzZXQgZGF0YSBvbiBub24tZWxlbWVudCBET00gbm9kZXMgYmVjYXVzZSBpdCB3aWxsIG5vdCBiZSBjbGVhcmVkICgjODMzNSkuCgkJcmV0dXJuIG5vZGVUeXBlICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ID8KCQkJZmFsc2UgOgoKCQkJLy8gTm9kZXMgYWNjZXB0IGRhdGEgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQ7IHJlamVjdGlvbiBjYW4gYmUgY29uZGl0aW9uYWwKCQkJIW5vRGF0YSB8fCBub0RhdGEgIT09IHRydWUgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoICJjbGFzc2lkIiApID09PSBub0RhdGE7Cgl9OwoKCgoKCXZhciByYnJhY2UgPSAvXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLAoJCXJtdWx0aURhc2ggPSAvKFtBLVpdKS9nOwoKCWZ1bmN0aW9uIGRhdGFBdHRyKCBlbGVtLCBrZXksIGRhdGEgKSB7CgoJCS8vIElmIG5vdGhpbmcgd2FzIGZvdW5kIGludGVybmFsbHksIHRyeSB0byBmZXRjaCBhbnkKCQkvLyBkYXRhIGZyb20gdGhlIEhUTUw1IGRhdGEtKiBhdHRyaWJ1dGUKCQlpZiAoIGRhdGEgPT09IHVuZGVmaW5lZCAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkgewoKCQkJdmFyIG5hbWUgPSAiZGF0YS0iICsga2V5LnJlcGxhY2UoIHJtdWx0aURhc2gsICItJDEiICkudG9Mb3dlckNhc2UoKTsKCgkJCWRhdGEgPSBlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApOwoKCQkJaWYgKCB0eXBlb2YgZGF0YSA9PT0gInN0cmluZyIgKSB7CgkJCQl0cnkgewoJCQkJCWRhdGEgPSBkYXRhID09PSAidHJ1ZSIgPyB0cnVlIDoKCQkJCQkJZGF0YSA9PT0gImZhbHNlIiA/IGZhbHNlIDoKCQkJCQkJZGF0YSA9PT0gIm51bGwiID8gbnVsbCA6CgoJCQkJCQkvLyBPbmx5IGNvbnZlcnQgdG8gYSBudW1iZXIgaWYgaXQgZG9lc24ndCBjaGFuZ2UgdGhlIHN0cmluZwoJCQkJCQkrZGF0YSArICIiID09PSBkYXRhID8gK2RhdGEgOgoJCQkJCQlyYnJhY2UudGVzdCggZGF0YSApID8galF1ZXJ5LnBhcnNlSlNPTiggZGF0YSApIDoKCQkJCQkJZGF0YTsKCQkJCX0gY2F0Y2ggKCBlICkge30KCgkJCQkvLyBNYWtlIHN1cmUgd2Ugc2V0IHRoZSBkYXRhIHNvIGl0IGlzbid0IGNoYW5nZWQgbGF0ZXIKCQkJCWpRdWVyeS5kYXRhKCBlbGVtLCBrZXksIGRhdGEgKTsKCgkJCX0gZWxzZSB7CgkJCQlkYXRhID0gdW5kZWZpbmVkOwoJCQl9CgkJfQoKCQlyZXR1cm4gZGF0YTsKCX0KCgkvLyBjaGVja3MgYSBjYWNoZSBvYmplY3QgZm9yIGVtcHRpbmVzcwoJZnVuY3Rpb24gaXNFbXB0eURhdGFPYmplY3QoIG9iaiApIHsKCQl2YXIgbmFtZTsKCQlmb3IgKCBuYW1lIGluIG9iaiApIHsKCgkJCS8vIGlmIHRoZSBwdWJsaWMgZGF0YSBvYmplY3QgaXMgZW1wdHksIHRoZSBwcml2YXRlIGlzIHN0aWxsIGVtcHR5CgkJCWlmICggbmFtZSA9PT0gImRhdGEiICYmIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBvYmpbIG5hbWUgXSApICkgewoJCQkJY29udGludWU7CgkJCX0KCQkJaWYgKCBuYW1lICE9PSAidG9KU09OIiApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX0KCgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gaW50ZXJuYWxEYXRhKCBlbGVtLCBuYW1lLCBkYXRhLCBwdnQgLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8gKSB7CgkJaWYgKCAhYWNjZXB0RGF0YSggZWxlbSApICkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgcmV0LCB0aGlzQ2FjaGUsCgkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgoJCQkvLyBXZSBoYXZlIHRvIGhhbmRsZSBET00gbm9kZXMgYW5kIEpTIG9iamVjdHMgZGlmZmVyZW50bHkgYmVjYXVzZSBJRTYtNwoJCQkvLyBjYW4ndCBHQyBvYmplY3QgcmVmZXJlbmNlcyBwcm9wZXJseSBhY3Jvc3MgdGhlIERPTS1KUyBib3VuZGFyeQoJCQlpc05vZGUgPSBlbGVtLm5vZGVUeXBlLAoKCQkJLy8gT25seSBET00gbm9kZXMgbmVlZCB0aGUgZ2xvYmFsIGpRdWVyeSBjYWNoZTsgSlMgb2JqZWN0IGRhdGEgaXMKCQkJLy8gYXR0YWNoZWQgZGlyZWN0bHkgdG8gdGhlIG9iamVjdCBzbyBHQyBjYW4gb2NjdXIgYXV0b21hdGljYWxseQoJCQljYWNoZSA9IGlzTm9kZSA/IGpRdWVyeS5jYWNoZSA6IGVsZW0sCgoJCQkvLyBPbmx5IGRlZmluaW5nIGFuIElEIGZvciBKUyBvYmplY3RzIGlmIGl0cyBjYWNoZSBhbHJlYWR5IGV4aXN0cyBhbGxvd3MKCQkJLy8gdGhlIGNvZGUgdG8gc2hvcnRjdXQgb24gdGhlIHNhbWUgcGF0aCBhcyBhIERPTSBub2RlIHdpdGggbm8gY2FjaGUKCQkJaWQgPSBpc05vZGUgPyBlbGVtWyBpbnRlcm5hbEtleSBdIDogZWxlbVsgaW50ZXJuYWxLZXkgXSAmJiBpbnRlcm5hbEtleTsKCgkJLy8gQXZvaWQgZG9pbmcgYW55IG1vcmUgd29yayB0aGFuIHdlIG5lZWQgdG8gd2hlbiB0cnlpbmcgdG8gZ2V0IGRhdGEgb24gYW4KCQkvLyBvYmplY3QgdGhhdCBoYXMgbm8gZGF0YSBhdCBhbGwKCQlpZiAoICggIWlkIHx8ICFjYWNoZVsgaWQgXSB8fCAoICFwdnQgJiYgIWNhY2hlWyBpZCBdLmRhdGEgKSApICYmCgkJCWRhdGEgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7CgkJCXJldHVybjsKCQl9CgoJCWlmICggIWlkICkgewoKCQkJLy8gT25seSBET00gbm9kZXMgbmVlZCBhIG5ldyB1bmlxdWUgSUQgZm9yIGVhY2ggZWxlbWVudCBzaW5jZSB0aGVpciBkYXRhCgkJCS8vIGVuZHMgdXAgaW4gdGhlIGdsb2JhbCBjYWNoZQoJCQlpZiAoIGlzTm9kZSApIHsKCQkJCWlkID0gZWxlbVsgaW50ZXJuYWxLZXkgXSA9IGRlbGV0ZWRJZHMucG9wKCkgfHwgalF1ZXJ5Lmd1aWQrKzsKCQkJfSBlbHNlIHsKCQkJCWlkID0gaW50ZXJuYWxLZXk7CgkJCX0KCQl9CgoJCWlmICggIWNhY2hlWyBpZCBdICkgewoKCQkJLy8gQXZvaWQgZXhwb3NpbmcgalF1ZXJ5IG1ldGFkYXRhIG9uIHBsYWluIEpTIG9iamVjdHMgd2hlbiB0aGUgb2JqZWN0CgkJCS8vIGlzIHNlcmlhbGl6ZWQgdXNpbmcgSlNPTi5zdHJpbmdpZnkKCQkJY2FjaGVbIGlkIF0gPSBpc05vZGUgPyB7fSA6IHsgdG9KU09OOiBqUXVlcnkubm9vcCB9OwoJCX0KCgkJLy8gQW4gb2JqZWN0IGNhbiBiZSBwYXNzZWQgdG8galF1ZXJ5LmRhdGEgaW5zdGVhZCBvZiBhIGtleS92YWx1ZSBwYWlyOyB0aGlzIGdldHMKCQkvLyBzaGFsbG93IGNvcGllZCBvdmVyIG9udG8gdGhlIGV4aXN0aW5nIGNhY2hlCgkJaWYgKCB0eXBlb2YgbmFtZSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIG5hbWUgPT09ICJmdW5jdGlvbiIgKSB7CgkJCWlmICggcHZ0ICkgewoJCQkJY2FjaGVbIGlkIF0gPSBqUXVlcnkuZXh0ZW5kKCBjYWNoZVsgaWQgXSwgbmFtZSApOwoJCQl9IGVsc2UgewoJCQkJY2FjaGVbIGlkIF0uZGF0YSA9IGpRdWVyeS5leHRlbmQoIGNhY2hlWyBpZCBdLmRhdGEsIG5hbWUgKTsKCQkJfQoJCX0KCgkJdGhpc0NhY2hlID0gY2FjaGVbIGlkIF07CgoJCS8vIGpRdWVyeSBkYXRhKCkgaXMgc3RvcmVkIGluIGEgc2VwYXJhdGUgb2JqZWN0IGluc2lkZSB0aGUgb2JqZWN0J3MgaW50ZXJuYWwgZGF0YQoJCS8vIGNhY2hlIGluIG9yZGVyIHRvIGF2b2lkIGtleSBjb2xsaXNpb25zIGJldHdlZW4gaW50ZXJuYWwgZGF0YSBhbmQgdXNlci1kZWZpbmVkCgkJLy8gZGF0YS4KCQlpZiAoICFwdnQgKSB7CgkJCWlmICggIXRoaXNDYWNoZS5kYXRhICkgewoJCQkJdGhpc0NhY2hlLmRhdGEgPSB7fTsKCQkJfQoKCQkJdGhpc0NhY2hlID0gdGhpc0NhY2hlLmRhdGE7CgkJfQoKCQlpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHsKCQkJdGhpc0NhY2hlWyBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICkgXSA9IGRhdGE7CgkJfQoKCQkvLyBDaGVjayBmb3IgYm90aCBjb252ZXJ0ZWQtdG8tY2FtZWwgYW5kIG5vbi1jb252ZXJ0ZWQgZGF0YSBwcm9wZXJ0eSBuYW1lcwoJCS8vIElmIGEgZGF0YSBwcm9wZXJ0eSB3YXMgc3BlY2lmaWVkCgkJaWYgKCB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7CgoJCQkvLyBGaXJzdCBUcnkgdG8gZmluZCBhcy1pcyBwcm9wZXJ0eSBkYXRhCgkJCXJldCA9IHRoaXNDYWNoZVsgbmFtZSBdOwoKCQkJLy8gVGVzdCBmb3IgbnVsbHx1bmRlZmluZWQgcHJvcGVydHkgZGF0YQoJCQlpZiAoIHJldCA9PSBudWxsICkgewoKCQkJCS8vIFRyeSB0byBmaW5kIHRoZSBjYW1lbENhc2VkIHByb3BlcnR5CgkJCQlyZXQgPSB0aGlzQ2FjaGVbIGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSBdOwoJCQl9CgkJfSBlbHNlIHsKCQkJcmV0ID0gdGhpc0NhY2hlOwoJCX0KCgkJcmV0dXJuIHJldDsKCX0KCglmdW5jdGlvbiBpbnRlcm5hbFJlbW92ZURhdGEoIGVsZW0sIG5hbWUsIHB2dCApIHsKCQlpZiAoICFhY2NlcHREYXRhKCBlbGVtICkgKSB7CgkJCXJldHVybjsKCQl9CgoJCXZhciB0aGlzQ2FjaGUsIGksCgkJCWlzTm9kZSA9IGVsZW0ubm9kZVR5cGUsCgoJCQkvLyBTZWUgalF1ZXJ5LmRhdGEgZm9yIG1vcmUgaW5mb3JtYXRpb24KCQkJY2FjaGUgPSBpc05vZGUgPyBqUXVlcnkuY2FjaGUgOiBlbGVtLAoJCQlpZCA9IGlzTm9kZSA/IGVsZW1bIGpRdWVyeS5leHBhbmRvIF0gOiBqUXVlcnkuZXhwYW5kbzsKCgkJLy8gSWYgdGhlcmUgaXMgYWxyZWFkeSBubyBjYWNoZSBlbnRyeSBmb3IgdGhpcyBvYmplY3QsIHRoZXJlIGlzIG5vCgkJLy8gcHVycG9zZSBpbiBjb250aW51aW5nCgkJaWYgKCAhY2FjaGVbIGlkIF0gKSB7CgkJCXJldHVybjsKCQl9CgoJCWlmICggbmFtZSApIHsKCgkJCXRoaXNDYWNoZSA9IHB2dCA/IGNhY2hlWyBpZCBdIDogY2FjaGVbIGlkIF0uZGF0YTsKCgkJCWlmICggdGhpc0NhY2hlICkgewoKCQkJCS8vIFN1cHBvcnQgYXJyYXkgb3Igc3BhY2Ugc2VwYXJhdGVkIHN0cmluZyBuYW1lcyBmb3IgZGF0YSBrZXlzCgkJCQlpZiAoICFqUXVlcnkuaXNBcnJheSggbmFtZSApICkgewoKCQkJCQkvLyB0cnkgdGhlIHN0cmluZyBhcyBhIGtleSBiZWZvcmUgYW55IG1hbmlwdWxhdGlvbgoJCQkJCWlmICggbmFtZSBpbiB0aGlzQ2FjaGUgKSB7CgkJCQkJCW5hbWUgPSBbIG5hbWUgXTsKCQkJCQl9IGVsc2UgewoKCQkJCQkJLy8gc3BsaXQgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gYnkgc3BhY2VzIHVubGVzcyBhIGtleSB3aXRoIHRoZSBzcGFjZXMgZXhpc3RzCgkJCQkJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICk7CgkJCQkJCWlmICggbmFtZSBpbiB0aGlzQ2FjaGUgKSB7CgkJCQkJCQluYW1lID0gWyBuYW1lIF07CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQluYW1lID0gbmFtZS5zcGxpdCggIiAiICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoKCQkJCQkvLyBJZiAibmFtZSIgaXMgYW4gYXJyYXkgb2Yga2V5cy4uLgoJCQkJCS8vIFdoZW4gZGF0YSBpcyBpbml0aWFsbHkgY3JlYXRlZCwgdmlhICgia2V5IiwgInZhbCIpIHNpZ25hdHVyZSwKCQkJCQkvLyBrZXlzIHdpbGwgYmUgY29udmVydGVkIHRvIGNhbWVsQ2FzZS4KCQkJCQkvLyBTaW5jZSB0aGVyZSBpcyBubyB3YXkgdG8gdGVsbCBfaG93XyBhIGtleSB3YXMgYWRkZWQsIHJlbW92ZQoJCQkJCS8vIGJvdGggcGxhaW4ga2V5IGFuZCBjYW1lbENhc2Uga2V5LiAjMTI3ODYKCQkJCQkvLyBUaGlzIHdpbGwgb25seSBwZW5hbGl6ZSB0aGUgYXJyYXkgYXJndW1lbnQgcGF0aC4KCQkJCQluYW1lID0gbmFtZS5jb25jYXQoIGpRdWVyeS5tYXAoIG5hbWUsIGpRdWVyeS5jYW1lbENhc2UgKSApOwoJCQkJfQoKCQkJCWkgPSBuYW1lLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWRlbGV0ZSB0aGlzQ2FjaGVbIG5hbWVbIGkgXSBdOwoJCQkJfQoKCQkJCS8vIElmIHRoZXJlIGlzIG5vIGRhdGEgbGVmdCBpbiB0aGUgY2FjaGUsIHdlIHdhbnQgdG8gY29udGludWUKCQkJCS8vIGFuZCBsZXQgdGhlIGNhY2hlIG9iamVjdCBpdHNlbGYgZ2V0IGRlc3Ryb3llZAoJCQkJaWYgKCBwdnQgPyAhaXNFbXB0eURhdGFPYmplY3QoIHRoaXNDYWNoZSApIDogIWpRdWVyeS5pc0VtcHR5T2JqZWN0KCB0aGlzQ2FjaGUgKSApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCX0KCQl9CgoJCS8vIFNlZSBqUXVlcnkuZGF0YSBmb3IgbW9yZSBpbmZvcm1hdGlvbgoJCWlmICggIXB2dCApIHsKCQkJZGVsZXRlIGNhY2hlWyBpZCBdLmRhdGE7CgoJCQkvLyBEb24ndCBkZXN0cm95IHRoZSBwYXJlbnQgY2FjaGUgdW5sZXNzIHRoZSBpbnRlcm5hbCBkYXRhIG9iamVjdAoJCQkvLyBoYWQgYmVlbiB0aGUgb25seSB0aGluZyBsZWZ0IGluIGl0CgkJCWlmICggIWlzRW1wdHlEYXRhT2JqZWN0KCBjYWNoZVsgaWQgXSApICkgewoJCQkJcmV0dXJuOwoJCQl9CgkJfQoKCQkvLyBEZXN0cm95IHRoZSBjYWNoZQoJCWlmICggaXNOb2RlICkgewoJCQlqUXVlcnkuY2xlYW5EYXRhKCBbIGVsZW0gXSwgdHJ1ZSApOwoKCQkvLyBVc2UgZGVsZXRlIHdoZW4gc3VwcG9ydGVkIGZvciBleHBhbmRvcyBvciBgY2FjaGVgIGlzIG5vdCBhIHdpbmRvdyBwZXIgaXNXaW5kb3cgKCMxMDA4MCkKCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCX0gZWxzZSBpZiAoIHN1cHBvcnQuZGVsZXRlRXhwYW5kbyB8fCBjYWNoZSAhPSBjYWNoZS53aW5kb3cgKSB7CgkJCS8qIGpzaGludCBlcWVxZXE6IHRydWUgKi8KCQkJZGVsZXRlIGNhY2hlWyBpZCBdOwoKCQkvLyBXaGVuIGFsbCBlbHNlIGZhaWxzLCB1bmRlZmluZWQKCQl9IGVsc2UgewoJCQljYWNoZVsgaWQgXSA9IHVuZGVmaW5lZDsKCQl9Cgl9CgoJalF1ZXJ5LmV4dGVuZCggewoJCWNhY2hlOiB7fSwKCgkJLy8gVGhlIGZvbGxvd2luZyBlbGVtZW50cyAoc3BhY2Utc3VmZml4ZWQgdG8gYXZvaWQgT2JqZWN0LnByb3RvdHlwZSBjb2xsaXNpb25zKQoJCS8vIHRocm93IHVuY2F0Y2hhYmxlIGV4Y2VwdGlvbnMgaWYgeW91IGF0dGVtcHQgdG8gc2V0IGV4cGFuZG8gcHJvcGVydGllcwoJCW5vRGF0YTogewoJCQkiYXBwbGV0ICI6IHRydWUsCgkJCSJlbWJlZCAiOiB0cnVlLAoKCQkJLy8gLi4uYnV0IEZsYXNoIG9iamVjdHMgKHdoaWNoIGhhdmUgdGhpcyBjbGFzc2lkKSAqY2FuKiBoYW5kbGUgZXhwYW5kb3MKCQkJIm9iamVjdCAiOiAiY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwIgoJCX0sCgoJCWhhc0RhdGE6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQllbGVtID0gZWxlbS5ub2RlVHlwZSA/IGpRdWVyeS5jYWNoZVsgZWxlbVsgalF1ZXJ5LmV4cGFuZG8gXSBdIDogZWxlbVsgalF1ZXJ5LmV4cGFuZG8gXTsKCQkJcmV0dXJuICEhZWxlbSAmJiAhaXNFbXB0eURhdGFPYmplY3QoIGVsZW0gKTsKCQl9LAoKCQlkYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQkJcmV0dXJuIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSApOwoJCX0sCgoJCXJlbW92ZURhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQlyZXR1cm4gaW50ZXJuYWxSZW1vdmVEYXRhKCBlbGVtLCBuYW1lICk7CgkJfSwKCgkJLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgoJCV9kYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQkJcmV0dXJuIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSwgdHJ1ZSApOwoJCX0sCgoJCV9yZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkJcmV0dXJuIGludGVybmFsUmVtb3ZlRGF0YSggZWxlbSwgbmFtZSwgdHJ1ZSApOwoJCX0KCX0gKTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJZGF0YTogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7CgkJCXZhciBpLCBuYW1lLCBkYXRhLAoJCQkJZWxlbSA9IHRoaXNbIDAgXSwKCQkJCWF0dHJzID0gZWxlbSAmJiBlbGVtLmF0dHJpYnV0ZXM7CgoJCQkvLyBTcGVjaWFsIGV4cGVjdGlvbnMgb2YgLmRhdGEgYmFzaWNhbGx5IHRod2FydCBqUXVlcnkuYWNjZXNzLAoJCQkvLyBzbyBpbXBsZW1lbnQgdGhlIHJlbGV2YW50IGJlaGF2aW9yIG91cnNlbHZlcwoKCQkJLy8gR2V0cyBhbGwgdmFsdWVzCgkJCWlmICgga2V5ID09PSB1bmRlZmluZWQgKSB7CgkJCQlpZiAoIHRoaXMubGVuZ3RoICkgewoJCQkJCWRhdGEgPSBqUXVlcnkuZGF0YSggZWxlbSApOwoKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgIWpRdWVyeS5fZGF0YSggZWxlbSwgInBhcnNlZEF0dHJzIiApICkgewoJCQkJCQlpID0gYXR0cnMubGVuZ3RoOwoJCQkJCQl3aGlsZSAoIGktLSApIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRTExKwoJCQkJCQkJLy8gVGhlIGF0dHJzIGVsZW1lbnRzIGNhbiBiZSBudWxsICgjMTQ4OTQpCgkJCQkJCQlpZiAoIGF0dHJzWyBpIF0gKSB7CgkJCQkJCQkJbmFtZSA9IGF0dHJzWyBpIF0ubmFtZTsKCQkJCQkJCQlpZiAoIG5hbWUuaW5kZXhPZiggImRhdGEtIiApID09PSAwICkgewoJCQkJCQkJCQluYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZS5zbGljZSggNSApICk7CgkJCQkJCQkJCWRhdGFBdHRyKCBlbGVtLCBuYW1lLCBkYXRhWyBuYW1lIF0gKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAicGFyc2VkQXR0cnMiLCB0cnVlICk7CgkJCQkJfQoJCQkJfQoKCQkJCXJldHVybiBkYXRhOwoJCQl9CgoJCQkvLyBTZXRzIG11bHRpcGxlIHZhbHVlcwoJCQlpZiAoIHR5cGVvZiBrZXkgPT09ICJvYmplY3QiICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5LmRhdGEoIHRoaXMsIGtleSApOwoJCQkJfSApOwoJCQl9CgoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDEgPwoKCQkJCS8vIFNldHMgb25lIHZhbHVlCgkJCQl0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kYXRhKCB0aGlzLCBrZXksIHZhbHVlICk7CgkJCQl9ICkgOgoKCQkJCS8vIEdldHMgb25lIHZhbHVlCgkJCQkvLyBUcnkgdG8gZmV0Y2ggYW55IGludGVybmFsbHkgc3RvcmVkIGRhdGEgZmlyc3QKCQkJCWVsZW0gPyBkYXRhQXR0ciggZWxlbSwga2V5LCBqUXVlcnkuZGF0YSggZWxlbSwga2V5ICkgKSA6IHVuZGVmaW5lZDsKCQl9LAoKCQlyZW1vdmVEYXRhOiBmdW5jdGlvbigga2V5ICkgewoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5yZW1vdmVEYXRhKCB0aGlzLCBrZXkgKTsKCQkJfSApOwoJCX0KCX0gKTsKCgoJalF1ZXJ5LmV4dGVuZCggewoJCXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSwgZGF0YSApIHsKCQkJdmFyIHF1ZXVlOwoKCQkJaWYgKCBlbGVtICkgewoJCQkJdHlwZSA9ICggdHlwZSB8fCAiZngiICkgKyAicXVldWUiOwoJCQkJcXVldWUgPSBqUXVlcnkuX2RhdGEoIGVsZW0sIHR5cGUgKTsKCgkJCQkvLyBTcGVlZCB1cCBkZXF1ZXVlIGJ5IGdldHRpbmcgb3V0IHF1aWNrbHkgaWYgdGhpcyBpcyBqdXN0IGEgbG9va3VwCgkJCQlpZiAoIGRhdGEgKSB7CgkJCQkJaWYgKCAhcXVldWUgfHwgalF1ZXJ5LmlzQXJyYXkoIGRhdGEgKSApIHsKCQkJCQkJcXVldWUgPSBqUXVlcnkuX2RhdGEoIGVsZW0sIHR5cGUsIGpRdWVyeS5tYWtlQXJyYXkoIGRhdGEgKSApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXF1ZXVlLnB1c2goIGRhdGEgKTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gcXVldWUgfHwgW107CgkJCX0KCQl9LAoKCQlkZXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJCXZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSggZWxlbSwgdHlwZSApLAoJCQkJc3RhcnRMZW5ndGggPSBxdWV1ZS5sZW5ndGgsCgkJCQlmbiA9IHF1ZXVlLnNoaWZ0KCksCgkJCQlob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyggZWxlbSwgdHlwZSApLAoJCQkJbmV4dCA9IGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCBlbGVtLCB0eXBlICk7CgkJCQl9OwoKCQkJLy8gSWYgdGhlIGZ4IHF1ZXVlIGlzIGRlcXVldWVkLCBhbHdheXMgcmVtb3ZlIHRoZSBwcm9ncmVzcyBzZW50aW5lbAoJCQlpZiAoIGZuID09PSAiaW5wcm9ncmVzcyIgKSB7CgkJCQlmbiA9IHF1ZXVlLnNoaWZ0KCk7CgkJCQlzdGFydExlbmd0aC0tOwoJCQl9CgoJCQlpZiAoIGZuICkgewoKCQkJCS8vIEFkZCBhIHByb2dyZXNzIHNlbnRpbmVsIHRvIHByZXZlbnQgdGhlIGZ4IHF1ZXVlIGZyb20gYmVpbmcKCQkJCS8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWQKCQkJCWlmICggdHlwZSA9PT0gImZ4IiApIHsKCQkJCQlxdWV1ZS51bnNoaWZ0KCAiaW5wcm9ncmVzcyIgKTsKCQkJCX0KCgkJCQkvLyBjbGVhciB1cCB0aGUgbGFzdCBxdWV1ZSBzdG9wIGZ1bmN0aW9uCgkJCQlkZWxldGUgaG9va3Muc3RvcDsKCQkJCWZuLmNhbGwoIGVsZW0sIG5leHQsIGhvb2tzICk7CgkJCX0KCgkJCWlmICggIXN0YXJ0TGVuZ3RoICYmIGhvb2tzICkgewoJCQkJaG9va3MuZW1wdHkuZmlyZSgpOwoJCQl9CgkJfSwKCgkJLy8gbm90IGludGVuZGVkIGZvciBwdWJsaWMgY29uc3VtcHRpb24gLSBnZW5lcmF0ZXMgYSBxdWV1ZUhvb2tzIG9iamVjdCwKCQkvLyBvciByZXR1cm5zIHRoZSBjdXJyZW50IG9uZQoJCV9xdWV1ZUhvb2tzOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQkJdmFyIGtleSA9IHR5cGUgKyAicXVldWVIb29rcyI7CgkJCXJldHVybiBqUXVlcnkuX2RhdGEoIGVsZW0sIGtleSApIHx8IGpRdWVyeS5fZGF0YSggZWxlbSwga2V5LCB7CgkJCQllbXB0eTogalF1ZXJ5LkNhbGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLmFkZCggZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBlbGVtLCB0eXBlICsgInF1ZXVlIiApOwoJCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZWxlbSwga2V5ICk7CgkJCQl9ICkKCQkJfSApOwoJCX0KCX0gKTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJcXVldWU6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgc2V0dGVyID0gMjsKCgkJCWlmICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJZGF0YSA9IHR5cGU7CgkJCQl0eXBlID0gImZ4IjsKCQkJCXNldHRlci0tOwoJCQl9CgoJCQlpZiAoIGFyZ3VtZW50cy5sZW5ndGggPCBzZXR0ZXIgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LnF1ZXVlKCB0aGlzWyAwIF0sIHR5cGUgKTsKCQkJfQoKCQkJcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/CgkJCQl0aGlzIDoKCQkJCXRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQkJdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBkYXRhICk7CgoJCQkJCS8vIGVuc3VyZSBhIGhvb2tzIGZvciB0aGlzIHF1ZXVlCgkJCQkJalF1ZXJ5Ll9xdWV1ZUhvb2tzKCB0aGlzLCB0eXBlICk7CgoJCQkJCWlmICggdHlwZSA9PT0gImZ4IiAmJiBxdWV1ZVsgMCBdICE9PSAiaW5wcm9ncmVzcyIgKSB7CgkJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQkJfQoJCQkJfSApOwoJCX0sCgkJZGVxdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmRlcXVldWUoIHRoaXMsIHR5cGUgKTsKCQkJfSApOwoJCX0sCgkJY2xlYXJRdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJfSwKCgkJLy8gR2V0IGEgcHJvbWlzZSByZXNvbHZlZCB3aGVuIHF1ZXVlcyBvZiBhIGNlcnRhaW4gdHlwZQoJCS8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KQoJCXByb21pc2U6IGZ1bmN0aW9uKCB0eXBlLCBvYmogKSB7CgkJCXZhciB0bXAsCgkJCQljb3VudCA9IDEsCgkJCQlkZWZlciA9IGpRdWVyeS5EZWZlcnJlZCgpLAoJCQkJZWxlbWVudHMgPSB0aGlzLAoJCQkJaSA9IHRoaXMubGVuZ3RoLAoJCQkJcmVzb2x2ZSA9IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggISggLS1jb3VudCApICkgewoJCQkJCQlkZWZlci5yZXNvbHZlV2l0aCggZWxlbWVudHMsIFsgZWxlbWVudHMgXSApOwoJCQkJCX0KCQkJCX07CgoJCQlpZiAoIHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIiApIHsKCQkJCW9iaiA9IHR5cGU7CgkJCQl0eXBlID0gdW5kZWZpbmVkOwoJCQl9CgkJCXR5cGUgPSB0eXBlIHx8ICJmeCI7CgoJCQl3aGlsZSAoIGktLSApIHsKCQkJCXRtcCA9IGpRdWVyeS5fZGF0YSggZWxlbWVudHNbIGkgXSwgdHlwZSArICJxdWV1ZUhvb2tzIiApOwoJCQkJaWYgKCB0bXAgJiYgdG1wLmVtcHR5ICkgewoJCQkJCWNvdW50Kys7CgkJCQkJdG1wLmVtcHR5LmFkZCggcmVzb2x2ZSApOwoJCQkJfQoJCQl9CgkJCXJlc29sdmUoKTsKCQkJcmV0dXJuIGRlZmVyLnByb21pc2UoIG9iaiApOwoJCX0KCX0gKTsKCgoJKCBmdW5jdGlvbigpIHsKCQl2YXIgc2hyaW5rV3JhcEJsb2Nrc1ZhbDsKCgkJc3VwcG9ydC5zaHJpbmtXcmFwQmxvY2tzID0gZnVuY3Rpb24oKSB7CgkJCWlmICggc2hyaW5rV3JhcEJsb2Nrc1ZhbCAhPSBudWxsICkgewoJCQkJcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7CgkJCX0KCgkJCS8vIFdpbGwgYmUgY2hhbmdlZCBsYXRlciBpZiBuZWVkZWQuCgkJCXNocmlua1dyYXBCbG9ja3NWYWwgPSBmYWxzZTsKCgkJCS8vIE1pbmlmaWVkOiB2YXIgYixjLGQKCQkJdmFyIGRpdiwgYm9keSwgY29udGFpbmVyOwoKCQkJYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYm9keSIgKVsgMCBdOwoJCQlpZiAoICFib2R5IHx8ICFib2R5LnN0eWxlICkgewoKCQkJCS8vIFRlc3QgZmlyZWQgdG9vIGVhcmx5IG9yIGluIGFuIHVuc3VwcG9ydGVkIGVudmlyb25tZW50LCBleGl0LgoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBTZXR1cAoJCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCQljb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCQljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweCI7CgkJCWJvZHkuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApLmFwcGVuZENoaWxkKCBkaXYgKTsKCgkJCS8vIFN1cHBvcnQ6IElFNgoJCQkvLyBDaGVjayBpZiBlbGVtZW50cyB3aXRoIGxheW91dCBzaHJpbmstd3JhcCB0aGVpciBjaGlsZHJlbgoJCQlpZiAoIHR5cGVvZiBkaXYuc3R5bGUuem9vbSAhPT0gInVuZGVmaW5lZCIgKSB7CgoJCQkJLy8gUmVzZXQgQ1NTOiBib3gtc2l6aW5nOyBkaXNwbGF5OyBtYXJnaW47IGJvcmRlcgoJCQkJZGl2LnN0eWxlLmNzc1RleHQgPQoKCQkJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCQkJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCQkJCSItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94OyIgKwoJCQkJCSJib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7IiArCgkJCQkJInBhZGRpbmc6MXB4O3dpZHRoOjFweDt6b29tOjEiOwoJCQkJZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICkuc3R5bGUud2lkdGggPSAiNXB4IjsKCQkJCXNocmlua1dyYXBCbG9ja3NWYWwgPSBkaXYub2Zmc2V0V2lkdGggIT09IDM7CgkJCX0KCgkJCWJvZHkucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7CgkJfTsKCgl9ICkoKTsKCXZhciBwbnVtID0gKCAvWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvICkuc291cmNlOwoKCXZhciByY3NzTnVtID0gbmV3IFJlZ0V4cCggIl4oPzooWystXSk9fCkoIiArIHBudW0gKyAiKShbYS16JV0qKSQiLCAiaSIgKTsKCgoJdmFyIGNzc0V4cGFuZCA9IFsgIlRvcCIsICJSaWdodCIsICJCb3R0b20iLCAiTGVmdCIgXTsKCgl2YXIgaXNIaWRkZW4gPSBmdW5jdGlvbiggZWxlbSwgZWwgKSB7CgoJCQkvLyBpc0hpZGRlbiBtaWdodCBiZSBjYWxsZWQgZnJvbSBqUXVlcnkjZmlsdGVyIGZ1bmN0aW9uOwoJCQkvLyBpbiB0aGF0IGNhc2UsIGVsZW1lbnQgd2lsbCBiZSBzZWNvbmQgYXJndW1lbnQKCQkJZWxlbSA9IGVsIHx8IGVsZW07CgkJCXJldHVybiBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSA9PT0gIm5vbmUiIHx8CgkJCQkhalF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCQl9OwoKCgoJZnVuY3Rpb24gYWRqdXN0Q1NTKCBlbGVtLCBwcm9wLCB2YWx1ZVBhcnRzLCB0d2VlbiApIHsKCQl2YXIgYWRqdXN0ZWQsCgkJCXNjYWxlID0gMSwKCQkJbWF4SXRlcmF0aW9ucyA9IDIwLAoJCQljdXJyZW50VmFsdWUgPSB0d2VlbiA/CgkJCQlmdW5jdGlvbigpIHsgcmV0dXJuIHR3ZWVuLmN1cigpOyB9IDoKCQkJCWZ1bmN0aW9uKCkgeyByZXR1cm4galF1ZXJ5LmNzcyggZWxlbSwgcHJvcCwgIiIgKTsgfSwKCQkJaW5pdGlhbCA9IGN1cnJlbnRWYWx1ZSgpLAoJCQl1bml0ID0gdmFsdWVQYXJ0cyAmJiB2YWx1ZVBhcnRzWyAzIF0gfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gPyAiIiA6ICJweCIgKSwKCgkJCS8vIFN0YXJ0aW5nIHZhbHVlIGNvbXB1dGF0aW9uIGlzIHJlcXVpcmVkIGZvciBwb3RlbnRpYWwgdW5pdCBtaXNtYXRjaGVzCgkJCWluaXRpYWxJblVuaXQgPSAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSB8fCB1bml0ICE9PSAicHgiICYmICtpbml0aWFsICkgJiYKCQkJCXJjc3NOdW0uZXhlYyggalF1ZXJ5LmNzcyggZWxlbSwgcHJvcCApICk7CgoJCWlmICggaW5pdGlhbEluVW5pdCAmJiBpbml0aWFsSW5Vbml0WyAzIF0gIT09IHVuaXQgKSB7CgoJCQkvLyBUcnVzdCB1bml0cyByZXBvcnRlZCBieSBqUXVlcnkuY3NzCgkJCXVuaXQgPSB1bml0IHx8IGluaXRpYWxJblVuaXRbIDMgXTsKCgkJCS8vIE1ha2Ugc3VyZSB3ZSB1cGRhdGUgdGhlIHR3ZWVuIHByb3BlcnRpZXMgbGF0ZXIgb24KCQkJdmFsdWVQYXJ0cyA9IHZhbHVlUGFydHMgfHwgW107CgoJCQkvLyBJdGVyYXRpdmVseSBhcHByb3hpbWF0ZSBmcm9tIGEgbm9uemVybyBzdGFydGluZyBwb2ludAoJCQlpbml0aWFsSW5Vbml0ID0gK2luaXRpYWwgfHwgMTsKCgkJCWRvIHsKCgkJCQkvLyBJZiBwcmV2aW91cyBpdGVyYXRpb24gemVyb2VkIG91dCwgZG91YmxlIHVudGlsIHdlIGdldCAqc29tZXRoaW5nKi4KCQkJCS8vIFVzZSBzdHJpbmcgZm9yIGRvdWJsaW5nIHNvIHdlIGRvbid0IGFjY2lkZW50YWxseSBzZWUgc2NhbGUgYXMgdW5jaGFuZ2VkIGJlbG93CgkJCQlzY2FsZSA9IHNjYWxlIHx8ICIuNSI7CgoJCQkJLy8gQWRqdXN0IGFuZCBhcHBseQoJCQkJaW5pdGlhbEluVW5pdCA9IGluaXRpYWxJblVuaXQgLyBzY2FsZTsKCQkJCWpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCwgaW5pdGlhbEluVW5pdCArIHVuaXQgKTsKCgkJCS8vIFVwZGF0ZSBzY2FsZSwgdG9sZXJhdGluZyB6ZXJvIG9yIE5hTiBmcm9tIHR3ZWVuLmN1cigpCgkJCS8vIEJyZWFrIHRoZSBsb29wIGlmIHNjYWxlIGlzIHVuY2hhbmdlZCBvciBwZXJmZWN0LCBvciBpZiB3ZSd2ZSBqdXN0IGhhZCBlbm91Z2guCgkJCX0gd2hpbGUgKAoJCQkJc2NhbGUgIT09ICggc2NhbGUgPSBjdXJyZW50VmFsdWUoKSAvIGluaXRpYWwgKSAmJiBzY2FsZSAhPT0gMSAmJiAtLW1heEl0ZXJhdGlvbnMKCQkJKTsKCQl9CgoJCWlmICggdmFsdWVQYXJ0cyApIHsKCQkJaW5pdGlhbEluVW5pdCA9ICtpbml0aWFsSW5Vbml0IHx8ICtpbml0aWFsIHx8IDA7CgoJCQkvLyBBcHBseSByZWxhdGl2ZSBvZmZzZXQgKCs9Ly09KSBpZiBzcGVjaWZpZWQKCQkJYWRqdXN0ZWQgPSB2YWx1ZVBhcnRzWyAxIF0gPwoJCQkJaW5pdGlhbEluVW5pdCArICggdmFsdWVQYXJ0c1sgMSBdICsgMSApICogdmFsdWVQYXJ0c1sgMiBdIDoKCQkJCSt2YWx1ZVBhcnRzWyAyIF07CgkJCWlmICggdHdlZW4gKSB7CgkJCQl0d2Vlbi51bml0ID0gdW5pdDsKCQkJCXR3ZWVuLnN0YXJ0ID0gaW5pdGlhbEluVW5pdDsKCQkJCXR3ZWVuLmVuZCA9IGFkanVzdGVkOwoJCQl9CgkJfQoJCXJldHVybiBhZGp1c3RlZDsKCX0KCgoJLy8gTXVsdGlmdW5jdGlvbmFsIG1ldGhvZCB0byBnZXQgYW5kIHNldCB2YWx1ZXMgb2YgYSBjb2xsZWN0aW9uCgkvLyBUaGUgdmFsdWUvcyBjYW4gb3B0aW9uYWxseSBiZSBleGVjdXRlZCBpZiBpdCdzIGEgZnVuY3Rpb24KCXZhciBhY2Nlc3MgPSBmdW5jdGlvbiggZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCByYXcgKSB7CgkJdmFyIGkgPSAwLAoJCQlsZW5ndGggPSBlbGVtcy5sZW5ndGgsCgkJCWJ1bGsgPSBrZXkgPT0gbnVsbDsKCgkJLy8gU2V0cyBtYW55IHZhbHVlcwoJCWlmICggalF1ZXJ5LnR5cGUoIGtleSApID09PSAib2JqZWN0IiApIHsKCQkJY2hhaW5hYmxlID0gdHJ1ZTsKCQkJZm9yICggaSBpbiBrZXkgKSB7CgkJCQlhY2Nlc3MoIGVsZW1zLCBmbiwgaSwga2V5WyBpIF0sIHRydWUsIGVtcHR5R2V0LCByYXcgKTsKCQkJfQoKCQkvLyBTZXRzIG9uZSB2YWx1ZQoJCX0gZWxzZSBpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJCWNoYWluYWJsZSA9IHRydWU7CgoJCQlpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJhdyA9IHRydWU7CgkJCX0KCgkJCWlmICggYnVsayApIHsKCgkJCQkvLyBCdWxrIG9wZXJhdGlvbnMgcnVuIGFnYWluc3QgdGhlIGVudGlyZSBzZXQKCQkJCWlmICggcmF3ICkgewoJCQkJCWZuLmNhbGwoIGVsZW1zLCB2YWx1ZSApOwoJCQkJCWZuID0gbnVsbDsKCgkJCQkvLyAuLi5leGNlcHQgd2hlbiBleGVjdXRpbmcgZnVuY3Rpb24gdmFsdWVzCgkJCQl9IGVsc2UgewoJCQkJCWJ1bGsgPSBmbjsKCQkJCQlmbiA9IGZ1bmN0aW9uKCBlbGVtLCBrZXksIHZhbHVlICkgewoJCQkJCQlyZXR1cm4gYnVsay5jYWxsKCBqUXVlcnkoIGVsZW0gKSwgdmFsdWUgKTsKCQkJCQl9OwoJCQkJfQoJCQl9CgoJCQlpZiAoIGZuICkgewoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJZm4oCgkJCQkJCWVsZW1zWyBpIF0sCgkJCQkJCWtleSwKCQkJCQkJcmF3ID8gdmFsdWUgOiB2YWx1ZS5jYWxsKCBlbGVtc1sgaSBdLCBpLCBmbiggZWxlbXNbIGkgXSwga2V5ICkgKQoJCQkJCSk7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBjaGFpbmFibGUgPwoJCQllbGVtcyA6CgoJCQkvLyBHZXRzCgkJCWJ1bGsgPwoJCQkJZm4uY2FsbCggZWxlbXMgKSA6CgkJCQlsZW5ndGggPyBmbiggZWxlbXNbIDAgXSwga2V5ICkgOiBlbXB0eUdldDsKCX07Cgl2YXIgcmNoZWNrYWJsZVR5cGUgPSAoIC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pICk7CgoJdmFyIHJ0YWdOYW1lID0gKCAvPChbXHc6LV0rKS8gKTsKCgl2YXIgcnNjcmlwdFR5cGUgPSAoIC9eJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSApOwoKCXZhciBybGVhZGluZ1doaXRlc3BhY2UgPSAoIC9eXHMrLyApOwoKCXZhciBub2RlTmFtZXMgPSAiYWJicnxhcnRpY2xlfGFzaWRlfGF1ZGlvfGJkaXxjYW52YXN8ZGF0YXxkYXRhbGlzdHwiICsKCQkJImRldGFpbHN8ZGlhbG9nfGZpZ2NhcHRpb258ZmlndXJlfGZvb3RlcnxoZWFkZXJ8aGdyb3VwfG1haW58IiArCgkJCSJtYXJrfG1ldGVyfG5hdnxvdXRwdXR8cGljdHVyZXxwcm9ncmVzc3xzZWN0aW9ufHN1bW1hcnl8dGVtcGxhdGV8dGltZXx2aWRlbyI7CgoKCglmdW5jdGlvbiBjcmVhdGVTYWZlRnJhZ21lbnQoIGRvY3VtZW50ICkgewoJCXZhciBsaXN0ID0gbm9kZU5hbWVzLnNwbGl0KCAifCIgKSwKCQkJc2FmZUZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CgoJCWlmICggc2FmZUZyYWcuY3JlYXRlRWxlbWVudCApIHsKCQkJd2hpbGUgKCBsaXN0Lmxlbmd0aCApIHsKCQkJCXNhZmVGcmFnLmNyZWF0ZUVsZW1lbnQoCgkJCQkJbGlzdC5wb3AoKQoJCQkJKTsKCQkJfQoJCX0KCQlyZXR1cm4gc2FmZUZyYWc7Cgl9CgoKCSggZnVuY3Rpb24oKSB7CgkJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICksCgkJCWZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLAoJCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKTsKCgkJLy8gU2V0dXAKCQlkaXYuaW5uZXJIVE1MID0gIiAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7CgoJCS8vIElFIHN0cmlwcyBsZWFkaW5nIHdoaXRlc3BhY2Ugd2hlbiAuaW5uZXJIVE1MIGlzIHVzZWQKCQlzdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlID0gZGl2LmZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDM7CgoJCS8vIE1ha2Ugc3VyZSB0aGF0IHRib2R5IGVsZW1lbnRzIGFyZW4ndCBhdXRvbWF0aWNhbGx5IGluc2VydGVkCgkJLy8gSUUgd2lsbCBpbnNlcnQgdGhlbSBpbnRvIGVtcHR5IHRhYmxlcwoJCXN1cHBvcnQudGJvZHkgPSAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAidGJvZHkiICkubGVuZ3RoOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCBsaW5rIGVsZW1lbnRzIGdldCBzZXJpYWxpemVkIGNvcnJlY3RseSBieSBpbm5lckhUTUwKCQkvLyBUaGlzIHJlcXVpcmVzIGEgd3JhcHBlciBlbGVtZW50IGluIElFCgkJc3VwcG9ydC5odG1sU2VyaWFsaXplID0gISFkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJsaW5rIiApLmxlbmd0aDsKCgkJLy8gTWFrZXMgc3VyZSBjbG9uaW5nIGFuIGh0bWw1IGVsZW1lbnQgZG9lcyBub3QgY2F1c2UgcHJvYmxlbXMKCQkvLyBXaGVyZSBvdXRlckhUTUwgaXMgdW5kZWZpbmVkLCB0aGlzIHN0aWxsIHdvcmtzCgkJc3VwcG9ydC5odG1sNUNsb25lID0KCQkJZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggIm5hdiIgKS5jbG9uZU5vZGUoIHRydWUgKS5vdXRlckhUTUwgIT09ICI8Om5hdj48LzpuYXY+IjsKCgkJLy8gQ2hlY2sgaWYgYSBkaXNjb25uZWN0ZWQgY2hlY2tib3ggd2lsbCByZXRhaW4gaXRzIGNoZWNrZWQKCQkvLyB2YWx1ZSBvZiB0cnVlIGFmdGVyIGFwcGVuZGVkIHRvIHRoZSBET00gKElFNi83KQoJCWlucHV0LnR5cGUgPSAiY2hlY2tib3giOwoJCWlucHV0LmNoZWNrZWQgPSB0cnVlOwoJCWZyYWdtZW50LmFwcGVuZENoaWxkKCBpbnB1dCApOwoJCXN1cHBvcnQuYXBwZW5kQ2hlY2tlZCA9IGlucHV0LmNoZWNrZWQ7CgoJCS8vIE1ha2Ugc3VyZSB0ZXh0YXJlYSAoYW5kIGNoZWNrYm94KSBkZWZhdWx0VmFsdWUgaXMgcHJvcGVybHkgY2xvbmVkCgkJLy8gU3VwcG9ydDogSUU2LUlFMTErCgkJZGl2LmlubmVySFRNTCA9ICI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+IjsKCQlzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkID0gISFkaXYuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZTsKCgkJLy8gIzExMjE3IC0gV2ViS2l0IGxvc2VzIGNoZWNrIHdoZW4gdGhlIG5hbWUgaXMgYWZ0ZXIgdGhlIGNoZWNrZWQgYXR0cmlidXRlCgkJZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQkvLyBTdXBwb3J0OiBXaW5kb3dzIFdlYiBBcHBzIChXV0EpCgkJLy8gYG5hbWVgIGFuZCBgdHlwZWAgbXVzdCB1c2UgLnNldEF0dHJpYnV0ZSBmb3IgV1dBICgjMTQ5MDEpCgkJaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiaW5wdXQiICk7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJyYWRpbyIgKTsKCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJjaGVja2VkIiwgImNoZWNrZWQiICk7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAibmFtZSIsICJ0IiApOwoKCQlkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7CgoJCS8vIFN1cHBvcnQ6IFNhZmFyaSA1LjEsIGlPUyA1LjEsIEFuZHJvaWQgNC54LCBBbmRyb2lkIDIuMwoJCS8vIG9sZCBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHMKCQlzdXBwb3J0LmNoZWNrQ2xvbmUgPSBkaXYuY2xvbmVOb2RlKCB0cnVlICkuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmNoZWNrZWQ7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQkvLyBDbG9uZWQgZWxlbWVudHMga2VlcCBhdHRhY2hFdmVudCBoYW5kbGVycywgd2UgdXNlIGFkZEV2ZW50TGlzdGVuZXIgb24gSUU5KwoJCXN1cHBvcnQubm9DbG9uZUV2ZW50ID0gISFkaXYuYWRkRXZlbnRMaXN0ZW5lcjsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCS8vIFNpbmNlIGF0dHJpYnV0ZXMgYW5kIHByb3BlcnRpZXMgYXJlIHRoZSBzYW1lIGluIElFLAoJCS8vIGNsZWFuRGF0YSBtdXN0IHNldCBwcm9wZXJ0aWVzIHRvIHVuZGVmaW5lZCByYXRoZXIgdGhhbiB1c2UgcmVtb3ZlQXR0cmlidXRlCgkJZGl2WyBqUXVlcnkuZXhwYW5kbyBdID0gMTsKCQlzdXBwb3J0LmF0dHJpYnV0ZXMgPSAhZGl2LmdldEF0dHJpYnV0ZSggalF1ZXJ5LmV4cGFuZG8gKTsKCX0gKSgpOwoKCgkvLyBXZSBoYXZlIHRvIGNsb3NlIHRoZXNlIHRhZ3MgdG8gc3VwcG9ydCBYSFRNTCAoIzEzMjAwKQoJdmFyIHdyYXBNYXAgPSB7CgkJb3B0aW9uOiBbIDEsICI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+IiwgIjwvc2VsZWN0PiIgXSwKCQlsZWdlbmQ6IFsgMSwgIjxmaWVsZHNldD4iLCAiPC9maWVsZHNldD4iIF0sCgkJYXJlYTogWyAxLCAiPG1hcD4iLCAiPC9tYXA+IiBdLAoKCQkvLyBTdXBwb3J0OiBJRTgKCQlwYXJhbTogWyAxLCAiPG9iamVjdD4iLCAiPC9vYmplY3Q+IiBdLAoJCXRoZWFkOiBbIDEsICI8dGFibGU+IiwgIjwvdGFibGU+IiBdLAoJCXRyOiBbIDIsICI8dGFibGU+PHRib2R5PiIsICI8L3Rib2R5PjwvdGFibGU+IiBdLAoJCWNvbDogWyAyLCAiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCAiPC9jb2xncm91cD48L3RhYmxlPiIgXSwKCQl0ZDogWyAzLCAiPHRhYmxlPjx0Ym9keT48dHI+IiwgIjwvdHI+PC90Ym9keT48L3RhYmxlPiIgXSwKCgkJLy8gSUU2LTggY2FuJ3Qgc2VyaWFsaXplIGxpbmssIHNjcmlwdCwgc3R5bGUsIG9yIGFueSBodG1sNSAoTm9TY29wZSkgdGFncywKCQkvLyB1bmxlc3Mgd3JhcHBlZCBpbiBhIGRpdiB3aXRoIG5vbi1icmVha2luZyBjaGFyYWN0ZXJzIGluIGZyb250IG9mIGl0LgoJCV9kZWZhdWx0OiBzdXBwb3J0Lmh0bWxTZXJpYWxpemUgPyBbIDAsICIiLCAiIiBdIDogWyAxLCAiWDxkaXY+IiwgIjwvZGl2PiIgXQoJfTsKCgkvLyBTdXBwb3J0OiBJRTgtSUU5Cgl3cmFwTWFwLm9wdGdyb3VwID0gd3JhcE1hcC5vcHRpb247CgoJd3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDsKCXdyYXBNYXAudGggPSB3cmFwTWFwLnRkOwoKCglmdW5jdGlvbiBnZXRBbGwoIGNvbnRleHQsIHRhZyApIHsKCQl2YXIgZWxlbXMsIGVsZW0sCgkJCWkgPSAwLAoJCQlmb3VuZCA9IHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIiA/CgkJCQljb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgfHwgIioiICkgOgoJCQkJdHlwZW9mIGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCAhPT0gInVuZGVmaW5lZCIgPwoJCQkJCWNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnIHx8ICIqIiApIDoKCQkJCQl1bmRlZmluZWQ7CgoJCWlmICggIWZvdW5kICkgewoJCQlmb3IgKCBmb3VuZCA9IFtdLCBlbGVtcyA9IGNvbnRleHQuY2hpbGROb2RlcyB8fCBjb250ZXh0OwoJCQkJKCBlbGVtID0gZWxlbXNbIGkgXSApICE9IG51bGw7CgkJCQlpKysKCQkJKSB7CgkJCQlpZiAoICF0YWcgfHwgalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCB0YWcgKSApIHsKCQkJCQlmb3VuZC5wdXNoKCBlbGVtICk7CgkJCQl9IGVsc2UgewoJCQkJCWpRdWVyeS5tZXJnZSggZm91bmQsIGdldEFsbCggZWxlbSwgdGFnICkgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHRhZyA9PT0gdW5kZWZpbmVkIHx8IHRhZyAmJiBqUXVlcnkubm9kZU5hbWUoIGNvbnRleHQsIHRhZyApID8KCQkJalF1ZXJ5Lm1lcmdlKCBbIGNvbnRleHQgXSwgZm91bmQgKSA6CgkJCWZvdW5kOwoJfQoKCgkvLyBNYXJrIHNjcmlwdHMgYXMgaGF2aW5nIGFscmVhZHkgYmVlbiBldmFsdWF0ZWQKCWZ1bmN0aW9uIHNldEdsb2JhbEV2YWwoIGVsZW1zLCByZWZFbGVtZW50cyApIHsKCQl2YXIgZWxlbSwKCQkJaSA9IDA7CgkJZm9yICggOyAoIGVsZW0gPSBlbGVtc1sgaSBdICkgIT0gbnVsbDsgaSsrICkgewoJCQlqUXVlcnkuX2RhdGEoCgkJCQllbGVtLAoJCQkJImdsb2JhbEV2YWwiLAoJCQkJIXJlZkVsZW1lbnRzIHx8IGpRdWVyeS5fZGF0YSggcmVmRWxlbWVudHNbIGkgXSwgImdsb2JhbEV2YWwiICkKCQkJKTsKCQl9Cgl9CgoKCXZhciByaHRtbCA9IC88fCYjP1x3KzsvLAoJCXJ0Ym9keSA9IC88dGJvZHkvaTsKCglmdW5jdGlvbiBmaXhEZWZhdWx0Q2hlY2tlZCggZWxlbSApIHsKCQlpZiAoIHJjaGVja2FibGVUeXBlLnRlc3QoIGVsZW0udHlwZSApICkgewoJCQllbGVtLmRlZmF1bHRDaGVja2VkID0gZWxlbS5jaGVja2VkOwoJCX0KCX0KCglmdW5jdGlvbiBidWlsZEZyYWdtZW50KCBlbGVtcywgY29udGV4dCwgc2NyaXB0cywgc2VsZWN0aW9uLCBpZ25vcmVkICkgewoJCXZhciBqLCBlbGVtLCBjb250YWlucywKCQkJdG1wLCB0YWcsIHRib2R5LCB3cmFwLAoJCQlsID0gZWxlbXMubGVuZ3RoLAoKCQkJLy8gRW5zdXJlIGEgc2FmZSBmcmFnbWVudAoJCQlzYWZlID0gY3JlYXRlU2FmZUZyYWdtZW50KCBjb250ZXh0ICksCgoJCQlub2RlcyA9IFtdLAoJCQlpID0gMDsKCgkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQllbGVtID0gZWxlbXNbIGkgXTsKCgkJCWlmICggZWxlbSB8fCBlbGVtID09PSAwICkgewoKCQkJCS8vIEFkZCBub2RlcyBkaXJlY3RseQoJCQkJaWYgKCBqUXVlcnkudHlwZSggZWxlbSApID09PSAib2JqZWN0IiApIHsKCQkJCQlqUXVlcnkubWVyZ2UoIG5vZGVzLCBlbGVtLm5vZGVUeXBlID8gWyBlbGVtIF0gOiBlbGVtICk7CgoJCQkJLy8gQ29udmVydCBub24taHRtbCBpbnRvIGEgdGV4dCBub2RlCgkJCQl9IGVsc2UgaWYgKCAhcmh0bWwudGVzdCggZWxlbSApICkgewoJCQkJCW5vZGVzLnB1c2goIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIGVsZW0gKSApOwoKCQkJCS8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2RlcwoJCQkJfSBlbHNlIHsKCQkJCQl0bXAgPSB0bXAgfHwgc2FmZS5hcHBlbmRDaGlsZCggY29udGV4dC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICk7CgoJCQkJCS8vIERlc2VyaWFsaXplIGEgc3RhbmRhcmQgcmVwcmVzZW50YXRpb24KCQkJCQl0YWcgPSAoIHJ0YWdOYW1lLmV4ZWMoIGVsZW0gKSB8fCBbICIiLCAiIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpOwoJCQkJCXdyYXAgPSB3cmFwTWFwWyB0YWcgXSB8fCB3cmFwTWFwLl9kZWZhdWx0OwoKCQkJCQl0bXAuaW5uZXJIVE1MID0gd3JhcFsgMSBdICsgalF1ZXJ5Lmh0bWxQcmVmaWx0ZXIoIGVsZW0gKSArIHdyYXBbIDIgXTsKCgkJCQkJLy8gRGVzY2VuZCB0aHJvdWdoIHdyYXBwZXJzIHRvIHRoZSByaWdodCBjb250ZW50CgkJCQkJaiA9IHdyYXBbIDAgXTsKCQkJCQl3aGlsZSAoIGotLSApIHsKCQkJCQkJdG1wID0gdG1wLmxhc3RDaGlsZDsKCQkJCQl9CgoJCQkJCS8vIE1hbnVhbGx5IGFkZCBsZWFkaW5nIHdoaXRlc3BhY2UgcmVtb3ZlZCBieSBJRQoJCQkJCWlmICggIXN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UgJiYgcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoIGVsZW0gKSApIHsKCQkJCQkJbm9kZXMucHVzaCggY29udGV4dC5jcmVhdGVUZXh0Tm9kZSggcmxlYWRpbmdXaGl0ZXNwYWNlLmV4ZWMoIGVsZW0gKVsgMCBdICkgKTsKCQkJCQl9CgoJCQkJCS8vIFJlbW92ZSBJRSdzIGF1dG9pbnNlcnRlZCA8dGJvZHk+IGZyb20gdGFibGUgZnJhZ21lbnRzCgkJCQkJaWYgKCAhc3VwcG9ydC50Ym9keSApIHsKCgkJCQkJCS8vIFN0cmluZyB3YXMgYSA8dGFibGU+LCAqbWF5KiBoYXZlIHNwdXJpb3VzIDx0Ym9keT4KCQkJCQkJZWxlbSA9IHRhZyA9PT0gInRhYmxlIiAmJiAhcnRib2R5LnRlc3QoIGVsZW0gKSA/CgkJCQkJCQl0bXAuZmlyc3RDaGlsZCA6CgoJCQkJCQkJLy8gU3RyaW5nIHdhcyBhIGJhcmUgPHRoZWFkPiBvciA8dGZvb3Q+CgkJCQkJCQl3cmFwWyAxIF0gPT09ICI8dGFibGU+IiAmJiAhcnRib2R5LnRlc3QoIGVsZW0gKSA/CgkJCQkJCQkJdG1wIDoKCQkJCQkJCQkwOwoKCQkJCQkJaiA9IGVsZW0gJiYgZWxlbS5jaGlsZE5vZGVzLmxlbmd0aDsKCQkJCQkJd2hpbGUgKCBqLS0gKSB7CgkJCQkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggKCB0Ym9keSA9IGVsZW0uY2hpbGROb2Rlc1sgaiBdICksICJ0Ym9keSIgKSAmJgoJCQkJCQkJCSF0Ym9keS5jaGlsZE5vZGVzLmxlbmd0aCApIHsKCgkJCQkJCQkJZWxlbS5yZW1vdmVDaGlsZCggdGJvZHkgKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCgkJCQkJalF1ZXJ5Lm1lcmdlKCBub2RlcywgdG1wLmNoaWxkTm9kZXMgKTsKCgkJCQkJLy8gRml4ICMxMjM5MiBmb3IgV2ViS2l0IGFuZCBJRSA+IDkKCQkJCQl0bXAudGV4dENvbnRlbnQgPSAiIjsKCgkJCQkJLy8gRml4ICMxMjM5MiBmb3Igb2xkSUUKCQkJCQl3aGlsZSAoIHRtcC5maXJzdENoaWxkICkgewoJCQkJCQl0bXAucmVtb3ZlQ2hpbGQoIHRtcC5maXJzdENoaWxkICk7CgkJCQkJfQoKCQkJCQkvLyBSZW1lbWJlciB0aGUgdG9wLWxldmVsIGNvbnRhaW5lciBmb3IgcHJvcGVyIGNsZWFudXAKCQkJCQl0bXAgPSBzYWZlLmxhc3RDaGlsZDsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gRml4ICMxMTM1NjogQ2xlYXIgZWxlbWVudHMgZnJvbSBmcmFnbWVudAoJCWlmICggdG1wICkgewoJCQlzYWZlLnJlbW92ZUNoaWxkKCB0bXAgKTsKCQl9CgoJCS8vIFJlc2V0IGRlZmF1bHRDaGVja2VkIGZvciBhbnkgcmFkaW9zIGFuZCBjaGVja2JveGVzCgkJLy8gYWJvdXQgdG8gYmUgYXBwZW5kZWQgdG8gdGhlIERPTSBpbiBJRSA2LzcgKCM4MDYwKQoJCWlmICggIXN1cHBvcnQuYXBwZW5kQ2hlY2tlZCApIHsKCQkJalF1ZXJ5LmdyZXAoIGdldEFsbCggbm9kZXMsICJpbnB1dCIgKSwgZml4RGVmYXVsdENoZWNrZWQgKTsKCQl9CgoJCWkgPSAwOwoJCXdoaWxlICggKCBlbGVtID0gbm9kZXNbIGkrKyBdICkgKSB7CgoJCQkvLyBTa2lwIGVsZW1lbnRzIGFscmVhZHkgaW4gdGhlIGNvbnRleHQgY29sbGVjdGlvbiAodHJhYy00MDg3KQoJCQlpZiAoIHNlbGVjdGlvbiAmJiBqUXVlcnkuaW5BcnJheSggZWxlbSwgc2VsZWN0aW9uICkgPiAtMSApIHsKCQkJCWlmICggaWdub3JlZCApIHsKCQkJCQlpZ25vcmVkLnB1c2goIGVsZW0gKTsKCQkJCX0KCgkJCQljb250aW51ZTsKCQkJfQoKCQkJY29udGFpbnMgPSBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApOwoKCQkJLy8gQXBwZW5kIHRvIGZyYWdtZW50CgkJCXRtcCA9IGdldEFsbCggc2FmZS5hcHBlbmRDaGlsZCggZWxlbSApLCAic2NyaXB0IiApOwoKCQkJLy8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeQoJCQlpZiAoIGNvbnRhaW5zICkgewoJCQkJc2V0R2xvYmFsRXZhbCggdG1wICk7CgkJCX0KCgkJCS8vIENhcHR1cmUgZXhlY3V0YWJsZXMKCQkJaWYgKCBzY3JpcHRzICkgewoJCQkJaiA9IDA7CgkJCQl3aGlsZSAoICggZWxlbSA9IHRtcFsgaisrIF0gKSApIHsKCQkJCQlpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIGVsZW0udHlwZSB8fCAiIiApICkgewoJCQkJCQlzY3JpcHRzLnB1c2goIGVsZW0gKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXRtcCA9IG51bGw7CgoJCXJldHVybiBzYWZlOwoJfQoKCgkoIGZ1bmN0aW9uKCkgewoJCXZhciBpLCBldmVudE5hbWUsCgkJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgoJCS8vIFN1cHBvcnQ6IElFPDkgKGxhY2sgc3VibWl0L2NoYW5nZSBidWJibGUpLCBGaXJlZm94IChsYWNrIGZvY3VzKGluIHwgb3V0KSBldmVudHMpCgkJZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgY2hhbmdlOiB0cnVlLCBmb2N1c2luOiB0cnVlIH0gKSB7CgkJCWV2ZW50TmFtZSA9ICJvbiIgKyBpOwoKCQkJaWYgKCAhKCBzdXBwb3J0WyBpIF0gPSBldmVudE5hbWUgaW4gd2luZG93ICkgKSB7CgoJCQkJLy8gQmV3YXJlIG9mIENTUCByZXN0cmljdGlvbnMgKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL1NlY3VyaXR5L0NTUCkKCQkJCWRpdi5zZXRBdHRyaWJ1dGUoIGV2ZW50TmFtZSwgInQiICk7CgkJCQlzdXBwb3J0WyBpIF0gPSBkaXYuYXR0cmlidXRlc1sgZXZlbnROYW1lIF0uZXhwYW5kbyA9PT0gZmFsc2U7CgkJCX0KCQl9CgoJCS8vIE51bGwgZWxlbWVudHMgdG8gYXZvaWQgbGVha3MgaW4gSUUuCgkJZGl2ID0gbnVsbDsKCX0gKSgpOwoKCgl2YXIgcmZvcm1FbGVtcyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhKSQvaSwKCQlya2V5RXZlbnQgPSAvXmtleS8sCgkJcm1vdXNlRXZlbnQgPSAvXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnV8ZHJhZ3xkcm9wKXxjbGljay8sCgkJcmZvY3VzTW9ycGggPSAvXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sCgkJcnR5cGVuYW1lc3BhY2UgPSAvXihbXi5dKikoPzpcLiguKyl8KS87CgoJZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpIHsKCQlyZXR1cm4gdHJ1ZTsKCX0KCglmdW5jdGlvbiByZXR1cm5GYWxzZSgpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9CgoJLy8gU3VwcG9ydDogSUU5CgkvLyBTZWUgIzEzMzkzIGZvciBtb3JlIGluZm8KCWZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkgewoJCXRyeSB7CgkJCXJldHVybiBkb2N1bWVudC5hY3RpdmVFbGVtZW50OwoJCX0gY2F0Y2ggKCBlcnIgKSB7IH0KCX0KCglmdW5jdGlvbiBvbiggZWxlbSwgdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgb25lICkgewoJCXZhciBvcmlnRm4sIHR5cGU7CgoJCS8vIFR5cGVzIGNhbiBiZSBhIG1hcCBvZiB0eXBlcy9oYW5kbGVycwoJCWlmICggdHlwZW9mIHR5cGVzID09PSAib2JqZWN0IiApIHsKCgkJCS8vICggdHlwZXMtT2JqZWN0LCBzZWxlY3RvciwgZGF0YSApCgkJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiApIHsKCgkJCQkvLyAoIHR5cGVzLU9iamVjdCwgZGF0YSApCgkJCQlkYXRhID0gZGF0YSB8fCBzZWxlY3RvcjsKCQkJCXNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCQl9CgkJCWZvciAoIHR5cGUgaW4gdHlwZXMgKSB7CgkJCQlvbiggZWxlbSwgdHlwZSwgc2VsZWN0b3IsIGRhdGEsIHR5cGVzWyB0eXBlIF0sIG9uZSApOwoJCQl9CgkJCXJldHVybiBlbGVtOwoJCX0KCgkJaWYgKCBkYXRhID09IG51bGwgJiYgZm4gPT0gbnVsbCApIHsKCgkJCS8vICggdHlwZXMsIGZuICkKCQkJZm4gPSBzZWxlY3RvcjsKCQkJZGF0YSA9IHNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCX0gZWxzZSBpZiAoIGZuID09IG51bGwgKSB7CgkJCWlmICggdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiApIHsKCgkJCQkvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKQoJCQkJZm4gPSBkYXRhOwoJCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQkJfSBlbHNlIHsKCgkJCQkvLyAoIHR5cGVzLCBkYXRhLCBmbiApCgkJCQlmbiA9IGRhdGE7CgkJCQlkYXRhID0gc2VsZWN0b3I7CgkJCQlzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJfQoJCX0KCQlpZiAoIGZuID09PSBmYWxzZSApIHsKCQkJZm4gPSByZXR1cm5GYWxzZTsKCQl9IGVsc2UgaWYgKCAhZm4gKSB7CgkJCXJldHVybiBlbGVtOwoJCX0KCgkJaWYgKCBvbmUgPT09IDEgKSB7CgkJCW9yaWdGbiA9IGZuOwoJCQlmbiA9IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCQkvLyBDYW4gdXNlIGFuIGVtcHR5IHNldCwgc2luY2UgZXZlbnQgY29udGFpbnMgdGhlIGluZm8KCQkJCWpRdWVyeSgpLm9mZiggZXZlbnQgKTsKCQkJCXJldHVybiBvcmlnRm4uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQl9OwoKCQkJLy8gVXNlIHNhbWUgZ3VpZCBzbyBjYWxsZXIgY2FuIHJlbW92ZSB1c2luZyBvcmlnRm4KCQkJZm4uZ3VpZCA9IG9yaWdGbi5ndWlkIHx8ICggb3JpZ0ZuLmd1aWQgPSBqUXVlcnkuZ3VpZCsrICk7CgkJfQoJCXJldHVybiBlbGVtLmVhY2goIGZ1bmN0aW9uKCkgewoJCQlqUXVlcnkuZXZlbnQuYWRkKCB0aGlzLCB0eXBlcywgZm4sIGRhdGEsIHNlbGVjdG9yICk7CgkJfSApOwoJfQoKCS8qCgkgKiBIZWxwZXIgZnVuY3Rpb25zIGZvciBtYW5hZ2luZyBldmVudHMgLS0gbm90IHBhcnQgb2YgdGhlIHB1YmxpYyBpbnRlcmZhY2UuCgkgKiBQcm9wcyB0byBEZWFuIEVkd2FyZHMnIGFkZEV2ZW50IGxpYnJhcnkgZm9yIG1hbnkgb2YgdGhlIGlkZWFzLgoJICovCglqUXVlcnkuZXZlbnQgPSB7CgoJCWdsb2JhbDoge30sCgoJCWFkZDogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBkYXRhLCBzZWxlY3RvciApIHsKCQkJdmFyIHRtcCwgZXZlbnRzLCB0LCBoYW5kbGVPYmpJbiwKCQkJCXNwZWNpYWwsIGV2ZW50SGFuZGxlLCBoYW5kbGVPYmosCgkJCQloYW5kbGVycywgdHlwZSwgbmFtZXNwYWNlcywgb3JpZ1R5cGUsCgkJCQllbGVtRGF0YSA9IGpRdWVyeS5fZGF0YSggZWxlbSApOwoKCQkJLy8gRG9uJ3QgYXR0YWNoIGV2ZW50cyB0byBub0RhdGEgb3IgdGV4dC9jb21tZW50IG5vZGVzIChidXQgYWxsb3cgcGxhaW4gb2JqZWN0cykKCQkJaWYgKCAhZWxlbURhdGEgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFuZGxlcgoJCQlpZiAoIGhhbmRsZXIuaGFuZGxlciApIHsKCQkJCWhhbmRsZU9iakluID0gaGFuZGxlcjsKCQkJCWhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyOwoJCQkJc2VsZWN0b3IgPSBoYW5kbGVPYmpJbi5zZWxlY3RvcjsKCQkJfQoKCQkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIGhhbmRsZXIgaGFzIGEgdW5pcXVlIElELCB1c2VkIHRvIGZpbmQvcmVtb3ZlIGl0IGxhdGVyCgkJCWlmICggIWhhbmRsZXIuZ3VpZCApIHsKCQkJCWhhbmRsZXIuZ3VpZCA9IGpRdWVyeS5ndWlkKys7CgkJCX0KCgkJCS8vIEluaXQgdGhlIGVsZW1lbnQncyBldmVudCBzdHJ1Y3R1cmUgYW5kIG1haW4gaGFuZGxlciwgaWYgdGhpcyBpcyB0aGUgZmlyc3QKCQkJaWYgKCAhKCBldmVudHMgPSBlbGVtRGF0YS5ldmVudHMgKSApIHsKCQkJCWV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cyA9IHt9OwoJCQl9CgkJCWlmICggISggZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUgKSApIHsKCQkJCWV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlID0gZnVuY3Rpb24oIGUgKSB7CgoJCQkJCS8vIERpc2NhcmQgdGhlIHNlY29uZCBldmVudCBvZiBhIGpRdWVyeS5ldmVudC50cmlnZ2VyKCkgYW5kCgkJCQkJLy8gd2hlbiBhbiBldmVudCBpcyBjYWxsZWQgYWZ0ZXIgYSBwYWdlIGhhcyB1bmxvYWRlZAoJCQkJCXJldHVybiB0eXBlb2YgalF1ZXJ5ICE9PSAidW5kZWZpbmVkIiAmJgoJCQkJCQkoICFlIHx8IGpRdWVyeS5ldmVudC50cmlnZ2VyZWQgIT09IGUudHlwZSApID8KCQkJCQkJalF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmFwcGx5KCBldmVudEhhbmRsZS5lbGVtLCBhcmd1bWVudHMgKSA6CgkJCQkJCXVuZGVmaW5lZDsKCQkJCX07CgoJCQkJLy8gQWRkIGVsZW0gYXMgYSBwcm9wZXJ0eSBvZiB0aGUgaGFuZGxlIGZuIHRvIHByZXZlbnQgYSBtZW1vcnkgbGVhawoJCQkJLy8gd2l0aCBJRSBub24tbmF0aXZlIGV2ZW50cwoJCQkJZXZlbnRIYW5kbGUuZWxlbSA9IGVsZW07CgkJCX0KCgkJCS8vIEhhbmRsZSBtdWx0aXBsZSBldmVudHMgc2VwYXJhdGVkIGJ5IGEgc3BhY2UKCQkJdHlwZXMgPSAoIHR5cGVzIHx8ICIiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgIiIgXTsKCQkJdCA9IHR5cGVzLmxlbmd0aDsKCQkJd2hpbGUgKCB0LS0gKSB7CgkJCQl0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKCB0eXBlc1sgdCBdICkgfHwgW107CgkJCQl0eXBlID0gb3JpZ1R5cGUgPSB0bXBbIDEgXTsKCQkJCW5hbWVzcGFjZXMgPSAoIHRtcFsgMiBdIHx8ICIiICkuc3BsaXQoICIuIiApLnNvcnQoKTsKCgkJCQkvLyBUaGVyZSAqbXVzdCogYmUgYSB0eXBlLCBubyBhdHRhY2hpbmcgbmFtZXNwYWNlLW9ubHkgaGFuZGxlcnMKCQkJCWlmICggIXR5cGUgKSB7CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJLy8gSWYgZXZlbnQgY2hhbmdlcyBpdHMgdHlwZSwgdXNlIHRoZSBzcGVjaWFsIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgY2hhbmdlZCB0eXBlCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTsKCgkJCQkvLyBJZiBzZWxlY3RvciBkZWZpbmVkLCBkZXRlcm1pbmUgc3BlY2lhbCBldmVudCBhcGkgdHlwZSwgb3RoZXJ3aXNlIA==", "base64"));
  res.write(new Buffer("Z2l2ZW4gdHlwZQoJCQkJdHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlOwoKCQkJCS8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGUKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9OwoKCQkJCS8vIGhhbmRsZU9iaiBpcyBwYXNzZWQgdG8gYWxsIGV2ZW50IGhhbmRsZXJzCgkJCQloYW5kbGVPYmogPSBqUXVlcnkuZXh0ZW5kKCB7CgkJCQkJdHlwZTogdHlwZSwKCQkJCQlvcmlnVHlwZTogb3JpZ1R5cGUsCgkJCQkJZGF0YTogZGF0YSwKCQkJCQloYW5kbGVyOiBoYW5kbGVyLAoJCQkJCWd1aWQ6IGhhbmRsZXIuZ3VpZCwKCQkJCQlzZWxlY3Rvcjogc2VsZWN0b3IsCgkJCQkJbmVlZHNDb250ZXh0OiBzZWxlY3RvciAmJiBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3IgKSwKCQkJCQluYW1lc3BhY2U6IG5hbWVzcGFjZXMuam9pbiggIi4iICkKCQkJCX0sIGhhbmRsZU9iakluICk7CgoJCQkJLy8gSW5pdCB0aGUgZXZlbnQgaGFuZGxlciBxdWV1ZSBpZiB3ZSdyZSB0aGUgZmlyc3QKCQkJCWlmICggISggaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSApICkgewoJCQkJCWhhbmRsZXJzID0gZXZlbnRzWyB0eXBlIF0gPSBbXTsKCQkJCQloYW5kbGVycy5kZWxlZ2F0ZUNvdW50ID0gMDsKCgkJCQkJLy8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lci9hdHRhY2hFdmVudCBpZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlCgkJCQkJaWYgKCAhc3BlY2lhbC5zZXR1cCB8fAoJCQkJCQlzcGVjaWFsLnNldHVwLmNhbGwoIGVsZW0sIGRhdGEsIG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlICkgPT09IGZhbHNlICkgewoKCQkJCQkJLy8gQmluZCB0aGUgZ2xvYmFsIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGVsZW1lbnQKCQkJCQkJaWYgKCBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQkJCQllbGVtLmFkZEV2ZW50TGlzdGVuZXIoIHR5cGUsIGV2ZW50SGFuZGxlLCBmYWxzZSApOwoKCQkJCQkJfSBlbHNlIGlmICggZWxlbS5hdHRhY2hFdmVudCApIHsKCQkJCQkJCWVsZW0uYXR0YWNoRXZlbnQoICJvbiIgKyB0eXBlLCBldmVudEhhbmRsZSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCWlmICggc3BlY2lhbC5hZGQgKSB7CgkJCQkJc3BlY2lhbC5hZGQuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgoJCQkJCWlmICggIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgKSB7CgkJCQkJCWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgPSBoYW5kbGVyLmd1aWQ7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250CgkJCQlpZiAoIHNlbGVjdG9yICkgewoJCQkJCWhhbmRsZXJzLnNwbGljZSggaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLCAwLCBoYW5kbGVPYmogKTsKCQkJCX0gZWxzZSB7CgkJCQkJaGFuZGxlcnMucHVzaCggaGFuZGxlT2JqICk7CgkJCQl9CgoJCQkJLy8gS2VlcCB0cmFjayBvZiB3aGljaCBldmVudHMgaGF2ZSBldmVyIGJlZW4gdXNlZCwgZm9yIGV2ZW50IG9wdGltaXphdGlvbgoJCQkJalF1ZXJ5LmV2ZW50Lmdsb2JhbFsgdHlwZSBdID0gdHJ1ZTsKCQkJfQoKCQkJLy8gTnVsbGlmeSBlbGVtIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzIGluIElFCgkJCWVsZW0gPSBudWxsOwoJCX0sCgoJCS8vIERldGFjaCBhbiBldmVudCBvciBzZXQgb2YgZXZlbnRzIGZyb20gYW4gZWxlbWVudAoJCXJlbW92ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBzZWxlY3RvciwgbWFwcGVkVHlwZXMgKSB7CgkJCXZhciBqLCBoYW5kbGVPYmosIHRtcCwKCQkJCW9yaWdDb3VudCwgdCwgZXZlbnRzLAoJCQkJc3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsCgkJCQluYW1lc3BhY2VzLCBvcmlnVHlwZSwKCQkJCWVsZW1EYXRhID0galF1ZXJ5Lmhhc0RhdGEoIGVsZW0gKSAmJiBqUXVlcnkuX2RhdGEoIGVsZW0gKTsKCgkJCWlmICggIWVsZW1EYXRhIHx8ICEoIGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cyApICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBPbmNlIGZvciBlYWNoIHR5cGUubmFtZXNwYWNlIGluIHR5cGVzOyB0eXBlIG1heSBiZSBvbWl0dGVkCgkJCXR5cGVzID0gKCB0eXBlcyB8fCAiIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbICIiIF07CgkJCXQgPSB0eXBlcy5sZW5ndGg7CgkJCXdoaWxlICggdC0tICkgewoJCQkJdG1wID0gcnR5cGVuYW1lc3BhY2UuZXhlYyggdHlwZXNbIHQgXSApIHx8IFtdOwoJCQkJdHlwZSA9IG9yaWdUeXBlID0gdG1wWyAxIF07CgkJCQluYW1lc3BhY2VzID0gKCB0bXBbIDIgXSB8fCAiIiApLnNwbGl0KCAiLiIgKS5zb3J0KCk7CgoJCQkJLy8gVW5iaW5kIGFsbCBldmVudHMgKG9uIHRoaXMgbmFtZXNwYWNlLCBpZiBwcm92aWRlZCkgZm9yIHRoZSBlbGVtZW50CgkJCQlpZiAoICF0eXBlICkgewoJCQkJCWZvciAoIHR5cGUgaW4gZXZlbnRzICkgewoJCQkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICsgdHlwZXNbIHQgXSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUgKTsKCQkJCQl9CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCQl0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7CgkJCQloYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdIHx8IFtdOwoJCQkJdG1wID0gdG1wWyAyIF0gJiYKCQkJCQluZXcgUmVnRXhwKCAiKF58XFwuKSIgKyBuYW1lc3BhY2VzLmpvaW4oICJcXC4oPzouKlxcLnwpIiApICsgIihcXC58JCkiICk7CgoJCQkJLy8gUmVtb3ZlIG1hdGNoaW5nIGV2ZW50cwoJCQkJb3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDsKCQkJCXdoaWxlICggai0tICkgewoJCQkJCWhhbmRsZU9iaiA9IGhhbmRsZXJzWyBqIF07CgoJCQkJCWlmICggKCBtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlICkgJiYKCQkJCQkJKCAhaGFuZGxlciB8fCBoYW5kbGVyLmd1aWQgPT09IGhhbmRsZU9iai5ndWlkICkgJiYKCQkJCQkJKCAhdG1wIHx8IHRtcC50ZXN0KCBoYW5kbGVPYmoubmFtZXNwYWNlICkgKSAmJgoJCQkJCQkoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8CgkJCQkJCQlzZWxlY3RvciA9PT0gIioqIiAmJiBoYW5kbGVPYmouc2VsZWN0b3IgKSApIHsKCQkJCQkJaGFuZGxlcnMuc3BsaWNlKCBqLCAxICk7CgoJCQkJCQlpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHsKCQkJCQkJCWhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTsKCQkJCQkJfQoJCQkJCQlpZiAoIHNwZWNpYWwucmVtb3ZlICkgewoJCQkJCQkJc3BlY2lhbC5yZW1vdmUuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGdlbmVyaWMgZXZlbnQgaGFuZGxlciBpZiB3ZSByZW1vdmVkIHNvbWV0aGluZyBhbmQgbm8gbW9yZSBoYW5kbGVycyBleGlzdAoJCQkJLy8gKGF2b2lkcyBwb3RlbnRpYWwgZm9yIGVuZGxlc3MgcmVjdXJzaW9uIGR1cmluZyByZW1vdmFsIG9mIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMpCgkJCQlpZiAoIG9yaWdDb3VudCAmJiAhaGFuZGxlcnMubGVuZ3RoICkgewoJCQkJCWlmICggIXNwZWNpYWwudGVhcmRvd24gfHwKCQkJCQkJc3BlY2lhbC50ZWFyZG93bi5jYWxsKCBlbGVtLCBuYW1lc3BhY2VzLCBlbGVtRGF0YS5oYW5kbGUgKSA9PT0gZmFsc2UgKSB7CgoJCQkJCQlqUXVlcnkucmVtb3ZlRXZlbnQoIGVsZW0sIHR5cGUsIGVsZW1EYXRhLmhhbmRsZSApOwoJCQkJCX0KCgkJCQkJZGVsZXRlIGV2ZW50c1sgdHlwZSBdOwoJCQkJfQoJCQl9CgoJCQkvLyBSZW1vdmUgdGhlIGV4cGFuZG8gaWYgaXQncyBubyBsb25nZXIgdXNlZAoJCQlpZiAoIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBldmVudHMgKSApIHsKCQkJCWRlbGV0ZSBlbGVtRGF0YS5oYW5kbGU7CgoJCQkJLy8gcmVtb3ZlRGF0YSBhbHNvIGNoZWNrcyBmb3IgZW1wdGluZXNzIGFuZCBjbGVhcnMgdGhlIGV4cGFuZG8gaWYgZW1wdHkKCQkJCS8vIHNvIHVzZSBpdCBpbnN0ZWFkIG9mIGRlbGV0ZQoJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBlbGVtLCAiZXZlbnRzIiApOwoJCQl9CgkJfSwKCgkJdHJpZ2dlcjogZnVuY3Rpb24oIGV2ZW50LCBkYXRhLCBlbGVtLCBvbmx5SGFuZGxlcnMgKSB7CgkJCXZhciBoYW5kbGUsIG9udHlwZSwgY3VyLAoJCQkJYnViYmxlVHlwZSwgc3BlY2lhbCwgdG1wLCBpLAoJCQkJZXZlbnRQYXRoID0gWyBlbGVtIHx8IGRvY3VtZW50IF0sCgkJCQl0eXBlID0gaGFzT3duLmNhbGwoIGV2ZW50LCAidHlwZSIgKSA/IGV2ZW50LnR5cGUgOiBldmVudCwKCQkJCW5hbWVzcGFjZXMgPSBoYXNPd24uY2FsbCggZXZlbnQsICJuYW1lc3BhY2UiICkgPyBldmVudC5uYW1lc3BhY2Uuc3BsaXQoICIuIiApIDogW107CgoJCQljdXIgPSB0bXAgPSBlbGVtID0gZWxlbSB8fCBkb2N1bWVudDsKCgkJCS8vIERvbid0IGRvIGV2ZW50cyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzCgkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4ICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBmb2N1cy9ibHVyIG1vcnBocyB0byBmb2N1c2luL291dDsgZW5zdXJlIHdlJ3JlIG5vdCBmaXJpbmcgdGhlbSByaWdodCBub3cKCQkJaWYgKCByZm9jdXNNb3JwaC50ZXN0KCB0eXBlICsgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCApICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpZiAoIHR5cGUuaW5kZXhPZiggIi4iICkgPiAtMSApIHsKCgkJCQkvLyBOYW1lc3BhY2VkIHRyaWdnZXI7IGNyZWF0ZSBhIHJlZ2V4cCB0byBtYXRjaCBldmVudCB0eXBlIGluIGhhbmRsZSgpCgkJCQluYW1lc3BhY2VzID0gdHlwZS5zcGxpdCggIi4iICk7CgkJCQl0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgpOwoJCQkJbmFtZXNwYWNlcy5zb3J0KCk7CgkJCX0KCQkJb250eXBlID0gdHlwZS5pbmRleE9mKCAiOiIgKSA8IDAgJiYgIm9uIiArIHR5cGU7CgoJCQkvLyBDYWxsZXIgY2FuIHBhc3MgaW4gYSBqUXVlcnkuRXZlbnQgb2JqZWN0LCBPYmplY3QsIG9yIGp1c3QgYW4gZXZlbnQgdHlwZSBzdHJpbmcKCQkJZXZlbnQgPSBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSA/CgkJCQlldmVudCA6CgkJCQluZXcgalF1ZXJ5LkV2ZW50KCB0eXBlLCB0eXBlb2YgZXZlbnQgPT09ICJvYmplY3QiICYmIGV2ZW50ICk7CgoJCQkvLyBUcmlnZ2VyIGJpdG1hc2s6ICYgMSBmb3IgbmF0aXZlIGhhbmRsZXJzOyAmIDIgZm9yIGpRdWVyeSAoYWx3YXlzIHRydWUpCgkJCWV2ZW50LmlzVHJpZ2dlciA9IG9ubHlIYW5kbGVycyA/IDIgOiAzOwoJCQlldmVudC5uYW1lc3BhY2UgPSBuYW1lc3BhY2VzLmpvaW4oICIuIiApOwoJCQlldmVudC5ybmFtZXNwYWNlID0gZXZlbnQubmFtZXNwYWNlID8KCQkJCW5ldyBSZWdFeHAoICIoXnxcXC4pIiArIG5hbWVzcGFjZXMuam9pbiggIlxcLig/Oi4qXFwufCkiICkgKyAiKFxcLnwkKSIgKSA6CgkJCQludWxsOwoKCQkJLy8gQ2xlYW4gdXAgdGhlIGV2ZW50IGluIGNhc2UgaXQgaXMgYmVpbmcgcmV1c2VkCgkJCWV2ZW50LnJlc3VsdCA9IHVuZGVmaW5lZDsKCQkJaWYgKCAhZXZlbnQudGFyZ2V0ICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gZWxlbTsKCQkJfQoKCQkJLy8gQ2xvbmUgYW55IGluY29taW5nIGRhdGEgYW5kIHByZXBlbmQgdGhlIGV2ZW50LCBjcmVhdGluZyB0aGUgaGFuZGxlciBhcmcgbGlzdAoJCQlkYXRhID0gZGF0YSA9PSBudWxsID8KCQkJCVsgZXZlbnQgXSA6CgkJCQlqUXVlcnkubWFrZUFycmF5KCBkYXRhLCBbIGV2ZW50IF0gKTsKCgkJCS8vIEFsbG93IHNwZWNpYWwgZXZlbnRzIHRvIGRyYXcgb3V0c2lkZSB0aGUgbGluZXMKCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCWlmICggIW9ubHlIYW5kbGVycyAmJiBzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmlnZ2VyLmFwcGx5KCBlbGVtLCBkYXRhICkgPT09IGZhbHNlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZXRlcm1pbmUgZXZlbnQgcHJvcGFnYXRpb24gcGF0aCBpbiBhZHZhbmNlLCBwZXIgVzNDIGV2ZW50cyBzcGVjICgjOTk1MSkKCQkJLy8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNCkKCQkJaWYgKCAhb25seUhhbmRsZXJzICYmICFzcGVjaWFsLm5vQnViYmxlICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQlidWJibGVUeXBlID0gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgfHwgdHlwZTsKCQkJCWlmICggIXJmb2N1c01vcnBoLnRlc3QoIGJ1YmJsZVR5cGUgKyB0eXBlICkgKSB7CgkJCQkJY3VyID0gY3VyLnBhcmVudE5vZGU7CgkJCQl9CgkJCQlmb3IgKCA7IGN1cjsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7CgkJCQkJZXZlbnRQYXRoLnB1c2goIGN1ciApOwoJCQkJCXRtcCA9IGN1cjsKCQkJCX0KCgkJCQkvLyBPbmx5IGFkZCB3aW5kb3cgaWYgd2UgZ290IHRvIGRvY3VtZW50IChlLmcuLCBub3QgcGxhaW4gb2JqIG9yIGRldGFjaGVkIERPTSkKCQkJCWlmICggdG1wID09PSAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApICkgewoJCQkJCWV2ZW50UGF0aC5wdXNoKCB0bXAuZGVmYXVsdFZpZXcgfHwgdG1wLnBhcmVudFdpbmRvdyB8fCB3aW5kb3cgKTsKCQkJCX0KCQkJfQoKCQkJLy8gRmlyZSBoYW5kbGVycyBvbiB0aGUgZXZlbnQgcGF0aAoJCQlpID0gMDsKCQkJd2hpbGUgKCAoIGN1ciA9IGV2ZW50UGF0aFsgaSsrIF0gKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSApIHsKCgkJCQlldmVudC50eXBlID0gaSA+IDEgPwoJCQkJCWJ1YmJsZVR5cGUgOgoJCQkJCXNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZTsKCgkJCQkvLyBqUXVlcnkgaGFuZGxlcgoJCQkJaGFuZGxlID0gKCBqUXVlcnkuX2RhdGEoIGN1ciwgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gJiYKCQkJCQlqUXVlcnkuX2RhdGEoIGN1ciwgImhhbmRsZSIgKTsKCgkJCQlpZiAoIGhhbmRsZSApIHsKCQkJCQloYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJfQoKCQkJCS8vIE5hdGl2ZSBoYW5kbGVyCgkJCQloYW5kbGUgPSBvbnR5cGUgJiYgY3VyWyBvbnR5cGUgXTsKCQkJCWlmICggaGFuZGxlICYmIGhhbmRsZS5hcHBseSAmJiBhY2NlcHREYXRhKCBjdXIgKSApIHsKCQkJCQlldmVudC5yZXN1bHQgPSBoYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJCWlmICggZXZlbnQucmVzdWx0ID09PSBmYWxzZSApIHsKCQkJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJZXZlbnQudHlwZSA9IHR5cGU7CgoJCQkvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93CgkJCWlmICggIW9ubHlIYW5kbGVycyAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgoJCQkJaWYgKAoJCQkJCSggIXNwZWNpYWwuX2RlZmF1bHQgfHwKCQkJCQkgc3BlY2lhbC5fZGVmYXVsdC5hcHBseSggZXZlbnRQYXRoLnBvcCgpLCBkYXRhICkgPT09IGZhbHNlCgkJCQkJKSAmJiBhY2NlcHREYXRhKCBlbGVtICkKCQkJCSkgewoKCQkJCQkvLyBDYWxsIGEgbmF0aXZlIERPTSBtZXRob2Qgb24gdGhlIHRhcmdldCB3aXRoIHRoZSBzYW1lIG5hbWUgbmFtZSBhcyB0aGUgZXZlbnQuCgkJCQkJLy8gQ2FuJ3QgdXNlIGFuIC5pc0Z1bmN0aW9uKCkgY2hlY2sgaGVyZSBiZWNhdXNlIElFNi83IGZhaWxzIHRoYXQgdGVzdC4KCQkJCQkvLyBEb24ndCBkbyBkZWZhdWx0IGFjdGlvbnMgb24gd2luZG93LCB0aGF0J3Mgd2hlcmUgZ2xvYmFsIHZhcmlhYmxlcyBiZSAoIzYxNzApCgkJCQkJaWYgKCBvbnR5cGUgJiYgZWxlbVsgdHlwZSBdICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQkJCS8vIERvbid0IHJlLXRyaWdnZXIgYW4gb25GT08gZXZlbnQgd2hlbiB3ZSBjYWxsIGl0cyBGT08oKSBtZXRob2QKCQkJCQkJdG1wID0gZWxlbVsgb250eXBlIF07CgoJCQkJCQlpZiAoIHRtcCApIHsKCQkJCQkJCWVsZW1bIG9udHlwZSBdID0gbnVsbDsKCQkJCQkJfQoKCQkJCQkJLy8gUHJldmVudCByZS10cmlnZ2VyaW5nIG9mIHRoZSBzYW1lIGV2ZW50LCBzaW5jZSB3ZSBhbHJlYWR5IGJ1YmJsZWQgaXQgYWJvdmUKCQkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHR5cGU7CgkJCQkJCXRyeSB7CgkJCQkJCQllbGVtWyB0eXBlIF0oKTsKCQkJCQkJfSBjYXRjaCAoIGUgKSB7CgoJCQkJCQkJLy8gSUU8OSBkaWVzIG9uIGZvY3VzL2JsdXIgdG8gaGlkZGVuIGVsZW1lbnQgKCMxNDg2LCMxMjUxOCkKCQkJCQkJCS8vIG9ubHkgcmVwcm9kdWNpYmxlIG9uIHdpblhQIElFOCBuYXRpdmUsIG5vdCBJRTkgaW4gSUU4IG1vZGUKCQkJCQkJfQoJCQkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdW5kZWZpbmVkOwoKCQkJCQkJaWYgKCB0bXAgKSB7CgkJCQkJCQllbGVtWyBvbnR5cGUgXSA9IHRtcDsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGV2ZW50LnJlc3VsdDsKCQl9LAoKCQlkaXNwYXRjaDogZnVuY3Rpb24oIGV2ZW50ICkgewoKCQkJLy8gTWFrZSBhIHdyaXRhYmxlIGpRdWVyeS5FdmVudCBmcm9tIHRoZSBuYXRpdmUgZXZlbnQgb2JqZWN0CgkJCWV2ZW50ID0galF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKTsKCgkJCXZhciBpLCBqLCByZXQsIG1hdGNoZWQsIGhhbmRsZU9iaiwKCQkJCWhhbmRsZXJRdWV1ZSA9IFtdLAoJCQkJYXJncyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApLAoJCQkJaGFuZGxlcnMgPSAoIGpRdWVyeS5fZGF0YSggdGhpcywgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gfHwgW10sCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGV2ZW50LnR5cGUgXSB8fCB7fTsKCgkJCS8vIFVzZSB0aGUgZml4LWVkIGpRdWVyeS5FdmVudCByYXRoZXIgdGhhbiB0aGUgKHJlYWQtb25seSkgbmF0aXZlIGV2ZW50CgkJCWFyZ3NbIDAgXSA9IGV2ZW50OwoJCQlldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7CgoJCQkvLyBDYWxsIHRoZSBwcmVEaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUsIGFuZCBsZXQgaXQgYmFpbCBpZiBkZXNpcmVkCgkJCWlmICggc3BlY2lhbC5wcmVEaXNwYXRjaCAmJiBzcGVjaWFsLnByZURpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICkgPT09IGZhbHNlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZXRlcm1pbmUgaGFuZGxlcnMKCQkJaGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwoIHRoaXMsIGV2ZW50LCBoYW5kbGVycyApOwoKCQkJLy8gUnVuIGRlbGVnYXRlcyBmaXJzdDsgdGhleSBtYXkgd2FudCB0byBzdG9wIHByb3BhZ2F0aW9uIGJlbmVhdGggdXMKCQkJaSA9IDA7CgkJCXdoaWxlICggKCBtYXRjaGVkID0gaGFuZGxlclF1ZXVlWyBpKysgXSApICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkgewoJCQkJZXZlbnQuY3VycmVudFRhcmdldCA9IG1hdGNoZWQuZWxlbTsKCgkJCQlqID0gMDsKCQkJCXdoaWxlICggKCBoYW5kbGVPYmogPSBtYXRjaGVkLmhhbmRsZXJzWyBqKysgXSApICYmCgkJCQkJIWV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7CgoJCQkJCS8vIFRyaWdnZXJlZCBldmVudCBtdXN0IGVpdGhlciAxKSBoYXZlIG5vIG5hbWVzcGFjZSwgb3IgMikgaGF2ZSBuYW1lc3BhY2UocykKCQkJCQkvLyBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBpbiB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS4KCQkJCQlpZiAoICFldmVudC5ybmFtZXNwYWNlIHx8IGV2ZW50LnJuYW1lc3BhY2UudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgewoKCQkJCQkJZXZlbnQuaGFuZGxlT2JqID0gaGFuZGxlT2JqOwoJCQkJCQlldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7CgoJCQkJCQlyZXQgPSAoICggalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGhhbmRsZU9iai5vcmlnVHlwZSBdIHx8IHt9ICkuaGFuZGxlIHx8CgkJCQkJCQloYW5kbGVPYmouaGFuZGxlciApLmFwcGx5KCBtYXRjaGVkLmVsZW0sIGFyZ3MgKTsKCgkJCQkJCWlmICggcmV0ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCQlpZiAoICggZXZlbnQucmVzdWx0ID0gcmV0ICkgPT09IGZhbHNlICkgewoJCQkJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQkJCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIENhbGwgdGhlIHBvc3REaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUKCQkJaWYgKCBzcGVjaWFsLnBvc3REaXNwYXRjaCApIHsKCQkJCXNwZWNpYWwucG9zdERpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICk7CgkJCX0KCgkJCXJldHVybiBldmVudC5yZXN1bHQ7CgkJfSwKCgkJaGFuZGxlcnM6IGZ1bmN0aW9uKCBldmVudCwgaGFuZGxlcnMgKSB7CgkJCXZhciBpLCBtYXRjaGVzLCBzZWwsIGhhbmRsZU9iaiwKCQkJCWhhbmRsZXJRdWV1ZSA9IFtdLAoJCQkJZGVsZWdhdGVDb3VudCA9IGhhbmRsZXJzLmRlbGVnYXRlQ291bnQsCgkJCQljdXIgPSBldmVudC50YXJnZXQ7CgoJCQkvLyBTdXBwb3J0IChhdCBsZWFzdCk6IENocm9tZSwgSUU5CgkJCS8vIEZpbmQgZGVsZWdhdGUgaGFuZGxlcnMKCQkJLy8gQmxhY2staG9sZSBTVkcgPHVzZT4gaW5zdGFuY2UgdHJlZXMgKCMxMzE4MCkKCQkJLy8KCQkJLy8gU3VwcG9ydDogRmlyZWZveDw9NDIrCgkJCS8vIEF2b2lkIG5vbi1sZWZ0LWNsaWNrIGluIEZGIGJ1dCBkb24ndCBibG9jayBJRSByYWRpbyBldmVudHMgKCMzODYxLCBnaC0yMzQzKQoJCQlpZiAoIGRlbGVnYXRlQ291bnQgJiYgY3VyLm5vZGVUeXBlICYmCgkJCQkoIGV2ZW50LnR5cGUgIT09ICJjbGljayIgfHwgaXNOYU4oIGV2ZW50LmJ1dHRvbiApIHx8IGV2ZW50LmJ1dHRvbiA8IDEgKSApIHsKCgkJCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCQkJZm9yICggOyBjdXIgIT0gdGhpczsgY3VyID0gY3VyLnBhcmVudE5vZGUgfHwgdGhpcyApIHsKCQkJCQkvKiBqc2hpbnQgZXFlcWVxOiB0cnVlICovCgoJCQkJCS8vIERvbid0IGNoZWNrIG5vbi1lbGVtZW50cyAoIzEzMjA4KQoJCQkJCS8vIERvbid0IHByb2Nlc3MgY2xpY2tzIG9uIGRpc2FibGVkIGVsZW1lbnRzICgjNjkxMSwgIzgxNjUsICMxMTM4MiwgIzExNzY0KQoJCQkJCWlmICggY3VyLm5vZGVUeXBlID09PSAxICYmICggY3VyLmRpc2FibGVkICE9PSB0cnVlIHx8IGV2ZW50LnR5cGUgIT09ICJjbGljayIgKSApIHsKCQkJCQkJbWF0Y2hlcyA9IFtdOwoJCQkJCQlmb3IgKCBpID0gMDsgaSA8IGRlbGVnYXRlQ291bnQ7IGkrKyApIHsKCQkJCQkJCWhhbmRsZU9iaiA9IGhhbmRsZXJzWyBpIF07CgoJCQkJCQkJLy8gRG9uJ3QgY29uZmxpY3Qgd2l0aCBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKCMxMzIwMykKCQkJCQkJCXNlbCA9IGhhbmRsZU9iai5zZWxlY3RvciArICIgIjsKCgkJCQkJCQlpZiAoIG1hdGNoZXNbIHNlbCBdID09PSB1bmRlZmluZWQgKSB7CgkJCQkJCQkJbWF0Y2hlc1sgc2VsIF0gPSBoYW5kbGVPYmoubmVlZHNDb250ZXh0ID8KCQkJCQkJCQkJalF1ZXJ5KCBzZWwsIHRoaXMgKS5pbmRleCggY3VyICkgPiAtMSA6CgkJCQkJCQkJCWpRdWVyeS5maW5kKCBzZWwsIHRoaXMsIG51bGwsIFsgY3VyIF0gKS5sZW5ndGg7CgkJCQkJCQl9CgkJCQkJCQlpZiAoIG1hdGNoZXNbIHNlbCBdICkgewoJCQkJCQkJCW1hdGNoZXMucHVzaCggaGFuZGxlT2JqICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJaWYgKCBtYXRjaGVzLmxlbmd0aCApIHsKCQkJCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKCB7IGVsZW06IGN1ciwgaGFuZGxlcnM6IG1hdGNoZXMgfSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBBZGQgdGhlIHJlbWFpbmluZyAoZGlyZWN0bHktYm91bmQpIGhhbmRsZXJzCgkJCWlmICggZGVsZWdhdGVDb3VudCA8IGhhbmRsZXJzLmxlbmd0aCApIHsKCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKCB7IGVsZW06IHRoaXMsIGhhbmRsZXJzOiBoYW5kbGVycy5zbGljZSggZGVsZWdhdGVDb3VudCApIH0gKTsKCQkJfQoKCQkJcmV0dXJuIGhhbmRsZXJRdWV1ZTsKCQl9LAoKCQlmaXg6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJaWYgKCBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJCXJldHVybiBldmVudDsKCQkJfQoKCQkJLy8gQ3JlYXRlIGEgd3JpdGFibGUgY29weSBvZiB0aGUgZXZlbnQgb2JqZWN0IGFuZCBub3JtYWxpemUgc29tZSBwcm9wZXJ0aWVzCgkJCXZhciBpLCBwcm9wLCBjb3B5LAoJCQkJdHlwZSA9IGV2ZW50LnR5cGUsCgkJCQlvcmlnaW5hbEV2ZW50ID0gZXZlbnQsCgkJCQlmaXhIb29rID0gdGhpcy5maXhIb29rc1sgdHlwZSBdOwoKCQkJaWYgKCAhZml4SG9vayApIHsKCQkJCXRoaXMuZml4SG9va3NbIHR5cGUgXSA9IGZpeEhvb2sgPQoJCQkJCXJtb3VzZUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMubW91c2VIb29rcyA6CgkJCQkJcmtleUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMua2V5SG9va3MgOgoJCQkJCXt9OwoJCQl9CgkJCWNvcHkgPSBmaXhIb29rLnByb3BzID8gdGhpcy5wcm9wcy5jb25jYXQoIGZpeEhvb2sucHJvcHMgKSA6IHRoaXMucHJvcHM7CgoJCQlldmVudCA9IG5ldyBqUXVlcnkuRXZlbnQoIG9yaWdpbmFsRXZlbnQgKTsKCgkJCWkgPSBjb3B5Lmxlbmd0aDsKCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQlwcm9wID0gY29weVsgaSBdOwoJCQkJZXZlbnRbIHByb3AgXSA9IG9yaWdpbmFsRXZlbnRbIHByb3AgXTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBGaXggdGFyZ2V0IHByb3BlcnR5ICgjMTkyNSkKCQkJaWYgKCAhZXZlbnQudGFyZ2V0ICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gb3JpZ2luYWxFdmVudC5zcmNFbGVtZW50IHx8IGRvY3VtZW50OwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBTYWZhcmkgNi04KwoJCQkvLyBUYXJnZXQgc2hvdWxkIG5vdCBiZSBhIHRleHQgbm9kZSAoIzUwNCwgIzEzMTQzKQoJCQlpZiAoIGV2ZW50LnRhcmdldC5ub2RlVHlwZSA9PT0gMyApIHsKCQkJCWV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIEZvciBtb3VzZS9rZXkgZXZlbnRzLCBtZXRhS2V5PT1mYWxzZSBpZiBpdCdzIHVuZGVmaW5lZCAoIzMzNjgsICMxMTMyOCkKCQkJZXZlbnQubWV0YUtleSA9ICEhZXZlbnQubWV0YUtleTsKCgkJCXJldHVybiBmaXhIb29rLmZpbHRlciA/IGZpeEhvb2suZmlsdGVyKCBldmVudCwgb3JpZ2luYWxFdmVudCApIDogZXZlbnQ7CgkJfSwKCgkJLy8gSW5jbHVkZXMgc29tZSBldmVudCBwcm9wcyBzaGFyZWQgYnkgS2V5RXZlbnQgYW5kIE1vdXNlRXZlbnQKCQlwcm9wczogKCAiYWx0S2V5IGJ1YmJsZXMgY2FuY2VsYWJsZSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZGV0YWlsIGV2ZW50UGhhc2UgIiArCgkJCSJtZXRhS2V5IHJlbGF0ZWRUYXJnZXQgc2hpZnRLZXkgdGFyZ2V0IHRpbWVTdGFtcCB2aWV3IHdoaWNoIiApLnNwbGl0KCAiICIgKSwKCgkJZml4SG9va3M6IHt9LAoKCQlrZXlIb29rczogewoJCQlwcm9wczogImNoYXIgY2hhckNvZGUga2V5IGtleUNvZGUiLnNwbGl0KCAiICIgKSwKCQkJZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkgewoKCQkJCS8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50cwoJCQkJaWYgKCBldmVudC53aGljaCA9PSBudWxsICkgewoJCQkJCWV2ZW50LndoaWNoID0gb3JpZ2luYWwuY2hhckNvZGUgIT0gbnVsbCA/IG9yaWdpbmFsLmNoYXJDb2RlIDogb3JpZ2luYWwua2V5Q29kZTsKCQkJCX0KCgkJCQlyZXR1cm4gZXZlbnQ7CgkJCX0KCQl9LAoKCQltb3VzZUhvb2tzOiB7CgkJCXByb3BzOiAoICJidXR0b24gYnV0dG9ucyBjbGllbnRYIGNsaWVudFkgZnJvbUVsZW1lbnQgb2Zmc2V0WCBvZmZzZXRZICIgKwoJCQkJInBhZ2VYIHBhZ2VZIHNjcmVlblggc2NyZWVuWSB0b0VsZW1lbnQiICkuc3BsaXQoICIgIiApLAoJCQlmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7CgkJCQl2YXIgYm9keSwgZXZlbnREb2MsIGRvYywKCQkJCQlidXR0b24gPSBvcmlnaW5hbC5idXR0b24sCgkJCQkJZnJvbUVsZW1lbnQgPSBvcmlnaW5hbC5mcm9tRWxlbWVudDsKCgkJCQkvLyBDYWxjdWxhdGUgcGFnZVgvWSBpZiBtaXNzaW5nIGFuZCBjbGllbnRYL1kgYXZhaWxhYmxlCgkJCQlpZiAoIGV2ZW50LnBhZ2VYID09IG51bGwgJiYgb3JpZ2luYWwuY2xpZW50WCAhPSBudWxsICkgewoJCQkJCWV2ZW50RG9jID0gZXZlbnQudGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CgkJCQkJZG9jID0gZXZlbnREb2MuZG9jdW1lbnRFbGVtZW50OwoJCQkJCWJvZHkgPSBldmVudERvYy5ib2R5OwoKCQkJCQlldmVudC5wYWdlWCA9IG9yaWdpbmFsLmNsaWVudFggKwoJCQkJCQkoIGRvYyAmJiBkb2Muc2Nyb2xsTGVmdCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwICkgLQoJCQkJCQkoIGRvYyAmJiBkb2MuY2xpZW50TGVmdCB8fCBib2R5ICYmIGJvZHkuY2xpZW50TGVmdCB8fCAwICk7CgkJCQkJZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsKCQkJCQkJKCBkb2MgJiYgZG9jLnNjcm9sbFRvcCAgfHwgYm9keSAmJiBib2R5LnNjcm9sbFRvcCAgfHwgMCApIC0KCQkJCQkJKCBkb2MgJiYgZG9jLmNsaWVudFRvcCAgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCAgfHwgMCApOwoJCQkJfQoKCQkJCS8vIEFkZCByZWxhdGVkVGFyZ2V0LCBpZiBuZWNlc3NhcnkKCQkJCWlmICggIWV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgZnJvbUVsZW1lbnQgKSB7CgkJCQkJZXZlbnQucmVsYXRlZFRhcmdldCA9IGZyb21FbGVtZW50ID09PSBldmVudC50YXJnZXQgPwoJCQkJCQlvcmlnaW5hbC50b0VsZW1lbnQgOgoJCQkJCQlmcm9tRWxlbWVudDsKCQkJCX0KCgkJCQkvLyBBZGQgd2hpY2ggZm9yIGNsaWNrOiAxID09PSBsZWZ0OyAyID09PSBtaWRkbGU7IDMgPT09IHJpZ2h0CgkJCQkvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdAoJCQkJaWYgKCAhZXZlbnQud2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJZXZlbnQud2hpY2ggPSAoIGJ1dHRvbiAmIDEgPyAxIDogKCBidXR0b24gJiAyID8gMyA6ICggYnV0dG9uICYgNCA/IDIgOiAwICkgKSApOwoJCQkJfQoKCQkJCXJldHVybiBldmVudDsKCQkJfQoJCX0sCgoJCXNwZWNpYWw6IHsKCQkJbG9hZDogewoKCQkJCS8vIFByZXZlbnQgdHJpZ2dlcmVkIGltYWdlLmxvYWQgZXZlbnRzIGZyb20gYnViYmxpbmcgdG8gd2luZG93LmxvYWQKCQkJCW5vQnViYmxlOiB0cnVlCgkJCX0sCgkJCWZvY3VzOiB7CgoJCQkJLy8gRmlyZSBuYXRpdmUgZXZlbnQgaWYgcG9zc2libGUgc28gYmx1ci9mb2N1cyBzZXF1ZW5jZSBpcyBjb3JyZWN0CgkJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIHRoaXMgIT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5mb2N1cyApIHsKCQkJCQkJdHJ5IHsKCQkJCQkJCXRoaXMuZm9jdXMoKTsKCQkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQkJfSBjYXRjaCAoIGUgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSWYgd2UgZXJyb3Igb24gZm9jdXMgdG8gaGlkZGVuIGVsZW1lbnQgKCMxNDg2LCAjMTI1MTgpLAoJCQkJCQkJLy8gbGV0IC50cmlnZ2VyKCkgcnVuIHRoZSBoYW5kbGVycwoJCQkJCQl9CgkJCQkJfQoJCQkJfSwKCQkJCWRlbGVnYXRlVHlwZTogImZvY3VzaW4iCgkJCX0sCgkJCWJsdXI6IHsKCQkJCXRyaWdnZXI6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggdGhpcyA9PT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmJsdXIgKSB7CgkJCQkJCXRoaXMuYmx1cigpOwoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJfSwKCQkJCWRlbGVnYXRlVHlwZTogImZvY3Vzb3V0IgoJCQl9LAoJCQljbGljazogewoKCQkJCS8vIEZvciBjaGVja2JveCwgZmlyZSBuYXRpdmUgZXZlbnQgc28gY2hlY2tlZCBzdGF0ZSB3aWxsIGJlIHJpZ2h0CgkJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggdGhpcywgImlucHV0IiApICYmIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiAmJiB0aGlzLmNsaWNrICkgewoJCQkJCQl0aGlzLmNsaWNrKCk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9LAoKCQkJCS8vIEZvciBjcm9zcy1icm93c2VyIGNvbnNpc3RlbmN5LCBkb24ndCBmaXJlIG5hdGl2ZSAuY2xpY2soKSBvbiBsaW5rcwoJCQkJX2RlZmF1bHQ6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBldmVudC50YXJnZXQsICJhIiApOwoJCQkJfQoJCQl9LAoKCQkJYmVmb3JldW5sb2FkOiB7CgkJCQlwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCQkJLy8gU3VwcG9ydDogRmlyZWZveCAyMCsKCQkJCQkvLyBGaXJlZm94IGRvZXNuJ3QgYWxlcnQgaWYgdGhlIHJldHVyblZhbHVlIGZpZWxkIGlzIG5vdCBzZXQuCgkJCQkJaWYgKCBldmVudC5yZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBldmVudC5vcmlnaW5hbEV2ZW50ICkgewoJCQkJCQlldmVudC5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID0gZXZlbnQucmVzdWx0OwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0sCgoJCS8vIFBpZ2d5YmFjayBvbiBhIGRvbm9yIGV2ZW50IHRvIHNpbXVsYXRlIGEgZGlmZmVyZW50IG9uZQoJCXNpbXVsYXRlOiBmdW5jdGlvbiggdHlwZSwgZWxlbSwgZXZlbnQgKSB7CgkJCXZhciBlID0galF1ZXJ5LmV4dGVuZCgKCQkJCW5ldyBqUXVlcnkuRXZlbnQoKSwKCQkJCWV2ZW50LAoJCQkJewoJCQkJCXR5cGU6IHR5cGUsCgkJCQkJaXNTaW11bGF0ZWQ6IHRydWUKCgkJCQkJLy8gUHJldmlvdXNseSwgYG9yaWdpbmFsRXZlbnQ6IHt9YCB3YXMgc2V0IGhlcmUsIHNvIHN0b3BQcm9wYWdhdGlvbiBjYWxsCgkJCQkJLy8gd291bGQgbm90IGJlIHRyaWdnZXJlZCBvbiBkb25vciBldmVudCwgc2luY2UgaW4gb3VyIG93bgoJCQkJCS8vIGpRdWVyeS5ldmVudC5zdG9wUHJvcGFnYXRpb24gZnVuY3Rpb24gd2UgaGFkIGEgY2hlY2sgZm9yIGV4aXN0ZW5jZSBvZgoJCQkJCS8vIG9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uIG1ldGhvZCwgc28sIGNvbnNlcXVlbnRseSBpdCB3b3VsZCBiZSBhIG5vb3AuCgkJCQkJLy8KCQkJCQkvLyBHdWFyZCBmb3Igc2ltdWxhdGVkIGV2ZW50cyB3YXMgbW92ZWQgdG8galF1ZXJ5LmV2ZW50LnN0b3BQcm9wYWdhdGlvbiBmdW5jdGlvbgoJCQkJCS8vIHNpbmNlIGBvcmlnaW5hbEV2ZW50YCBzaG91bGQgcG9pbnQgdG8gdGhlIG9yaWdpbmFsIGV2ZW50IGZvciB0aGUKCQkJCQkvLyBjb25zdGFuY3kgd2l0aCBvdGhlciBldmVudHMgYW5kIGZvciBtb3JlIGZvY3VzZWQgbG9naWMKCQkJCX0KCQkJKTsKCgkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCBlLCBudWxsLCBlbGVtICk7CgoJCQlpZiAoIGUuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQl9CgkJfQoJfTsKCglqUXVlcnkucmVtb3ZlRXZlbnQgPSBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyID8KCQlmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoKCQkJLy8gVGhpcyAiaWYiIGlzIG5lZWRlZCBmb3IgcGxhaW4gb2JqZWN0cwoJCQlpZiAoIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciApIHsKCQkJCWVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciggdHlwZSwgaGFuZGxlICk7CgkJCX0KCQl9IDoKCQlmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoJCQl2YXIgbmFtZSA9ICJvbiIgKyB0eXBlOwoKCQkJaWYgKCBlbGVtLmRldGFjaEV2ZW50ICkgewoKCQkJCS8vICM4NTQ1LCAjNzA1NCwgcHJldmVudGluZyBtZW1vcnkgbGVha3MgZm9yIGN1c3RvbSBldmVudHMgaW4gSUU2LTgKCQkJCS8vIGRldGFjaEV2ZW50IG5lZWRlZCBwcm9wZXJ0eSBvbiBlbGVtZW50LCBieSBuYW1lIG9mIHRoYXQgZXZlbnQsCgkJCQkvLyB0byBwcm9wZXJseSBleHBvc2UgaXQgdG8gR0MKCQkJCWlmICggdHlwZW9mIGVsZW1bIG5hbWUgXSA9PT0gInVuZGVmaW5lZCIgKSB7CgkJCQkJZWxlbVsgbmFtZSBdID0gbnVsbDsKCQkJCX0KCgkJCQllbGVtLmRldGFjaEV2ZW50KCBuYW1lLCBoYW5kbGUgKTsKCQkJfQoJCX07CgoJalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24oIHNyYywgcHJvcHMgKSB7CgoJCS8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCB0aGUgJ25ldycga2V5d29yZAoJCWlmICggISggdGhpcyBpbnN0YW5jZW9mIGpRdWVyeS5FdmVudCApICkgewoJCQlyZXR1cm4gbmV3IGpRdWVyeS5FdmVudCggc3JjLCBwcm9wcyApOwoJCX0KCgkJLy8gRXZlbnQgb2JqZWN0CgkJaWYgKCBzcmMgJiYgc3JjLnR5cGUgKSB7CgkJCXRoaXMub3JpZ2luYWxFdmVudCA9IHNyYzsKCQkJdGhpcy50eXBlID0gc3JjLnR5cGU7CgoJCQkvLyBFdmVudHMgYnViYmxpbmcgdXAgdGhlIGRvY3VtZW50IG1heSBoYXZlIGJlZW4gbWFya2VkIGFzIHByZXZlbnRlZAoJCQkvLyBieSBhIGhhbmRsZXIgbG93ZXIgZG93biB0aGUgdHJlZTsgcmVmbGVjdCB0aGUgY29ycmVjdCB2YWx1ZS4KCQkJdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fAoJCQkJCXNyYy5kZWZhdWx0UHJldmVudGVkID09PSB1bmRlZmluZWQgJiYKCgkJCQkJLy8gU3VwcG9ydDogSUUgPCA5LCBBbmRyb2lkIDwgNC4wCgkJCQkJc3JjLnJldHVyblZhbHVlID09PSBmYWxzZSA/CgkJCQlyZXR1cm5UcnVlIDoKCQkJCXJldHVybkZhbHNlOwoKCQkvLyBFdmVudCB0eXBlCgkJfSBlbHNlIHsKCQkJdGhpcy50eXBlID0gc3JjOwoJCX0KCgkJLy8gUHV0IGV4cGxpY2l0bHkgcHJvdmlkZWQgcHJvcGVydGllcyBvbnRvIHRoZSBldmVudCBvYmplY3QKCQlpZiAoIHByb3BzICkgewoJCQlqUXVlcnkuZXh0ZW5kKCB0aGlzLCBwcm9wcyApOwoJCX0KCgkJLy8gQ3JlYXRlIGEgdGltZXN0YW1wIGlmIGluY29taW5nIGV2ZW50IGRvZXNuJ3QgaGF2ZSBvbmUKCQl0aGlzLnRpbWVTdGFtcCA9IHNyYyAmJiBzcmMudGltZVN0YW1wIHx8IGpRdWVyeS5ub3coKTsKCgkJLy8gTWFyayBpdCBhcyBmaXhlZAoJCXRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlOwoJfTsKCgkvLyBqUXVlcnkuRXZlbnQgaXMgYmFzZWQgb24gRE9NMyBFdmVudHMgYXMgc3BlY2lmaWVkIGJ5IHRoZSBFQ01BU2NyaXB0IExhbmd1YWdlIEJpbmRpbmcKCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDMvV0QtRE9NLUxldmVsLTMtRXZlbnRzLTIwMDMwMzMxL2VjbWEtc2NyaXB0LWJpbmRpbmcuaHRtbAoJalF1ZXJ5LkV2ZW50LnByb3RvdHlwZSA9IHsKCQljb25zdHJ1Y3RvcjogalF1ZXJ5LkV2ZW50LAoJCWlzRGVmYXVsdFByZXZlbnRlZDogcmV0dXJuRmFsc2UsCgkJaXNQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLAoJCWlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwKCgkJcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZTsKCQkJaWYgKCAhZSApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gSWYgcHJldmVudERlZmF1bHQgZXhpc3RzLCBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgkJCWlmICggZS5wcmV2ZW50RGVmYXVsdCApIHsKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCgkJCS8vIFN1cHBvcnQ6IElFCgkJCS8vIE90aGVyd2lzZSBzZXQgdGhlIHJldHVyblZhbHVlIHByb3BlcnR5IG9mIHRoZSBvcmlnaW5hbCBldmVudCB0byBmYWxzZQoJCQl9IGVsc2UgewoJCQkJZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwoJCQl9CgkJfSwKCQlzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoKCQkJaWYgKCAhZSB8fCB0aGlzLmlzU2ltdWxhdGVkICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBJZiBzdG9wUHJvcGFnYXRpb24gZXhpc3RzLCBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgkJCWlmICggZS5zdG9wUHJvcGFnYXRpb24gKSB7CgkJCQllLnN0b3BQcm9wYWdhdGlvbigpOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBTZXQgdGhlIGNhbmNlbEJ1YmJsZSBwcm9wZXJ0eSBvZiB0aGUgb3JpZ2luYWwgZXZlbnQgdG8gdHJ1ZQoJCQllLmNhbmNlbEJ1YmJsZSA9IHRydWU7CgkJfSwKCQlzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoKCQkJaWYgKCBlICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uICkgewoJCQkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKCQkJfQoKCQkJdGhpcy5zdG9wUHJvcGFnYXRpb24oKTsKCQl9Cgl9OwoKCS8vIENyZWF0ZSBtb3VzZWVudGVyL2xlYXZlIGV2ZW50cyB1c2luZyBtb3VzZW92ZXIvb3V0IGFuZCBldmVudC10aW1lIGNoZWNrcwoJLy8gc28gdGhhdCBldmVudCBkZWxlZ2F0aW9uIHdvcmtzIGluIGpRdWVyeS4KCS8vIERvIHRoZSBzYW1lIGZvciBwb2ludGVyZW50ZXIvcG9pbnRlcmxlYXZlIGFuZCBwb2ludGVyb3Zlci9wb2ludGVyb3V0CgkvLwoJLy8gU3VwcG9ydDogU2FmYXJpIDcgb25seQoJLy8gU2FmYXJpIHNlbmRzIG1vdXNlZW50ZXIgdG9vIG9mdGVuOyBzZWU6CgkvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NDcwMjU4CgkvLyBmb3IgdGhlIGRlc2NyaXB0aW9uIG9mIHRoZSBidWcgKGl0IGV4aXN0ZWQgaW4gb2xkZXIgQ2hyb21lIHZlcnNpb25zIGFzIHdlbGwpLgoJalF1ZXJ5LmVhY2goIHsKCQltb3VzZWVudGVyOiAibW91c2VvdmVyIiwKCQltb3VzZWxlYXZlOiAibW91c2VvdXQiLAoJCXBvaW50ZXJlbnRlcjogInBvaW50ZXJvdmVyIiwKCQlwb2ludGVybGVhdmU6ICJwb2ludGVyb3V0IgoJfSwgZnVuY3Rpb24oIG9yaWcsIGZpeCApIHsKCQlqUXVlcnkuZXZlbnQuc3BlY2lhbFsgb3JpZyBdID0gewoJCQlkZWxlZ2F0ZVR5cGU6IGZpeCwKCQkJYmluZFR5cGU6IGZpeCwKCgkJCWhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJdmFyIHJldCwKCQkJCQl0YXJnZXQgPSB0aGlzLAoJCQkJCXJlbGF0ZWQgPSBldmVudC5yZWxhdGVkVGFyZ2V0LAoJCQkJCWhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iajsKCgkJCQkvLyBGb3IgbW91c2VlbnRlci9sZWF2ZSBjYWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0LgoJCQkJLy8gTkI6IE5vIHJlbGF0ZWRUYXJnZXQgaWYgdGhlIG1vdXNlIGxlZnQvZW50ZXJlZCB0aGUgYnJvd3NlciB3aW5kb3cKCQkJCWlmICggIXJlbGF0ZWQgfHwgKCByZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyggdGFyZ2V0LCByZWxhdGVkICkgKSApIHsKCQkJCQlldmVudC50eXBlID0gaGFuZGxlT2JqLm9yaWdUeXBlOwoJCQkJCXJldCA9IGhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCQlldmVudC50eXBlID0gZml4OwoJCQkJfQoJCQkJcmV0dXJuIHJldDsKCQkJfQoJCX07Cgl9ICk7CgoJLy8gSUUgc3VibWl0IGRlbGVnYXRpb24KCWlmICggIXN1cHBvcnQuc3VibWl0ICkgewoKCQlqUXVlcnkuZXZlbnQuc3BlY2lhbC5zdWJtaXQgPSB7CgkJCXNldHVwOiBmdW5jdGlvbigpIHsKCgkJCQkvLyBPbmx5IG5lZWQgdGhpcyBmb3IgZGVsZWdhdGVkIGZvcm0gc3VibWl0IGV2ZW50cwoJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJmb3JtIiApICkgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCgkJCQkvLyBMYXp5LWFkZCBhIHN1Ym1pdCBoYW5kbGVyIHdoZW4gYSBkZXNjZW5kYW50IGZvcm0gbWF5IHBvdGVudGlhbGx5IGJlIHN1Ym1pdHRlZAoJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImNsaWNrLl9zdWJtaXQga2V5cHJlc3MuX3N1Ym1pdCIsIGZ1bmN0aW9uKCBlICkgewoKCQkJCQkvLyBOb2RlIG5hbWUgY2hlY2sgYXZvaWRzIGEgVk1MLXJlbGF0ZWQgY3Jhc2ggaW4gSUUgKCM5ODA3KQoJCQkJCXZhciBlbGVtID0gZS50YXJnZXQsCgkJCQkJCWZvcm0gPSBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJpbnB1dCIgKSB8fCBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJidXR0b24iICkgPwoKCQkJCQkJCS8vIFN1cHBvcnQ6IElFIDw9OAoJCQkJCQkJLy8gV2UgdXNlIGpRdWVyeS5wcm9wIGluc3RlYWQgb2YgZWxlbS5mb3JtCgkJCQkJCQkvLyB0byBhbGxvdyBmaXhpbmcgdGhlIElFOCBkZWxlZ2F0ZWQgc3VibWl0IGlzc3VlIChnaC0yMzMyKQoJCQkJCQkJLy8gYnkgM3JkIHBhcnR5IHBvbHlmaWxscy93b3JrYXJvdW5kcy4KCQkJCQkJCWpRdWVyeS5wcm9wKCBlbGVtLCAiZm9ybSIgKSA6CgkJCQkJCQl1bmRlZmluZWQ7CgoJCQkJCWlmICggZm9ybSAmJiAhalF1ZXJ5Ll9kYXRhKCBmb3JtLCAic3VibWl0IiApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBmb3JtLCAic3VibWl0Ll9zdWJtaXQiLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJCQlldmVudC5fc3VibWl0QnViYmxlID0gdHJ1ZTsKCQkJCQkJfSApOwoJCQkJCQlqUXVlcnkuX2RhdGEoIGZvcm0sICJzdWJtaXQiLCB0cnVlICk7CgkJCQkJfQoJCQkJfSApOwoKCQkJCS8vIHJldHVybiB1bmRlZmluZWQgc2luY2Ugd2UgZG9uJ3QgbmVlZCBhbiBldmVudCBsaXN0ZW5lcgoJCQl9LAoKCQkJcG9zdERpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7CgoJCQkJLy8gSWYgZm9ybSB3YXMgc3VibWl0dGVkIGJ5IHRoZSB1c2VyLCBidWJibGUgdGhlIGV2ZW50IHVwIHRoZSB0cmVlCgkJCQlpZiAoIGV2ZW50Ll9zdWJtaXRCdWJibGUgKSB7CgkJCQkJZGVsZXRlIGV2ZW50Ll9zdWJtaXRCdWJibGU7CgkJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCAic3VibWl0IiwgdGhpcy5wYXJlbnROb2RlLCBldmVudCApOwoJCQkJCX0KCQkJCX0KCQkJfSwKCgkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCgkJCQkvLyBPbmx5IG5lZWQgdGhpcyBmb3IgZGVsZWdhdGVkIGZvcm0gc3VibWl0IGV2ZW50cwoJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJmb3JtIiApICkgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCgkJCQkvLyBSZW1vdmUgZGVsZWdhdGVkIGhhbmRsZXJzOyBjbGVhbkRhdGEgZXZlbnR1YWxseSByZWFwcyBzdWJtaXQgaGFuZGxlcnMgYXR0YWNoZWQgYWJvdmUKCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsICIuX3N1Ym1pdCIgKTsKCQkJfQoJCX07Cgl9CgoJLy8gSUUgY2hhbmdlIGRlbGVnYXRpb24gYW5kIGNoZWNrYm94L3JhZGlvIGZpeAoJaWYgKCAhc3VwcG9ydC5jaGFuZ2UgKSB7CgoJCWpRdWVyeS5ldmVudC5zcGVjaWFsLmNoYW5nZSA9IHsKCgkJCXNldHVwOiBmdW5jdGlvbigpIHsKCgkJCQlpZiAoIHJmb3JtRWxlbXMudGVzdCggdGhpcy5ub2RlTmFtZSApICkgewoKCQkJCQkvLyBJRSBkb2Vzbid0IGZpcmUgY2hhbmdlIG9uIGEgY2hlY2svcmFkaW8gdW50aWwgYmx1cjsgdHJpZ2dlciBpdCBvbiBjbGljawoJCQkJCS8vIGFmdGVyIGEgcHJvcGVydHljaGFuZ2UuIEVhdCB0aGUgYmx1ci1jaGFuZ2UgaW4gc3BlY2lhbC5jaGFuZ2UuaGFuZGxlLgoJCQkJCS8vIFRoaXMgc3RpbGwgZmlyZXMgb25jaGFuZ2UgYSBzZWNvbmQgdGltZSBmb3IgY2hlY2svcmFkaW8gYWZ0ZXIgYmx1ci4KCQkJCQlpZiAoIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiB8fCB0aGlzLnR5cGUgPT09ICJyYWRpbyIgKSB7CgkJCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsICJwcm9wZXJ0eWNoYW5nZS5fY2hhbmdlIiwgZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJCQkJaWYgKCBldmVudC5vcmlnaW5hbEV2ZW50LnByb3BlcnR5TmFtZSA9PT0gImNoZWNrZWQiICkgewoJCQkJCQkJCXRoaXMuX2p1c3RDaGFuZ2VkID0gdHJ1ZTsKCQkJCQkJCX0KCQkJCQkJfSApOwoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCB0aGlzLCAiY2xpY2suX2NoYW5nZSIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJCWlmICggdGhpcy5fanVzdENoYW5nZWQgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJCQl0aGlzLl9qdXN0Q2hhbmdlZCA9IGZhbHNlOwoJCQkJCQkJfQoKCQkJCQkJCS8vIEFsbG93IHRyaWdnZXJlZCwgc2ltdWxhdGVkIGNoYW5nZSBldmVudHMgKCMxMTUwMCkKCQkJCQkJCWpRdWVyeS5ldmVudC5zaW11bGF0ZSggImNoYW5nZSIsIHRoaXMsIGV2ZW50ICk7CgkJCQkJCX0gKTsKCQkJCQl9CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoKCQkJCS8vIERlbGVnYXRlZCBldmVudDsgbGF6eS1hZGQgYSBjaGFuZ2UgaGFuZGxlciBvbiBkZXNjZW5kYW50IGlucHV0cwoJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImJlZm9yZWFjdGl2YXRlLl9jaGFuZ2UiLCBmdW5jdGlvbiggZSApIHsKCQkJCQl2YXIgZWxlbSA9IGUudGFyZ2V0OwoKCQkJCQlpZiAoIHJmb3JtRWxlbXMudGVzdCggZWxlbS5ub2RlTmFtZSApICYmICFqUXVlcnkuX2RhdGEoIGVsZW0sICJjaGFuZ2UiICkgKSB7CgkJCQkJCWpRdWVyeS5ldmVudC5hZGQoIGVsZW0sICJjaGFuZ2UuX2NoYW5nZSIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJCWlmICggdGhpcy5wYXJlbnROb2RlICYmICFldmVudC5pc1NpbXVsYXRlZCAmJiAhZXZlbnQuaXNUcmlnZ2VyICkgewoJCQkJCQkJCWpRdWVyeS5ldmVudC5zaW11bGF0ZSggImNoYW5nZSIsIHRoaXMucGFyZW50Tm9kZSwgZXZlbnQgKTsKCQkJCQkJCX0KCQkJCQkJfSApOwoJCQkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJjaGFuZ2UiLCB0cnVlICk7CgkJCQkJfQoJCQkJfSApOwoJCQl9LAoKCQkJaGFuZGxlOiBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQl2YXIgZWxlbSA9IGV2ZW50LnRhcmdldDsKCgkJCQkvLyBTd2FsbG93IG5hdGl2ZSBjaGFuZ2UgZXZlbnRzIGZyb20gY2hlY2tib3gvcmFkaW8sIHdlIGFscmVhZHkgdHJpZ2dlcmVkIHRoZW0gYWJvdmUKCQkJCWlmICggdGhpcyAhPT0gZWxlbSB8fCBldmVudC5pc1NpbXVsYXRlZCB8fCBldmVudC5pc1RyaWdnZXIgfHwKCQkJCQkoIGVsZW0udHlwZSAhPT0gInJhZGlvIiAmJiBlbGVtLnR5cGUgIT09ICJjaGVja2JveCIgKSApIHsKCgkJCQkJcmV0dXJuIGV2ZW50LmhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCX0KCQkJfSwKCgkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsICIuX2NoYW5nZSIgKTsKCgkJCQlyZXR1cm4gIXJmb3JtRWxlbXMudGVzdCggdGhpcy5ub2RlTmFtZSApOwoJCQl9CgkJfTsKCX0KCgkvLyBTdXBwb3J0OiBGaXJlZm94CgkvLyBGaXJlZm94IGRvZXNuJ3QgaGF2ZSBmb2N1cyhpbiB8IG91dCkgZXZlbnRzCgkvLyBSZWxhdGVkIHRpY2tldCAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY4Nzc4NwoJLy8KCS8vIFN1cHBvcnQ6IENocm9tZSwgU2FmYXJpCgkvLyBmb2N1cyhpbiB8IG91dCkgZXZlbnRzIGZpcmUgYWZ0ZXIgZm9jdXMgJiBibHVyIGV2ZW50cywKCS8vIHdoaWNoIGlzIHNwZWMgdmlvbGF0aW9uIC0gaHR0cDovL3d3dy53My5vcmcvVFIvRE9NLUxldmVsLTMtRXZlbnRzLyNldmVudHMtZm9jdXNldmVudC1ldmVudC1vcmRlcgoJLy8gUmVsYXRlZCB0aWNrZXQgLSBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NDQ5ODU3CglpZiAoICFzdXBwb3J0LmZvY3VzaW4gKSB7CgkJalF1ZXJ5LmVhY2goIHsgZm9jdXM6ICJmb2N1c2luIiwgYmx1cjogImZvY3Vzb3V0IiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoKCQkJLy8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIG9uIHRoZSBkb2N1bWVudCB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXQKCQkJdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoIGZpeCwgZXZlbnQudGFyZ2V0LCBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApICk7CgkJCX07CgoJCQlqUXVlcnkuZXZlbnQuc3BlY2lhbFsgZml4IF0gPSB7CgkJCQlzZXR1cDogZnVuY3Rpb24oKSB7CgkJCQkJdmFyIGRvYyA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLAoJCQkJCQlhdHRhY2hlcyA9IGpRdWVyeS5fZGF0YSggZG9jLCBmaXggKTsKCgkJCQkJaWYgKCAhYXR0YWNoZXMgKSB7CgkJCQkJCWRvYy5hZGRFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7CgkJCQkJfQoJCQkJCWpRdWVyeS5fZGF0YSggZG9jLCBmaXgsICggYXR0YWNoZXMgfHwgMCApICsgMSApOwoJCQkJfSwKCQkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCQkJCQl2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsCgkJCQkJCWF0dGFjaGVzID0galF1ZXJ5Ll9kYXRhKCBkb2MsIGZpeCApIC0gMTsKCgkJCQkJaWYgKCAhYXR0YWNoZXMgKSB7CgkJCQkJCWRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7CgkJCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZG9jLCBmaXggKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlqUXVlcnkuX2RhdGEoIGRvYywgZml4LCBhdHRhY2hlcyApOwoJCQkJCX0KCQkJCX0KCQkJfTsKCQl9ICk7Cgl9CgoJalF1ZXJ5LmZuLmV4dGVuZCggewoKCQlvbjogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKSB7CgkJCXJldHVybiBvbiggdGhpcywgdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApOwoJCX0sCgkJb25lOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIG9uKCB0aGlzLCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAxICk7CgkJfSwKCQlvZmY6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGZuICkgewoJCQl2YXIgaGFuZGxlT2JqLCB0eXBlOwoJCQlpZiAoIHR5cGVzICYmIHR5cGVzLnByZXZlbnREZWZhdWx0ICYmIHR5cGVzLmhhbmRsZU9iaiApIHsKCgkJCQkvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50CgkJCQloYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CgkJCQlqUXVlcnkoIHR5cGVzLmRlbGVnYXRlVGFyZ2V0ICkub2ZmKAoJCQkJCWhhbmRsZU9iai5uYW1lc3BhY2UgPwoJCQkJCQloYW5kbGVPYmoub3JpZ1R5cGUgKyAiLiIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDoKCQkJCQkJaGFuZGxlT2JqLm9yaWdUeXBlLAoJCQkJCWhhbmRsZU9iai5zZWxlY3RvciwKCQkJCQloYW5kbGVPYmouaGFuZGxlcgoJCQkJKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCWlmICggdHlwZW9mIHR5cGVzID09PSAib2JqZWN0IiApIHsKCgkJCQkvLyAoIHR5cGVzLW9iamVjdCBbLCBzZWxlY3Rvcl0gKQoJCQkJZm9yICggdHlwZSBpbiB0eXBlcyApIHsKCQkJCQl0aGlzLm9mZiggdHlwZSwgc2VsZWN0b3IsIHR5cGVzWyB0eXBlIF0gKTsKCQkJCX0KCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCWlmICggc2VsZWN0b3IgPT09IGZhbHNlIHx8IHR5cGVvZiBzZWxlY3RvciA9PT0gImZ1bmN0aW9uIiApIHsKCgkJCQkvLyAoIHR5cGVzIFssIGZuXSApCgkJCQlmbiA9IHNlbGVjdG9yOwoJCQkJc2VsZWN0b3IgPSB1bmRlZmluZWQ7CgkJCX0KCQkJaWYgKCBmbiA9PT0gZmFsc2UgKSB7CgkJCQlmbiA9IHJldHVybkZhbHNlOwoJCQl9CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggdGhpcywgdHlwZXMsIGZuLCBzZWxlY3RvciApOwoJCQl9ICk7CgkJfSwKCgkJdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoIHR5cGUsIGRhdGEsIHRoaXMgKTsKCQkJfSApOwoJCX0sCgkJdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgZWxlbSA9IHRoaXNbIDAgXTsKCQkJaWYgKCBlbGVtICkgewoJCQkJcmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCBlbGVtLCB0cnVlICk7CgkJCX0KCQl9Cgl9ICk7CgoKCXZhciByaW5saW5lalF1ZXJ5ID0gLyBqUXVlcnlcZCs9Iig/Om51bGx8XGQrKSIvZywKCQlybm9zaGltY2FjaGUgPSBuZXcgUmVnRXhwKCAiPCg/OiIgKyBub2RlTmFtZXMgKyAiKVtcXHMvPl0iLCAiaSIgKSwKCQlyeGh0bWxUYWcgPSAvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6LV0rKVtePl0qKVwvPi9naSwKCgkJLy8gU3VwcG9ydDogSUUgMTAtMTEsIEVkZ2UgMTAyNDArCgkJLy8gSW4gSUUvRWRnZSB1c2luZyByZWdleCBncm91cHMgaGVyZSBjYXVzZXMgc2V2ZXJlIHNsb3dkb3ducy4KCQkvLyBTZWUgaHR0cHM6Ly9jb25uZWN0Lm1pY3Jvc29mdC5jb20vSUUvZmVlZGJhY2svZGV0YWlscy8xNzM2NTEyLwoJCXJub0lubmVyaHRtbCA9IC88c2NyaXB0fDxzdHlsZXw8bGluay9pLAoKCQkvLyBjaGVja2VkPSJjaGVja2VkIiBvciBjaGVja2VkCgkJcmNoZWNrZWQgPSAvY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSwKCQlyc2NyaXB0VHlwZU1hc2tlZCA9IC9edHJ1ZVwvKC4qKS8sCgkJcmNsZWFuU2NyaXB0ID0gL15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLAoJCXNhZmVGcmFnbWVudCA9IGNyZWF0ZVNhZmVGcmFnbWVudCggZG9jdW1lbnQgKSwKCQlmcmFnbWVudERpdiA9IHNhZmVGcmFnbWVudC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSApOwoKCS8vIFN1cHBvcnQ6IElFPDgKCS8vIE1hbmlwdWxhdGluZyB0YWJsZXMgcmVxdWlyZXMgYSB0Ym9keQoJZnVuY3Rpb24gbWFuaXB1bGF0aW9uVGFyZ2V0KCBlbGVtLCBjb250ZW50ICkgewoJCXJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJ0YWJsZSIgKSAmJgoJCQlqUXVlcnkubm9kZU5hbWUoIGNvbnRlbnQubm9kZVR5cGUgIT09IDExID8gY29udGVudCA6IGNvbnRlbnQuZmlyc3RDaGlsZCwgInRyIiApID8KCgkJCWVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJ0Ym9keSIgKVsgMCBdIHx8CgkJCQllbGVtLmFwcGVuZENoaWxkKCBlbGVtLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCggInRib2R5IiApICkgOgoJCQllbGVtOwoJfQoKCS8vIFJlcGxhY2UvcmVzdG9yZSB0aGUgdHlwZSBhdHRyaWJ1dGUgb2Ygc2NyaXB0IGVsZW1lbnRzIGZvciBzYWZlIERPTSBtYW5pcHVsYXRpb24KCWZ1bmN0aW9uIGRpc2FibGVTY3JpcHQoIGVsZW0gKSB7CgkJZWxlbS50eXBlID0gKCBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCAidHlwZSIgKSAhPT0gbnVsbCApICsgIi8iICsgZWxlbS50eXBlOwoJCXJldHVybiBlbGVtOwoJfQoJZnVuY3Rpb24gcmVzdG9yZVNjcmlwdCggZWxlbSApIHsKCQl2YXIgbWF0Y2ggPSByc2NyaXB0VHlwZU1hc2tlZC5leGVjKCBlbGVtLnR5cGUgKTsKCQlpZiAoIG1hdGNoICkgewoJCQllbGVtLnR5cGUgPSBtYXRjaFsgMSBdOwoJCX0gZWxzZSB7CgkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCAidHlwZSIgKTsKCQl9CgkJcmV0dXJuIGVsZW07Cgl9CgoJZnVuY3Rpb24gY2xvbmVDb3B5RXZlbnQoIHNyYywgZGVzdCApIHsKCQlpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgfHwgIWpRdWVyeS5oYXNEYXRhKCBzcmMgKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIHR5cGUsIGksIGwsCgkJCW9sZERhdGEgPSBqUXVlcnkuX2RhdGEoIHNyYyApLAoJCQljdXJEYXRhID0galF1ZXJ5Ll9kYXRhKCBkZXN0LCBvbGREYXRhICksCgkJCWV2ZW50cyA9IG9sZERhdGEuZXZlbnRzOwoKCQlpZiAoIGV2ZW50cyApIHsKCQkJZGVsZXRlIGN1ckRhdGEuaGFuZGxlOwoJCQljdXJEYXRhLmV2ZW50cyA9IHt9OwoKCQkJZm9yICggdHlwZSBpbiBldmVudHMgKSB7CgkJCQlmb3IgKCBpID0gMCwgbCA9IGV2ZW50c1sgdHlwZSBdLmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBkZXN0LCB0eXBlLCBldmVudHNbIHR5cGUgXVsgaSBdICk7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIG1ha2UgdGhlIGNsb25lZCBwdWJsaWMgZGF0YSBvYmplY3QgYSBjb3B5IGZyb20gdGhlIG9yaWdpbmFsCgkJaWYgKCBjdXJEYXRhLmRhdGEgKSB7CgkJCWN1ckRhdGEuZGF0YSA9IGpRdWVyeS5leHRlbmQoIHt9LCBjdXJEYXRhLmRhdGEgKTsKCQl9Cgl9CgoJZnVuY3Rpb24gZml4Q2xvbmVOb2RlSXNzdWVzKCBzcmMsIGRlc3QgKSB7CgkJdmFyIG5vZGVOYW1lLCBlLCBkYXRhOwoKCQkvLyBXZSBkbyBub3QgbmVlZCB0byBkbyBhbnl0aGluZyBmb3Igbm9uLUVsZW1lbnRzCgkJaWYgKCBkZXN0Lm5vZGVUeXBlICE9PSAxICkgewoJCQlyZXR1cm47CgkJfQoKCQlub2RlTmFtZSA9IGRlc3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCgkJLy8gSUU2LTggY29waWVzIGV2ZW50cyBib3VuZCB2aWEgYXR0YWNoRXZlbnQgd2hlbiB1c2luZyBjbG9uZU5vZGUuCgkJaWYgKCAhc3VwcG9ydC5ub0Nsb25lRXZlbnQgJiYgZGVzdFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJZGF0YSA9IGpRdWVyeS5fZGF0YSggZGVzdCApOwoKCQkJZm9yICggZSBpbiBkYXRhLmV2ZW50cyApIHsKCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZGVzdCwgZSwgZGF0YS5oYW5kbGUgKTsKCQkJfQoKCQkJLy8gRXZlbnQgZGF0YSBnZXRzIHJlZmVyZW5jZWQgaW5zdGVhZCBvZiBjb3BpZWQgaWYgdGhlIGV4cGFuZG8gZ2V0cyBjb3BpZWQgdG9vCgkJCWRlc3QucmVtb3ZlQXR0cmlidXRlKCBqUXVlcnkuZXhwYW5kbyApOwoJCX0KCgkJLy8gSUUgYmxhbmtzIGNvbnRlbnRzIHdoZW4gY2xvbmluZyBzY3JpcHRzLCBhbmQgdHJpZXMgdG8gZXZhbHVhdGUgbmV3bHktc2V0IHRleHQKCQlpZiAoIG5vZGVOYW1lID09PSAic2NyaXB0IiAmJiBkZXN0LnRleHQgIT09IHNyYy50ZXh0ICkgewoJCQlkaXNhYmxlU2NyaXB0KCBkZXN0ICkudGV4dCA9IHNyYy50ZXh0OwoJCQlyZXN0b3JlU2NyaXB0KCBkZXN0ICk7CgoJCS8vIElFNi0xMCBpbXByb3Blcmx5IGNsb25lcyBjaGlsZHJlbiBvZiBvYmplY3QgZWxlbWVudHMgdXNpbmcgY2xhc3NpZC4KCQkvLyBJRTEwIHRocm93cyBOb01vZGlmaWNhdGlvbkFsbG93ZWRFcnJvciBpZiBwYXJlbnQgaXMgbnVsbCwgIzEyMTMyLgoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAib2JqZWN0IiApIHsKCQkJaWYgKCBkZXN0LnBhcmVudE5vZGUgKSB7CgkJCQlkZXN0Lm91dGVySFRNTCA9IHNyYy5vdXRlckhUTUw7CgkJCX0KCgkJCS8vIFRoaXMgcGF0aCBhcHBlYXJzIHVuYXZvaWRhYmxlIGZvciBJRTkuIFdoZW4gY2xvbmluZyBhbiBvYmplY3QKCQkJLy8gZWxlbWVudCBpbiBJRTksIHRoZSBvdXRlckhUTUwgc3RyYXRlZ3kgYWJvdmUgaXMgbm90IHN1ZmZpY2llbnQuCgkJCS8vIElmIHRoZSBzcmMgaGFzIGlubmVySFRNTCBhbmQgdGhlIGRlc3RpbmF0aW9uIGRvZXMgbm90LAoJCQkvLyBjb3B5IHRoZSBzcmMuaW5uZXJIVE1MIGludG8gdGhlIGRlc3QuaW5uZXJIVE1MLiAjMTAzMjQKCQkJaWYgKCBzdXBwb3J0Lmh0bWw1Q2xvbmUgJiYgKCBzcmMuaW5uZXJIVE1MICYmICFqUXVlcnkudHJpbSggZGVzdC5pbm5lckhUTUwgKSApICkgewoJCQkJZGVzdC5pbm5lckhUTUwgPSBzcmMuaW5uZXJIVE1MOwoJCQl9CgoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAiaW5wdXQiICYmIHJjaGVja2FibGVUeXBlLnRlc3QoIHNyYy50eXBlICkgKSB7CgoJCQkvLyBJRTYtOCBmYWlscyB0byBwZXJzaXN0IHRoZSBjaGVja2VkIHN0YXRlIG9mIGEgY2xvbmVkIGNoZWNrYm94CgkJCS8vIG9yIHJhZGlvIGJ1dHRvbi4gV29yc2UsIElFNi03IGZhaWwgdG8gZ2l2ZSB0aGUgY2xvbmVkIGVsZW1lbnQKCQkJLy8gYSBjaGVja2VkIGFwcGVhcmFuY2UgaWYgdGhlIGRlZmF1bHRDaGVja2VkIHZhbHVlIGlzbid0IGFsc28gc2V0CgoJCQlkZXN0LmRlZmF1bHRDaGVja2VkID0gZGVzdC5jaGVja2VkID0gc3JjLmNoZWNrZWQ7CgoJCQkvLyBJRTYtNyBnZXQgY29uZnVzZWQgYW5kIGVuZCB1cCBzZXR0aW5nIHRoZSB2YWx1ZSBvZiBhIGNsb25lZAoJCQkvLyBjaGVja2JveC9yYWRpbyBidXR0b24gdG8gYW4gZW1wdHkgc3RyaW5nIGluc3RlYWQgb2YgIm9uIgoJCQlpZiAoIGRlc3QudmFsdWUgIT09IHNyYy52YWx1ZSApIHsKCQkJCWRlc3QudmFsdWUgPSBzcmMudmFsdWU7CgkJCX0KCgkJLy8gSUU2LTggZmFpbHMgdG8gcmV0dXJuIHRoZSBzZWxlY3RlZCBvcHRpb24gdG8gdGhlIGRlZmF1bHQgc2VsZWN0ZWQKCQkvLyBzdGF0ZSB3aGVuIGNsb25pbmcgb3B0aW9ucwoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAib3B0aW9uIiApIHsKCQkJZGVzdC5kZWZhdWx0U2VsZWN0ZWQgPSBkZXN0LnNlbGVjdGVkID0gc3JjLmRlZmF1bHRTZWxlY3RlZDsKCgkJLy8gSUU2LTggZmFpbHMgdG8gc2V0IHRoZSBkZWZhdWx0VmFsdWUgdG8gdGhlIGNvcnJlY3QgdmFsdWUgd2hlbgoJCS8vIGNsb25pbmcgb3RoZXIgdHlwZXMgb2YgaW5wdXQgZmllbGRzCgkJfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJpbnB1dCIgfHwgbm9kZU5hbWUgPT09ICJ0ZXh0YXJlYSIgKSB7CgkJCWRlc3QuZGVmYXVsdFZhbHVlID0gc3JjLmRlZmF1bHRWYWx1ZTsKCQl9Cgl9CgoJZnVuY3Rpb24gZG9tTWFuaXAoIGNvbGxlY3Rpb24sIGFyZ3MsIGNhbGxiYWNrLCBpZ25vcmVkICkgewoKCQkvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCgkJYXJncyA9IGNvbmNhdC5hcHBseSggW10sIGFyZ3MgKTsKCgkJdmFyIGZpcnN0LCBub2RlLCBoYXNTY3JpcHRzLAoJCQlzY3JpcHRzLCBkb2MsIGZyYWdtZW50LAoJCQlpID0gMCwKCQkJbCA9IGNvbGxlY3Rpb24ubGVuZ3RoLAoJCQlpTm9DbG9uZSA9IGwgLSAxLAoJCQl2YWx1ZSA9IGFyZ3NbIDAgXSwKCQkJaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApOwoKCQkvLyBXZSBjYW4ndCBjbG9uZU5vZGUgZnJhZ21lbnRzIHRoYXQgY29udGFpbiBjaGVja2VkLCBpbiBXZWJLaXQKCQlpZiAoIGlzRnVuY3Rpb24gfHwKCQkJCSggbCA+IDEgJiYgdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiAmJgoJCQkJCSFzdXBwb3J0LmNoZWNrQ2xvbmUgJiYgcmNoZWNrZWQudGVzdCggdmFsdWUgKSApICkgewoJCQlyZXR1cm4gY29sbGVjdGlvbi5lYWNoKCBmdW5jdGlvbiggaW5kZXggKSB7CgkJCQl2YXIgc2VsZiA9IGNvbGxlY3Rpb24uZXEoIGluZGV4ICk7CgkJCQlpZiAoIGlzRnVuY3Rpb24gKSB7CgkJCQkJYXJnc1sgMCBdID0gdmFsdWUuY2FsbCggdGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpICk7CgkJCQl9CgkJCQlkb21NYW5pcCggc2VsZiwgYXJncywgY2FsbGJhY2ssIGlnbm9yZWQgKTsKCQkJfSApOwoJCX0KCgkJaWYgKCBsICkgewoJCQlmcmFnbWVudCA9IGJ1aWxkRnJhZ21lbnQoIGFyZ3MsIGNvbGxlY3Rpb25bIDAgXS5vd25lckRvY3VtZW50LCBmYWxzZSwgY29sbGVjdGlvbiwgaWdub3JlZCApOwoJCQlmaXJzdCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7CgoJCQlpZiAoIGZyYWdtZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICkgewoJCQkJZnJhZ21lbnQgPSBmaXJzdDsKCQkJfQoKCQkJLy8gUmVxdWlyZSBlaXRoZXIgbmV3IGNvbnRlbnQgb3IgYW4gaW50ZXJlc3QgaW4gaWdub3JlZCBlbGVtZW50cyB0byBpbnZva2UgdGhlIGNhbGxiYWNrCgkJCWlmICggZmlyc3QgfHwgaWdub3JlZCApIHsKCQkJCXNjcmlwdHMgPSBqUXVlcnkubWFwKCBnZXRBbGwoIGZyYWdtZW50LCAic2NyaXB0IiApLCBkaXNhYmxlU2NyaXB0ICk7CgkJCQloYXNTY3JpcHRzID0gc2NyaXB0cy5sZW5ndGg7CgoJCQkJLy8gVXNlIHRoZSBvcmlnaW5hbCBmcmFnbWVudCBmb3IgdGhlIGxhc3QgaXRlbQoJCQkJLy8gaW5zdGVhZCBvZiB0aGUgZmlyc3QgYmVjYXVzZSBpdCBjYW4gZW5kIHVwCgkJCQkvLyBiZWluZyBlbXB0aWVkIGluY29ycmVjdGx5IGluIGNlcnRhaW4gc2l0dWF0aW9ucyAoIzgwNzApLgoJCQkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQkJCW5vZGUgPSBmcmFnbWVudDsKCgkJCQkJaWYgKCBpICE9PSBpTm9DbG9uZSApIHsKCQkJCQkJbm9kZSA9IGpRdWVyeS5jbG9uZSggbm9kZSwgdHJ1ZSwgdHJ1ZSApOwoKCQkJCQkJLy8gS2VlcCByZWZlcmVuY2VzIHRvIGNsb25lZCBzY3JpcHRzIGZvciBsYXRlciByZXN0b3JhdGlvbgoJCQkJCQlpZiAoIGhhc1NjcmlwdHMgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIFBoYW50b21KUzwyCgkJCQkJCQkvLyBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzIG9uIGFuY2llbnQgV2ViS2l0CgkJCQkJCQlqUXVlcnkubWVyZ2UoIHNjcmlwdHMsIGdldEFsbCggbm9kZSwgInNjcmlwdCIgKSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQljYWxsYmFjay5jYWxsKCBjb2xsZWN0aW9uWyBpIF0sIG5vZGUsIGkgKTsKCQkJCX0KCgkJCQlpZiAoIGhhc1NjcmlwdHMgKSB7CgkJCQkJZG9jID0gc2NyaXB0c1sgc2NyaXB0cy5sZW5ndGggLSAxIF0ub3duZXJEb2N1bWVudDsKCgkJCQkJLy8gUmVlbmFibGUgc2NyaXB0cwoJCQkJCWpRdWVyeS5tYXAoIHNjcmlwdHMsIHJlc3RvcmVTY3JpcHQgKTsKCgkJCQkJLy8gRXZhbHVhdGUgZXhlY3V0YWJsZSBzY3JpcHRzIG9uIGZpcnN0IGRvY3VtZW50IGluc2VydGlvbgoJCQkJCWZvciAoIGkgPSAwOyBpIDwgaGFzU2NyaXB0czsgaSsrICkgewoJCQkJCQlub2RlID0gc2NyaXB0c1sgaSBdOwoJCQkJCQlpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIG5vZGUudHlwZSB8fCAiIiApICYmCgkJCQkJCQkhalF1ZXJ5Ll9kYXRhKCBub2RlLCAiZ2xvYmFsRXZhbCIgKSAmJgoJCQkJCQkJalF1ZXJ5LmNvbnRhaW5zKCBkb2MsIG5vZGUgKSApIHsKCgkJCQkJCQlpZiAoIG5vZGUuc3JjICkgewoKCQkJCQkJCQkvLyBPcHRpb25hbCBBSkFYIGRlcGVuZGVuY3ksIGJ1dCB3b24ndCBydW4gc2NyaXB0cyBpZiBub3QgcHJlc2VudAoJCQkJCQkJCWlmICggalF1ZXJ5Ll9ldmFsVXJsICkgewoJCQkJCQkJCQlqUXVlcnkuX2V2YWxVcmwoIG5vZGUuc3JjICk7CgkJCQkJCQkJfQoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlqUXVlcnkuZ2xvYmFsRXZhbCgKCQkJCQkJCQkJKCBub2RlLnRleHQgfHwgbm9kZS50ZXh0Q29udGVudCB8fCBub2RlLmlubmVySFRNTCB8fCAiIiApCgkJCQkJCQkJCQkucmVwbGFjZSggcmNsZWFuU2NyaXB0LCAiIiApCgkJCQkJCQkJKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBGaXggIzExODA5OiBBdm9pZCBsZWFraW5nIG1lbW9yeQoJCQkJZnJhZ21lbnQgPSBmaXJzdCA9IG51bGw7CgkJCX0KCQl9CgoJCXJldHVybiBjb2xsZWN0aW9uOwoJfQoKCWZ1bmN0aW9uIHJlbW92ZSggZWxlbSwgc2VsZWN0b3IsIGtlZXBEYXRhICkgewoJCXZhciBub2RlLAoJCQllbGVtcyA9IHNlbGVjdG9yID8galF1ZXJ5LmZpbHRlciggc2VsZWN0b3IsIGVsZW0gKSA6IGVsZW0sCgkJCWkgPSAwOwoKCQlmb3IgKCA7ICggbm9kZSA9IGVsZW1zWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgoJCQlpZiAoICFrZWVwRGF0YSAmJiBub2RlLm5vZGVUeXBlID09PSAxICkgewoJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBub2RlICkgKTsKCQkJfQoKCQkJaWYgKCBub2RlLnBhcmVudE5vZGUgKSB7CgkJCQlpZiAoIGtlZXBEYXRhICYmIGpRdWVyeS5jb250YWlucyggbm9kZS5vd25lckRvY3VtZW50LCBub2RlICkgKSB7CgkJCQkJc2V0R2xvYmFsRXZhbCggZ2V0QWxsKCBub2RlLCAic2NyaXB0IiApICk7CgkJCQl9CgkJCQlub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5vZGUgKTsKCQkJfQoJCX0KCgkJcmV0dXJuIGVsZW07Cgl9CgoJalF1ZXJ5LmV4dGVuZCggewoJCWh0bWxQcmVmaWx0ZXI6IGZ1bmN0aW9uKCBodG1sICkgewoJCQlyZXR1cm4gaHRtbC5yZXBsYWNlKCByeGh0bWxUYWcsICI8JDE+PC8kMj4iICk7CgkJfSwKCgkJY2xvbmU6IGZ1bmN0aW9uKCBlbGVtLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApIHsKCQkJdmFyIGRlc3RFbGVtZW50cywgbm9kZSwgY2xvbmUsIGksIHNyY0VsZW1lbnRzLAoJCQkJaW5QYWdlID0galF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCgkJCWlmICggc3VwcG9ydC5odG1sNUNsb25lIHx8IGpRdWVyeS5pc1hNTERvYyggZWxlbSApIHx8CgkJCQkhcm5vc2hpbWNhY2hlLnRlc3QoICI8IiArIGVsZW0ubm9kZU5hbWUgKyAiPiIgKSApIHsKCgkJCQljbG9uZSA9IGVsZW0uY2xvbmVOb2RlKCB0cnVlICk7CgoJCQkvLyBJRTw9OCBkb2VzIG5vdCBwcm9wZXJseSBjbG9uZSBkZXRhY2hlZCwgdW5rbm93biBlbGVtZW50IG5vZGVzCgkJCX0gZWxzZSB7CgkJCQlmcmFnbWVudERpdi5pbm5lckhUTUwgPSBlbGVtLm91dGVySFRNTDsKCQkJCWZyYWdtZW50RGl2LnJlbW92ZUNoaWxkKCBjbG9uZSA9IGZyYWdtZW50RGl2LmZpcnN0Q2hpbGQgKTsKCQkJfQoKCQkJaWYgKCAoICFzdXBwb3J0Lm5vQ2xvbmVFdmVudCB8fCAhc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCApICYmCgkJCQkJKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGVsZW0ubm9kZVR5cGUgPT09IDExICkgJiYgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApICkgewoKCQkJCS8vIFdlIGVzY2hldyBTaXp6bGUgaGVyZSBmb3IgcGVyZm9ybWFuY2UgcmVhc29uczogaHR0cDovL2pzcGVyZi5jb20vZ2V0YWxsLXZzLXNpenpsZS8yCgkJCQlkZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lICk7CgkJCQlzcmNFbGVtZW50cyA9IGdldEFsbCggZWxlbSApOwoKCQkJCS8vIEZpeCBhbGwgSUUgY2xvbmluZyBpc3N1ZXMKCQkJCWZvciAoIGkgPSAwOyAoIG5vZGUgPSBzcmNFbGVtZW50c1sgaSBdICkgIT0gbnVsbDsgKytpICkgewoKCQkJCQkvLyBFbnN1cmUgdGhhdCB0aGUgZGVzdGluYXRpb24gbm9kZSBpcyBub3QgbnVsbDsgRml4ZXMgIzk1ODcKCQkJCQlpZiAoIGRlc3RFbGVtZW50c1sgaSBdICkgewoJCQkJCQlmaXhDbG9uZU5vZGVJc3N1ZXMoIG5vZGUsIGRlc3RFbGVtZW50c1sgaSBdICk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBDb3B5IHRoZSBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgdG8gdGhlIGNsb25lCgkJCWlmICggZGF0YUFuZEV2ZW50cyApIHsKCQkJCWlmICggZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJCQkJc3JjRWxlbWVudHMgPSBzcmNFbGVtZW50cyB8fCBnZXRBbGwoIGVsZW0gKTsKCQkJCQlkZXN0RWxlbWVudHMgPSBkZXN0RWxlbWVudHMgfHwgZ2V0QWxsKCBjbG9uZSApOwoKCQkJCQlmb3IgKCBpID0gMDsgKCBub2RlID0gc3JjRWxlbWVudHNbIGkgXSApICE9IG51bGw7IGkrKyApIHsKCQkJCQkJY2xvbmVDb3B5RXZlbnQoIG5vZGUsIGRlc3RFbGVtZW50c1sgaSBdICk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQljbG9uZUNvcHlFdmVudCggZWxlbSwgY2xvbmUgKTsKCQkJCX0KCQkJfQoKCQkJLy8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeQoJCQlkZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lLCAic2NyaXB0IiApOwoJCQlpZiAoIGRlc3RFbGVtZW50cy5sZW5ndGggPiAwICkgewoJCQkJc2V0R2xvYmFsRXZhbCggZGVzdEVsZW1lbnRzLCAhaW5QYWdlICYmIGdldEFsbCggZWxlbSwgInNjcmlwdCIgKSApOwoJCQl9CgoJCQlkZXN0RWxlbWVudHMgPSBzcmNFbGVtZW50cyA9IG5vZGUgPSBudWxsOwoKCQkJLy8gUmV0dXJuIHRoZSBjbG9uZWQgc2V0CgkJCXJldHVybiBjbG9uZTsKCQl9LAoKCQljbGVhbkRhdGE6IGZ1bmN0aW9uKCBlbGVtcywgLyogaW50ZXJuYWwgKi8gZm9yY2VBY2NlcHREYXRhICkgewoJCQl2YXIgZWxlbSwgdHlwZSwgaWQsIGRhdGEsCgkJCQlpID0gMCwKCQkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgkJCQljYWNoZSA9IGpRdWVyeS5jYWNoZSwKCQkJCWF0dHJpYnV0ZXMgPSBzdXBwb3J0LmF0dHJpYnV0ZXMsCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWw7CgoJCQlmb3IgKCA7ICggZWxlbSA9IGVsZW1zWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgkJCQlpZiAoIGZvcmNlQWNjZXB0RGF0YSB8fCBhY2NlcHREYXRhKCBlbGVtICkgKSB7CgoJCQkJCWlkID0gZWxlbVsgaW50ZXJuYWxLZXkgXTsKCQkJCQlkYXRhID0gaWQgJiYgY2FjaGVbIGlkIF07CgoJCQkJCWlmICggZGF0YSApIHsKCQkJCQkJaWYgKCBkYXRhLmV2ZW50cyApIHsKCQkJCQkJCWZvciAoIHR5cGUgaW4gZGF0YS5ldmVudHMgKSB7CgkJCQkJCQkJaWYgKCBzcGVjaWFsWyB0eXBlIF0gKSB7CgkJCQkJCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIGVsZW0sIHR5cGUgKTsKCgkJCQkJCQkJLy8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1vdmUncyBvdmVyaGVhZAoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUgKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIFJlbW92ZSBjYWNoZSBvbmx5IGlmIGl0IHdhcyBub3QgYWxyZWFkeSByZW1vdmVkIGJ5IGpRdWVyeS5ldmVudC5yZW1vdmUKCQkJCQkJaWYgKCBjYWNoZVsgaWQgXSApIHsKCgkJCQkJCQlkZWxldGUgY2FjaGVbIGlkIF07CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSUUgZG9lcyBub3QgYWxsb3cgdXMgdG8gZGVsZXRlIGV4cGFuZG8gcHJvcGVydGllcyBmcm9tIG5vZGVzCgkJCQkJCQkvLyBJRSBjcmVhdGVzIGV4cGFuZG8gYXR0cmlidXRlcyBhbG9uZyB3aXRoIHRoZSBwcm9wZXJ0eQoJCQkJCQkJLy8gSUUgZG9lcyBub3QgaGF2ZSBhIHJlbW92ZUF0dHJpYnV0ZSBmdW5jdGlvbiBvbiBEb2N1bWVudCBub2RlcwoJCQkJCQkJaWYgKCAhYXR0cmlidXRlcyAmJiB0eXBlb2YgZWxlbS5yZW1vdmVBdHRyaWJ1dGUgIT09ICJ1bmRlZmluZWQiICkgewoJCQkJCQkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCBpbnRlcm5hbEtleSApOwoKCQkJCQkJCS8vIFdlYmtpdCAmIEJsaW5rIHBlcmZvcm1hbmNlIHN1ZmZlcnMgd2hlbiBkZWxldGluZyBwcm9wZXJ0aWVzCgkJCQkJCQkvLyBmcm9tIERPTSBub2Rlcywgc28gc2V0IHRvIHVuZGVmaW5lZCBpbnN0ZWFkCgkJCQkJCQkvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9Mzc4NjA3CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCWVsZW1bIGludGVybmFsS2V5IF0gPSB1bmRlZmluZWQ7CgkJCQkJCQl9CgoJCQkJCQkJZGVsZXRlZElkcy5wdXNoKCBpZCApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfSApOwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCgkJLy8gS2VlcCBkb21NYW5pcCBleHBvc2VkIHVudGlsIDMuMCAoZ2gtMjIyNSkKCQlkb21NYW5pcDogZG9tTWFuaXAsCgoJCWRldGFjaDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gcmVtb3ZlKCB0aGlzLCBzZWxlY3RvciwgdHJ1ZSApOwoJCX0sCgoJCXJlbW92ZTogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gcmVtb3ZlKCB0aGlzLCBzZWxlY3RvciApOwoJCX0sCgoJCXRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPwoJCQkJCWpRdWVyeS50ZXh0KCB0aGlzICkgOgoJCQkJCXRoaXMuZW1wdHkoKS5hcHBlbmQoCgkJCQkJCSggdGhpc1sgMCBdICYmIHRoaXNbIDAgXS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50ICkuY3JlYXRlVGV4dE5vZGUoIHZhbHVlICkKCQkJCQkpOwoJCQl9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCApOwoJCX0sCgoJCWFwcGVuZDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBkb21NYW5pcCggdGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkgewoJCQkJCXZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTsKCQkJCQl0YXJnZXQuYXBwZW5kQ2hpbGQoIGVsZW0gKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCXByZXBlbmQ6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gZG9tTWFuaXAoIHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHsKCQkJCQl2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KCB0aGlzLCBlbGVtICk7CgkJCQkJdGFyZ2V0Lmluc2VydEJlZm9yZSggZWxlbSwgdGFyZ2V0LmZpcnN0Q2hpbGQgKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCWJlZm9yZTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBkb21NYW5pcCggdGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5wYXJlbnROb2RlICkgewoJCQkJCXRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMgKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCWFmdGVyOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIGRvbU1hbmlwKCB0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgKSB7CgkJCQkJdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggZWxlbSwgdGhpcy5uZXh0U2libGluZyApOwoJCQkJfQoJCQl9ICk7CgkJfSwKCgkJZW1wdHk6IGZ1bmN0aW9uKCkgewoJCQl2YXIgZWxlbSwKCQkJCWkgPSAwOwoKCQkJZm9yICggOyAoIGVsZW0gPSB0aGlzWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgoJCQkJLy8gUmVtb3ZlIGVsZW1lbnQgbm9kZXMgYW5kIHByZXZlbnQgbWVtb3J5IGxlYWtzCgkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGFueSByZW1haW5pbmcgbm9kZXMKCQkJCXdoaWxlICggZWxlbS5maXJzdENoaWxkICkgewoJCQkJCWVsZW0ucmVtb3ZlQ2hpbGQoIGVsZW0uZmlyc3RDaGlsZCApOwoJCQkJfQoKCQkJCS8vIElmIHRoaXMgaXMgYSBzZWxlY3QsIGVuc3VyZSB0aGF0IGl0IGRpc3BsYXlzIGVtcHR5ICgjMTIzMzYpCgkJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCQlpZiAoIGVsZW0ub3B0aW9ucyAmJiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJzZWxlY3QiICkgKSB7CgkJCQkJZWxlbS5vcHRpb25zLmxlbmd0aCA9IDA7CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCWNsb25lOiBmdW5jdGlvbiggZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJCWRhdGFBbmRFdmVudHMgPSBkYXRhQW5kRXZlbnRzID09IG51bGwgPyBmYWxzZSA6IGRhdGFBbmRFdmVudHM7CgkJCWRlZXBEYXRhQW5kRXZlbnRzID0gZGVlcERhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGRhdGFBbmRFdmVudHMgOiBkZWVwRGF0YUFuZEV2ZW50czsKCgkJCXJldHVybiB0aGlzLm1hcCggZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4galF1ZXJ5LmNsb25lKCB0aGlzLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApOwoJCQl9ICk7CgkJfSwKCgkJaHRtbDogZnVuY3Rpb24oIHZhbHVlICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQl2YXIgZWxlbSA9IHRoaXNbIDAgXSB8fCB7fSwKCQkJCQlpID0gMCwKCQkJCQlsID0gdGhpcy5sZW5ndGg7CgoJCQkJaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiBlbGVtLm5vZGVUeXBlID09PSAxID8KCQkJCQkJZWxlbS5pbm5lckhUTUwucmVwbGFjZSggcmlubGluZWpRdWVyeSwgIiIgKSA6CgkJCQkJCXVuZGVmaW5lZDsKCQkJCX0KCgkJCQkvLyBTZWUgaWYgd2UgY2FuIHRha2UgYSBzaG9ydGN1dCBhbmQganVzdCB1c2UgaW5uZXJIVE1MCgkJCQlpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgIXJub0lubmVyaHRtbC50ZXN0KCB2YWx1ZSApICYmCgkJCQkJKCBzdXBwb3J0Lmh0bWxTZXJpYWxpemUgfHwgIXJub3NoaW1jYWNoZS50ZXN0KCB2YWx1ZSApICApICYmCgkJCQkJKCBzdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlIHx8ICFybGVhZGluZ1doaXRlc3BhY2UudGVzdCggdmFsdWUgKSApICYmCgkJCQkJIXdyYXBNYXBbICggcnRhZ05hbWUuZXhlYyggdmFsdWUgKSB8fCBbICIiLCAiIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpIF0gKSB7CgoJCQkJCXZhbHVlID0galF1ZXJ5Lmh0bWxQcmVmaWx0ZXIoIHZhbHVlICk7CgoJCQkJCXRyeSB7CgkJCQkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCgkJCQkJCQkvLyBSZW1vdmUgZWxlbWVudCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3MKCQkJCQkJCWVsZW0gPSB0aGlzWyBpIF0gfHwge307CgkJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgkJCQkJCQkJZWxlbS5pbm5lckhUTUwgPSB2YWx1ZTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJZWxlbSA9IDA7CgoJCQkJCS8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJvd3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZAoJCQkJCX0gY2F0Y2ggKCBlICkge30KCQkJCX0KCgkJCQlpZiAoIGVsZW0gKSB7CgkJCQkJdGhpcy5lbXB0eSgpLmFwcGVuZCggdmFsdWUgKTsKCQkJCX0KCQkJfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggKTsKCQl9LAoKCQlyZXBsYWNlV2l0aDogZnVuY3Rpb24oKSB7CgkJCXZhciBpZ25vcmVkID0gW107CgoJCQkvLyBNYWtlIHRoZSBjaGFuZ2VzLCByZXBsYWNpbmcgZWFjaCBub24taWdub3JlZCBjb250ZXh0IGVsZW1lbnQgd2l0aCB0aGUgbmV3IGNvbnRlbnQKCQkJcmV0dXJuIGRvbU1hbmlwKCB0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTsKCgkJCQlpZiAoIGpRdWVyeS5pbkFycmF5KCB0aGlzLCBpZ25vcmVkICkgPCAwICkgewoJCQkJCWpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggdGhpcyApICk7CgkJCQkJaWYgKCBwYXJlbnQgKSB7CgkJCQkJCXBhcmVudC5yZXBsYWNlQ2hpbGQoIGVsZW0sIHRoaXMgKTsKCQkJCQl9CgkJCQl9CgoJCQkvLyBGb3JjZSBjYWxsYmFjayBpbnZvY2F0aW9uCgkJCX0sIGlnbm9yZWQgKTsKCQl9Cgl9ICk7CgoJalF1ZXJ5LmVhY2goIHsKCQlhcHBlbmRUbzogImFwcGVuZCIsCgkJcHJlcGVuZFRvOiAicHJlcGVuZCIsCgkJaW5zZXJ0QmVmb3JlOiAiYmVmb3JlIiwKCQlpbnNlcnRBZnRlcjogImFmdGVyIiwKCQlyZXBsYWNlQWxsOiAicmVwbGFjZVdpdGgiCgl9LCBmdW5jdGlvbiggbmFtZSwgb3JpZ2luYWwgKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBlbGVtcywKCQkJCWkgPSAwLAoJCQkJcmV0ID0gW10sCgkJCQlpbnNlcnQgPSBqUXVlcnkoIHNlbGVjdG9yICksCgkJCQlsYXN0ID0gaW5zZXJ0Lmxlbmd0aCAtIDE7CgoJCQlmb3IgKCA7IGkgPD0gbGFzdDsgaSsrICkgewoJCQkJZWxlbXMgPSBpID09PSBsYXN0ID8gdGhpcyA6IHRoaXMuY2xvbmUoIHRydWUgKTsKCQkJCWpRdWVyeSggaW5zZXJ0WyBpIF0gKVsgb3JpZ2luYWwgXSggZWxlbXMgKTsKCgkJCQkvLyBNb2Rlcm4gYnJvd3NlcnMgY2FuIGFwcGx5IGpRdWVyeSBjb2xsZWN0aW9ucyBhcyBhcnJheXMsIGJ1dCBvbGRJRSBuZWVkcyBhIC5nZXQoKQoJCQkJcHVzaC5hcHBseSggcmV0LCBlbGVtcy5nZXQoKSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHJldCApOwoJCX07Cgl9ICk7CgoKCXZhciBpZnJhbWUsCgkJZWxlbWRpc3BsYXkgPSB7CgoJCQkvLyBTdXBwb3J0OiBGaXJlZm94CgkJCS8vIFdlIGhhdmUgdG8gcHJlLWRlZmluZSB0aGVzZSB2YWx1ZXMgZm9yIEZGICgjMTAyMjcpCgkJCUhUTUw6ICJibG9jayIsCgkJCUJPRFk6ICJibG9jayIKCQl9OwoKCS8qKgoJICogUmV0cmlldmUgdGhlIGFjdHVhbCBkaXNwbGF5IG9mIGEgZWxlbWVudAoJICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgbm9kZU5hbWUgb2YgdGhlIGVsZW1lbnQKCSAqIEBwYXJhbSB7T2JqZWN0fSBkb2MgRG9jdW1lbnQgb2JqZWN0CgkgKi8KCgkvLyBDYWxsZWQgb25seSBmcm9tIHdpdGhpbiBkZWZhdWx0RGlzcGxheQoJZnVuY3Rpb24gYWN0dWFsRGlzcGxheSggbmFtZSwgZG9jICkgewoJCXZhciBlbGVtID0galF1ZXJ5KCBkb2MuY3JlYXRlRWxlbWVudCggbmFtZSApICkuYXBwZW5kVG8oIGRvYy5ib2R5ICksCgoJCQlkaXNwbGF5ID0galF1ZXJ5LmNzcyggZWxlbVsgMCBdLCAiZGlzcGxheSIgKTsKCgkJLy8gV2UgZG9uJ3QgaGF2ZSBhbnkgZGF0YSBzdG9yZWQgb24gdGhlIGVsZW1lbnQsCgkJLy8gc28gdXNlICJkZXRhY2giIG1ldGhvZCBhcyBmYXN0IHdheSB0byBnZXQgcmlkIG9mIHRoZSBlbGVtZW50CgkJZWxlbS5kZXRhY2goKTsKCgkJcmV0dXJuIGRpc3BsYXk7Cgl9CgoJLyoqCgkgKiBUcnkgdG8gZGV0ZXJtaW5lIHRoZSBkZWZhdWx0IGRpc3BsYXkgdmFsdWUgb2YgYW4gZWxlbWVudAoJICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lCgkgKi8KCWZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KCBub2RlTmFtZSApIHsKCQl2YXIgZG9jID0gZG9jdW1lbnQsCgkJCWRpc3BsYXkgPSBlbGVtZGlzcGxheVsgbm9kZU5hbWUgXTsKCgkJaWYgKCAhZGlzcGxheSApIHsKCQkJZGlzcGxheSA9IGFjdHVhbERpc3BsYXkoIG5vZGVOYW1lLCBkb2MgKTsKCgkJCS8vIElmIHRoZSBzaW1wbGUgd2F5IGZhaWxzLCByZWFkIGZyb20gaW5zaWRlIGFuIGlmcmFtZQoJCQlpZiAoIGRpc3BsYXkgPT09ICJub25lIiB8fCAhZGlzcGxheSApIHsKCgkJCQkvLyBVc2UgdGhlIGFscmVhZHktY3JlYXRlZCBpZnJhbWUgaWYgcG9zc2libGUKCQkJCWlmcmFtZSA9ICggaWZyYW1lIHx8IGpRdWVyeSggIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz4iICkgKQoJCQkJCS5hcHBlbmRUbyggZG9jLmRvY3VtZW50RWxlbWVudCApOwoKCQkJCS8vIEFsd2F5cyB3cml0ZSBhIG5ldyBIVE1MIHNrZWxldG9uIHNvIFdlYmtpdCBhbmQgRmlyZWZveCBkb24ndCBjaG9rZSBvbiByZXVzZQoJCQkJZG9jID0gKCBpZnJhbWVbIDAgXS5jb250ZW50V2luZG93IHx8IGlmcmFtZVsgMCBdLmNvbnRlbnREb2N1bWVudCApLmRvY3VtZW50OwoKCQkJCS8vIFN1cHBvcnQ6IElFCgkJCQlkb2Mud3JpdGUoKTsKCQkJCWRvYy5jbG9zZSgpOwoKCQkJCWRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7CgkJCQlpZnJhbWUuZGV0YWNoKCk7CgkJCX0KCgkJCS8vIFN0b3JlIHRoZSBjb3JyZWN0IGRlZmF1bHQgZGlzcGxheQoJCQllbGVtZGlzcGxheVsgbm9kZU5hbWUgXSA9IGRpc3BsYXk7CgkJfQoKCQlyZXR1cm4gZGlzcGxheTsKCX0KCXZhciBybWFyZ2luID0gKCAvXm1hcmdpbi8gKTsKCgl2YXIgcm51bW5vbnB4ID0gbmV3IFJlZ0V4cCggIl4oIiArIHBudW0gKyAiKSg/IXB4KVthLXolXSskIiwgImkiICk7CgoJdmFyIHN3YXAgPSBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgY2FsbGJhY2ssIGFyZ3MgKSB7CgkJdmFyIHJldCwgbmFtZSwKCQkJb2xkID0ge307CgoJCS8vIFJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzLCBhbmQgaW5zZXJ0IHRoZSBuZXcgb25lcwoJCWZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHsKCQkJb2xkWyBuYW1lIF0gPSBlbGVtLnN0eWxlWyBuYW1lIF07CgkJCWVsZW0uc3R5bGVbIG5hbWUgXSA9IG9wdGlvbnNbIG5hbWUgXTsKCQl9CgoJCXJldCA9IGNhbGxiYWNrLmFwcGx5KCBlbGVtLCBhcmdzIHx8IFtdICk7CgoJCS8vIFJldmVydCB0aGUgb2xkIHZhbHVlcwoJCWZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHsKCQkJZWxlbS5zdHlsZVsgbmFtZSBdID0gb2xkWyBuYW1lIF07CgkJfQoKCQlyZXR1cm4gcmV0OwoJfTsKCgoJdmFyIGRvY3VtZW50RWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgoKCSggZnVuY3Rpb24oKSB7CgkJdmFyIHBpeGVsUG9zaXRpb25WYWwsIHBpeGVsTWFyZ2luUmlnaHRWYWwsIGJveFNpemluZ1JlbGlhYmxlVmFsLAoJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwsIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwsIHJlbGlhYmxlTWFyZ2luTGVmdFZhbCwKCQkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkJLy8gRmluaXNoIGVhcmx5IGluIGxpbWl0ZWQgKG5vbi1icm93c2VyKSBlbnZpcm9ubWVudHMKCQlpZiAoICFkaXYuc3R5bGUgKSB7CgkJCXJldHVybjsKCQl9CgoJCWRpdi5zdHlsZS5jc3NUZXh0ID0gImZsb2F0OmxlZnQ7b3BhY2l0eTouNSI7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQkvLyBNYWtlIHN1cmUgdGhhdCBlbGVtZW50IG9wYWNpdHkgZXhpc3RzIChhcyBvcHBvc2VkIHRvIGZpbHRlcikKCQlzdXBwb3J0Lm9wYWNpdHkgPSBkaXYuc3R5bGUub3BhY2l0eSA9PT0gIjAuNSI7CgoJCS8vIFZlcmlmeSBzdHlsZSBmbG9hdCBleGlzdGVuY2UKCQkvLyAoSUUgdXNlcyBzdHlsZUZsb2F0IGluc3RlYWQgb2YgY3NzRmxvYXQpCgkJc3VwcG9ydC5jc3NGbG9hdCA9ICEhZGl2LnN0eWxlLmNzc0Zsb2F0OwoKCQlkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSAiY29udGVudC1ib3giOwoJCWRpdi5jbG9uZU5vZGUoIHRydWUgKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICIiOwoJCXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlID0gZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwID09PSAiY29udGVudC1ib3giOwoKCQljb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCWNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gImJvcmRlcjowO3dpZHRoOjhweDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7IiArCgkJCSJwYWRkaW5nOjA7bWFyZ2luLXRvcDoxcHg7cG9zaXRpb246YWJzb2x1dGUiOwoJCWRpdi5pbm5lckhUTUwgPSAiIjsKCQljb250YWluZXIuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCXN1cHBvcnQuYm94U2l6aW5nID0gZGl2LnN0eWxlLmJveFNpemluZyA9PT0gIiIgfHwgZGl2LnN0eWxlLk1vekJveFNpemluZyA9PT0gIiIgfHwKCQkJZGl2LnN0eWxlLldlYmtpdEJveFNpemluZyA9PT0gIiI7CgoJCWpRdWVyeS5leHRlbmQoIHN1cHBvcnQsIHsKCQkJcmVsaWFibGVIaWRkZW5PZmZzZXRzOiBmdW5jdGlvbigpIHsKCQkJCWlmICggcGl4ZWxQb3NpdGlvblZhbCA9PSBudWxsICkgewoJCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCQl9CgkJCQlyZXR1cm4gcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsOwoJCQl9LAoKCQkJYm94U2l6aW5nUmVsaWFibGU6IGZ1bmN0aW9uKCkgewoKCQkJCS8vIFdlJ3JlIGNoZWNraW5nIGZvciBwaXhlbFBvc2l0aW9uVmFsIGhlcmUgaW5zdGVhZCBvZiBib3hTaXppbmdSZWxpYWJsZVZhbAoJCQkJLy8gc2luY2UgdGhhdCBjb21wcmVzc2VzIGJldHRlciBhbmQgdGhleSdyZSBjb21wdXRlZCB0b2dldGhlciBhbnl3YXkuCgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIGJveFNpemluZ1JlbGlhYmxlVmFsOwoJCQl9LAoKCQkJcGl4ZWxNYXJnaW5SaWdodDogZnVuY3Rpb24oKSB7CgoJCQkJLy8gU3VwcG9ydDogQW5kcm9pZCA0LjAtNC4zCgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHBpeGVsTWFyZ2luUmlnaHRWYWw7CgkJCX0sCgoJCQlwaXhlbFBvc2l0aW9uOiBmdW5jdGlvbigpIHsKCQkJCWlmICggcGl4ZWxQb3NpdGlvblZhbCA9PSBudWxsICkgewoJCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCQl9CgkJCQlyZXR1cm4gcGl4ZWxQb3NpdGlvblZhbDsKCQkJfSwKCgkJCXJlbGlhYmxlTWFyZ2luUmlnaHQ6IGZ1bmN0aW9uKCkgewoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw7CgkJCX0sCgoJCQlyZWxpYWJsZU1hcmdpbkxlZnQ6IGZ1bmN0aW9uKCkgewoKCQkJCS8vIFN1cHBvcnQ6IElFIDw9OCBvbmx5LCBBbmRyb2lkIDQuMCAtIDQuMyBvbmx5LCBGaXJlZm94IDw9MyAtIDM3CgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHJlbGlhYmxlTWFyZ2luTGVmdFZhbDsKCQkJfQoJCX0gKTsKCgkJZnVuY3Rpb24gY29tcHV0ZVN0eWxlVGVzdHMoKSB7CgkJCXZhciBjb250ZW50cywgZGl2U3R5bGUsCgkJCQlkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJCQkvLyBTZXR1cAoJCQlkb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJZGl2LnN0eWxlLmNzc1RleHQgPQoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQkJCSItd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3g7IiArCgkJCQkicG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpibG9jazsiICsKCQkJCSJtYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4OyIgKwoJCQkJInRvcDoxJTt3aWR0aDo1MCUiOwoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBBc3N1bWUgcmVhc29uYWJsZSB2YWx1ZXMgaW4gdGhlIGFic2VuY2Ugb2YgZ2V0Q29tcHV0ZWRTdHlsZQoJCQlwaXhlbFBvc2l0aW9uVmFsID0gYm94U2l6aW5nUmVsaWFibGVWYWwgPSByZWxpYWJsZU1hcmdpbkxlZnRWYWwgPSBmYWxzZTsKCQkJcGl4ZWxNYXJnaW5SaWdodFZhbCA9IHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwgPSB0cnVlOwoKCQkJLy8gQ2hlY2sgZm9yIGdldENvbXB1dGVkU3R5bGUgc28gdGhhdCB0aGlzIGNvZGUgaXMgbm90IHJ1biBpbiBJRTw5LgoJCQlpZiAoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlICkgewoJCQkJZGl2U3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZGl2ICk7CgkJCQlwaXhlbFBvc2l0aW9uVmFsID0gKCBkaXZTdHlsZSB8fCB7fSApLnRvcCAhPT0gIjElIjsKCQkJCXJlbGlhYmxlTWFyZ2luTGVmdFZhbCA9ICggZGl2U3R5bGUgfHwge30gKS5tYXJnaW5MZWZ0ID09PSAiMnB4IjsKCQkJCWJveFNpemluZ1JlbGlhYmxlVmFsID0gKCBkaXZTdHlsZSB8fCB7IHdpZHRoOiAiNHB4IiB9ICkud2lkdGggPT09ICI0cHgiOwoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgNC4wIC0gNC4zIG9ubHkKCQkJCS8vIFNvbWUgc3R5bGVzIGNvbWUgYmFjayB3aXRoIHBlcmNlbnRhZ2UgdmFsdWVzLCBldmVuIHRob3VnaCB0aGV5IHNob3VsZG4ndAoJCQkJZGl2LnN0eWxlLm1hcmdpblJpZ2h0ID0gIjUwJSI7CgkJCQlwaXhlbE1hcmdpblJpZ2h0VmFsID0gKCBkaXZTdHlsZSB8fCB7IG1hcmdpblJpZ2h0OiAiNHB4IiB9ICkubWFyZ2luUmlnaHQgPT09ICI0cHgiOwoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zIG9ubHkKCQkJCS8vIERpdiB3aXRoIGV4cGxpY2l0IHdpZHRoIGFuZCBubyBtYXJnaW4tcmlnaHQgaW5jb3JyZWN0bHkKCQkJCS8vIGdldHMgY29tcHV0ZWQgbWFyZ2luLXJpZ2h0IGJhc2VkIG9uIHdpZHRoIG9mIGNvbnRhaW5lciAoIzMzMzMpCgkJCQkvLyBXZWJLaXQgQnVnIDEzMzQzIC0gZ2V0Q29tcHV0ZWRTdHlsZSByZXR1cm5zIHdyb25nIHZhbHVlIGZvciBtYXJnaW4tcmlnaHQKCQkJCWNvbnRlbnRzID0gZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICk7CgoJCQkJLy8gUmVzZXQgQ1NTOiBib3gtc2l6aW5nOyBkaXNwbGF5OyBtYXJnaW47IGJvcmRlcjsgcGFkZGluZwoJCQkJY29udGVudHMuc3R5bGUuY3NzVGV4dCA9IGRpdi5zdHlsZS5jc3NUZXh0ID0KCgkJCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQkJCQkiLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDsiICsKCQkJCQkiYm94LXNpemluZzpjb250ZW50LWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MCI7CgkJCQljb250ZW50cy5zdHlsZS5tYXJnaW5SaWdodCA9IGNvbnRlbnRzLnN0eWxlLndpZHRoID0gIjAiOwoJCQkJZGl2LnN0eWxlLndpZHRoID0gIjFweCI7CgoJCQkJcmVsaWFibGVNYXJnaW5SaWdodFZhbCA9CgkJCQkJIXBhcnNlRmxvYXQoICggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGNvbnRlbnRzICkgfHwge30gKS5tYXJnaW5SaWdodCApOwoKCQkJCWRpdi5yZW1vdmVDaGlsZCggY29udGVudHMgKTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU2LTgKCQkJLy8gRmlyc3QgY2hlY2sgdGhhdCBnZXRDbGllbnRSZWN0cyB3b3JrcyBhcyBleHBlY3RlZAoJCQkvLyBDaGVjayBpZiB0YWJsZSBjZWxscyBzdGlsbCBoYXZlIG9mZnNldFdpZHRoL0hlaWdodCB3aGVuIHRoZXkgYXJlIHNldAoJCQkvLyB0byBkaXNwbGF5Om5vbmUgYW5kIHRoZXJlIGFyZSBzdGlsbCBvdGhlciB2aXNpYmxlIHRhYmxlIGNlbGxzIGluIGEKCQkJLy8gdGFibGUgcm93OyBpZiBzbywgb2Zmc2V0V2lkdGgvSGVpZ2h0IGFyZSBub3QgcmVsaWFibGUgZm9yIHVzZSB3aGVuCgkJCS8vIGRldGVybWluaW5nIGlmIGFuIGVsZW1lbnQgaGFzIGJlZW4gaGlkZGVuIGRpcmVjdGx5IHVzaW5nCgkJCS8vIGRpc3BsYXk6bm9uZSAoaXQgaXMgc3RpbGwgc2FmZSB0byB1c2Ugb2Zmc2V0cyBpZiBhIHBhcmVudCBlbGVtZW50IGlzCgkJCS8vIGhpZGRlbjsgZG9uIHNhZmV0eSBnb2dnbGVzIGFuZCBzZWUgYnVnICM0NTEyIGZvciBtb3JlIGluZm9ybWF0aW9uKS4KCQkJZGl2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCXJlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbCA9IGRpdi5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCA9PT0gMDsKCQkJaWYgKCByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgKSB7CgkJCQlkaXYuc3R5bGUuZGlzcGxheSA9ICIiOwoJCQkJZGl2LmlubmVySFRNTCA9ICI8dGFibGU+PHRyPjx0ZD48L3RkPjx0ZD50PC90ZD48L3RyPjwvdGFibGU+IjsKCQkJCWNvbnRlbnRzID0gZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAidGQiICk7CgkJCQljb250ZW50c1sgMCBdLnN0eWxlLmNzc1RleHQgPSAibWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowO2Rpc3BsYXk6bm9uZSI7CgkJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPSBjb250ZW50c1sgMCBdLm9mZnNldEhlaWdodCA9PT0gMDsKCQkJCWlmICggcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsICkgewoJCQkJCWNvbnRlbnRzWyAwIF0uc3R5bGUuZGlzcGxheSA9ICIiOwoJCQkJCWNvbnRlbnRzWyAxIF0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPSBjb250ZW50c1sgMCBdLm9mZnNldEhlaWdodCA9PT0gMDsKCQkJCX0KCQkJfQoKCQkJLy8gVGVhcmRvd24KCQkJZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCQl9CgoJfSApKCk7CgoKCXZhciBnZXRTdHlsZXMsIGN1ckNTUywKCQlycG9zaXRpb24gPSAvXih0b3B8cmlnaHR8Ym90dG9tfGxlZnQpJC87CgoJaWYgKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSApIHsKCQlnZXRTdHlsZXMgPSBmdW5jdGlvbiggZWxlbSApIHsKCgkJCS8vIFN1cHBvcnQ6IElFPD0xMSssIEZpcmVmb3g8PTMwKyAoIzE1MDk4LCAjMTQxNTApCgkJCS8vIElFIHRocm93cyBvbiBlbGVtZW50cyBjcmVhdGVkIGluIHBvcHVwcwoJCQkvLyBGRiBtZWFud2hpbGUgdGhyb3dzIG9uIGZyYW1lIGVsZW1lbnRzIHRocm91Z2ggImRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUiCgkJCXZhciB2aWV3ID0gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3OwoKCQkJaWYgKCAhdmlldyB8fCAhdmlldy5vcGVuZXIgKSB7CgkJCQl2aWV3ID0gd2luZG93OwoJCQl9CgoJCQlyZXR1cm4gdmlldy5nZXRDb21wdXRlZFN0eWxlKCBlbGVtICk7CgkJfTsKCgkJY3VyQ1NTID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJCQl2YXIgd2lkdGgsIG1pbldpZHRoLCBtYXhXaWR0aCwgcmV0LAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCgkJCS8vIGdldFByb3BlcnR5VmFsdWUgaXMgb25seSBuZWVkZWQgZm9yIC5jc3MoJ2ZpbHRlcicpIGluIElFOSwgc2VlICMxMjUzNwoJCQlyZXQgPSBjb21wdXRlZCA/IGNvbXB1dGVkLmdldFByb3BlcnR5VmFsdWUoIG5hbWUgKSB8fCBjb21wdXRlZFsgbmFtZSBdIDogdW5kZWZpbmVkOwoKCQkJLy8gU3VwcG9ydDogT3BlcmEgMTIuMXggb25seQoJCQkvLyBGYWxsIGJhY2sgdG8gc3R5bGUgZXZlbiB3aXRob3V0IGNvbXB1dGVkCgkJCS8vIGNvbXB1dGVkIGlzIHVuZGVmaW5lZCBmb3IgZWxlbXMgb24gZG9jdW1lbnQgZnJhZ21lbnRzCgkJCWlmICggKCByZXQgPT09ICIiIHx8IHJldCA9PT0gdW5kZWZpbmVkICkgJiYgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7CgkJCQlyZXQgPSBqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUgKTsKCQkJfQoKCQkJaWYgKCBjb21wdXRlZCApIHsKCgkJCQkvLyBBIHRyaWJ1dGUgdG8gdGhlICJhd2Vzb21lIGhhY2sgYnkgRGVhbiBFZHdhcmRzIgoJCQkJLy8gQ2hyb21lIDwgMTcgYW5kIFNhZmFyaSA1LjAgdXNlcyAiY29tcHV0ZWQgdmFsdWUiCgkJCQkvLyBpbnN0ZWFkIG9mICJ1c2VkIHZhbHVlIiBmb3IgbWFyZ2luLXJpZ2h0CgkJCQkvLyBTYWZhcmkgNS4xLjcgKGF0IGxlYXN0KSByZXR1cm5zIHBlcmNlbnRhZ2UgZm9yIGEgbGFyZ2VyIHNldCBvZiB2YWx1ZXMsCgkJCQkvLyBidXQgd2lkdGggc2VlbXMgdG8gYmUgcmVsaWFibHkgcGl4ZWxzCgkJCQkvLyB0aGlzIGlzIGFnYWluc3QgdGhlIENTU09NIGRyYWZ0IHNwZWM6CgkJCQkvLyBodHRwOi8vZGV2LnczLm9yZy9jc3N3Zy9jc3NvbS8jcmVzb2x2ZWQtdmFsdWVzCgkJCQlpZiAoICFzdXBwb3J0LnBpeGVsTWFyZ2luUmlnaHQoKSAmJiBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgcm1hcmdpbi50ZXN0KCBuYW1lICkgKSB7CgoJCQkJCS8vIFJlbWVtYmVyIHRoZSBvcmlnaW5hbCB2YWx1ZXMKCQkJCQl3aWR0aCA9IHN0eWxlLndpZHRoOwoJCQkJCW1pbldpZHRoID0gc3R5bGUubWluV2lkdGg7CgkJCQkJbWF4V2lkdGggPSBzdHlsZS5tYXhXaWR0aDsKCgkJCQkJLy8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dAoJCQkJCXN0eWxlLm1pbldpZHRoID0gc3R5bGUubWF4V2lkdGggPSBzdHlsZS53aWR0aCA9IHJldDsKCQkJCQlyZXQgPSBjb21wdXRlZC53aWR0aDsKCgkJCQkJLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwoJCQkJCXN0eWxlLndpZHRoID0gd2lkdGg7CgkJCQkJc3R5bGUubWluV2lkdGggPSBtaW5XaWR0aDsKCQkJCQlzdHlsZS5tYXhXaWR0aCA9IG1heFdpZHRoOwoJCQkJfQoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBJRSByZXR1cm5zIHpJbmRleCB2YWx1ZSBhcyBhbiBpbnRlZ2VyLgoJCQlyZXR1cm4gcmV0ID09PSB1bmRlZmluZWQgPwoJCQkJcmV0IDoKCQkJCXJldCArICIiOwoJCX07Cgl9IGVsc2UgaWYgKCBkb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlICkgewoJCWdldFN0eWxlcyA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5jdXJyZW50U3R5bGU7CgkJfTsKCgkJY3VyQ1NTID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJCQl2YXIgbGVmdCwgcnMsIHJzTGVmdCwgcmV0LAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJcmV0ID0gY29tcHV0ZWQgPyBjb21wdXRlZFsgbmFtZSBdIDogdW5kZWZpbmVkOwoKCQkJLy8gQXZvaWQgc2V0dGluZyByZXQgdG8gZW1wdHkgc3RyaW5nIGhlcmUKCQkJLy8gc28gd2UgZG9uJ3QgZGVmYXVsdCB0byBhdXRvCgkJCWlmICggcmV0ID09IG51bGwgJiYgc3R5bGUgJiYgc3R5bGVbIG5hbWUgXSApIHsKCQkJCXJldCA9IHN0eWxlWyBuYW1lIF07CgkJCX0KCgkJCS8vIEZyb20gdGhlIGF3ZXNvbWUgaGFjayBieSBEZWFuIEVkd2FyZHMKCQkJLy8gaHR0cDovL2VyaWsuZWFlLm5ldC9hcmNoaXZlcy8yMDA3LzA3LzI3LzE4LjU0LjE1LyNjb21tZW50LTEwMjI5MQoKCQkJLy8gSWYgd2UncmUgbm90IGRlYWxpbmcgd2l0aCBhIHJlZ3VsYXIgcGl4ZWwgbnVtYmVyCgkJCS8vIGJ1dCBhIG51bWJlciB0aGF0IGhhcyBhIHdlaXJkIGVuZGluZywgd2UgbmVlZCB0byBjb252ZXJ0IGl0IHRvIHBpeGVscwoJCQkvLyBidXQgbm90IHBvc2l0aW9uIGNzcyBhdHRyaWJ1dGVzLCBhcyB0aG9zZSBhcmUKCQkJLy8gcHJvcG9ydGlvbmFsIHRvIHRoZSBwYXJlbnQgZWxlbWVudCBpbnN0ZWFkCgkJCS8vIGFuZCB3ZSBjYW4ndCBtZWFzdXJlIHRoZSBwYXJlbnQgaW5zdGVhZCBiZWNhdXNlIGl0CgkJCS8vIG1pZ2h0IHRyaWdnZXIgYSAic3RhY2tpbmcgZG9sbHMiIHByb2JsZW0KCQkJaWYgKCBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgIXJwb3NpdGlvbi50ZXN0KCBuYW1lICkgKSB7CgoJCQkJLy8gUmVtZW1iZXIgdGhlIG9yaWdpbmFsIHZhbHVlcwoJCQkJbGVmdCA9IHN0eWxlLmxlZnQ7CgkJCQlycyA9IGVsZW0ucnVudGltZVN0eWxlOwoJCQkJcnNMZWZ0ID0gcnMgJiYgcnMubGVmdDsKCgkJCQkvLyBQdXQgaW4gdGhlIG5ldyB2YWx1ZXMgdG8gZ2V0IGEgY29tcHV0ZWQgdmFsdWUgb3V0CgkJCQlpZiAoIHJzTGVmdCApIHsKCQkJCQlycy5sZWZ0ID0gZWxlbS5jdXJyZW50U3R5bGUubGVmdDsKCQkJCX0KCQkJCXN0eWxlLmxlZnQgPSBuYW1lID09PSAiZm9udFNpemUiID8gIjFlbSIgOiByZXQ7CgkJCQlyZXQgPSBzdHlsZS5waXhlbExlZnQgKyAicHgiOwoKCQkJCS8vIFJldmVydCB0aGUgY2hhbmdlZCB2YWx1ZXMKCQkJCXN0eWxlLmxlZnQgPSBsZWZ0OwoJCQkJaWYgKCByc0xlZnQgKSB7CgkJCQkJcnMubGVmdCA9IHJzTGVmdDsKCQkJCX0KCQkJfQoKCQkJLy8gU3VwcG9ydDogSUUKCQkJLy8gSUUgcmV0dXJucyB6SW5kZXggdmFsdWUgYXMgYW4gaW50ZWdlci4KCQkJcmV0dXJuIHJldCA9PT0gdW5kZWZpbmVkID8KCQkJCXJldCA6CgkJCQlyZXQgKyAiIiB8fCAiYXV0byI7CgkJfTsKCX0KCgoKCglmdW5jdGlvbiBhZGRHZXRIb29rSWYoIGNvbmRpdGlvbkZuLCBob29rRm4gKSB7CgoJCS8vIERlZmluZSB0aGUgaG9vaywgd2UnbGwgY2hlY2sgb24gdGhlIGZpcnN0IHJ1biBpZiBpdCdzIHJlYWxseSBuZWVkZWQuCgkJcmV0dXJuIHsKCQkJZ2V0OiBmdW5jdGlvbigpIHsKCQkJCWlmICggY29uZGl0aW9uRm4oKSApIHsKCgkJCQkJLy8gSG9vayBub3QgbmVlZGVkIChvciBpdCdzIG5vdCBwb3NzaWJsZSB0byB1c2UgaXQgZHVlCgkJCQkJLy8gdG8gbWlzc2luZyBkZXBlbmRlbmN5KSwgcmVtb3ZlIGl0LgoJCQkJCWRlbGV0ZSB0aGlzLmdldDsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gSG9vayBuZWVkZWQ7IHJlZGVmaW5lIGl0IHNvIHRoYXQgdGhlIHN1cHBvcnQgdGVzdCBpcyBub3QgZXhlY3V0ZWQgYWdhaW4uCgkJCQlyZXR1cm4gKCB0aGlzLmdldCA9IGhvb2tGbiApLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJfQoJCX07Cgl9CgoKCXZhcgoKCQkJcmFscGhhID0gL2FscGhhXChbXildKlwpL2ksCgkJcm9wYWNpdHkgPSAvb3BhY2l0eVxzKj1ccyooW14pXSopL2ksCgoJCS8vIHN3YXBwYWJsZSBpZiBkaXNwbGF5IGlzIG5vbmUgb3Igc3RhcnRzIHdpdGggdGFibGUgZXhjZXB0CgkJLy8gInRhYmxlIiwgInRhYmxlLWNlbGwiLCBvciAidGFibGUtY2FwdGlvbiIKCQkvLyBzZWUgaGVyZSBmb3IgZGlzcGxheSB2YWx1ZXM6CgkJLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9DU1MvZGlzcGxheQoJCXJkaXNwbGF5c3dhcCA9IC9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLywKCQlybnVtc3BsaXQgPSBuZXcgUmVnRXhwKCAiXigiICsgcG51bSArICIpKC4qKSQiLCAiaSIgKSwKCgkJY3NzU2hvdyA9IHsgcG9zaXRpb246ICJhYnNvbHV0ZSIsIHZpc2liaWxpdHk6ICJoaWRkZW4iLCBkaXNwbGF5OiAiYmxvY2siIH0sCgkJY3NzTm9ybWFsVHJhbnNmb3JtID0gewoJCQlsZXR0ZXJTcGFjaW5nOiAiMCIsCgkJCWZvbnRXZWlnaHQ6ICI0MDAiCgkJfSwKCgkJY3NzUHJlZml4ZXMgPSBbICJXZWJraXQiLCAiTyIsICJNb3oiLCAibXMiIF0sCgkJZW1wdHlTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICkuc3R5bGU7CgoKCS8vIHJldHVybiBhIGNzcyBwcm9wZXJ0eSBtYXBwZWQgdG8gYSBwb3RlbnRpYWxseSB2ZW5kb3IgcHJlZml4ZWQgcHJvcGVydHkKCWZ1bmN0aW9uIHZlbmRvclByb3BOYW1lKCBuYW1lICkgewoKCQkvLyBzaG9ydGN1dCBmb3IgbmFtZXMgdGhhdCBhcmUgbm90IHZlbmRvciBwcmVmaXhlZAoJCWlmICggbmFtZSBpbiBlbXB0eVN0eWxlICkgewoJCQlyZXR1cm4gbmFtZTsKCQl9CgoJCS8vIGNoZWNrIGZvciB2ZW5kb3IgcHJlZml4ZWQgbmFtZXMKCQl2YXIgY2FwTmFtZSA9IG5hbWUuY2hhckF0KCAwICkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoIDEgKSwKCQkJaSA9IGNzc1ByZWZpeGVzLmxlbmd0aDsKCgkJd2hpbGUgKCBpLS0gKSB7CgkJCW5hbWUgPSBjc3NQcmVmaXhlc1sgaSBdICsgY2FwTmFtZTsKCQkJaWYgKCBuYW1lIGluIGVtcHR5U3R5bGUgKSB7CgkJCQlyZXR1cm4gbmFtZTsKCQkJfQoJCX0KCX0KCglmdW5jdGlvbiBzaG93SGlkZSggZWxlbWVudHMsIHNob3cgKSB7CgkJdmFyIGRpc3BsYXksIGVsZW0sIGhpZGRlbiwKCQkJdmFsdWVzID0gW10sCgkJCWluZGV4ID0gMCwKCQkJbGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQllbGVtID0gZWxlbWVudHNbIGluZGV4IF07CgkJCWlmICggIWVsZW0uc3R5bGUgKSB7CgkJCQljb250aW51ZTsKCQkJfQoKCQkJdmFsdWVzWyBpbmRleCBdID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xkZGlzcGxheSIgKTsKCQkJZGlzcGxheSA9IGVsZW0uc3R5bGUuZGlzcGxheTsKCQkJaWYgKCBzaG93ICkgewoKCQkJCS8vIFJlc2V0IHRoZSBpbmxpbmUgZGlzcGxheSBvZiB0aGlzIGVsZW1lbnQgdG8gbGVhcm4gaWYgaXQgaXMKCQkJCS8vIGJlaW5nIGhpZGRlbiBieSBjYXNjYWRlZCBydWxlcyBvciBub3QKCQkJCWlmICggIXZhbHVlc1sgaW5kZXggXSAmJiBkaXNwbGF5ID09PSAibm9uZSIgKSB7CgkJCQkJZWxlbS5zdHlsZS5kaXNwbGF5ID0gIiI7CgkJCQl9CgoJCQkJLy8gU2V0IGVsZW1lbnRzIHdoaWNoIGhhdmUgYmVlbiBvdmVycmlkZGVuIHdpdGggZGlzcGxheTogbm9uZQoJCQkJLy8gaW4gYSBzdHlsZXNoZWV0IHRvIHdoYXRldmVyIHRoZSBkZWZhdWx0IGJyb3dzZXIgc3R5bGUgaXMKCQkJCS8vIGZvciBzdWNoIGFuIGVsZW1lbnQKCQkJCWlmICggZWxlbS5zdHlsZS5kaXNwbGF5ID09PSAiIiAmJiBpc0hpZGRlbiggZWxlbSApICkgewoJCQkJCXZhbHVlc1sgaW5kZXggXSA9CgkJCQkJCWpRdWVyeS5fZGF0YSggZWxlbSwgIm9sZGRpc3BsYXkiLCBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApICk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQloaWRkZW4gPSBpc0hpZGRlbiggZWxlbSApOwoKCQkJCWlmICggZGlzcGxheSAmJiBkaXNwbGF5ICE9PSAibm9uZSIgfHwgIWhpZGRlbiApIHsKCQkJCQlqUXVlcnkuX2RhdGEoCgkJCQkJCWVsZW0sCgkJCQkJCSJvbGRkaXNwbGF5IiwKCQkJCQkJaGlkZGVuID8gZGlzcGxheSA6IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApCgkJCQkJKTsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gU2V0IHRoZSBkaXNwbGF5IG9mIG1vc3Qgb2YgdGhlIGVsZW1lbnRzIGluIGEgc2Vjb25kIGxvb3AKCQkvLyB0byBhdm9pZCB0aGUgY29uc3RhbnQgcmVmbG93CgkJZm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJZWxlbSA9IGVsZW1lbnRzWyBpbmRleCBdOwoJCQlpZiAoICFlbGVtLnN0eWxlICkgewoJCQkJY29udGludWU7CgkJCX0KCQkJaWYgKCAhc2hvdyB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09ICJub25lIiB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09ICIiICkgewoJCQkJZWxlbS5zdHlsZS5kaXNwbGF5ID0gc2hvdyA/IHZhbHVlc1sgaW5kZXggXSB8fCAiIiA6ICJub25lIjsKCQkJfQoJCX0KCgkJcmV0dXJuIGVsZW1lbnRzOwoJfQoKCWZ1bmN0aW9uIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgc3VidHJhY3QgKSB7CgkJdmFyIG1hdGNoZXMgPSBybnVtc3BsaXQuZXhlYyggdmFsdWUgKTsKCQlyZXR1cm4gbWF0Y2hlcyA/CgoJCQkvLyBHdWFyZCBhZ2FpbnN0IHVuZGVmaW5lZCAic3VidHJhY3QiLCBlLmcuLCB3aGVuIHVzZWQgYXMgaW4gY3NzSG9va3MKCQkJTWF0aC5tYXgoIDAsIG1hdGNoZXNbIDEgXSAtICggc3VidHJhY3QgfHwgMCApICkgKyAoIG1hdGNoZXNbIDIgXSB8fCAicHgiICkgOgoJCQl2YWx1ZTsKCX0KCglmdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEsIGlzQm9yZGVyQm94LCBzdHlsZXMgKSB7CgkJdmFyIGkgPSBleHRyYSA9PT0gKCBpc0JvcmRlckJveCA/ICJib3JkZXIiIDogImNvbnRlbnQiICkgPwoKCQkJLy8gSWYgd2UgYWxyZWFkeSBoYXZlIHRoZSByaWdodCBtZWFzdXJlbWVudCwgYXZvaWQgYXVnbWVudGF0aW9uCgkJCTQgOgoKCQkJLy8gT3RoZXJ3aXNlIGluaXRpYWxpemUgZm9yIGhvcml6b250YWwgb3IgdmVydGljYWwgcHJvcGVydGllcwoJCQluYW1lID09PSAid2lkdGgiID8gMSA6IDAsCgoJCQl2YWwgPSAwOwoKCQlmb3IgKCA7IGkgPCA0OyBpICs9IDIgKSB7CgoJCQkvLyBib3RoIGJveCBtb2RlbHMgZXhjbHVkZSBtYXJnaW4sIHNvIGFkZCBpdCBpZiB3ZSB3YW50IGl0CgkJCWlmICggZXh0cmEgPT09ICJtYXJnaW4iICkgewoJCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sIGV4dHJhICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApOwoJCQl9CgoJCQlpZiAoIGlzQm9yZGVyQm94ICkgewoKCQkJCS8vIGJvcmRlci1ib3ggaW5jbHVkZXMgcGFkZGluZywgc28gcmVtb3ZlIGl0IGlmIHdlIHdhbnQgY29udGVudAoJCQkJaWYgKCBleHRyYSA9PT0gImNvbnRlbnQiICkgewoJCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgYm9yZGVyIG5vciBtYXJnaW4sIHNvIHJlbW92ZSBib3JkZXIKCQkJCWlmICggZXh0cmEgIT09ICJtYXJnaW4iICkgewoJCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgkJCX0gZWxzZSB7CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgY29udGVudCwgc28gYWRkIHBhZGRpbmcKCQkJCXZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgY29udGVudCBub3IgcGFkZGluZywgc28gYWRkIGJvcmRlcgoJCQkJaWYgKCBleHRyYSAhPT0gInBhZGRpbmciICkgewoJCQkJCXZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiB2YWw7Cgl9CgoJZnVuY3Rpb24gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKSB7CgoJCS8vIFN0YXJ0IHdpdGggb2Zmc2V0IHByb3BlcnR5LCB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBib3JkZXItYm94IHZhbHVlCgkJdmFyIHZhbHVlSXNCb3JkZXJCb3ggPSB0cnVlLAoJCQl2YWwgPSBuYW1lID09PSAid2lkdGgiID8gZWxlbS5vZmZzZXRXaWR0aCA6IGVsZW0ub2Zmc2V0SGVpZ2h0LAoJCQlzdHlsZXMgPSBnZXRTdHlsZXMoIGVsZW0gKSwKCQkJaXNCb3JkZXJCb3ggPSBzdXBwb3J0LmJveFNpemluZyAmJgoJCQkJalF1ZXJ5LmNzcyggZWxlbSwgImJveFNpemluZyIsIGZhbHNlLCBzdHlsZXMgKSA9PT0gImJvcmRlci1ib3giOwoKCQkvLyBTdXBwb3J0OiBJRTExIG9ubHkKCQkvLyBJbiBJRSAxMSBmdWxsc2NyZWVuIGVsZW1lbnRzIGluc2lkZSBvZiBhbiBpZnJhbWUgaGF2ZQoJCS8vIDEwMHggdG9vIHNtYWxsIGRpbWVuc2lvbnMgKGdoLTE3NjQpLgoJCWlmICggZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudCAmJiB3aW5kb3cudG9wICE9PSB3aW5kb3cgKSB7CgoJCQkvLyBTdXBwb3J0OiBJRTExIG9ubHkKCQkJLy8gUnVubmluZyBnZXRCb3VuZGluZ0NsaWVudFJlY3Qgb24gYSBkaXNjb25uZWN0ZWQgbm9kZQoJCQkvLyBpbiBJRSB0aHJvd3MgYW4gZXJyb3IuCgkJCWlmICggZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCApIHsKCQkJCXZhbCA9IE1hdGgucm91bmQoIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClbIG5hbWUgXSAqIDEwMCApOwoJCQl9CgkJfQoKCQkvLyBzb21lIG5vbi1odG1sIGVsZW1lbnRzIHJldHVybiB1bmRlZmluZWQgZm9yIG9mZnNldFdpZHRoLCBzbyBjaGVjayBmb3IgbnVsbC91bmRlZmluZWQKCQkvLyBzdmcgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDkyODUKCQkvLyBNYXRoTUwgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD00OTE2NjgKCQlpZiAoIHZhbCA8PSAwIHx8IHZhbCA9PSBudWxsICkgewoKCQkJLy8gRmFsbCBiYWNrIHRvIGNvbXB1dGVkIHRoZW4gdW5jb21wdXRlZCBjc3MgaWYgbmVjZXNzYXJ5CgkJCXZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7CgkJCWlmICggdmFsIDwgMCB8fCB2YWwgPT0gbnVsbCApIHsKCQkJCXZhbCA9IGVsZW0uc3R5bGVbIG5hbWUgXTsKCQkJfQoKCQkJLy8gQ29tcHV0ZWQgdW5pdCBpcyBub3QgcGl4ZWxzLiBTdG9wIGhlcmUgYW5kIHJldHVybi4KCQkJaWYgKCBybnVtbm9ucHgudGVzdCggdmFsICkgKSB7CgkJCQlyZXR1cm4gdmFsOwoJCQl9CgoJCQkvLyB3ZSBuZWVkIHRoZSBjaGVjayBmb3Igc3R5bGUgaW4gY2FzZSBhIGJyb3dzZXIgd2hpY2ggcmV0dXJucyB1bnJlbGlhYmxlIHZhbHVlcwoJCQkvLyBmb3IgZ2V0Q29tcHV0ZWRTdHlsZSBzaWxlbnRseSBmYWxscyBiYWNrIHRvIHRoZSByZWxpYWJsZSBlbGVtLnN0eWxlCgkJCXZhbHVlSXNCb3JkZXJCb3ggPSBpc0JvcmRlckJveCAmJgoJCQkJKCBzdXBwb3J0LmJveFNpemluZ1JlbGlhYmxlKCkgfHwgdmFsID09PSBlbGVtLnN0eWxlWyBuYW1lIF0gKTsKCgkJCS8vIE5vcm1hbGl6ZSAiIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJhCgkJCXZhbCA9IHBhcnNlRmxvYXQoIHZhbCApIHx8IDA7CgkJfQoKCQkvLyB1c2UgdGhlIGFjdGl2ZSBib3gtc2l6aW5nIG1vZGVsIHRvIGFkZC9zdWJ0cmFjdCBpcnJlbGV2YW50IHN0eWxlcwoJCXJldHVybiAoIHZhbCArCgkJCWF1Z21lbnRXaWR0aE9ySGVpZ2h0KAoJCQkJZWxlbSwKCQkJCW5hbWUsCgkJCQlleHRyYSB8fCAoIGlzQm9yZGVyQm94ID8gImJvcmRlciIgOiAiY29udGVudCIgKSwKCQkJCXZhbHVlSXNCb3JkZXJCb3gsCgkJCQlzdHlsZXMKCQkJKQoJCSkgKyAicHgiOwoJfQoKCWpRdWVyeS5leHRlbmQoIHsKCgkJLy8gQWRkIGluIHN0eWxlIHByb3BlcnR5IGhvb2tzIGZvciBvdmVycmlkaW5nIHRoZSBkZWZhdWx0CgkJLy8gYmVoYXZpb3Igb2YgZ2V0dGluZyBhbmQgc2V0dGluZyBhIHN0eWxlIHByb3BlcnR5CgkJY3NzSG9va3M6IHsKCQkJb3BhY2l0eTogewoJCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7CgkJCQkJaWYgKCBjb21wdXRlZCApIHsKCgkJCQkJCS8vIFdlIHNob3VsZCBhbHdheXMgZ2V0IGEgbnVtYmVyIGJhY2sgZnJvbSBvcGFjaXR5CgkJCQkJCXZhciByZXQgPSBjdXJDU1MoIGVsZW0sICJvcGFjaXR5IiApOwoJCQkJCQlyZXR1cm4gcmV0ID09PSAiIiA/ICIxIiA6IHJldDsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9LAoKCQkvLyBEb24ndCBhdXRvbWF0aWNhbGx5IGFkZCAicHgiIHRvIHRoZXNlIHBvc3NpYmx5LXVuaXRsZXNzIHByb3BlcnRpZXMKCQljc3NOdW1iZXI6IHsKCQkJImFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50IjogdHJ1ZSwKCQkJImNvbHVtbkNvdW50IjogdHJ1ZSwKCQkJImZpbGxPcGFjaXR5IjogdHJ1ZSwKCQkJImZsZXhHcm93IjogdHJ1ZSwKCQkJImZsZXhTaHJpbmsiOiB0cnVlLAoJCQkiZm9udFdlaWdodCI6IHRydWUsCgkJCSJsaW5lSGVpZ2h0IjogdHJ1ZSwKCQkJIm9wYWNpdHkiOiB0cnVlLAoJCQkib3JkZXIiOiB0cnVlLAoJCQkib3JwaGFucyI6IHRydWUsCgkJCSJ3aWRvd3MiOiB0cnVlLAoJCQkiekluZGV4IjogdHJ1ZSwKCQkJInpvb20iOiB0cnVlCgkJfSwKCgkJLy8gQWRkIGluIHByb3BlcnRpZXMgd2hvc2UgbmFtZXMgeW91IHdpc2ggdG8gZml4IGJlZm9yZQoJCS8vIHNldHRpbmcgb3IgZ2V0dGluZyB0aGUgdmFsdWUKCQljc3NQcm9wczogewoKCQkJLy8gbm9ybWFsaXplIGZsb2F0IGNzcyBwcm9wZXJ0eQoJCQkiZmxvYXQiOiBzdXBwb3J0LmNzc0Zsb2F0ID8gImNzc0Zsb2F0IiA6ICJzdHlsZUZsb2F0IgoJCX0sCgoJCS8vIEdldCBhbmQgc2V0IHRoZSBzdHlsZSBwcm9wZXJ0eSBvbiBhIERPTSBOb2RlCgkJc3R5bGU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSwgZXh0cmEgKSB7CgoJCQkvLyBEb24ndCBzZXQgc3R5bGVzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQkJaWYgKCAhZWxlbSB8fCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwgIWVsZW0uc3R5bGUgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCQl2YXIgcmV0LCB0eXBlLCBob29rcywKCQkJCW9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApLAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJbmFtZSA9IGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fAoJCQkJKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggb3JpZ05hbWUgKSB8fCBvcmlnTmFtZSApOwoKCQkJLy8gZ2V0cyBob29rIGZvciB0aGUgcHJlZml4ZWQgdmVyc2lvbgoJCQkvLyBmb2xsb3dlZCBieSB0aGUgdW5wcmVmaXhlZCB2ZXJzaW9uCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdOwoKCQkJLy8gQ2hlY2sgaWYgd2UncmUgc2V0dGluZyBhIHZhbHVlCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCXR5cGUgPSB0eXBlb2YgdmFsdWU7CgoJCQkJLy8gQ29udmVydCAiKz0iIG9yICItPSIgdG8gcmVsYXRpdmUgbnVtYmVycyAoIzczNDUpCgkJCQlpZiAoIHR5cGUgPT09ICJzdHJpbmciICYmICggcmV0ID0gcmNzc051bS5leGVjKCB2YWx1ZSApICkgJiYgcmV0WyAxIF0gKSB7CgkJCQkJdmFsdWUgPSBhZGp1c3RDU1MoIGVsZW0sIG5hbWUsIHJldCApOwoKCQkJCQkvLyBGaXhlcyBidWcgIzkyMzcKCQkJCQl0eXBlID0gIm51bWJlciI7CgkJCQl9CgoJCQkJLy8gTWFrZSBzdXJlIHRoYXQgbnVsbCBhbmQgTmFOIHZhbHVlcyBhcmVuJ3Qgc2V0LiBTZWU6ICM3MTE2CgkJCQlpZiAoIHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlICkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQkvLyBJZiBhIG51bWJlciB3YXMgcGFzc2VkIGluLCBhZGQgdGhlIHVuaXQgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcykKCQkJCWlmICggdHlwZSA9PT0gIm51bWJlciIgKSB7CgkJCQkJdmFsdWUgKz0gcmV0ICYmIHJldFsgMyBdIHx8ICggalF1ZXJ5LmNzc051bWJlclsgb3JpZ05hbWUgXSA/ICIiIDogInB4IiApOwoJCQkJfQoKCQkJCS8vIEZpeGVzICM4OTA4LCBpdCBjYW4gYmUgZG9uZSBtb3JlIGNvcnJlY3RseSBieSBzcGVjaWZpbmcgc2V0dGVycyBpbiBjc3NIb29rcywKCQkJCS8vIGJ1dCBpdCB3b3VsZCBtZWFuIHRvIGRlZmluZSBlaWdodAoJCQkJLy8gKGZvciBldmVyeSBwcm9ibGVtYXRpYyBwcm9wZXJ0eSkgaWRlbnRpY2FsIGZ1bmN0aW9ucwoJCQkJaWYgKCAhc3VwcG9ydC5jbGVhckNsb25lU3R5bGUgJiYgdmFsdWUgPT09ICIiICYmIG5hbWUuaW5kZXhPZiggImJhY2tncm91bmQiICkgPT09IDAgKSB7CgkJCQkJc3R5bGVbIG5hbWUgXSA9ICJpbmhlcml0IjsKCQkJCX0KCgkJCQkvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkLCB1c2UgdGhhdCB2YWx1ZSwgb3RoZXJ3aXNlIGp1c3Qgc2V0IHRoZSBzcGVjaWZpZWQgdmFsdWUKCQkJCWlmICggIWhvb2tzIHx8ICEoICJzZXQiIGluIGhvb2tzICkgfHwKCQkJCQkoIHZhbHVlID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgZXh0cmEgKSApICE9PSB1bmRlZmluZWQgKSB7CgoJCQkJCS8vIFN1cHBvcnQ6IElFCgkJCQkJLy8gU3dhbGxvdyBlcnJvcnMgZnJvbSAnaW52YWxpZCcgQ1NTIHZhbHVlcyAoIzU1MDkpCgkJCQkJdHJ5IHsKCQkJCQkJc3R5bGVbIG5hbWUgXSA9IHZhbHVlOwoJCQkJCX0gY2F0Y2ggKCBlICkge30KCQkJCX0KCgkJCX0gZWxzZSB7CgoJCQkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIG5vbi1jb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlCgkJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmCgkJCQkJKCByZXQgPSBob29rcy5nZXQoIGVsZW0sIGZhbHNlLCBleHRyYSApICkgIT09IHVuZGVmaW5lZCApIHsKCgkJCQkJcmV0dXJuIHJldDsKCQkJCX0KCgkJCQkvLyBPdGhlcndpc2UganVzdCBnZXQgdGhlIHZhbHVlIGZyb20gdGhlIHN0eWxlIG9iamVjdAoJCQkJcmV0dXJuIHN0eWxlWyBuYW1lIF07CgkJCX0KCQl9LAoKCQ==", "base64"));
  res.write(new Buffer("CWNzczogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGV4dHJhLCBzdHlsZXMgKSB7CgkJCXZhciBudW0sIHZhbCwgaG9va3MsCgkJCQlvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKTsKCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCQluYW1lID0galF1ZXJ5LmNzc1Byb3BzWyBvcmlnTmFtZSBdIHx8CgkJCQkoIGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSA9IHZlbmRvclByb3BOYW1lKCBvcmlnTmFtZSApIHx8IG9yaWdOYW1lICk7CgoJCQkvLyBnZXRzIGhvb2sgZm9yIHRoZSBwcmVmaXhlZCB2ZXJzaW9uCgkJCS8vIGZvbGxvd2VkIGJ5IHRoZSB1bnByZWZpeGVkIHZlcnNpb24KCQkJaG9va3MgPSBqUXVlcnkuY3NzSG9va3NbIG5hbWUgXSB8fCBqUXVlcnkuY3NzSG9va3NbIG9yaWdOYW1lIF07CgoJCQkvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkIGdldCB0aGUgY29tcHV0ZWQgdmFsdWUgZnJvbSB0aGVyZQoJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICkgewoJCQkJdmFsID0gaG9va3MuZ2V0KCBlbGVtLCB0cnVlLCBleHRyYSApOwoJCQl9CgoJCQkvLyBPdGhlcndpc2UsIGlmIGEgd2F5IHRvIGdldCB0aGUgY29tcHV0ZWQgdmFsdWUgZXhpc3RzLCB1c2UgdGhhdAoJCQlpZiAoIHZhbCA9PT0gdW5kZWZpbmVkICkgewoJCQkJdmFsID0gY3VyQ1NTKCBlbGVtLCBuYW1lLCBzdHlsZXMgKTsKCQkJfQoKCQkJLy9jb252ZXJ0ICJub3JtYWwiIHRvIGNvbXB1dGVkIHZhbHVlCgkJCWlmICggdmFsID09PSAibm9ybWFsIiAmJiBuYW1lIGluIGNzc05vcm1hbFRyYW5zZm9ybSApIHsKCQkJCXZhbCA9IGNzc05vcm1hbFRyYW5zZm9ybVsgbmFtZSBdOwoJCQl9CgoJCQkvLyBSZXR1cm4sIGNvbnZlcnRpbmcgdG8gbnVtYmVyIGlmIGZvcmNlZCBvciBhIHF1YWxpZmllciB3YXMgcHJvdmlkZWQgYW5kIHZhbCBsb29rcyBudW1lcmljCgkJCWlmICggZXh0cmEgPT09ICIiIHx8IGV4dHJhICkgewoJCQkJbnVtID0gcGFyc2VGbG9hdCggdmFsICk7CgkJCQlyZXR1cm4gZXh0cmEgPT09IHRydWUgfHwgaXNGaW5pdGUoIG51bSApID8gbnVtIHx8IDAgOiB2YWw7CgkJCX0KCQkJcmV0dXJuIHZhbDsKCQl9Cgl9ICk7CgoJalF1ZXJ5LmVhY2goIFsgImhlaWdodCIsICJ3aWR0aCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkLCBleHRyYSApIHsKCQkJCWlmICggY29tcHV0ZWQgKSB7CgoJCQkJCS8vIGNlcnRhaW4gZWxlbWVudHMgY2FuIGhhdmUgZGltZW5zaW9uIGluZm8gaWYgd2UgaW52aXNpYmx5IHNob3cgdGhlbQoJCQkJCS8vIGhvd2V2ZXIsIGl0IG11c3QgaGF2ZSBhIGN1cnJlbnQgZGlzcGxheSBzdHlsZSB0aGF0IHdvdWxkIGJlbmVmaXQgZnJvbSB0aGlzCgkJCQkJcmV0dXJuIHJkaXNwbGF5c3dhcC50ZXN0KCBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSApICYmCgkJCQkJCWVsZW0ub2Zmc2V0V2lkdGggPT09IDAgPwoJCQkJCQkJc3dhcCggZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24oKSB7CgkJCQkJCQkJcmV0dXJuIGdldFdpZHRoT3JIZWlnaHQoIGVsZW0sIG5hbWUsIGV4dHJhICk7CgkJCQkJCQl9ICkgOgoJCQkJCQkJZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJCX0KCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBleHRyYSApIHsKCQkJCXZhciBzdHlsZXMgPSBleHRyYSAmJiBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJCXJldHVybiBzZXRQb3NpdGl2ZU51bWJlciggZWxlbSwgdmFsdWUsIGV4dHJhID8KCQkJCQlhdWdtZW50V2lkdGhPckhlaWdodCgKCQkJCQkJZWxlbSwKCQkJCQkJbmFtZSwKCQkJCQkJZXh0cmEsCgkJCQkJCXN1cHBvcnQuYm94U2l6aW5nICYmCgkJCQkJCQlqUXVlcnkuY3NzKCBlbGVtLCAiYm94U2l6aW5nIiwgZmFsc2UsIHN0eWxlcyApID09PSAiYm9yZGVyLWJveCIsCgkJCQkJCXN0eWxlcwoJCQkJCSkgOiAwCgkJCQkpOwoJCQl9CgkJfTsKCX0gKTsKCglpZiAoICFzdXBwb3J0Lm9wYWNpdHkgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzLm9wYWNpdHkgPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoKCQkJCS8vIElFIHVzZXMgZmlsdGVycyBmb3Igb3BhY2l0eQoJCQkJcmV0dXJuIHJvcGFjaXR5LnRlc3QoICggY29tcHV0ZWQgJiYgZWxlbS5jdXJyZW50U3R5bGUgPwoJCQkJCWVsZW0uY3VycmVudFN0eWxlLmZpbHRlciA6CgkJCQkJZWxlbS5zdHlsZS5maWx0ZXIgKSB8fCAiIiApID8KCQkJCQkJKCAwLjAxICogcGFyc2VGbG9hdCggUmVnRXhwLiQxICkgKSArICIiIDoKCQkJCQkJY29tcHV0ZWQgPyAiMSIgOiAiIjsKCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJdmFyIHN0eWxlID0gZWxlbS5zdHlsZSwKCQkJCQljdXJyZW50U3R5bGUgPSBlbGVtLmN1cnJlbnRTdHlsZSwKCQkJCQlvcGFjaXR5ID0galF1ZXJ5LmlzTnVtZXJpYyggdmFsdWUgKSA/ICJhbHBoYShvcGFjaXR5PSIgKyB2YWx1ZSAqIDEwMCArICIpIiA6ICIiLAoJCQkJCWZpbHRlciA9IGN1cnJlbnRTdHlsZSAmJiBjdXJyZW50U3R5bGUuZmlsdGVyIHx8IHN0eWxlLmZpbHRlciB8fCAiIjsKCgkJCQkvLyBJRSBoYXMgdHJvdWJsZSB3aXRoIG9wYWNpdHkgaWYgaXQgZG9lcyBub3QgaGF2ZSBsYXlvdXQKCQkJCS8vIEZvcmNlIGl0IGJ5IHNldHRpbmcgdGhlIHpvb20gbGV2ZWwKCQkJCXN0eWxlLnpvb20gPSAxOwoKCQkJCS8vIGlmIHNldHRpbmcgb3BhY2l0eSB0byAxLCBhbmQgbm8gb3RoZXIgZmlsdGVycyBleGlzdCAtCgkJCQkvLyBhdHRlbXB0IHRvIHJlbW92ZSBmaWx0ZXIgYXR0cmlidXRlICM2NjUyCgkJCQkvLyBpZiB2YWx1ZSA9PT0gIiIsIHRoZW4gcmVtb3ZlIGlubGluZSBvcGFjaXR5ICMxMjY4NQoJCQkJaWYgKCAoIHZhbHVlID49IDEgfHwgdmFsdWUgPT09ICIiICkgJiYKCQkJCQkJalF1ZXJ5LnRyaW0oIGZpbHRlci5yZXBsYWNlKCByYWxwaGEsICIiICkgKSA9PT0gIiIgJiYKCQkJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlICkgewoKCQkJCQkvLyBTZXR0aW5nIHN0eWxlLmZpbHRlciB0byBudWxsLCAiIiAmICIgIiBzdGlsbCBsZWF2ZSAiZmlsdGVyOiIgaW4gdGhlIGNzc1RleHQKCQkJCQkvLyBpZiAiZmlsdGVyOiIgaXMgcHJlc2VudCBhdCBhbGwsIGNsZWFyVHlwZSBpcyBkaXNhYmxlZCwgd2Ugd2FudCB0byBhdm9pZCB0aGlzCgkJCQkJLy8gc3R5bGUucmVtb3ZlQXR0cmlidXRlIGlzIElFIE9ubHksIGJ1dCBzbyBhcHBhcmVudGx5IGlzIHRoaXMgY29kZSBwYXRoLi4uCgkJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlKCAiZmlsdGVyIiApOwoKCQkJCQkvLyBpZiB0aGVyZSBpcyBubyBmaWx0ZXIgc3R5bGUgYXBwbGllZCBpbiBhIGNzcyBydWxlCgkJCQkJLy8gb3IgdW5zZXQgaW5saW5lIG9wYWNpdHksIHdlIGFyZSBkb25lCgkJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgfHwgY3VycmVudFN0eWxlICYmICFjdXJyZW50U3R5bGUuZmlsdGVyICkgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoKCQkJCS8vIG90aGVyd2lzZSwgc2V0IG5ldyBmaWx0ZXIgdmFsdWVzCgkJCQlzdHlsZS5maWx0ZXIgPSByYWxwaGEudGVzdCggZmlsdGVyICkgPwoJCQkJCWZpbHRlci5yZXBsYWNlKCByYWxwaGEsIG9wYWNpdHkgKSA6CgkJCQkJZmlsdGVyICsgIiAiICsgb3BhY2l0eTsKCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmNzc0hvb2tzLm1hcmdpblJpZ2h0ID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQsCgkJZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQlpZiAoIGNvbXB1dGVkICkgewoJCQkJcmV0dXJuIHN3YXAoIGVsZW0sIHsgImRpc3BsYXkiOiAiaW5saW5lLWJsb2NrIiB9LAoJCQkJCWN1ckNTUywgWyBlbGVtLCAibWFyZ2luUmlnaHQiIF0gKTsKCQkJfQoJCX0KCSk7CgoJalF1ZXJ5LmNzc0hvb2tzLm1hcmdpbkxlZnQgPSBhZGRHZXRIb29rSWYoIHN1cHBvcnQucmVsaWFibGVNYXJnaW5MZWZ0LAoJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCXJldHVybiAoCgkJCQkJcGFyc2VGbG9hdCggY3VyQ1NTKCBlbGVtLCAibWFyZ2luTGVmdCIgKSApIHx8CgoJCQkJCS8vIFN1cHBvcnQ6IElFPD0xMSsKCQkJCQkvLyBSdW5uaW5nIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBvbiBhIGRpc2Nvbm5lY3RlZCBub2RlIGluIElFIHRocm93cyBhbiBlcnJvcgoJCQkJCS8vIFN1cHBvcnQ6IElFOCBvbmx5CgkJCQkJLy8gZ2V0Q2xpZW50UmVjdHMoKSBlcnJvcnMgb24gZGlzY29ubmVjdGVkIGVsZW1zCgkJCQkJKCBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApID8KCQkJCQkJZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0KCQkJCQkJCXN3YXAoIGVsZW0sIHsgbWFyZ2luTGVmdDogMCB9LCBmdW5jdGlvbigpIHsKCQkJCQkJCQlyZXR1cm4gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0OwoJCQkJCQkJfSApIDoKCQkJCQkJMAoJCQkJCSkKCQkJCSkgKyAicHgiOwoJCQl9CgkJfQoJKTsKCgkvLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzCglqUXVlcnkuZWFjaCggewoJCW1hcmdpbjogIiIsCgkJcGFkZGluZzogIiIsCgkJYm9yZGVyOiAiV2lkdGgiCgl9LCBmdW5jdGlvbiggcHJlZml4LCBzdWZmaXggKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXSA9IHsKCQkJZXhwYW5kOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQl2YXIgaSA9IDAsCgkJCQkJZXhwYW5kZWQgPSB7fSwKCgkJCQkJLy8gYXNzdW1lcyBhIHNpbmdsZSBudW1iZXIgaWYgbm90IGEgc3RyaW5nCgkJCQkJcGFydHMgPSB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciID8gdmFsdWUuc3BsaXQoICIgIiApIDogWyB2YWx1ZSBdOwoKCQkJCWZvciAoIDsgaSA8IDQ7IGkrKyApIHsKCQkJCQlleHBhbmRlZFsgcHJlZml4ICsgY3NzRXhwYW5kWyBpIF0gKyBzdWZmaXggXSA9CgkJCQkJCXBhcnRzWyBpIF0gfHwgcGFydHNbIGkgLSAyIF0gfHwgcGFydHNbIDAgXTsKCQkJCX0KCgkJCQlyZXR1cm4gZXhwYW5kZWQ7CgkJCX0KCQl9OwoKCQlpZiAoICFybWFyZ2luLnRlc3QoIHByZWZpeCApICkgewoJCQlqUXVlcnkuY3NzSG9va3NbIHByZWZpeCArIHN1ZmZpeCBdLnNldCA9IHNldFBvc2l0aXZlTnVtYmVyOwoJCX0KCX0gKTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJY3NzOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHsKCQkJCXZhciBzdHlsZXMsIGxlbiwKCQkJCQltYXAgPSB7fSwKCQkJCQlpID0gMDsKCgkJCQlpZiAoIGpRdWVyeS5pc0FycmF5KCBuYW1lICkgKSB7CgkJCQkJc3R5bGVzID0gZ2V0U3R5bGVzKCBlbGVtICk7CgkJCQkJbGVuID0gbmFtZS5sZW5ndGg7CgoJCQkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCQltYXBbIG5hbWVbIGkgXSBdID0galF1ZXJ5LmNzcyggZWxlbSwgbmFtZVsgaSBdLCBmYWxzZSwgc3R5bGVzICk7CgkJCQkJfQoKCQkJCQlyZXR1cm4gbWFwOwoJCQkJfQoKCQkJCXJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8KCQkJCQlqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUsIHZhbHVlICkgOgoJCQkJCWpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKTsKCQkJfSwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxICk7CgkJfSwKCQlzaG93OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHNob3dIaWRlKCB0aGlzLCB0cnVlICk7CgkJfSwKCQloaWRlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHNob3dIaWRlKCB0aGlzICk7CgkJfSwKCQl0b2dnbGU6IGZ1bmN0aW9uKCBzdGF0ZSApIHsKCQkJaWYgKCB0eXBlb2Ygc3RhdGUgPT09ICJib29sZWFuIiApIHsKCQkJCXJldHVybiBzdGF0ZSA/IHRoaXMuc2hvdygpIDogdGhpcy5oaWRlKCk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBpc0hpZGRlbiggdGhpcyApICkgewoJCQkJCWpRdWVyeSggdGhpcyApLnNob3coKTsKCQkJCX0gZWxzZSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkuaGlkZSgpOwoJCQkJfQoJCQl9ICk7CgkJfQoJfSApOwoKCglmdW5jdGlvbiBUd2VlbiggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcgKSB7CgkJcmV0dXJuIG5ldyBUd2Vlbi5wcm90b3R5cGUuaW5pdCggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcgKTsKCX0KCWpRdWVyeS5Ud2VlbiA9IFR3ZWVuOwoKCVR3ZWVuLnByb3RvdHlwZSA9IHsKCQljb25zdHJ1Y3RvcjogVHdlZW4sCgkJaW5pdDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nLCB1bml0ICkgewoJCQl0aGlzLmVsZW0gPSBlbGVtOwoJCQl0aGlzLnByb3AgPSBwcm9wOwoJCQl0aGlzLmVhc2luZyA9IGVhc2luZyB8fCBqUXVlcnkuZWFzaW5nLl9kZWZhdWx0OwoJCQl0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwoJCQl0aGlzLnN0YXJ0ID0gdGhpcy5ub3cgPSB0aGlzLmN1cigpOwoJCQl0aGlzLmVuZCA9IGVuZDsKCQkJdGhpcy51bml0ID0gdW5pdCB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSA/ICIiIDogInB4IiApOwoJCX0sCgkJY3VyOiBmdW5jdGlvbigpIHsKCQkJdmFyIGhvb2tzID0gVHdlZW4ucHJvcEhvb2tzWyB0aGlzLnByb3AgXTsKCgkJCXJldHVybiBob29rcyAmJiBob29rcy5nZXQgPwoJCQkJaG9va3MuZ2V0KCB0aGlzICkgOgoJCQkJVHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LmdldCggdGhpcyApOwoJCX0sCgkJcnVuOiBmdW5jdGlvbiggcGVyY2VudCApIHsKCQkJdmFyIGVhc2VkLAoJCQkJaG9va3MgPSBUd2Vlbi5wcm9wSG9va3NbIHRoaXMucHJvcCBdOwoKCQkJaWYgKCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKSB7CgkJCQl0aGlzLnBvcyA9IGVhc2VkID0galF1ZXJ5LmVhc2luZ1sgdGhpcy5lYXNpbmcgXSgKCQkJCQlwZXJjZW50LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiBwZXJjZW50LCAwLCAxLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24KCQkJCSk7CgkJCX0gZWxzZSB7CgkJCQl0aGlzLnBvcyA9IGVhc2VkID0gcGVyY2VudDsKCQkJfQoJCQl0aGlzLm5vdyA9ICggdGhpcy5lbmQgLSB0aGlzLnN0YXJ0ICkgKiBlYXNlZCArIHRoaXMuc3RhcnQ7CgoJCQlpZiAoIHRoaXMub3B0aW9ucy5zdGVwICkgewoJCQkJdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCggdGhpcy5lbGVtLCB0aGlzLm5vdywgdGhpcyApOwoJCQl9CgoJCQlpZiAoIGhvb2tzICYmIGhvb2tzLnNldCApIHsKCQkJCWhvb2tzLnNldCggdGhpcyApOwoJCQl9IGVsc2UgewoJCQkJVHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCggdGhpcyApOwoJCQl9CgkJCXJldHVybiB0aGlzOwoJCX0KCX07CgoJVHdlZW4ucHJvdG90eXBlLmluaXQucHJvdG90eXBlID0gVHdlZW4ucHJvdG90eXBlOwoKCVR3ZWVuLnByb3BIb29rcyA9IHsKCQlfZGVmYXVsdDogewoJCQlnZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHsKCQkJCXZhciByZXN1bHQ7CgoJCQkJLy8gVXNlIGEgcHJvcGVydHkgb24gdGhlIGVsZW1lbnQgZGlyZWN0bHkgd2hlbiBpdCBpcyBub3QgYSBET00gZWxlbWVudCwKCQkJCS8vIG9yIHdoZW4gdGhlcmUgaXMgbm8gbWF0Y2hpbmcgc3R5bGUgcHJvcGVydHkgdGhhdCBleGlzdHMuCgkJCQlpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgIT09IDEgfHwKCQkJCQl0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gIT0gbnVsbCAmJiB0d2Vlbi5lbGVtLnN0eWxlWyB0d2Vlbi5wcm9wIF0gPT0gbnVsbCApIHsKCQkJCQlyZXR1cm4gdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdOwoJCQkJfQoKCQkJCS8vIHBhc3NpbmcgYW4gZW1wdHkgc3RyaW5nIGFzIGEgM3JkIHBhcmFtZXRlciB0byAuY3NzIHdpbGwgYXV0b21hdGljYWxseQoJCQkJLy8gYXR0ZW1wdCBhIHBhcnNlRmxvYXQgYW5kIGZhbGxiYWNrIHRvIGEgc3RyaW5nIGlmIHRoZSBwYXJzZSBmYWlscwoJCQkJLy8gc28sIHNpbXBsZSB2YWx1ZXMgc3VjaCBhcyAiMTBweCIgYXJlIHBhcnNlZCB0byBGbG9hdC4KCQkJCS8vIGNvbXBsZXggdmFsdWVzIHN1Y2ggYXMgInJvdGF0ZSgxcmFkKSIgYXJlIHJldHVybmVkIGFzIGlzLgoJCQkJcmVzdWx0ID0galF1ZXJ5LmNzcyggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgIiIgKTsKCgkJCQkvLyBFbXB0eSBzdHJpbmdzLCBudWxsLCB1bmRlZmluZWQgYW5kICJhdXRvIiBhcmUgY29udmVydGVkIHRvIDAuCgkJCQlyZXR1cm4gIXJlc3VsdCB8fCByZXN1bHQgPT09ICJhdXRvIiA/IDAgOiByZXN1bHQ7CgkJCX0sCgkJCXNldDogZnVuY3Rpb24oIHR3ZWVuICkgewoKCQkJCS8vIHVzZSBzdGVwIGhvb2sgZm9yIGJhY2sgY29tcGF0IC0gdXNlIGNzc0hvb2sgaWYgaXRzIHRoZXJlIC0gdXNlIC5zdHlsZSBpZiBpdHMKCQkJCS8vIGF2YWlsYWJsZSBhbmQgdXNlIHBsYWluIHByb3BlcnRpZXMgd2hlcmUgYXZhaWxhYmxlCgkJCQlpZiAoIGpRdWVyeS5meC5zdGVwWyB0d2Vlbi5wcm9wIF0gKSB7CgkJCQkJalF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSggdHdlZW4gKTsKCQkJCX0gZWxzZSBpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkoIHR3ZWVuLmVsZW0uc3R5bGVbIGpRdWVyeS5jc3NQcm9wc1sgdHdlZW4ucHJvcCBdIF0gIT0gbnVsbCB8fAoJCQkJCQlqUXVlcnkuY3NzSG9va3NbIHR3ZWVuLnByb3AgXSApICkgewoJCQkJCWpRdWVyeS5zdHlsZSggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgdHdlZW4ubm93ICsgdHdlZW4udW5pdCApOwoJCQkJfSBlbHNlIHsKCQkJCQl0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7CgkJCQl9CgkJCX0KCQl9Cgl9OwoKCS8vIFN1cHBvcnQ6IElFIDw9OQoJLy8gUGFuaWMgYmFzZWQgYXBwcm9hY2ggdG8gc2V0dGluZyB0aGluZ3Mgb24gZGlzY29ubmVjdGVkIG5vZGVzCgoJVHdlZW4ucHJvcEhvb2tzLnNjcm9sbFRvcCA9IFR3ZWVuLnByb3BIb29rcy5zY3JvbGxMZWZ0ID0gewoJCXNldDogZnVuY3Rpb24oIHR3ZWVuICkgewoJCQlpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgJiYgdHdlZW4uZWxlbS5wYXJlbnROb2RlICkgewoJCQkJdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdID0gdHdlZW4ubm93OwoJCQl9CgkJfQoJfTsKCglqUXVlcnkuZWFzaW5nID0gewoJCWxpbmVhcjogZnVuY3Rpb24oIHAgKSB7CgkJCXJldHVybiBwOwoJCX0sCgkJc3dpbmc6IGZ1bmN0aW9uKCBwICkgewoJCQlyZXR1cm4gMC41IC0gTWF0aC5jb3MoIHAgKiBNYXRoLlBJICkgLyAyOwoJCX0sCgkJX2RlZmF1bHQ6ICJzd2luZyIKCX07CgoJalF1ZXJ5LmZ4ID0gVHdlZW4ucHJvdG90eXBlLmluaXQ7CgoJLy8gQmFjayBDb21wYXQgPDEuOCBleHRlbnNpb24gcG9pbnQKCWpRdWVyeS5meC5zdGVwID0ge307CgoKCgoJdmFyCgkJZnhOb3csIHRpbWVySWQsCgkJcmZ4dHlwZXMgPSAvXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sCgkJcnJ1biA9IC9xdWV1ZUhvb2tzJC87CgoJLy8gQW5pbWF0aW9ucyBjcmVhdGVkIHN5bmNocm9ub3VzbHkgd2lsbCBydW4gc3luY2hyb25vdXNseQoJZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7CgkJd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQlmeE5vdyA9IHVuZGVmaW5lZDsKCQl9ICk7CgkJcmV0dXJuICggZnhOb3cgPSBqUXVlcnkubm93KCkgKTsKCX0KCgkvLyBHZW5lcmF0ZSBwYXJhbWV0ZXJzIHRvIGNyZWF0ZSBhIHN0YW5kYXJkIGFuaW1hdGlvbgoJZnVuY3Rpb24gZ2VuRngoIHR5cGUsIGluY2x1ZGVXaWR0aCApIHsKCQl2YXIgd2hpY2gsCgkJCWF0dHJzID0geyBoZWlnaHQ6IHR5cGUgfSwKCQkJaSA9IDA7CgoJCS8vIGlmIHdlIGluY2x1ZGUgd2lkdGgsIHN0ZXAgdmFsdWUgaXMgMSB0byBkbyBhbGwgY3NzRXhwYW5kIHZhbHVlcywKCQkvLyBpZiB3ZSBkb24ndCBpbmNsdWRlIHdpZHRoLCBzdGVwIHZhbHVlIGlzIDIgdG8gc2tpcCBvdmVyIExlZnQgYW5kIFJpZ2h0CgkJaW5jbHVkZVdpZHRoID0gaW5jbHVkZVdpZHRoID8gMSA6IDA7CgkJZm9yICggOyBpIDwgNCA7IGkgKz0gMiAtIGluY2x1ZGVXaWR0aCApIHsKCQkJd2hpY2ggPSBjc3NFeHBhbmRbIGkgXTsKCQkJYXR0cnNbICJtYXJnaW4iICsgd2hpY2ggXSA9IGF0dHJzWyAicGFkZGluZyIgKyB3aGljaCBdID0gdHlwZTsKCQl9CgoJCWlmICggaW5jbHVkZVdpZHRoICkgewoJCQlhdHRycy5vcGFjaXR5ID0gYXR0cnMud2lkdGggPSB0eXBlOwoJCX0KCgkJcmV0dXJuIGF0dHJzOwoJfQoKCWZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKCB2YWx1ZSwgcHJvcCwgYW5pbWF0aW9uICkgewoJCXZhciB0d2VlbiwKCQkJY29sbGVjdGlvbiA9ICggQW5pbWF0aW9uLnR3ZWVuZXJzWyBwcm9wIF0gfHwgW10gKS5jb25jYXQoIEFuaW1hdGlvbi50d2VlbmVyc1sgIioiIF0gKSwKCQkJaW5kZXggPSAwLAoJCQlsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDsKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQlpZiAoICggdHdlZW4gPSBjb2xsZWN0aW9uWyBpbmRleCBdLmNhbGwoIGFuaW1hdGlvbiwgcHJvcCwgdmFsdWUgKSApICkgewoKCQkJCS8vIHdlJ3JlIGRvbmUgd2l0aCB0aGlzIHByb3BlcnR5CgkJCQlyZXR1cm4gdHdlZW47CgkJCX0KCQl9Cgl9CgoJZnVuY3Rpb24gZGVmYXVsdFByZWZpbHRlciggZWxlbSwgcHJvcHMsIG9wdHMgKSB7CgkJLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqLwoJCXZhciBwcm9wLCB2YWx1ZSwgdG9nZ2xlLCB0d2VlbiwgaG9va3MsIG9sZGZpcmUsIGRpc3BsYXksIGNoZWNrRGlzcGxheSwKCQkJYW5pbSA9IHRoaXMsCgkJCW9yaWcgPSB7fSwKCQkJc3R5bGUgPSBlbGVtLnN0eWxlLAoJCQloaWRkZW4gPSBlbGVtLm5vZGVUeXBlICYmIGlzSGlkZGVuKCBlbGVtICksCgkJCWRhdGFTaG93ID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAiZnhzaG93IiApOwoKCQkvLyBoYW5kbGUgcXVldWU6IGZhbHNlIHByb21pc2VzCgkJaWYgKCAhb3B0cy5xdWV1ZSApIHsKCQkJaG9va3MgPSBqUXVlcnkuX3F1ZXVlSG9va3MoIGVsZW0sICJmeCIgKTsKCQkJaWYgKCBob29rcy51bnF1ZXVlZCA9PSBudWxsICkgewoJCQkJaG9va3MudW5xdWV1ZWQgPSAwOwoJCQkJb2xkZmlyZSA9IGhvb2tzLmVtcHR5LmZpcmU7CgkJCQlob29rcy5lbXB0eS5maXJlID0gZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCAhaG9va3MudW5xdWV1ZWQgKSB7CgkJCQkJCW9sZGZpcmUoKTsKCQkJCQl9CgkJCQl9OwoJCQl9CgkJCWhvb2tzLnVucXVldWVkKys7CgoJCQlhbmltLmFsd2F5cyggZnVuY3Rpb24oKSB7CgoJCQkJLy8gZG9pbmcgdGhpcyBtYWtlcyBzdXJlIHRoYXQgdGhlIGNvbXBsZXRlIGhhbmRsZXIgd2lsbCBiZSBjYWxsZWQKCQkJCS8vIGJlZm9yZSB0aGlzIGNvbXBsZXRlcwoJCQkJYW5pbS5hbHdheXMoIGZ1bmN0aW9uKCkgewoJCQkJCWhvb2tzLnVucXVldWVkLS07CgkJCQkJaWYgKCAhalF1ZXJ5LnF1ZXVlKCBlbGVtLCAiZngiICkubGVuZ3RoICkgewoJCQkJCQlob29rcy5lbXB0eS5maXJlKCk7CgkJCQkJfQoJCQkJfSApOwoJCQl9ICk7CgkJfQoKCQkvLyBoZWlnaHQvd2lkdGggb3ZlcmZsb3cgcGFzcwoJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoICJoZWlnaHQiIGluIHByb3BzIHx8ICJ3aWR0aCIgaW4gcHJvcHMgKSApIHsKCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IG5vdGhpbmcgc25lYWtzIG91dAoJCQkvLyBSZWNvcmQgYWxsIDMgb3ZlcmZsb3cgYXR0cmlidXRlcyBiZWNhdXNlIElFIGRvZXMgbm90CgkJCS8vIGNoYW5nZSB0aGUgb3ZlcmZsb3cgYXR0cmlidXRlIHdoZW4gb3ZlcmZsb3dYIGFuZAoJCQkvLyBvdmVyZmxvd1kgYXJlIHNldCB0byB0aGUgc2FtZSB2YWx1ZQoJCQlvcHRzLm92ZXJmbG93ID0gWyBzdHlsZS5vdmVyZmxvdywgc3R5bGUub3ZlcmZsb3dYLCBzdHlsZS5vdmVyZmxvd1kgXTsKCgkJCS8vIFNldCBkaXNwbGF5IHByb3BlcnR5IHRvIGlubGluZS1ibG9jayBmb3IgaGVpZ2h0L3dpZHRoCgkJCS8vIGFuaW1hdGlvbnMgb24gaW5saW5lIGVsZW1lbnRzIHRoYXQgYXJlIGhhdmluZyB3aWR0aC9oZWlnaHQgYW5pbWF0ZWQKCQkJZGlzcGxheSA9IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApOwoKCQkJLy8gVGVzdCBkZWZhdWx0IGRpc3BsYXkgaWYgZGlzcGxheSBpcyBjdXJyZW50bHkgIm5vbmUiCgkJCWNoZWNrRGlzcGxheSA9IGRpc3BsYXkgPT09ICJub25lIiA/CgkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJvbGRkaXNwbGF5IiApIHx8IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgOiBkaXNwbGF5OwoKCQkJaWYgKCBjaGVja0Rpc3BsYXkgPT09ICJpbmxpbmUiICYmIGpRdWVyeS5jc3MoIGVsZW0sICJmbG9hdCIgKSA9PT0gIm5vbmUiICkgewoKCQkJCS8vIGlubGluZS1sZXZlbCBlbGVtZW50cyBhY2NlcHQgaW5saW5lLWJsb2NrOwoJCQkJLy8gYmxvY2stbGV2ZWwgZWxlbWVudHMgbmVlZCB0byBiZSBpbmxpbmUgd2l0aCBsYXlvdXQKCQkJCWlmICggIXN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dCB8fCBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApID09PSAiaW5saW5lIiApIHsKCQkJCQlzdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CgkJCQl9IGVsc2UgewoJCQkJCXN0eWxlLnpvb20gPSAxOwoJCQkJfQoJCQl9CgkJfQoKCQlpZiAoIG9wdHMub3ZlcmZsb3cgKSB7CgkJCXN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CgkJCWlmICggIXN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcygpICkgewoJCQkJYW5pbS5hbHdheXMoIGZ1bmN0aW9uKCkgewoJCQkJCXN0eWxlLm92ZXJmbG93ID0gb3B0cy5vdmVyZmxvd1sgMCBdOwoJCQkJCXN0eWxlLm92ZXJmbG93WCA9IG9wdHMub3ZlcmZsb3dbIDEgXTsKCQkJCQlzdHlsZS5vdmVyZmxvd1kgPSBvcHRzLm92ZXJmbG93WyAyIF07CgkJCQl9ICk7CgkJCX0KCQl9CgoJCS8vIHNob3cvaGlkZSBwYXNzCgkJZm9yICggcHJvcCBpbiBwcm9wcyApIHsKCQkJdmFsdWUgPSBwcm9wc1sgcHJvcCBdOwoJCQlpZiAoIHJmeHR5cGVzLmV4ZWMoIHZhbHVlICkgKSB7CgkJCQlkZWxldGUgcHJvcHNbIHByb3AgXTsKCQkJCXRvZ2dsZSA9IHRvZ2dsZSB8fCB2YWx1ZSA9PT0gInRvZ2dsZSI7CgkJCQlpZiAoIHZhbHVlID09PSAoIGhpZGRlbiA/ICJoaWRlIiA6ICJzaG93IiApICkgewoKCQkJCQkvLyBJZiB0aGVyZSBpcyBkYXRhU2hvdyBsZWZ0IG92ZXIgZnJvbSBhIHN0b3BwZWQgaGlkZSBvciBzaG93CgkJCQkJLy8gYW5kIHdlIGFyZSBnb2luZyB0byBwcm9jZWVkIHdpdGggc2hvdywgd2Ugc2hvdWxkIHByZXRlbmQgdG8gYmUgaGlkZGVuCgkJCQkJaWYgKCB2YWx1ZSA9PT0gInNob3ciICYmIGRhdGFTaG93ICYmIGRhdGFTaG93WyBwcm9wIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJaGlkZGVuID0gdHJ1ZTsKCQkJCQl9IGVsc2UgewoJCQkJCQljb250aW51ZTsKCQkJCQl9CgkJCQl9CgkJCQlvcmlnWyBwcm9wIF0gPSBkYXRhU2hvdyAmJiBkYXRhU2hvd1sgcHJvcCBdIHx8IGpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCApOwoKCQkJLy8gQW55IG5vbi1meCB2YWx1ZSBzdG9wcyB1cyBmcm9tIHJlc3RvcmluZyB0aGUgb3JpZ2luYWwgZGlzcGxheSB2YWx1ZQoJCQl9IGVsc2UgewoJCQkJZGlzcGxheSA9IHVuZGVmaW5lZDsKCQkJfQoJCX0KCgkJaWYgKCAhalF1ZXJ5LmlzRW1wdHlPYmplY3QoIG9yaWcgKSApIHsKCQkJaWYgKCBkYXRhU2hvdyApIHsKCQkJCWlmICggImhpZGRlbiIgaW4gZGF0YVNob3cgKSB7CgkJCQkJaGlkZGVuID0gZGF0YVNob3cuaGlkZGVuOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZGF0YVNob3cgPSBqUXVlcnkuX2RhdGEoIGVsZW0sICJmeHNob3ciLCB7fSApOwoJCQl9CgoJCQkvLyBzdG9yZSBzdGF0ZSBpZiBpdHMgdG9nZ2xlIC0gZW5hYmxlcyAuc3RvcCgpLnRvZ2dsZSgpIHRvICJyZXZlcnNlIgoJCQlpZiAoIHRvZ2dsZSApIHsKCQkJCWRhdGFTaG93LmhpZGRlbiA9ICFoaWRkZW47CgkJCX0KCQkJaWYgKCBoaWRkZW4gKSB7CgkJCQlqUXVlcnkoIGVsZW0gKS5zaG93KCk7CgkJCX0gZWxzZSB7CgkJCQlhbmltLmRvbmUoIGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeSggZWxlbSApLmhpZGUoKTsKCQkJCX0gKTsKCQkJfQoJCQlhbmltLmRvbmUoIGZ1bmN0aW9uKCkgewoJCQkJdmFyIHByb3A7CgkJCQlqUXVlcnkuX3JlbW92ZURhdGEoIGVsZW0sICJmeHNob3ciICk7CgkJCQlmb3IgKCBwcm9wIGluIG9yaWcgKSB7CgkJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCBwcm9wLCBvcmlnWyBwcm9wIF0gKTsKCQkJCX0KCQkJfSApOwoJCQlmb3IgKCBwcm9wIGluIG9yaWcgKSB7CgkJCQl0d2VlbiA9IGNyZWF0ZVR3ZWVuKCBoaWRkZW4gPyBkYXRhU2hvd1sgcHJvcCBdIDogMCwgcHJvcCwgYW5pbSApOwoKCQkJCWlmICggISggcHJvcCBpbiBkYXRhU2hvdyApICkgewoJCQkJCWRhdGFTaG93WyBwcm9wIF0gPSB0d2Vlbi5zdGFydDsKCQkJCQlpZiAoIGhpZGRlbiApIHsKCQkJCQkJdHdlZW4uZW5kID0gdHdlZW4uc3RhcnQ7CgkJCQkJCXR3ZWVuLnN0YXJ0ID0gcHJvcCA9PT0gIndpZHRoIiB8fCBwcm9wID09PSAiaGVpZ2h0IiA/IDEgOiAwOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkvLyBJZiB0aGlzIGlzIGEgbm9vcCBsaWtlIC5oaWRlKCkuaGlkZSgpLCByZXN0b3JlIGFuIG92ZXJ3cml0dGVuIGRpc3BsYXkgdmFsdWUKCQl9IGVsc2UgaWYgKCAoIGRpc3BsYXkgPT09ICJub25lIiA/IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgOiBkaXNwbGF5ICkgPT09ICJpbmxpbmUiICkgewoJCQlzdHlsZS5kaXNwbGF5ID0gZGlzcGxheTsKCQl9Cgl9CgoJZnVuY3Rpb24gcHJvcEZpbHRlciggcHJvcHMsIHNwZWNpYWxFYXNpbmcgKSB7CgkJdmFyIGluZGV4LCBuYW1lLCBlYXNpbmcsIHZhbHVlLCBob29rczsKCgkJLy8gY2FtZWxDYXNlLCBzcGVjaWFsRWFzaW5nIGFuZCBleHBhbmQgY3NzSG9vayBwYXNzCgkJZm9yICggaW5kZXggaW4gcHJvcHMgKSB7CgkJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBpbmRleCApOwoJCQllYXNpbmcgPSBzcGVjaWFsRWFzaW5nWyBuYW1lIF07CgkJCXZhbHVlID0gcHJvcHNbIGluZGV4IF07CgkJCWlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7CgkJCQllYXNpbmcgPSB2YWx1ZVsgMSBdOwoJCQkJdmFsdWUgPSBwcm9wc1sgaW5kZXggXSA9IHZhbHVlWyAwIF07CgkJCX0KCgkJCWlmICggaW5kZXggIT09IG5hbWUgKSB7CgkJCQlwcm9wc1sgbmFtZSBdID0gdmFsdWU7CgkJCQlkZWxldGUgcHJvcHNbIGluZGV4IF07CgkJCX0KCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF07CgkJCWlmICggaG9va3MgJiYgImV4cGFuZCIgaW4gaG9va3MgKSB7CgkJCQl2YWx1ZSA9IGhvb2tzLmV4cGFuZCggdmFsdWUgKTsKCQkJCWRlbGV0ZSBwcm9wc1sgbmFtZSBdOwoKCQkJCS8vIG5vdCBxdWl0ZSAkLmV4dGVuZCwgdGhpcyB3b250IG92ZXJ3cml0ZSBrZXlzIGFscmVhZHkgcHJlc2VudC4KCQkJCS8vIGFsc28gLSByZXVzaW5nICdpbmRleCcgZnJvbSBhYm92ZSBiZWNhdXNlIHdlIGhhdmUgdGhlIGNvcnJlY3QgIm5hbWUiCgkJCQlmb3IgKCBpbmRleCBpbiB2YWx1ZSApIHsKCQkJCQlpZiAoICEoIGluZGV4IGluIHByb3BzICkgKSB7CgkJCQkJCXByb3BzWyBpbmRleCBdID0gdmFsdWVbIGluZGV4IF07CgkJCQkJCXNwZWNpYWxFYXNpbmdbIGluZGV4IF0gPSBlYXNpbmc7CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJc3BlY2lhbEVhc2luZ1sgbmFtZSBdID0gZWFzaW5nOwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIEFuaW1hdGlvbiggZWxlbSwgcHJvcGVydGllcywgb3B0aW9ucyApIHsKCQl2YXIgcmVzdWx0LAoJCQlzdG9wcGVkLAoJCQlpbmRleCA9IDAsCgkJCWxlbmd0aCA9IEFuaW1hdGlvbi5wcmVmaWx0ZXJzLmxlbmd0aCwKCQkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKS5hbHdheXMoIGZ1bmN0aW9uKCkgewoKCQkJCS8vIGRvbid0IG1hdGNoIGVsZW0gaW4gdGhlIDphbmltYXRlZCBzZWxlY3RvcgoJCQkJZGVsZXRlIHRpY2suZWxlbTsKCQkJfSApLAoJCQl0aWNrID0gZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHN0b3BwZWQgKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQkJdmFyIGN1cnJlbnRUaW1lID0gZnhOb3cgfHwgY3JlYXRlRnhOb3coKSwKCQkJCQlyZW1haW5pbmcgPSBNYXRoLm1heCggMCwgYW5pbWF0aW9uLnN0YXJ0VGltZSArIGFuaW1hdGlvbi5kdXJhdGlvbiAtIGN1cnJlbnRUaW1lICksCgoJCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCQkJLy8gQXJjaGFpYyBjcmFzaCBidWcgd29uJ3QgYWxsb3cgdXMgdG8gdXNlIGAxIC0gKCAwLjUgfHwgMCApYCAoIzEyNDk3KQoJCQkJCXRlbXAgPSByZW1haW5pbmcgLyBhbmltYXRpb24uZHVyYXRpb24gfHwgMCwKCQkJCQlwZXJjZW50ID0gMSAtIHRlbXAsCgkJCQkJaW5kZXggPSAwLAoJCQkJCWxlbmd0aCA9IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoOwoKCQkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJCWFuaW1hdGlvbi50d2VlbnNbIGluZGV4IF0ucnVuKCBwZXJjZW50ICk7CgkJCQl9CgoJCQkJZGVmZXJyZWQubm90aWZ5V2l0aCggZWxlbSwgWyBhbmltYXRpb24sIHBlcmNlbnQsIHJlbWFpbmluZyBdICk7CgoJCQkJaWYgKCBwZXJjZW50IDwgMSAmJiBsZW5ndGggKSB7CgkJCQkJcmV0dXJuIHJlbWFpbmluZzsKCQkJCX0gZWxzZSB7CgkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uIF0gKTsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0sCgkJCWFuaW1hdGlvbiA9IGRlZmVycmVkLnByb21pc2UoIHsKCQkJCWVsZW06IGVsZW0sCgkJCQlwcm9wczogalF1ZXJ5LmV4dGVuZCgge30sIHByb3BlcnRpZXMgKSwKCQkJCW9wdHM6IGpRdWVyeS5leHRlbmQoIHRydWUsIHsKCQkJCQlzcGVjaWFsRWFzaW5nOiB7fSwKCQkJCQllYXNpbmc6IGpRdWVyeS5lYXNpbmcuX2RlZmF1bHQKCQkJCX0sIG9wdGlvbnMgKSwKCQkJCW9yaWdpbmFsUHJvcGVydGllczogcHJvcGVydGllcywKCQkJCW9yaWdpbmFsT3B0aW9uczogb3B0aW9ucywKCQkJCXN0YXJ0VGltZTogZnhOb3cgfHwgY3JlYXRlRnhOb3coKSwKCQkJCWR1cmF0aW9uOiBvcHRpb25zLmR1cmF0aW9uLAoJCQkJdHdlZW5zOiBbXSwKCQkJCWNyZWF0ZVR3ZWVuOiBmdW5jdGlvbiggcHJvcCwgZW5kICkgewoJCQkJCXZhciB0d2VlbiA9IGpRdWVyeS5Ud2VlbiggZWxlbSwgYW5pbWF0aW9uLm9wdHMsIHByb3AsIGVuZCwKCQkJCQkJCWFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmdbIHByb3AgXSB8fCBhbmltYXRpb24ub3B0cy5lYXNpbmcgKTsKCQkJCQlhbmltYXRpb24udHdlZW5zLnB1c2goIHR3ZWVuICk7CgkJCQkJcmV0dXJuIHR3ZWVuOwoJCQkJfSwKCQkJCXN0b3A6IGZ1bmN0aW9uKCBnb3RvRW5kICkgewoJCQkJCXZhciBpbmRleCA9IDAsCgoJCQkJCQkvLyBpZiB3ZSBhcmUgZ29pbmcgdG8gdGhlIGVuZCwgd2Ugd2FudCB0byBydW4gYWxsIHRoZSB0d2VlbnMKCQkJCQkJLy8gb3RoZXJ3aXNlIHdlIHNraXAgdGhpcyBwYXJ0CgkJCQkJCWxlbmd0aCA9IGdvdG9FbmQgPyBhbmltYXRpb24udHdlZW5zLmxlbmd0aCA6IDA7CgkJCQkJaWYgKCBzdG9wcGVkICkgewoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9CgkJCQkJc3RvcHBlZCA9IHRydWU7CgkJCQkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCQkJCWFuaW1hdGlvbi50d2VlbnNbIGluZGV4IF0ucnVuKCAxICk7CgkJCQkJfQoKCQkJCQkvLyByZXNvbHZlIHdoZW4gd2UgcGxheWVkIHRoZSBsYXN0IGZyYW1lCgkJCQkJLy8gb3RoZXJ3aXNlLCByZWplY3QKCQkJCQlpZiAoIGdvdG9FbmQgKSB7CgkJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCAxLCAwIF0gKTsKCQkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBnb3RvRW5kIF0gKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlkZWZlcnJlZC5yZWplY3RXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgZ290b0VuZCBdICk7CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfQoJCQl9ICksCgkJCXByb3BzID0gYW5pbWF0aW9uLnByb3BzOwoKCQlwcm9wRmlsdGVyKCBwcm9wcywgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZyApOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHsKCQkJcmVzdWx0ID0gQW5pbWF0aW9uLnByZWZpbHRlcnNbIGluZGV4IF0uY2FsbCggYW5pbWF0aW9uLCBlbGVtLCBwcm9wcywgYW5pbWF0aW9uLm9wdHMgKTsKCQkJaWYgKCByZXN1bHQgKSB7CgkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXN1bHQuc3RvcCApICkgewoJCQkJCWpRdWVyeS5fcXVldWVIb29rcyggYW5pbWF0aW9uLmVsZW0sIGFuaW1hdGlvbi5vcHRzLnF1ZXVlICkuc3RvcCA9CgkJCQkJCWpRdWVyeS5wcm94eSggcmVzdWx0LnN0b3AsIHJlc3VsdCApOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3VsdDsKCQkJfQoJCX0KCgkJalF1ZXJ5Lm1hcCggcHJvcHMsIGNyZWF0ZVR3ZWVuLCBhbmltYXRpb24gKTsKCgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggYW5pbWF0aW9uLm9wdHMuc3RhcnQgKSApIHsKCQkJYW5pbWF0aW9uLm9wdHMuc3RhcnQuY2FsbCggZWxlbSwgYW5pbWF0aW9uICk7CgkJfQoKCQlqUXVlcnkuZngudGltZXIoCgkJCWpRdWVyeS5leHRlbmQoIHRpY2ssIHsKCQkJCWVsZW06IGVsZW0sCgkJCQlhbmltOiBhbmltYXRpb24sCgkJCQlxdWV1ZTogYW5pbWF0aW9uLm9wdHMucXVldWUKCQkJfSApCgkJKTsKCgkJLy8gYXR0YWNoIGNhbGxiYWNrcyBmcm9tIG9wdGlvbnMKCQlyZXR1cm4gYW5pbWF0aW9uLnByb2dyZXNzKCBhbmltYXRpb24ub3B0cy5wcm9ncmVzcyApCgkJCS5kb25lKCBhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSApCgkJCS5mYWlsKCBhbmltYXRpb24ub3B0cy5mYWlsICkKCQkJLmFsd2F5cyggYW5pbWF0aW9uLm9wdHMuYWx3YXlzICk7Cgl9CgoJalF1ZXJ5LkFuaW1hdGlvbiA9IGpRdWVyeS5leHRlbmQoIEFuaW1hdGlvbiwgewoKCQl0d2VlbmVyczogewoJCQkiKiI6IFsgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkgewoJCQkJdmFyIHR3ZWVuID0gdGhpcy5jcmVhdGVUd2VlbiggcHJvcCwgdmFsdWUgKTsKCQkJCWFkanVzdENTUyggdHdlZW4uZWxlbSwgcHJvcCwgcmNzc051bS5leGVjKCB2YWx1ZSApLCB0d2VlbiApOwoJCQkJcmV0dXJuIHR3ZWVuOwoJCQl9IF0KCQl9LAoKCQl0d2VlbmVyOiBmdW5jdGlvbiggcHJvcHMsIGNhbGxiYWNrICkgewoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwcm9wcyApICkgewoJCQkJY2FsbGJhY2sgPSBwcm9wczsKCQkJCXByb3BzID0gWyAiKiIgXTsKCQkJfSBlbHNlIHsKCQkJCXByb3BzID0gcHJvcHMubWF0Y2goIHJub3R3aGl0ZSApOwoJCQl9CgoJCQl2YXIgcHJvcCwKCQkJCWluZGV4ID0gMCwKCQkJCWxlbmd0aCA9IHByb3BzLmxlbmd0aDsKCgkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJcHJvcCA9IHByb3BzWyBpbmRleCBdOwoJCQkJQW5pbWF0aW9uLnR3ZWVuZXJzWyBwcm9wIF0gPSBBbmltYXRpb24udHdlZW5lcnNbIHByb3AgXSB8fCBbXTsKCQkJCUFuaW1hdGlvbi50d2VlbmVyc1sgcHJvcCBdLnVuc2hpZnQoIGNhbGxiYWNrICk7CgkJCX0KCQl9LAoKCQlwcmVmaWx0ZXJzOiBbIGRlZmF1bHRQcmVmaWx0ZXIgXSwKCgkJcHJlZmlsdGVyOiBmdW5jdGlvbiggY2FsbGJhY2ssIHByZXBlbmQgKSB7CgkJCWlmICggcHJlcGVuZCApIHsKCQkJCUFuaW1hdGlvbi5wcmVmaWx0ZXJzLnVuc2hpZnQoIGNhbGxiYWNrICk7CgkJCX0gZWxzZSB7CgkJCQlBbmltYXRpb24ucHJlZmlsdGVycy5wdXNoKCBjYWxsYmFjayApOwoJCQl9CgkJfQoJfSApOwoKCWpRdWVyeS5zcGVlZCA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBmbiApIHsKCQl2YXIgb3B0ID0gc3BlZWQgJiYgdHlwZW9mIHNwZWVkID09PSAib2JqZWN0IiA/IGpRdWVyeS5leHRlbmQoIHt9LCBzcGVlZCApIDogewoJCQljb21wbGV0ZTogZm4gfHwgIWZuICYmIGVhc2luZyB8fAoJCQkJalF1ZXJ5LmlzRnVuY3Rpb24oIHNwZWVkICkgJiYgc3BlZWQsCgkJCWR1cmF0aW9uOiBzcGVlZCwKCQkJZWFzaW5nOiBmbiAmJiBlYXNpbmcgfHwgZWFzaW5nICYmICFqUXVlcnkuaXNGdW5jdGlvbiggZWFzaW5nICkgJiYgZWFzaW5nCgkJfTsKCgkJb3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4Lm9mZiA/IDAgOiB0eXBlb2Ygb3B0LmR1cmF0aW9uID09PSAibnVtYmVyIiA/IG9wdC5kdXJhdGlvbiA6CgkJCW9wdC5kdXJhdGlvbiBpbiBqUXVlcnkuZnguc3BlZWRzID8KCQkJCWpRdWVyeS5meC5zcGVlZHNbIG9wdC5kdXJhdGlvbiBdIDogalF1ZXJ5LmZ4LnNwZWVkcy5fZGVmYXVsdDsKCgkJLy8gbm9ybWFsaXplIG9wdC5xdWV1ZSAtIHRydWUvdW5kZWZpbmVkL251bGwgLT4gImZ4IgoJCWlmICggb3B0LnF1ZXVlID09IG51bGwgfHwgb3B0LnF1ZXVlID09PSB0cnVlICkgewoJCQlvcHQucXVldWUgPSAiZngiOwoJCX0KCgkJLy8gUXVldWVpbmcKCQlvcHQub2xkID0gb3B0LmNvbXBsZXRlOwoKCQlvcHQuY29tcGxldGUgPSBmdW5jdGlvbigpIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0Lm9sZCApICkgewoJCQkJb3B0Lm9sZC5jYWxsKCB0aGlzICk7CgkJCX0KCgkJCWlmICggb3B0LnF1ZXVlICkgewoJCQkJalF1ZXJ5LmRlcXVldWUoIHRoaXMsIG9wdC5xdWV1ZSApOwoJCQl9CgkJfTsKCgkJcmV0dXJuIG9wdDsKCX07CgoJalF1ZXJ5LmZuLmV4dGVuZCggewoJCWZhZGVUbzogZnVuY3Rpb24oIHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjayApIHsKCgkJCS8vIHNob3cgYW55IGhpZGRlbiBlbGVtZW50cyBhZnRlciBzZXR0aW5nIG9wYWNpdHkgdG8gMAoJCQlyZXR1cm4gdGhpcy5maWx0ZXIoIGlzSGlkZGVuICkuY3NzKCAib3BhY2l0eSIsIDAgKS5zaG93KCkKCgkJCQkvLyBhbmltYXRlIHRvIHRoZSB2YWx1ZSBzcGVjaWZpZWQKCQkJCS5lbmQoKS5hbmltYXRlKCB7IG9wYWNpdHk6IHRvIH0sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7CgkJfSwKCQlhbmltYXRlOiBmdW5jdGlvbiggcHJvcCwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXZhciBlbXB0eSA9IGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBwcm9wICksCgkJCQlvcHRhbGwgPSBqUXVlcnkuc3BlZWQoIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICksCgkJCQlkb0FuaW1hdGlvbiA9IGZ1bmN0aW9uKCkgewoKCQkJCQkvLyBPcGVyYXRlIG9uIGEgY29weSBvZiBwcm9wIHNvIHBlci1wcm9wZXJ0eSBlYXNpbmcgd29uJ3QgYmUgbG9zdAoJCQkJCXZhciBhbmltID0gQW5pbWF0aW9uKCB0aGlzLCBqUXVlcnkuZXh0ZW5kKCB7fSwgcHJvcCApLCBvcHRhbGwgKTsKCgkJCQkJLy8gRW1wdHkgYW5pbWF0aW9ucywgb3IgZmluaXNoaW5nIHJlc29sdmVzIGltbWVkaWF0ZWx5CgkJCQkJaWYgKCBlbXB0eSB8fCBqUXVlcnkuX2RhdGEoIHRoaXMsICJmaW5pc2giICkgKSB7CgkJCQkJCWFuaW0uc3RvcCggdHJ1ZSApOwoJCQkJCX0KCQkJCX07CgkJCQlkb0FuaW1hdGlvbi5maW5pc2ggPSBkb0FuaW1hdGlvbjsKCgkJCXJldHVybiBlbXB0eSB8fCBvcHRhbGwucXVldWUgPT09IGZhbHNlID8KCQkJCXRoaXMuZWFjaCggZG9BbmltYXRpb24gKSA6CgkJCQl0aGlzLnF1ZXVlKCBvcHRhbGwucXVldWUsIGRvQW5pbWF0aW9uICk7CgkJfSwKCQlzdG9wOiBmdW5jdGlvbiggdHlwZSwgY2xlYXJRdWV1ZSwgZ290b0VuZCApIHsKCQkJdmFyIHN0b3BRdWV1ZSA9IGZ1bmN0aW9uKCBob29rcyApIHsKCQkJCXZhciBzdG9wID0gaG9va3Muc3RvcDsKCQkJCWRlbGV0ZSBob29rcy5zdG9wOwoJCQkJc3RvcCggZ290b0VuZCApOwoJCQl9OwoKCQkJaWYgKCB0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIgKSB7CgkJCQlnb3RvRW5kID0gY2xlYXJRdWV1ZTsKCQkJCWNsZWFyUXVldWUgPSB0eXBlOwoJCQkJdHlwZSA9IHVuZGVmaW5lZDsKCQkJfQoJCQlpZiAoIGNsZWFyUXVldWUgJiYgdHlwZSAhPT0gZmFsc2UgKSB7CgkJCQl0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFyIGRlcXVldWUgPSB0cnVlLAoJCQkJCWluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyAicXVldWVIb29rcyIsCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlkYXRhID0galF1ZXJ5Ll9kYXRhKCB0aGlzICk7CgoJCQkJaWYgKCBpbmRleCApIHsKCQkJCQlpZiAoIGRhdGFbIGluZGV4IF0gJiYgZGF0YVsgaW5kZXggXS5zdG9wICkgewoJCQkJCQlzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWZvciAoIGluZGV4IGluIGRhdGEgKSB7CgkJCQkJCWlmICggZGF0YVsgaW5kZXggXSAmJiBkYXRhWyBpbmRleCBdLnN0b3AgJiYgcnJ1bi50ZXN0KCBpbmRleCApICkgewoJCQkJCQkJc3RvcFF1ZXVlKCBkYXRhWyBpbmRleCBdICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmCgkJCQkJCSggdHlwZSA9PSBudWxsIHx8IHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApICkgewoKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggZ290b0VuZCApOwoJCQkJCQlkZXF1ZXVlID0gZmFsc2U7CgkJCQkJCXRpbWVycy5zcGxpY2UoIGluZGV4LCAxICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIHN0YXJ0IHRoZSBuZXh0IGluIHRoZSBxdWV1ZSBpZiB0aGUgbGFzdCBzdGVwIHdhc24ndCBmb3JjZWQKCQkJCS8vIHRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2ggd2lsbCBkZXF1ZXVlCgkJCQkvLyBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZAoJCQkJaWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQl9CgkJCX0gKTsKCQl9LAoJCWZpbmlzaDogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCWlmICggdHlwZSAhPT0gZmFsc2UgKSB7CgkJCQl0eXBlID0gdHlwZSB8fCAiZngiOwoJCQl9CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFyIGluZGV4LAoJCQkJCWRhdGEgPSBqUXVlcnkuX2RhdGEoIHRoaXMgKSwKCQkJCQlxdWV1ZSA9IGRhdGFbIHR5cGUgKyAicXVldWUiIF0sCgkJCQkJaG9va3MgPSBkYXRhWyB0eXBlICsgInF1ZXVlSG9va3MiIF0sCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlsZW5ndGggPSBxdWV1ZSA/IHF1ZXVlLmxlbmd0aCA6IDA7CgoJCQkJLy8gZW5hYmxlIGZpbmlzaGluZyBmbGFnIG9uIHByaXZhdGUgZGF0YQoJCQkJZGF0YS5maW5pc2ggPSB0cnVlOwoKCQkJCS8vIGVtcHR5IHRoZSBxdWV1ZSBmaXJzdAoJCQkJalF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBbXSApOwoKCQkJCWlmICggaG9va3MgJiYgaG9va3Muc3RvcCApIHsKCQkJCQlob29rcy5zdG9wLmNhbGwoIHRoaXMsIHRydWUgKTsKCQkJCX0KCgkJCQkvLyBsb29rIGZvciBhbnkgYWN0aXZlIGFuaW1hdGlvbnMsIGFuZCBmaW5pc2ggdGhlbQoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmIHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApIHsKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggdHJ1ZSApOwoJCQkJCQl0aW1lcnMuc3BsaWNlKCBpbmRleCwgMSApOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBsb29rIGZvciBhbnkgYW5pbWF0aW9ucyBpbiB0aGUgb2xkIHF1ZXVlIGFuZCBmaW5pc2ggdGhlbQoJCQkJZm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJCQlpZiAoIHF1ZXVlWyBpbmRleCBdICYmIHF1ZXVlWyBpbmRleCBdLmZpbmlzaCApIHsKCQkJCQkJcXVldWVbIGluZGV4IF0uZmluaXNoLmNhbGwoIHRoaXMgKTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gdHVybiBvZmYgZmluaXNoaW5nIGZsYWcKCQkJCWRlbGV0ZSBkYXRhLmZpbmlzaDsKCQkJfSApOwoJCX0KCX0gKTsKCglqUXVlcnkuZWFjaCggWyAidG9nZ2xlIiwgInNob3ciLCAiaGlkZSIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJdmFyIGNzc0ZuID0galF1ZXJ5LmZuWyBuYW1lIF07CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXJldHVybiBzcGVlZCA9PSBudWxsIHx8IHR5cGVvZiBzcGVlZCA9PT0gImJvb2xlYW4iID8KCQkJCWNzc0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSA6CgkJCQl0aGlzLmFuaW1hdGUoIGdlbkZ4KCBuYW1lLCB0cnVlICksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7CgkJfTsKCX0gKTsKCgkvLyBHZW5lcmF0ZSBzaG9ydGN1dHMgZm9yIGN1c3RvbSBhbmltYXRpb25zCglqUXVlcnkuZWFjaCggewoJCXNsaWRlRG93bjogZ2VuRngoICJzaG93IiApLAoJCXNsaWRlVXA6IGdlbkZ4KCAiaGlkZSIgKSwKCQlzbGlkZVRvZ2dsZTogZ2VuRngoICJ0b2dnbGUiICksCgkJZmFkZUluOiB7IG9wYWNpdHk6ICJzaG93IiB9LAoJCWZhZGVPdXQ6IHsgb3BhY2l0eTogImhpZGUiIH0sCgkJZmFkZVRvZ2dsZTogeyBvcGFjaXR5OiAidG9nZ2xlIiB9Cgl9LCBmdW5jdGlvbiggbmFtZSwgcHJvcHMgKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXJldHVybiB0aGlzLmFuaW1hdGUoIHByb3BzLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApOwoJCX07Cgl9ICk7CgoJalF1ZXJ5LnRpbWVycyA9IFtdOwoJalF1ZXJ5LmZ4LnRpY2sgPSBmdW5jdGlvbigpIHsKCQl2YXIgdGltZXIsCgkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJCWkgPSAwOwoKCQlmeE5vdyA9IGpRdWVyeS5ub3coKTsKCgkJZm9yICggOyBpIDwgdGltZXJzLmxlbmd0aDsgaSsrICkgewoJCQl0aW1lciA9IHRpbWVyc1sgaSBdOwoKCQkJLy8gQ2hlY2tzIHRoZSB0aW1lciBoYXMgbm90IGFscmVhZHkgYmVlbiByZW1vdmVkCgkJCWlmICggIXRpbWVyKCkgJiYgdGltZXJzWyBpIF0gPT09IHRpbWVyICkgewoJCQkJdGltZXJzLnNwbGljZSggaS0tLCAxICk7CgkJCX0KCQl9CgoJCWlmICggIXRpbWVycy5sZW5ndGggKSB7CgkJCWpRdWVyeS5meC5zdG9wKCk7CgkJfQoJCWZ4Tm93ID0gdW5kZWZpbmVkOwoJfTsKCglqUXVlcnkuZngudGltZXIgPSBmdW5jdGlvbiggdGltZXIgKSB7CgkJalF1ZXJ5LnRpbWVycy5wdXNoKCB0aW1lciApOwoJCWlmICggdGltZXIoKSApIHsKCQkJalF1ZXJ5LmZ4LnN0YXJ0KCk7CgkJfSBlbHNlIHsKCQkJalF1ZXJ5LnRpbWVycy5wb3AoKTsKCQl9Cgl9OwoKCWpRdWVyeS5meC5pbnRlcnZhbCA9IDEzOwoKCWpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uKCkgewoJCWlmICggIXRpbWVySWQgKSB7CgkJCXRpbWVySWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoIGpRdWVyeS5meC50aWNrLCBqUXVlcnkuZnguaW50ZXJ2YWwgKTsKCQl9Cgl9OwoKCWpRdWVyeS5meC5zdG9wID0gZnVuY3Rpb24oKSB7CgkJd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVySWQgKTsKCQl0aW1lcklkID0gbnVsbDsKCX07CgoJalF1ZXJ5LmZ4LnNwZWVkcyA9IHsKCQlzbG93OiA2MDAsCgkJZmFzdDogMjAwLAoKCQkvLyBEZWZhdWx0IHNwZWVkCgkJX2RlZmF1bHQ6IDQwMAoJfTsKCgoJLy8gQmFzZWQgb2ZmIG9mIHRoZSBwbHVnaW4gYnkgQ2xpbnQgSGVsZmVycywgd2l0aCBwZXJtaXNzaW9uLgoJLy8gaHR0cDovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxMDAzMjQwMTQ3NDcvaHR0cDovL2JsaW5kc2lnbmFscy5jb20vaW5kZXgucGhwLzIwMDkvMDcvanF1ZXJ5LWRlbGF5LwoJalF1ZXJ5LmZuLmRlbGF5ID0gZnVuY3Rpb24oIHRpbWUsIHR5cGUgKSB7CgkJdGltZSA9IGpRdWVyeS5meCA/IGpRdWVyeS5meC5zcGVlZHNbIHRpbWUgXSB8fCB0aW1lIDogdGltZTsKCQl0eXBlID0gdHlwZSB8fCAiZngiOwoKCQlyZXR1cm4gdGhpcy5xdWV1ZSggdHlwZSwgZnVuY3Rpb24oIG5leHQsIGhvb2tzICkgewoJCQl2YXIgdGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KCBuZXh0LCB0aW1lICk7CgkJCWhvb2tzLnN0b3AgPSBmdW5jdGlvbigpIHsKCQkJCXdpbmRvdy5jbGVhclRpbWVvdXQoIHRpbWVvdXQgKTsKCQkJfTsKCQl9ICk7Cgl9OwoKCgkoIGZ1bmN0aW9uKCkgewoJCXZhciBhLAoJCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKSwKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQkJc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggInNlbGVjdCIgKSwKCQkJb3B0ID0gc2VsZWN0LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAib3B0aW9uIiApICk7CgoJCS8vIFNldHVwCgkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQlkaXYuc2V0QXR0cmlidXRlKCAiY2xhc3NOYW1lIiwgInQiICk7CgkJZGl2LmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iOwoJCWEgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJhIiApWyAwIF07CgoJCS8vIFN1cHBvcnQ6IFdpbmRvd3MgV2ViIEFwcHMgKFdXQSkKCQkvLyBgdHlwZWAgbXVzdCB1c2UgLnNldEF0dHJpYnV0ZSBmb3IgV1dBICgjMTQ5MDEpCgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJjaGVja2JveCIgKTsKCQlkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7CgoJCWEgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJhIiApWyAwIF07CgoJCS8vIEZpcnN0IGJhdGNoIG9mIHRlc3RzLgoJCWEuc3R5bGUuY3NzVGV4dCA9ICJ0b3A6MXB4IjsKCgkJLy8gVGVzdCBzZXRBdHRyaWJ1dGUgb24gY2FtZWxDYXNlIGNsYXNzLgoJCS8vIElmIGl0IHdvcmtzLCB3ZSBuZWVkIGF0dHJGaXhlcyB3aGVuIGRvaW5nIGdldC9zZXRBdHRyaWJ1dGUgKGllNi83KQoJCXN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlID0gZGl2LmNsYXNzTmFtZSAhPT0gInQiOwoKCQkvLyBHZXQgdGhlIHN0eWxlIGluZm9ybWF0aW9uIGZyb20gZ2V0QXR0cmlidXRlCgkJLy8gKElFIHVzZXMgLmNzc1RleHQgaW5zdGVhZCkKCQlzdXBwb3J0LnN0eWxlID0gL3RvcC8udGVzdCggYS5nZXRBdHRyaWJ1dGUoICJzdHlsZSIgKSApOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCBVUkxzIGFyZW4ndCBtYW5pcHVsYXRlZAoJCS8vIChJRSBub3JtYWxpemVzIGl0IGJ5IGRlZmF1bHQpCgkJc3VwcG9ydC5ocmVmTm9ybWFsaXplZCA9IGEuZ2V0QXR0cmlidXRlKCAiaHJlZiIgKSA9PT0gIi9hIjsKCgkJLy8gQ2hlY2sgdGhlIGRlZmF1bHQgY2hlY2tib3gvcmFkaW8gdmFsdWUgKCIiIG9uIFdlYktpdDsgIm9uIiBlbHNld2hlcmUpCgkJc3VwcG9ydC5jaGVja09uID0gISFpbnB1dC52YWx1ZTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgYSBzZWxlY3RlZC1ieS1kZWZhdWx0IG9wdGlvbiBoYXMgYSB3b3JraW5nIHNlbGVjdGVkIHByb3BlcnR5LgoJCS8vIChXZWJLaXQgZGVmYXVsdHMgdG8gZmFsc2UgaW5zdGVhZCBvZiB0cnVlLCBJRSB0b28sIGlmIGl0J3MgaW4gYW4gb3B0Z3JvdXApCgkJc3VwcG9ydC5vcHRTZWxlY3RlZCA9IG9wdC5zZWxlY3RlZDsKCgkJLy8gVGVzdHMgZm9yIGVuY3R5cGUgc3VwcG9ydCBvbiBhIGZvcm0gKCM2NzQzKQoJCXN1cHBvcnQuZW5jdHlwZSA9ICEhZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImZvcm0iICkuZW5jdHlwZTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIG9wdGlvbnMgaW5zaWRlIGRpc2FibGVkIHNlbGVjdHMgYXJlbid0IG1hcmtlZCBhcyBkaXNhYmxlZAoJCS8vIChXZWJLaXQgbWFya3MgdGhlbSBhcyBkaXNhYmxlZCkKCQlzZWxlY3QuZGlzYWJsZWQgPSB0cnVlOwoJCXN1cHBvcnQub3B0RGlzYWJsZWQgPSAhb3B0LmRpc2FibGVkOwoKCQkvLyBTdXBwb3J0OiBJRTggb25seQoJCS8vIENoZWNrIGlmIHdlIGNhbiB0cnVzdCBnZXRBdHRyaWJ1dGUoInZhbHVlIikKCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKTsKCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ2YWx1ZSIsICIiICk7CgkJc3VwcG9ydC5pbnB1dCA9IGlucHV0LmdldEF0dHJpYnV0ZSggInZhbHVlIiApID09PSAiIjsKCgkJLy8gQ2hlY2sgaWYgYW4gaW5wdXQgbWFpbnRhaW5zIGl0cyB2YWx1ZSBhZnRlciBiZWNvbWluZyBhIHJhZGlvCgkJaW5wdXQudmFsdWUgPSAidCI7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJyYWRpbyIgKTsKCQlzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gInQiOwoJfSApKCk7CgoKCXZhciBycmV0dXJuID0gL1xyL2c7CgoJalF1ZXJ5LmZuLmV4dGVuZCggewoJCXZhbDogZnVuY3Rpb24oIHZhbHVlICkgewoJCQl2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbiwKCQkJCWVsZW0gPSB0aGlzWyAwIF07CgoJCQlpZiAoICFhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJaWYgKCBlbGVtICkgewoJCQkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyBlbGVtLnR5cGUgXSB8fAoJCQkJCQlqUXVlcnkudmFsSG9va3NbIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdOwoKCQkJCQlpZiAoCgkJCQkJCWhvb2tzICYmCgkJCQkJCSJnZXQiIGluIGhvb2tzICYmCgkJCQkJCSggcmV0ID0gaG9va3MuZ2V0KCBlbGVtLCAidmFsdWUiICkgKSAhPT0gdW5kZWZpbmVkCgkJCQkJKSB7CgkJCQkJCXJldHVybiByZXQ7CgkJCQkJfQoKCQkJCQlyZXQgPSBlbGVtLnZhbHVlOwoKCQkJCQlyZXR1cm4gdHlwZW9mIHJldCA9PT0gInN0cmluZyIgPwoKCQkJCQkJLy8gaGFuZGxlIG1vc3QgY29tbW9uIHN0cmluZyBjYXNlcwoJCQkJCQlyZXQucmVwbGFjZSggcnJldHVybiwgIiIgKSA6CgoJCQkJCQkvLyBoYW5kbGUgY2FzZXMgd2hlcmUgdmFsdWUgaXMgbnVsbC91bmRlZiBvciBudW1iZXIKCQkJCQkJcmV0ID09IG51bGwgPyAiIiA6IHJldDsKCQkJCX0KCgkJCQlyZXR1cm47CgkJCX0KCgkJCWlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTsKCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQkJdmFyIHZhbDsKCgkJCQlpZiAoIHRoaXMubm9kZVR5cGUgIT09IDEgKSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCWlmICggaXNGdW5jdGlvbiApIHsKCQkJCQl2YWwgPSB2YWx1ZS5jYWxsKCB0aGlzLCBpLCBqUXVlcnkoIHRoaXMgKS52YWwoKSApOwoJCQkJfSBlbHNlIHsKCQkJCQl2YWwgPSB2YWx1ZTsKCQkJCX0KCgkJCQkvLyBUcmVhdCBudWxsL3VuZGVmaW5lZCBhcyAiIjsgY29udmVydCBudW1iZXJzIHRvIHN0cmluZwoJCQkJaWYgKCB2YWwgPT0gbnVsbCApIHsKCQkJCQl2YWwgPSAiIjsKCQkJCX0gZWxzZSBpZiAoIHR5cGVvZiB2YWwgPT09ICJudW1iZXIiICkgewoJCQkJCXZhbCArPSAiIjsKCQkJCX0gZWxzZSBpZiAoIGpRdWVyeS5pc0FycmF5KCB2YWwgKSApIHsKCQkJCQl2YWwgPSBqUXVlcnkubWFwKCB2YWwsIGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJCQkJcmV0dXJuIHZhbHVlID09IG51bGwgPyAiIiA6IHZhbHVlICsgIiI7CgkJCQkJfSApOwoJCQkJfQoKCQkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyB0aGlzLnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIHRoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdOwoKCQkJCS8vIElmIHNldCByZXR1cm5zIHVuZGVmaW5lZCwgZmFsbCBiYWNrIHRvIG5vcm1hbCBzZXR0aW5nCgkJCQlpZiAoICFob29rcyB8fCAhKCAic2V0IiBpbiBob29rcyApIHx8IGhvb2tzLnNldCggdGhpcywgdmFsLCAidmFsdWUiICkgPT09IHVuZGVmaW5lZCApIHsKCQkJCQl0aGlzLnZhbHVlID0gdmFsOwoJCQkJfQoJCQl9ICk7CgkJfQoJfSApOwoKCWpRdWVyeS5leHRlbmQoIHsKCQl2YWxIb29rczogewoJCQlvcHRpb246IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIHZhbCA9IGpRdWVyeS5maW5kLmF0dHIoIGVsZW0sICJ2YWx1ZSIgKTsKCQkJCQlyZXR1cm4gdmFsICE9IG51bGwgPwoJCQkJCQl2YWwgOgoKCQkJCQkJLy8gU3VwcG9ydDogSUUxMC0xMSsKCQkJCQkJLy8gb3B0aW9uLnRleHQgdGhyb3dzIGV4Y2VwdGlvbnMgKCMxNDY4NiwgIzE0ODU4KQoJCQkJCQlqUXVlcnkudHJpbSggalF1ZXJ5LnRleHQoIGVsZW0gKSApOwoJCQkJfQoJCQl9LAoJCQlzZWxlY3Q6IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIHZhbHVlLCBvcHRpb24sCgkJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJCWluZGV4ID0gZWxlbS5zZWxlY3RlZEluZGV4LAoJCQkJCQlvbmUgPSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIiB8fCBpbmRleCA8IDAsCgkJCQkJCXZhbHVlcyA9IG9uZSA/IG51bGwgOiBbXSwKCQkJCQkJbWF4ID0gb25lID8gaW5kZXggKyAxIDogb3B0aW9ucy5sZW5ndGgsCgkJCQkJCWkgPSBpbmRleCA8IDAgPwoJCQkJCQkJbWF4IDoKCQkJCQkJCW9uZSA/IGluZGV4IDogMDsKCgkJCQkJLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgc2VsZWN0ZWQgb3B0aW9ucwoJCQkJCWZvciAoIDsgaSA8IG1heDsgaSsrICkgewoJCQkJCQlvcHRpb24gPSBvcHRpb25zWyBpIF07CgoJCQkJCQkvLyBvbGRJRSBkb2Vzbid0IHVwZGF0ZSBzZWxlY3RlZCBhZnRlciBmb3JtIHJlc2V0ICgjMjU1MSkKCQkJCQkJaWYgKCAoIG9wdGlvbi5zZWxlY3RlZCB8fCBpID09PSBpbmRleCApICYmCgoJCQkJCQkJCS8vIERvbid0IHJldHVybiBvcHRpb25zIHRoYXQgYXJlIGRpc2FibGVkIG9yIGluIGEgZGlzYWJsZWQgb3B0Z3JvdXAKCQkJCQkJCQkoIHN1cHBvcnQub3B0RGlzYWJsZWQgPwoJCQkJCQkJCQkhb3B0aW9uLmRpc2FibGVkIDoKCQkJCQkJCQkJb3B0aW9uLmdldEF0dHJpYnV0ZSggImRpc2FibGVkIiApID09PSBudWxsICkgJiYKCQkJCQkJCQkoICFvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZCB8fAoJCQkJCQkJCQkhalF1ZXJ5Lm5vZGVOYW1lKCBvcHRpb24ucGFyZW50Tm9kZSwgIm9wdGdyb3VwIiApICkgKSB7CgoJCQkJCQkJLy8gR2V0IHRoZSBzcGVjaWZpYyB2YWx1ZSBmb3IgdGhlIG9wdGlvbgoJCQkJCQkJdmFsdWUgPSBqUXVlcnkoIG9wdGlvbiApLnZhbCgpOwoKCQkJCQkJCS8vIFdlIGRvbid0IG5lZWQgYW4gYXJyYXkgZm9yIG9uZSBzZWxlY3RzCgkJCQkJCQlpZiAoIG9uZSApIHsKCQkJCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQkJCQl9CgoJCQkJCQkJLy8gTXVsdGktU2VsZWN0cyByZXR1cm4gYW4gYXJyYXkKCQkJCQkJCXZhbHVlcy5wdXNoKCB2YWx1ZSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQlyZXR1cm4gdmFsdWVzOwoJCQkJfSwKCgkJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCQl2YXIgb3B0aW9uU2V0LCBvcHRpb24sCgkJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJCXZhbHVlcyA9IGpRdWVyeS5tYWtlQXJyYXkoIHZhbHVlICksCgkJCQkJCWkgPSBvcHRpb25zLmxlbmd0aDsKCgkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCW9wdGlvbiA9IG9wdGlvbnNbIGkgXTsKCgkJCQkJCWlmICggalF1ZXJ5LmluQXJyYXkoIGpRdWVyeS52YWxIb29rcy5vcHRpb24uZ2V0KCBvcHRpb24gKSwgdmFsdWVzICkgPj0gMCApIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRTYKCQkJCQkJCS8vIFdoZW4gbmV3IG9wdGlvbiBlbGVtZW50IGlzIGFkZGVkIHRvIHNlbGVjdCBib3ggd2UgbmVlZCB0bwoJCQkJCQkJLy8gZm9yY2UgcmVmbG93IG9mIG5ld2x5IGFkZGVkIG5vZGUgaW4gb3JkZXIgdG8gd29ya2Fyb3VuZCBkZWxheQoJCQkJCQkJLy8gb2YgaW5pdGlhbGl6YXRpb24gcHJvcGVydGllcwoJCQkJCQkJdHJ5IHsKCQkJCQkJCQlvcHRpb24uc2VsZWN0ZWQgPSBvcHRpb25TZXQgPSB0cnVlOwoKCQkJCQkJCX0gY2F0Y2ggKCBfICkgewoKCQkJCQkJCQkvLyBXaWxsIGJlIGV4ZWN1dGVkIG9ubHkgaW4gSUU2CgkJCQkJCQkJb3B0aW9uLnNjcm9sbEhlaWdodDsKCQkJCQkJCX0KCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlvcHRpb24uc2VsZWN0ZWQgPSBmYWxzZTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gRm9yY2UgYnJvd3NlcnMgdG8gYmVoYXZlIGNvbnNpc3RlbnRseSB3aGVuIG5vbi1tYXRjaGluZyB2YWx1ZSBpcyBzZXQKCQkJCQlpZiAoICFvcHRpb25TZXQgKSB7CgkJCQkJCWVsZW0uc2VsZWN0ZWRJbmRleCA9IC0xOwoJCQkJCX0KCgkJCQkJcmV0dXJuIG9wdGlvbnM7CgkJCQl9CgkJCX0KCQl9Cgl9ICk7CgoJLy8gUmFkaW9zIGFuZCBjaGVja2JveGVzIGdldHRlci9zZXR0ZXIKCWpRdWVyeS5lYWNoKCBbICJyYWRpbyIsICJjaGVja2JveCIgXSwgZnVuY3Rpb24oKSB7CgkJalF1ZXJ5LnZhbEhvb2tzWyB0aGlzIF0gPSB7CgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSApIHsKCQkJCQlyZXR1cm4gKCBlbGVtLmNoZWNrZWQgPSBqUXVlcnkuaW5BcnJheSggalF1ZXJ5KCBlbGVtICkudmFsKCksIHZhbHVlICkgPiAtMSApOwoJCQkJfQoJCQl9CgkJfTsKCQlpZiAoICFzdXBwb3J0LmNoZWNrT24gKSB7CgkJCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdLmdldCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCAidmFsdWUiICkgPT09IG51bGwgPyAib24iIDogZWxlbS52YWx1ZTsKCQkJfTsKCQl9Cgl9ICk7CgoKCgoJdmFyIG5vZGVIb29rLCBib29sSG9vaywKCQlhdHRySGFuZGxlID0galF1ZXJ5LmV4cHIuYXR0ckhhbmRsZSwKCQlydXNlRGVmYXVsdCA9IC9eKD86Y2hlY2tlZHxzZWxlY3RlZCkkL2ksCgkJZ2V0U2V0QXR0cmlidXRlID0gc3VwcG9ydC5nZXRTZXRBdHRyaWJ1dGUsCgkJZ2V0U2V0SW5wdXQgPSBzdXBwb3J0LmlucHV0OwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlhdHRyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5hdHRyLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCQl9LAoKCQlyZW1vdmVBdHRyOiBmdW5jdGlvbiggbmFtZSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkucmVtb3ZlQXR0ciggdGhpcywgbmFtZSApOwoJCQl9ICk7CgkJfQoJfSApOwoKCWpRdWVyeS5leHRlbmQoIHsKCQlhdHRyOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJCXZhciByZXQsIGhvb2tzLAoJCQkJblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQkJLy8gRG9uJ3QgZ2V0L3NldCBhdHRyaWJ1dGVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwoJCQlpZiAoIG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBGYWxsYmFjayB0byBwcm9wIHdoZW4gYXR0cmlidXRlcyBhcmUgbm90IHN1cHBvcnRlZAoJCQlpZiAoIHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZSA9PT0gInVuZGVmaW5lZCIgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LnByb3AoIGVsZW0sIG5hbWUsIHZhbHVlICk7CgkJCX0KCgkJCS8vIEFsbCBhdHRyaWJ1dGVzIGFyZSBsb3dlcmNhc2UKCQkJLy8gR3JhYiBuZWNlc3NhcnkgaG9vayBpZiBvbmUgaXMgZGVmaW5lZAoJCQlpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHsKCQkJCW5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlob29rcyA9IGpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSB8fAoJCQkJCSggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgPyBib29sSG9vayA6IG5vZGVIb29rICk7CgkJCX0KCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCWlmICggdmFsdWUgPT09IG51bGwgKSB7CgkJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJaWYgKCBob29rcyAmJiAic2V0IiBpbiBob29rcyAmJgoJCQkJCSggcmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApICkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gcmV0OwoJCQkJfQoKCQkJCWVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCB2YWx1ZSArICIiICk7CgkJCQlyZXR1cm4gdmFsdWU7CgkJCX0KCgkJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKCByZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSApICE9PSBudWxsICkgewoJCQkJcmV0dXJuIHJldDsKCQkJfQoKCQkJcmV0ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgbmFtZSApOwoKCQkJLy8gTm9uLWV4aXN0ZW50IGF0dHJpYnV0ZXMgcmV0dXJuIG51bGwsIHdlIG5vcm1hbGl6ZSB0byB1bmRlZmluZWQKCQkJcmV0dXJuIHJldCA9PSBudWxsID8gdW5kZWZpbmVkIDogcmV0OwoJCX0sCgoJCWF0dHJIb29rczogewoJCQl0eXBlOiB7CgkJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCQlpZiAoICFzdXBwb3J0LnJhZGlvVmFsdWUgJiYgdmFsdWUgPT09ICJyYWRpbyIgJiYKCQkJCQkJalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAiaW5wdXQiICkgKSB7CgoJCQkJCQkvLyBTZXR0aW5nIHRoZSB0eXBlIG9uIGEgcmFkaW8gYnV0dG9uIGFmdGVyIHRoZSB2YWx1ZSByZXNldHMgdGhlIHZhbHVlIGluIElFOC05CgkJCQkJCS8vIFJlc2V0IHZhbHVlIHRvIGRlZmF1bHQgaW4gY2FzZSB0eXBlIGlzIHNldCBhZnRlciB2YWx1ZSBkdXJpbmcgY3JlYXRpb24KCQkJCQkJdmFyIHZhbCA9IGVsZW0udmFsdWU7CgkJCQkJCWVsZW0uc2V0QXR0cmlidXRlKCAidHlwZSIsIHZhbHVlICk7CgkJCQkJCWlmICggdmFsICkgewoJCQkJCQkJZWxlbS52YWx1ZSA9IHZhbDsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfSwKCgkJcmVtb3ZlQXR0cjogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQl2YXIgbmFtZSwgcHJvcE5hbWUsCgkJCQlpID0gMCwKCQkJCWF0dHJOYW1lcyA9IHZhbHVlICYmIHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKTsKCgkJCWlmICggYXR0ck5hbWVzICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQl3aGlsZSAoICggbmFtZSA9IGF0dHJOYW1lc1sgaSsrIF0gKSApIHsKCQkJCQlwcm9wTmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCgkJCQkJLy8gQm9vbGVhbiBhdHRyaWJ1dGVzIGdldCBzcGVjaWFsIHRyZWF0bWVudCAoIzEwODcwKQoJCQkJCWlmICggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgKSB7CgoJCQkJCQkvLyBTZXQgY29ycmVzcG9uZGluZyBwcm9wZXJ0eSB0byBmYWxzZQoJCQkJCQlpZiAoIGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApICkgewoJCQkJCQkJZWxlbVsgcHJvcE5hbWUgXSA9IGZhbHNlOwoKCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkvLyBBbHNvIGNsZWFyIGRlZmF1bHRDaGVja2VkL2RlZmF1bHRTZWxlY3RlZCAoaWYgYXBwcm9wcmlhdGUpCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQllbGVtWyBqUXVlcnkuY2FtZWxDYXNlKCAiZGVmYXVsdC0iICsgbmFtZSApIF0gPQoJCQkJCQkJCWVsZW1bIHByb3BOYW1lIF0gPSBmYWxzZTsKCQkJCQkJfQoKCQkJCQkvLyBTZWUgIzk2OTkgZm9yIGV4cGxhbmF0aW9uIG9mIHRoaXMgYXBwcm9hY2ggKHNldHRpbmcgZmlyc3QsIHRoZW4gcmVtb3ZhbCkKCQkJCQl9IGVsc2UgewoJCQkJCQlqUXVlcnkuYXR0ciggZWxlbSwgbmFtZSwgIiIgKTsKCQkJCQl9CgoJCQkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCBnZXRTZXRBdHRyaWJ1dGUgPyBuYW1lIDogcHJvcE5hbWUgKTsKCQkJCX0KCQkJfQoJCX0KCX0gKTsKCgkvLyBIb29rcyBmb3IgYm9vbGVhbiBhdHRyaWJ1dGVzCglib29sSG9vayA9IHsKCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgbmFtZSApIHsKCQkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgoJCQkJLy8gUmVtb3ZlIGJvb2xlYW4gYXR0cmlidXRlcyB3aGVuIHNldCB0byBmYWxzZQoJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTsKCQkJfSBlbHNlIGlmICggZ2V0U2V0SW5wdXQgJiYgZ2V0U2V0QXR0cmlidXRlIHx8ICFydXNlRGVmYXVsdC50ZXN0KCBuYW1lICkgKSB7CgoJCQkJLy8gSUU8OCBuZWVkcyB0aGUgKnByb3BlcnR5KiBuYW1lCgkJCQllbGVtLnNldEF0dHJpYnV0ZSggIWdldFNldEF0dHJpYnV0ZSAmJiBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWUsIG5hbWUgKTsKCgkJCX0gZWxzZSB7CgoJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJLy8gVXNlIGRlZmF1bHRDaGVja2VkIGFuZCBkZWZhdWx0U2VsZWN0ZWQgZm9yIG9sZElFCgkJCQllbGVtWyBqUXVlcnkuY2FtZWxDYXNlKCAiZGVmYXVsdC0iICsgbmFtZSApIF0gPSBlbGVtWyBuYW1lIF0gPSB0cnVlOwoJCQl9CgkJCXJldHVybiBuYW1lOwoJCX0KCX07CgoJalF1ZXJ5LmVhY2goIGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKCAvXHcrL2cgKSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJdmFyIGdldHRlciA9IGF0dHJIYW5kbGVbIG5hbWUgXSB8fCBqUXVlcnkuZmluZC5hdHRyOwoKCQlpZiAoIGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApICkgewoJCQlhdHRySGFuZGxlWyBuYW1lIF0gPSBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCQl2YXIgcmV0LCBoYW5kbGU7CgkJCQlpZiAoICFpc1hNTCApIHsKCgkJCQkJLy8gQXZvaWQgYW4gaW5maW5pdGUgbG9vcCBieSB0ZW1wb3JhcmlseSByZW1vdmluZyB0aGlzIGZ1bmN0aW9uIGZyb20gdGhlIGdldHRlcgoJCQkJCWhhbmRsZSA9IGF0dHJIYW5kbGVbIG5hbWUgXTsKCQkJCQlhdHRySGFuZGxlWyBuYW1lIF0gPSByZXQ7CgkJCQkJcmV0ID0gZ2V0dGVyKCBlbGVtLCBuYW1lLCBpc1hNTCApICE9IG51bGwgPwoJCQkJCQluYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJCQludWxsOwoJCQkJCWF0dHJIYW5kbGVbIG5hbWUgXSA9IGhhbmRsZTsKCQkJCX0KCQkJCXJldHVybiByZXQ7CgkJCX07CgkJfSBlbHNlIHsKCQkJYXR0ckhhbmRsZVsgbmFtZSBdID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQkJaWYgKCAhaXNYTUwgKSB7CgkJCQkJcmV0dXJuIGVsZW1bIGpRdWVyeS5jYW1lbENhc2UoICJkZWZhdWx0LSIgKyBuYW1lICkgXSA/CgkJCQkJCW5hbWUudG9Mb3dlckNhc2UoKSA6CgkJCQkJCW51bGw7CgkJCQl9CgkJCX07CgkJfQoJfSApOwoKCS8vIGZpeCBvbGRJRSBhdHRyb3BlcnRpZXMKCWlmICggIWdldFNldElucHV0IHx8ICFnZXRTZXRBdHRyaWJ1dGUgKSB7CgkJalF1ZXJ5LmF0dHJIb29rcy52YWx1ZSA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImlucHV0IiApICkgewoKCQkJCQkvLyBEb2VzIG5vdCByZXR1cm4gc28gdGhhdCBzZXRBdHRyaWJ1dGUgaXMgYWxzbyB1c2VkCgkJCQkJZWxlbS5kZWZhdWx0VmFsdWUgPSB2YWx1ZTsKCQkJCX0gZWxzZSB7CgoJCQkJCS8vIFVzZSBub2RlSG9vayBpZiBkZWZpbmVkICgjMTk1NCk7IG90aGVyd2lzZSBzZXRBdHRyaWJ1dGUgaXMgZmluZQoJCQkJCXJldHVybiBub2RlSG9vayAmJiBub2RlSG9vay5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICk7CgkJCQl9CgkJCX0KCQl9OwoJfQoKCS8vIElFNi83IGRvIG5vdCBzdXBwb3J0IGdldHRpbmcvc2V0dGluZyBzb21lIGF0dHJpYnV0ZXMgd2l0aCBnZXQvc2V0QXR0cmlidXRlCglpZiAoICFnZXRTZXRBdHRyaWJ1dGUgKSB7CgoJCS8vIFVzZSB0aGlzIGZvciBhbnkgYXR0cmlidXRlIGluIElFNi83CgkJLy8gVGhpcyBmaXhlcyBhbG1vc3QgZXZlcnkgSUU2LzcgaXNzdWUKCQlub2RlSG9vayA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgoJCQkJLy8gU2V0IHRoZSBleGlzdGluZyBvciBjcmVhdGUgYSBuZXcgYXR0cmlidXRlIG5vZGUKCQkJCXZhciByZXQgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKTsKCQkJCWlmICggIXJldCApIHsKCQkJCQllbGVtLnNldEF0dHJpYnV0ZU5vZGUoCgkJCQkJCSggcmV0ID0gZWxlbS5vd25lckRvY3VtZW50LmNyZWF0ZUF0dHJpYnV0ZSggbmFtZSApICkKCQkJCQkpOwoJCQkJfQoKCQkJCXJldC52YWx1ZSA9IHZhbHVlICs9ICIiOwoKCQkJCS8vIEJyZWFrIGFzc29jaWF0aW9uIHdpdGggY2xvbmVkIGVsZW1lbnRzIGJ5IGFsc28gdXNpbmcgc2V0QXR0cmlidXRlICgjOTY0NikKCQkJCWlmICggbmFtZSA9PT0gInZhbHVlIiB8fCB2YWx1ZSA9PT0gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKSApIHsKCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQl9CgkJCX0KCQl9OwoKCQkvLyBTb21lIGF0dHJpYnV0ZXMgYXJlIGNvbnN0cnVjdGVkIHdpdGggZW1wdHktc3RyaW5nIHZhbHVlcyB3aGVuIG5vdCBkZWZpbmVkCgkJYXR0ckhhbmRsZS5pZCA9IGF0dHJIYW5kbGUubmFtZSA9IGF0dHJIYW5kbGUuY29vcmRzID0KCQkJZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQkJdmFyIHJldDsKCQkJCWlmICggIWlzWE1MICkgewoJCQkJCXJldHVybiAoIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSggbmFtZSApICkgJiYgcmV0LnZhbHVlICE9PSAiIiA/CgkJCQkJCXJldC52YWx1ZSA6CgkJCQkJCW51bGw7CgkJCQl9CgkJCX07CgoJCS8vIEZpeGluZyB2YWx1ZSByZXRyaWV2YWwgb24gYSBidXR0b24gcmVxdWlyZXMgdGhpcyBtb2R1bGUKCQlqUXVlcnkudmFsSG9va3MuYnV0dG9uID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQkJdmFyIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSggbmFtZSApOwoJCQkJaWYgKCByZXQgJiYgcmV0LnNwZWNpZmllZCApIHsKCQkJCQlyZXR1cm4gcmV0LnZhbHVlOwoJCQkJfQoJCQl9LAoJCQlzZXQ6IG5vZGVIb29rLnNldAoJCX07CgoJCS8vIFNldCBjb250ZW50ZWRpdGFibGUgdG8gZmFsc2Ugb24gcmVtb3ZhbHMoIzEwNDI5KQoJCS8vIFNldHRpbmcgdG8gZW1wdHkgc3RyaW5nIHRocm93cyBhbiBlcnJvciBhcyBhbiBpbnZhbGlkIHZhbHVlCgkJalF1ZXJ5LmF0dHJIb29rcy5jb250ZW50ZWRpdGFibGUgPSB7CgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBuYW1lICkgewoJCQkJbm9kZUhvb2suc2V0KCBlbGVtLCB2YWx1ZSA9PT0gIiIgPyBmYWxzZSA6IHZhbHVlLCBuYW1lICk7CgkJCX0KCQl9OwoKCQkvLyBTZXQgd2lkdGggYW5kIGhlaWdodCB0byBhdXRvIGluc3RlYWQgb2YgMCBvbiBlbXB0eSBzdHJpbmcoIEJ1ZyAjODE1MCApCgkJLy8gVGhpcyBpcyBmb3IgcmVtb3ZhbHMKCQlqUXVlcnkuZWFjaCggWyAid2lkdGgiLCAiaGVpZ2h0IiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCQkJalF1ZXJ5LmF0dHJIb29rc1sgbmFtZSBdID0gewoJCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgKSB7CgkJCQkJCWVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCAiYXV0byIgKTsKCQkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJCX0KCQkJCX0KCQkJfTsKCQl9ICk7Cgl9CgoJaWYgKCAhc3VwcG9ydC5zdHlsZSApIHsKCQlqUXVlcnkuYXR0ckhvb2tzLnN0eWxlID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoKCQkJCS8vIFJldHVybiB1bmRlZmluZWQgaW4gdGhlIGNhc2Ugb2YgZW1wdHkgc3RyaW5nCgkJCQkvLyBOb3RlOiBJRSB1cHBlcmNhc2VzIGNzcyBwcm9wZXJ0eSBuYW1lcywgYnV0IGlmIHdlIHdlcmUgdG8gLnRvTG93ZXJDYXNlKCkKCQkJCS8vIC5jc3NUZXh0LCB0aGF0IHdvdWxkIGRlc3Ryb3kgY2FzZSBzZW5zaXRpdml0eSBpbiBVUkwncywgbGlrZSBpbiAiYmFja2dyb3VuZCIKCQkJCXJldHVybiBlbGVtLnN0eWxlLmNzc1RleHQgfHwgdW5kZWZpbmVkOwoJCQl9LAoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCXJldHVybiAoIGVsZW0uc3R5bGUuY3NzVGV4dCA9IHZhbHVlICsgIiIgKTsKCQkJfQoJCX07Cgl9CgoKCgoJdmFyIHJmb2N1c2FibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvaSwKCQlyY2xpY2thYmxlID0gL14oPzphfGFyZWEpJC9pOwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlwcm9wOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5wcm9wLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCQl9LAoKCQlyZW1vdmVQcm9wOiBmdW5jdGlvbiggbmFtZSApIHsKCQkJbmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgoJCQkJLy8gdHJ5L2NhdGNoIGhhbmRsZXMgY2FzZXMgd2hlcmUgSUUgYmFsa3MgKHN1Y2ggYXMgcmVtb3ZpbmcgYSBwcm9wZXJ0eSBvbiB3aW5kb3cpCgkJCQl0cnkgewoJCQkJCXRoaXNbIG5hbWUgXSA9IHVuZGVmaW5lZDsKCQkJCQlkZWxldGUgdGhpc1sgbmFtZSBdOwoJCQkJfSBjYXRjaCAoIGUgKSB7fQoJCQl9ICk7CgkJfQoJfSApOwoKCWpRdWVyeS5leHRlbmQoIHsKCQlwcm9wOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJCXZhciByZXQsIGhvb2tzLAoJCQkJblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQkJLy8gRG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwoJCQlpZiAoIG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHsKCgkJCQkvLyBGaXggbmFtZSBhbmQgYXR0YWNoIGhvb2tzCgkJCQluYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lOwoJCQkJaG9va3MgPSBqUXVlcnkucHJvcEhvb2tzWyBuYW1lIF07CgkJCX0KCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCWlmICggaG9va3MgJiYgInNldCIgaW4gaG9va3MgJiYKCQkJCQkoIHJldCA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIG5hbWUgKSApICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJcmV0dXJuIHJldDsKCQkJCX0KCgkJCQlyZXR1cm4gKCBlbGVtWyBuYW1lIF0gPSB2YWx1ZSApOwoJCQl9CgoJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmICggcmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkgKSAhPT0gbnVsbCApIHsKCQkJCXJldHVybiByZXQ7CgkJCX0KCgkJCXJldHVybiBlbGVtWyBuYW1lIF07CgkJfSwKCgkJcHJvcEhvb2tzOiB7CgkJCXRhYkluZGV4OiB7CgkJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoKCQkJCQkvLyBlbGVtLnRhYkluZGV4IGRvZXNuJ3QgYWx3YXlzIHJldHVybiB0aGUKCQkJCQkvLyBjb3JyZWN0IHZhbHVlIHdoZW4gaXQgaGFzbid0IGJlZW4gZXhwbGljaXRseSBzZXQKCQkJCQkvLyBodHRwOi8vZmx1aWRwcm9qZWN0Lm9yZy9ibG9nLzIwMDgvMDEvMDkvZ2V0dGluZy1zZXR0aW5nLWFuZC1yZW1vdmluZy10YWJpbmRleC12YWx1ZXMtd2l0aC1qYXZhc2NyaXB0LwoJCQkJCS8vIFVzZSBwcm9wZXIgYXR0cmlidXRlIHJldHJpZXZhbCgjMTIwNzIpCgkJCQkJdmFyIHRhYmluZGV4ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgInRhYmluZGV4IiApOwoKCQkJCQlyZXR1cm4gdGFiaW5kZXggPwoJCQkJCQlwYXJzZUludCggdGFiaW5kZXgsIDEwICkgOgoJCQkJCQlyZm9jdXNhYmxlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSB8fAoJCQkJCQkJcmNsaWNrYWJsZS50ZXN0KCBlbGVtLm5vZGVOYW1lICkgJiYgZWxlbS5ocmVmID8KCQkJCQkJCQkwIDoKCQkJCQkJCQktMTsKCQkJCX0KCQkJfQoJCX0sCgoJCXByb3BGaXg6IHsKCQkJImZvciI6ICJodG1sRm9yIiwKCQkJImNsYXNzIjogImNsYXNzTmFtZSIKCQl9Cgl9ICk7CgoJLy8gU29tZSBhdHRyaWJ1dGVzIHJlcXVpcmUgYSBzcGVjaWFsIGNhbGwgb24gSUUKCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKCWlmICggIXN1cHBvcnQuaHJlZk5vcm1hbGl6ZWQgKSB7CgoJCS8vIGhyZWYvc3JjIHByb3BlcnR5IHNob3VsZCBnZXQgdGhlIGZ1bGwgbm9ybWFsaXplZCBVUkwgKCMxMDI5OS8jMTI5MTUpCgkJalF1ZXJ5LmVhY2goIFsgImhyZWYiLCAic3JjIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCQkJalF1ZXJ5LnByb3BIb29rc1sgbmFtZSBdID0gewoJCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIDQgKTsKCQkJCX0KCQkJfTsKCQl9ICk7Cgl9CgoJLy8gU3VwcG9ydDogU2FmYXJpLCBJRTkrCgkvLyBtaXMtcmVwb3J0cyB0aGUgZGVmYXVsdCBzZWxlY3RlZCBwcm9wZXJ0eSBvZiBhbiBvcHRpb24KCS8vIEFjY2Vzc2luZyB0aGUgcGFyZW50J3Mgc2VsZWN0ZWRJbmRleCBwcm9wZXJ0eSBmaXhlcyBpdAoJaWYgKCAhc3VwcG9ydC5vcHRTZWxlY3RlZCApIHsKCQlqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKCgkJCQlpZiAoIHBhcmVudCApIHsKCQkJCQlwYXJlbnQuc2VsZWN0ZWRJbmRleDsKCgkJCQkJLy8gTWFrZSBzdXJlIHRoYXQgaXQgYWxzbyB3b3JrcyB3aXRoIG9wdGdyb3Vwcywgc2VlICM1NzAxCgkJCQkJaWYgKCBwYXJlbnQucGFyZW50Tm9kZSApIHsKCQkJCQkJcGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmVhY2goIFsKCQkidGFiSW5kZXgiLAoJCSJyZWFkT25seSIsCgkJIm1heExlbmd0aCIsCgkJImNlbGxTcGFjaW5nIiwKCQkiY2VsbFBhZGRpbmciLAoJCSJyb3dTcGFuIiwKCQkiY29sU3BhbiIsCgkJInVzZU1hcCIsCgkJImZyYW1lQm9yZGVyIiwKCQkiY29udGVudEVkaXRhYmxlIgoJXSwgZnVuY3Rpb24oKSB7CgkJalF1ZXJ5LnByb3BGaXhbIHRoaXMudG9Mb3dlckNhc2UoKSBdID0gdGhpczsKCX0gKTsKCgkvLyBJRTYvNyBjYWxsIGVuY3R5cGUgZW5jb2RpbmcKCWlmICggIXN1cHBvcnQuZW5jdHlwZSApIHsKCQlqUXVlcnkucHJvcEZpeC5lbmN0eXBlID0gImVuY29kaW5nIjsKCX0KCgoKCgl2YXIgcmNsYXNzID0gL1tcdFxyXG5cZl0vZzsKCglmdW5jdGlvbiBnZXRDbGFzcyggZWxlbSApIHsKCQlyZXR1cm4galF1ZXJ5LmF0dHIoIGVsZW0sICJjbGFzcyIgKSB8fCAiIjsKCX0KCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJYWRkQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY3VyVmFsdWUsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQkJaSA9IDA7CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGogKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkuYWRkQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIGdldENsYXNzKCB0aGlzICkgKSApOwoJCQkJfSApOwoJCQl9CgoJCQlpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWUgKSB7CgkJCQljbGFzc2VzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdOwoKCQkJCXdoaWxlICggKCBlbGVtID0gdGhpc1sgaSsrIF0gKSApIHsKCQkJCQljdXJWYWx1ZSA9IGdldENsYXNzKCBlbGVtICk7CgkJCQkJY3VyID0gZWxlbS5ub2RlVHlwZSA9PT0gMSAmJgoJCQkJCQkoICIgIiArIGN1clZhbHVlICsgIiAiICkucmVwbGFjZSggcmNsYXNzLCAiICIgKTsKCgkJCQkJaWYgKCBjdXIgKSB7CgkJCQkJCWogPSAwOwoJCQkJCQl3aGlsZSAoICggY2xhenogPSBjbGFzc2VzWyBqKysgXSApICkgewoJCQkJCQkJaWYgKCBjdXIuaW5kZXhPZiggIiAiICsgY2xhenogKyAiICIgKSA8IDAgKSB7CgkJCQkJCQkJY3VyICs9IGNsYXp6ICsgIiAiOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgoJCQkJCQlmaW5hbFZhbHVlID0galF1ZXJ5LnRyaW0oIGN1ciApOwoJCQkJCQlpZiAoIGN1clZhbHVlICE9PSBmaW5hbFZhbHVlICkgewoJCQkJCQkJalF1ZXJ5LmF0dHIoIGVsZW0sICJjbGFzcyIsIGZpbmFsVmFsdWUgKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY3VyVmFsdWUsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQkJaSA9IDA7CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGogKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkucmVtb3ZlQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIGdldENsYXNzKCB0aGlzICkgKSApOwoJCQkJfSApOwoJCQl9CgoJCQlpZiAoICFhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJcmV0dXJuIHRoaXMuYXR0ciggImNsYXNzIiwgIiIgKTsKCQkJfQoKCQkJaWYgKCB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmIHZhbHVlICkgewoJCQkJY2xhc3NlcyA9IHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCQl3aGlsZSAoICggZWxlbSA9IHRoaXNbIGkrKyBdICkgKSB7CgkJCQkJY3VyVmFsdWUgPSBnZXRDbGFzcyggZWxlbSApOwoKCQkJCQkvLyBUaGlzIGV4cHJlc3Npb24gaXMgaGVyZSBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIGFkZENsYXNzKQoJCQkJCWN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkJKCAiICIgKyBjdXJWYWx1ZSArICIgIiApLnJlcGxhY2UoIHJjbGFzcywgIiAiICk7CgoJCQkJCWlmICggY3VyICkgewoJCQkJCQlqID0gMDsKCQkJCQkJd2hpbGUgKCAoIGNsYXp6ID0gY2xhc3Nlc1sgaisrIF0gKSApIHsKCgkJCQkJCQkvLyBSZW1vdmUgKmFsbCogaW5zdGFuY2VzCgkJCQkJCQl3aGlsZSAoIGN1ci5pbmRleE9mKCAiICIgKyBjbGF6eiArICIgIiApID4gLTEgKSB7CgkJCQkJCQkJY3VyID0gY3VyLnJlcGxhY2UoICIgIiArIGNsYXp6ICsgIiAiLCAiICIgKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gT25seSBhc3NpZ24gaWYgZGlmZmVyZW50IHRvIGF2b2lkIHVubmVlZGVkIHJlbmRlcmluZy4KCQkJCQkJZmluYWxWYWx1ZSA9IGpRdWVyeS50cmltKCBjdXIgKTsKCQkJCQkJaWYgKCBjdXJWYWx1ZSAhPT0gZmluYWxWYWx1ZSApIHsKCQkJCQkJCWpRdWVyeS5hdHRyKCBlbGVtLCAiY2xhc3MiLCBmaW5hbFZhbHVlICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCXRvZ2dsZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUsIHN0YXRlVmFsICkgewoJCQl2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTsKCgkJCWlmICggdHlwZW9mIHN0YXRlVmFsID09PSAiYm9vbGVhbiIgJiYgdHlwZSA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXR1cm4gc3RhdGVWYWwgPyB0aGlzLmFkZENsYXNzKCB2YWx1ZSApIDogdGhpcy5yZW1vdmVDbGFzcyggdmFsdWUgKTsKCQkJfQoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQkJCWpRdWVyeSggdGhpcyApLnRvZ2dsZUNsYXNzKAoJCQkJCQl2YWx1ZS5jYWxsKCB0aGlzLCBpLCBnZXRDbGFzcyggdGhpcyApLCBzdGF0ZVZhbCApLAoJCQkJCQlzdGF0ZVZhbAoJCQkJCSk7CgkJCQl9ICk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFyIGNsYXNzTmFtZSwgaSwgc2VsZiwgY2xhc3NOYW1lczsKCgkJCQlpZiAoIHR5cGUgPT09ICJzdHJpbmciICkgewoKCQkJCQkvLyBUb2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lcwoJCQkJCWkgPSAwOwoJCQkJCXNlbGYgPSBqUXVlcnkoIHRoaXMgKTsKCQkJCQljbGFzc05hbWVzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdOwoKCQkJCQl3aGlsZSAoICggY2xhc3NOYW1lID0gY2xhc3NOYW1lc1sgaSsrIF0gKSApIHsKCgkJCQkJCS8vIENoZWNrIGVhY2ggY2xhc3NOYW1lIGdpdmVuLCBzcGFjZSBzZXBhcmF0ZWQgbGlzdAoJCQkJCQlpZiAoIHNlbGYuaGFzQ2xhc3MoIGNsYXNzTmFtZSApICkgewoJCQkJCQkJc2VsZi5yZW1vdmVDbGFzcyggY2xhc3NOYW1lICk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlzZWxmLmFkZENsYXNzKCBjbGFzc05hbWUgKTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkvLyBUb2dnbGUgd2hvbGUgY2xhc3MgbmFtZQoJCQkJfSBlbHNlIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB0eXBlID09PSAiYm9vbGVhbiIgKSB7CgkJCQkJY2xhc3NOYW1lID0gZ2V0Q2xhc3MoIHRoaXMgKTsKCQkJCQlpZiAoIGNsYXNzTmFtZSApIHsKCgkJCQkJCS8vIHN0b3JlIGNsYXNzTmFtZSBpZiBzZXQKCQkJCQkJalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiX19jbGFzc05hbWVfXyIsIGNsYXNzTmFtZSApOwoJCQkJCX0KCgkJCQkJLy8gSWYgdGhlIGVsZW1lbnQgaGFzIGEgY2xhc3MgbmFtZSBvciBpZiB3ZSdyZSBwYXNzZWQgImZhbHNlIiwKCQkJCQkvLyB0aGVuIHJlbW92ZSB0aGUgd2hvbGUgY2xhc3NuYW1lIChpZiB0aGVyZSB3YXMgb25lLCB0aGUgYWJvdmUgc2F2ZWQgaXQpLgoJCQkJCS8vIE90aGVyd2lzZSBicmluZyBiYWNrIHdoYXRldmVyIHdhcyBwcmV2aW91c2x5IHNhdmVkIChpZiBhbnl0aGluZyksCgkJCQkJLy8gZmFsbGluZyBiYWNrIHRvIHRoZSBlbXB0eSBzdHJpbmcgaWYgbm90aGluZyB3YXMgc3RvcmVkLgoJCQkJCWpRdWVyeS5hdHRyKCB0aGlzLCAiY2xhc3MiLAoJCQkJCQljbGFzc05hbWUgfHwgdmFsdWUgPT09IGZhbHNlID8KCQkJCQkJIiIgOgoJCQkJCQlqUXVlcnkuX2RhdGEoIHRoaXMsICJfX2NsYXNzTmFtZV9fIiApIHx8ICIiCgkJCQkJKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCWhhc0NsYXNzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBjbGFzc05hbWUsIGVsZW0sCgkJCQlpID0gMDsKCgkJCWNsYXNzTmFtZSA9ICIgIiArIHNlbGVjdG9yICsgIiAiOwoJCQl3aGlsZSAoICggZWxlbSA9IHRoaXNbIGkrKyBdICkgKSB7CgkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkoICIgIiArIGdldENsYXNzKCBlbGVtICkgKyAiICIgKS5yZXBsYWNlKCByY2xhc3MsICIgIiApCgkJCQkJCS5pbmRleE9mKCBjbGFzc05hbWUgKSA+IC0xCgkJCQkpIHsKCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCX0gKTsKCgoKCgkvLyBSZXR1cm4galF1ZXJ5IGZvciBhdHRyaWJ1dGVzLW9ubHkgaW5jbHVzaW9uCgoKCWpRdWVyeS5lYWNoKCAoICJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAiICsKCQkibW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgIiArCgkJImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiICkuc3BsaXQoICIgIiApLAoJCWZ1bmN0aW9uKCBpLCBuYW1lICkgewoKCQkvLyBIYW5kbGUgZXZlbnQgYmluZGluZwoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPwoJCQkJdGhpcy5vbiggbmFtZSwgbnVsbCwgZGF0YSwgZm4gKSA6CgkJCQl0aGlzLnRyaWdnZXIoIG5hbWUgKTsKCQl9OwoJfSApOwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlob3ZlcjogZnVuY3Rpb24oIGZuT3ZlciwgZm5PdXQgKSB7CgkJCXJldHVybiB0aGlzLm1vdXNlZW50ZXIoIGZuT3ZlciApLm1vdXNlbGVhdmUoIGZuT3V0IHx8IGZuT3ZlciApOwoJCX0KCX0gKTsKCgoJdmFyIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uOwoKCXZhciBub25jZSA9IGpRdWVyeS5ub3coKTsKCgl2YXIgcnF1ZXJ5ID0gKCAvXD8vICk7CgoKCgl2YXIgcnZhbGlkdG9rZW5zID0gLygsKXwoXFt8eyl8KH18XSl8Iig/OlteIlxcXHJcbl18XFxbIlxcXC9iZm5ydF18XFx1W1xkYS1mQS1GXXs0fSkqIlxzKjo/fHRydWV8ZmFsc2V8bnVsbHwtPyg/ITBcZClcZCsoPzpcLlxkK3wpKD86W2VFXVsrLV0/XGQrfCkvZzsKCglqUXVlcnkucGFyc2VKU09OID0gZnVuY3Rpb24oIGRhdGEgKSB7CgoJCS8vIEF0dGVtcHQgdG8gcGFyc2UgdXNpbmcgdGhlIG5hdGl2ZSBKU09OIHBhcnNlciBmaXJzdAoJCWlmICggd2luZG93LkpTT04gJiYgd2luZG93LkpTT04ucGFyc2UgKSB7CgoJCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDIuMwoJCQkvLyBXb3JrYXJvdW5kIGZhaWx1cmUgdG8gc3RyaW5nLWNhc3QgbnVsbCBpbnB1dAoJCQlyZXR1cm4gd2luZG93LkpTT04ucGFyc2UoIGRhdGEgKyAiIiApOwoJCX0KCgkJdmFyIHJlcXVpcmVOb25Db21tYSwKCQkJZGVwdGggPSBudWxsLAoJCQlzdHIgPSBqUXVlcnkudHJpbSggZGF0YSArICIiICk7CgoJCS8vIEd1YXJkIGFnYWluc3QgaW52YWxpZCAoYW5kIHBvc3NpYmx5IGRhbmdlcm91cykgaW5wdXQgYnkgZW5zdXJpbmcgdGhhdCBub3RoaW5nIHJlbWFpbnMKCQkvLyBhZnRlciByZW1vdmluZyB2YWxpZCB0b2tlbnMKCQlyZXR1cm4gc3RyICYmICFqUXVlcnkudHJpbSggc3RyLnJlcGxhY2UoIHJ2YWxpZHRva2VucywgZnVuY3Rpb24oIHRva2VuLCBjb21tYSwgb3BlbiwgY2xvc2UgKSB7CgoJCQkvLyBGb3JjZSB0ZXJtaW5hdGlvbiBpZiB3ZSBzZWUgYSBtaXNwbGFjZWQgY29tbWEKCQkJaWYgKCByZXF1aXJlTm9uQ29tbWEgJiYgY29tbWEgKSB7CgkJCQlkZXB0aCA9IDA7CgkJCX0KCgkJCS8vIFBlcmZvcm0gbm8gbW9yZSByZXBsYWNlbWVudHMgYWZ0ZXIgcmV0dXJuaW5nIHRvIG91dGVybW9zdCBkZXB0aAoJCQlpZiAoIGRlcHRoID09PSAwICkgewoJCQkJcmV0dXJuIHRva2VuOwoJCQl9CgoJCQkvLyBDb21tYXMgbXVzdCBub3QgZm9sbG93ICJbIiwgInsiLCBvciAiLCIKCQkJcmVxdWlyZU5vbkNvbW1hID0gb3BlbiB8fCBjb21tYTsKCgkJCS8vIERldGVybWluZSBuZXcgZGVwdGgKCQkJLy8gYXJyYXkvb2JqZWN0IG9wZW4gKCJbIiBvciAieyIpOiBkZXB0aCArPSB0cnVlIC0gZmFsc2UgKGluY3JlbWVudCkKCQkJLy8gYXJyYXkvb2JqZWN0IGNsb3NlICgiXSIgb3IgIn0iKTogZGVwdGggKz0gZmFsc2UgLSB0cnVlIChkZWNyZW1lbnQpCgkJCS8vIG90aGVyIGNhc2VzICgiLCIgb3IgcHJpbWl0aXZlKTogZGVwdGggKz0gdHJ1ZSAtIHRydWUgKG51bWVyaWMgY2FzdCkKCQkJZGVwdGggKz0gIWNsb3NlIC0gIW9wZW47CgoJCQkvLyBSZW1vdmUgdGhpcyB0b2tlbgoJCQlyZXR1cm4gIiI7CgkJfSApICkgPwoJCQkoIEZ1bmN0aW9uKCAicmV0dXJuICIgKyBzdHIgKSApKCkgOgoJCQlqUXVlcnkuZXJyb3IoICJJbnZhbGlkIEpTT046ICIgKyBkYXRhICk7Cgl9OwoKCgkvLyBDcm9zcy1icm93c2VyIHhtbCBwYXJzaW5nCglqUXVlcnkucGFyc2VYTUwgPSBmdW5jdGlvbiggZGF0YSApIHsKCQl2YXIgeG1sLCB0bXA7CgkJaWYgKCAhZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gInN0cmluZyIgKSB7CgkJCXJldHVybiBudWxsOwoJCX0KCQl0cnkgewoJCQlpZiAoIHdpbmRvdy5ET01QYXJzZXIgKSB7IC8vIFN0YW5kYXJkCgkJCQl0bXAgPSBuZXcgd2luZG93LkRPTVBhcnNlcigpOwoJCQkJeG1sID0gdG1wLnBhcnNlRnJvbVN0cmluZyggZGF0YSwgInRleHQveG1sIiApOwoJCQl9IGVsc2UgeyAvLyBJRQoJCQkJeG1sID0gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KCAiTWljcm9zb2Z0LlhNTERPTSIgKTsKCQkJCXhtbC5hc3luYyA9ICJmYWxzZSI7CgkJCQl4bWwubG9hZFhNTCggZGF0YSApOwoJCQl9CgkJfSBjYXRjaCAoIGUgKSB7CgkJCXhtbCA9IHVuZGVmaW5lZDsKCQl9CgkJaWYgKCAheG1sIHx8ICF4bWwuZG9jdW1lbnRFbGVtZW50IHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSggInBhcnNlcmVycm9yIiApLmxlbmd0aCApIHsKCQkJalF1ZXJ5LmVycm9yKCAiSW52YWxpZCBYTUw6ICIgKyBkYXRhICk7CgkJfQoJCXJldHVybiB4bWw7Cgl9OwoKCgl2YXIKCQlyaGFzaCA9IC8jLiokLywKCQlydHMgPSAvKFs/Jl0pXz1bXiZdKi8sCgoJCS8vIElFIGxlYXZlcyBhbiBcciBjaGFyYWN0ZXIgYXQgRU9MCgkJcmhlYWRlcnMgPSAvXiguKj8pOlsgXHRdKihbXlxyXG5dKilccj8kL21nLAoKCQkvLyAjNzY1MywgIzgxMjUsICM4MTUyOiBsb2NhbCBwcm90b2NvbCBkZXRlY3Rpb24KCQlybG9jYWxQcm90b2NvbCA9IC9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLAoJCXJub0NvbnRlbnQgPSAvXig/OkdFVHxIRUFEKSQvLAoJCXJwcm90b2NvbCA9IC9eXC9cLy8sCgkJcnVybCA9IC9eKFtcdy4rLV0rOikoPzpcL1wvKD86W15cLz8jXSpAfCkoW15cLz8jOl0qKSg/OjooXGQrKXwpfCkvLAoKCQkvKiBQcmVmaWx0ZXJzCgkJICogMSkgVGhleSBhcmUgdXNlZnVsIHRvIGludHJvZHVjZSBjdXN0b20gZGF0YVR5cGVzIChzZWUgYWpheC9qc29ucC5qcyBmb3IgYW4gZXhhbXBsZSkKCQkgKiAyKSBUaGVzZSBhcmUgY2FsbGVkOgoJCSAqICAgIC0gQkVGT1JFIGFza2luZyBmb3IgYSB0cmFuc3BvcnQKCQkgKiAgICAtIEFGVEVSIHBhcmFtIHNlcmlhbGl6YXRpb24gKHMuZGF0YSBpcyBhIHN0cmluZyBpZiBzLnByb2Nlc3NEYXRhIGlzIHRydWUpCgkJICogMykga2V5IGlzIHRoZSBkYXRhVHlwZQoJCSAqIDQpIHRoZSBjYXRjaGFsbCBzeW1ib2wgIioiIGNhbiBiZSB1c2VkCgkJICogNSkgZXhlY3V0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gY29udGludWUgZG93biB0byAiKiIgaWYgbmVlZGVkCgkJICovCgkJcHJlZmlsdGVycyA9IHt9LAoKCQkvKiBUcmFuc3BvcnRzIGJpbmRpbmdzCgkJICogMSkga2V5IGlzIHRoZSBkYXRhVHlwZQoJCSAqIDIpIHRoZSBjYXRjaGFsbCBzeW1ib2wgIioiIGNhbiBiZSB1c2VkCgkJICogMykgc2VsZWN0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28gdG8gIioiIGlmIG5lZWRlZAoJCSAqLwoJCXRyYW5zcG9ydHMgPSB7fSwKCgkJLy8gQXZvaWQgY29tbWVudC1wcm9sb2cgY2hhciBzZXF1ZW5jZSAoIzEwMDk4KTsgbXVzdCBhcHBlYXNlIGxpbnQgYW5kIGV2YWRlIGNvbXByZXNzaW9uCgkJYWxsVHlwZXMgPSAiKi8iLmNvbmNhdCggIioiICksCgoJCS8vIERvY3VtZW50IGxvY2F0aW9uCgkJYWpheExvY2F0aW9uID0gbG9jYXRpb24uaHJlZiwKCgkJLy8gU2VnbWVudCBsb2NhdGlvbiBpbnRvIHBhcnRzCgkJYWpheExvY1BhcnRzID0gcnVybC5leGVjKCBhamF4TG9jYXRpb24udG9Mb3dlckNhc2UoKSApIHx8IFtdOwoKCS8vIEJhc2UgImNvbnN0cnVjdG9yIiBmb3IgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIgYW5kIGpRdWVyeS5hamF4VHJhbnNwb3J0CglmdW5jdGlvbiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHN0cnVjdHVyZSApIHsKCgkJLy8gZGF0YVR5cGVFeHByZXNzaW9uIGlzIG9wdGlvbmFsIGFuZCBkZWZhdWx0cyB0byAiKiIKCQlyZXR1cm4gZnVuY3Rpb24oIGRhdGFUeXBlRXhwcmVzc2lvbiwgZnVuYyApIHsKCgkJCWlmICggdHlwZW9mIGRhdGFUeXBlRXhwcmVzc2lvbiAhPT0gInN0cmluZyIgKSB7CgkJCQlmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uOwoJCQkJZGF0YVR5cGVFeHByZXNzaW9uID0gIioiOwoJCQl9CgoJCQl2YXIgZGF0YVR5cGUsCgkJCQlpID0gMCwKCQkJCWRhdGFUeXBlcyA9IGRhdGFUeXBlRXhwcmVzc2lvbi50b0xvd2VyQ2FzZSgpLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGZ1bmMgKSApIHsKCgkJCQkvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9uCgkJCQl3aGlsZSAoICggZGF0YVR5cGUgPSBkYXRhVHlwZXNbIGkrKyBdICkgKSB7CgoJCQkJCS8vIFByZXBlbmQgaWYgcmVxdWVzdGVkCgkJCQkJaWYgKCBkYXRhVHlwZS5jaGFyQXQoIDAgKSA9PT0gIisiICkgewoJCQkJCQlkYXRhVHlwZSA9IGRhdGFUeXBlLnNsaWNlKCAxICkgfHwgIioiOwoJCQkJCQkoIHN0cnVjdHVyZVsgZGF0YVR5cGUgXSA9IHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSApLnVuc2hpZnQoIGZ1bmMgKTsKCgkJCQkJLy8gT3RoZXJ3aXNlIGFwcGVuZAoJCQkJCX0gZWxzZSB7CgkJCQkJCSggc3RydWN0dXJlWyBkYXRhVHlwZSBdID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdICkucHVzaCggZnVuYyApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX07Cgl9CgoJLy8gQmFzZSBpbnNwZWN0aW9uIGZ1bmN0aW9uIGZvciBwcmVmaWx0ZXJzIGFuZCB0cmFuc3BvcnRzCglmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggc3RydWN0dXJlLCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSICkgewoKCQl2YXIgaW5zcGVjdGVkID0ge30sCgkJCXNlZWtpbmdUcmFuc3BvcnQgPSAoIHN0cnVjdHVyZSA9PT0gdHJhbnNwb3J0cyApOwoKCQlmdW5jdGlvbiBpbnNwZWN0KCBkYXRhVHlwZSApIHsKCQkJdmFyIHNlbGVjdGVkOwoJCQlpbnNwZWN0ZWRbIGRhdGFUeXBlIF0gPSB0cnVlOwoJCQlqUXVlcnkuZWFjaCggc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdLCBmdW5jdGlvbiggXywgcHJlZmlsdGVyT3JGYWN0b3J5ICkgewoJCQkJdmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQgPSBwcmVmaWx0ZXJPckZhY3RvcnkoIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKTsKCQkJCWlmICggdHlwZW9mIGRhdGFUeXBlT3JUcmFuc3BvcnQgPT09ICJzdHJpbmciICYmCgkJCQkJIXNlZWtpbmdUcmFuc3BvcnQgJiYgIWluc3BlY3RlZFsgZGF0YVR5cGVPclRyYW5zcG9ydCBdICkgewoKCQkJCQlvcHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQkJaW5zcGVjdCggZGF0YVR5cGVPclRyYW5zcG9ydCApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0gZWxzZSBpZiAoIHNlZWtpbmdUcmFuc3BvcnQgKSB7CgkJCQkJcmV0dXJuICEoIHNlbGVjdGVkID0gZGF0YVR5cGVPclRyYW5zcG9ydCApOwoJCQkJfQoJCQl9ICk7CgkJCXJldHVybiBzZWxlY3RlZDsKCQl9CgoJCXJldHVybiBpbnNwZWN0KCBvcHRpb25zLmRhdGFUeXBlc1sgMCBdICkgfHwgIWluc3BlY3RlZFsgIioiIF0gJiYgaW5zcGVjdCggIioiICk7Cgl9CgoJLy8gQSBzcGVjaWFsIGV4dGVuZCBmb3IgYWpheCBvcHRpb25zCgkvLyB0aGF0IHRha2VzICJmbGF0IiBvcHRpb25zIChub3QgdG8gYmUgZGVlcCBleHRlbmRlZCkKCS8vIEZpeGVzICM5ODg3CglmdW5jdGlvbiBhamF4RXh0ZW5kKCB0YXJnZXQsIHNyYyApIHsKCQl2YXIgZGVlcCwga2V5LAoJCQlmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307CgoJCWZvciAoIGtleSBpbiBzcmMgKSB7CgkJCWlmICggc3JjWyBrZXkgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkJKCBmbGF0T3B0aW9uc1sga2V5IF0gPyB0YXJnZXQgOiAoIGRlZXAgfHwgKCBkZWVwID0ge30gKSApIClbIGtleSBdID0gc3JjWyBrZXkgXTsKCQkJfQoJCX0KCQlpZiAoIGRlZXAgKSB7CgkJCWpRdWVyeS5leHRlbmQoIHRydWUsIHRhcmdldCwgZGVlcCApOwoJCX0KCgkJcmV0dXJuIHRhcmdldDsKCX0KCgkvKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6CgkgKiAtIGZpbmRzIHRoZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUgYW5kIGV4cGVjdGVkIGRhdGFUeXBlKQoJICogLSByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlCgkgKi8KCWZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMoIHMsIGpxWEhSLCByZXNwb25zZXMgKSB7CgkJdmFyIGZpcnN0RGF0YVR5cGUsIGN0LCBmaW5hbERhdGFUeXBlLCB0eXBlLAoJCQljb250ZW50cyA9IHMuY29udGVudHMsCgkJCWRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzOwoKCQkvLyBSZW1vdmUgYXV0byBkYXRhVHlwZSBhbmQgZ2V0IGNvbnRlbnQtdHlwZSBpbiB0aGUgcHJvY2VzcwoJCXdoaWxlICggZGF0YVR5cGVzWyAwIF0gPT09ICIqIiApIHsKCQkJZGF0YVR5cGVzLnNoaWZ0KCk7CgkJCWlmICggY3QgPT09IHVuZGVmaW5lZCApIHsKCQkJCWN0ID0gcy5taW1lVHlwZSB8fCBqcVhIUi5nZXRSZXNwb25zZUhlYWRlciggIkNvbnRlbnQtVHlwZSIgKTsKCQkJfQoJCX0KCgkJLy8gQ2hlY2sgaWYgd2UncmUgZGVhbGluZyB3aXRoIGEga25vd24gY29udGVudC10eXBlCgkJaWYgKCBjdCApIHsKCQkJZm9yICggdHlwZSBpbiBjb250ZW50cyApIHsKCQkJCWlmICggY29udGVudHNbIHR5cGUgXSAmJiBjb250ZW50c1sgdHlwZSBdLnRlc3QoIGN0ICkgKSB7CgkJCQkJZGF0YVR5cGVzLnVuc2hpZnQoIHR5cGUgKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gQ2hlY2sgdG8gc2VlIGlmIHdlIGhhdmUgYSByZXNwb25zZSBmb3IgdGhlIGV4cGVjdGVkIGRhdGFUeXBlCgkJaWYgKCBkYXRhVHlwZXNbIDAgXSBpbiByZXNwb25zZXMgKSB7CgkJCWZpbmFsRGF0YVR5cGUgPSBkYXRhVHlwZXNbIDAgXTsKCQl9IGVsc2UgewoKCQkJLy8gVHJ5IGNvbnZlcnRpYmxlIGRhdGFUeXBlcwoJCQlmb3IgKCB0eXBlIGluIHJlc3BvbnNlcyApIHsKCQkJCWlmICggIWRhdGFUeXBlc1sgMCBdIHx8IHMuY29udmVydGVyc1sgdHlwZSArICIgIiArIGRhdGFUeXBlc1sgMCBdIF0gKSB7CgkJCQkJZmluYWxEYXRhVHlwZSA9IHR5cGU7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQlpZiAoICFmaXJzdERhdGFUeXBlICkgewoJCQkJCWZpcnN0RGF0YVR5cGUgPSB0eXBlOwoJCQkJfQoJCQl9CgoJCQkvLyBPciBqdXN0IHVzZSBmaXJzdCBvbmUKCQkJZmluYWxEYXRhVHlwZSA9IGZpbmFsRGF0YVR5cGUgfHwgZmlyc3REYXRhVHlwZTsKCQl9CgoJCS8vIElmIHdlIGZvdW5kIGEgZGF0YVR5cGUKCQkvLyBXZSBhZGQgdGhlIGRhdGFUeXBlIHRvIHRoZSBsaXN0IGlmIG5lZWRlZAoJCS8vIGFuZCByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKCQlpZiAoIGZpbmFsRGF0YVR5cGUgKSB7CgkJCWlmICggZmluYWxEYXRhVHlwZSAhPT0gZGF0YVR5cGVzWyAwIF0gKSB7CgkJCQlkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApOwoJCQl9CgkJCXJldHVybiByZXNwb25zZXNbIGZpbmFsRGF0YVR5cGUgXTsKCQl9Cgl9CgoJLyogQ2hhaW4gY29udmVyc2lvbnMgZ2l2ZW4gdGhlIHJlcXVlc3QgYW5kIHRoZSBvcmlnaW5hbCByZXNwb25zZQoJICogQWxzbyBzZXRzIHRoZSByZXNwb25zZVhYWCBmaWVsZHMgb24gdGhlIGpxWEhSIGluc3RhbmNlCgkgKi8KCWZ1bmN0aW9uIGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApIHsKCQl2YXIgY29udjIsIGN1cnJlbnQsIGNvbnYsIHRtcCwgcHJldiwKCQkJY29udmVydGVycyA9IHt9LAoKCQkJLy8gV29yayB3aXRoIGEgY29weSBvZiBkYXRhVHlwZXMgaW4gY2FzZSB3ZSBuZWVkIHRvIG1vZGlmeSBpdCBmb3IgY29udmVyc2lvbgoJCQlkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcy5zbGljZSgpOwoKCQkvLyBDcmVhdGUgY29udmVydGVycyBtYXAgd2l0aCBsb3dlcmNhc2VkIGtleXMKCQlpZiAoIGRhdGFUeXBlc1sgMSBdICkgewoJCQlmb3IgKCBjb252IGluIHMuY29udmVydGVycyApIHsKCQkJCWNvbnZlcnRlcnNbIGNvbnYudG9Mb3dlckNhc2UoKSBdID0gcy5jb252ZXJ0ZXJzWyBjb252IF07CgkJCX0KCQl9CgoJCWN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTsKCgkJLy8gQ29udmVydCB0byBlYWNoIHNlcXVlbnRpYWwgZGF0YVR5cGUKCQl3aGlsZSAoIGN1cnJlbnQgKSB7CgoJCQlpZiAoIHMucmVzcG9uc2VGaWVsZHNbIGN1cnJlbnQgXSApIHsKCQkJCWpxWEhSWyBzLnJlc3BvbnNlRmllbGRzWyBjdXJyZW50IF0gXSA9IHJlc3BvbnNlOwoJCQl9CgoJCQkvLyBBcHBseSB0aGUgZGF0YUZpbHRlciBpZiBwcm92aWRlZAoJCQlpZiAoICFwcmV2ICYmIGlzU3VjY2VzcyAmJiBzLmRhdGFGaWx0ZXIgKSB7CgkJCQlyZXNwb25zZSA9IHMuZGF0YUZpbHRlciggcmVzcG9uc2UsIHMuZGF0YVR5cGUgKTsKCQkJfQoKCQkJcHJldiA9IGN1cnJlbnQ7CgkJCWN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTsKCgkJCWlmICggY3VycmVudCApIHsKCgkJCQkvLyBUaGVyZSdzIG9ubHkgd29yayB0byBkbyBpZiBjdXJyZW50IGRhdGFUeXBlIGlzIG5vbi1hdXRvCgkJCQlpZiAoIGN1cnJlbnQgPT09ICIqIiApIHsKCgkJCQkJY3VycmVudCA9IHByZXY7CgoJCQkJLy8gQ29udmVydCByZXNwb25zZSBpZiBwcmV2IGRhdGFUeXBlIGlzIG5vbi1hdXRvIGFuZCBkaWZmZXJzIGZyb20gY3VycmVudAoJCQkJfSBlbHNlIGlmICggcHJldiAhPT0gIioiICYmIHByZXYgIT09IGN1cnJlbnQgKSB7CgoJCQkJCS8vIFNlZWsgYSBkaXJlY3QgY29udmVydGVyCgkJCQkJY29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyAiICIgKyBjdXJyZW50IF0gfHwgY29udmVydGVyc1sgIiogIiArIGN1cnJlbnQgXTsKCgkJCQkJLy8gSWYgbm9uZSBmb3VuZCwgc2VlayBhIHBhaXIKCQkJCQlpZiAoICFjb252ICkgewoJCQkJCQlmb3IgKCBjb252MiBpbiBjb252ZXJ0ZXJzICkgewoKCQkJCQkJCS8vIElmIGNvbnYyIG91dHB1dHMgY3VycmVudAoJCQkJCQkJdG1wID0gY29udjIuc3BsaXQoICIgIiApOwoJCQkJCQkJaWYgKCB0bXBbIDEgXSA9PT0gY3VycmVudCApIHsKCgkJCQkJCQkJLy8gSWYgcHJldiBjYW4gYmUgY29udmVydGVkIHRvIGFjY2VwdGVkIGlucHV0CgkJCQkJCQkJY29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyAiICIgKyB0bXBbIDAgXSBdIHx8CgkJCQkJCQkJCWNvbnZlcnRlcnNbICIqICIgKyB0bXBbIDAgXSBdOwoJCQkJCQkJCWlmICggY29udiApIHsKCgkJCQkJCQkJCS8vIENvbmRlbnNlIGVxdWl2YWxlbmNlIGNvbnZlcnRlcnMKCQkJCQkJCQkJaWYgKCBjb252ID09PSB0cnVlICkgewoJCQkJCQkJCQkJY29udiA9IGNvbnZlcnRlcnNbIGNvbnYyIF07CgoJCQkJCQkJCQkvLyBPdGhlcndpc2UsIGluc2VydCB0aGUgaW50ZXJtZWRpYXRlIGRhdGFUeXBlCgkJCQkJCQkJCX0gZWxzZSBpZiAoIGNvbnZlcnRlcnNbIGNvbnYyIF0gIT09IHRydWUgKSB7CgkJCQkJCQkJCQljdXJyZW50ID0gdG1wWyAwIF07CgkJCQkJCQkJCQlkYXRhVHlwZXMudW5zaGlmdCggdG1wWyAxIF0gKTsKCQkJCQkJCQkJfQoJCQkJCQkJCQlicmVhazsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIEFwcGx5IGNvbnZlcnRlciAoaWYgbm90IGFuIGVxdWl2YWxlbmNlKQoJCQkJCWlmICggY29udiAhPT0gdHJ1ZSApIHsKCgkJCQkJCS8vIFVubGVzcyBlcnJvcnMgYXJlIGFsbG93ZWQgdG8gYnViYmxlLCBjYXRjaCBhbmQgcmV0dXJuIHRoZW0KCQkJCQkJaWYgKCBjb252ICYmIHNbICJ0aHJvd3MiIF0gKSB7IC8vIGpzY3M6aWdub3JlIHJlcXVpcmVEb3ROb3RhdGlvbgoJCQkJCQkJcmVzcG9uc2UgPSBjb252KCByZXNwb25zZSApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdHJ5IHsKCQkJCQkJCQlyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7CgkJCQkJCQl9IGNhdGNoICggZSApIHsKCQkJCQkJCQlyZXR1cm4gewoJCQkJCQkJCQlzdGF0ZTogInBhcnNlcmVycm9yIiwKCQkJCQkJCQkJZXJyb3I6IGNvbnYgPyBlIDogIk5vIGNvbnZlcnNpb24gZnJvbSAiICsgcHJldiArICIgdG8gIiArIGN1cnJlbnQKCQkJCQkJCQl9OwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4geyBzdGF0ZTogInN1Y2Nlc3MiLCBkYXRhOiByZXNwb25zZSB9OwoJfQoKCWpRdWVyeS5leHRlbmQoIHsKCgkJLy8gQ291bnRlciBmb3IgaG9sZGluZyB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBxdWVyaWVzCgkJYWN0aXZlOiAwLAoKCQkvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4dCByZXF1ZXN0CgkJbGFzdE1vZGlmaWVkOiB7fSwKCQlldGFnOiB7fSwKCgkJYWpheFNldHRpbmdzOiB7CgkJCXVybDogYWpheExvY2F0aW9uLAoJCQl0eXBlOiAiR0VUIiwKCQkJaXNMb2NhbDogcmxvY2FsUHJvdG9jb2wudGVzdCggYWpheExvY1BhcnRzWyAxIF0gKSwKCQkJZ2xvYmFsOiB0cnVlLAoJCQlwcm9jZXNzRGF0YTogdHJ1ZSwKCQkJYXN5bmM6IHRydWUsCgkJCWNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKCQkJLyoKCQkJdGltZW91dDogMCwKCQkJZGF0YTogbnVsbCwKCQkJZGF0YVR5cGU6IG51bGwsCgkJCXVzZXJuYW1lOiBudWxsLAoJCQlwYXNzd29yZDogbnVsbCwKCQkJY2FjaGU6IG51bGwsCgkJCXRocm93czogZmFsc2UsCgkJCXRyYWRpdGlvbmFsOiBmYWxzZSwKCQkJaGVhZGVyczoge30sCgkJCSovCgoJCQlhY2NlcHRzOiB7CgkJCQkiKiI6IGFsbFR5cGVzLAoJCQkJdGV4dDogInRleHQvcGxhaW4iLAoJCQkJaHRtbDogInRleHQvaHRtbCIsCgkJCQl4bWw6ICJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIiwKCQkJCWpzb246ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQiCgkJCX0sCgoJCQljb250ZW50czogewoJCQkJeG1sOiAvXGJ4bWxcYi8sCgkJCQlodG1sOiAvXGJodG1sLywKCQkJCWpzb246IC9cYmpzb25cYi8KCQkJfSwKCgkJCXJlc3BvbnNlRmllbGRzOiB7CgkJCQl4bWw6ICJyZXNwb25zZVhNTCIsCgkJCQl0ZXh0OiAicmVzcG9uc2VUZXh0IiwKCQkJCWpzb246ICJyZXNwb25zZUpTT04iCgkJCX0sCgoJCQkvLyBEYXRhIGNvbnZlcnRlcnMKCQkJLy8gS2V5cyBzZXBhcmF0ZSBzb3VyY2UgKG9yIGNhdGNoYWxsICIqIikgYW5kIGRlc3RpbmF0aW9uIHR5cGVzIHdpdGggYSBzaW5nbGUgc3BhY2UKCQkJY29udmVydGVyczogewoKCQkJCS8vIENvbnZlcnQgYW55dGhpbmcgdG8gdGV4dAoJCQkJIiogdGV4dCI6IFN0cmluZywKCgkJCQkvLyBUZXh0IHRvIGh0bWwgKHRydWUgPSBubyB0cmFuc2Zvcm1hdGlvbikKCQkJCSJ0ZXh0IGh0bWwiOiB0cnVlLAoKCQkJCS8vIEV2YWx1YXRlIHRleHQgYXMgYSBqc29uIGV4cHJlc3Npb24KCQkJCSJ0ZXh0IGpzb24iOiBqUXVlcnkucGFyc2VKU09OLAoKCQkJCS8vIFBhcnNlIHRleHQgYXMgeG1sCgkJCQkidGV4dCB4bWwiOiBqUXVlcnkucGFyc2VYTUwKCQkJfSwKCgkJCS8vIEZvciBvcHRpb25zIHRoYXQgc2hvdWxkbid0IGJlIGRlZXAgZXh0ZW5kZWQ6CgkJCS8vIHlvdSBjYW4gYWRkIHlvdXIgb3duIGN1c3RvbSBvcHRpb25zIGhlcmUgaWYKCQkJLy8gYW5kIHdoZW4geW91IGNyZWF0ZSBvbmUgdGhhdCBzaG91bGRuJ3QgYmUKCQkJLy8gZGVlcCBleHRlbmRlZCAoc2VlIGFqYXhFeHRlbmQpCgkJCWZsYXRPcHRpb25zOiB7CgkJCQl1cmw6IHRydWUsCgkJCQljb250ZXh0OiB0cnVlCgkJCX0KCQl9LAoKCQkvLyBDcmVhdGVzIGEgZnVsbCBmbGVkZ2VkIHNldHRpbmdzIG9iamVjdCBpbnRvIHRhcmdldAoJCS8vIHdpdGggYm90aCBhamF4U2V0dGluZ3MgYW5kIHNldHRpbmdzIGZpZWxkcy4KCQkvLyBJZiB0YXJnZXQgaXMgb21pdHRlZCwgd3JpdGVzIGludG8gYWpheFNldHRpbmdzLgoJCWFqYXhTZXR1cDogZnVuY3Rpb24oIHRhcmdldCwgc2V0dGluZ3MgKSB7CgkJCXJldHVybiBzZXR0aW5ncyA/CgoJCQkJLy8gQnVpbGRpbmcgYSBzZXR0aW5ncyBvYmplY3QKCQkJCWFqYXhFeHRlbmQoIGFqYXhFeHRlbmQoIHRhcmdldCwgalF1ZXJ5LmFqYXhTZXR0aW5ncyApLCBzZXR0aW5ncyApIDoKCgkJCQkvLyBFeHRlbmRpbmcgYWpheFNldHRpbmdzCgkJCQlhamF4RXh0ZW5kKCBqUXVlcnkuYWpheFNldHRpbmdzLCB0YXJnZXQgKTsKCQl9LAoKCQlhamF4UHJlZmlsdGVyOiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHByZWZpbHRlcnMgKSwKCQlhamF4VHJhbnNwb3J0OiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMgKSwKCgkJLy8gTWFpbiBtZXRob2QKCQlhamF4OiBmdW5jdGlvbiggdXJsLCBvcHRpb25zICkgewoKCQkJLy8gSWYgdXJsIGlzIGFuIG9iamVjdCwgc2ltdWxhdGUgcHJlLTEuNSBzaWduYXR1cmUKCQkJaWYgKCB0eXBlb2YgdXJsID09PSAib2JqZWN0IiApIHsKCQkJCW9wdGlvbnMgPSB1cmw7CgkJCQl1cmwgPSB1bmRlZmluZWQ7CgkJCX0KCgkJCS8vIEZvcmNlIG9wdGlvbnMgdG8gYmUgYW4gb2JqZWN0CgkJCW9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKCQkJdmFyCgoJCQkJLy8gQ3Jvc3MtZG9tYWluIGRldGVjdGlvbiB2YXJzCgkJCQlwYXJ0cywKCgkJCQkvLyBMb29wIHZhcmlhYmxlCgkJCQlpLAoKCQkJCS8vIFVSTCB3aXRob3V0IGFudGktY2FjaGUgcGFyYW0KCQkJCWNhY2hlVVJMLAoKCQkJCS8vIFJlc3BvbnNlIGhlYWRlcnMgYXMgc3RyaW5nCgkJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcsCgoJCQkJLy8gdGltZW91dCBoYW5kbGUKCQkJCXRpbWVvdXRUaW1lciwKCgkJCQkvLyBUbyBrbm93IGlmIGdsb2JhbCBldmVudHMgYXJlIHRvIGJlIGRpc3BhdGNoZWQKCQkJCWZpcmVHbG9iYWxzLAoKCQkJCXRyYW5zcG9ydCwKCgkJCQkvLyBSZXNwb25zZSBoZWFkZXJzCgkJCQlyZXNwb25zZUhlYWRlcnMsCgoJCQkJLy8gQ3JlYXRlIHRoZSBmaW5hbCBvcHRpb25zIG9iamVjdAoJCQkJcyA9IGpRdWVyeS5hamF4U2V0dXAoIHt9LCBvcHRpb25zICksCgoJCQkJLy8gQ2FsbGJhY2tzIGNvbnRleHQKCQkJCWNhbGxiYWNrQ29udGV4dCA9IHMuY29udGV4dCB8fCBzLAoKCQkJCS8vIENvbnRleHQgZm9yIGdsb2JhbCBldmVudHMgaXMgY2FsbGJhY2tDb250ZXh0IGlmIGl0IGlzIGEgRE9NIG5vZGUgb3IgalF1ZXJ5IGNvbGxlY3Rpb24KCQkJCWdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJgoJCQkJCSggY2FsbGJhY2tDb250ZXh0Lm5vZGVUeXBlIHx8IGNhbGxiYWNrQ29udGV4dC5qcXVlcnkgKSA/CgkJCQkJCWpRdWVyeSggY2FsbGJhY2tDb250ZXh0ICkgOgoJCQkJCQlqUXVlcnkuZXZlbnQsCgoJCQkJLy8gRGVmZXJyZWRzCgkJCQlkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLAoJCQkJY29tcGxldGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwKCgkJCQkvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwoJCQkJc3RhdHVzQ29kZSA9IHMuc3RhdHVzQ29kZSB8fCB7fSwKCgkJCQkvLyBIZWFkZXJzICh0aGV5IGFyZSBzZW50IGFsbCBhdCBvbmNlKQoJCQkJcmVxdWVzdEhlYWRlcnMgPSB7fSwKCQkJCXJlcXVlc3RIZWFkZXJzTmFtZXMgPSB7fSwKCgkJCQkvLyBUaGUganFYSFIgc3RhdGUKCQkJCXN0YXRlID0gMCwKCgkJCQkvLyBEZWZhdWx0IGFib3J0IG1lc3NhZ2UKCQkJCXN0ckFib3J0ID0gImNhbmNlbGVkIiwKCgkJCQkvLyBGYWtlIHhocgoJCQkJanFYSFIgPSB7CgkJCQkJcmVhZHlTdGF0ZTogMCwKCgkJCQkJLy8gQnVpbGRzIGhlYWRlcnMgaGFzaHRhYmxlIGlmIG5lZWRlZAoJCQkJCWdldFJlc3BvbnNlSGVhZGVyOiBmdW5jdGlvbigga2V5ICkgewoJCQkJCQl2YXIgbWF0Y2g7CgkJCQkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQkJCQlpZiAoICFyZXNwb25zZUhlYWRlcnMgKSB7CgkJCQkJCQkJcmVzcG9uc2VIZWFkZXJzID0ge307CgkJCQkJCQkJd2hpbGUgKCAoIG1hdGNoID0gcmhlYWRlcnMuZXhlYyggcmVzcG9uc2VIZWFkZXJzU3RyaW5nICkgKSApIHsKCQkJCQkJCQkJcmVzcG9uc2VIZWFkZXJzWyBtYXRjaFsgMSBdLnRvTG93ZXJDYXNlKCkgXSA9IG1hdGNoWyAyIF07CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQkJbWF0Y2ggPSByZXNwb25zZUhlYWRlcnNbIGtleS50b0xvd2VyQ2FzZSgpIF07CgkJCQkJCX0KCQkJCQkJcmV0dXJuIG1hdGNoID09IG51bGwgPyBudWxsIDogbWF0Y2g7CgkJCQkJfSwKCgkJCQkJLy8gUmF3IHN0cmluZwoJCQkJCWdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24oKSB7CgkJCQkJCXJldHVybiBzdGF0ZSA9PT0gMiA/IHJlc3BvbnNlSGVhZGVyc1N0cmluZyA6IG51bGw7CgkJCQkJfSwKCgkJCQkJLy8gQ2FjaGVzIHRoZSBoZWFkZXIKCQkJCQlzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCQkJCXZhciBsbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCQkJCQkJaWYgKCAhc3RhdGUgKSB7CgkJCQkJCQluYW1lID0gcmVxdWVzdEhlYWRlcnNOYW1lc1sgbG5hbWUgXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gfHwgbmFtZTsKCQkJCQkJCXJlcXVlc3RIZWFkZXJzWyBuYW1lIF0gPSB2YWx1ZTsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9LAoKCQkJCQkvLyBPdmVycmlkZXMgcmVzcG9uc2UgY29udGVudC10eXBlIGhlYWRlcgoJCQkJCW92ZXJyaWRlTWltZVR5cGU6IGZ1bmN0aW9uKCB0eXBlICkgewoJCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJCXMubWltZVR5cGUgPSB0eXBlOwoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCQkJc3RhdHVzQ29kZTogZnVuY3Rpb24oIG1hcCApIHsKCQkJCQkJdmFyIGNvZGU7CgkJCQkJCWlmICggbWFwICkgewoJCQkJCQkJaWYgKCBzdGF0ZSA8IDIgKSB7CgkJCQkJCQkJZm9yICggY29kZSBpbiBtYXAgKSB7CgoJCQkJCQkJCQkvLyBMYXp5LWFkZCB0aGUgbmV3IGNhbGxiYWNrIGluIGEgd2F5IHRoYXQgcHJlc2VydmVzIG9sZCBvbmVzCgkJCQkJCQkJCXN0YXR1c0NvZGVbIGNvZGUgXSA9IFsgc3RhdHVzQ29kZVsgY29kZSBdLCBtYXBbIGNvZGUgXSBdOwoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgoJCQkJCQkJCS8vIEV4ZWN1dGUgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrcwoJCQkJCQkJCWpxWEhSLmFsd2F5cyggbWFwWyBqcVhIUi5zdGF0dXMgXSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIENhbmNlbCB0aGUgcmVxdWVzdAoJCQkJCWFib3J0OiBmdW5jdGlvbiggc3RhdHVzVGV4dCApIHsKCQkJCQkJdmFyIGZpbmFsVGV4dCA9IHN0YXR1c1RleHQgfHwgc3RyQWJvcnQ7CgkJCQkJCWlmICggdHJhbnNwb3J0ICkgewoJCQkJCQkJdHJhbnNwb3J0LmFib3J0KCBmaW5hbFRleHQgKTsKCQkJCQkJfQoJCQkJCQlkb25lKCAwLCBmaW5hbFRleHQgKTsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfQoJCQkJfTsKCgkJCS8vIEF0dGFjaCBkZWZlcnJlZHMKCQkJZGVmZXJyZWQucHJvbWlzZSgganFYSFIgKS5jb21wbGV0ZSA9IGNvbXBsZXRlRGVmZXJyZWQuYWRkOwoJCQlqcVhIUi5zdWNjZXNzID0ganFYSFIuZG9uZTsKCQkJanFYSFIuZXJyb3IgPSBqcVhIUi5mYWlsOwoKCQkJLy8gUmVtb3ZlIGhhc2ggY2hhcmFjdGVyICgjNzUzMTogYW5kIHN0cmluZyBwcm9tb3Rpb24pCgkJCS8vIEFkZCBwcm90b2NvbCBpZiBub3QgcHJvdmlkZWQgKCM1ODY2OiBJRTcgaXNzdWUgd2l0aCBwcm90b2NvbC1sZXNzIHVybHMpCgkJCS8vIEhhbmRsZSBmYWxzeSB1cmwgaW4gdGhlIHNldHRpbmdzIG9iamVjdCAoIzEwMDkzOiBjb25zaXN0ZW5jeSB3aXRoIG9sZCBzaWduYXR1cmUpCgkJCS8vIFdlIGFsc28gdXNlIHRoZSB1cmwgcGFyYW1ldGVyIGlmIGF2YWlsYWJsZQoJCQlzLnVybCA9ICggKCB1cmwgfHwgcy51cmwgfHwgYWpheExvY2F0aW9uICkgKyAiIiApCgkJCQkucmVwbGFjZSggcmhhc2gsICIiICkKCQkJCS5yZXBsYWNlKCBycHJvdG9jb2wsIGFqYXhMb2NQYXJ0c1sgMSBdICsgIi8vIiApOwoKCQkJLy8gQWxpYXMgbWV0aG9kIG9wdGlvbiB0byB0eXBlIGFzIHBlciB0aWNrZXQgIzEyMDA0CgkJCXMudHlwZSA9IG9wdGlvbnMubWV0aG9kIHx8IG9wdGlvbnMudHlwZSB8fCBzLm1ldGhvZCB8fCBzLnR5cGU7CgoJCQkvLyBFeHRyYWN0IGRhdGFUeXBlcyBsaXN0CgkJCXMuZGF0YVR5cGVzID0galF1ZXJ5LnRyaW0oIHMuZGF0YVR5cGUgfHwgIioiICkudG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyAiIiBdOwoKCQkJLy8gQSBjcm9zcy1kb21haW4gcmVxdWVzdCBpcyBpbiBvcmRlciB3aGVuIHdlIGhhdmUgYSBwcm90b2NvbDpob3N0OnBvcnQgbWlzbWF0Y2gKCQkJaWYgKCBzLmNyb3NzRG9tYWluID09IG51bGwgKSB7CgkJCQlwYXJ0cyA9IHJ1cmwuZXhlYyggcy51cmwudG9Mb3dlckNhc2UoKSApOwoJCQkJcy5jcm9zc0RvbWFpbiA9ICEhKCBwYXJ0cyAmJgoJCQkJCSggcGFydHNbIDEgXSAhPT0gYWpheExvY1BhcnRzWyAxIF0gfHwgcGFydHNbIDIgXSAhPT0gYWpheExvY1BhcnRzWyAyIF0gfHwKCQkJCQkJKCBwYXJ0c1sgMyBdIHx8ICggcGFydHNbIDEgXSA9PT0gImh0dHA6IiA/ICI4MCIgOiAiNDQzIiApICkgIT09CgkJCQkJCQkoIGFqYXhMb2NQYXJ0c1sgMyBdIHx8ICggYWpheExvY1BhcnRzWyAxIF0gPT09ICJodHRwOiIgPyAiODAiIDogIjQ0MyIgKSApICkKCQkJCSk7CgkJCX0KCgkJCS8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZwoJCQlpZiAoIHMuZGF0YSAmJiBzLnByb2Nlc3NEYXRhICYmIHR5cGVvZiBzLmRhdGEgIT09ICJzdHJpbmciICkgewoJCQkJcy5kYXRhID0galF1ZXJ5LnBhcmFtKCBzLmRhdGEsIHMudHJhZGl0aW9uYWwgKTsKCQkJfQoKCQkJLy8gQXBwbHkgcHJlZmlsdGVycwoJCQlpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJCS8vIElmIHJlcXVlc3Qgd2FzIGFib3J0ZWQgaW5zaWRlIGEgcHJlZmlsdGVyLCBzdG9wIHRoZXJlCgkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQlyZXR1cm4ganFYSFI7CgkJCX0KCgkJCS8vIFdlIGNhbiBmaXJlIGdsb2JhbCBldmVudHMgYXMgb2Ygbm93IGlmIGFza2VkIHRvCgkJCS8vIERvbid0IGZpcmUgZXZlbnRzIGlmIGpRdWVyeS5ldmVudCBpcyB1bmRlZmluZWQgaW4gYW4gQU1ELXVzYWdlIHNjZW5hcmlvICgjMTUxMTgpCgkJCWZpcmVHbG9iYWxzID0galF1ZXJ5LmV2ZW50ICYmIHMuZ2xvYmFsOwoKCQkJLy8gV2F0Y2ggZm9yIGEgbmV3IHNldCBvZiByZXF1ZXN0cwoJCQlpZiAoIGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCApIHsKCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCAiYWpheFN0YXJ0IiApOwoJCQl9CgoJCQkvLyBVcHBlcmNhc2UgdGhlIHR5cGUKCQkJcy50eXBlID0gcy50eXBlLnRvVXBwZXJDYXNlKCk7CgoJCQkvLyBEZXRlcm1pbmUgaWYgcmVxdWVzdCBoYXMgY29udGVudAoJCQlzLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KCBzLnR5cGUgKTsKCgkJCS8vIFNhdmUgdGhlIFVSTCBpbiBjYXNlIHdlJ3JlIHRveWluZyB3aXRoIHRoZSBJZi1Nb2RpZmllZC1TaW5jZQoJCQkvLyBhbmQvb3IgSWYtTm9uZQ==", "base64"));
  res.write(new Buffer("LU1hdGNoIGhlYWRlciBsYXRlciBvbgoJCQljYWNoZVVSTCA9IHMudXJsOwoKCQkJLy8gTW9yZSBvcHRpb25zIGhhbmRsaW5nIGZvciByZXF1ZXN0cyB3aXRoIG5vIGNvbnRlbnQKCQkJaWYgKCAhcy5oYXNDb250ZW50ICkgewoKCQkJCS8vIElmIGRhdGEgaXMgYXZhaWxhYmxlLCBhcHBlbmQgZGF0YSB0byB1cmwKCQkJCWlmICggcy5kYXRhICkgewoJCQkJCWNhY2hlVVJMID0gKCBzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gIiYiIDogIj8iICkgKyBzLmRhdGEgKTsKCgkJCQkJLy8gIzk2ODI6IHJlbW92ZSBkYXRhIHNvIHRoYXQgaXQncyBub3QgdXNlZCBpbiBhbiBldmVudHVhbCByZXRyeQoJCQkJCWRlbGV0ZSBzLmRhdGE7CgkJCQl9CgoJCQkJLy8gQWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZAoJCQkJaWYgKCBzLmNhY2hlID09PSBmYWxzZSApIHsKCQkJCQlzLnVybCA9IHJ0cy50ZXN0KCBjYWNoZVVSTCApID8KCgkJCQkJCS8vIElmIHRoZXJlIGlzIGFscmVhZHkgYSAnXycgcGFyYW1ldGVyLCBzZXQgaXRzIHZhbHVlCgkJCQkJCWNhY2hlVVJMLnJlcGxhY2UoIHJ0cywgIiQxXz0iICsgbm9uY2UrKyApIDoKCgkJCQkJCS8vIE90aGVyd2lzZSBhZGQgb25lIHRvIHRoZSBlbmQKCQkJCQkJY2FjaGVVUkwgKyAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gIiYiIDogIj8iICkgKyAiXz0iICsgbm9uY2UrKzsKCQkJCX0KCQkJfQoKCQkJLy8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS4KCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQlpZiAoIGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gKSB7CgkJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIklmLU1vZGlmaWVkLVNpbmNlIiwgalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApOwoJCQkJfQoJCQkJaWYgKCBqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSApIHsKCQkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCAiSWYtTm9uZS1NYXRjaCIsIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICk7CgkJCQl9CgkJCX0KCgkJCS8vIFNldCB0aGUgY29ycmVjdCBoZWFkZXIsIGlmIGRhdGEgaXMgYmVpbmcgc2VudAoJCQlpZiAoIHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSApIHsKCQkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoICJDb250ZW50LVR5cGUiLCBzLmNvbnRlbnRUeXBlICk7CgkJCX0KCgkJCS8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRlcGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlcigKCQkJCSJBY2NlcHQiLAoJCQkJcy5kYXRhVHlwZXNbIDAgXSAmJiBzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWyAwIF0gXSA/CgkJCQkJcy5hY2NlcHRzWyBzLmRhdGFUeXBlc1sgMCBdIF0gKwoJCQkJCQkoIHMuZGF0YVR5cGVzWyAwIF0gIT09ICIqIiA/ICIsICIgKyBhbGxUeXBlcyArICI7IHE9MC4wMSIgOiAiIiApIDoKCQkJCQlzLmFjY2VwdHNbICIqIiBdCgkJCSk7CgoJCQkvLyBDaGVjayBmb3IgaGVhZGVycyBvcHRpb24KCQkJZm9yICggaSBpbiBzLmhlYWRlcnMgKSB7CgkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBzLmhlYWRlcnNbIGkgXSApOwoJCQl9CgoJCQkvLyBBbGxvdyBjdXN0b20gaGVhZGVycy9taW1ldHlwZXMgYW5kIGVhcmx5IGFib3J0CgkJCWlmICggcy5iZWZvcmVTZW5kICYmCgkJCQkoIHMuYmVmb3JlU2VuZC5jYWxsKCBjYWxsYmFja0NvbnRleHQsIGpxWEhSLCBzICkgPT09IGZhbHNlIHx8IHN0YXRlID09PSAyICkgKSB7CgoJCQkJLy8gQWJvcnQgaWYgbm90IGRvbmUgYWxyZWFkeSBhbmQgcmV0dXJuCgkJCQlyZXR1cm4ganFYSFIuYWJvcnQoKTsKCQkJfQoKCQkJLy8gYWJvcnRpbmcgaXMgbm8gbG9uZ2VyIGEgY2FuY2VsbGF0aW9uCgkJCXN0ckFib3J0ID0gImFib3J0IjsKCgkJCS8vIEluc3RhbGwgY2FsbGJhY2tzIG9uIGRlZmVycmVkcwoJCQlmb3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0gKSB7CgkJCQlqcVhIUlsgaSBdKCBzWyBpIF0gKTsKCQkJfQoKCQkJLy8gR2V0IHRyYW5zcG9ydAoJCQl0cmFuc3BvcnQgPSBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJCS8vIElmIG5vIHRyYW5zcG9ydCwgd2UgYXV0by1hYm9ydAoJCQlpZiAoICF0cmFuc3BvcnQgKSB7CgkJCQlkb25lKCAtMSwgIk5vIFRyYW5zcG9ydCIgKTsKCQkJfSBlbHNlIHsKCQkJCWpxWEhSLnJlYWR5U3RhdGUgPSAxOwoKCQkJCS8vIFNlbmQgZ2xvYmFsIGV2ZW50CgkJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCAiYWpheFNlbmQiLCBbIGpxWEhSLCBzIF0gKTsKCQkJCX0KCgkJCQkvLyBJZiByZXF1ZXN0IHdhcyBhYm9ydGVkIGluc2lkZSBhamF4U2VuZCwgc3RvcCB0aGVyZQoJCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCQlyZXR1cm4ganFYSFI7CgkJCQl9CgoJCQkJLy8gVGltZW91dAoJCQkJaWYgKCBzLmFzeW5jICYmIHMudGltZW91dCA+IDAgKSB7CgkJCQkJdGltZW91dFRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQkJCQlqcVhIUi5hYm9ydCggInRpbWVvdXQiICk7CgkJCQkJfSwgcy50aW1lb3V0ICk7CgkJCQl9CgoJCQkJdHJ5IHsKCQkJCQlzdGF0ZSA9IDE7CgkJCQkJdHJhbnNwb3J0LnNlbmQoIHJlcXVlc3RIZWFkZXJzLCBkb25lICk7CgkJCQl9IGNhdGNoICggZSApIHsKCgkJCQkJLy8gUHJvcGFnYXRlIGV4Y2VwdGlvbiBhcyBlcnJvciBpZiBub3QgZG9uZQoJCQkJCWlmICggc3RhdGUgPCAyICkgewoJCQkJCQlkb25lKCAtMSwgZSApOwoKCQkJCQkvLyBTaW1wbHkgcmV0aHJvdyBvdGhlcndpc2UKCQkJCQl9IGVsc2UgewoJCQkJCQl0aHJvdyBlOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlcnl0aGluZyBpcyBkb25lCgkJCWZ1bmN0aW9uIGRvbmUoIHN0YXR1cywgbmF0aXZlU3RhdHVzVGV4dCwgcmVzcG9uc2VzLCBoZWFkZXJzICkgewoJCQkJdmFyIGlzU3VjY2Vzcywgc3VjY2VzcywgZXJyb3IsIHJlc3BvbnNlLCBtb2RpZmllZCwKCQkJCQlzdGF0dXNUZXh0ID0gbmF0aXZlU3RhdHVzVGV4dDsKCgkJCQkvLyBDYWxsZWQgb25jZQoJCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gU3RhdGUgaXMgImRvbmUiIG5vdwoJCQkJc3RhdGUgPSAyOwoKCQkJCS8vIENsZWFyIHRpbWVvdXQgaWYgaXQgZXhpc3RzCgkJCQlpZiAoIHRpbWVvdXRUaW1lciApIHsKCQkJCQl3aW5kb3cuY2xlYXJUaW1lb3V0KCB0aW1lb3V0VGltZXIgKTsKCQkJCX0KCgkJCQkvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5IGdhcmJhZ2UgY29sbGVjdGlvbgoJCQkJLy8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZCkKCQkJCXRyYW5zcG9ydCA9IHVuZGVmaW5lZDsKCgkJCQkvLyBDYWNoZSByZXNwb25zZSBoZWFkZXJzCgkJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcgPSBoZWFkZXJzIHx8ICIiOwoKCQkJCS8vIFNldCByZWFkeVN0YXRlCgkJCQlqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwOwoKCQkJCS8vIERldGVybWluZSBpZiBzdWNjZXNzZnVsCgkJCQlpc1N1Y2Nlc3MgPSBzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNDsKCgkJCQkvLyBHZXQgcmVzcG9uc2UgZGF0YQoJCQkJaWYgKCByZXNwb25zZXMgKSB7CgkJCQkJcmVzcG9uc2UgPSBhamF4SGFuZGxlUmVzcG9uc2VzKCBzLCBqcVhIUiwgcmVzcG9uc2VzICk7CgkJCQl9CgoJCQkJLy8gQ29udmVydCBubyBtYXR0ZXIgd2hhdCAodGhhdCB3YXkgcmVzcG9uc2VYWFggZmllbGRzIGFyZSBhbHdheXMgc2V0KQoJCQkJcmVzcG9uc2UgPSBhamF4Q29udmVydCggcywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MgKTsKCgkJCQkvLyBJZiBzdWNjZXNzZnVsLCBoYW5kbGUgdHlwZSBjaGFpbmluZwoJCQkJaWYgKCBpc1N1Y2Nlc3MgKSB7CgoJCQkJCS8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuCgkJCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQkJCW1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoICJMYXN0LU1vZGlmaWVkIiApOwoJCQkJCQlpZiAoIG1vZGlmaWVkICkgewoJCQkJCQkJalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSA9IG1vZGlmaWVkOwoJCQkJCQl9CgkJCQkJCW1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoICJldGFnIiApOwoJCQkJCQlpZiAoIG1vZGlmaWVkICkgewoJCQkJCQkJalF1ZXJ5LmV0YWdbIGNhY2hlVVJMIF0gPSBtb2RpZmllZDsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gaWYgbm8gY29udGVudAoJCQkJCWlmICggc3RhdHVzID09PSAyMDQgfHwgcy50eXBlID09PSAiSEVBRCIgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAibm9jb250ZW50IjsKCgkJCQkJLy8gaWYgbm90IG1vZGlmaWVkCgkJCQkJfSBlbHNlIGlmICggc3RhdHVzID09PSAzMDQgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAibm90bW9kaWZpZWQiOwoKCQkJCQkvLyBJZiB3ZSBoYXZlIGRhdGEsIGxldCdzIGNvbnZlcnQgaXQKCQkJCQl9IGVsc2UgewoJCQkJCQlzdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdGU7CgkJCQkJCXN1Y2Nlc3MgPSByZXNwb25zZS5kYXRhOwoJCQkJCQllcnJvciA9IHJlc3BvbnNlLmVycm9yOwoJCQkJCQlpc1N1Y2Nlc3MgPSAhZXJyb3I7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCgkJCQkJLy8gV2UgZXh0cmFjdCBlcnJvciBmcm9tIHN0YXR1c1RleHQKCQkJCQkvLyB0aGVuIG5vcm1hbGl6ZSBzdGF0dXNUZXh0IGFuZCBzdGF0dXMgZm9yIG5vbi1hYm9ydHMKCQkJCQllcnJvciA9IHN0YXR1c1RleHQ7CgkJCQkJaWYgKCBzdGF0dXMgfHwgIXN0YXR1c1RleHQgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAiZXJyb3IiOwoJCQkJCQlpZiAoIHN0YXR1cyA8IDAgKSB7CgkJCQkJCQlzdGF0dXMgPSAwOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFNldCBkYXRhIGZvciB0aGUgZmFrZSB4aHIgb2JqZWN0CgkJCQlqcVhIUi5zdGF0dXMgPSBzdGF0dXM7CgkJCQlqcVhIUi5zdGF0dXNUZXh0ID0gKCBuYXRpdmVTdGF0dXNUZXh0IHx8IHN0YXR1c1RleHQgKSArICIiOwoKCQkJCS8vIFN1Y2Nlc3MvRXJyb3IKCQkJCWlmICggaXNTdWNjZXNzICkgewoJCQkJCWRlZmVycmVkLnJlc29sdmVXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsgc3VjY2Vzcywgc3RhdHVzVGV4dCwganFYSFIgXSApOwoJCQkJfSBlbHNlIHsKCQkJCQlkZWZlcnJlZC5yZWplY3RXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsganFYSFIsIHN0YXR1c1RleHQsIGVycm9yIF0gKTsKCQkJCX0KCgkJCQkvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwoJCQkJanFYSFIuc3RhdHVzQ29kZSggc3RhdHVzQ29kZSApOwoJCQkJc3RhdHVzQ29kZSA9IHVuZGVmaW5lZDsKCgkJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCBpc1N1Y2Nlc3MgPyAiYWpheFN1Y2Nlc3MiIDogImFqYXhFcnJvciIsCgkJCQkJCVsganFYSFIsIHMsIGlzU3VjY2VzcyA/IHN1Y2Nlc3MgOiBlcnJvciBdICk7CgkJCQl9CgoJCQkJLy8gQ29tcGxldGUKCQkJCWNvbXBsZXRlRGVmZXJyZWQuZmlyZVdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBqcVhIUiwgc3RhdHVzVGV4dCBdICk7CgoJCQkJaWYgKCBmaXJlR2xvYmFscyApIHsKCQkJCQlnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggImFqYXhDb21wbGV0ZSIsIFsganFYSFIsIHMgXSApOwoKCQkJCQkvLyBIYW5kbGUgdGhlIGdsb2JhbCBBSkFYIGNvdW50ZXIKCQkJCQlpZiAoICEoIC0talF1ZXJ5LmFjdGl2ZSApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlciggImFqYXhTdG9wIiApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGpxWEhSOwoJCX0sCgoJCWdldEpTT046IGZ1bmN0aW9uKCB1cmwsIGRhdGEsIGNhbGxiYWNrICkgewoJCQlyZXR1cm4galF1ZXJ5LmdldCggdXJsLCBkYXRhLCBjYWxsYmFjaywgImpzb24iICk7CgkJfSwKCgkJZ2V0U2NyaXB0OiBmdW5jdGlvbiggdXJsLCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgdW5kZWZpbmVkLCBjYWxsYmFjaywgInNjcmlwdCIgKTsKCQl9Cgl9ICk7CgoJalF1ZXJ5LmVhY2goIFsgImdldCIsICJwb3N0IiBdLCBmdW5jdGlvbiggaSwgbWV0aG9kICkgewoJCWpRdWVyeVsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjaywgdHlwZSApIHsKCgkJCS8vIHNoaWZ0IGFyZ3VtZW50cyBpZiBkYXRhIGFyZ3VtZW50IHdhcyBvbWl0dGVkCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGRhdGEgKSApIHsKCQkJCXR5cGUgPSB0eXBlIHx8IGNhbGxiYWNrOwoJCQkJY2FsbGJhY2sgPSBkYXRhOwoJCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQkJfQoKCQkJLy8gVGhlIHVybCBjYW4gYmUgYW4gb3B0aW9ucyBvYmplY3QgKHdoaWNoIHRoZW4gbXVzdCBoYXZlIC51cmwpCgkJCXJldHVybiBqUXVlcnkuYWpheCggalF1ZXJ5LmV4dGVuZCggewoJCQkJdXJsOiB1cmwsCgkJCQl0eXBlOiBtZXRob2QsCgkJCQlkYXRhVHlwZTogdHlwZSwKCQkJCWRhdGE6IGRhdGEsCgkJCQlzdWNjZXNzOiBjYWxsYmFjawoJCQl9LCBqUXVlcnkuaXNQbGFpbk9iamVjdCggdXJsICkgJiYgdXJsICkgKTsKCQl9OwoJfSApOwoKCglqUXVlcnkuX2V2YWxVcmwgPSBmdW5jdGlvbiggdXJsICkgewoJCXJldHVybiBqUXVlcnkuYWpheCggewoJCQl1cmw6IHVybCwKCgkJCS8vIE1ha2UgdGhpcyBleHBsaWNpdCwgc2luY2UgdXNlciBjYW4gb3ZlcnJpZGUgdGhpcyB0aHJvdWdoIGFqYXhTZXR1cCAoIzExMjY0KQoJCQl0eXBlOiAiR0VUIiwKCQkJZGF0YVR5cGU6ICJzY3JpcHQiLAoJCQljYWNoZTogdHJ1ZSwKCQkJYXN5bmM6IGZhbHNlLAoJCQlnbG9iYWw6IGZhbHNlLAoJCQkidGhyb3dzIjogdHJ1ZQoJCX0gKTsKCX07CgoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQl3cmFwQWxsOiBmdW5jdGlvbiggaHRtbCApIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaHRtbC5jYWxsKCB0aGlzLCBpICkgKTsKCQkJCX0gKTsKCQkJfQoKCQkJaWYgKCB0aGlzWyAwIF0gKSB7CgoJCQkJLy8gVGhlIGVsZW1lbnRzIHRvIHdyYXAgdGhlIHRhcmdldCBhcm91bmQKCQkJCXZhciB3cmFwID0galF1ZXJ5KCBodG1sLCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCApLmVxKCAwICkuY2xvbmUoIHRydWUgKTsKCgkJCQlpZiAoIHRoaXNbIDAgXS5wYXJlbnROb2RlICkgewoJCQkJCXdyYXAuaW5zZXJ0QmVmb3JlKCB0aGlzWyAwIF0gKTsKCQkJCX0KCgkJCQl3cmFwLm1hcCggZnVuY3Rpb24oKSB7CgkJCQkJdmFyIGVsZW0gPSB0aGlzOwoKCQkJCQl3aGlsZSAoIGVsZW0uZmlyc3RDaGlsZCAmJiBlbGVtLmZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCWVsZW0gPSBlbGVtLmZpcnN0Q2hpbGQ7CgkJCQkJfQoKCQkJCQlyZXR1cm4gZWxlbTsKCQkJCX0gKS5hcHBlbmQoIHRoaXMgKTsKCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJd3JhcElubmVyOiBmdW5jdGlvbiggaHRtbCApIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkud3JhcElubmVyKCBodG1sLmNhbGwoIHRoaXMsIGkgKSApOwoJCQkJfSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJCXZhciBzZWxmID0galF1ZXJ5KCB0aGlzICksCgkJCQkJY29udGVudHMgPSBzZWxmLmNvbnRlbnRzKCk7CgoJCQkJaWYgKCBjb250ZW50cy5sZW5ndGggKSB7CgkJCQkJY29udGVudHMud3JhcEFsbCggaHRtbCApOwoKCQkJCX0gZWxzZSB7CgkJCQkJc2VsZi5hcHBlbmQoIGh0bWwgKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCXdyYXA6IGZ1bmN0aW9uKCBodG1sICkgewoJCQl2YXIgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICk7CgoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbiggaSApIHsKCQkJCWpRdWVyeSggdGhpcyApLndyYXBBbGwoIGlzRnVuY3Rpb24gPyBodG1sLmNhbGwoIHRoaXMsIGkgKSA6IGh0bWwgKTsKCQkJfSApOwoJCX0sCgoJCXVud3JhcDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJaWYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCAiYm9keSIgKSApIHsKCQkJCQlqUXVlcnkoIHRoaXMgKS5yZXBsYWNlV2l0aCggdGhpcy5jaGlsZE5vZGVzICk7CgkJCQl9CgkJCX0gKS5lbmQoKTsKCQl9Cgl9ICk7CgoKCWZ1bmN0aW9uIGdldERpc3BsYXkoIGVsZW0gKSB7CgkJcmV0dXJuIGVsZW0uc3R5bGUgJiYgZWxlbS5zdHlsZS5kaXNwbGF5IHx8IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApOwoJfQoKCWZ1bmN0aW9uIGZpbHRlckhpZGRlbiggZWxlbSApIHsKCQl3aGlsZSAoIGVsZW0gJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJaWYgKCBnZXREaXNwbGF5KCBlbGVtICkgPT09ICJub25lIiB8fCBlbGVtLnR5cGUgPT09ICJoaWRkZW4iICkgewoJCQkJcmV0dXJuIHRydWU7CgkJCX0KCQkJZWxlbSA9IGVsZW0ucGFyZW50Tm9kZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfQoKCWpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuID0gZnVuY3Rpb24oIGVsZW0gKSB7CgoJCS8vIFN1cHBvcnQ6IE9wZXJhIDw9IDEyLjEyCgkJLy8gT3BlcmEgcmVwb3J0cyBvZmZzZXRXaWR0aHMgYW5kIG9mZnNldEhlaWdodHMgbGVzcyB0aGFuIHplcm8gb24gc29tZSBlbGVtZW50cwoJCXJldHVybiBzdXBwb3J0LnJlbGlhYmxlSGlkZGVuT2Zmc2V0cygpID8KCQkJKCBlbGVtLm9mZnNldFdpZHRoIDw9IDAgJiYgZWxlbS5vZmZzZXRIZWlnaHQgPD0gMCAmJgoJCQkJIWVsZW0uZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggKSA6CgkJCQlmaWx0ZXJIaWRkZW4oIGVsZW0gKTsKCX07CgoJalF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuICFqUXVlcnkuZXhwci5maWx0ZXJzLmhpZGRlbiggZWxlbSApOwoJfTsKCgoKCgl2YXIgcjIwID0gLyUyMC9nLAoJCXJicmFja2V0ID0gL1xbXF0kLywKCQlyQ1JMRiA9IC9ccj9cbi9nLAoJCXJzdWJtaXR0ZXJUeXBlcyA9IC9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSwKCQlyc3VibWl0dGFibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7CgoJZnVuY3Rpb24gYnVpbGRQYXJhbXMoIHByZWZpeCwgb2JqLCB0cmFkaXRpb25hbCwgYWRkICkgewoJCXZhciBuYW1lOwoKCQlpZiAoIGpRdWVyeS5pc0FycmF5KCBvYmogKSApIHsKCgkJCS8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLgoJCQlqUXVlcnkuZWFjaCggb2JqLCBmdW5jdGlvbiggaSwgdiApIHsKCQkJCWlmICggdHJhZGl0aW9uYWwgfHwgcmJyYWNrZXQudGVzdCggcHJlZml4ICkgKSB7CgoJCQkJCS8vIFRyZWF0IGVhY2ggYXJyYXkgaXRlbSBhcyBhIHNjYWxhci4KCQkJCQlhZGQoIHByZWZpeCwgdiApOwoKCQkJCX0gZWxzZSB7CgoJCQkJCS8vIEl0ZW0gaXMgbm9uLXNjYWxhciAoYXJyYXkgb3Igb2JqZWN0KSwgZW5jb2RlIGl0cyBudW1lcmljIGluZGV4LgoJCQkJCWJ1aWxkUGFyYW1zKAoJCQkJCQlwcmVmaXggKyAiWyIgKyAoIHR5cGVvZiB2ID09PSAib2JqZWN0IiAmJiB2ICE9IG51bGwgPyBpIDogIiIgKSArICJdIiwKCQkJCQkJdiwKCQkJCQkJdHJhZGl0aW9uYWwsCgkJCQkJCWFkZAoJCQkJCSk7CgkJCQl9CgkJCX0gKTsKCgkJfSBlbHNlIGlmICggIXRyYWRpdGlvbmFsICYmIGpRdWVyeS50eXBlKCBvYmogKSA9PT0gIm9iamVjdCIgKSB7CgoJCQkvLyBTZXJpYWxpemUgb2JqZWN0IGl0ZW0uCgkJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCArICJbIiArIG5hbWUgKyAiXSIsIG9ialsgbmFtZSBdLCB0cmFkaXRpb25hbCwgYWRkICk7CgkJCX0KCgkJfSBlbHNlIHsKCgkJCS8vIFNlcmlhbGl6ZSBzY2FsYXIgaXRlbS4KCQkJYWRkKCBwcmVmaXgsIG9iaiApOwoJCX0KCX0KCgkvLyBTZXJpYWxpemUgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cyBvciBhIHNldCBvZgoJLy8ga2V5L3ZhbHVlcyBpbnRvIGEgcXVlcnkgc3RyaW5nCglqUXVlcnkucGFyYW0gPSBmdW5jdGlvbiggYSwgdHJhZGl0aW9uYWwgKSB7CgkJdmFyIHByZWZpeCwKCQkJcyA9IFtdLAoJCQlhZGQgPSBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsKCgkJCQkvLyBJZiB2YWx1ZSBpcyBhIGZ1bmN0aW9uLCBpbnZva2UgaXQgYW5kIHJldHVybiBpdHMgdmFsdWUKCQkJCXZhbHVlID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgPyB2YWx1ZSgpIDogKCB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1ZSApOwoJCQkJc1sgcy5sZW5ndGggXSA9IGVuY29kZVVSSUNvbXBvbmVudCgga2V5ICkgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQoIHZhbHVlICk7CgkJCX07CgoJCS8vIFNldCB0cmFkaXRpb25hbCB0byB0cnVlIGZvciBqUXVlcnkgPD0gMS4zLjIgYmVoYXZpb3IuCgkJaWYgKCB0cmFkaXRpb25hbCA9PT0gdW5kZWZpbmVkICkgewoJCQl0cmFkaXRpb25hbCA9IGpRdWVyeS5hamF4U2V0dGluZ3MgJiYgalF1ZXJ5LmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbDsKCQl9CgoJCS8vIElmIGFuIGFycmF5IHdhcyBwYXNzZWQgaW4sIGFzc3VtZSB0aGF0IGl0IGlzIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMuCgkJaWYgKCBqUXVlcnkuaXNBcnJheSggYSApIHx8ICggYS5qcXVlcnkgJiYgIWpRdWVyeS5pc1BsYWluT2JqZWN0KCBhICkgKSApIHsKCgkJCS8vIFNlcmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50cwoJCQlqUXVlcnkuZWFjaCggYSwgZnVuY3Rpb24oKSB7CgkJCQlhZGQoIHRoaXMubmFtZSwgdGhpcy52YWx1ZSApOwoJCQl9ICk7CgoJCX0gZWxzZSB7CgoJCQkvLyBJZiB0cmFkaXRpb25hbCwgZW5jb2RlIHRoZSAib2xkIiB3YXkgKHRoZSB3YXkgMS4zLjIgb3Igb2xkZXIKCQkJLy8gZGlkIGl0KSwgb3RoZXJ3aXNlIGVuY29kZSBwYXJhbXMgcmVjdXJzaXZlbHkuCgkJCWZvciAoIHByZWZpeCBpbiBhICkgewoJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCwgYVsgcHJlZml4IF0sIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQkJfQoJCX0KCgkJLy8gUmV0dXJuIHRoZSByZXN1bHRpbmcgc2VyaWFsaXphdGlvbgoJCXJldHVybiBzLmpvaW4oICImIiApLnJlcGxhY2UoIHIyMCwgIisiICk7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlzZXJpYWxpemU6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4galF1ZXJ5LnBhcmFtKCB0aGlzLnNlcmlhbGl6ZUFycmF5KCkgKTsKCQl9LAoJCXNlcmlhbGl6ZUFycmF5OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMubWFwKCBmdW5jdGlvbigpIHsKCgkJCQkvLyBDYW4gYWRkIHByb3BIb29rIGZvciAiZWxlbWVudHMiIHRvIGZpbHRlciBvciBhZGQgZm9ybSBlbGVtZW50cwoJCQkJdmFyIGVsZW1lbnRzID0galF1ZXJ5LnByb3AoIHRoaXMsICJlbGVtZW50cyIgKTsKCQkJCXJldHVybiBlbGVtZW50cyA/IGpRdWVyeS5tYWtlQXJyYXkoIGVsZW1lbnRzICkgOiB0aGlzOwoJCQl9ICkKCQkJLmZpbHRlciggZnVuY3Rpb24oKSB7CgkJCQl2YXIgdHlwZSA9IHRoaXMudHlwZTsKCgkJCQkvLyBVc2UgLmlzKCI6ZGlzYWJsZWQiKSBzbyB0aGF0IGZpZWxkc2V0W2Rpc2FibGVkXSB3b3JrcwoJCQkJcmV0dXJuIHRoaXMubmFtZSAmJiAhalF1ZXJ5KCB0aGlzICkuaXMoICI6ZGlzYWJsZWQiICkgJiYKCQkJCQlyc3VibWl0dGFibGUudGVzdCggdGhpcy5ub2RlTmFtZSApICYmICFyc3VibWl0dGVyVHlwZXMudGVzdCggdHlwZSApICYmCgkJCQkJKCB0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QoIHR5cGUgKSApOwoJCQl9ICkKCQkJLm1hcCggZnVuY3Rpb24oIGksIGVsZW0gKSB7CgkJCQl2YXIgdmFsID0galF1ZXJ5KCB0aGlzICkudmFsKCk7CgoJCQkJcmV0dXJuIHZhbCA9PSBudWxsID8KCQkJCQludWxsIDoKCQkJCQlqUXVlcnkuaXNBcnJheSggdmFsICkgPwoJCQkJCQlqUXVlcnkubWFwKCB2YWwsIGZ1bmN0aW9uKCB2YWwgKSB7CgkJCQkJCQlyZXR1cm4geyBuYW1lOiBlbGVtLm5hbWUsIHZhbHVlOiB2YWwucmVwbGFjZSggckNSTEYsICJcclxuIiApIH07CgkJCQkJCX0gKSA6CgkJCQkJCXsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCAiXHJcbiIgKSB9OwoJCQl9ICkuZ2V0KCk7CgkJfQoJfSApOwoKCgkvLyBDcmVhdGUgdGhlIHJlcXVlc3Qgb2JqZWN0CgkvLyAoVGhpcyBpcyBzdGlsbCBhdHRhY2hlZCB0byBhamF4U2V0dGluZ3MgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpCglqUXVlcnkuYWpheFNldHRpbmdzLnhociA9IHdpbmRvdy5BY3RpdmVYT2JqZWN0ICE9PSB1bmRlZmluZWQgPwoKCQkvLyBTdXBwb3J0OiBJRTYtSUU4CgkJZnVuY3Rpb24oKSB7CgoJCQkvLyBYSFIgY2Fubm90IGFjY2VzcyBsb2NhbCBmaWxlcywgYWx3YXlzIHVzZSBBY3RpdmVYIGZvciB0aGF0IGNhc2UKCQkJaWYgKCB0aGlzLmlzTG9jYWwgKSB7CgkJCQlyZXR1cm4gY3JlYXRlQWN0aXZlWEhSKCk7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFIDktMTEKCQkJLy8gSUUgc2VlbXMgdG8gZXJyb3Igb24gY3Jvc3MtZG9tYWluIFBBVENIIHJlcXVlc3RzIHdoZW4gQWN0aXZlWCBYSFIKCQkJLy8gaXMgdXNlZC4gSW4gSUUgOSsgYWx3YXlzIHVzZSB0aGUgbmF0aXZlIFhIUi4KCQkJLy8gTm90ZTogdGhpcyBjb25kaXRpb24gd29uJ3QgY2F0Y2ggRWRnZSBhcyBpdCBkb2Vzbid0IGRlZmluZQoJCQkvLyBkb2N1bWVudC5kb2N1bWVudE1vZGUgYnV0IGl0IGFsc28gZG9lc24ndCBzdXBwb3J0IEFjdGl2ZVggc28gaXQgd29uJ3QKCQkJLy8gcmVhY2ggdGhpcyBjb2RlLgoJCQlpZiAoIGRvY3VtZW50LmRvY3VtZW50TW9kZSA+IDggKSB7CgkJCQlyZXR1cm4gY3JlYXRlU3RhbmRhcmRYSFIoKTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBvbGRJRSBYSFIgZG9lcyBub3Qgc3VwcG9ydCBub24tUkZDMjYxNiBtZXRob2RzICgjMTMyNDApCgkJCS8vIFNlZSBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvbXM1MzY2NDgodj12cy44NSkuYXNweAoJCQkvLyBhbmQgaHR0cDovL3d3dy53My5vcmcvUHJvdG9jb2xzL3JmYzI2MTYvcmZjMjYxNi1zZWM5Lmh0bWwjc2VjOQoJCQkvLyBBbHRob3VnaCB0aGlzIGNoZWNrIGZvciBzaXggbWV0aG9kcyBpbnN0ZWFkIG9mIGVpZ2h0CgkJCS8vIHNpbmNlIElFIGFsc28gZG9lcyBub3Qgc3VwcG9ydCAidHJhY2UiIGFuZCAiY29ubmVjdCIKCQkJcmV0dXJuIC9eKGdldHxwb3N0fGhlYWR8cHV0fGRlbGV0ZXxvcHRpb25zKSQvaS50ZXN0KCB0aGlzLnR5cGUgKSAmJgoJCQkJY3JlYXRlU3RhbmRhcmRYSFIoKSB8fCBjcmVhdGVBY3RpdmVYSFIoKTsKCQl9IDoKCgkJLy8gRm9yIGFsbCBvdGhlciBicm93c2VycywgdXNlIHRoZSBzdGFuZGFyZCBYTUxIdHRwUmVxdWVzdCBvYmplY3QKCQljcmVhdGVTdGFuZGFyZFhIUjsKCgl2YXIgeGhySWQgPSAwLAoJCXhockNhbGxiYWNrcyA9IHt9LAoJCXhoclN1cHBvcnRlZCA9IGpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCk7CgoJLy8gU3VwcG9ydDogSUU8MTAKCS8vIE9wZW4gcmVxdWVzdHMgbXVzdCBiZSBtYW51YWxseSBhYm9ydGVkIG9uIHVubG9hZCAoIzUyODApCgkvLyBTZWUgaHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20va2IvMjg1Njc0NiBmb3IgbW9yZSBpbmZvCglpZiAoIHdpbmRvdy5hdHRhY2hFdmVudCApIHsKCQl3aW5kb3cuYXR0YWNoRXZlbnQoICJvbnVubG9hZCIsIGZ1bmN0aW9uKCkgewoJCQlmb3IgKCB2YXIga2V5IGluIHhockNhbGxiYWNrcyApIHsKCQkJCXhockNhbGxiYWNrc1sga2V5IF0oIHVuZGVmaW5lZCwgdHJ1ZSApOwoJCQl9CgkJfSApOwoJfQoKCS8vIERldGVybWluZSBzdXBwb3J0IHByb3BlcnRpZXMKCXN1cHBvcnQuY29ycyA9ICEheGhyU3VwcG9ydGVkICYmICggIndpdGhDcmVkZW50aWFscyIgaW4geGhyU3VwcG9ydGVkICk7Cgl4aHJTdXBwb3J0ZWQgPSBzdXBwb3J0LmFqYXggPSAhIXhoclN1cHBvcnRlZDsKCgkvLyBDcmVhdGUgdHJhbnNwb3J0IGlmIHRoZSBicm93c2VyIGNhbiBwcm92aWRlIGFuIHhocgoJaWYgKCB4aHJTdXBwb3J0ZWQgKSB7CgoJCWpRdWVyeS5hamF4VHJhbnNwb3J0KCBmdW5jdGlvbiggb3B0aW9ucyApIHsKCgkJCS8vIENyb3NzIGRvbWFpbiBvbmx5IGFsbG93ZWQgaWYgc3VwcG9ydGVkIHRocm91Z2ggWE1MSHR0cFJlcXVlc3QKCQkJaWYgKCAhb3B0aW9ucy5jcm9zc0RvbWFpbiB8fCBzdXBwb3J0LmNvcnMgKSB7CgoJCQkJdmFyIGNhbGxiYWNrOwoKCQkJCXJldHVybiB7CgkJCQkJc2VuZDogZnVuY3Rpb24oIGhlYWRlcnMsIGNvbXBsZXRlICkgewoJCQkJCQl2YXIgaSwKCQkJCQkJCXhociA9IG9wdGlvbnMueGhyKCksCgkJCQkJCQlpZCA9ICsreGhySWQ7CgoJCQkJCQkvLyBPcGVuIHRoZSBzb2NrZXQKCQkJCQkJeGhyLm9wZW4oCgkJCQkJCQlvcHRpb25zLnR5cGUsCgkJCQkJCQlvcHRpb25zLnVybCwKCQkJCQkJCW9wdGlvbnMuYXN5bmMsCgkJCQkJCQlvcHRpb25zLnVzZXJuYW1lLAoJCQkJCQkJb3B0aW9ucy5wYXNzd29yZAoJCQkJCQkpOwoKCQkJCQkJLy8gQXBwbHkgY3VzdG9tIGZpZWxkcyBpZiBwcm92aWRlZAoJCQkJCQlpZiAoIG9wdGlvbnMueGhyRmllbGRzICkgewoJCQkJCQkJZm9yICggaSBpbiBvcHRpb25zLnhockZpZWxkcyApIHsKCQkJCQkJCQl4aHJbIGkgXSA9IG9wdGlvbnMueGhyRmllbGRzWyBpIF07CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIE92ZXJyaWRlIG1pbWUgdHlwZSBpZiBuZWVkZWQKCQkJCQkJaWYgKCBvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlICkgewoJCQkJCQkJeGhyLm92ZXJyaWRlTWltZVR5cGUoIG9wdGlvbnMubWltZVR5cGUgKTsKCQkJCQkJfQoKCQkJCQkJLy8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXIKCQkJCQkJLy8gRm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cywgc2VlaW5nIGFzIGNvbmRpdGlvbnMgZm9yIGEgcHJlZmxpZ2h0IGFyZQoJCQkJCQkvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLgoJCQkJCQkvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cCkKCQkJCQkJLy8gRm9yIHNhbWUtZG9tYWluIHJlcXVlc3RzLCB3b24ndCBjaGFuZ2UgaGVhZGVyIGlmIGFscmVhZHkgcHJvdmlkZWQuCgkJCQkJCWlmICggIW9wdGlvbnMuY3Jvc3NEb21haW4gJiYgIWhlYWRlcnNbICJYLVJlcXVlc3RlZC1XaXRoIiBdICkgewoJCQkJCQkJaGVhZGVyc1sgIlgtUmVxdWVzdGVkLVdpdGgiIF0gPSAiWE1MSHR0cFJlcXVlc3QiOwoJCQkJCQl9CgoJCQkJCQkvLyBTZXQgaGVhZGVycwoJCQkJCQlmb3IgKCBpIGluIGhlYWRlcnMgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSUUncyBBY3RpdmVYT2JqZWN0IHRocm93cyBhICdUeXBlIE1pc21hdGNoJyBleGNlcHRpb24gd2hlbiBzZXR0aW5nCgkJCQkJCQkvLyByZXF1ZXN0IGhlYWRlciB0byBhIG51bGwtdmFsdWUuCgkJCQkJCQkvLwoJCQkJCQkJLy8gVG8ga2VlcCBjb25zaXN0ZW50IHdpdGggb3RoZXIgWEhSIGltcGxlbWVudGF0aW9ucywgY2FzdCB0aGUgdmFsdWUKCQkJCQkJCS8vIHRvIHN0cmluZyBhbmQgaWdub3JlIGB1bmRlZmluZWRgLgoJCQkJCQkJaWYgKCBoZWFkZXJzWyBpIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJCQl4aHIuc2V0UmVxdWVzdEhlYWRlciggaSwgaGVhZGVyc1sgaSBdICsgIiIgKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gRG8gc2VuZCB0aGUgcmVxdWVzdAoJCQkJCQkvLyBUaGlzIG1heSByYWlzZSBhbiBleGNlcHRpb24gd2hpY2ggaXMgYWN0dWFsbHkKCQkJCQkJLy8gaGFuZGxlZCBpbiBqUXVlcnkuYWpheCAoc28gbm8gdHJ5L2NhdGNoIGhlcmUpCgkJCQkJCXhoci5zZW5kKCAoIG9wdGlvbnMuaGFzQ29udGVudCAmJiBvcHRpb25zLmRhdGEgKSB8fCBudWxsICk7CgoJCQkJCQkvLyBMaXN0ZW5lcgoJCQkJCQljYWxsYmFjayA9IGZ1bmN0aW9uKCBfLCBpc0Fib3J0ICkgewoJCQkJCQkJdmFyIHN0YXR1cywgc3RhdHVzVGV4dCwgcmVzcG9uc2VzOwoKCQkJCQkJCS8vIFdhcyBuZXZlciBjYWxsZWQgYW5kIGlzIGFib3J0ZWQgb3IgY29tcGxldGUKCQkJCQkJCWlmICggY2FsbGJhY2sgJiYgKCBpc0Fib3J0IHx8IHhoci5yZWFkeVN0YXRlID09PSA0ICkgKSB7CgoJCQkJCQkJCS8vIENsZWFuIHVwCgkJCQkJCQkJZGVsZXRlIHhockNhbGxiYWNrc1sgaWQgXTsKCQkJCQkJCQljYWxsYmFjayA9IHVuZGVmaW5lZDsKCQkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0galF1ZXJ5Lm5vb3A7CgoJCQkJCQkJCS8vIEFib3J0IG1hbnVhbGx5IGlmIG5lZWRlZAoJCQkJCQkJCWlmICggaXNBYm9ydCApIHsKCQkJCQkJCQkJaWYgKCB4aHIucmVhZHlTdGF0ZSAhPT0gNCApIHsKCQkJCQkJCQkJCXhoci5hYm9ydCgpOwoJCQkJCQkJCQl9CgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJcmVzcG9uc2VzID0ge307CgkJCQkJCQkJCXN0YXR1cyA9IHhoci5zdGF0dXM7CgoJCQkJCQkJCQkvLyBTdXBwb3J0OiBJRTwxMAoJCQkJCQkJCQkvLyBBY2Nlc3NpbmcgYmluYXJ5LWRhdGEgcmVzcG9uc2VUZXh0IHRocm93cyBhbiBleGNlcHRpb24KCQkJCQkJCQkJLy8gKCMxMTQyNikKCQkJCQkJCQkJaWYgKCB0eXBlb2YgeGhyLnJlc3BvbnNlVGV4dCA9PT0gInN0cmluZyIgKSB7CgkJCQkJCQkJCQlyZXNwb25zZXMudGV4dCA9IHhoci5yZXNwb25zZVRleHQ7CgkJCQkJCQkJCX0KCgkJCQkJCQkJCS8vIEZpcmVmb3ggdGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZwoJCQkJCQkJCQkvLyBzdGF0dXNUZXh0IGZvciBmYXVsdHkgY3Jvc3MtZG9tYWluIHJlcXVlc3RzCgkJCQkJCQkJCXRyeSB7CgkJCQkJCQkJCQlzdGF0dXNUZXh0ID0geGhyLnN0YXR1c1RleHQ7CgkJCQkJCQkJCX0gY2F0Y2ggKCBlICkgewoKCQkJCQkJCQkJCS8vIFdlIG5vcm1hbGl6ZSB3aXRoIFdlYmtpdCBnaXZpbmcgYW4gZW1wdHkgc3RhdHVzVGV4dAoJCQkJCQkJCQkJc3RhdHVzVGV4dCA9ICIiOwoJCQkJCQkJCQl9CgoJCQkJCQkJCQkvLyBGaWx0ZXIgc3RhdHVzIGZvciBub24gc3RhbmRhcmQgYmVoYXZpb3JzCgoJCQkJCQkJCQkvLyBJZiB0aGUgcmVxdWVzdCBpcyBsb2NhbCBhbmQgd2UgaGF2ZSBkYXRhOiBhc3N1bWUgYSBzdWNjZXNzCgkJCQkJCQkJCS8vIChzdWNjZXNzIHdpdGggbm8gZGF0YSB3b24ndCBnZXQgbm90aWZpZWQsIHRoYXQncyB0aGUgYmVzdCB3ZQoJCQkJCQkJCQkvLyBjYW4gZG8gZ2l2ZW4gY3VycmVudCBpbXBsZW1lbnRhdGlvbnMpCgkJCQkJCQkJCWlmICggIXN0YXR1cyAmJiBvcHRpb25zLmlzTG9jYWwgJiYgIW9wdGlvbnMuY3Jvc3NEb21haW4gKSB7CgkJCQkJCQkJCQlzdGF0dXMgPSByZXNwb25zZXMudGV4dCA/IDIwMCA6IDQwNDsKCgkJCQkJCQkJCS8vIElFIC0gIzE0NTA6IHNvbWV0aW1lcyByZXR1cm5zIDEyMjMgd2hlbiBpdCBzaG91bGQgYmUgMjA0CgkJCQkJCQkJCX0gZWxzZSBpZiAoIHN0YXR1cyA9PT0gMTIyMyApIHsKCQkJCQkJCQkJCXN0YXR1cyA9IDIwNDsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQkvLyBDYWxsIGNvbXBsZXRlIGlmIG5lZWRlZAoJCQkJCQkJaWYgKCByZXNwb25zZXMgKSB7CgkJCQkJCQkJY29tcGxldGUoIHN0YXR1cywgc3RhdHVzVGV4dCwgcmVzcG9uc2VzLCB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgKTsKCQkJCQkJCX0KCQkJCQkJfTsKCgkJCQkJCS8vIERvIHNlbmQgdGhlIHJlcXVlc3QKCQkJCQkJLy8gYHhoci5zZW5kYCBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uLCBidXQgaXQgd2lsbCBiZQoJCQkJCQkvLyBoYW5kbGVkIGluIGpRdWVyeS5hamF4IChzbyBubyB0cnkvY2F0Y2ggaGVyZSkKCQkJCQkJaWYgKCAhb3B0aW9ucy5hc3luYyApIHsKCgkJCQkJCQkvLyBJZiB3ZSdyZSBpbiBzeW5jIG1vZGUgd2UgZmlyZSB0aGUgY2FsbGJhY2sKCQkJCQkJCWNhbGxiYWNrKCk7CgkJCQkJCX0gZWxzZSBpZiAoIHhoci5yZWFkeVN0YXRlID09PSA0ICkgewoKCQkJCQkJCS8vIChJRTYgJiBJRTcpIGlmIGl0J3MgaW4gY2FjaGUgYW5kIGhhcyBiZWVuCgkJCQkJCQkvLyByZXRyaWV2ZWQgZGlyZWN0bHkgd2UgbmVlZCB0byBmaXJlIHRoZSBjYWxsYmFjawoJCQkJCQkJd2luZG93LnNldFRpbWVvdXQoIGNhbGxiYWNrICk7CgkJCQkJCX0gZWxzZSB7CgoJCQkJCQkJLy8gUmVnaXN0ZXIgdGhlIGNhbGxiYWNrLCBidXQgZGVsYXkgaXQgaW4gY2FzZSBgeGhyLnNlbmRgIHRocm93cwoJCQkJCQkJLy8gQWRkIHRvIHRoZSBsaXN0IG9mIGFjdGl2ZSB4aHIgY2FsbGJhY2tzCgkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0geGhyQ2FsbGJhY2tzWyBpZCBdID0gY2FsbGJhY2s7CgkJCQkJCX0KCQkJCQl9LAoKCQkJCQlhYm9ydDogZnVuY3Rpb24oKSB7CgkJCQkJCWlmICggY2FsbGJhY2sgKSB7CgkJCQkJCQljYWxsYmFjayggdW5kZWZpbmVkLCB0cnVlICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9OwoJCQl9CgkJfSApOwoJfQoKCS8vIEZ1bmN0aW9ucyB0byBjcmVhdGUgeGhycwoJZnVuY3Rpb24gY3JlYXRlU3RhbmRhcmRYSFIoKSB7CgkJdHJ5IHsKCQkJcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKCQl9IGNhdGNoICggZSApIHt9Cgl9CgoJZnVuY3Rpb24gY3JlYXRlQWN0aXZlWEhSKCkgewoJCXRyeSB7CgkJCXJldHVybiBuZXcgd2luZG93LkFjdGl2ZVhPYmplY3QoICJNaWNyb3NvZnQuWE1MSFRUUCIgKTsKCQl9IGNhdGNoICggZSApIHt9Cgl9CgoKCgoJLy8gUHJldmVudCBhdXRvLWV4ZWN1dGlvbiBvZiBzY3JpcHRzIHdoZW4gbm8gZXhwbGljaXQgZGF0YVR5cGUgd2FzIHByb3ZpZGVkIChTZWUgZ2gtMjQzMikKCWpRdWVyeS5hamF4UHJlZmlsdGVyKCBmdW5jdGlvbiggcyApIHsKCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgkJCXMuY29udGVudHMuc2NyaXB0ID0gZmFsc2U7CgkJfQoJfSApOwoKCS8vIEluc3RhbGwgc2NyaXB0IGRhdGFUeXBlCglqUXVlcnkuYWpheFNldHVwKCB7CgkJYWNjZXB0czogewoJCQlzY3JpcHQ6ICJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsICIgKwoJCQkJImFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCIKCQl9LAoJCWNvbnRlbnRzOiB7CgkJCXNjcmlwdDogL1xiKD86amF2YXxlY21hKXNjcmlwdFxiLwoJCX0sCgkJY29udmVydGVyczogewoJCQkidGV4dCBzY3JpcHQiOiBmdW5jdGlvbiggdGV4dCApIHsKCQkJCWpRdWVyeS5nbG9iYWxFdmFsKCB0ZXh0ICk7CgkJCQlyZXR1cm4gdGV4dDsKCQkJfQoJCX0KCX0gKTsKCgkvLyBIYW5kbGUgY2FjaGUncyBzcGVjaWFsIGNhc2UgYW5kIGdsb2JhbAoJalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoICJzY3JpcHQiLCBmdW5jdGlvbiggcyApIHsKCQlpZiAoIHMuY2FjaGUgPT09IHVuZGVmaW5lZCApIHsKCQkJcy5jYWNoZSA9IGZhbHNlOwoJCX0KCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgkJCXMudHlwZSA9ICJHRVQiOwoJCQlzLmdsb2JhbCA9IGZhbHNlOwoJCX0KCX0gKTsKCgkvLyBCaW5kIHNjcmlwdCB0YWcgaGFjayB0cmFuc3BvcnQKCWpRdWVyeS5hamF4VHJhbnNwb3J0KCAic2NyaXB0IiwgZnVuY3Rpb24oIHMgKSB7CgoJCS8vIFRoaXMgdHJhbnNwb3J0IG9ubHkgZGVhbHMgd2l0aCBjcm9zcyBkb21haW4gcmVxdWVzdHMKCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgoJCQl2YXIgc2NyaXB0LAoJCQkJaGVhZCA9IGRvY3VtZW50LmhlYWQgfHwgalF1ZXJ5KCAiaGVhZCIgKVsgMCBdIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgkJCXJldHVybiB7CgoJCQkJc2VuZDogZnVuY3Rpb24oIF8sIGNhbGxiYWNrICkgewoKCQkJCQlzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAic2NyaXB0IiApOwoKCQkJCQlzY3JpcHQuYXN5bmMgPSB0cnVlOwoKCQkJCQlpZiAoIHMuc2NyaXB0Q2hhcnNldCApIHsKCQkJCQkJc2NyaXB0LmNoYXJzZXQgPSBzLnNjcmlwdENoYXJzZXQ7CgkJCQkJfQoKCQkJCQlzY3JpcHQuc3JjID0gcy51cmw7CgoJCQkJCS8vIEF0dGFjaCBoYW5kbGVycyBmb3IgYWxsIGJyb3dzZXJzCgkJCQkJc2NyaXB0Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiggXywgaXNBYm9ydCApIHsKCgkJCQkJCWlmICggaXNBYm9ydCB8fCAhc2NyaXB0LnJlYWR5U3RhdGUgfHwgL2xvYWRlZHxjb21wbGV0ZS8udGVzdCggc2NyaXB0LnJlYWR5U3RhdGUgKSApIHsKCgkJCQkJCQkvLyBIYW5kbGUgbWVtb3J5IGxlYWsgaW4gSUUKCQkJCQkJCXNjcmlwdC5vbmxvYWQgPSBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsKCgkJCQkJCQkvLyBSZW1vdmUgdGhlIHNjcmlwdAoJCQkJCQkJaWYgKCBzY3JpcHQucGFyZW50Tm9kZSApIHsKCQkJCQkJCQlzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggc2NyaXB0ICk7CgkJCQkJCQl9CgoJCQkJCQkJLy8gRGVyZWZlcmVuY2UgdGhlIHNjcmlwdAoJCQkJCQkJc2NyaXB0ID0gbnVsbDsKCgkJCQkJCQkvLyBDYWxsYmFjayBpZiBub3QgYWJvcnQKCQkJCQkJCWlmICggIWlzQWJvcnQgKSB7CgkJCQkJCQkJY2FsbGJhY2soIDIwMCwgInN1Y2Nlc3MiICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9OwoKCQkJCQkvLyBDaXJjdW12ZW50IElFNiBidWdzIHdpdGggYmFzZSBlbGVtZW50cyAoIzI3MDkgYW5kICM0Mzc4KSBieSBwcmVwZW5kaW5nCgkJCQkJLy8gVXNlIG5hdGl2ZSBET00gbWFuaXB1bGF0aW9uIHRvIGF2b2lkIG91ciBkb21NYW5pcCBBSkFYIHRyaWNrZXJ5CgkJCQkJaGVhZC5pbnNlcnRCZWZvcmUoIHNjcmlwdCwgaGVhZC5maXJzdENoaWxkICk7CgkJCQl9LAoKCQkJCWFib3J0OiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIHNjcmlwdCApIHsKCQkJCQkJc2NyaXB0Lm9ubG9hZCggdW5kZWZpbmVkLCB0cnVlICk7CgkJCQkJfQoJCQkJfQoJCQl9OwoJCX0KCX0gKTsKCgoKCgl2YXIgb2xkQ2FsbGJhY2tzID0gW10sCgkJcmpzb25wID0gLyg9KVw/KD89JnwkKXxcP1w/LzsKCgkvLyBEZWZhdWx0IGpzb25wIHNldHRpbmdzCglqUXVlcnkuYWpheFNldHVwKCB7CgkJanNvbnA6ICJjYWxsYmFjayIsCgkJanNvbnBDYWxsYmFjazogZnVuY3Rpb24oKSB7CgkJCXZhciBjYWxsYmFjayA9IG9sZENhbGxiYWNrcy5wb3AoKSB8fCAoIGpRdWVyeS5leHBhbmRvICsgIl8iICsgKCBub25jZSsrICkgKTsKCQkJdGhpc1sgY2FsbGJhY2sgXSA9IHRydWU7CgkJCXJldHVybiBjYWxsYmFjazsKCQl9Cgl9ICk7CgoJLy8gRGV0ZWN0LCBub3JtYWxpemUgb3B0aW9ucyBhbmQgaW5zdGFsbCBjYWxsYmFja3MgZm9yIGpzb25wIHJlcXVlc3RzCglqUXVlcnkuYWpheFByZWZpbHRlciggImpzb24ganNvbnAiLCBmdW5jdGlvbiggcywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIgKSB7CgoJCXZhciBjYWxsYmFja05hbWUsIG92ZXJ3cml0dGVuLCByZXNwb25zZUNvbnRhaW5lciwKCQkJanNvblByb3AgPSBzLmpzb25wICE9PSBmYWxzZSAmJiAoIHJqc29ucC50ZXN0KCBzLnVybCApID8KCQkJCSJ1cmwiIDoKCQkJCXR5cGVvZiBzLmRhdGEgPT09ICJzdHJpbmciICYmCgkJCQkJKCBzLmNvbnRlbnRUeXBlIHx8ICIiICkKCQkJCQkJLmluZGV4T2YoICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiICkgPT09IDAgJiYKCQkJCQlyanNvbnAudGVzdCggcy5kYXRhICkgJiYgImRhdGEiCgkJCSk7CgoJCS8vIEhhbmRsZSBpZmYgdGhlIGV4cGVjdGVkIGRhdGEgdHlwZSBpcyAianNvbnAiIG9yIHdlIGhhdmUgYSBwYXJhbWV0ZXIgdG8gc2V0CgkJaWYgKCBqc29uUHJvcCB8fCBzLmRhdGFUeXBlc1sgMCBdID09PSAianNvbnAiICkgewoKCQkJLy8gR2V0IGNhbGxiYWNrIG5hbWUsIHJlbWVtYmVyaW5nIHByZWV4aXN0aW5nIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBpdAoJCQljYWxsYmFja05hbWUgPSBzLmpzb25wQ2FsbGJhY2sgPSBqUXVlcnkuaXNGdW5jdGlvbiggcy5qc29ucENhbGxiYWNrICkgPwoJCQkJcy5qc29ucENhbGxiYWNrKCkgOgoJCQkJcy5qc29ucENhbGxiYWNrOwoKCQkJLy8gSW5zZXJ0IGNhbGxiYWNrIGludG8gdXJsIG9yIGZvcm0gZGF0YQoJCQlpZiAoIGpzb25Qcm9wICkgewoJCQkJc1sganNvblByb3AgXSA9IHNbIGpzb25Qcm9wIF0ucmVwbGFjZSggcmpzb25wLCAiJDEiICsgY2FsbGJhY2tOYW1lICk7CgkJCX0gZWxzZSBpZiAoIHMuanNvbnAgIT09IGZhbHNlICkgewoJCQkJcy51cmwgKz0gKCBycXVlcnkudGVzdCggcy51cmwgKSA/ICImIiA6ICI/IiApICsgcy5qc29ucCArICI9IiArIGNhbGxiYWNrTmFtZTsKCQkJfQoKCQkJLy8gVXNlIGRhdGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1dGlvbgoJCQlzLmNvbnZlcnRlcnNbICJzY3JpcHQganNvbiIgXSA9IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCAhcmVzcG9uc2VDb250YWluZXIgKSB7CgkJCQkJalF1ZXJ5LmVycm9yKCBjYWxsYmFja05hbWUgKyAiIHdhcyBub3QgY2FsbGVkIiApOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07CgkJCX07CgoJCQkvLyBmb3JjZSBqc29uIGRhdGFUeXBlCgkJCXMuZGF0YVR5cGVzWyAwIF0gPSAianNvbiI7CgoJCQkvLyBJbnN0YWxsIGNhbGxiYWNrCgkJCW92ZXJ3cml0dGVuID0gd2luZG93WyBjYWxsYmFja05hbWUgXTsKCQkJd2luZG93WyBjYWxsYmFja05hbWUgXSA9IGZ1bmN0aW9uKCkgewoJCQkJcmVzcG9uc2VDb250YWluZXIgPSBhcmd1bWVudHM7CgkJCX07CgoJCQkvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycykKCQkJanFYSFIuYWx3YXlzKCBmdW5jdGlvbigpIHsKCgkJCQkvLyBJZiBwcmV2aW91cyB2YWx1ZSBkaWRuJ3QgZXhpc3QgLSByZW1vdmUgaXQKCQkJCWlmICggb3ZlcndyaXR0ZW4gPT09IHVuZGVmaW5lZCApIHsKCQkJCQlqUXVlcnkoIHdpbmRvdyApLnJlbW92ZVByb3AoIGNhbGxiYWNrTmFtZSApOwoKCQkJCS8vIE90aGVyd2lzZSByZXN0b3JlIHByZWV4aXN0aW5nIHZhbHVlCgkJCQl9IGVsc2UgewoJCQkJCXdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBvdmVyd3JpdHRlbjsKCQkJCX0KCgkJCQkvLyBTYXZlIGJhY2sgYXMgZnJlZQoJCQkJaWYgKCBzWyBjYWxsYmFja05hbWUgXSApIHsKCgkJCQkJLy8gbWFrZSBzdXJlIHRoYXQgcmUtdXNpbmcgdGhlIG9wdGlvbnMgZG9lc24ndCBzY3JldyB0aGluZ3MgYXJvdW5kCgkJCQkJcy5qc29ucENhbGxiYWNrID0gb3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrOwoKCQkJCQkvLyBzYXZlIHRoZSBjYWxsYmFjayBuYW1lIGZvciBmdXR1cmUgdXNlCgkJCQkJb2xkQ2FsbGJhY2tzLnB1c2goIGNhbGxiYWNrTmFtZSApOwoJCQkJfQoKCQkJCS8vIENhbGwgaWYgaXQgd2FzIGEgZnVuY3Rpb24gYW5kIHdlIGhhdmUgYSByZXNwb25zZQoJCQkJaWYgKCByZXNwb25zZUNvbnRhaW5lciAmJiBqUXVlcnkuaXNGdW5jdGlvbiggb3ZlcndyaXR0ZW4gKSApIHsKCQkJCQlvdmVyd3JpdHRlbiggcmVzcG9uc2VDb250YWluZXJbIDAgXSApOwoJCQkJfQoKCQkJCXJlc3BvbnNlQ29udGFpbmVyID0gb3ZlcndyaXR0ZW4gPSB1bmRlZmluZWQ7CgkJCX0gKTsKCgkJCS8vIERlbGVnYXRlIHRvIHNjcmlwdAoJCQlyZXR1cm4gInNjcmlwdCI7CgkJfQoJfSApOwoKCgoKCS8vIFN1cHBvcnQ6IFNhZmFyaSA4KwoJLy8gSW4gU2FmYXJpIDggZG9jdW1lbnRzIGNyZWF0ZWQgdmlhIGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudAoJLy8gY29sbGFwc2Ugc2libGluZyBmb3JtczogdGhlIHNlY29uZCBvbmUgYmVjb21lcyBhIGNoaWxkIG9mIHRoZSBmaXJzdCBvbmUuCgkvLyBCZWNhdXNlIG9mIHRoYXQsIHRoaXMgc2VjdXJpdHkgbWVhc3VyZSBoYXMgdG8gYmUgZGlzYWJsZWQgaW4gU2FmYXJpIDguCgkvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM3MzM3CglzdXBwb3J0LmNyZWF0ZUhUTUxEb2N1bWVudCA9ICggZnVuY3Rpb24oKSB7CgkJaWYgKCAhZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50ICkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCXZhciBkb2MgPSBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoICIiICk7CgkJZG9jLmJvZHkuaW5uZXJIVE1MID0gIjxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IjsKCQlyZXR1cm4gZG9jLmJvZHkuY2hpbGROb2Rlcy5sZW5ndGggPT09IDI7Cgl9ICkoKTsKCgoJLy8gZGF0YTogc3RyaW5nIG9mIGh0bWwKCS8vIGNvbnRleHQgKG9wdGlvbmFsKTogSWYgc3BlY2lmaWVkLCB0aGUgZnJhZ21lbnQgd2lsbCBiZSBjcmVhdGVkIGluIHRoaXMgY29udGV4dCwKCS8vIGRlZmF1bHRzIHRvIGRvY3VtZW50CgkvLyBrZWVwU2NyaXB0cyAob3B0aW9uYWwpOiBJZiB0cnVlLCB3aWxsIGluY2x1ZGUgc2NyaXB0cyBwYXNzZWQgaW4gdGhlIGh0bWwgc3RyaW5nCglqUXVlcnkucGFyc2VIVE1MID0gZnVuY3Rpb24oIGRhdGEsIGNvbnRleHQsIGtlZXBTY3JpcHRzICkgewoJCWlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09ICJzdHJpbmciICkgewoJCQlyZXR1cm4gbnVsbDsKCQl9CgkJaWYgKCB0eXBlb2YgY29udGV4dCA9PT0gImJvb2xlYW4iICkgewoJCQlrZWVwU2NyaXB0cyA9IGNvbnRleHQ7CgkJCWNvbnRleHQgPSBmYWxzZTsKCQl9CgoJCS8vIGRvY3VtZW50LmltcGxlbWVudGF0aW9uIHN0b3BzIHNjcmlwdHMgb3IgaW5saW5lIGV2ZW50IGhhbmRsZXJzIGZyb20KCQkvLyBiZWluZyBleGVjdXRlZCBpbW1lZGlhdGVseQoJCWNvbnRleHQgPSBjb250ZXh0IHx8ICggc3VwcG9ydC5jcmVhdGVIVE1MRG9jdW1lbnQgPwoJCQlkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoICIiICkgOgoJCQlkb2N1bWVudCApOwoKCQl2YXIgcGFyc2VkID0gcnNpbmdsZVRhZy5leGVjKCBkYXRhICksCgkJCXNjcmlwdHMgPSAha2VlcFNjcmlwdHMgJiYgW107CgoJCS8vIFNpbmdsZSB0YWcKCQlpZiAoIHBhcnNlZCApIHsKCQkJcmV0dXJuIFsgY29udGV4dC5jcmVhdGVFbGVtZW50KCBwYXJzZWRbIDEgXSApIF07CgkJfQoKCQlwYXJzZWQgPSBidWlsZEZyYWdtZW50KCBbIGRhdGEgXSwgY29udGV4dCwgc2NyaXB0cyApOwoKCQlpZiAoIHNjcmlwdHMgJiYgc2NyaXB0cy5sZW5ndGggKSB7CgkJCWpRdWVyeSggc2NyaXB0cyApLnJlbW92ZSgpOwoJCX0KCgkJcmV0dXJuIGpRdWVyeS5tZXJnZSggW10sIHBhcnNlZC5jaGlsZE5vZGVzICk7Cgl9OwoKCgkvLyBLZWVwIGEgY29weSBvZiB0aGUgb2xkIGxvYWQgbWV0aG9kCgl2YXIgX2xvYWQgPSBqUXVlcnkuZm4ubG9hZDsKCgkvKioKCSAqIExvYWQgYSB1cmwgaW50byBhIHBhZ2UKCSAqLwoJalF1ZXJ5LmZuLmxvYWQgPSBmdW5jdGlvbiggdXJsLCBwYXJhbXMsIGNhbGxiYWNrICkgewoJCWlmICggdHlwZW9mIHVybCAhPT0gInN0cmluZyIgJiYgX2xvYWQgKSB7CgkJCXJldHVybiBfbG9hZC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJfQoKCQl2YXIgc2VsZWN0b3IsIHR5cGUsIHJlc3BvbnNlLAoJCQlzZWxmID0gdGhpcywKCQkJb2ZmID0gdXJsLmluZGV4T2YoICIgIiApOwoKCQlpZiAoIG9mZiA+IC0xICkgewoJCQlzZWxlY3RvciA9IGpRdWVyeS50cmltKCB1cmwuc2xpY2UoIG9mZiwgdXJsLmxlbmd0aCApICk7CgkJCXVybCA9IHVybC5zbGljZSggMCwgb2ZmICk7CgkJfQoKCQkvLyBJZiBpdCdzIGEgZnVuY3Rpb24KCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwYXJhbXMgKSApIHsKCgkJCS8vIFdlIGFzc3VtZSB0aGF0IGl0J3MgdGhlIGNhbGxiYWNrCgkJCWNhbGxiYWNrID0gcGFyYW1zOwoJCQlwYXJhbXMgPSB1bmRlZmluZWQ7CgoJCS8vIE90aGVyd2lzZSwgYnVpbGQgYSBwYXJhbSBzdHJpbmcKCQl9IGVsc2UgaWYgKCBwYXJhbXMgJiYgdHlwZW9mIHBhcmFtcyA9PT0gIm9iamVjdCIgKSB7CgkJCXR5cGUgPSAiUE9TVCI7CgkJfQoKCQkvLyBJZiB3ZSBoYXZlIGVsZW1lbnRzIHRvIG1vZGlmeSwgbWFrZSB0aGUgcmVxdWVzdAoJCWlmICggc2VsZi5sZW5ndGggPiAwICkgewoJCQlqUXVlcnkuYWpheCggewoJCQkJdXJsOiB1cmwsCgoJCQkJLy8gSWYgInR5cGUiIHZhcmlhYmxlIGlzIHVuZGVmaW5lZCwgdGhlbiAiR0VUIiBtZXRob2Qgd2lsbCBiZSB1c2VkLgoJCQkJLy8gTWFrZSB2YWx1ZSBvZiB0aGlzIGZpZWxkIGV4cGxpY2l0IHNpbmNlCgkJCQkvLyB1c2VyIGNhbiBvdmVycmlkZSBpdCB0aHJvdWdoIGFqYXhTZXR1cCBtZXRob2QKCQkJCXR5cGU6IHR5cGUgfHwgIkdFVCIsCgkJCQlkYXRhVHlwZTogImh0bWwiLAoJCQkJZGF0YTogcGFyYW1zCgkJCX0gKS5kb25lKCBmdW5jdGlvbiggcmVzcG9uc2VUZXh0ICkgewoKCQkJCS8vIFNhdmUgcmVzcG9uc2UgZm9yIHVzZSBpbiBjb21wbGV0ZSBjYWxsYmFjawoJCQkJcmVzcG9uc2UgPSBhcmd1bWVudHM7CgoJCQkJc2VsZi5odG1sKCBzZWxlY3RvciA/CgoJCQkJCS8vIElmIGEgc2VsZWN0b3Igd2FzIHNwZWNpZmllZCwgbG9jYXRlIHRoZSByaWdodCBlbGVtZW50cyBpbiBhIGR1bW15IGRpdgoJCQkJCS8vIEV4Y2x1ZGUgc2NyaXB0cyB0byBhdm9pZCBJRSAnUGVybWlzc2lvbiBEZW5pZWQnIGVycm9ycwoJCQkJCWpRdWVyeSggIjxkaXY+IiApLmFwcGVuZCggalF1ZXJ5LnBhcnNlSFRNTCggcmVzcG9uc2VUZXh0ICkgKS5maW5kKCBzZWxlY3RvciApIDoKCgkJCQkJLy8gT3RoZXJ3aXNlIHVzZSB0aGUgZnVsbCByZXN1bHQKCQkJCQlyZXNwb25zZVRleHQgKTsKCgkJCS8vIElmIHRoZSByZXF1ZXN0IHN1Y2NlZWRzLCB0aGlzIGZ1bmN0aW9uIGdldHMgImRhdGEiLCAic3RhdHVzIiwgImpxWEhSIgoJCQkvLyBidXQgdGhleSBhcmUgaWdub3JlZCBiZWNhdXNlIHJlc3BvbnNlIHdhcyBzZXQgYWJvdmUuCgkJCS8vIElmIGl0IGZhaWxzLCB0aGlzIGZ1bmN0aW9uIGdldHMgImpxWEhSIiwgInN0YXR1cyIsICJlcnJvciIKCQkJfSApLmFsd2F5cyggY2FsbGJhY2sgJiYgZnVuY3Rpb24oIGpxWEhSLCBzdGF0dXMgKSB7CgkJCQlzZWxmLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJCWNhbGxiYWNrLmFwcGx5KCBzZWxmLCByZXNwb25zZSB8fCBbIGpxWEhSLnJlc3BvbnNlVGV4dCwgc3RhdHVzLCBqcVhIUiBdICk7CgkJCQl9ICk7CgkJCX0gKTsKCQl9CgoJCXJldHVybiB0aGlzOwoJfTsKCgoKCgkvLyBBdHRhY2ggYSBidW5jaCBvZiBmdW5jdGlvbnMgZm9yIGhhbmRsaW5nIGNvbW1vbiBBSkFYIGV2ZW50cwoJalF1ZXJ5LmVhY2goIFsKCQkiYWpheFN0YXJ0IiwKCQkiYWpheFN0b3AiLAoJCSJhamF4Q29tcGxldGUiLAoJCSJhamF4RXJyb3IiLAoJCSJhamF4U3VjY2VzcyIsCgkJImFqYXhTZW5kIgoJXSwgZnVuY3Rpb24oIGksIHR5cGUgKSB7CgkJalF1ZXJ5LmZuWyB0eXBlIF0gPSBmdW5jdGlvbiggZm4gKSB7CgkJCXJldHVybiB0aGlzLm9uKCB0eXBlLCBmbiApOwoJCX07Cgl9ICk7CgoKCgoJalF1ZXJ5LmV4cHIuZmlsdGVycy5hbmltYXRlZCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnkuZ3JlcCggalF1ZXJ5LnRpbWVycywgZnVuY3Rpb24oIGZuICkgewoJCQlyZXR1cm4gZWxlbSA9PT0gZm4uZWxlbTsKCQl9ICkubGVuZ3RoOwoJfTsKCgoKCgoJLyoqCgkgKiBHZXRzIGEgd2luZG93IGZyb20gYW4gZWxlbWVudAoJICovCglmdW5jdGlvbiBnZXRXaW5kb3coIGVsZW0gKSB7CgkJcmV0dXJuIGpRdWVyeS5pc1dpbmRvdyggZWxlbSApID8KCQkJZWxlbSA6CgkJCWVsZW0ubm9kZVR5cGUgPT09IDkgPwoJCQkJZWxlbS5kZWZhdWx0VmlldyB8fCBlbGVtLnBhcmVudFdpbmRvdyA6CgkJCQlmYWxzZTsKCX0KCglqUXVlcnkub2Zmc2V0ID0gewoJCXNldE9mZnNldDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGkgKSB7CgkJCXZhciBjdXJQb3NpdGlvbiwgY3VyTGVmdCwgY3VyQ1NTVG9wLCBjdXJUb3AsIGN1ck9mZnNldCwgY3VyQ1NTTGVmdCwgY2FsY3VsYXRlUG9zaXRpb24sCgkJCQlwb3NpdGlvbiA9IGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSwKCQkJCWN1ckVsZW0gPSBqUXVlcnkoIGVsZW0gKSwKCQkJCXByb3BzID0ge307CgoJCQkvLyBzZXQgcG9zaXRpb24gZmlyc3QsIGluLWNhc2UgdG9wL2xlZnQgYXJlIHNldCBldmVuIG9uIHN0YXRpYyBlbGVtCgkJCWlmICggcG9zaXRpb24gPT09ICJzdGF0aWMiICkgewoJCQkJZWxlbS5zdHlsZS5wb3NpdGlvbiA9ICJyZWxhdGl2ZSI7CgkJCX0KCgkJCWN1ck9mZnNldCA9IGN1ckVsZW0ub2Zmc2V0KCk7CgkJCWN1ckNTU1RvcCA9IGpRdWVyeS5jc3MoIGVsZW0sICJ0b3AiICk7CgkJCWN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCAibGVmdCIgKTsKCQkJY2FsY3VsYXRlUG9zaXRpb24gPSAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09PSAiZml4ZWQiICkgJiYKCQkJCWpRdWVyeS5pbkFycmF5KCAiYXV0byIsIFsgY3VyQ1NTVG9wLCBjdXJDU1NMZWZ0IF0gKSA+IC0xOwoKCQkJLy8gbmVlZCB0byBiZSBhYmxlIHRvIGNhbGN1bGF0ZSBwb3NpdGlvbiBpZiBlaXRoZXIgdG9wIG9yIGxlZnQKCQkJLy8gaXMgYXV0byBhbmQgcG9zaXRpb24gaXMgZWl0aGVyIGFic29sdXRlIG9yIGZpeGVkCgkJCWlmICggY2FsY3VsYXRlUG9zaXRpb24gKSB7CgkJCQljdXJQb3NpdGlvbiA9IGN1ckVsZW0ucG9zaXRpb24oKTsKCQkJCWN1clRvcCA9IGN1clBvc2l0aW9uLnRvcDsKCQkJCWN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0OwoJCQl9IGVsc2UgewoJCQkJY3VyVG9wID0gcGFyc2VGbG9hdCggY3VyQ1NTVG9wICkgfHwgMDsKCQkJCWN1ckxlZnQgPSBwYXJzZUZsb2F0KCBjdXJDU1NMZWZ0ICkgfHwgMDsKCQkJfQoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0aW9ucyApICkgewoKCQkJCS8vIFVzZSBqUXVlcnkuZXh0ZW5kIGhlcmUgdG8gYWxsb3cgbW9kaWZpY2F0aW9uIG9mIGNvb3JkaW5hdGVzIGFyZ3VtZW50IChnaC0xODQ4KQoJCQkJb3B0aW9ucyA9IG9wdGlvbnMuY2FsbCggZWxlbSwgaSwgalF1ZXJ5LmV4dGVuZCgge30sIGN1ck9mZnNldCApICk7CgkJCX0KCgkJCWlmICggb3B0aW9ucy50b3AgIT0gbnVsbCApIHsKCQkJCXByb3BzLnRvcCA9ICggb3B0aW9ucy50b3AgLSBjdXJPZmZzZXQudG9wICkgKyBjdXJUb3A7CgkJCX0KCQkJaWYgKCBvcHRpb25zLmxlZnQgIT0gbnVsbCApIHsKCQkJCXByb3BzLmxlZnQgPSAoIG9wdGlvbnMubGVmdCAtIGN1ck9mZnNldC5sZWZ0ICkgKyBjdXJMZWZ0OwoJCQl9CgoJCQlpZiAoICJ1c2luZyIgaW4gb3B0aW9ucyApIHsKCQkJCW9wdGlvbnMudXNpbmcuY2FsbCggZWxlbSwgcHJvcHMgKTsKCQkJfSBlbHNlIHsKCQkJCWN1ckVsZW0uY3NzKCBwcm9wcyApOwoJCQl9CgkJfQoJfTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJb2Zmc2V0OiBmdW5jdGlvbiggb3B0aW9ucyApIHsKCQkJaWYgKCBhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJcmV0dXJuIG9wdGlvbnMgPT09IHVuZGVmaW5lZCA/CgkJCQkJdGhpcyA6CgkJCQkJdGhpcy5lYWNoKCBmdW5jdGlvbiggaSApIHsKCQkJCQkJalF1ZXJ5Lm9mZnNldC5zZXRPZmZzZXQoIHRoaXMsIG9wdGlvbnMsIGkgKTsKCQkJCQl9ICk7CgkJCX0KCgkJCXZhciBkb2NFbGVtLCB3aW4sCgkJCQlib3ggPSB7IHRvcDogMCwgbGVmdDogMCB9LAoJCQkJZWxlbSA9IHRoaXNbIDAgXSwKCQkJCWRvYyA9IGVsZW0gJiYgZWxlbS5vd25lckRvY3VtZW50OwoKCQkJaWYgKCAhZG9jICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCgkJCS8vIE1ha2Ugc3VyZSBpdCdzIG5vdCBhIGRpc2Nvbm5lY3RlZCBET00gbm9kZQoJCQlpZiAoICFqUXVlcnkuY29udGFpbnMoIGRvY0VsZW0sIGVsZW0gKSApIHsKCQkJCXJldHVybiBib3g7CgkJCX0KCgkJCS8vIElmIHdlIGRvbid0IGhhdmUgZ0JDUiwganVzdCB1c2UgMCwwIHJhdGhlciB0aGFuIGVycm9yCgkJCS8vIEJsYWNrQmVycnkgNSwgaU9TIDMgKG9yaWdpbmFsIGlQaG9uZSkKCQkJaWYgKCB0eXBlb2YgZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QgIT09ICJ1bmRlZmluZWQiICkgewoJCQkJYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCQkJfQoJCQl3aW4gPSBnZXRXaW5kb3coIGRvYyApOwoJCQlyZXR1cm4gewoJCQkJdG9wOiBib3gudG9wICArICggd2luLnBhZ2VZT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsVG9wICkgIC0gKCBkb2NFbGVtLmNsaWVudFRvcCAgfHwgMCApLAoJCQkJbGVmdDogYm94LmxlZnQgKyAoIHdpbi5wYWdlWE9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbExlZnQgKSAtICggZG9jRWxlbS5jbGllbnRMZWZ0IHx8IDAgKQoJCQl9OwoJCX0sCgoJCXBvc2l0aW9uOiBmdW5jdGlvbigpIHsKCQkJaWYgKCAhdGhpc1sgMCBdICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQl2YXIgb2Zmc2V0UGFyZW50LCBvZmZzZXQsCgkJCQlwYXJlbnRPZmZzZXQgPSB7IHRvcDogMCwgbGVmdDogMCB9LAoJCQkJZWxlbSA9IHRoaXNbIDAgXTsKCgkJCS8vIEZpeGVkIGVsZW1lbnRzIGFyZSBvZmZzZXQgZnJvbSB3aW5kb3cgKHBhcmVudE9mZnNldCA9IHt0b3A6MCwgbGVmdDogMH0sCgkJCS8vIGJlY2F1c2UgaXQgaXMgaXRzIG9ubHkgb2Zmc2V0IHBhcmVudAoJCQlpZiAoIGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSA9PT0gImZpeGVkIiApIHsKCgkJCQkvLyB3ZSBhc3N1bWUgdGhhdCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgaXMgYXZhaWxhYmxlIHdoZW4gY29tcHV0ZWQgcG9zaXRpb24gaXMgZml4ZWQKCQkJCW9mZnNldCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgkJCX0gZWxzZSB7CgoJCQkJLy8gR2V0ICpyZWFsKiBvZmZzZXRQYXJlbnQKCQkJCW9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50KCk7CgoJCQkJLy8gR2V0IGNvcnJlY3Qgb2Zmc2V0cwoJCQkJb2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTsKCQkJCWlmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50WyAwIF0sICJodG1sIiApICkgewoJCQkJCXBhcmVudE9mZnNldCA9IG9mZnNldFBhcmVudC5vZmZzZXQoKTsKCQkJCX0KCgkJCQkvLyBBZGQgb2Zmc2V0UGFyZW50IGJvcmRlcnMKCQkJCXBhcmVudE9mZnNldC50b3AgICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCAiYm9yZGVyVG9wV2lkdGgiLCB0cnVlICk7CgkJCQlwYXJlbnRPZmZzZXQubGVmdCArPSBqUXVlcnkuY3NzKCBvZmZzZXRQYXJlbnRbIDAgXSwgImJvcmRlckxlZnRXaWR0aCIsIHRydWUgKTsKCQkJfQoKCQkJLy8gU3VidHJhY3QgcGFyZW50IG9mZnNldHMgYW5kIGVsZW1lbnQgbWFyZ2lucwoJCQkvLyBub3RlOiB3aGVuIGFuIGVsZW1lbnQgaGFzIG1hcmdpbjogYXV0byB0aGUgb2Zmc2V0TGVmdCBhbmQgbWFyZ2luTGVmdAoJCQkvLyBhcmUgdGhlIHNhbWUgaW4gU2FmYXJpIGNhdXNpbmcgb2Zmc2V0LmxlZnQgdG8gaW5jb3JyZWN0bHkgYmUgMAoJCQlyZXR1cm4gewoJCQkJdG9wOiAgb2Zmc2V0LnRvcCAgLSBwYXJlbnRPZmZzZXQudG9wIC0galF1ZXJ5LmNzcyggZWxlbSwgIm1hcmdpblRvcCIsIHRydWUgKSwKCQkJCWxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQgLSBqUXVlcnkuY3NzKCBlbGVtLCAibWFyZ2luTGVmdCIsIHRydWUgKQoJCQl9OwoJCX0sCgoJCW9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLm1hcCggZnVuY3Rpb24oKSB7CgkJCQl2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQ7CgoJCQkJd2hpbGUgKCBvZmZzZXRQYXJlbnQgJiYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCBvZmZzZXRQYXJlbnQsICJodG1sIiApICYmCgkJCQkJalF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50LCAicG9zaXRpb24iICkgPT09ICJzdGF0aWMiICkgKSB7CgkJCQkJb2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDsKCQkJCX0KCQkJCXJldHVybiBvZmZzZXRQYXJlbnQgfHwgZG9jdW1lbnRFbGVtZW50OwoJCQl9ICk7CgkJfQoJfSApOwoKCS8vIENyZWF0ZSBzY3JvbGxMZWZ0IGFuZCBzY3JvbGxUb3AgbWV0aG9kcwoJalF1ZXJ5LmVhY2goIHsgc2Nyb2xsTGVmdDogInBhZ2VYT2Zmc2V0Iiwgc2Nyb2xsVG9wOiAicGFnZVlPZmZzZXQiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIHByb3AgKSB7CgkJdmFyIHRvcCA9IC9ZLy50ZXN0KCBwcm9wICk7CgoJCWpRdWVyeS5mblsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdmFsICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgbWV0aG9kLCB2YWwgKSB7CgkJCQl2YXIgd2luID0gZ2V0V2luZG93KCBlbGVtICk7CgoJCQkJaWYgKCB2YWwgPT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gd2luID8gKCBwcm9wIGluIHdpbiApID8gd2luWyBwcm9wIF0gOgoJCQkJCQl3aW4uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyBtZXRob2QgXSA6CgkJCQkJCWVsZW1bIG1ldGhvZCBdOwoJCQkJfQoKCQkJCWlmICggd2luICkgewoJCQkJCXdpbi5zY3JvbGxUbygKCQkJCQkJIXRvcCA/IHZhbCA6IGpRdWVyeSggd2luICkuc2Nyb2xsTGVmdCgpLAoJCQkJCQl0b3AgPyB2YWwgOiBqUXVlcnkoIHdpbiApLnNjcm9sbFRvcCgpCgkJCQkJKTsKCgkJCQl9IGVsc2UgewoJCQkJCWVsZW1bIG1ldGhvZCBdID0gdmFsOwoJCQkJfQoJCQl9LCBtZXRob2QsIHZhbCwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCApOwoJCX07Cgl9ICk7CgoJLy8gU3VwcG9ydDogU2FmYXJpPDctOCssIENocm9tZTwzNy00NCsKCS8vIEFkZCB0aGUgdG9wL2xlZnQgY3NzSG9va3MgdXNpbmcgalF1ZXJ5LmZuLnBvc2l0aW9uCgkvLyBXZWJraXQgYnVnOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjkwODQKCS8vIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyBwZXJjZW50IHdoZW4gc3BlY2lmaWVkIGZvciB0b3AvbGVmdC9ib3R0b20vcmlnaHQKCS8vIHJhdGhlciB0aGFuIG1ha2UgdGhlIGNzcyBtb2R1bGUgZGVwZW5kIG9uIHRoZSBvZmZzZXQgbW9kdWxlLCB3ZSBqdXN0IGNoZWNrIGZvciBpdCBoZXJlCglqUXVlcnkuZWFjaCggWyAidG9wIiwgImxlZnQiIF0sIGZ1bmN0aW9uKCBpLCBwcm9wICkgewoJCWpRdWVyeS5jc3NIb29rc1sgcHJvcCBdID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnBpeGVsUG9zaXRpb24sCgkJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJCWlmICggY29tcHV0ZWQgKSB7CgkJCQkJY29tcHV0ZWQgPSBjdXJDU1MoIGVsZW0sIHByb3AgKTsKCgkJCQkJLy8gaWYgY3VyQ1NTIHJldHVybnMgcGVyY2VudGFnZSwgZmFsbGJhY2sgdG8gb2Zmc2V0CgkJCQkJcmV0dXJuIHJudW1ub25weC50ZXN0KCBjb21wdXRlZCApID8KCQkJCQkJalF1ZXJ5KCBlbGVtICkucG9zaXRpb24oKVsgcHJvcCBdICsgInB4IiA6CgkJCQkJCWNvbXB1dGVkOwoJCQkJfQoJCQl9CgkJKTsKCX0gKTsKCgoJLy8gQ3JlYXRlIGlubmVySGVpZ2h0LCBpbm5lcldpZHRoLCBoZWlnaHQsIHdpZHRoLCBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aCBtZXRob2RzCglqUXVlcnkuZWFjaCggeyBIZWlnaHQ6ICJoZWlnaHQiLCBXaWR0aDogIndpZHRoIiB9LCBmdW5jdGlvbiggbmFtZSwgdHlwZSApIHsKCQlqUXVlcnkuZWFjaCggeyBwYWRkaW5nOiAiaW5uZXIiICsgbmFtZSwgY29udGVudDogdHlwZSwgIiI6ICJvdXRlciIgKyBuYW1lIH0sCgkJZnVuY3Rpb24oIGRlZmF1bHRFeHRyYSwgZnVuY05hbWUgKSB7CgoJCQkvLyBtYXJnaW4gaXMgb25seSBmb3Igb3V0ZXJIZWlnaHQsIG91dGVyV2lkdGgKCQkJalF1ZXJ5LmZuWyBmdW5jTmFtZSBdID0gZnVuY3Rpb24oIG1hcmdpbiwgdmFsdWUgKSB7CgkJCQl2YXIgY2hhaW5hYmxlID0gYXJndW1lbnRzLmxlbmd0aCAmJiAoIGRlZmF1bHRFeHRyYSB8fCB0eXBlb2YgbWFyZ2luICE9PSAiYm9vbGVhbiIgKSwKCQkJCQlleHRyYSA9IGRlZmF1bHRFeHRyYSB8fCAoIG1hcmdpbiA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gdHJ1ZSA/ICJtYXJnaW4iIDogImJvcmRlciIgKTsKCgkJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgdHlwZSwgdmFsdWUgKSB7CgkJCQkJdmFyIGRvYzsKCgkJCQkJaWYgKCBqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQkJCS8vIEFzIG9mIDUvOC8yMDEyIHRoaXMgd2lsbCB5aWVsZCBpbmNvcnJlY3QgcmVzdWx0cyBmb3IgTW9iaWxlIFNhZmFyaSwgYnV0IHRoZXJlCgkJCQkJCS8vIGlzbid0IGEgd2hvbGUgbG90IHdlIGNhbiBkby4gU2VlIHB1bGwgcmVxdWVzdCBhdCB0aGlzIFVSTCBmb3IgZGlzY3Vzc2lvbjoKCQkJCQkJLy8gaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC83NjQKCQkJCQkJcmV0dXJuIGVsZW0uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyAiY2xpZW50IiArIG5hbWUgXTsKCQkJCQl9CgoJCQkJCS8vIEdldCBkb2N1bWVudCB3aWR0aCBvciBoZWlnaHQKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDkgKSB7CgkJCQkJCWRvYyA9IGVsZW0uZG9jdW1lbnRFbGVtZW50OwoKCQkJCQkJLy8gRWl0aGVyIHNjcm9sbFtXaWR0aC9IZWlnaHRdIG9yIG9mZnNldFtXaWR0aC9IZWlnaHRdIG9yIGNsaWVudFtXaWR0aC9IZWlnaHRdLAoJCQkJCQkvLyB3aGljaGV2ZXIgaXMgZ3JlYXRlc3QKCQkJCQkJLy8gdW5mb3J0dW5hdGVseSwgdGhpcyBjYXVzZXMgYnVnICMzODM4IGluIElFNi84IG9ubHksCgkJCQkJCS8vIGJ1dCB0aGVyZSBpcyBjdXJyZW50bHkgbm8gZ29vZCwgc21hbGwgd2F5IHRvIGZpeCBpdC4KCQkJCQkJcmV0dXJuIE1hdGgubWF4KAoJCQkJCQkJZWxlbS5ib2R5WyAic2Nyb2xsIiArIG5hbWUgXSwgZG9jWyAic2Nyb2xsIiArIG5hbWUgXSwKCQkJCQkJCWVsZW0uYm9keVsgIm9mZnNldCIgKyBuYW1lIF0sIGRvY1sgIm9mZnNldCIgKyBuYW1lIF0sCgkJCQkJCQlkb2NbICJjbGllbnQiICsgbmFtZSBdCgkJCQkJCSk7CgkJCQkJfQoKCQkJCQlyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/CgoJCQkJCQkvLyBHZXQgd2lkdGggb3IgaGVpZ2h0IG9uIHRoZSBlbGVtZW50LCByZXF1ZXN0aW5nIGJ1dCBub3QgZm9yY2luZyBwYXJzZUZsb2F0CgkJCQkJCWpRdWVyeS5jc3MoIGVsZW0sIHR5cGUsIGV4dHJhICkgOgoKCQkJCQkJLy8gU2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudAoJCQkJCQlqUXVlcnkuc3R5bGUoIGVsZW0sIHR5cGUsIHZhbHVlLCBleHRyYSApOwoJCQkJfSwgdHlwZSwgY2hhaW5hYmxlID8gbWFyZ2luIDogdW5kZWZpbmVkLCBjaGFpbmFibGUsIG51bGwgKTsKCQkJfTsKCQl9ICk7Cgl9ICk7CgoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCgkJYmluZDogZnVuY3Rpb24oIHR5cGVzLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBudWxsLCBkYXRhLCBmbiApOwoJCX0sCgkJdW5iaW5kOiBmdW5jdGlvbiggdHlwZXMsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vZmYoIHR5cGVzLCBudWxsLCBmbiApOwoJCX0sCgoJCWRlbGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKTsKCQl9LAoJCXVuZGVsZWdhdGU6IGZ1bmN0aW9uKCBzZWxlY3RvciwgdHlwZXMsIGZuICkgewoKCQkJLy8gKCBuYW1lc3BhY2UgKSBvciAoIHNlbGVjdG9yLCB0eXBlcyBbLCBmbl0gKQoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/CgkJCQl0aGlzLm9mZiggc2VsZWN0b3IsICIqKiIgKSA6CgkJCQl0aGlzLm9mZiggdHlwZXMsIHNlbGVjdG9yIHx8ICIqKiIsIGZuICk7CgkJfQoJfSApOwoKCS8vIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgY29udGFpbmVkIGluIHRoZSBtYXRjaGVkIGVsZW1lbnQgc2V0CglqUXVlcnkuZm4uc2l6ZSA9IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLmxlbmd0aDsKCX07CgoJalF1ZXJ5LmZuLmFuZFNlbGYgPSBqUXVlcnkuZm4uYWRkQmFjazsKCgoKCgkvLyBSZWdpc3RlciBhcyBhIG5hbWVkIEFNRCBtb2R1bGUsIHNpbmNlIGpRdWVyeSBjYW4gYmUgY29uY2F0ZW5hdGVkIHdpdGggb3RoZXIKCS8vIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsIGJ1dCBub3QgdmlhIGEgcHJvcGVyIGNvbmNhdGVuYXRpb24gc2NyaXB0IHRoYXQKCS8vIHVuZGVyc3RhbmRzIGFub255bW91cyBBTUQgbW9kdWxlcy4gQSBuYW1lZCBBTUQgaXMgc2FmZXN0IGFuZCBtb3N0IHJvYnVzdAoJLy8gd2F5IHRvIHJlZ2lzdGVyLiBMb3dlcmNhc2UganF1ZXJ5IGlzIHVzZWQgYmVjYXVzZSBBTUQgbW9kdWxlIG5hbWVzIGFyZQoJLy8gZGVyaXZlZCBmcm9tIGZpbGUgbmFtZXMsIGFuZCBqUXVlcnkgaXMgbm9ybWFsbHkgZGVsaXZlcmVkIGluIGEgbG93ZXJjYXNlCgkvLyBmaWxlIG5hbWUuIERvIHRoaXMgYWZ0ZXIgY3JlYXRpbmcgdGhlIGdsb2JhbCBzbyB0aGF0IGlmIGFuIEFNRCBtb2R1bGUgd2FudHMKCS8vIHRvIGNhbGwgbm9Db25mbGljdCB0byBoaWRlIHRoaXMgdmVyc2lvbiBvZiBqUXVlcnksIGl0IHdpbGwgd29yay4KCgkvLyBOb3RlIHRoYXQgZm9yIG1heGltdW0gcG9ydGFiaWxpdHksIGxpYnJhcmllcyB0aGF0IGFyZSBub3QgalF1ZXJ5IHNob3VsZAoJLy8gZGVjbGFyZSB0aGVtc2VsdmVzIGFzIGFub255bW91cyBtb2R1bGVzLCBhbmQgYXZvaWQgc2V0dGluZyBhIGdsb2JhbCBpZiBhbgoJLy8gQU1EIGxvYWRlciBpcyBwcmVzZW50LiBqUXVlcnkgaXMgYSBzcGVjaWFsIGNhc2UuIEZvciBtb3JlIGluZm9ybWF0aW9uLCBzZWUKCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL3JlcXVpcmVqcy93aWtpL1VwZGF0aW5nLWV4aXN0aW5nLWxpYnJhcmllcyN3aWtpLWFub24KCglpZiAoIHRydWUgKSB7CgkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7CgkJCXJldHVybiBqUXVlcnk7CgkJfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJfQoKCgoJdmFyCgoJCS8vIE1hcCBvdmVyIGpRdWVyeSBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJCV9qUXVlcnkgPSB3aW5kb3cualF1ZXJ5LAoKCQkvLyBNYXAgb3ZlciB0aGUgJCBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJCV8kID0gd2luZG93LiQ7CgoJalF1ZXJ5Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbiggZGVlcCApIHsKCQlpZiAoIHdpbmRvdy4kID09PSBqUXVlcnkgKSB7CgkJCXdpbmRvdy4kID0gXyQ7CgkJfQoKCQlpZiAoIGRlZXAgJiYgd2luZG93LmpRdWVyeSA9PT0galF1ZXJ5ICkgewoJCQl3aW5kb3cualF1ZXJ5ID0gX2pRdWVyeTsKCQl9CgoJCXJldHVybiBqUXVlcnk7Cgl9OwoKCS8vIEV4cG9zZSBqUXVlcnkgYW5kICQgaWRlbnRpZmllcnMsIGV2ZW4gaW4KCS8vIEFNRCAoIzcxMDIjY29tbWVudDoxMCwgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC81NTcpCgkvLyBhbmQgQ29tbW9uSlMgZm9yIGJyb3dzZXIgZW11bGF0b3JzICgjMTM1NjYpCglpZiAoICFub0dsb2JhbCApIHsKCQl3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSBqUXVlcnk7Cgl9CgoJcmV0dXJuIGpRdWVyeTsKCX0pKTsKCgovKioqLyB9LAovKiAzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsndXNlIHN0cmljdCc7CgoJLyogZXNsaW50IG1heC1zdGF0ZW1lbnRzOiBbMiwgMjNdIGNvbXBsZXhpdHk6IFsyLCA3XSAqLwoJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18oNCksIF9fd2VicGFja19yZXF1aXJlX18oNSksIF9fd2VicGFja19yZXF1aXJlX18oNiksIF9fd2VicGFja19yZXF1aXJlX18oMTApLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24gKCQsIEhhbmRsZWJhcnMsIENvb2tpZSwgY2FjaGVidXN0TWFwKSB7CgoJICB2YXIgdHBsID0gSGFuZGxlYmFycy5jb21waWxlOwoJICB2YXIgZm9ybVRwbCA9IHRwbCgnPGZvcm0gbWV0aG9kPSJQT1NUIiBhY3Rpb249Int7YWN0aW9ufX0iPjwvZm9ybT4nKTsKCSAgdmFyIGlucHV0VHBsID0gdHBsKCc8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ7e25hbWV9fSIgdmFsdWU9Int7dmFsdWV9fSIgLz4nKTsKCgkgIHZhciBVdGlsID0ge307CgoJICB2YXIgamFtbWVyVGVtcGxhdGUgPSB7CgkgICAgJ2Nocm9tZSc6ICc8aW5wdXQgc3R5bGU9Im9wYWNpdHk6IDA7IHdpZHRoOiAwOyBoZWlnaHQ6IDA7IiBpZD0ib2t0YV9oaWRkZW5fdXNlcm5hbWVfY2hyb21lX3NlcXVlbmNlX25vIiBcCgkgICAgICAgICAgICAgICAgdHlwZT0idGV4dCIgYXV0b2NvbXBsZXRlPSJvZmYiIC8+XAoJICAgICAgICAgICAgICAgIDxpbnB1dCBzdHlsZT0ib3BhY2l0eTogMDsgd2lkdGg6IDA7IGhlaWdodDogMDsiIGlkPSJva3RhX2hpZGRlbl9wYXNzX2Nocm9tZV9zZXF1ZW5jZV9ubyJcCgkgICAgICAgICAgICAgICAgdHlwZT0icGFzc3dvcmQiIGF1dG9jb21wbGV0ZT0ib2ZmIiAvPicsCgoJICAgICdzYWZhcmknOiAnPGlucHV0IHN0eWxlPSJvcGFjaXR5OiAwOyB3aWR0aDogMDsgaGVpZ2h0OiAwOyIgaWQ9Im9rdGFfaGlkZGVuX3Bhc3Nfc2FmYXJpX3NlcXVlbmNlX25vIiBcCgkgICAgICAgICAgICAgICAgICB0eXBlPSJwYXNzd29yZCIgYXV0b2NvbXBsZXRlPSJvZmYiIC8+JywKCgkgICAgJ21vemlsbGEnOiAnPGlucHV0IHN0eWxlPSJkaXNwbGF5Om5vbmUiIHR5cGU9InBhc3N3b3JkIiBpZD0ib2t0YV9oaWRkZW5fcGFzc19maXJlZm94X3NlcXVlbmNlX25vIiBcCgkgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU9Im9mZiIgdmFsdWU9InRlc3QiIC8+JywKCgkgICAgJ21zaWUnOiAnPGlucHV0IGlkPSJva3RhX2hpZGRlbl9wYXNzX2llX3NlcXVlbmNlX25vIiB0eXBlPSJwYXNzd29yZCIgYXV0b2NvbXBsZXRlPSJvZmYiXAoJICAgICAgICAgICAgICBzdHlsZT0iZGlzcGxheTpub25lIiB2YWx1ZSA9ICJ0ZXN0X3NlcXVlbmNlX25vIi8+JwoJICB9OwoKCSAgdmFyIGNsZWFyQmVlblRvSG9tZVBhZ2UgPSBmdW5jdGlvbiBjbGVhckJlZW5Ub0hvbWVQYWdlKCkgewoJICAgIENvb2tpZS5yZW1vdmVDb29raWUoJ2FvJywgeyBwYXRoOiAnLycgfSk7CgkgIH07CgoJICB2YXIgcmVzZXRBdXRvTGF1bmNoID0gZnVuY3Rpb24gcmVzZXRBdXRvTGF1bmNoKCkgewoJICAgIENvb2tpZS5yZW1vdmVDb29raWUoJ2F1dG9sYXVuY2hfdHJpZ2dlcmVkJywgeyBwYXRoOiAnLycgfSk7CgkgIH07CgoJICB2YXIgaXNQb3N0U2FtbEVtYmVkVXJsID0gZnVuY3Rpb24gaXNQb3N0U2FtbEVtYmVkVXJsKHVybCkgewoJICAgIC8vIEFQUF9TQU1MX0ZPUl9JTlNUQU5DRSBpcyAvYXBwL3thcHB9L3trZXl9L3Nzby9zYW1sCgkgICAgcmV0dXJuIHVybC5zZWFyY2goL1wvYXBwXC9bXi9dK1wvW14vXStcL3Nzb1wvc2FtbC4qXD8vaSkgIT09IC0xOwoJICB9OwoKCSAgLy8gUG9zdHMgdG8gYSBnaXZlbiB1cmwsIGNvbnZlcnRpbmcgYW55IHF1ZXJ5IHBhcmFtcyB0byBwb3N0IHBhcmFtcy4gVGhpcyBpcwoJICAvLyBkb25lIGJ5IGNyZWF0aW5nIGEgZm9ybSBvbiB0aGUgcGFnZSwgcGFyc2luZyB0aGUgcGFyYW1zIGZyb20gdGhlIHVybCwgYW5kCgkgIC8vIHN1Ym1pdHRpbmcgaXQuCgkgIC8vICRlbCBpcyBhbiBlbGVtZW50IHRvIGFwcGVuZCB0aGUgZm9ybSB0by4KCSAgdmFyIHBvc3RUb1VybCA9IGZ1bmN0aW9uIHBvc3RUb1VybCh1cmwsICRlbCkgewoJICAgIHZhciBwYXJ0cyA9IHVybC5zcGxpdCgnPycpLAoJICAgICAgICBiYXNlVXJsID0gcGFydHNbMF0sCgkgICAgICAgIHF1ZXJ5U3RyaW5nID0gcGFydHNbMV0sCgkgICAgICAgIHF1ZXJ5UGFyYW1zLAoJICAgICAgICBmb3JtOwoJICAgIGZvcm0gPSAkKGZvcm1UcGwoeyBhY3Rpb246IGJhc2VVcmwgfSkpOwoJICAgIGlmIChxdWVyeVN0cmluZykgewoJICAgICAgcXVlcnlQYXJhbXMgPSBxdWVyeVN0cmluZy5zcGxpdCgnJicpOwoJICAgICAgJC5lYWNoKHF1ZXJ5UGFyYW1zLCBmdW5jdGlvbiAoaSwgcGFyYW0pIHsKCSAgICAgICAgdmFyIHRva2VucyA9IHBhcmFtLnNwbGl0KCc9Jyk7CgkgICAgICAgIGZvcm0uYXBwZW5kKGlucHV0VHBsKHsKCSAgICAgICAgICBuYW1lOiB0b2tlbnNbMF0sCgkgICAgICAgICAgdmFsdWU6IGRlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMV0pCgkgICAgICAgIH0pKTsKCSAgICAgIH0pOwoJICAgIH0KCSAgICAkZWwuYXBwZW5kKGZvcm0pOwoJICAgIGZvcm0uc3VibWl0KCk7CgkgIH07CgoJICB2YXIgYWRkUGFzc3dvcmRKYW1tZXJzID0gZnVuY3Rpb24gYWRkUGFzc3dvcmRKYW1tZXJzKCRlbCkgewoJICAgIHZhciBoaWRkZW5JbnB1dCwgYnJvd3NlciwgdG90YWxSZXBldGl0aW9uczsKCgkgICAgaWYgKCQuYnJvd3Nlci5jaHJvbWUpIHsKCSAgICAgIGhpZGRlbklucHV0ID0gcGFzc3dvcmRKYW1tZXJGYWN0b3J5KCdjaHJvbWUnLCAzKTsKCSAgICAgICRlbC5wcmVwZW5kKGhpZGRlbklucHV0KTsKCSAgICAgIHJldHVybjsKCSAgICB9CgkgICAgaWYgKCQuYnJvd3Nlci5zYWZhcmkpIHsKCSAgICAgIGJyb3dzZXIgPSAnc2FmYXJpJzsKCSAgICAgIHRvdGFsUmVwZXRpdGlvbnMgPSAyOwoJICAgIH0gZWxzZSBpZiAoJC5icm93c2VyLm1vemlsbGEpIHsKCSAgICAgIGJyb3dzZXIgPSAnbW96aWxsYSc7CgkgICAgICB0b3RhbFJlcGV0aXRpb25zID0gMzsKCSAgICB9IGVsc2UgewoJICAgICAgYnJvd3NlciA9ICdtc2llJzsKCSAgICAgIHRvdGFsUmVwZXRpdGlvbnMgPSAyOwoJICAgIH0KCSAgICBoaWRkZW5JbnB1dCA9IHBhc3N3b3JkSmFtbWVyRmFjdG9yeShicm93c2VyLCB0b3RhbFJlcGV0aXRpb25zKTsKCSAgICAkZWwuYXBwZW5kKGhpZGRlbklucHV0KTsKCSAgfTsKCgkgIGZ1bmN0aW9uIHBhc3N3b3JkSmFtbWVyRmFjdG9yeShicm93c2VyLCB0b3RhbFJlcGV0aXRpb25zKSB7CgoJICAgIHZhciBjdXJyZW50VGVtcGxhdGUgPSBqYW1tZXJUZW1wbGF0ZVticm93c2VyXSwKCSAgICAgICAgcmVzdWx0ID0gJycsCgkgICAgICAgIGk7CgoJICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbFJlcGV0aXRpb25zOyBpKyspIHsKCSAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoY3VycmVudFRlbXBsYXRlLnJlcGxhY2UoL3NlcXVlbmNlX25vL2csIGkgKyAxKSk7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIC8vIFJld3JpdGVzIHRoZSBkZWZhdWx0IFNpZ24taW4gV2lkZ2V0IGFzc2V0IGJ1bmRsZSBwYXRocyB0byBoYW5kbGUgb3VyCgkgIC8vIGludGVybmFsIGkxOG4ganNvbnAgZmlsZXM6CgkgIC8vIDEuIEFkZCBjYWNoZWJ1c3Qgc2hhCgkgIC8vIDIuIFJlcGxhY2UgLmpzb25wIHdpdGggLmpzCgkgIHZhciBwYXRoUmUgPSBuZXcgUmVnRXhwKCcvKFteL10qKVwuanNvbnAkJyk7CgoJICBmdW5jdGlvbiBhc3NldFJld3JpdGUocGF0aCkgewoJICAgIHZhciBtYXRjaGVzID0gcGF0aFJlLmV4ZWMocGF0aCk7CgkgICAgaWYgKCFtYXRjaGVzIHx8ICFjYWNoZWJ1c3RNYXBbbWF0Y2hlc1sxXV0pIHsKCSAgICAgIHJldHVybiBwYXRoOwoJICAgIH0KCSAgICByZXR1cm4gJy8nICsgY2FjaGVidXN0TWFwW21hdGNoZXNbMV1dICsgJy5qcyc7CgkgIH0KCgkgIC8vIE9LVEEtMTAxNTA5OiBUaGVyZSBhcmUgZW1iZWRkZWQgYnJvd3NlcnMgdGhhdCBoYXZlIHB1c2hTdGF0ZSwgYnV0IHRocm93CgkgIC8vIGFuIGVycm9yIHdoZW4gaXQncyBjYWxsZWQuIFNvLCB3ZSBhY3R1YWxseSBjYWxsIHJlcGxhY2VTdGF0ZSBpbiBhIHRyeS9jYXRjaAoJICAvLyB0byBzZWUgaWYgaXQgaGl0cyB0aGlzIGNvbmRpdGlvbi4KCSAgZnVuY3Rpb24gc3VwcG9ydHNSb3V0ZXIoKSB7CgkgICAgdmFyIHN1cHBvcnRzUHVzaCA9ICEhKHdpbmRvdy5oaXN0b3J5ICYmIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSksCgkgICAgICAgIHN1cHBvcnRzUmVwbGFjZSA9IHN1cHBvcnRzUHVzaCAmJiB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGU7CgkgICAgaWYgKCFzdXBwb3J0c1B1c2ggfHwgIXN1cHBvcnRzUmVwbGFjZSkgewoJICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH0KCSAgICB0cnkgewoJICAgICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LCBkb2N1bWVudC50aXRsZSwgbG9jYXRpb24uaHJlZik7CgkgICAgICByZXR1cm4gdHJ1ZTsKCSAgICB9IGNhdGNoIChlKSB7CgkgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfQoJICB9CgoJICAvLyBIYWNrIGZvciBPS1RBLTEwMjIxNyA6IEdpdmVuIGEgYmFzZSB1cmwsIGNyZWF0ZSBhbm90aGVyIGJhc2UgdXJsCgkgIC8vIGJ5IHJlbW92aW5nL2FkZGluZyBwb3J0IG51bWJlciB0aGF0IGlzIGZ1bmN0aW9uYWxseSB0aGUgc2FtZSBidXQgYXZvaWRzIGEgTWljcm9zb2Z0IGRvdWJsZS1yZXF1ZXN0IGJ1Zy4KCSAgZnVuY3Rpb24gYmFzZVVybFdpdGhQb3J0QWRkZWRPclJlbW92ZWQoYmFzZVVybCkgewoKCSAgICB2YXIgYmFzZVVybEhvc3RuYW1lOwoJICAgIHZhciBob3N0bmFtZTsKCSAgICB2YXIgcHJvdG9jb2w7CgkgICAgdmFyIGhvc3RBbmRQYXRoOwoJICAgIHZhciBub1Byb3RvY29sRm91bmQgPSBmYWxzZTsKCgkgICAgLy8gU3BsaXQgb3V0IHByb3RvY29sIGFuZCBob3N0bmFtZQoJICAgIGlmIChiYXNlVXJsLmluZGV4T2YoJzovLycpID4gLTEpIHsKCSAgICAgIHByb3RvY29sID0gYmFzZVVybC5zcGxpdCgnOi8vJylbMF07CgkgICAgICAvLyBzZWNvbmQgaGFsZiBvZiBVUkwgaXMgaG9zdG5hbWUgKyBwYXRoIGNvbXBvbmVudHMKCSAgICAgIGhvc3RBbmRQYXRoID0gYmFzZVVybC5zcGxpdCgnOi8vJylbMV07CgkgICAgICAvLyBmaXJzdCBlbGVtZW50IGlzIGhvc3RuYW1lLCByZXN0IG9mIHRoZW0gYXJlIHBhdGggY29tcG9uZW50cwoJICAgICAgYmFzZVVybEhvc3RuYW1lID0gaG9zdEFuZFBhdGguc3BsaXQoJy8nKVswXTsKCSAgICB9IGVsc2UgewoJICAgICAgbm9Qcm90b2NvbEZvdW5kID0gdHJ1ZTsKCSAgICAgIHByb3RvY29sID0gJ2h0dHBzJzsKCSAgICAgIGJhc2VVcmxIb3N0bmFtZSA9IGJhc2VVcmwuc3BsaXQoJy8nKVswXTsKCSAgICB9CgoJICAgIC8vIElmIHRoZXJlIGlzIGEgcG9ydCBudW1iZXIsIHJlbW92ZSBpdAoJICAgIGlmIChiYXNlVXJsSG9zdG5hbWUuaW5kZXhPZignOicpID4gLTEpIHsKCSAgICAgIHZhciBwb3J0ID0gYmFzZVVybEhvc3RuYW1lLnNwbGl0KCc6JylbMV07CgkgICAgICAvLyBodHRwcyBwb3J0IHdpdGggbm8gcHJvdG9jb2wKCSAgICAgIGlmIChwb3J0ID09ICc0NDMnICYmIG5vUHJvdG9jb2xGb3VuZCkgewoJICAgICAgICBwcm90b2NvbCA9ICdodHRwcyc7CgkgICAgICAgIC8vIHN0YW5kYXJkIHBvcnQsIHNvIHJlbW92ZSBpdAoJICAgICAgfSBlbHNlIGlmIChwb3J0ID09PSAnODAnIHx8IHBvcnQgPT09ICc0NDMnKSB7CgkgICAgICAgIGhvc3RuYW1lID0gYmFzZVVybEhvc3RuYW1lLnNwbGl0KCc6JylbMF07CgkgICAgICAgIC8vIE5vbi1zdGFuZGFyZCBwb3J0IGVnIGZvciByYWluLCBzbyBsZWF2ZSBpdCBiZQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmV0dXJuIGJhc2VVcmw7CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHBvcnQgbnVtYmVyLCBhZGQgb25lCgkgICAgICBpZiAocHJvdG9jb2wgPT09ICdodHRwcycpIHsKCSAgICAgICAgaG9zdG5hbWUgPSBiYXNlVXJsSG9zdG5hbWUgKyAnOjQ0Myc7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBob3N0bmFtZSA9IGJhc2VVcmxIb3N0bmFtZSArICc6ODAnOwoJICAgICAgfQoJICAgIH0KCgkgICAgcmV0dXJuIHByb3RvY29sICsgJzovLycgKyBob3N0bmFtZTsKCSAgfQoKCSAgZnVuY3Rpb24gdXNlckFnZW50SXNJb3MxMCh1c2VyQWdlbnQpIHsKCSAgICByZXR1cm4gdXNlckFnZW50LmluZGV4T2YoJ0FwcGxlV2ViS2l0JykgPiAtMSAmJiB1c2VyQWdlbnQuaW5kZXhPZignTW9iaWxlJykgPiAtMSAmJiB1c2VyQWdlbnQuaW5kZXhPZignMTBfJykgPiAtMTsKCSAgfQoKCSAgLy8gQm9ycm93ZWQgZnJvbSBva3RhLWF1dGgtanMKCSAgZnVuY3Rpb24gdG9RdWVyeVBhcmFtcyhvYmopIHsKCSAgICB2YXIgc3RyID0gW107CgoJICAgIGlmIChvYmogPT09IG51bGwpIHsKCSAgICAgIHJldHVybiAnJzsKCSAgICB9CgkgICAgZm9yICh2YXIga2V5IGluIG9iaikgewoJICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIG9ialtrZXldICE9PSB1bmRlZmluZWQgJiYgb2JqW2tleV0gIT09IG51bGwpIHsKCSAgICAgICAgc3RyLnB1c2goa2V5ICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG9ialtrZXldKSk7CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAoc3RyLmxlbmd0aCkgewoJICAgICAgcmV0dXJuICc/JyArIHN0ci5qb2luKCcmJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiAnJzsKCSAgICB9CgkgIH0KCgkgIGZ1bmN0aW9uIGFkanVzdFVybFBhdGgocmVkaXJlY1VybCkgewoJICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSgnJywgZG9jdW1lbnQudGl0bGUsIHJlZGlyZWNVcmwpOwoJICB9CgoJICBmdW5jdGlvbiBpc0xvZ2luVXJsU3RhbGUobG9naW5QYWdlVXJsUmVkaXJlY3QsIGhyZWYpIHsKCSAgICByZXR1cm4gISEobG9naW5QYWdlVXJsUmVkaXJlY3QgJiYgbG9naW5QYWdlVXJsUmVkaXJlY3QgIT09IGhyZWYpOwoJICB9CgoJICBVdGlsID0gewoJICAgIGNsZWFyQmVlblRvSG9tZVBhZ2U6IGNsZWFyQmVlblRvSG9tZVBhZ2UsCgkgICAgcmVzZXRBdXRvTGF1bmNoOiByZXNldEF1dG9MYXVuY2gsCgkgICAgaXNQb3N0U2FtbEVtYmVkVXJsOiBpc1Bvc3RTYW1sRW1iZWRVcmwsCgkgICAgcG9zdFRvVXJsOiBwb3N0VG9VcmwsCgkgICAgYWRkUGFzc3dvcmRKYW1tZXJzOiBhZGRQYXNzd29yZEphbW1lcnMsCgkgICAgYXNzZXRSZXdyaXRlOiBhc3NldFJld3JpdGUsCgkgICAgc3VwcG9ydHNSb3V0ZXI6IHN1cHBvcnRzUm91dGVyLAoJICAgIGJhc2VVcmxXaXRoUG9ydEFkZGVkT3JSZW1vdmVkOiBiYXNlVXJsV2l0aFBvcnRBZGRlZE9yUmVtb3ZlZCwKCSAgICB1c2VyQWdlbnRJc0lvczEwOiB1c2VyQWdlbnRJc0lvczEwLAoJICAgIHRvUXVlcnlQYXJhbXM6IHRvUXVlcnlQYXJhbXMsCgkgICAgYWRqdXN0VXJsUGF0aDogYWRqdXN0VXJsUGF0aCwKCSAgICBpc0xvZ2luVXJsU3RhbGU6IGlzTG9naW5VcmxTdGFsZQoJICB9OwoKCSAgcmV0dXJuIFV0aWw7Cgl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgovKioqLyB9LAovKiA0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuMTEuMwoJICogaHR0cDovL2pxdWVyeS5jb20vCgkgKgoJICogSW5jbHVkZXMgU2l6emxlLmpzCgkgKiBodHRwOi8vc2l6emxlanMuY29tLwoJICoKCSAqIENvcHlyaWdodCAyMDA1LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnMKCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQoJICoKCSAqIERhdGU6IDIwMTUtMDQtMjhUMTY6MTlaCgkgKi8KCgkoZnVuY3Rpb24oIGdsb2JhbCwgZmFjdG9yeSApIHsKCgkJaWYgKCB0eXBlb2YgbW9kdWxlID09PSAib2JqZWN0IiAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09ICJvYmplY3QiICkgewoJCQkvLyBGb3IgQ29tbW9uSlMgYW5kIENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHdoZXJlIGEgcHJvcGVyIHdpbmRvdyBpcyBwcmVzZW50LAoJCQkvLyBleGVjdXRlIHRoZSBmYWN0b3J5IGFuZCBnZXQgalF1ZXJ5CgkJCS8vIEZvciBlbnZpcm9ubWVudHMgdGhhdCBkbyBub3QgaW5oZXJlbnRseSBwb3NzZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50CgkJCS8vIChzdWNoIGFzIE5vZGUuanMpLCBleHBvc2UgYSBqUXVlcnktbWFraW5nIGZhY3RvcnkgYXMgbW9kdWxlLmV4cG9ydHMKCQkJLy8gVGhpcyBhY2NlbnR1YXRlcyB0aGUgbmVlZCBmb3IgdGhlIGNyZWF0aW9uIG9mIGEgcmVhbCB3aW5kb3cKCQkJLy8gZS5nLiB2YXIgalF1ZXJ5ID0gcmVxdWlyZSgianF1ZXJ5Iikod2luZG93KTsKCQkJLy8gU2VlIHRpY2tldCAjMTQ1NDkgZm9yIG1vcmUgaW5mbwoJCQltb2R1bGUuZXhwb3J0cyA9IGdsb2JhbC5kb2N1bWVudCA/CgkJCQlmYWN0b3J5KCBnbG9iYWwsIHRydWUgKSA6CgkJCQlmdW5jdGlvbiggdyApIHsKCQkJCQlpZiAoICF3LmRvY3VtZW50ICkgewoJCQkJCQl0aHJvdyBuZXcgRXJyb3IoICJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50IiApOwoJCQkJCX0KCQkJCQlyZXR1cm4gZmFjdG9yeSggdyApOwoJCQkJfTsKCQl9IGVsc2UgewoJCQlmYWN0b3J5KCBnbG9iYWwgKTsKCQl9CgoJLy8gUGFzcyB0aGlzIGlmIHdpbmRvdyBpcyBub3QgZGVmaW5lZCB5ZXQKCX0odHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiggd2luZG93LCBub0dsb2JhbCApIHsKCgkvLyBDYW4ndCBkbyB0aGlzIGJlY2F1c2Ugc2V2ZXJhbCBhcHBzIGluY2x1ZGluZyBBU1AuTkVUIHRyYWNlCgkvLyB0aGUgc3RhY2sgdmlhIGFyZ3VtZW50cy5jYWxsZXIuY2FsbGVlIGFuZCBGaXJlZm94IGRpZXMgaWYKCS8vIHlvdSB0cnkgdG8gdHJhY2UgdGhyb3VnaCAidXNlIHN0cmljdCIgY2FsbCBjaGFpbnMuICgjMTMzMzUpCgkvLyBTdXBwb3J0OiBGaXJlZm94IDE4KwoJLy8KCgl2YXIgZGVsZXRlZElkcyA9IFtdOwoKCXZhciBzbGljZSA9IGRlbGV0ZWRJZHMuc2xpY2U7CgoJdmFyIGNvbmNhdCA9IGRlbGV0ZWRJZHMuY29uY2F0OwoKCXZhciBwdXNoID0gZGVsZXRlZElkcy5wdXNoOwoKCXZhciBpbmRleE9mID0gZGVsZXRlZElkcy5pbmRleE9mOwoKCXZhciBjbGFzczJ0eXBlID0ge307CgoJdmFyIHRvU3RyaW5nID0gY2xhc3MydHlwZS50b1N0cmluZzsKCgl2YXIgaGFzT3duID0gY2xhc3MydHlwZS5oYXNPd25Qcm9wZXJ0eTsKCgl2YXIgc3VwcG9ydCA9IHt9OwoKCgoJdmFyCgkJdmVyc2lvbiA9ICIxLjExLjMiLAoKCQkvLyBEZWZpbmUgYSBsb2NhbCBjb3B5IG9mIGpRdWVyeQoJCWpRdWVyeSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHsKCQkJLy8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnCgkJCS8vIE5lZWQgaW5pdCBpZiBqUXVlcnkgaXMgY2FsbGVkIChqdXN0IGFsbG93IGVycm9yIHRvIGJlIHRocm93biBpZiBub3QgaW5jbHVkZWQpCgkJCXJldHVybiBuZXcgalF1ZXJ5LmZuLmluaXQoIHNlbGVjdG9yLCBjb250ZXh0ICk7CgkJfSwKCgkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIElFPDkKCQkvLyBNYWtlIHN1cmUgd2UgdHJpbSBCT00gYW5kIE5CU1AKCQlydHJpbSA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywKCgkJLy8gTWF0Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nCgkJcm1zUHJlZml4ID0gL14tbXMtLywKCQlyZGFzaEFscGhhID0gLy0oW1xkYS16XSkvZ2ksCgoJCS8vIFVzZWQgYnkgalF1ZXJ5LmNhbWVsQ2FzZSBhcyBjYWxsYmFjayB0byByZXBsYWNlKCkKCQlmY2FtZWxDYXNlID0gZnVuY3Rpb24oIGFsbCwgbGV0dGVyICkgewoJCQlyZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CgkJfTsKCglqUXVlcnkuZm4gPSBqUXVlcnkucHJvdG90eXBlID0gewoJCS8vIFRoZSBjdXJyZW50IHZlcnNpb24gb2YgalF1ZXJ5IGJlaW5nIHVzZWQKCQlqcXVlcnk6IHZlcnNpb24sCgoJCWNvbnN0cnVjdG9yOiBqUXVlcnksCgoJCS8vIFN0YXJ0IHdpdGggYW4gZW1wdHkgc2VsZWN0b3IKCQlzZWxlY3RvcjogIiIsCgoJCS8vIFRoZSBkZWZhdWx0IGxlbmd0aCBvZiBhIGpRdWVyeSBvYmplY3QgaXMgMAoJCWxlbmd0aDogMCwKCgkJdG9BcnJheTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBzbGljZS5jYWxsKCB0aGlzICk7CgkJfSwKCgkJLy8gR2V0IHRoZSBOdGggZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldCBPUgoJCS8vIEdldCB0aGUgd2hvbGUgbWF0Y2hlZCBlbGVtZW50IHNldCBhcyBhIGNsZWFuIGFycmF5CgkJZ2V0OiBmdW5jdGlvbiggbnVtICkgewoJCQlyZXR1cm4gbnVtICE9IG51bGwgPwoKCQkJCS8vIFJldHVybiBqdXN0IHRoZSBvbmUgZWxlbWVudCBmcm9tIHRoZSBzZXQKCQkJCSggbnVtIDwgMCA/IHRoaXNbIG51bSArIHRoaXMubGVuZ3RoIF0gOiB0aGlzWyBudW0gXSApIDoKCgkJCQkvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBpbiBhIGNsZWFuIGFycmF5CgkJCQlzbGljZS5jYWxsKCB0aGlzICk7CgkJfSwKCgkJLy8gVGFrZSBhbiBhcnJheSBvZiBlbGVtZW50cyBhbmQgcHVzaCBpdCBvbnRvIHRoZSBzdGFjawoJCS8vIChyZXR1cm5pbmcgdGhlIG5ldyBtYXRjaGVkIGVsZW1lbnQgc2V0KQoJCXB1c2hTdGFjazogZnVuY3Rpb24oIGVsZW1zICkgewoKCQkJLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKCQkJdmFyIHJldCA9IGpRdWVyeS5tZXJnZSggdGhpcy5jb25zdHJ1Y3RvcigpLCBlbGVtcyApOwoKCQkJLy8gQWRkIHRoZSBvbGQgb2JqZWN0IG9udG8gdGhlIHN0YWNrIChhcyBhIHJlZmVyZW5jZSkKCQkJcmV0LnByZXZPYmplY3QgPSB0aGlzOwoJCQlyZXQuY29udGV4dCA9IHRoaXMuY29udGV4dDsKCgkJCS8vIFJldHVybiB0aGUgbmV3bHktZm9ybWVkIGVsZW1lbnQgc2V0CgkJCXJldHVybiByZXQ7CgkJfSwKCgkJLy8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC4KCQkvLyAoWW91IGNhbiBzZWVkIHRoZSBhcmd1bWVudHMgd2l0aCBhbiBhcnJheSBvZiBhcmdzLCBidXQgdGhpcyBpcwoJCS8vIG9ubHkgdXNlZCBpbnRlcm5hbGx5LikKCQllYWNoOiBmdW5jdGlvbiggY2FsbGJhY2ssIGFyZ3MgKSB7CgkJCXJldHVybiBqUXVlcnkuZWFjaCggdGhpcywgY2FsbGJhY2ssIGFyZ3MgKTsKCQl9LAoKCQltYXA6IGZ1bmN0aW9uKCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkubWFwKHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBpICkgewoJCQkJcmV0dXJuIGNhbGxiYWNrLmNhbGwoIGVsZW0sIGksIGVsZW0gKTsKCQkJfSkpOwoJCX0sCgoJCXNsaWNlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBzbGljZS5hcHBseSggdGhpcywgYXJndW1lbnRzICkgKTsKCQl9LAoKCQlmaXJzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAwICk7CgkJfSwKCgkJbGFzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAtMSApOwoJCX0sCgoJCWVxOiBmdW5jdGlvbiggaSApIHsKCQkJdmFyIGxlbiA9IHRoaXMubGVuZ3RoLAoJCQkJaiA9ICtpICsgKCBpIDwgMCA/IGxlbiA6IDAgKTsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqID49IDAgJiYgaiA8IGxlbiA/IFsgdGhpc1tqXSBdIDogW10gKTsKCQl9LAoKCQllbmQ6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IobnVsbCk7CgkJfSwKCgkJLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgoJCS8vIEJlaGF2ZXMgbGlrZSBhbiBBcnJheSdzIG1ldGhvZCwgbm90IGxpa2UgYSBqUXVlcnkgbWV0aG9kLgoJCXB1c2g6IHB1c2gsCgkJc29ydDogZGVsZXRlZElkcy5zb3J0LAoJCXNwbGljZTogZGVsZXRlZElkcy5zcGxpY2UKCX07CgoJalF1ZXJ5LmV4dGVuZCA9IGpRdWVyeS5mbi5leHRlbmQgPSBmdW5jdGlvbigpIHsKCQl2YXIgc3JjLCBjb3B5SXNBcnJheSwgY29weSwgbmFtZSwgb3B0aW9ucywgY2xvbmUsCgkJCXRhcmdldCA9IGFyZ3VtZW50c1swXSB8fCB7fSwKCQkJaSA9IDEsCgkJCWxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsCgkJCWRlZXAgPSBmYWxzZTsKCgkJLy8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvbgoJCWlmICggdHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4iICkgewoJCQlkZWVwID0gdGFyZ2V0OwoKCQkJLy8gc2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldAoJCQl0YXJnZXQgPSBhcmd1bWVudHNbIGkgXSB8fCB7fTsKCQkJaSsrOwoJCX0KCgkJLy8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpCgkJaWYgKCB0eXBlb2YgdGFyZ2V0ICE9PSAib2JqZWN0IiAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24odGFyZ2V0KSApIHsKCQkJdGFyZ2V0ID0ge307CgkJfQoKCQkvLyBleHRlbmQgalF1ZXJ5IGl0c2VsZiBpZiBvbmx5IG9uZSBhcmd1bWVudCBpcyBwYXNzZWQKCQlpZiAoIGkgPT09IGxlbmd0aCApIHsKCQkJdGFyZ2V0ID0gdGhpczsKCQkJaS0tOwoJCX0KCgkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCS8vIE9ubHkgZGVhbCB3aXRoIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXMKCQkJaWYgKCAob3B0aW9ucyA9IGFyZ3VtZW50c1sgaSBdKSAhPSBudWxsICkgewoJCQkJLy8gRXh0ZW5kIHRoZSBiYXNlIG9iamVjdAoJCQkJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCQkJCXNyYyA9IHRhcmdldFsgbmFtZSBdOwoJCQkJCWNvcHkgPSBvcHRpb25zWyBuYW1lIF07CgoJCQkJCS8vIFByZXZlbnQgbmV2ZXItZW5kaW5nIGxvb3AKCQkJCQlpZiAoIHRhcmdldCA9PT0gY29weSApIHsKCQkJCQkJY29udGludWU7CgkJCQkJfQoKCQkJCQkvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKCQkJCQlpZiAoIGRlZXAgJiYgY29weSAmJiAoIGpRdWVyeS5pc1BsYWluT2JqZWN0KGNvcHkpIHx8IChjb3B5SXNBcnJheSA9IGpRdWVyeS5pc0FycmF5KGNvcHkpKSApICkgewoJCQkJCQlpZiAoIGNvcHlJc0FycmF5ICkgewoJCQkJCQkJY29weUlzQXJyYXkgPSBmYWxzZTsKCQkJCQkJCWNsb25lID0gc3JjICYmIGpRdWVyeS5pc0FycmF5KHNyYykgPyBzcmMgOiBbXTsKCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdChzcmMpID8gc3JjIDoge307CgkJCQkJCX0KCgkJCQkJCS8vIE5ldmVyIG1vdmUgb3JpZ2luYWwgb2JqZWN0cywgY2xvbmUgdGhlbQoJCQkJCQl0YXJnZXRbIG5hbWUgXSA9IGpRdWVyeS5leHRlbmQoIGRlZXAsIGNsb25lLCBjb3B5ICk7CgoJCQkJCS8vIERvbid0IGJyaW5nIGluIHVuZGVmaW5lZCB2YWx1ZXMKCQkJCQl9IGVsc2UgaWYgKCBjb3B5ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCXRhcmdldFsgbmFtZSBdID0gY29weTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIFJldHVybiB0aGUgbW9kaWZpZWQgb2JqZWN0CgkJcmV0dXJuIHRhcmdldDsKCX07CgoJalF1ZXJ5LmV4dGVuZCh7CgkJLy8gVW5pcXVlIGZvciBlYWNoIGNvcHkgb2YgalF1ZXJ5IG9uIHRoZSBwYWdlCgkJZXhwYW5kbzogImpRdWVyeSIgKyAoIHZlcnNpb24gKyBNYXRoLnJhbmRvbSgpICkucmVwbGFjZSggL1xEL2csICIiICksCgoJCS8vIEFzc3VtZSBqUXVlcnkgaXMgcmVhZHkgd2l0aG91dCB0aGUgcmVhZHkgbW9kdWxlCgkJaXNSZWFkeTogdHJ1ZSwKCgkJZXJyb3I6IGZ1bmN0aW9uKCBtc2cgKSB7CgkJCXRocm93IG5ldyBFcnJvciggbXNnICk7CgkJfSwKCgkJbm9vcDogZnVuY3Rpb24oKSB7fSwKCgkJLy8gU2VlIHRlc3QvdW5pdC9jb3JlLmpzIGZvciBkZXRhaWxzIGNvbmNlcm5pbmcgaXNGdW5jdGlvbi4KCQkvLyBTaW5jZSB2ZXJzaW9uIDEuMywgRE9NIG1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBsaWtlIGFsZXJ0CgkJLy8gYXJlbid0IHN1cHBvcnRlZC4gVGhleSByZXR1cm4gZmFsc2Ugb24gSUUgKCMyOTY4KS4KCQlpc0Z1bmN0aW9uOiBmdW5jdGlvbiggb2JqICkgewoJCQlyZXR1cm4galF1ZXJ5LnR5cGUob2JqKSA9PT0gImZ1bmN0aW9uIjsKCQl9LAoKCQlpc0FycmF5OiBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKCBvYmogKSB7CgkJCXJldHVybiBqUXVlcnkudHlwZShvYmopID09PSAiYXJyYXkiOwoJCX0sCgoJCWlzV2luZG93OiBmdW5jdGlvbiggb2JqICkgewoJCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCQlyZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09IG9iai53aW5kb3c7CgkJfSwKCgkJaXNOdW1lcmljOiBmdW5jdGlvbiggb2JqICkgewoJCQkvLyBwYXJzZUZsb2F0IE5hTnMgbnVtZXJpYy1jYXN0IGZhbHNlIHBvc2l0aXZlcyAobnVsbHx0cnVlfGZhbHNlfCIiKQoJCQkvLyAuLi5idXQgbWlzaW50ZXJwcmV0cyBsZWFkaW5nLW51bWJlciBzdHJpbmdzLCBwYXJ0aWN1bGFybHkgaGV4IGxpdGVyYWxzICgiMHguLi4iKQoJCQkvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU4KCQkJLy8gYWRkaW5nIDEgY29ycmVjdHMgbG9zcyBvZiBwcmVjaXNpb24gZnJvbSBwYXJzZUZsb2F0ICgjMTUxMDApCgkJCXJldHVybiAhalF1ZXJ5LmlzQXJyYXkoIG9iaiApICYmIChvYmogLSBwYXJzZUZsb2F0KCBvYmogKSArIDEpID49IDA7CgkJfSwKCgkJaXNFbXB0eU9iamVjdDogZnVuY3Rpb24oIG9iaiApIHsKCQkJdmFyIG5hbWU7CgkJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0sCgoJCWlzUGxhaW5PYmplY3Q6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCXZhciBrZXk7CgoJCQkvLyBNdXN0IGJlIGFuIE9iamVjdC4KCQkJLy8gQmVjYXVzZSBvZiBJRSwgd2UgYWxzbyBoYXZlIHRvIGNoZWNrIHRoZSBwcmVzZW5jZSBvZiB0aGUgY29uc3RydWN0b3IgcHJvcGVydHkuCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IERPTSBub2RlcyBhbmQgd2luZG93IG9iamVjdHMgZG9uJ3QgcGFzcyB0aHJvdWdoLCBhcyB3ZWxsCgkJCWlmICggIW9iaiB8fCBqUXVlcnkudHlwZShvYmopICE9PSAib2JqZWN0IiB8fCBvYmoubm9kZVR5cGUgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoKCQkJdHJ5IHsKCQkJCS8vIE5vdCBvd24gY29uc3RydWN0b3IgcHJvcGVydHkgbXVzdCBiZSBPYmplY3QKCQkJCWlmICggb2JqLmNvbnN0cnVjdG9yICYmCgkJCQkJIWhhc093bi5jYWxsKG9iaiwgImNvbnN0cnVjdG9yIikgJiYKCQkJCQkhaGFzT3duLmNhbGwob2JqLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwgImlzUHJvdG90eXBlT2YiKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0gY2F0Y2ggKCBlICkgewoJCQkJLy8gSUU4LDkgV2lsbCB0aHJvdyBleGNlcHRpb25zIG9uIGNlcnRhaW4gaG9zdCBvYmplY3RzICM5ODk3CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJLy8gSGFuZGxlIGl0ZXJhdGlvbiBvdmVyIGluaGVyaXRlZCBwcm9wZXJ0aWVzIGJlZm9yZSBvd24gcHJvcGVydGllcy4KCQkJaWYgKCBzdXBwb3J0Lm93bkxhc3QgKSB7CgkJCQlmb3IgKCBrZXkgaW4gb2JqICkgewoJCQkJCXJldHVybiBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQkJCX0KCQkJfQoKCQkJLy8gT3duIHByb3BlcnRpZXMgYXJlIGVudW1lcmF0ZWQgZmlyc3RseSwgc28gdG8gc3BlZWQgdXAsCgkJCS8vIGlmIGxhc3Qgb25lIGlzIG93biwgdGhlbiBhbGwgcHJvcGVydGllcyBhcmUgb3duLgoJCQlmb3IgKCBrZXkgaW4gb2JqICkge30KCgkJCXJldHVybiBrZXkgPT09IHVuZGVmaW5lZCB8fCBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQl9LAoKCQl0eXBlOiBmdW5jdGlvbiggb2JqICkgewoJCQlpZiAoIG9iaiA9PSBudWxsICkgewoJCQkJcmV0dXJuIG9iaiArICIiOwoJCQl9CgkJCXJldHVybiB0eXBlb2Ygb2JqID09PSAib2JqZWN0IiB8fCB0eXBlb2Ygb2JqID09PSAiZnVuY3Rpb24iID8KCQkJCWNsYXNzMnR5cGVbIHRvU3RyaW5nLmNhbGwob2JqKSBdIHx8ICJvYmplY3QiIDoKCQkJCXR5cGVvZiBvYmo7CgkJfSwKCgkJLy8gRXZhbHVhdGVzIGEgc2NyaXB0IGluIGEgZ2xvYmFsIGNvbnRleHQKCQkvLyBXb3JrYXJvdW5kcyBiYXNlZCBvbiBmaW5kaW5ncyBieSBKaW0gRHJpc2NvbGwKCQkvLyBodHRwOi8vd2VibG9ncy5qYXZhLm5ldC9ibG9nL2RyaXNjb2xsL2FyY2hpdmUvMjAwOS8wOS8wOC9ldmFsLWphdmFzY3JpcHQtZ2xvYmFsLWNvbnRleHQKCQlnbG9iYWxFdmFsOiBmdW5jdGlvbiggZGF0YSApIHsKCQkJaWYgKCBkYXRhICYmIGpRdWVyeS50cmltKCBkYXRhICkgKSB7CgkJCQkvLyBXZSB1c2UgZXhlY1NjcmlwdCBvbiBJbnRlcm5ldCBFeHBsb3JlcgoJCQkJLy8gV2UgdXNlIGFuIGFub255bW91cyBmdW5jdGlvbiBzbyB0aGF0IGNvbnRleHQgaXMgd2luZG93CgkJCQkvLyByYXRoZXIgdGhhbiBqUXVlcnkgaW4gRmlyZWZveAoJCQkJKCB3aW5kb3cuZXhlY1NjcmlwdCB8fCBmdW5jdGlvbiggZGF0YSApIHsKCQkJCQl3aW5kb3dbICJldmFsIiBdLmNhbGwoIHdpbmRvdywgZGF0YSApOwoJCQkJfSApKCBkYXRhICk7CgkJCX0KCQl9LAoKCQkvLyBDb252ZXJ0IGRhc2hlZCB0byBjYW1lbENhc2U7IHVzZWQgYnkgdGhlIGNzcyBhbmQgZGF0YSBtb2R1bGVzCgkJLy8gTWljcm9zb2Z0IGZvcmdvdCB0byBodW1wIHRoZWlyIHZlbmRvciBwcmVmaXggKCM5NTcyKQoJCWNhbWVsQ2FzZTogZnVuY3Rpb24oIHN0cmluZyApIHsKCQkJcmV0dXJuIHN0cmluZy5yZXBsYWNlKCBybXNQcmVmaXgsICJtcy0iICkucmVwbGFjZSggcmRhc2hBbHBoYSwgZmNhbWVsQ2FzZSApOwoJCX0sCgoJCW5vZGVOYW1lOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7CgkJfSwKCgkJLy8gYXJncyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seQoJCWVhY2g6IGZ1bmN0aW9uKCBvYmosIGNhbGxiYWNrLCBhcmdzICkgewoJCQl2YXIgdmFsdWUsCgkJCQlpID0gMCwKCQkJCWxlbmd0aCA9IG9iai5sZW5ndGgsCgkJCQlpc0FycmF5ID0gaXNBcnJheWxpa2UoIG9iaiApOwoKCQkJaWYgKCBhcmdzICkgewoJCQkJaWYgKCBpc0FycmF5ICkgewoJCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJCQl2YWx1ZSA9IGNhbGxiYWNrLmFwcGx5KCBvYmpbIGkgXSwgYXJncyApOwoKCQkJCQkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJZm9yICggaSBpbiBvYmogKSB7CgkJCQkJCXZhbHVlID0gY2FsbGJhY2suYXBwbHkoIG9ialsgaSBdLCBhcmdzICk7CgoJCQkJCQlpZiAoIHZhbHVlID09PSBmYWxzZSApIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJLy8gQSBzcGVjaWFsLCBmYXN0LCBjYXNlIGZvciB0aGUgbW9zdCBjb21tb24gdXNlIG9mIGVhY2gKCQkJfSBlbHNlIHsKCQkJCWlmICggaXNBcnJheSApIHsKCQkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCQkJdmFsdWUgPSBjYWxsYmFjay5jYWxsKCBvYmpbIGkgXSwgaSwgb2JqWyBpIF0gKTsKCgkJCQkJCWlmICggdmFsdWUgPT09IGZhbHNlICkgewoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWZvciAoIGkgaW4gb2JqICkgewoJCQkJCQl2YWx1ZSA9IGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApOwoKCQkJCQkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG9iajsKCQl9LAoKCQkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMSwgSUU8OQoJCXRyaW06IGZ1bmN0aW9uKCB0ZXh0ICkgewoJCQlyZXR1cm4gdGV4dCA9PSBudWxsID8KCQkJCSIiIDoKCQkJCSggdGV4dCArICIiICkucmVwbGFjZSggcnRyaW0sICIiICk7CgkJfSwKCgkJLy8gcmVzdWx0cyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seQoJCW1ha2VBcnJheTogZnVuY3Rpb24oIGFyciwgcmVzdWx0cyApIHsKCQkJdmFyIHJldCA9IHJlc3VsdHMgfHwgW107CgoJCQlpZiAoIGFyciAhPSBudWxsICkgewoJCQkJaWYgKCBpc0FycmF5bGlrZSggT2JqZWN0KGFycikgKSApIHsKCQkJCQlqUXVlcnkubWVyZ2UoIHJldCwKCQkJCQkJdHlwZW9mIGFyciA9PT0gInN0cmluZyIgPwoJCQkJCQlbIGFyciBdIDogYXJyCgkJCQkJKTsKCQkJCX0gZWxzZSB7CgkJCQkJcHVzaC5jYWxsKCByZXQsIGFyciApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gcmV0OwoJCX0sCgoJCWluQXJyYXk6IGZ1bmN0aW9uKCBlbGVtLCBhcnIsIGkgKSB7CgkJCXZhciBsZW47CgoJCQlpZiAoIGFyciApIHsKCQkJCWlmICggaW5kZXhPZiApIHsKCQkJCQlyZXR1cm4gaW5kZXhPZi5jYWxsKCBhcnIsIGVsZW0sIGkgKTsKCQkJCX0KCgkJCQlsZW4gPSBhcnIubGVuZ3RoOwoJCQkJaSA9IGkgPyBpIDwgMCA/IE1hdGgubWF4KCAwLCBsZW4gKyBpICkgOiBpIDogMDsKCgkJCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQkvLyBTa2lwIGFjY2Vzc2luZyBpbiBzcGFyc2UgYXJyYXlzCgkJCQkJaWYgKCBpIGluIGFyciAmJiBhcnJbIGkgXSA9PT0gZWxlbSApIHsKCQkJCQkJcmV0dXJuIGk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gLTE7CgkJfSwKCgkJbWVyZ2U6IGZ1bmN0aW9uKCBmaXJzdCwgc2Vjb25kICkgewoJCQl2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsCgkJCQlqID0gMCwKCQkJCWkgPSBmaXJzdC5sZW5ndGg7CgoJCQl3aGlsZSAoIGogPCBsZW4gKSB7CgkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGorKyBdOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIFdvcmthcm91bmQgY2FzdGluZyBvZiAubGVuZ3RoIHRvIE5hTiBvbiBvdGhlcndpc2UgYXJyYXlsaWtlIG9iamVjdHMgKGUuZy4sIE5vZGVMaXN0cykKCQkJaWYgKCBsZW4gIT09IGxlbiApIHsKCQkJCXdoaWxlICggc2Vjb25kW2pdICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJZmlyc3RbIGkrKyBdID0gc2Vjb25kWyBqKysgXTsKCQkJCX0KCQkJfQoKCQkJZmlyc3QubGVuZ3RoID0gaTsKCgkJCXJldHVybiBmaXJzdDsKCQl9LAoKCQlncmVwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBpbnZlcnQgKSB7CgkJCXZhciBjYWxsYmFja0ludmVyc2UsCgkJCQltYXRjaGVzID0gW10sCgkJCQlpID0gMCwKCQkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aCwKCQkJCWNhbGxiYWNrRXhwZWN0ID0gIWludmVydDsKCgkJCS8vIEdvIHRocm91Z2ggdGhlIGFycmF5LCBvbmx5IHNhdmluZyB0aGUgaXRlbXMKCQkJLy8gdGhhdCBwYXNzIHRoZSB2YWxpZGF0b3IgZnVuY3Rpb24KCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQljYWxsYmFja0ludmVyc2UgPSAhY2FsbGJhY2soIGVsZW1zWyBpIF0sIGkgKTsKCQkJCWlmICggY2FsbGJhY2tJbnZlcnNlICE9PSBjYWxsYmFja0V4cGVjdCApIHsKCQkJCQltYXRjaGVzLnB1c2goIGVsZW1zWyBpIF0gKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG1hdGNoZXM7CgkJfSwKCgkJLy8gYXJnIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CgkJbWFwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBhcmcgKSB7CgkJCXZhciB2YWx1ZSwKCQkJCWkgPSAwLAoJCQkJbGVuZ3RoID0gZWxlbXMubGVuZ3RoLAoJCQkJaXNBcnJheSA9IGlzQXJyYXlsaWtlKCBlbGVtcyApLAoJCQkJcmV0ID0gW107CgoJCQkvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgdHJhbnNsYXRpbmcgZWFjaCBvZiB0aGUgaXRlbXMgdG8gdGhlaXIgbmV3IHZhbHVlcwoJCQlpZiAoIGlzQXJyYXkgKSB7CgkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCQl2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTsKCgkJCQkJaWYgKCB2YWx1ZSAhPSBudWxsICkgewoJCQkJCQlyZXQucHVzaCggdmFsdWUgKTsKCQkJCQl9CgkJCQl9CgoJCQkvLyBHbyB0aHJvdWdoIGV2ZXJ5IGtleSBvbiB0aGUgb2JqZWN0LAoJCQl9IGVsc2UgewoJCQkJZm9yICggaSBpbiBlbGVtcyApIHsKCQkJCQl2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTsKCgkJCQkJaWYgKCB2YWx1ZSAhPSBudWxsICkgewoJCQkJCQlyZXQucHVzaCggdmFsdWUgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIEZsYXR0ZW4gYW55IG5lc3RlZCBhcnJheXMKCQkJcmV0dXJuIGNvbmNhdC5hcHBseSggW10sIHJldCApOwoJCX0sCgoJCS8vIEEgZ2xvYmFsIEdVSUQgY291bnRlciBmb3Igb2JqZWN0cwoJCWd1aWQ6IDEsCgoJCS8vIEJpbmQgYSBmdW5jdGlvbiB0byBhIGNvbnRleHQsIG9wdGlvbmFsbHkgcGFydGlhbGx5IGFwcGx5aW5nIGFueQoJCS8vIGFyZ3VtZW50cy4KCQlwcm94eTogZnVuY3Rpb24oIGZuLCBjb250ZXh0ICkgewoJCQl2YXIgYXJncywgcHJveHksIHRtcDsKCgkJCWlmICggdHlwZW9mIGNvbnRleHQgPT09ICJzdHJpbmciICkgewoJCQkJdG1wID0gZm5bIGNvbnRleHQgXTsKCQkJCWNvbnRleHQgPSBmbjsKCQkJCWZuID0gdG1wOwoJCQl9CgoJCQkvLyBRdWljayBjaGVjayB0byBkZXRlcm1pbmUgaWYgdGFyZ2V0IGlzIGNhbGxhYmxlLCBpbiB0aGUgc3BlYwoJCQkvLyB0aGlzIHRocm93cyBhIFR5cGVFcnJvciwgYnV0IHdlIHdpbGwganVzdCByZXR1cm4gdW5kZWZpbmVkLgoJCQlpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggZm4gKSApIHsKCQkJCXJldHVybiB1bmRlZmluZWQ7CgkJCX0KCgkJCS8vIFNpbXVsYXRlZCBiaW5kCgkJCWFyZ3MgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMsIDIgKTsKCQkJcHJveHkgPSBmdW5jdGlvbigpIHsKCQkJCXJldHVybiBmbi5hcHBseSggY29udGV4dCB8fCB0aGlzLCBhcmdzLmNvbmNhdCggc2xpY2UuY2FsbCggYXJndW1lbnRzICkgKSApOwoJCQl9OwoKCQkJLy8gU2V0IHRoZSBndWlkIG9mIHVuaXF1ZSBoYW5kbGVyIHRvIHRoZSBzYW1lIG9mIG9yaWdpbmFsIGhhbmRsZXIsIHNvIGl0IGNhbiBiZSByZW1vdmVkCgkJCXByb3h5Lmd1aWQgPSBmbi5ndWlkID0gZm4uZ3VpZCB8fCBqUXVlcnkuZ3VpZCsrOwoKCQkJcmV0dXJuIHByb3h5OwoJCX0sCgoJCW5vdzogZnVuY3Rpb24oKSB7CgkJCXJldHVybiArKCBuZXcgRGF0ZSgpICk7CgkJfSwKCgkJLy8galF1ZXJ5LnN1cHBvcnQgaXMgbm90IHVzZWQgaW4gQ29yZSBidXQgb3RoZXIgcHJvamVjdHMgYXR0YWNoIHRoZWlyCgkJLy8gcHJvcGVydGllcyB0byBpdCBzbyBpdCBuZWVkcyB0byBleGlzdC4KCQlzdXBwb3J0OiBzdXBwb3J0Cgl9KTsKCgkvLyBQb3B1bGF0ZSB0aGUgY2xhc3MydHlwZSBtYXAKCWpRdWVyeS5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIi5zcGxpdCgiICIpLCBmdW5jdGlvbihpLCBuYW1lKSB7CgkJY2xhc3MydHlwZVsgIltvYmplY3QgIiArIG5hbWUgKyAiXSIgXSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCX0pOwoKCWZ1bmN0aW9uIGlzQXJyYXlsaWtlKCBvYmogKSB7CgoJCS8vIFN1cHBvcnQ6IGlPUyA4LjIgKG5vdCByZXByb2R1Y2libGUgaW4gc2ltdWxhdG9yKQoJCS8vIGBpbmAgY2hlY2sgdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMjE0NSkKCQkvLyBoYXNPd24gaXNuJ3QgdXNlZCBoZXJlIGR1ZSB0byBmYWxzZSBuZWdhdGl2ZXMKCQkvLyByZWdhcmRpbmcgTm9kZWxpc3QgbGVuZ3RoIGluIElFCgkJdmFyIGxlbmd0aCA9ICJsZW5ndGgiIGluIG9iaiAmJiBvYmoubGVuZ3RoLAoJCQl0eXBlID0galF1ZXJ5LnR5cGUoIG9iaiApOwoKCQlpZiAoIHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJaWYgKCBvYmoubm9kZVR5cGUgPT09IDEgJiYgbGVuZ3RoICkgewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgoJCXJldHVybiB0eXBlID09PSAiYXJyYXkiIHx8IGxlbmd0aCA9PT0gMCB8fAoJCQl0eXBlb2YgbGVuZ3RoID09PSAibnVtYmVyIiAmJiBsZW5ndGggPiAwICYmICggbGVuZ3RoIC0gMSApIGluIG9iajsKCX0KCXZhciBTaXp6bGUgPQoJLyohCgkgKiBTaXp6bGUgQ1NTIFNlbGVjdG9yIEVuZ2luZSB2Mi4yLjAtcHJlCgkgKiBodHRwOi8vc2l6emxlanMuY29tLwoJICoKCSAqIENvcHlyaWdodCAyMDA4LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnMKCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQoJICoKCSAqIERhdGU6IDIwMTQtMTItMTYKCSAqLwoJKGZ1bmN0aW9uKCB3aW5kb3cgKSB7CgoJdmFyIGksCgkJc3VwcG9ydCwKCQlFeHByLAoJCWdldFRleHQsCgkJaXNYTUwsCgkJdG9rZW5pemUsCgkJY29tcGlsZSwKCQlzZWxlY3QsCgkJb3V0ZXJtb3N0Q29udGV4dCwKCQlzb3J0SW5wdXQsCgkJaGFzRHVwbGljYXRlLAoKCQkvLyBMb2NhbCBkb2N1bWVudCB2YXJzCgkJc2V0RG9jdW1lbnQsCgkJZG9jdW1lbnQsCgkJZG9jRWxlbSwKCQlkb2N1bWVudElzSFRNTCwKCQlyYnVnZ3lRU0EsCgkJcmJ1Z2d5TWF0Y2hlcywKCQltYXRjaGVzLAoJCWNvbnRhaW5zLAoKCQkvLyBJbnN0YW5jZS1zcGVjaWZpYyBkYXRhCgkJZXhwYW5kbyA9ICJzaXp6bGUiICsgMSAqIG5ldyBEYXRlKCksCgkJcHJlZmVycmVkRG9jID0gd2luZG93LmRvY3VtZW50LAoJCWRpcnJ1bnMgPSAwLAoJCWRvbmUgPSAwLAoJCWNsYXNzQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJCXRva2VuQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJCWNvbXBpbGVyQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJCXNvcnRPcmRlciA9IGZ1bmN0aW9uKCBhLCBiICkgewoJCQlpZiAoIGEgPT09IGIgKSB7CgkJCQloYXNEdXBsaWNhdGUgPSB0cnVlOwoJCQl9CgkJCXJldHVybiAwOwoJCX0sCgoJCS8vIEdlbmVyYWwtcHVycG9zZSBjb25zdGFudHMKCQlNQVhfTkVHQVRJVkUgPSAxIDw8IDMxLAoKCQkvLyBJbnN0YW5jZSBtZXRob2RzCgkJaGFzT3duID0gKHt9KS5oYXNPd25Qcm9wZXJ0eSwKCQlhcnIgPSBbXSwKCQlwb3AgPSBhcnIucG9wLAoJCXB1c2hfbmF0aXZlID0gYXJyLnB1c2gsCgkJcHVzaCA9IGFyci5wdXNoLAoJCXNsaWNlID0gYXJyLnNsaWNlLAoJCS8vIFVzZSBhIHN0cmlwcGVkLWRvd24gaW5kZXhPZiBhcyBpdCdzIGZhc3RlciB0aGFuIG5hdGl2ZQoJCS8vIGh0dHA6Ly9qc3BlcmYuY29tL3Rob3ItaW5kZXhvZi12cy1mb3IvNQoJCWluZGV4T2YgPSBmdW5jdGlvbiggbGlzdCwgZWxlbSApIHsKCQkJdmFyIGkgPSAwLAoJCQkJbGVuID0gbGlzdC5sZW5ndGg7CgkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQkJaWYgKCBsaXN0W2ldID09PSBlbGVtICkgewoJCQkJCXJldHVybiBpOwoJCQkJfQoJCQl9CgkJCXJldHVybiAtMTsKCQl9LAoKCQlib29sZWFucyA9ICJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsCgoJCS8vIFJlZ3VsYXIgZXhwcmVzc2lvbnMKCgkJLy8gV2hpdGVzcGFjZSBjaGFyYWN0ZXJzIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc2VsZWN0b3JzLyN3aGl0ZXNwYWNlCgkJd2hpdGVzcGFjZSA9ICJbXFx4MjBcXHRcXHJcXG5cXGZdIiwKCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXN5bnRheC8jY2hhcmFjdGVycwoJCWNoYXJhY3RlckVuY29kaW5nID0gIig/OlxcXFwufFtcXHctXXxbXlxceDAwLVxceGEwXSkrIiwKCgkJLy8gTG9vc2VseSBtb2RlbGVkIG9uIENTUyBpZGVudGlmaWVyIGNoYXJhY3RlcnMKCQkvLyBBbiB1bnF1b3RlZCB2YWx1ZSBzaG91bGQgYmUgYSBDU1MgaWRlbnRpZmllciBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jYXR0cmlidXRlLXNlbGVjdG9ycwoJCS8vIFByb3BlciBzeW50YXg6IGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCN2YWx1ZS1kZWYtaWRlbnRpZmllcgoJCWlkZW50aWZpZXIgPSBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCAidyIsICJ3IyIgKSwKCgkJLy8gQXR0cmlidXRlIHNlbGVjdG9yczogaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNhdHRyaWJ1dGUtc2VsZWN0b3JzCgkJYXR0cmlidXRlcyA9ICJcXFsiICsgd2hpdGVzcGFjZSArICIqKCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArICIpKD86IiArIHdoaXRlc3BhY2UgKwoJCQkvLyBPcGVyYXRvciAoY2FwdHVyZSAyKQoJCQkiKihbKl4kfCF+XT89KSIgKyB3aGl0ZXNwYWNlICsKCQkJLy8gIkF0dHJpYnV0ZSB2YWx1ZXMgbXVzdCBiZSBDU1MgaWRlbnRpZmllcnMgW2NhcHR1cmUgNV0gb3Igc3RyaW5ncyBbY2FwdHVyZSAzIG9yIGNhcHR1cmUgNF0iCgkJCSIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIgKyBpZGVudGlmaWVyICsgIikpfCkiICsgd2hpdGVzcGFjZSArCgkJCSIqXFxdIiwKCgkJcHNldWRvcyA9ICI6KCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArICIpKD86XFwoKCIgKwoJCQkvLyBUbyByZWR1Y2UgdGhlIG51bWJlciBvZiBzZWxlY3RvcnMgbmVlZGluZyB0b2tlbml6ZSBpbiB0aGUgcHJlRmlsdGVyLCBwcmVmZXIgYXJndW1lbnRzOgoJCQkvLyAxLiBxdW90ZWQgKGNhcHR1cmUgMzsgY2FwdHVyZSA0IG9yIGNhcHR1cmUgNSkKCQkJIignKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8IiArCgkJCS8vIDIuIHNpbXBsZSAoY2FwdHVyZSA2KQoJCQkiKCg/OlxcXFwufFteXFxcXCgpW1xcXV18IiArIGF0dHJpYnV0ZXMgKyAiKSopfCIgKwoJCQkvLyAzLiBhbnl0aGluZyBlbHNlIChjYXB0dXJlIDIpCgkJCSIuKiIgKwoJCQkiKVxcKXwpIiwKCgkJLy8gTGVhZGluZyBhbmQgbm9uLWVzY2FwZWQgdHJhaWxpbmcgd2hpdGVzcGFjZSwgY2FwdHVyaW5nIHNvbWUgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBwcmVjZWRpbmcgdGhlIGxhdHRlcgoJCXJ3aGl0ZXNwYWNlID0gbmV3IFJlZ0V4cCggd2hpdGVzcGFjZSArICIrIiwgImciICksCgkJcnRyaW0gPSBuZXcgUmVnRXhwKCAiXiIgKyB3aGl0ZXNwYWNlICsgIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIgKyB3aGl0ZXNwYWNlICsgIiskIiwgImciICksCgoJCXJjb21tYSA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKiwiICsgd2hpdGVzcGFjZSArICIqIiApLAoJCXJjb21iaW5hdG9ycyA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKihbPit+XXwiICsgd2hpdGVzcGFjZSArICIpIiArIHdoaXRlc3BhY2UgKyAiKiIgKSwKCgkJcmF0dHJpYnV0ZVF1b3RlcyA9IG5ldyBSZWdFeHAoICI9IiArIHdoaXRlc3BhY2UgKyAiKihbXlxcXSdcIl0qPykiICsgd2hpdGVzcGFjZSArICIqXFxdIiwgImciICksCgoJCXJwc2V1ZG8gPSBuZXcgUmVnRXhwKCBwc2V1ZG9zICksCgkJcmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCAiXiIgKyBpZGVudGlmaWVyICsgIiQiICksCgoJCW1hdGNoRXhwciA9IHsKCQkJIklEIjogbmV3IFJlZ0V4cCggIl4jKCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArICIpIiApLAoJCQkiQ0xBU1MiOiBuZXcgUmVnRXhwKCAiXlxcLigiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyAiKSIgKSwKCQkJIlRBRyI6IG5ldyBSZWdFeHAoICJeKCIgKyBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCAidyIsICJ3KiIgKSArICIpIiApLAoJCQkiQVRUUiI6IG5ldyBSZWdFeHAoICJeIiArIGF0dHJpYnV0ZXMgKSwKCQkJIlBTRVVETyI6IG5ldyBSZWdFeHAoICJeIiArIHBzZXVkb3MgKSwKCQkJIkNISUxEIjogbmV3IFJlZ0V4cCggIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIgKyB3aGl0ZXNwYWNlICsKCQkJCSIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIiArIHdoaXRlc3BhY2UgKyAiKig/OihbKy1dfCkiICsgd2hpdGVzcGFjZSArCgkJCQkiKihcXGQrKXwpKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSIsICJpIiApLAoJCQkiYm9vbCI6IG5ldyBSZWdFeHAoICJeKD86IiArIGJvb2xlYW5zICsgIikkIiwgImkiICksCgkJCS8vIEZvciB1c2UgaW4gbGlicmFyaWVzIGltcGxlbWVudGluZyAuaXMoKQoJCQkvLyBXZSB1c2UgdGhpcyBmb3IgUE9TIG1hdGNoaW5nIGluIGBzZWxlY3RgCgkJCSJuZWVkc0NvbnRleHQiOiBuZXcgUmVnRXhwKCAiXiIgKyB3aGl0ZXNwYWNlICsgIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIgKwoJCQkJd2hpdGVzcGFjZSArICIqKCg/Oi1cXGQpP1xcZCopIiArIHdoaXRlc3BhY2UgKyAiKlxcKXwpKD89W14tXXwkKSIsICJpIiApCgkJfSwKCgkJcmlucHV0cyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksCgkJcmhlYWRlciA9IC9eaFxkJC9pLAoKCQlybmF0aXZlID0gL15bXntdK1x7XHMqXFtuYXRpdmUgXHcvLAoKCQkvLyBFYXNpbHktcGFyc2VhYmxlL3JldHJpZXZhYmxlIElEIG9yIFRBRyBvciBDTEFTUyBzZWxlY3RvcnMKCQlycXVpY2tFeHByID0gL14oPzojKFtcdy1dKyl8KFx3Kyl8XC4oW1x3LV0rKSkkLywKCgkJcnNpYmxpbmcgPSAvWyt+XS8sCgkJcmVzY2FwZSA9IC8nfFxcL2csCgoJCS8vIENTUyBlc2NhcGVzIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCNlc2NhcGVkLWNoYXJhY3RlcnMKCQlydW5lc2NhcGUgPSBuZXcgUmVnRXhwKCAiXFxcXChbXFxkYS1mXXsxLDZ9IiArIHdoaXRlc3BhY2UgKyAiP3woIiArIHdoaXRlc3BhY2UgKyAiKXwuKSIsICJpZyIgKSwKCQlmdW5lc2NhcGUgPSBmdW5jdGlvbiggXywgZXNjYXBlZCwgZXNjYXBlZFdoaXRlc3BhY2UgKSB7CgkJCXZhciBoaWdoID0gIjB4IiArIGVzY2FwZWQgLSAweDEwMDAwOwoJCQkvLyBOYU4gbWVhbnMgbg==", "base64"));
  res.write(new Buffer("b24tY29kZXBvaW50CgkJCS8vIFN1cHBvcnQ6IEZpcmVmb3g8MjQKCQkJLy8gV29ya2Fyb3VuZCBlcnJvbmVvdXMgbnVtZXJpYyBpbnRlcnByZXRhdGlvbiBvZiArIjB4IgoJCQlyZXR1cm4gaGlnaCAhPT0gaGlnaCB8fCBlc2NhcGVkV2hpdGVzcGFjZSA/CgkJCQllc2NhcGVkIDoKCQkJCWhpZ2ggPCAwID8KCQkJCQkvLyBCTVAgY29kZXBvaW50CgkJCQkJU3RyaW5nLmZyb21DaGFyQ29kZSggaGlnaCArIDB4MTAwMDAgKSA6CgkJCQkJLy8gU3VwcGxlbWVudGFsIFBsYW5lIGNvZGVwb2ludCAoc3Vycm9nYXRlIHBhaXIpCgkJCQkJU3RyaW5nLmZyb21DaGFyQ29kZSggaGlnaCA+PiAxMCB8IDB4RDgwMCwgaGlnaCAmIDB4M0ZGIHwgMHhEQzAwICk7CgkJfSwKCgkJLy8gVXNlZCBmb3IgaWZyYW1lcwoJCS8vIFNlZSBzZXREb2N1bWVudCgpCgkJLy8gUmVtb3ZpbmcgdGhlIGZ1bmN0aW9uIHdyYXBwZXIgY2F1c2VzIGEgIlBlcm1pc3Npb24gRGVuaWVkIgoJCS8vIGVycm9yIGluIElFCgkJdW5sb2FkSGFuZGxlciA9IGZ1bmN0aW9uKCkgewoJCQlzZXREb2N1bWVudCgpOwoJCX07CgoJLy8gT3B0aW1pemUgZm9yIHB1c2guYXBwbHkoIF8sIE5vZGVMaXN0ICkKCXRyeSB7CgkJcHVzaC5hcHBseSgKCQkJKGFyciA9IHNsaWNlLmNhbGwoIHByZWZlcnJlZERvYy5jaGlsZE5vZGVzICkpLAoJCQlwcmVmZXJyZWREb2MuY2hpbGROb2RlcwoJCSk7CgkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjAKCQkvLyBEZXRlY3Qgc2lsZW50bHkgZmFpbGluZyBwdXNoLmFwcGx5CgkJYXJyWyBwcmVmZXJyZWREb2MuY2hpbGROb2Rlcy5sZW5ndGggXS5ub2RlVHlwZTsKCX0gY2F0Y2ggKCBlICkgewoJCXB1c2ggPSB7IGFwcGx5OiBhcnIubGVuZ3RoID8KCgkJCS8vIExldmVyYWdlIHNsaWNlIGlmIHBvc3NpYmxlCgkJCWZ1bmN0aW9uKCB0YXJnZXQsIGVscyApIHsKCQkJCXB1c2hfbmF0aXZlLmFwcGx5KCB0YXJnZXQsIHNsaWNlLmNhbGwoZWxzKSApOwoJCQl9IDoKCgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJLy8gT3RoZXJ3aXNlIGFwcGVuZCBkaXJlY3RseQoJCQlmdW5jdGlvbiggdGFyZ2V0LCBlbHMgKSB7CgkJCQl2YXIgaiA9IHRhcmdldC5sZW5ndGgsCgkJCQkJaSA9IDA7CgkJCQkvLyBDYW4ndCB0cnVzdCBOb2RlTGlzdC5sZW5ndGgKCQkJCXdoaWxlICggKHRhcmdldFtqKytdID0gZWxzW2krK10pICkge30KCQkJCXRhcmdldC5sZW5ndGggPSBqIC0gMTsKCQkJfQoJCX07Cgl9CgoJZnVuY3Rpb24gU2l6emxlKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHsKCQl2YXIgbWF0Y2gsIGVsZW0sIG0sIG5vZGVUeXBlLAoJCQkvLyBRU0EgdmFycwoJCQlpLCBncm91cHMsIG9sZCwgbmlkLCBuZXdDb250ZXh0LCBuZXdTZWxlY3RvcjsKCgkJaWYgKCAoIGNvbnRleHQgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IHByZWZlcnJlZERvYyApICE9PSBkb2N1bWVudCApIHsKCQkJc2V0RG9jdW1lbnQoIGNvbnRleHQgKTsKCQl9CgoJCWNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50OwoJCXJlc3VsdHMgPSByZXN1bHRzIHx8IFtdOwoJCW5vZGVUeXBlID0gY29udGV4dC5ub2RlVHlwZTsKCgkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciIHx8ICFzZWxlY3RvciB8fAoJCQlub2RlVHlwZSAhPT0gMSAmJiBub2RlVHlwZSAhPT0gOSAmJiBub2RlVHlwZSAhPT0gMTEgKSB7CgoJCQlyZXR1cm4gcmVzdWx0czsKCQl9CgoJCWlmICggIXNlZWQgJiYgZG9jdW1lbnRJc0hUTUwgKSB7CgoJCQkvLyBUcnkgdG8gc2hvcnRjdXQgZmluZCBvcGVyYXRpb25zIHdoZW4gcG9zc2libGUgKGUuZy4sIG5vdCB1bmRlciBEb2N1bWVudEZyYWdtZW50KQoJCQlpZiAoIG5vZGVUeXBlICE9PSAxMSAmJiAobWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoIHNlbGVjdG9yICkpICkgewoJCQkJLy8gU3BlZWQtdXA6IFNpenpsZSgiI0lEIikKCQkJCWlmICggKG0gPSBtYXRjaFsxXSkgKSB7CgkJCQkJaWYgKCBub2RlVHlwZSA9PT0gOSApIHsKCQkJCQkJZWxlbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIG0gKTsKCQkJCQkJLy8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnMKCQkJCQkJLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAoalF1ZXJ5ICM2OTYzKQoJCQkJCQlpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkgewoJCQkJCQkJLy8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIElFLCBPcGVyYSwgYW5kIFdlYmtpdCByZXR1cm4gaXRlbXMKCQkJCQkJCS8vIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAoJCQkJCQkJaWYgKCBlbGVtLmlkID09PSBtICkgewoJCQkJCQkJCXJlc3VsdHMucHVzaCggZWxlbSApOwoJCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQkJfQoJCQkJCQl9IGVsc2UgewoJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCX0KCQkJCQl9IGVsc2UgewoJCQkJCQkvLyBDb250ZXh0IGlzIG5vdCBhIGRvY3VtZW50CgkJCQkJCWlmICggY29udGV4dC5vd25lckRvY3VtZW50ICYmIChlbGVtID0gY29udGV4dC5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBtICkpICYmCgkJCQkJCQljb250YWlucyggY29udGV4dCwgZWxlbSApICYmIGVsZW0uaWQgPT09IG0gKSB7CgkJCQkJCQlyZXN1bHRzLnB1c2goIGVsZW0gKTsKCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQl9CgkJCQkJfQoKCQkJCS8vIFNwZWVkLXVwOiBTaXp6bGUoIlRBRyIpCgkJCQl9IGVsc2UgaWYgKCBtYXRjaFsyXSApIHsKCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCBzZWxlY3RvciApICk7CgkJCQkJcmV0dXJuIHJlc3VsdHM7CgoJCQkJLy8gU3BlZWQtdXA6IFNpenpsZSgiLkNMQVNTIikKCQkJCX0gZWxzZSBpZiAoIChtID0gbWF0Y2hbM10pICYmIHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApIHsKCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIG0gKSApOwoJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJfQoJCQl9CgoJCQkvLyBRU0EgcGF0aAoJCQlpZiAoIHN1cHBvcnQucXNhICYmICghcmJ1Z2d5UVNBIHx8ICFyYnVnZ3lRU0EudGVzdCggc2VsZWN0b3IgKSkgKSB7CgkJCQluaWQgPSBvbGQgPSBleHBhbmRvOwoJCQkJbmV3Q29udGV4dCA9IGNvbnRleHQ7CgkJCQluZXdTZWxlY3RvciA9IG5vZGVUeXBlICE9PSAxICYmIHNlbGVjdG9yOwoKCQkJCS8vIHFTQSB3b3JrcyBzdHJhbmdlbHkgb24gRWxlbWVudC1yb290ZWQgcXVlcmllcwoJCQkJLy8gV2UgY2FuIHdvcmsgYXJvdW5kIHRoaXMgYnkgc3BlY2lmeWluZyBhbiBleHRyYSBJRCBvbiB0aGUgcm9vdAoJCQkJLy8gYW5kIHdvcmtpbmcgdXAgZnJvbSB0aGVyZSAoVGhhbmtzIHRvIEFuZHJldyBEdXBvbnQgZm9yIHRoZSB0ZWNobmlxdWUpCgkJCQkvLyBJRSA4IGRvZXNuJ3Qgd29yayBvbiBvYmplY3QgZWxlbWVudHMKCQkJCWlmICggbm9kZVR5cGUgPT09IDEgJiYgY29udGV4dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAib2JqZWN0IiApIHsKCQkJCQlncm91cHMgPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCgkJCQkJaWYgKCAob2xkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoImlkIikpICkgewoJCQkJCQluaWQgPSBvbGQucmVwbGFjZSggcmVzY2FwZSwgIlxcJCYiICk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJY29udGV4dC5zZXRBdHRyaWJ1dGUoICJpZCIsIG5pZCApOwoJCQkJCX0KCQkJCQluaWQgPSAiW2lkPSciICsgbmlkICsgIiddICI7CgoJCQkJCWkgPSBncm91cHMubGVuZ3RoOwoJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQlncm91cHNbaV0gPSBuaWQgKyB0b1NlbGVjdG9yKCBncm91cHNbaV0gKTsKCQkJCQl9CgkJCQkJbmV3Q29udGV4dCA9IHJzaWJsaW5nLnRlc3QoIHNlbGVjdG9yICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8IGNvbnRleHQ7CgkJCQkJbmV3U2VsZWN0b3IgPSBncm91cHMuam9pbigiLCIpOwoJCQkJfQoKCQkJCWlmICggbmV3U2VsZWN0b3IgKSB7CgkJCQkJdHJ5IHsKCQkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywKCQkJCQkJCW5ld0NvbnRleHQucXVlcnlTZWxlY3RvckFsbCggbmV3U2VsZWN0b3IgKQoJCQkJCQkpOwoJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQl9IGNhdGNoKHFzYUVycm9yKSB7CgkJCQkJfSBmaW5hbGx5IHsKCQkJCQkJaWYgKCAhb2xkICkgewoJCQkJCQkJY29udGV4dC5yZW1vdmVBdHRyaWJ1dGUoImlkIik7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIEFsbCBvdGhlcnMKCQlyZXR1cm4gc2VsZWN0KCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgIiQxIiApLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICk7Cgl9CgoJLyoqCgkgKiBDcmVhdGUga2V5LXZhbHVlIGNhY2hlcyBvZiBsaW1pdGVkIHNpemUKCSAqIEByZXR1cm5zIHtGdW5jdGlvbihzdHJpbmcsIE9iamVjdCl9IFJldHVybnMgdGhlIE9iamVjdCBkYXRhIGFmdGVyIHN0b3JpbmcgaXQgb24gaXRzZWxmIHdpdGgKCSAqCXByb3BlcnR5IG5hbWUgdGhlIChzcGFjZS1zdWZmaXhlZCkgc3RyaW5nIGFuZCAoaWYgdGhlIGNhY2hlIGlzIGxhcmdlciB0aGFuIEV4cHIuY2FjaGVMZW5ndGgpCgkgKglkZWxldGluZyB0aGUgb2xkZXN0IGVudHJ5CgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkgewoJCXZhciBrZXlzID0gW107CgoJCWZ1bmN0aW9uIGNhY2hlKCBrZXksIHZhbHVlICkgewoJCQkvLyBVc2UgKGtleSArICIgIikgdG8gYXZvaWQgY29sbGlzaW9uIHdpdGggbmF0aXZlIHByb3RvdHlwZSBwcm9wZXJ0aWVzIChzZWUgSXNzdWUgIzE1NykKCQkJaWYgKCBrZXlzLnB1c2goIGtleSArICIgIiApID4gRXhwci5jYWNoZUxlbmd0aCApIHsKCQkJCS8vIE9ubHkga2VlcCB0aGUgbW9zdCByZWNlbnQgZW50cmllcwoJCQkJZGVsZXRlIGNhY2hlWyBrZXlzLnNoaWZ0KCkgXTsKCQkJfQoJCQlyZXR1cm4gKGNhY2hlWyBrZXkgKyAiICIgXSA9IHZhbHVlKTsKCQl9CgkJcmV0dXJuIGNhY2hlOwoJfQoKCS8qKgoJICogTWFyayBhIGZ1bmN0aW9uIGZvciBzcGVjaWFsIHVzZSBieSBTaXp6bGUKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBtYXJrCgkgKi8KCWZ1bmN0aW9uIG1hcmtGdW5jdGlvbiggZm4gKSB7CgkJZm5bIGV4cGFuZG8gXSA9IHRydWU7CgkJcmV0dXJuIGZuOwoJfQoKCS8qKgoJICogU3VwcG9ydCB0ZXN0aW5nIHVzaW5nIGFuIGVsZW1lbnQKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFBhc3NlZCB0aGUgY3JlYXRlZCBkaXYgYW5kIGV4cGVjdHMgYSBib29sZWFuIHJlc3VsdAoJICovCglmdW5jdGlvbiBhc3NlcnQoIGZuICkgewoJCXZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKCgkJdHJ5IHsKCQkJcmV0dXJuICEhZm4oIGRpdiApOwoJCX0gY2F0Y2ggKGUpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0gZmluYWxseSB7CgkJCS8vIFJlbW92ZSBmcm9tIGl0cyBwYXJlbnQgYnkgZGVmYXVsdAoJCQlpZiAoIGRpdi5wYXJlbnROb2RlICkgewoJCQkJZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGRpdiApOwoJCQl9CgkJCS8vIHJlbGVhc2UgbWVtb3J5IGluIElFCgkJCWRpdiA9IG51bGw7CgkJfQoJfQoKCS8qKgoJICogQWRkcyB0aGUgc2FtZSBoYW5kbGVyIGZvciBhbGwgb2YgdGhlIHNwZWNpZmllZCBhdHRycwoJICogQHBhcmFtIHtTdHJpbmd9IGF0dHJzIFBpcGUtc2VwYXJhdGVkIGxpc3Qgb2YgYXR0cmlidXRlcwoJICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciBUaGUgbWV0aG9kIHRoYXQgd2lsbCBiZSBhcHBsaWVkCgkgKi8KCWZ1bmN0aW9uIGFkZEhhbmRsZSggYXR0cnMsIGhhbmRsZXIgKSB7CgkJdmFyIGFyciA9IGF0dHJzLnNwbGl0KCJ8IiksCgkJCWkgPSBhdHRycy5sZW5ndGg7CgoJCXdoaWxlICggaS0tICkgewoJCQlFeHByLmF0dHJIYW5kbGVbIGFycltpXSBdID0gaGFuZGxlcjsKCQl9Cgl9CgoJLyoqCgkgKiBDaGVja3MgZG9jdW1lbnQgb3JkZXIgb2YgdHdvIHNpYmxpbmdzCgkgKiBAcGFyYW0ge0VsZW1lbnR9IGEKCSAqIEBwYXJhbSB7RWxlbWVudH0gYgoJICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyBsZXNzIHRoYW4gMCBpZiBhIHByZWNlZGVzIGIsIGdyZWF0ZXIgdGhhbiAwIGlmIGEgZm9sbG93cyBiCgkgKi8KCWZ1bmN0aW9uIHNpYmxpbmdDaGVjayggYSwgYiApIHsKCQl2YXIgY3VyID0gYiAmJiBhLAoJCQlkaWZmID0gY3VyICYmIGEubm9kZVR5cGUgPT09IDEgJiYgYi5ub2RlVHlwZSA9PT0gMSAmJgoJCQkJKCB+Yi5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKSAtCgkJCQkoIH5hLnNvdXJjZUluZGV4IHx8IE1BWF9ORUdBVElWRSApOwoKCQkvLyBVc2UgSUUgc291cmNlSW5kZXggaWYgYXZhaWxhYmxlIG9uIGJvdGggbm9kZXMKCQlpZiAoIGRpZmYgKSB7CgkJCXJldHVybiBkaWZmOwoJCX0KCgkJLy8gQ2hlY2sgaWYgYiBmb2xsb3dzIGEKCQlpZiAoIGN1ciApIHsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLm5leHRTaWJsaW5nKSApIHsKCQkJCWlmICggY3VyID09PSBiICkgewoJCQkJCXJldHVybiAtMTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIGEgPyAxIDogLTE7Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGlucHV0IHR5cGVzCgkgKiBAcGFyYW0ge1N0cmluZ30gdHlwZQoJICovCglmdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyggdHlwZSApIHsKCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gbmFtZSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09IHR5cGU7CgkJfTsKCX0KCgkvKioKCSAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgYnV0dG9ucwoJICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKCSAqLwoJZnVuY3Rpb24gY3JlYXRlQnV0dG9uUHNldWRvKCB0eXBlICkgewoJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCXJldHVybiAobmFtZSA9PT0gImlucHV0IiB8fCBuYW1lID09PSAiYnV0dG9uIikgJiYgZWxlbS50eXBlID09PSB0eXBlOwoJCX07Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIHBvc2l0aW9uYWxzCgkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbgoJICovCglmdW5jdGlvbiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKCBmbiApIHsKCQlyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBhcmd1bWVudCApIHsKCQkJYXJndW1lbnQgPSArYXJndW1lbnQ7CgkJCXJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMgKSB7CgkJCQl2YXIgaiwKCQkJCQltYXRjaEluZGV4ZXMgPSBmbiggW10sIHNlZWQubGVuZ3RoLCBhcmd1bWVudCApLAoJCQkJCWkgPSBtYXRjaEluZGV4ZXMubGVuZ3RoOwoKCQkJCS8vIE1hdGNoIGVsZW1lbnRzIGZvdW5kIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXhlcwoJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJaWYgKCBzZWVkWyAoaiA9IG1hdGNoSW5kZXhlc1tpXSkgXSApIHsKCQkJCQkJc2VlZFtqXSA9ICEobWF0Y2hlc1tqXSA9IHNlZWRbal0pOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfSk7Cgl9CgoJLyoqCgkgKiBDaGVja3MgYSBub2RlIGZvciB2YWxpZGl0eSBhcyBhIFNpenpsZSBjb250ZXh0CgkgKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0PX0gY29udGV4dAoJICogQHJldHVybnMge0VsZW1lbnR8T2JqZWN0fEJvb2xlYW59IFRoZSBpbnB1dCBub2RlIGlmIGFjY2VwdGFibGUsIG90aGVyd2lzZSBhIGZhbHN5IHZhbHVlCgkgKi8KCWZ1bmN0aW9uIHRlc3RDb250ZXh0KCBjb250ZXh0ICkgewoJCXJldHVybiBjb250ZXh0ICYmIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIiAmJiBjb250ZXh0OwoJfQoKCS8vIEV4cG9zZSBzdXBwb3J0IHZhcnMgZm9yIGNvbnZlbmllbmNlCglzdXBwb3J0ID0gU2l6emxlLnN1cHBvcnQgPSB7fTsKCgkvKioKCSAqIERldGVjdHMgWE1MIG5vZGVzCgkgKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBlbGVtIEFuIGVsZW1lbnQgb3IgYSBkb2N1bWVudAoJICogQHJldHVybnMge0Jvb2xlYW59IFRydWUgaWZmIGVsZW0gaXMgYSBub24tSFRNTCBYTUwgbm9kZQoJICovCglpc1hNTCA9IFNpenpsZS5pc1hNTCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCS8vIGRvY3VtZW50RWxlbWVudCBpcyB2ZXJpZmllZCBmb3IgY2FzZXMgd2hlcmUgaXQgZG9lc24ndCB5ZXQgZXhpc3QKCQkvLyAoc3VjaCBhcyBsb2FkaW5nIGlmcmFtZXMgaW4gSUUgLSAjNDgzMykKCQl2YXIgZG9jdW1lbnRFbGVtZW50ID0gZWxlbSAmJiAoZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0pLmRvY3VtZW50RWxlbWVudDsKCQlyZXR1cm4gZG9jdW1lbnRFbGVtZW50ID8gZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lICE9PSAiSFRNTCIgOiBmYWxzZTsKCX07CgoJLyoqCgkgKiBTZXRzIGRvY3VtZW50LXJlbGF0ZWQgdmFyaWFibGVzIG9uY2UgYmFzZWQgb24gdGhlIGN1cnJlbnQgZG9jdW1lbnQKCSAqIEBwYXJhbSB7RWxlbWVudHxPYmplY3R9IFtkb2NdIEFuIGVsZW1lbnQgb3IgZG9jdW1lbnQgb2JqZWN0IHRvIHVzZSB0byBzZXQgdGhlIGRvY3VtZW50CgkgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjdXJyZW50IGRvY3VtZW50CgkgKi8KCXNldERvY3VtZW50ID0gU2l6emxlLnNldERvY3VtZW50ID0gZnVuY3Rpb24oIG5vZGUgKSB7CgkJdmFyIGhhc0NvbXBhcmUsIHBhcmVudCwKCQkJZG9jID0gbm9kZSA/IG5vZGUub3duZXJEb2N1bWVudCB8fCBub2RlIDogcHJlZmVycmVkRG9jOwoKCQkvLyBJZiBubyBkb2N1bWVudCBhbmQgZG9jdW1lbnRFbGVtZW50IGlzIGF2YWlsYWJsZSwgcmV0dXJuCgkJaWYgKCBkb2MgPT09IGRvY3VtZW50IHx8IGRvYy5ub2RlVHlwZSAhPT0gOSB8fCAhZG9jLmRvY3VtZW50RWxlbWVudCApIHsKCQkJcmV0dXJuIGRvY3VtZW50OwoJCX0KCgkJLy8gU2V0IG91ciBkb2N1bWVudAoJCWRvY3VtZW50ID0gZG9jOwoJCWRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50OwoJCXBhcmVudCA9IGRvYy5kZWZhdWx0VmlldzsKCgkJLy8gU3VwcG9ydDogSUU+OAoJCS8vIElmIGlmcmFtZSBkb2N1bWVudCBpcyBhc3NpZ25lZCB0byAiZG9jdW1lbnQiIHZhcmlhYmxlIGFuZCBpZiBpZnJhbWUgaGFzIGJlZW4gcmVsb2FkZWQsCgkJLy8gSUUgd2lsbCB0aHJvdyAicGVybWlzc2lvbiBkZW5pZWQiIGVycm9yIHdoZW4gYWNjZXNzaW5nICJkb2N1bWVudCIgdmFyaWFibGUsIHNlZSBqUXVlcnkgIzEzOTM2CgkJLy8gSUU2LTggZG8gbm90IHN1cHBvcnQgdGhlIGRlZmF1bHRWaWV3IHByb3BlcnR5IHNvIHBhcmVudCB3aWxsIGJlIHVuZGVmaW5lZAoJCWlmICggcGFyZW50ICYmIHBhcmVudCAhPT0gcGFyZW50LnRvcCApIHsKCQkJLy8gSUUxMSBkb2VzIG5vdCBoYXZlIGF0dGFjaEV2ZW50LCBzbyBhbGwgbXVzdCBzdWZmZXIKCQkJaWYgKCBwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciApIHsKCQkJCXBhcmVudC5hZGRFdmVudExpc3RlbmVyKCAidW5sb2FkIiwgdW5sb2FkSGFuZGxlciwgZmFsc2UgKTsKCQkJfSBlbHNlIGlmICggcGFyZW50LmF0dGFjaEV2ZW50ICkgewoJCQkJcGFyZW50LmF0dGFjaEV2ZW50KCAib251bmxvYWQiLCB1bmxvYWRIYW5kbGVyICk7CgkJCX0KCQl9CgoJCS8qIFN1cHBvcnQgdGVzdHMKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgkJZG9jdW1lbnRJc0hUTUwgPSAhaXNYTUwoIGRvYyApOwoKCQkvKiBBdHRyaWJ1dGVzCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBTdXBwb3J0OiBJRTw4CgkJLy8gVmVyaWZ5IHRoYXQgZ2V0QXR0cmlidXRlIHJlYWxseSByZXR1cm5zIGF0dHJpYnV0ZXMgYW5kIG5vdCBwcm9wZXJ0aWVzCgkJLy8gKGV4Y2VwdGluZyBJRTggYm9vbGVhbnMpCgkJc3VwcG9ydC5hdHRyaWJ1dGVzID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCWRpdi5jbGFzc05hbWUgPSAiaSI7CgkJCXJldHVybiAhZGl2LmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIik7CgkJfSk7CgoJCS8qIGdldEVsZW1lbnQocylCeSoKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgoJCS8vIENoZWNrIGlmIGdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikgcmV0dXJucyBvbmx5IGVsZW1lbnRzCgkJc3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZSA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQlkaXYuYXBwZW5kQ2hpbGQoIGRvYy5jcmVhdGVDb21tZW50KCIiKSApOwoJCQlyZXR1cm4gIWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aDsKCQl9KTsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCXN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IHJuYXRpdmUudGVzdCggZG9jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKTsKCgkJLy8gU3VwcG9ydDogSUU8MTAKCQkvLyBDaGVjayBpZiBnZXRFbGVtZW50QnlJZCByZXR1cm5zIGVsZW1lbnRzIGJ5IG5hbWUKCQkvLyBUaGUgYnJva2VuIGdldEVsZW1lbnRCeUlkIG1ldGhvZHMgZG9uJ3QgcGljayB1cCBwcm9ncmFtYXRpY2FsbHktc2V0IG5hbWVzLAoJCS8vIHNvIHVzZSBhIHJvdW5kYWJvdXQgZ2V0RWxlbWVudHNCeU5hbWUgdGVzdAoJCXN1cHBvcnQuZ2V0QnlJZCA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQlkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pZCA9IGV4cGFuZG87CgkJCXJldHVybiAhZG9jLmdldEVsZW1lbnRzQnlOYW1lIHx8ICFkb2MuZ2V0RWxlbWVudHNCeU5hbWUoIGV4cGFuZG8gKS5sZW5ndGg7CgkJfSk7CgoJCS8vIElEIGZpbmQgYW5kIGZpbHRlcgoJCWlmICggc3VwcG9ydC5nZXRCeUlkICkgewoJCQlFeHByLmZpbmRbIklEIl0gPSBmdW5jdGlvbiggaWQsIGNvbnRleHQgKSB7CgkJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRCeUlkICE9PSAidW5kZWZpbmVkIiAmJiBkb2N1bWVudElzSFRNTCApIHsKCQkJCQl2YXIgbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7CgkJCQkJLy8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnMKCQkJCQkvLyBub2RlcyB0aGF0IGFyZSBubyBsb25nZXIgaW4gdGhlIGRvY3VtZW50ICM2OTYzCgkJCQkJcmV0dXJuIG0gJiYgbS5wYXJlbnROb2RlID8gWyBtIF0gOiBbXTsKCQkJCX0KCQkJfTsKCQkJRXhwci5maWx0ZXJbIklEIl0gPSBmdW5jdGlvbiggaWQgKSB7CgkJCQl2YXIgYXR0cklkID0gaWQucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoImlkIikgPT09IGF0dHJJZDsKCQkJCX07CgkJCX07CgkJfSBlbHNlIHsKCQkJLy8gU3VwcG9ydDogSUU2LzcKCQkJLy8gZ2V0RWxlbWVudEJ5SWQgaXMgbm90IHJlbGlhYmxlIGFzIGEgZmluZCBzaG9ydGN1dAoJCQlkZWxldGUgRXhwci5maW5kWyJJRCJdOwoKCQkJRXhwci5maWx0ZXJbIklEIl0gPSAgZnVuY3Rpb24oIGlkICkgewoJCQkJdmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIG5vZGUgPSB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlICE9PSAidW5kZWZpbmVkIiAmJiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7CgkJCQkJcmV0dXJuIG5vZGUgJiYgbm9kZS52YWx1ZSA9PT0gYXR0cklkOwoJCQkJfTsKCQkJfTsKCQl9CgoJCS8vIFRhZwoJCUV4cHIuZmluZFsiVEFHIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID8KCQkJZnVuY3Rpb24oIHRhZywgY29udGV4dCApIHsKCQkJCWlmICggdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQiICkgewoJCQkJCXJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgKTsKCgkJCQkvLyBEb2N1bWVudEZyYWdtZW50IG5vZGVzIGRvbid0IGhhdmUgZ0VCVE4KCQkJCX0gZWxzZSBpZiAoIHN1cHBvcnQucXNhICkgewoJCQkJCXJldHVybiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIHRhZyApOwoJCQkJfQoJCQl9IDoKCgkJCWZ1bmN0aW9uKCB0YWcsIGNvbnRleHQgKSB7CgkJCQl2YXIgZWxlbSwKCQkJCQl0bXAgPSBbXSwKCQkJCQlpID0gMCwKCQkJCQkvLyBCeSBoYXBweSBjb2luY2lkZW5jZSwgYSAoYnJva2VuKSBnRUJUTiBhcHBlYXJzIG9uIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgdG9vCgkJCQkJcmVzdWx0cyA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyApOwoKCQkJCS8vIEZpbHRlciBvdXQgcG9zc2libGUgY29tbWVudHMKCQkJCWlmICggdGFnID09PSAiKiIgKSB7CgkJCQkJd2hpbGUgKCAoZWxlbSA9IHJlc3VsdHNbaSsrXSkgKSB7CgkJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQkJCXRtcC5wdXNoKCBlbGVtICk7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCXJldHVybiB0bXA7CgkJCQl9CgkJCQlyZXR1cm4gcmVzdWx0czsKCQkJfTsKCgkJLy8gQ2xhc3MKCQlFeHByLmZpbmRbIkNMQVNTIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZnVuY3Rpb24oIGNsYXNzTmFtZSwgY29udGV4dCApIHsKCQkJaWYgKCBkb2N1bWVudElzSFRNTCApIHsKCQkJCXJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIGNsYXNzTmFtZSApOwoJCQl9CgkJfTsKCgkJLyogUVNBL21hdGNoZXNTZWxlY3RvcgoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkJLy8gUVNBIGFuZCBtYXRjaGVzU2VsZWN0b3Igc3VwcG9ydAoKCQkvLyBtYXRjaGVzU2VsZWN0b3IoOmFjdGl2ZSkgcmVwb3J0cyBmYWxzZSB3aGVuIHRydWUgKElFOS9PcGVyYSAxMS41KQoJCXJidWdneU1hdGNoZXMgPSBbXTsKCgkJLy8gcVNhKDpmb2N1cykgcmVwb3J0cyBmYWxzZSB3aGVuIHRydWUgKENocm9tZSAyMSkKCQkvLyBXZSBhbGxvdyB0aGlzIGJlY2F1c2Ugb2YgYSBidWcgaW4gSUU4LzkgdGhhdCB0aHJvd3MgYW4gZXJyb3IKCQkvLyB3aGVuZXZlciBgZG9jdW1lbnQuYWN0aXZlRWxlbWVudGAgaXMgYWNjZXNzZWQgb24gYW4gaWZyYW1lCgkJLy8gU28sIHdlIGFsbG93IDpmb2N1cyB0byBwYXNzIHRocm91Z2ggUVNBIGFsbCB0aGUgdGltZSB0byBhdm9pZCB0aGUgSUUgZXJyb3IKCQkvLyBTZWUgaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvMTMzNzgKCQlyYnVnZ3lRU0EgPSBbXTsKCgkJaWYgKCAoc3VwcG9ydC5xc2EgPSBybmF0aXZlLnRlc3QoIGRvYy5xdWVyeVNlbGVjdG9yQWxsICkpICkgewoJCQkvLyBCdWlsZCBRU0EgcmVnZXgKCQkJLy8gUmVnZXggc3RyYXRlZ3kgYWRvcHRlZCBmcm9tIERpZWdvIFBlcmluaQoJCQlhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJCS8vIFNlbGVjdCBpcyBzZXQgdG8gZW1wdHkgc3RyaW5nIG9uIHB1cnBvc2UKCQkJCS8vIFRoaXMgaXMgdG8gdGVzdCBJRSdzIHRyZWF0bWVudCBvZiBub3QgZXhwbGljaXRseQoJCQkJLy8gc2V0dGluZyBhIGJvb2xlYW4gY29udGVudCBhdHRyaWJ1dGUsCgkJCQkvLyBzaW5jZSBpdHMgcHJlc2VuY2Ugc2hvdWxkIGJlIGVub3VnaAoJCQkJLy8gaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvMTIzNTkKCQkJCWRvY0VsZW0uYXBwZW5kQ2hpbGQoIGRpdiApLmlubmVySFRNTCA9ICI8YSBpZD0nIiArIGV4cGFuZG8gKyAiJz48L2E+IiArCgkJCQkJIjxzZWxlY3QgaWQ9JyIgKyBleHBhbmRvICsgIi1cZl0nIG1zYWxsb3djYXB0dXJlPScnPiIgKwoJCQkJCSI8b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PiI7CgoJCQkJLy8gU3VwcG9ydDogSUU4LCBPcGVyYSAxMS0xMi4xNgoJCQkJLy8gTm90aGluZyBzaG91bGQgYmUgc2VsZWN0ZWQgd2hlbiBlbXB0eSBzdHJpbmdzIGZvbGxvdyBePSBvciAkPSBvciAqPQoJCQkJLy8gVGhlIHRlc3QgYXR0cmlidXRlIG11c3QgYmUgdW5rbm93biBpbiBPcGVyYSBidXQgInNhZmUiIGZvciBXaW5SVAoJCQkJLy8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2llL2hoNDY1Mzg4LmFzcHgjYXR0cmlidXRlX3NlY3Rpb24KCQkJCWlmICggZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAiWypeJF09IiArIHdoaXRlc3BhY2UgKyAiKig/OicnfFwiXCIpIiApOwoJCQkJfQoKCQkJCS8vIFN1cHBvcnQ6IElFOAoJCQkJLy8gQm9vbGVhbiBhdHRyaWJ1dGVzIGFuZCAidmFsdWUiIGFyZSBub3QgdHJlYXRlZCBjb3JyZWN0bHkKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAiXFxbIiArIHdoaXRlc3BhY2UgKyAiKig/OnZhbHVlfCIgKyBib29sZWFucyArICIpIiApOwoJCQkJfQoKCQkJCS8vIFN1cHBvcnQ6IENocm9tZTwyOSwgQW5kcm9pZDw0LjIrLCBTYWZhcmk8Ny4wKywgaU9TPDcuMCssIFBoYW50b21KUzwxLjkuNysKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCAiW2lkfj0iICsgZXhwYW5kbyArICItXSIgKS5sZW5ndGggKSB7CgkJCQkJcmJ1Z2d5UVNBLnB1c2goIn49Iik7CgkJCQl9CgoJCQkJLy8gV2Via2l0L09wZXJhIC0gOmNoZWNrZWQgc2hvdWxkIHJldHVybiBzZWxlY3RlZCBvcHRpb24gZWxlbWVudHMKCQkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkCgkJCQkvLyBJRTggdGhyb3dzIGVycm9yIGhlcmUgYW5kIHdpbGwgbm90IHNlZSBsYXRlciB0ZXN0cwoJCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCI6Y2hlY2tlZCIpOwoJCQkJfQoKCQkJCS8vIFN1cHBvcnQ6IFNhZmFyaSA4KywgaU9TIDgrCgkJCQkvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM2ODUxCgkJCQkvLyBJbi1wYWdlIGBzZWxlY3RvciNpZCBzaWJpbmctY29tYmluYXRvciBzZWxlY3RvcmAgZmFpbHMKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCAiYSMiICsgZXhwYW5kbyArICIrKiIgKS5sZW5ndGggKSB7CgkJCQkJcmJ1Z2d5UVNBLnB1c2goIi4jLitbK35dIik7CgkJCQl9CgkJCX0pOwoKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBTdXBwb3J0OiBXaW5kb3dzIDggTmF0aXZlIEFwcHMKCQkJCS8vIFRoZSB0eXBlIGFuZCBuYW1lIGF0dHJpYnV0ZXMgYXJlIHJlc3RyaWN0ZWQgZHVyaW5nIC5pbm5lckhUTUwgYXNzaWdubWVudAoJCQkJdmFyIGlucHV0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CgkJCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ0eXBlIiwgImhpZGRlbiIgKTsKCQkJCWRpdi5hcHBlbmRDaGlsZCggaW5wdXQgKS5zZXRBdHRyaWJ1dGUoICJuYW1lIiwgIkQiICk7CgoJCQkJLy8gU3VwcG9ydDogSUU4CgkJCQkvLyBFbmZvcmNlIGNhc2Utc2Vuc2l0aXZpdHkgb2YgbmFtZSBhdHRyaWJ1dGUKCQkJCWlmICggZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAibmFtZSIgKyB3aGl0ZXNwYWNlICsgIipbKl4kfCF+XT89IiApOwoJCQkJfQoKCQkJCS8vIEZGIDMuNSAtIDplbmFibGVkLzpkaXNhYmxlZCBhbmQgaGlkZGVuIGVsZW1lbnRzIChoaWRkZW4gZWxlbWVudHMgYXJlIHN0aWxsIGVuYWJsZWQpCgkJCQkvLyBJRTggdGhyb3dzIGVycm9yIGhlcmUgYW5kIHdpbGwgbm90IHNlZSBsYXRlciB0ZXN0cwoJCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIjplbmFibGVkIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAiOmVuYWJsZWQiLCAiOmRpc2FibGVkIiApOwoJCQkJfQoKCQkJCS8vIE9wZXJhIDEwLTExIGRvZXMgbm90IHRocm93IG9uIHBvc3QtY29tbWEgaW52YWxpZCBwc2V1ZG9zCgkJCQlkaXYucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpOwoJCQkJcmJ1Z2d5UVNBLnB1c2goIiwuKjoiKTsKCQkJfSk7CgkJfQoKCQlpZiAoIChzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciA9IHJuYXRpdmUudGVzdCggKG1hdGNoZXMgPSBkb2NFbGVtLm1hdGNoZXMgfHwKCQkJZG9jRWxlbS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwKCQkJZG9jRWxlbS5tb3pNYXRjaGVzU2VsZWN0b3IgfHwKCQkJZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yIHx8CgkJCWRvY0VsZW0ubXNNYXRjaGVzU2VsZWN0b3IpICkpICkgewoKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBDaGVjayB0byBzZWUgaWYgaXQncyBwb3NzaWJsZSB0byBkbyBtYXRjaGVzU2VsZWN0b3IKCQkJCS8vIG9uIGEgZGlzY29ubmVjdGVkIG5vZGUgKElFIDkpCgkJCQlzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoID0gbWF0Y2hlcy5jYWxsKCBkaXYsICJkaXYiICk7CgoJCQkJLy8gVGhpcyBzaG91bGQgZmFpbCB3aXRoIGFuIGV4Y2VwdGlvbgoJCQkJLy8gR2Vja28gZG9lcyBub3QgZXJyb3IsIHJldHVybnMgZmFsc2UgaW5zdGVhZAoJCQkJbWF0Y2hlcy5jYWxsKCBkaXYsICJbcyE9JyddOngiICk7CgkJCQlyYnVnZ3lNYXRjaGVzLnB1c2goICIhPSIsIHBzZXVkb3MgKTsKCQkJfSk7CgkJfQoKCQlyYnVnZ3lRU0EgPSByYnVnZ3lRU0EubGVuZ3RoICYmIG5ldyBSZWdFeHAoIHJidWdneVFTQS5qb2luKCJ8IikgKTsKCQlyYnVnZ3lNYXRjaGVzID0gcmJ1Z2d5TWF0Y2hlcy5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5TWF0Y2hlcy5qb2luKCJ8IikgKTsKCgkJLyogQ29udGFpbnMKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgkJaGFzQ29tcGFyZSA9IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiApOwoKCQkvLyBFbGVtZW50IGNvbnRhaW5zIGFub3RoZXIKCQkvLyBQdXJwb3NlZnVsbHkgZG9lcyBub3QgaW1wbGVtZW50IGluY2x1c2l2ZSBkZXNjZW5kZW50CgkJLy8gQXMgaW4sIGFuIGVsZW1lbnQgZG9lcyBub3QgY29udGFpbiBpdHNlbGYKCQljb250YWlucyA9IGhhc0NvbXBhcmUgfHwgcm5hdGl2ZS50ZXN0KCBkb2NFbGVtLmNvbnRhaW5zICkgPwoJCQlmdW5jdGlvbiggYSwgYiApIHsKCQkJCXZhciBhZG93biA9IGEubm9kZVR5cGUgPT09IDkgPyBhLmRvY3VtZW50RWxlbWVudCA6IGEsCgkJCQkJYnVwID0gYiAmJiBiLnBhcmVudE5vZGU7CgkJCQlyZXR1cm4gYSA9PT0gYnVwIHx8ICEhKCBidXAgJiYgYnVwLm5vZGVUeXBlID09PSAxICYmICgKCQkJCQlhZG93bi5jb250YWlucyA/CgkJCQkJCWFkb3duLmNvbnRhaW5zKCBidXAgKSA6CgkJCQkJCWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gJiYgYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYnVwICkgJiAxNgoJCQkJKSk7CgkJCX0gOgoJCQlmdW5jdGlvbiggYSwgYiApIHsKCQkJCWlmICggYiApIHsKCQkJCQl3aGlsZSAoIChiID0gYi5wYXJlbnROb2RlKSApIHsKCQkJCQkJaWYgKCBiID09PSBhICkgewoJCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX07CgoJCS8qIFNvcnRpbmcKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgoJCS8vIERvY3VtZW50IG9yZGVyIHNvcnRpbmcKCQlzb3J0T3JkZXIgPSBoYXNDb21wYXJlID8KCQlmdW5jdGlvbiggYSwgYiApIHsKCgkJCS8vIEZsYWcgZm9yIGR1cGxpY2F0ZSByZW1vdmFsCgkJCWlmICggYSA9PT0gYiApIHsKCQkJCWhhc0R1cGxpY2F0ZSA9IHRydWU7CgkJCQlyZXR1cm4gMDsKCQkJfQoKCQkJLy8gU29ydCBvbiBtZXRob2QgZXhpc3RlbmNlIGlmIG9ubHkgb25lIGlucHV0IGhhcyBjb21wYXJlRG9jdW1lbnRQb3NpdGlvbgoJCQl2YXIgY29tcGFyZSA9ICFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIC0gIWIuY29tcGFyZURvY3VtZW50UG9zaXRpb247CgkJCWlmICggY29tcGFyZSApIHsKCQkJCXJldHVybiBjb21wYXJlOwoJCQl9CgoJCQkvLyBDYWxjdWxhdGUgcG9zaXRpb24gaWYgYm90aCBpbnB1dHMgYmVsb25nIHRvIHRoZSBzYW1lIGRvY3VtZW50CgkJCWNvbXBhcmUgPSAoIGEub3duZXJEb2N1bWVudCB8fCBhICkgPT09ICggYi5vd25lckRvY3VtZW50IHx8IGIgKSA/CgkJCQlhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBiICkgOgoKCQkJCS8vIE90aGVyd2lzZSB3ZSBrbm93IHRoZXkgYXJlIGRpc2Nvbm5lY3RlZAoJCQkJMTsKCgkJCS8vIERpc2Nvbm5lY3RlZCBub2RlcwoJCQlpZiAoIGNvbXBhcmUgJiAxIHx8CgkJCQkoIXN1cHBvcnQuc29ydERldGFjaGVkICYmIGIuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGEgKSA9PT0gY29tcGFyZSkgKSB7CgoJCQkJLy8gQ2hvb3NlIHRoZSBmaXJzdCBlbGVtZW50IHRoYXQgaXMgcmVsYXRlZCB0byBvdXIgcHJlZmVycmVkIGRvY3VtZW50CgkJCQlpZiAoIGEgPT09IGRvYyB8fCBhLm93bmVyRG9jdW1lbnQgPT09IHByZWZlcnJlZERvYyAmJiBjb250YWlucyhwcmVmZXJyZWREb2MsIGEpICkgewoJCQkJCXJldHVybiAtMTsKCQkJCX0KCQkJCWlmICggYiA9PT0gZG9jIHx8IGIub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYikgKSB7CgkJCQkJcmV0dXJuIDE7CgkJCQl9CgoJCQkJLy8gTWFpbnRhaW4gb3JpZ2luYWwgb3JkZXIKCQkJCXJldHVybiBzb3J0SW5wdXQgPwoJCQkJCSggaW5kZXhPZiggc29ydElucHV0LCBhICkgLSBpbmRleE9mKCBzb3J0SW5wdXQsIGIgKSApIDoKCQkJCQkwOwoJCQl9CgoJCQlyZXR1cm4gY29tcGFyZSAmIDQgPyAtMSA6IDE7CgkJfSA6CgkJZnVuY3Rpb24oIGEsIGIgKSB7CgkJCS8vIEV4aXQgZWFybHkgaWYgdGhlIG5vZGVzIGFyZSBpZGVudGljYWwKCQkJaWYgKCBhID09PSBiICkgewoJCQkJaGFzRHVwbGljYXRlID0gdHJ1ZTsKCQkJCXJldHVybiAwOwoJCQl9CgoJCQl2YXIgY3VyLAoJCQkJaSA9IDAsCgkJCQlhdXAgPSBhLnBhcmVudE5vZGUsCgkJCQlidXAgPSBiLnBhcmVudE5vZGUsCgkJCQlhcCA9IFsgYSBdLAoJCQkJYnAgPSBbIGIgXTsKCgkJCS8vIFBhcmVudGxlc3Mgbm9kZXMgYXJlIGVpdGhlciBkb2N1bWVudHMgb3IgZGlzY29ubmVjdGVkCgkJCWlmICggIWF1cCB8fCAhYnVwICkgewoJCQkJcmV0dXJuIGEgPT09IGRvYyA/IC0xIDoKCQkJCQliID09PSBkb2MgPyAxIDoKCQkJCQlhdXAgPyAtMSA6CgkJCQkJYnVwID8gMSA6CgkJCQkJc29ydElucHV0ID8KCQkJCQkoIGluZGV4T2YoIHNvcnRJbnB1dCwgYSApIC0gaW5kZXhPZiggc29ydElucHV0LCBiICkgKSA6CgkJCQkJMDsKCgkJCS8vIElmIHRoZSBub2RlcyBhcmUgc2libGluZ3MsIHdlIGNhbiBkbyBhIHF1aWNrIGNoZWNrCgkJCX0gZWxzZSBpZiAoIGF1cCA9PT0gYnVwICkgewoJCQkJcmV0dXJuIHNpYmxpbmdDaGVjayggYSwgYiApOwoJCQl9CgoJCQkvLyBPdGhlcndpc2Ugd2UgbmVlZCBmdWxsIGxpc3RzIG9mIHRoZWlyIGFuY2VzdG9ycyBmb3IgY29tcGFyaXNvbgoJCQljdXIgPSBhOwoJCQl3aGlsZSAoIChjdXIgPSBjdXIucGFyZW50Tm9kZSkgKSB7CgkJCQlhcC51bnNoaWZ0KCBjdXIgKTsKCQkJfQoJCQljdXIgPSBiOwoJCQl3aGlsZSAoIChjdXIgPSBjdXIucGFyZW50Tm9kZSkgKSB7CgkJCQlicC51bnNoaWZ0KCBjdXIgKTsKCQkJfQoKCQkJLy8gV2FsayBkb3duIHRoZSB0cmVlIGxvb2tpbmcgZm9yIGEgZGlzY3JlcGFuY3kKCQkJd2hpbGUgKCBhcFtpXSA9PT0gYnBbaV0gKSB7CgkJCQlpKys7CgkJCX0KCgkJCXJldHVybiBpID8KCQkJCS8vIERvIGEgc2libGluZyBjaGVjayBpZiB0aGUgbm9kZXMgaGF2ZSBhIGNvbW1vbiBhbmNlc3RvcgoJCQkJc2libGluZ0NoZWNrKCBhcFtpXSwgYnBbaV0gKSA6CgoJCQkJLy8gT3RoZXJ3aXNlIG5vZGVzIGluIG91ciBkb2N1bWVudCBzb3J0IGZpcnN0CgkJCQlhcFtpXSA9PT0gcHJlZmVycmVkRG9jID8gLTEgOgoJCQkJYnBbaV0gPT09IHByZWZlcnJlZERvYyA/IDEgOgoJCQkJMDsKCQl9OwoKCQlyZXR1cm4gZG9jOwoJfTsKCglTaXp6bGUubWF0Y2hlcyA9IGZ1bmN0aW9uKCBleHByLCBlbGVtZW50cyApIHsKCQlyZXR1cm4gU2l6emxlKCBleHByLCBudWxsLCBudWxsLCBlbGVtZW50cyApOwoJfTsKCglTaXp6bGUubWF0Y2hlc1NlbGVjdG9yID0gZnVuY3Rpb24oIGVsZW0sIGV4cHIgKSB7CgkJLy8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkCgkJaWYgKCAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtICkgIT09IGRvY3VtZW50ICkgewoJCQlzZXREb2N1bWVudCggZWxlbSApOwoJCX0KCgkJLy8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRlIHNlbGVjdG9ycyBhcmUgcXVvdGVkCgkJZXhwciA9IGV4cHIucmVwbGFjZSggcmF0dHJpYnV0ZVF1b3RlcywgIj0nJDEnXSIgKTsKCgkJaWYgKCBzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciAmJiBkb2N1bWVudElzSFRNTCAmJgoJCQkoICFyYnVnZ3lNYXRjaGVzIHx8ICFyYnVnZ3lNYXRjaGVzLnRlc3QoIGV4cHIgKSApICYmCgkJCSggIXJidWdneVFTQSAgICAgfHwgIXJidWdneVFTQS50ZXN0KCBleHByICkgKSApIHsKCgkJCXRyeSB7CgkJCQl2YXIgcmV0ID0gbWF0Y2hlcy5jYWxsKCBlbGVtLCBleHByICk7CgoJCQkJLy8gSUUgOSdzIG1hdGNoZXNTZWxlY3RvciByZXR1cm5zIGZhbHNlIG9uIGRpc2Nvbm5lY3RlZCBub2RlcwoJCQkJaWYgKCByZXQgfHwgc3VwcG9ydC5kaXNjb25uZWN0ZWRNYXRjaCB8fAoJCQkJCQkvLyBBcyB3ZWxsLCBkaXNjb25uZWN0ZWQgbm9kZXMgYXJlIHNhaWQgdG8gYmUgaW4gYSBkb2N1bWVudAoJCQkJCQkvLyBmcmFnbWVudCBpbiBJRSA5CgkJCQkJCWVsZW0uZG9jdW1lbnQgJiYgZWxlbS5kb2N1bWVudC5ub2RlVHlwZSAhPT0gMTEgKSB7CgkJCQkJcmV0dXJuIHJldDsKCQkJCX0KCQkJfSBjYXRjaCAoZSkge30KCQl9CgoJCXJldHVybiBTaXp6bGUoIGV4cHIsIGRvY3VtZW50LCBudWxsLCBbIGVsZW0gXSApLmxlbmd0aCA+IDA7Cgl9OwoKCVNpenpsZS5jb250YWlucyA9IGZ1bmN0aW9uKCBjb250ZXh0LCBlbGVtICkgewoJCS8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZAoJCWlmICggKCBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCApICE9PSBkb2N1bWVudCApIHsKCQkJc2V0RG9jdW1lbnQoIGNvbnRleHQgKTsKCQl9CgkJcmV0dXJuIGNvbnRhaW5zKCBjb250ZXh0LCBlbGVtICk7Cgl9OwoKCVNpenpsZS5hdHRyID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkJLy8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkCgkJaWYgKCAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtICkgIT09IGRvY3VtZW50ICkgewoJCQlzZXREb2N1bWVudCggZWxlbSApOwoJCX0KCgkJdmFyIGZuID0gRXhwci5hdHRySGFuZGxlWyBuYW1lLnRvTG93ZXJDYXNlKCkgXSwKCQkJLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKGpRdWVyeSAjMTM4MDcpCgkJCXZhbCA9IGZuICYmIGhhc093bi5jYWxsKCBFeHByLmF0dHJIYW5kbGUsIG5hbWUudG9Mb3dlckNhc2UoKSApID8KCQkJCWZuKCBlbGVtLCBuYW1lLCAhZG9jdW1lbnRJc0hUTUwgKSA6CgkJCQl1bmRlZmluZWQ7CgoJCXJldHVybiB2YWwgIT09IHVuZGVmaW5lZCA/CgkJCXZhbCA6CgkJCXN1cHBvcnQuYXR0cmlidXRlcyB8fCAhZG9jdW1lbnRJc0hUTUwgPwoJCQkJZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKSA6CgkJCQkodmFsID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpKSAmJiB2YWwuc3BlY2lmaWVkID8KCQkJCQl2YWwudmFsdWUgOgoJCQkJCW51bGw7Cgl9OwoKCVNpenpsZS5lcnJvciA9IGZ1bmN0aW9uKCBtc2cgKSB7CgkJdGhyb3cgbmV3IEVycm9yKCAiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIiArIG1zZyApOwoJfTsKCgkvKioKCSAqIERvY3VtZW50IHNvcnRpbmcgYW5kIHJlbW92aW5nIGR1cGxpY2F0ZXMKCSAqIEBwYXJhbSB7QXJyYXlMaWtlfSByZXN1bHRzCgkgKi8KCVNpenpsZS51bmlxdWVTb3J0ID0gZnVuY3Rpb24oIHJlc3VsdHMgKSB7CgkJdmFyIGVsZW0sCgkJCWR1cGxpY2F0ZXMgPSBbXSwKCQkJaiA9IDAsCgkJCWkgPSAwOwoKCQkvLyBVbmxlc3Mgd2UgKmtub3cqIHdlIGNhbiBkZXRlY3QgZHVwbGljYXRlcywgYXNzdW1lIHRoZWlyIHByZXNlbmNlCgkJaGFzRHVwbGljYXRlID0gIXN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlczsKCQlzb3J0SW5wdXQgPSAhc3VwcG9ydC5zb3J0U3RhYmxlICYmIHJlc3VsdHMuc2xpY2UoIDAgKTsKCQlyZXN1bHRzLnNvcnQoIHNvcnRPcmRlciApOwoKCQlpZiAoIGhhc0R1cGxpY2F0ZSApIHsKCQkJd2hpbGUgKCAoZWxlbSA9IHJlc3VsdHNbaSsrXSkgKSB7CgkJCQlpZiAoIGVsZW0gPT09IHJlc3VsdHNbIGkgXSApIHsKCQkJCQlqID0gZHVwbGljYXRlcy5wdXNoKCBpICk7CgkJCQl9CgkJCX0KCQkJd2hpbGUgKCBqLS0gKSB7CgkJCQlyZXN1bHRzLnNwbGljZSggZHVwbGljYXRlc1sgaiBdLCAxICk7CgkJCX0KCQl9CgoJCS8vIENsZWFyIGlucHV0IGFmdGVyIHNvcnRpbmcgdG8gcmVsZWFzZSBvYmplY3RzCgkJLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvc2l6emxlL3B1bGwvMjI1CgkJc29ydElucHV0ID0gbnVsbDsKCgkJcmV0dXJuIHJlc3VsdHM7Cgl9OwoKCS8qKgoJICogVXRpbGl0eSBmdW5jdGlvbiBmb3IgcmV0cmlldmluZyB0aGUgdGV4dCB2YWx1ZSBvZiBhbiBhcnJheSBvZiBET00gbm9kZXMKCSAqIEBwYXJhbSB7QXJyYXl8RWxlbWVudH0gZWxlbQoJICovCglnZXRUZXh0ID0gU2l6emxlLmdldFRleHQgPSBmdW5jdGlvbiggZWxlbSApIHsKCQl2YXIgbm9kZSwKCQkJcmV0ID0gIiIsCgkJCWkgPSAwLAoJCQlub2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7CgoJCWlmICggIW5vZGVUeXBlICkgewoJCQkvLyBJZiBubyBub2RlVHlwZSwgdGhpcyBpcyBleHBlY3RlZCB0byBiZSBhbiBhcnJheQoJCQl3aGlsZSAoIChub2RlID0gZWxlbVtpKytdKSApIHsKCQkJCS8vIERvIG5vdCB0cmF2ZXJzZSBjb21tZW50IG5vZGVzCgkJCQlyZXQgKz0gZ2V0VGV4dCggbm9kZSApOwoJCQl9CgkJfSBlbHNlIGlmICggbm9kZVR5cGUgPT09IDEgfHwgbm9kZVR5cGUgPT09IDkgfHwgbm9kZVR5cGUgPT09IDExICkgewoJCQkvLyBVc2UgdGV4dENvbnRlbnQgZm9yIGVsZW1lbnRzCgkJCS8vIGlubmVyVGV4dCB1c2FnZSByZW1vdmVkIGZvciBjb25zaXN0ZW5jeSBvZiBuZXcgbGluZXMgKGpRdWVyeSAjMTExNTMpCgkJCWlmICggdHlwZW9mIGVsZW0udGV4dENvbnRlbnQgPT09ICJzdHJpbmciICkgewoJCQkJcmV0dXJuIGVsZW0udGV4dENvbnRlbnQ7CgkJCX0gZWxzZSB7CgkJCQkvLyBUcmF2ZXJzZSBpdHMgY2hpbGRyZW4KCQkJCWZvciAoIGVsZW0gPSBlbGVtLmZpcnN0Q2hpbGQ7IGVsZW07IGVsZW0gPSBlbGVtLm5leHRTaWJsaW5nICkgewoJCQkJCXJldCArPSBnZXRUZXh0KCBlbGVtICk7CgkJCQl9CgkJCX0KCQl9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMyB8fCBub2RlVHlwZSA9PT0gNCApIHsKCQkJcmV0dXJuIGVsZW0ubm9kZVZhbHVlOwoJCX0KCQkvLyBEbyBub3QgaW5jbHVkZSBjb21tZW50IG9yIHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb24gbm9kZXMKCgkJcmV0dXJuIHJldDsKCX07CgoJRXhwciA9IFNpenpsZS5zZWxlY3RvcnMgPSB7CgoJCS8vIENhbiBiZSBhZGp1c3RlZCBieSB0aGUgdXNlcgoJCWNhY2hlTGVuZ3RoOiA1MCwKCgkJY3JlYXRlUHNldWRvOiBtYXJrRnVuY3Rpb24sCgoJCW1hdGNoOiBtYXRjaEV4cHIsCgoJCWF0dHJIYW5kbGU6IHt9LAoKCQlmaW5kOiB7fSwKCgkJcmVsYXRpdmU6IHsKCQkJIj4iOiB7IGRpcjogInBhcmVudE5vZGUiLCBmaXJzdDogdHJ1ZSB9LAoJCQkiICI6IHsgZGlyOiAicGFyZW50Tm9kZSIgfSwKCQkJIisiOiB7IGRpcjogInByZXZpb3VzU2libGluZyIsIGZpcnN0OiB0cnVlIH0sCgkJCSJ+IjogeyBkaXI6ICJwcmV2aW91c1NpYmxpbmciIH0KCQl9LAoKCQlwcmVGaWx0ZXI6IHsKCQkJIkFUVFIiOiBmdW5jdGlvbiggbWF0Y2ggKSB7CgkJCQltYXRjaFsxXSA9IG1hdGNoWzFdLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgoJCQkJLy8gTW92ZSB0aGUgZ2l2ZW4gdmFsdWUgdG8gbWF0Y2hbM10gd2hldGhlciBxdW90ZWQgb3IgdW5xdW90ZWQKCQkJCW1hdGNoWzNdID0gKCBtYXRjaFszXSB8fCBtYXRjaFs0XSB8fCBtYXRjaFs1XSB8fCAiIiApLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgoJCQkJaWYgKCBtYXRjaFsyXSA9PT0gIn49IiApIHsKCQkJCQltYXRjaFszXSA9ICIgIiArIG1hdGNoWzNdICsgIiAiOwoJCQkJfQoKCQkJCXJldHVybiBtYXRjaC5zbGljZSggMCwgNCApOwoJCQl9LAoKCQkJIkNISUxEIjogZnVuY3Rpb24oIG1hdGNoICkgewoJCQkJLyogbWF0Y2hlcyBmcm9tIG1hdGNoRXhwclsiQ0hJTEQiXQoJCQkJCTEgdHlwZSAob25seXxudGh8Li4uKQoJCQkJCTIgd2hhdCAoY2hpbGR8b2YtdHlwZSkKCQkJCQkzIGFyZ3VtZW50IChldmVufG9kZHxcZCp8XGQqbihbKy1dXGQrKT98Li4uKQoJCQkJCTQgeG4tY29tcG9uZW50IG9mIHhuK3kgYXJndW1lbnQgKFsrLV0/XGQqbnwpCgkJCQkJNSBzaWduIG9mIHhuLWNvbXBvbmVudAoJCQkJCTYgeCBvZiB4bi1jb21wb25lbnQKCQkJCQk3IHNpZ24gb2YgeS1jb21wb25lbnQKCQkJCQk4IHkgb2YgeS1jb21wb25lbnQKCQkJCSovCgkJCQltYXRjaFsxXSA9IG1hdGNoWzFdLnRvTG93ZXJDYXNlKCk7CgoJCQkJaWYgKCBtYXRjaFsxXS5zbGljZSggMCwgMyApID09PSAibnRoIiApIHsKCQkJCQkvLyBudGgtKiByZXF1aXJlcyBhcmd1bWVudAoJCQkJCWlmICggIW1hdGNoWzNdICkgewoJCQkJCQlTaXp6bGUuZXJyb3IoIG1hdGNoWzBdICk7CgkJCQkJfQoKCQkJCQkvLyBudW1lcmljIHggYW5kIHkgcGFyYW1ldGVycyBmb3IgRXhwci5maWx0ZXIuQ0hJTEQKCQkJCQkvLyByZW1lbWJlciB0aGF0IGZhbHNlL3RydWUgY2FzdCByZXNwZWN0aXZlbHkgdG8gMC8xCgkJCQkJbWF0Y2hbNF0gPSArKCBtYXRjaFs0XSA/IG1hdGNoWzVdICsgKG1hdGNoWzZdIHx8IDEpIDogMiAqICggbWF0Y2hbM10gPT09ICJldmVuIiB8fCBtYXRjaFszXSA9PT0gIm9kZCIgKSApOwoJCQkJCW1hdGNoWzVdID0gKyggKCBtYXRjaFs3XSArIG1hdGNoWzhdICkgfHwgbWF0Y2hbM10gPT09ICJvZGQiICk7CgoJCQkJLy8gb3RoZXIgdHlwZXMgcHJvaGliaXQgYXJndW1lbnRzCgkJCQl9IGVsc2UgaWYgKCBtYXRjaFszXSApIHsKCQkJCQlTaXp6bGUuZXJyb3IoIG1hdGNoWzBdICk7CgkJCQl9CgoJCQkJcmV0dXJuIG1hdGNoOwoJCQl9LAoKCQkJIlBTRVVETyI6IGZ1bmN0aW9uKCBtYXRjaCApIHsKCQkJCXZhciBleGNlc3MsCgkJCQkJdW5xdW90ZWQgPSAhbWF0Y2hbNl0gJiYgbWF0Y2hbMl07CgoJCQkJaWYgKCBtYXRjaEV4cHJbIkNISUxEIl0udGVzdCggbWF0Y2hbMF0gKSApIHsKCQkJCQlyZXR1cm4gbnVsbDsKCQkJCX0KCgkJCQkvLyBBY2NlcHQgcXVvdGVkIGFyZ3VtZW50cyBhcy1pcwoJCQkJaWYgKCBtYXRjaFszXSApIHsKCQkJCQltYXRjaFsyXSA9IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8ICIiOwoKCQkJCS8vIFN0cmlwIGV4Y2VzcyBjaGFyYWN0ZXJzIGZyb20gdW5xdW90ZWQgYXJndW1lbnRzCgkJCQl9IGVsc2UgaWYgKCB1bnF1b3RlZCAmJiBycHNldWRvLnRlc3QoIHVucXVvdGVkICkgJiYKCQkJCQkvLyBHZXQgZXhjZXNzIGZyb20gdG9rZW5pemUgKHJlY3Vyc2l2ZWx5KQoJCQkJCShleGNlc3MgPSB0b2tlbml6ZSggdW5xdW90ZWQsIHRydWUgKSkgJiYKCQkJCQkvLyBhZHZhbmNlIHRvIHRoZSBuZXh0IGNsb3NpbmcgcGFyZW50aGVzaXMKCQkJCQkoZXhjZXNzID0gdW5xdW90ZWQuaW5kZXhPZiggIikiLCB1bnF1b3RlZC5sZW5ndGggLSBleGNlc3MgKSAtIHVucXVvdGVkLmxlbmd0aCkgKSB7CgoJCQkJCS8vIGV4Y2VzcyBpcyBhIG5lZ2F0aXZlIGluZGV4CgkJCQkJbWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCwgZXhjZXNzICk7CgkJCQkJbWF0Y2hbMl0gPSB1bnF1b3RlZC5zbGljZSggMCwgZXhjZXNzICk7CgkJCQl9CgoJCQkJLy8gUmV0dXJuIG9ubHkgY2FwdHVyZXMgbmVlZGVkIGJ5IHRoZSBwc2V1ZG8gZmlsdGVyIG1ldGhvZCAodHlwZSBhbmQgYXJndW1lbnQpCgkJCQlyZXR1cm4gbWF0Y2guc2xpY2UoIDAsIDMgKTsKCQkJfQoJCX0sCgoJCWZpbHRlcjogewoKCQkJIlRBRyI6IGZ1bmN0aW9uKCBub2RlTmFtZVNlbGVjdG9yICkgewoJCQkJdmFyIG5vZGVOYW1lID0gbm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gbm9kZU5hbWVTZWxlY3RvciA9PT0gIioiID8KCQkJCQlmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0gOgoJCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQlyZXR1cm4gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5vZGVOYW1lOwoJCQkJCX07CgkJCX0sCgoJCQkiQ0xBU1MiOiBmdW5jdGlvbiggY2xhc3NOYW1lICkgewoJCQkJdmFyIHBhdHRlcm4gPSBjbGFzc0NhY2hlWyBjbGFzc05hbWUgKyAiICIgXTsKCgkJCQlyZXR1cm4gcGF0dGVybiB8fAoJCQkJCShwYXR0ZXJuID0gbmV3IFJlZ0V4cCggIihefCIgKyB3aGl0ZXNwYWNlICsgIikiICsgY2xhc3NOYW1lICsgIigiICsgd2hpdGVzcGFjZSArICJ8JCkiICkpICYmCgkJCQkJY2xhc3NDYWNoZSggY2xhc3NOYW1lLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQkJcmV0dXJuIHBhdHRlcm4udGVzdCggdHlwZW9mIGVsZW0uY2xhc3NOYW1lID09PSAic3RyaW5nIiAmJiBlbGVtLmNsYXNzTmFtZSB8fCB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUgIT09ICJ1bmRlZmluZWQiICYmIGVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiICk7CgkJCQkJfSk7CgkJCX0sCgoJCQkiQVRUUiI6IGZ1bmN0aW9uKCBuYW1lLCBvcGVyYXRvciwgY2hlY2sgKSB7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIHJlc3VsdCA9IFNpenpsZS5hdHRyKCBlbGVtLCBuYW1lICk7CgoJCQkJCWlmICggcmVzdWx0ID09IG51bGwgKSB7CgkJCQkJCXJldHVybiBvcGVyYXRvciA9PT0gIiE9IjsKCQkJCQl9CgkJCQkJaWYgKCAhb3BlcmF0b3IgKSB7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCgkJCQkJcmVzdWx0ICs9ICIiOwoKCQkJCQlyZXR1cm4gb3BlcmF0b3IgPT09ICI9IiA/IHJlc3VsdCA9PT0gY2hlY2sgOgoJCQkJCQlvcGVyYXRvciA9PT0gIiE9IiA/IHJlc3VsdCAhPT0gY2hlY2sgOgoJCQkJCQlvcGVyYXRvciA9PT0gIl49IiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID09PSAwIDoKCQkJCQkJb3BlcmF0b3IgPT09ICIqPSIgPyBjaGVjayAmJiByZXN1bHQuaW5kZXhPZiggY2hlY2sgKSA+IC0xIDoKCQkJCQkJb3BlcmF0b3IgPT09ICIkPSIgPyBjaGVjayAmJiByZXN1bHQuc2xpY2UoIC1jaGVjay5sZW5ndGggKSA9PT0gY2hlY2sgOgoJCQkJCQlvcGVyYXRvciA9PT0gIn49IiA/ICggIiAiICsgcmVzdWx0LnJlcGxhY2UoIHJ3aGl0ZXNwYWNlLCAiICIgKSArICIgIiApLmluZGV4T2YoIGNoZWNrICkgPiAtMSA6CgkJCQkJCW9wZXJhdG9yID09PSAifD0iID8gcmVzdWx0ID09PSBjaGVjayB8fCByZXN1bHQuc2xpY2UoIDAsIGNoZWNrLmxlbmd0aCArIDEgKSA9PT0gY2hlY2sgKyAiLSIgOgoJCQkJCQlmYWxzZTsKCQkJCX07CgkJCX0sCgoJCQkiQ0hJTEQiOiBmdW5jdGlvbiggdHlwZSwgd2hhdCwgYXJndW1lbnQsIGZpcnN0LCBsYXN0ICkgewoJCQkJdmFyIHNpbXBsZSA9IHR5cGUuc2xpY2UoIDAsIDMgKSAhPT0gIm50aCIsCgkJCQkJZm9yd2FyZCA9IHR5cGUuc2xpY2UoIC00ICkgIT09ICJsYXN0IiwKCQkJCQlvZlR5cGUgPSB3aGF0ID09PSAib2YtdHlwZSI7CgoJCQkJcmV0dXJuIGZpcnN0ID09PSAxICYmIGxhc3QgPT09IDAgPwoKCQkJCQkvLyBTaG9ydGN1dCBmb3IgOm50aC0qKG4pCgkJCQkJZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJCXJldHVybiAhIWVsZW0ucGFyZW50Tm9kZTsKCQkJCQl9IDoKCgkJCQkJZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHsKCQkJCQkJdmFyIGNhY2hlLCBvdXRlckNhY2hlLCBub2RlLCBkaWZmLCBub2RlSW5kZXgsIHN0YXJ0LAoJCQkJCQkJZGlyID0gc2ltcGxlICE9PSBmb3J3YXJkID8gIm5leHRTaWJsaW5nIiA6ICJwcmV2aW91c1NpYmxpbmciLAoJCQkJCQkJcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlLAoJCQkJCQkJbmFtZSA9IG9mVHlwZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksCgkJCQkJCQl1c2VDYWNoZSA9ICF4bWwgJiYgIW9mVHlwZTsKCgkJCQkJCWlmICggcGFyZW50ICkgewoKCQkJCQkJCS8vIDooZmlyc3R8bGFzdHxvbmx5KS0oY2hpbGR8b2YtdHlwZSkKCQkJCQkJCWlmICggc2ltcGxlICkgewoJCQkJCQkJCXdoaWxlICggZGlyICkgewoJCQkJCQkJCQlub2RlID0gZWxlbTsKCQkJCQkJCQkJd2hpbGUgKCAobm9kZSA9IG5vZGVbIGRpciBdKSApIHsKCQkJCQkJCQkJCWlmICggb2ZUeXBlID8gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lIDogbm9kZS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQkJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJCQkJCQl9CgkJCQkJCQkJCX0KCQkJCQkJCQkJLy8gUmV2ZXJzZSBkaXJlY3Rpb24gZm9yIDpvbmx5LSogKGlmIHdlIGhhdmVuJ3QgeWV0IGRvbmUgc28pCgkJCQkJCQkJCXN0YXJ0ID0gZGlyID0gdHlwZSA9PT0gIm9ubHkiICYmICFzdGFydCAmJiAibmV4dFNpYmxpbmciOwoJCQkJCQkJCX0KCQkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJCX0KCgkJCQkJCQlzdGFydCA9IFsgZm9yd2FyZCA/IHBhcmVudC5maXJzdENoaWxkIDogcGFyZW50Lmxhc3RDaGlsZCBdOwoKCQkJCQkJCS8vIG5vbi14bWwgOm50aC1jaGlsZCguLi4pIHN0b3JlcyBjYWNoZSBkYXRhIG9uIGBwYXJlbnRgCgkJCQkJCQlpZiAoIGZvcndhcmQgJiYgdXNlQ2FjaGUgKSB7CgkJCQkJCQkJLy8gU2VlayBgZWxlbWAgZnJvbSBhIHByZXZpb3VzbHktY2FjaGVkIGluZGV4CgkJCQkJCQkJb3V0ZXJDYWNoZSA9IHBhcmVudFsgZXhwYW5kbyBdIHx8IChwYXJlbnRbIGV4cGFuZG8gXSA9IHt9KTsKCQkJCQkJCQljYWNoZSA9IG91dGVyQ2FjaGVbIHR5cGUgXSB8fCBbXTsKCQkJCQkJCQlub2RlSW5kZXggPSBjYWNoZVswXSA9PT0gZGlycnVucyAmJiBjYWNoZVsxXTsKCQkJCQkJCQlkaWZmID0gY2FjaGVbMF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbMl07CgkJCQkJCQkJbm9kZSA9IG5vZGVJbmRleCAmJiBwYXJlbnQuY2hpbGROb2Rlc1sgbm9kZUluZGV4IF07CgoJCQkJCQkJCXdoaWxlICggKG5vZGUgPSArK25vZGVJbmRleCAmJiBub2RlICYmIG5vZGVbIGRpciBdIHx8CgoJCQkJCQkJCQkvLyBGYWxsYmFjayB0byBzZWVraW5nIGBlbGVtYCBmcm9tIHRoZSBzdGFydAoJCQkJCQkJCQkoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSApIHsKCgkJCQkJCQkJCS8vIFdoZW4gZm91bmQsIGNhY2hlIGluZGV4ZXMgb24gYHBhcmVudGAgYW5kIGJyZWFrCgkJCQkJCQkJCWlmICggbm9kZS5ub2RlVHlwZSA9PT0gMSAmJiArK2RpZmYgJiYgbm9kZSA9PT0gZWxlbSApIHsKCQkJCQkJCQkJCW91dGVyQ2FjaGVbIHR5cGUgXSA9IFsgZGlycnVucywgbm9kZUluZGV4LCBkaWZmIF07CgkJCQkJCQkJCQlicmVhazsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCgkJCQkJCQkvLyBVc2UgcHJldmlvdXNseS1jYWNoZWQgZWxlbWVudCBpbmRleCBpZiBhdmFpbGFibGUKCQkJCQkJCX0gZWxzZSBpZiAoIHVzZUNhY2hlICYmIChjYWNoZSA9IChlbGVtWyBleHBhbmRvIF0gfHwgKGVsZW1bIGV4cGFuZG8gXSA9IHt9KSlbIHR5cGUgXSkgJiYgY2FjaGVbMF0gPT09IGRpcnJ1bnMgKSB7CgkJCQkJCQkJZGlmZiA9IGNhY2hlWzFdOwoKCQkJCQkJCS8vIHhtbCA6bnRoLWNoaWxkKC4uLikgb3IgOm50aC1sYXN0LWNoaWxkKC4uLikgb3IgOm50aCgtbGFzdCk/LW9mLXR5cGUoLi4uKQoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkvLyBVc2UgdGhlIHNhbWUgbG9vcCBhcyBhYm92ZSB0byBzZWVrIGBlbGVtYCBmcm9tIHRoZSBzdGFydAoJCQkJCQkJCXdoaWxlICggKG5vZGUgPSArK25vZGVJbmRleCAmJiBub2RlICYmIG5vZGVbIGRpciBdIHx8CgkJCQkJCQkJCShkaWZmID0gbm9kZUluZGV4ID0gMCkgfHwgc3RhcnQucG9wKCkpICkgewoKCQkJCQkJCQkJaWYgKCAoIG9mVHlwZSA/IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6IG5vZGUubm9kZVR5cGUgPT09IDEgKSAmJiArK2RpZmYgKSB7CgkJCQkJCQkJCQkvLyBDYWNoZSB0aGUgaW5kZXggb2YgZWFjaCBlbmNvdW50ZXJlZCBlbGVtZW50CgkJCQkJCQkJCQlpZiAoIHVzZUNhY2hlICkgewoJCQkJCQkJCQkJCShub2RlWyBleHBhbmRvIF0gfHwgKG5vZGVbIGV4cGFuZG8gXSA9IHt9KSlbIHR5cGUgXSA9IFsgZGlycnVucywgZGlmZiBdOwoJCQkJCQkJCQkJfQoKCQkJCQkJCQkJCWlmICggbm9kZSA9PT0gZWxlbSApIHsKCQkJCQkJCQkJCQlicmVhazsKCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQkvLyBJbmNvcnBvcmF0ZSB0aGUgb2Zmc2V0LCB0aGVuIGNoZWNrIGFnYWluc3QgY3ljbGUgc2l6ZQoJCQkJCQkJZGlmZiAtPSBsYXN0OwoJCQkJCQkJcmV0dXJuIGRpZmYgPT09IGZpcnN0IHx8ICggZGlmZiAlIGZpcnN0ID09PSAwICYmIGRpZmYgLyBmaXJzdCA+PSAwICk7CgkJCQkJCX0KCQkJCQl9OwoJCQl9LAoKCQkJIlBTRVVETyI6IGZ1bmN0aW9uKCBwc2V1ZG8sIGFyZ3VtZW50ICkgewoJCQkJLy8gcHNldWRvLWNsYXNzIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI3BzZXVkby1jbGFzc2VzCgkJCQkvLyBQcmlvcml0aXplIGJ5IGNhc2Ugc2Vuc2l0aXZpdHkgaW4gY2FzZSBjdXN0b20gcHNldWRvcyBhcmUgYWRkZWQgd2l0aCB1cHBlcmNhc2UgbGV0dGVycwoJCQkJLy8gUmVtZW1iZXIgdGhhdCBzZXRGaWx0ZXJzIGluaGVyaXRzIGZyb20gcHNldWRvcwoJCQkJdmFyIGFyZ3MsCgkJCQkJZm4gPSBFeHByLnBzZXVkb3NbIHBzZXVkbyBdIHx8IEV4cHIuc2V0RmlsdGVyc1sgcHNldWRvLnRvTG93ZXJDYXNlKCkgXSB8fAoJCQkJCQlTaXp6bGUuZXJyb3IoICJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIgKyBwc2V1ZG8gKTsKCgkJCQkvLyBUaGUgdXNlciBtYXkgdXNlIGNyZWF0ZVBzZXVkbyB0byBpbmRpY2F0ZSB0aGF0CgkJCQkvLyBhcmd1bWVudHMgYXJlIG5lZWRlZCB0byBjcmVhdGUgdGhlIGZpbHRlciBmdW5jdGlvbgoJCQkJLy8ganVzdCBhcyBTaXp6bGUgZG9lcwoJCQkJaWYgKCBmblsgZXhwYW5kbyBdICkgewoJCQkJCXJldHVybiBmbiggYXJndW1lbnQgKTsKCQkJCX0KCgkJCQkvLyBCdXQgbWFpbnRhaW4gc3VwcG9ydCBmb3Igb2xkIHNpZ25hdHVyZXMKCQkJCWlmICggZm4ubGVuZ3RoID4gMSApIHsKCQkJCQlhcmdzID0gWyBwc2V1ZG8sIHBzZXVkbywgIiIsIGFyZ3VtZW50IF07CgkJCQkJcmV0dXJuIEV4cHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eSggcHNldWRvLnRvTG93ZXJDYXNlKCkgKSA/CgkJCQkJCW1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgbWF0Y2hlcyApIHsKCQkJCQkJCXZhciBpZHgsCgkJCQkJCQkJbWF0Y2hlZCA9IGZuKCBzZWVkLCBhcmd1bWVudCApLAoJCQkJCQkJCWkgPSBtYXRjaGVkLmxlbmd0aDsKCQkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJCWlkeCA9IGluZGV4T2YoIHNlZWQsIG1hdGNoZWRbaV0gKTsKCQkJCQkJCQlzZWVkWyBpZHggXSA9ICEoIG1hdGNoZXNbIGlkeCBdID0gbWF0Y2hlZFtpXSApOwoJCQkJCQkJfQoJCQkJCQl9KSA6CgkJCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQkJcmV0dXJuIGZuKCBlbGVtLCAwLCBhcmdzICk7CgkJCQkJCX07CgkJCQl9CgoJCQkJcmV0dXJuIGZuOwoJCQl9CgkJfSwKCgkJcHNldWRvczogewoJCQkvLyBQb3RlbnRpYWxseSBjb21wbGV4IHBzZXVkb3MKCQkJIm5vdCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCQkvLyBUcmltIHRoZSBzZWxlY3RvciBwYXNzZWQgdG8gY29tcGlsZQoJCQkJLy8gdG8gYXZvaWQgdHJlYXRpbmcgbGVhZGluZyBhbmQgdHJhaWxpbmcKCQkJCS8vIHNwYWNlcyBhcyBjb21iaW5hdG9ycwoJCQkJdmFyIGlucHV0ID0gW10sCgkJCQkJcmVzdWx0cyA9IFtdLAoJCQkJCW1hdGNoZXIgPSBjb21waWxlKCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgIiQxIiApICk7CgoJCQkJcmV0dXJuIG1hdGNoZXJbIGV4cGFuZG8gXSA/CgkJCQkJbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzLCBjb250ZXh0LCB4bWwgKSB7CgkJCQkJCXZhciBlbGVtLAoJCQkJCQkJdW5tYXRjaGVkID0gbWF0Y2hlciggc2VlZCwgbnVsbCwgeG1sLCBbXSApLAoJCQkJCQkJaSA9IHNlZWQubGVuZ3RoOwoKCQkJCQkJLy8gTWF0Y2ggZWxlbWVudHMgdW5tYXRjaGVkIGJ5IGBtYXRjaGVyYAoJCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJCWlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkgewoJCQkJCQkJCXNlZWRbaV0gPSAhKG1hdGNoZXNbaV0gPSBlbGVtKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0pIDoKCQkJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJCQlpbnB1dFswXSA9IGVsZW07CgkJCQkJCW1hdGNoZXIoIGlucHV0LCBudWxsLCB4bWwsIHJlc3VsdHMgKTsKCQkJCQkJLy8gRG9uJ3Qga2VlcCB0aGUgZWxlbWVudCAoaXNzdWUgIzI5OSkKCQkJCQkJaW5wdXRbMF0gPSBudWxsOwoJCQkJCQlyZXR1cm4gIXJlc3VsdHMucG9wKCk7CgkJCQkJfTsKCQkJfSksCgoJCQkiaGFzIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQlyZXR1cm4gU2l6emxlKCBzZWxlY3RvciwgZWxlbSApLmxlbmd0aCA+IDA7CgkJCQl9OwoJCQl9KSwKCgkJCSJjb250YWlucyI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggdGV4dCApIHsKCQkJCXRleHQgPSB0ZXh0LnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuICggZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVyVGV4dCB8fCBnZXRUZXh0KCBlbGVtICkgKS5pbmRleE9mKCB0ZXh0ICkgPiAtMTsKCQkJCX07CgkJCX0pLAoKCQkJLy8gIldoZXRoZXIgYW4gZWxlbWVudCBpcyByZXByZXNlbnRlZCBieSBhIDpsYW5nKCkgc2VsZWN0b3IKCQkJLy8gaXMgYmFzZWQgc29sZWx5IG9uIHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUKCQkJLy8gYmVpbmcgZXF1YWwgdG8gdGhlIGlkZW50aWZpZXIgQywKCQkJLy8gb3IgYmVnaW5uaW5nIHdpdGggdGhlIGlkZW50aWZpZXIgQyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSAiLSIuCgkJCS8vIFRoZSBtYXRjaGluZyBvZiBDIGFnYWluc3QgdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZSBpcyBwZXJmb3JtZWQgY2FzZS1pbnNlbnNpdGl2ZWx5LgoJCQkvLyBUaGUgaWRlbnRpZmllciBDIGRvZXMgbm90IGhhdmUgdG8gYmUgYSB2YWxpZCBsYW5ndWFnZSBuYW1lLiIKCQkJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNsYW5nLXBzZXVkbwoJCQkibGFuZyI6IG1hcmtGdW5jdGlvbiggZnVuY3Rpb24oIGxhbmcgKSB7CgkJCQkvLyBsYW5nIHZhbHVlIG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyCgkJCQlpZiAoICFyaWRlbnRpZmllci50ZXN0KGxhbmcgfHwgIiIpICkgewoJCQkJCVNpenpsZS5lcnJvciggInVuc3VwcG9ydGVkIGxhbmc6ICIgKyBsYW5nICk7CgkJCQl9CgkJCQlsYW5nID0gbGFuZy5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIGVsZW1MYW5nOwoJCQkJCWRvIHsKCQkJCQkJaWYgKCAoZWxlbUxhbmcgPSBkb2N1bWVudElzSFRNTCA/CgkJCQkJCQllbGVtLmxhbmcgOgoJCQkJCQkJZWxlbS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIikgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoImxhbmciKSkgKSB7CgoJCQkJCQkJZWxlbUxhbmcgPSBlbGVtTGFuZy50b0xvd2VyQ2FzZSgpOwoJCQkJCQkJcmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YoIGxhbmcgKyAiLSIgKSA9PT0gMDsKCQkJCQkJfQoJCQkJCX0gd2hpbGUgKCAoZWxlbSA9IGVsZW0ucGFyZW50Tm9kZSkgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX07CgkJCX0pLAoKCQkJLy8gTWlzY2VsbGFuZW91cwoJCQkidGFyZ2V0IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQl2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbiAmJiB3aW5kb3cubG9jYXRpb24uaGFzaDsKCQkJCXJldHVybiBoYXNoICYmIGhhc2guc2xpY2UoIDEgKSA9PT0gZWxlbS5pZDsKCQkJfSwKCgkJCSJyb290IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbSA9PT0gZG9jRWxlbTsKCQkJfSwKCgkJCSJmb2N1cyI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKCFkb2N1bWVudC5oYXNGb2N1cyB8fCBkb2N1bWVudC5oYXNGb2N1cygpKSAmJiAhIShlbGVtLnR5cGUgfHwgZWxlbS5ocmVmIHx8IH5lbGVtLnRhYkluZGV4KTsKCQkJfSwKCgkJCS8vIEJvb2xlYW4gcHJvcGVydGllcwoJCQkiZW5hYmxlZCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IGZhbHNlOwoJCQl9LAoKCQkJImRpc2FibGVkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTsKCQkJfSwKCgkJCSJjaGVja2VkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBJbiBDU1MzLCA6Y2hlY2tlZCBzaG91bGQgcmV0dXJuIGJvdGggY2hlY2tlZCBhbmQgc2VsZWN0ZWQgZWxlbWVudHMKCQkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkCgkJCQl2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gKG5vZGVOYW1lID09PSAiaW5wdXQiICYmICEhZWxlbS5jaGVja2VkKSB8fCAobm9kZU5hbWUgPT09ICJvcHRpb24iICYmICEhZWxlbS5zZWxlY3RlZCk7CgkJCX0sCgoJCQkic2VsZWN0ZWQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCS8vIEFjY2Vzc2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHQKCQkJCS8vIG9wdGlvbnMgaW4gU2FmYXJpIHdvcmsgcHJvcGVybHkKCQkJCWlmICggZWxlbS5wYXJlbnROb2RlICkgewoJCQkJCWVsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4OwoJCQkJfQoKCQkJCXJldHVybiBlbGVtLnNlbGVjdGVkID09PSB0cnVlOwoJCQl9LAoKCQkJLy8gQ29udGVudHMKCQkJImVtcHR5IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2VtcHR5LXBzZXVkbwoJCQkJLy8gOmVtcHR5IGlzIG5lZ2F0ZWQgYnkgZWxlbWVudCAoMSkgb3IgY29udGVudCBub2RlcyAodGV4dDogMzsgY2RhdGE6IDQ7IGVudGl0eSByZWY6IDUpLAoJCQkJLy8gICBidXQgbm90IGJ5IG90aGVycyAoY29tbWVudDogODsgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbjogNzsgZXRjLikKCQkJCS8vIG5vZGVUeXBlIDwgNiB3b3JrcyBiZWNhdXNlIGF0dHJpYnV0ZXMgKDIpIGRvIG5vdCBhcHBlYXIgYXMgY2hpbGRyZW4KCQkJCWZvciAoIGVsZW0gPSBlbGVtLmZpcnN0Q2hpbGQ7IGVsZW07IGVsZW0gPSBlbGVtLm5leHRTaWJsaW5nICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA8IDYgKSB7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfSwKCgkJCSJwYXJlbnQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiAhRXhwci5wc2V1ZG9zWyJlbXB0eSJdKCBlbGVtICk7CgkJCX0sCgoJCQkvLyBFbGVtZW50L2lucHV0IHR5cGVzCgkJCSJoZWFkZXIiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiByaGVhZGVyLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTsKCQkJfSwKCgkJCSJpbnB1dCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIHJpbnB1dHMudGVzdCggZWxlbS5ub2RlTmFtZSApOwoJCQl9LAoKCQkJImJ1dHRvbiI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gbmFtZSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09ICJidXR0b24iIHx8IG5hbWUgPT09ICJidXR0b24iOwoJCQl9LAoKCQkJInRleHQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciBhdHRyOwoJCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiAmJgoJCQkJCWVsZW0udHlwZSA9PT0gInRleHQiICYmCgoJCQkJCS8vIFN1cHBvcnQ6IElFPDgKCQkJCQkvLyBOZXcgSFRNTDUgYXR0cmlidXRlIHZhbHVlcyAoZS5nLiwgInNlYXJjaCIpIGFwcGVhciB3aXRoIGVsZW0udHlwZSA9PT0gInRleHQiCgkJCQkJKCAoYXR0ciA9IGVsZW0uZ2V0QXR0cmlidXRlKCJ0eXBlIikpID09IG51bGwgfHwgYXR0ci50b0xvd2VyQ2FzZSgpID09PSAidGV4dCIgKTsKCQkJfSwKCgkJCS8vIFBvc2l0aW9uLWluLWNvbGxlY3Rpb24KCQkJImZpcnN0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbigpIHsKCQkJCXJldHVybiBbIDAgXTsKCQkJfSksCgoJCQkibGFzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJcmV0dXJuIFsgbGVuZ3RoIC0gMSBdOwoJCQl9KSwKCgkJCSJlcSI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHsKCQkJCXJldHVybiBbIGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQgXTsKCQkJfSksCgoJCQkiZXZlbiI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJdmFyIGkgPSAwOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJIm9kZCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJdmFyIGkgPSAxOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJImx0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkgewoJCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQkJZm9yICggOyAtLWkgPj0gMDsgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJImd0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkgewoJCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQkJZm9yICggOyArK2kgPCBsZW5ndGg7ICkgewoJCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCQl9CgkJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCQl9KQoJCX0KCX07CgoJRXhwci5wc2V1ZG9zWyJudGgiXSA9IEV4cHIucHNldWRvc1siZXEiXTsKCgkvLyBBZGQgYnV0dG9uL2lucHV0IHR5cGUgcHNldWRvcwoJZm9yICggaSBpbiB7IHJhZGlvOiB0cnVlLCBjaGVja2JveDogdHJ1ZSwgZmlsZTogdHJ1ZSwgcGFzc3dvcmQ6IHRydWUsIGltYWdlOiB0cnVlIH0gKSB7CgkJRXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVJbnB1dFBzZXVkbyggaSApOwoJfQoJZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgcmVzZXQ6IHRydWUgfSApIHsKCQlFeHByLnBzZXVkb3NbIGkgXSA9IGNyZWF0ZUJ1dHRvblBzZXVkbyggaSApOwoJfQoKCS8vIEVhc3kgQVBJIGZvciBjcmVhdGluZyBuZXcgc2V0RmlsdGVycwoJZnVuY3Rpb24gc2V0RmlsdGVycygpIHt9CglzZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvczsKCUV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7CgoJdG9rZW5pemUgPSBTaXp6bGUudG9rZW5pemUgPSBmdW5jdGlvbiggc2VsZWN0b3IsIHBhcnNlT25seSApIHsKCQl2YXIgbWF0Y2hlZCwgbWF0Y2gsIHRva2VucywgdHlwZSwKCQkJc29GYXIsIGdyb3VwcywgcHJlRmlsdGVycywKCQkJY2FjaGVkID0gdG9rZW5DYWNoZVsgc2VsZWN0b3IgKyAiICIgXTsKCgkJaWYgKCBjYWNoZWQgKSB7CgkJCXJldHVybiBwYXJzZU9ubHkgPyAwIDogY2FjaGVkLnNsaWNlKCAwICk7CgkJfQoKCQlzb0ZhciA9IHNlbGVjdG9yOwoJCWdyb3VwcyA9IFtdOwoJCXByZUZpbHRlcnMgPSBFeHByLnByZUZpbHRlcjsKCgkJd2hpbGUgKCBzb0ZhciApIHsKCgkJCS8vIENvbW1hIGFuZCBmaXJzdCBydW4KCQkJaWYgKCAhbWF0Y2hlZCB8fCAobWF0Y2ggPSByY29tbWEuZXhlYyggc29GYXIgKSkgKSB7CgkJCQlpZiAoIG1hdGNoICkgewoJCQkJCS8vIERvbid0IGNvbnN1bWUgdHJhaWxpbmcgY29tbWFzIGFzIHZhbGlkCgkJCQkJc29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hbMF0ubGVuZ3RoICkgfHwgc29GYXI7CgkJCQl9CgkJCQlncm91cHMucHVzaCggKHRva2VucyA9IFtdKSApOwoJCQl9CgoJCQltYXRjaGVkID0gZmFsc2U7CgoJCQkvLyBDb21iaW5hdG9ycwoJCQlpZiAoIChtYXRjaCA9IHJjb21iaW5hdG9ycy5leGVjKCBzb0ZhciApKSApIHsKCQkJCW1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpOwoJCQkJdG9rZW5zLnB1c2goewoJCQkJCXZhbHVlOiBtYXRjaGVkLAoJCQkJCS8vIENhc3QgZGVzY2VuZGFudCBjb21iaW5hdG9ycyB0byBzcGFjZQoJCQkJCXR5cGU6IG1hdGNoWzBdLnJlcGxhY2UoIHJ0cmltLCAiICIgKQoJCQkJfSk7CgkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQl9CgoJCQkvLyBGaWx0ZXJzCgkJCWZvciAoIHR5cGUgaW4gRXhwci5maWx0ZXIgKSB7CgkJCQlpZiAoIChtYXRjaCA9IG1hdGNoRXhwclsgdHlwZSBdLmV4ZWMoIHNvRmFyICkpICYmICghcHJlRmlsdGVyc1sgdHlwZSBdIHx8CgkJCQkJKG1hdGNoID0gcHJlRmlsdGVyc1sgdHlwZSBdKCBtYXRjaCApKSkgKSB7CgkJCQkJbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7CgkJCQkJdG9rZW5zLnB1c2goewoJCQkJCQl2YWx1ZTogbWF0Y2hlZCwKCQkJCQkJdHlwZTogdHlwZSwKCQkJCQkJbWF0Y2hlczogbWF0Y2gKCQkJCQl9KTsKCQkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQkJfQoJCQl9CgoJCQlpZiAoICFtYXRjaGVkICkgewoJCQkJYnJlYWs7CgkJCX0KCQl9CgoJCS8vIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBpbnZhbGlkIGV4Y2VzcwoJCS8vIGlmIHdlJ3JlIGp1c3QgcGFyc2luZwoJCS8vIE90aGVyd2lzZSwgdGhyb3cgYW4gZXJyb3Igb3IgcmV0dXJuIHRva2VucwoJCXJldHVybiBwYXJzZU9ubHkgPwoJCQlzb0Zhci5sZW5ndGggOgoJCQlzb0ZhciA/CgkJCQlTaXp6bGUuZXJyb3IoIHNlbGVjdG9yICkgOgoJCQkJLy8gQ2FjaGUgdGhlIHRva2VucwoJCQkJdG9rZW5DYWNoZSggc2VsZWN0b3IsIGdyb3VwcyApLnNsaWNlKCAwICk7Cgl9OwoKCWZ1bmN0aW9uIHRvU2VsZWN0b3IoIHRva2VucyApIHsKCQl2YXIgaSA9IDAsCgkJCWxlbiA9IHRva2Vucy5sZW5ndGgsCgkJCXNlbGVjdG9yID0gIiI7CgkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCXNlbGVjdG9yICs9IHRva2Vuc1tpXS52YWx1ZTsKCQl9CgkJcmV0dXJuIHNlbGVjdG9yOwoJfQoKCWZ1bmN0aW9uIGFkZENvbWJpbmF0b3IoIG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UgKSB7CgkJdmFyIGRpciA9IGNvbWJpbmF0b3IuZGlyLAoJCQljaGVja05vbkVsZW1lbnRzID0gYmFzZSAmJiBkaXIgPT09ICJwYXJlbnROb2RlIiwKCQkJZG9uZU5hbWUgPSBkb25lKys7CgoJCXJldHVybiBjb21iaW5hdG9yLmZpcnN0ID8KCQkJLy8gQ2hlY2sgYWdhaW5zdCBjbG9zZXN0IGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50CgkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkgewoJCQkJCQlyZXR1cm4gbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICk7CgkJCQkJfQoJCQkJfQoJCQl9IDoKCgkJCS8vIENoZWNrIGFnYWluc3QgYWxsIGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50cwoJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJdmFyIG9sZENhY2hlLCBvdXRlckNhY2hlLAoJCQkJCW5ld0NhY2hlID0gWyBkaXJydW5zLCBkb25lTmFtZSBdOwoKCQkJCS8vIFdlIGNhbid0IHNldCBhcmJpdHJhcnkgZGF0YSBvbiBYTUwgbm9kZXMsIHNvIHRoZXkgZG9uJ3QgYmVuZWZpdCBmcm9tIGRpciBjYWNoaW5nCgkJCQlpZiAoIHhtbCApIHsKCQkJCQl3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkgewoJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgY2hlY2tOb25FbGVtZW50cyApIHsKCQkJCQkJCWlmICggbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7CgkJCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7CgkJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkgewoJCQkJCQkJb3V0ZXJDYWNoZSA9IGVsZW1bIGV4cGFuZG8gXSB8fCAoZWxlbVsgZXhwYW5kbyBdID0ge30pOwoJCQkJCQkJaWYgKCAob2xkQ2FjaGUgPSBvdXRlckNhY2hlWyBkaXIgXSkgJiYKCQkJCQkJCQlvbGRDYWNoZVsgMCBdID09PSBkaXJydW5zICYmIG9sZENhY2hlWyAxIF0gPT09IGRvbmVOYW1lICkgewoKCQkJCQkJCQkvLyBBc3NpZ24gdG8gbmV3Q2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50cwoJCQkJCQkJCXJldHVybiAobmV3Q2FjaGVbIDIgXSA9IG9sZENhY2hlWyAyIF0pOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkvLyBSZXVzZSBuZXdjYWNoZSBzbyByZXN1bHRzIGJhY2stcHJvcGFnYXRlIHRvIHByZXZpb3VzIGVsZW1lbnRzCgkJCQkJCQkJb3V0ZXJDYWNoZVsgZGlyIF0gPSBuZXdDYWNoZTsKCgkJCQkJCQkJLy8gQSBtYXRjaCBtZWFucyB3ZSdyZSBkb25lOyBhIGZhaWwgbWVhbnMgd2UgaGF2ZSB0byBrZWVwIGNoZWNraW5nCgkJCQkJCQkJaWYgKCAobmV3Q2FjaGVbIDIgXSA9IG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApKSApIHsKCQkJCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9OwoJfQoKCWZ1bmN0aW9uIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApIHsKCQlyZXR1cm4gbWF0Y2hlcnMubGVuZ3RoID4gMSA/CgkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggIW1hdGNoZXJzW2ldKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiB0cnVlOwoJCQl9IDoKCQkJbWF0Y2hlcnNbMF07Cgl9CgoJZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IsIGNvbnRleHRzLCByZXN1bHRzICkgewoJCXZhciBpID0gMCwKCQkJbGVuID0gY29udGV4dHMubGVuZ3RoOwoJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQlTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0c1tpXSwgcmVzdWx0cyApOwoJCX0KCQlyZXR1cm4gcmVzdWx0czsKCX0KCglmdW5jdGlvbiBjb25kZW5zZSggdW5tYXRjaGVkLCBtYXAsIGZpbHRlciwgY29udGV4dCwgeG1sICkgewoJCXZhciBlbGVtLAoJCQluZXdVbm1hdGNoZWQgPSBbXSwKCQkJaSA9IDAsCgkJCWxlbiA9IHVubWF0Y2hlZC5sZW5ndGgsCgkJCW1hcHBlZCA9IG1hcCAhPSBudWxsOwoKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgKSB7CgkJCQlpZiAoICFmaWx0ZXIgfHwgZmlsdGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQluZXdVbm1hdGNoZWQucHVzaCggZWxlbSApOwoJCQkJCWlmICggbWFwcGVkICkgewoJCQkJCQltYXAucHVzaCggaSApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIG5ld1VubWF0Y2hlZDsKCX0KCglmdW5jdGlvbiBzZXRNYXRjaGVyKCBwcmVGaWx0ZXIsIHNlbGVjdG9yLCBtYXRjaGVyLCBwb3N0RmlsdGVyLCBwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IgKSB7CgkJaWYgKCBwb3N0RmlsdGVyICYmICFwb3N0RmlsdGVyWyBleHBhbmRvIF0gKSB7CgkJCXBvc3RGaWx0ZXIgPSBzZXRNYXRjaGVyKCBwb3N0RmlsdGVyICk7CgkJfQoJCWlmICggcG9zdEZpbmRlciAmJiAhcG9zdEZpbmRlclsgZXhwYW5kbyBdICkgewoJCQlwb3N0RmluZGVyID0gc2V0TWF0Y2hlciggcG9zdEZpbmRlciwgcG9zdFNlbGVjdG9yICk7CgkJfQoJCXJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIHJlc3VsdHMsIGNvbnRleHQsIHhtbCApIHsKCQkJdmFyIHRlbXAsIGksIGVsZW0sCgkJCQlwcmVNYXAgPSBbXSwKCQkJCXBvc3RNYXAgPSBbXSwKCQkJCXByZWV4aXN0aW5nID0gcmVzdWx0cy5sZW5ndGgsCgoJCQkJLy8gR2V0IGluaXRpYWwgZWxlbWVudHMgZnJvbSBzZWVkIG9yIGNvbnRleHQKCQkJCWVsZW1zID0gc2VlZCB8fCBtdWx0aXBsZUNvbnRleHRzKCBzZWxlY3RvciB8fCAiKiIsIGNvbnRleHQubm9kZVR5cGUgPyBbIGNvbnRleHQgXSA6IGNvbnRleHQsIFtdICksCgoJCQkJLy8gUHJlZmlsdGVyIHRvIGdldCBtYXRjaGVyIGlucHV0LCBwcmVzZXJ2aW5nIGEgbWFwIGZvciBzZWVkLXJlc3VsdHMgc3luY2hyb25pemF0aW9uCgkJCQltYXRjaGVySW4gPSBwcmVGaWx0ZXIgJiYgKCBzZWVkIHx8ICFzZWxlY3RvciApID8KCQkJCQljb25kZW5zZSggZWxlbXMsIHByZU1hcCwgcHJlRmlsdGVyLCBjb250ZXh0LCB4bWwgKSA6CgkJCQkJZWxlbXMsCgoJCQkJbWF0Y2hlck91dCA9IG1hdGNoZXIgPwoJCQkJCS8vIElmIHdlIGhhdmUgYSBwb3N0RmluZGVyLCBvciBmaWx0ZXJlZCBzZWVkLCBvciBub24tc2VlZCBwb3N0RmlsdGVyIG9yIHByZWV4aXN0aW5nIHJlc3VsdHMsCgkJCQkJcG9zdEZpbmRlciB8fCAoIHNlZWQgPyBwcmVGaWx0ZXIgOiBwcmVleGlzdGluZyB8fCBwb3N0RmlsdGVyICkgPwoKCQkJCQkJLy8gLi4uaW50ZXJtZWRpYXRlIHByb2Nlc3NpbmcgaXMgbmVjZXNzYXJ5CgkJCQkJCVtdIDoKCgkJCQkJCS8vIC4uLm90aGVyd2lzZSB1c2UgcmVzdWx0cyBkaXJlY3RseQoJCQkJCQlyZXN1bHRzIDoKCQkJCQltYXRjaGVySW47CgoJCQkvLyBGaW5kIHByaW1hcnkgbWF0Y2hlcwoJCQlpZiAoIG1hdGNoZXIgKSB7CgkJCQltYXRjaGVyKCBtYXRjaGVySW4sIG1hdGNoZXJPdXQsIGNvbnRleHQsIHhtbCApOwoJCQl9CgoJCQkvLyBBcHBseSBwb3N0RmlsdGVyCgkJCWlmICggcG9zdEZpbHRlciApIHsKCQkJCXRlbXAgPSBjb25kZW5zZSggbWF0Y2hlck91dCwgcG9zdE1hcCApOwoJCQkJcG9zdEZpbHRlciggdGVtcCwgW10sIGNvbnRleHQsIHhtbCApOwoKCQkJCS8vIFVuLW1hdGNoIGZhaWxpbmcgZWxlbWVudHMgYnkgbW92aW5nIHRoZW0gYmFjayB0byBtYXRjaGVySW4KCQkJCWkgPSB0ZW1wLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggKGVsZW0gPSB0ZW1wW2ldKSApIHsKCQkJCQkJbWF0Y2hlck91dFsgcG9zdE1hcFtpXSBdID0gIShtYXRjaGVySW5bIHBvc3RNYXBbaV0gXSA9IGVsZW0pOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKCBzZWVkICkgewoJCQkJaWYgKCBwb3N0RmluZGVyIHx8IHByZUZpbHRlciApIHsKCQkJCQlpZiAoIHBvc3RGaW5kZXIgKSB7CgkJCQkJCS8vIEdldCB0aGUgZmluYWwgbWF0Y2hlck91dCBieSBjb25kZW5zaW5nIHRoaXMgaW50ZXJtZWRpYXRlIGludG8gcG9zdEZpbmRlciBjb250ZXh0cwoJCQkJCQl0ZW1wID0gW107CgkJCQkJCWkgPSBtYXRjaGVyT3V0Lmxlbmd0aDsKCQkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgKSB7CgkJCQkJCQkJLy8gUmVzdG9yZSBtYXRjaGVySW4gc2luY2UgZWxlbSBpcyBub3QgeWV0IGEgZmluYWwgbWF0Y2gKCQkJCQkJCQl0ZW1wLnB1c2goIChtYXRjaGVySW5baV0gPSBlbGVtKSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXBvc3RGaW5kZXIoIG51bGwsIChtYXRjaGVyT3V0ID0gW10pLCB0ZW1wLCB4bWwgKTsKCQkJCQl9CgoJCQkJCS8vIE1vdmUgbWF0Y2hlZCBlbGVtZW50cyBmcm9tIHNlZWQgdG8gcmVzdWx0cyB0byBrZWVwIHRoZW0gc3luY2hyb25pemVkCgkJCQkJaSA9IG1hdGNoZXJPdXQubGVuZ3RoOwoJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgJiYKCQkJCQkJCSh0ZW1wID0gcG9zdEZpbmRlciA/IGluZGV4T2YoIHNlZWQsIGVsZW0gKSA6IHByZU1hcFtpXSkgPiAtMSApIHsKCgkJCQkJCQlzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkvLyBBZGQgZWxlbWVudHMgdG8gcmVzdWx0cywgdGhyb3VnaCBwb3N0RmluZGVyIGlmIGRlZmluZWQKCQkJfSBlbHNlIHsKCQkJCW1hdGNoZXJPdXQgPSBjb25kZW5zZSgKCQkJCQltYXRjaGVyT3V0ID09PSByZXN1bHRzID8KCQkJCQkJbWF0Y2hlck91dC5zcGxpY2UoIHByZWV4aXN0aW5nLCBtYXRjaGVyT3V0Lmxlbmd0aCApIDoKCQkJCQkJbWF0Y2hlck91dAoJCQkJKTsKCQkJCWlmICggcG9zdEZpbmRlciApIHsKCQkJCQlwb3N0RmluZGVyKCBudWxsLCByZXN1bHRzLCBtYXRjaGVyT3V0LCB4bWwgKTsKCQkJCX0gZWxzZSB7CgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgbWF0Y2hlck91dCApOwoJCQkJfQoJCQl9CgkJfSk7Cgl9CgoJZnVuY3Rpb24gbWF0Y2hlckZyb21Ub2tlbnMoIHRva2VucyApIHsKCQl2YXIgY2hlY2tDb250ZXh0LCBtYXRjaGVyLCBqLAoJCQlsZW4gPSB0b2tlbnMubGVuZ3RoLAoJCQlsZWFkaW5nUmVsYXRpdmUgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbMF0udHlwZSBdLAoJCQlpbXBsaWNpdFJlbGF0aXZlID0gbGVhZGluZ1JlbGF0aXZlIHx8IEV4cHIucmVsYXRpdmVbIiAiXSwKCQkJaSA9IGxlYWRpbmdSZWxhdGl2ZSA/IDEgOiAwLAoKCQkJLy8gVGhlIGZvdW5kYXRpb25hbCBtYXRjaGVyIGVuc3VyZXMgdGhhdCBlbGVtZW50cyBhcmUgcmVhY2hhYmxlIGZyb20gdG9wLWxldmVsIGNvbnRleHQocykKCQkJbWF0Y2hDb250ZXh0ID0gYWRkQ29tYmluYXRvciggZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbSA9PT0gY2hlY2tDb250ZXh0OwoJCQl9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlICksCgkJCW1hdGNoQW55Q29udGV4dCA9IGFkZENvbWJpbmF0b3IoIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGluZGV4T2YoIGNoZWNrQ29udGV4dCwgZWxlbSApID4gLTE7CgkJCX0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUgKSwKCQkJbWF0Y2hlcnMgPSBbIGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl2YXIgcmV0ID0gKCAhbGVhZGluZ1JlbGF0aXZlICYmICggeG1sIHx8IGNvbnRleHQgIT09IG91dGVybW9zdENvbnRleHQgKSApIHx8ICgKCQkJCQkoY2hlY2tDb250ZXh0ID0gY29udGV4dCkubm9kZVR5cGUgPwoJCQkJCQltYXRjaENvbnRleHQoIGVsZW0sIGNvbnRleHQsIHhtbCApIDoKCQkJCQkJbWF0Y2hBbnlDb250ZXh0KCBlbGVtLCBjb250ZXh0LCB4bWwgKSApOwoJCQkJLy8gQXZvaWQgaGFuZ2luZyBvbnRvIGVsZW1lbnQgKGlzc3VlICMyOTkpCgkJCQljaGVja0NvbnRleHQgPSBudWxsOwoJCQkJcmV0dXJuIHJldDsKCQkJfSBdOwoKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCAobWF0Y2hlciA9IEV4cHIucmVsYXRpdmVbIHRva2Vuc1tpXS50eXBlIF0pICkgewoJCQkJbWF0Y2hlcnMgPSBbIGFkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICksIG1hdGNoZXIpIF07CgkJCX0gZWxzZSB7CgkJCQltYXRjaGVyID0gRXhwci5maWx0ZXJbIHRva2Vuc1tpXS50eXBlIF0uYXBwbHkoIG51bGwsIHRva2Vuc1tpXS5tYXRjaGVzICk7CgoJCQkJLy8gUmV0dXJuIHNwZWNpYWwgdXBvbiBzZWVpbmcgYSBwb3NpdGlvbmFsIG1hdGNoZXIKCQkJCWlmICggbWF0Y2hlclsgZXhwYW5kbyBdICkgewoJCQkJCS8vIEZpbmQgdGhlIG5leHQgcmVsYXRpdmUgb3BlcmF0b3IgKGlmIGFueSkgZm9yIHByb3BlciBoYW5kbGluZwoJCQkJCWogPSArK2k7CgkJCQkJZm9yICggOyBqIDwgbGVuOyBqKysgKSB7CgkJCQkJCWlmICggRXhwci5yZWxhdGl2ZVsgdG9rZW5zW2pdLnR5cGUgXSApIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJCXJldHVybiBzZXRNYXRjaGVyKAoJCQkJCQlpID4gMSAmJiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKSwKCQkJCQkJaSA+IDEgJiYgdG9TZWxlY3RvcigKCQkJCQkJCS8vIElmIHRoZSBwcmVjZWRpbmcgdG9rZW4gd2FzIGEgZGVzY2VuZGFudCBjb21iaW5hdG9yLCBpbnNlcnQgYW4gaW1wbGljaXQgYW55LWVsZW1lbnQgYCpgCgkJCQkJCQl0b2tlbnMuc2xpY2UoIDAsIGkgLSAxICkuY29uY2F0KHsgdmFsdWU6IHRva2Vuc1sgaSAtIDIgXS50eXBlID09PSAiICIgPyAiKiIgOiAiIiB9KQoJCQkJCQkpLnJlcGxhY2UoIHJ0cmltLCAiJDEiICksCgkJCQkJCW1hdGNoZXIsCgkJCQkJCWkgPCBqICYmIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMuc2xpY2UoIGksIGogKSApLAoJCQkJCQlqIDwgbGVuICYmIG1hdGNoZXJGcm9tVG9rZW5zKCAodG9rZW5zID0gdG9rZW5zLnNsaWNlKCBqICkpICksCgkJCQkJCWogPCBsZW4gJiYgdG9TZWxlY3RvciggdG9rZW5zICkKCQkJCQkpOwoJCQkJfQoJCQkJbWF0Y2hlcnMucHVzaCggbWF0Y2hlciApOwoJCQl9CgkJfQoKCQlyZXR1cm4gZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICk7Cgl9CgoJZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKCBlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzICkgewoJCXZhciBieVNldCA9IHNldE1hdGNoZXJzLmxlbmd0aCA+IDAsCgkJCWJ5RWxlbWVudCA9IGVsZW1lbnRNYXRjaGVycy5sZW5ndGggPiAwLAoJCQlzdXBlck1hdGNoZXIgPSBmdW5jdGlvbiggc2VlZCwgY29udGV4dCwgeG1sLCByZXN1bHRzLCBvdXRlcm1vc3QgKSB7CgkJCQl2YXIgZWxlbSwgaiwgbWF0Y2hlciwKCQkJCQltYXRjaGVkQ291bnQgPSAwLAoJCQkJCWkgPSAiMCIsCgkJCQkJdW5tYXRjaGVkID0gc2VlZCAmJiBbXSwKCQkJCQlzZXRNYXRjaGVkID0gW10sCgkJCQkJY29udGV4dEJhY2t1cCA9IG91dGVybW9zdENvbnRleHQsCgkJCQkJLy8gV2UgbXVzdCBhbHdheXMgaGF2ZSBlaXRoZXIgc2VlZCBlbGVtZW50cyBvciBvdXRlcm1vc3QgY29udGV4dAoJCQkJCWVsZW1zID0gc2VlZCB8fCBieUVsZW1lbnQgJiYgRXhwci5maW5kWyJUQUciXSggIioiLCBvdXRlcm1vc3QgKSwKCQkJCQkvLyBVc2UgaW50ZWdlciBkaXJydW5zIGlmZiB0aGlzIGlzIHRoZSBvdXRlcm1vc3QgbWF0Y2hlcgoJCQkJCWRpcnJ1bnNVbmlxdWUgPSAoZGlycnVucyArPSBjb250ZXh0QmFja3VwID09IG51bGwgPyAxIDogTWF0aC5yYW5kb20oKSB8fCAwLjEpLAoJCQkJCWxlbiA9IGVsZW1zLmxlbmd0aDsKCgkJCQlpZiAoIG91dGVybW9zdCApIHsKCQkJCQlvdXRlcm1vc3RDb250ZXh0ID0gY29udGV4dCAhPT0gZG9jdW1lbnQgJiYgY29udGV4dDsKCQkJCX0KCgkJCQkvLyBBZGQgZWxlbWVudHMgcGFzc2luZyBlbGVtZW50TWF0Y2hlcnMgZGlyZWN0bHkgdG8gcmVzdWx0cwoJCQkJLy8gS2VlcCBgaWAgYSBzdHJpbmcgaWYgdGhlcmUgYXJlIG5vIGVsZW1lbnRzIHNvIGBtYXRjaGVkQ291bnRgIHdpbGwgYmUgIjAwIiBiZWxvdwoJCQkJLy8gU3VwcG9ydDogSUU8OSwgU2FmYXJpCgkJCQkvLyBUb2xlcmF0ZSBOb2RlTGlzdCBwcm9wZXJ0aWVzIChJRTogImxlbmd0aCI7IFNhZmFyaTogPG51bWJlcj4pIG1hdGNoaW5nIGVsZW1lbnRzIGJ5IGlkCgkJCQlmb3IgKCA7IGkgIT09IGxlbiAmJiAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7CgkJCQkJaWYgKCBieUVsZW1lbnQgJiYgZWxlbSApIHsKCQkJCQkJaiA9IDA7CgkJCQkJCXdoaWxlICggKG1hdGNoZXIgPSBlbGVtZW50TWF0Y2hlcnNbaisrXSkgKSB7CgkJCQkJCQlpZiAoIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApICkgewoJCQkJCQkJCXJlc3VsdHMucHVzaCggZWxlbSApOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWlmICggb3V0ZXJtb3N0ICkgewoJCQkJCQkJZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIFRyYWNrIHVubWF0Y2hlZCBlbGVtZW50cyBmb3Igc2V0IGZpbHRlcnMKCQkJCQlpZiAoIGJ5U2V0ICkgewoJCQkJCQkvLyBUaGV5IHdpbGwgaGF2ZSBnb25lIHRocm91Z2ggYWxsIHBvc3NpYmxlIG1hdGNoZXJzCgkJCQkJCWlmICggKGVsZW0gPSAhbWF0Y2hlciAmJiBlbGVtKSApIHsKCQkJCQkJCW1hdGNoZWRDb3VudC0tOwoJCQkJCQl9CgoJCQkJCQkvLyBMZW5ndGhlbiB0aGUgYXJyYXkgZm9yIGV2ZXJ5IGVsZW1lbnQsIG1hdGNoZWQgb3Igbm90CgkJCQkJCWlmICggc2VlZCApIHsKCQkJCQkJCXVubWF0Y2hlZC5wdXNoKCBlbGVtICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gQXBwbHkgc2V0IGZpbHRlcnMgdG8gdW5tYXRjaGVkIGVsZW1lbnRzCgkJCQltYXRjaGVkQ291bnQgKz0gaTsKCQkJCWlmICggYnlTZXQgJiYgaSAhPT0gbWF0Y2hlZENvdW50ICkgewoJCQkJCWogPSAwOwoJCQkJCXdoaWxlICggKG1hdGNoZXIgPSBzZXRNYXRjaGVyc1tqKytdKSApIHsKCQkJCQkJbWF0Y2hlciggdW5tYXRjaGVkLCBzZXRNYXRjaGVkLCBjb250ZXh0LCB4bWwgKTsKCQkJCQl9CgoJCQkJCWlmICggc2VlZCApIHsKCQkJCQkJLy8gUmVpbnRlZ3JhdGUgZWxlbWVudCBtYXRjaGVzIHRvIGVsaW1pbmF0ZSB0aGUgbmVlZCBmb3Igc29ydGluZwoJCQkJCQlpZiAoIG1hdGNoZWRDb3VudCA+IDAgKSB7CgkJCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJCQlpZiAoICEodW5tYXRjaGVkW2ldIHx8IHNldE1hdGNoZWRbaV0pICkgewoJCQkJCQkJCQlzZXRNYXRjaGVkW2ldID0gcG9wLmNhbGwoIHJlc3VsdHMgKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIERpc2NhcmQgaW5kZXggcGxhY2Vob2xkZXIgdmFsdWVzIHRvIGdldCBvbmx5IGFjdHVhbCBtYXRjaGVzCgkJCQkJCXNldE1hdGNoZWQgPSBjb25kZW5zZSggc2V0TWF0Y2hlZCApOwoJCQkJCX0KCgkJCQkJLy8gQWRkIG1hdGNoZXMgdG8gcmVzdWx0cwoJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsIHNldE1hdGNoZWQgKTsKCgkJCQkJLy8gU2VlZGxlc3Mgc2V0IG1hdGNoZXMgc3VjY2VlZGluZyBtdWx0aXBsZSBzdWNjZXNzZnVsIG1hdGNoZXJzIHN0aXB1bGF0ZSBzb3J0aW5nCgkJCQkJaWYgKCBvdXRlcm1vc3QgJiYgIXNlZWQgJiYgc2V0TWF0Y2hlZC5sZW5ndGggPiAwICYmCgkJCQkJCSggbWF0Y2hlZENvdW50ICsgc2V0TWF0Y2hlcnMubGVuZ3RoICkgPiAxICkgewoKCQkJCQkJU2l6emxlLnVuaXF1ZVNvcnQoIHJlc3VsdHMgKTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gT3ZlcnJpZGUgbWFuaXB1bGF0aW9uIG9mIGdsb2JhbHMgYnkgbmVzdGVkIG1hdGNoZXJzCgkJCQlpZiAoIG91dGVybW9zdCApIHsKCQkJCQlkaXJydW5zID0gZGlycnVuc1VuaXF1ZTsKCQkJCQlvdXRlcm1vc3RDb250ZXh0ID0gY29udGV4dEJhY2t1cDsKCQkJCX0KCgkJCQlyZXR1cm4gdW5tYXRjaGVkOwoJCQl9OwoKCQlyZXR1cm4gYnlTZXQgPwoJCQltYXJrRnVuY3Rpb24oIHN1cGVyTWF0Y2hlciApIDoKCQkJc3VwZXJNYXRjaGVyOwoJfQoKCWNvbXBpbGUgPSBTaXp6bGUuY29tcGlsZSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgbWF0Y2ggLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8gKSB7CgkJdmFyIGksCgkJCXNldE1hdGNoZXJzID0gW10sCgkJCWVsZW1lbnRNYXRjaGVycyA9IFtdLAoJCQljYWNoZWQgPSBjb21waWxlckNhY2hlWyBzZWxlY3RvciArICIgIiBdOwoKCQlpZiAoICFjYWNoZWQgKSB7CgkJCS8vIEdlbmVyYXRlIGEgZnVuY3Rpb24gb2YgcmVjdXJzaXZlIGZ1bmN0aW9ucyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNoZWNrIGVhY2ggZWxlbWVudAoJCQlpZiAoICFtYXRjaCApIHsKCQkJCW1hdGNoID0gdG9rZW5pemUoIHNlbGVjdG9yICk7CgkJCX0KCQkJaSA9IG1hdGNoLmxlbmd0aDsKCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQljYWNoZWQgPSBtYXRjaGVyRnJvbVRva2VucyggbWF0Y2hbaV0gKTsKCQkJCWlmICggY2FjaGVkWyBleHBhbmRvIF0gKSB7CgkJCQkJc2V0TWF0Y2hlcnMucHVzaCggY2FjaGVkICk7CgkJCQl9IGVsc2UgewoJCQkJCWVsZW1lbnRNYXRjaGVycy5wdXNoKCBjYWNoZWQgKTsKCQkJCX0KCQkJfQoKCQkJLy8gQ2FjaGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uCgkJCWNhY2hlZCA9IGNvbXBpbGVyQ2FjaGUoIHNlbGVjdG9yLCBtYXRjaGVyRnJvbUdyb3VwTWF0Y2hlcnMoIGVsZW1lbnRNYXRjaGVycywgc2V0TWF0Y2hlcnMgKSApOwoKCQkJLy8gU2F2ZSBzZWxlY3RvciBhbmQgdG9rZW5pemF0aW9uCgkJCWNhY2hlZC5zZWxlY3RvciA9IHNlbGVjdG9yOwoJCX0KCQlyZXR1cm4gY2FjaGVkOwoJfTsKCgkvKioKCSAqIEEgbG93LWxldmVsIHNlbGVjdGlvbiBmdW5jdGlvbiB0aGF0IHdvcmtzIHdpdGggU2l6emxlJ3MgY29tcGlsZWQKCSAqICBzZWxlY3RvciBmdW5jdGlvbnMKCSAqIEBwYXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBzZWxlY3RvciBBIHNlbGVjdG9yIG9yIGEgcHJlLWNvbXBpbGVkCgkgKiAgc2VsZWN0b3IgZnVuY3Rpb24gYnVpbHQgd2l0aCBTaXp6bGUuY29tcGlsZQoJICogQHBhcmFtIHtFbGVtZW50fSBjb250ZXh0CgkgKiBAcGFyYW0ge0FycmF5fSBbcmVzdWx0c10KCSAqIEBwYXJhbSB7QXJyYXl9IFtzZWVkXSBBIHNldCBvZiBlbGVtZW50cyB0byBtYXRjaCBhZ2FpbnN0CgkgKi8KCXNlbGVjdCA9IFNpenpsZS5zZWxlY3QgPSBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQsIHJlc3VsdHMsIHNlZWQgKSB7CgkJdmFyIGksIHRva2VucywgdG9rZW4sIHR5cGUsIGZpbmQsCgkJCWNvbXBpbGVkID0gdHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iICYmIHNlbGVjdG9yLAoJCQltYXRjaCA9ICFzZWVkICYmIHRva2VuaXplKCAoc2VsZWN0b3IgPSBjb21waWxlZC5zZWxlY3RvciB8fCBzZWxlY3RvcikgKTsKCgkJcmVzdWx0cyA9IHJlc3VsdHMgfHwgW107CgoJCS8vIFRyeSB0byBtaW5pbWl6ZSBvcGVyYXRpb25zIGlmIHRoZXJlIGlzIG5vIHNlZWQgYW5kIG9ubHkgb25lIGdyb3VwCgkJaWYgKCBtYXRjaC5sZW5ndGggPT09IDEgKSB7CgoJCQkvLyBUYWtlIGEgc2hvcnRjdXQgYW5kIHNldCB0aGUgY29udGV4dCBpZiB0aGUgcm9vdCBzZWxlY3RvciBpcyBhbiBJRAoJCQl0b2tlbnMgPSBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwICk7CgkJCWlmICggdG9rZW5zLmxlbmd0aCA+IDIgJiYgKHRva2VuID0gdG9rZW5zWzBdKS50eXBlID09PSAiSUQiICYmCgkJCQkJc3VwcG9ydC5nZXRCeUlkICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDkgJiYgZG9jdW1lbnRJc0hUTUwgJiYKCQkJCQlFeHByLnJlbGF0aXZlWyB0b2tlbnNbMV0udHlwZSBdICkgewoKCQkJCWNvbnRleHQgPSAoIEV4cHIuZmluZFsiSUQiXSggdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKSwgY29udGV4dCApIHx8IFtdIClbMF07CgkJCQlpZiAoICFjb250ZXh0ICkgewoJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCS8vIFByZWNvbXBpbGVkIG1hdGNoZXJzIHdpbGwgc3RpbGwgdmVyaWZ5IGFuY2VzdHJ5LCBzbyBzdGVwIHVwIGEgbGV2ZWwKCQkJCX0gZWxzZSBpZiAoIGNvbXBpbGVkICkgewoJCQkJCWNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7CgkJCQl9CgoJCQkJc2VsZWN0b3IgPSBzZWxlY3Rvci5zbGljZSggdG9rZW5zLnNoaWZ0KCkudmFsdWUubGVuZ3RoICk7CgkJCX0KCgkJCS8vIEZldGNoIGEgc2VlZCBzZXQgZm9yIHJpZ2h0LXRvLWxlZnQgbWF0Y2hpbmcKCQkJaSA9IG1hdGNoRXhwclsibmVlZHNDb250ZXh0Il0udGVzdCggc2VsZWN0b3IgKSA/IDAgOiB0b2tlbnMubGVuZ3RoOwoJCQl3aGlsZSAoIGktLSApIHsKCQkJCXRva2VuID0gdG9rZW5zW2ldOwoKCQkJCS8vIEFib3J0IGlmIHdlIGhpdCBhIGNvbWJpbmF0b3IKCQkJCWlmICggRXhwci5yZWxhdGl2ZVsgKHR5cGUgPSB0b2tlbi50eXBlKSBdICkgewoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJaWYgKCAoZmluZCA9IEV4cHIuZmluZFsgdHlwZSBdKSApIHsKCQkJCQkvLyBTZWFyY2gsIGV4cGFuZGluZyBjb250ZXh0IGZvciBsZWFkaW5nIHNpYmxpbmcgY29tYmluYXRvcnMKCQkJCQlpZiAoIChzZWVkID0gZmluZCgKCQkJCQkJdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLAoJCQkJCQlyc2libGluZy50ZXN0KCB0b2tlbnNbMF0udHlwZSApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0CgkJCQkJKSkgKSB7CgoJCQkJCQkvLyBJZiBzZWVkIGlzIGVtcHR5IG9yIG5vIHRva2VucyByZW1haW4sIHdlIGNhbiByZXR1cm4gZWFybHkKCQkJCQkJdG9rZW5zLnNwbGljZSggaSwgMSApOwoJCQkJCQlzZWxlY3RvciA9IHNlZWQubGVuZ3RoICYmIHRvU2VsZWN0b3IoIHRva2VucyApOwoJCQkJCQlpZiAoICFzZWxlY3RvciApIHsKCQkJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsIHNlZWQgKTsKCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQl9CgoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZAoJCS8vIFByb3ZpZGUgYG1hdGNoYCB0byBhdm9pZCByZXRva2VuaXphdGlvbiBpZiB3ZSBtb2RpZmllZCB0aGUgc2VsZWN0b3IgYWJvdmUKCQkoIGNvbXBpbGVkIHx8IGNvbXBpbGUoIHNlbGVjdG9yLCBtYXRjaCApICkoCgkJCXNlZWQsCgkJCWNvbnRleHQsCgkJCSFkb2N1bWVudElzSFRNTCwKCQkJcmVzdWx0cywKCQkJcnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dAoJCSk7CgkJcmV0dXJuIHJlc3VsdHM7Cgl9OwoKCS8vIE9uZS10aW1lIGFzc2lnbm1lbnRzCgoJLy8gU29ydCBzdGFiaWxpdHkKCXN1cHBvcnQuc29ydFN0YWJsZSA9IGV4cGFuZG8uc3BsaXQoIiIpLnNvcnQoIHNvcnRPcmRlciApLmpvaW4oIiIpID09PSBleHBhbmRvOwoKCS8vIFN1cHBvcnQ6IENocm9tZSAxNC0zNSsKCS8vIEFsd2F5cyBhc3N1bWUgZHVwbGljYXRlcyBpZiB0aGV5IGFyZW4ndCBwYXNzZWQgdG8gdGhlIGNvbXBhcmlzb24gZnVuY3Rpb24KCXN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcyA9ICEhaGFzRHVwbGljYXRlOwoKCS8vIEluaXRpYWxpemUgYWdhaW5zdCB0aGUgZGVmYXVsdCBkb2N1bWVudAoJc2V0RG9jdW1lbnQoKTsKCgkvLyBTdXBwb3J0OiBXZWJraXQ8NTM3LjMyIC0gU2FmYXJpIDYuMC4zL0Nocm9tZSAyNSAoZml4ZWQgaW4gQ2hyb21lIDI3KQoJLy8gRGV0YWNoZWQgbm9kZXMgY29uZm91bmRpbmdseSBmb2xsb3cgKmVhY2ggb3RoZXIqCglzdXBwb3J0LnNvcnREZXRhY2hlZCA9IGFzc2VydChmdW5jdGlvbiggZGl2MSApIHsKCQkvLyBTaG91bGQgcmV0dXJuIDEsIGJ1dCByZXR1cm5zIDQgKGZvbGxvd2luZykKCQlyZXR1cm4gZGl2MS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikgKSAmIDE7Cgl9KTsKCgkvLyBTdXBwb3J0OiBJRTw4CgkvLyBQcmV2ZW50IGF0dHJpYnV0ZS9wcm9wZXJ0eSAiaW50ZXJwb2xhdGlvbiIKCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKCWlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCWRpdi5pbm5lckhUTUwgPSAiPGEgaHJlZj0nIyc+PC9hPiI7CgkJcmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpID09PSAiIyIgOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCAidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsIGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHsKCQkJaWYgKCAhaXNYTUwgKSB7CgkJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gInR5cGUiID8gMSA6IDIgKTsKCQkJfQoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpCglpZiAoICFzdXBwb3J0LmF0dHJpYnV0ZXMgfHwgIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCWRpdi5pbm5lckhUTUwgPSAiPGlucHV0Lz4iOwoJCWRpdi5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSggInZhbHVlIiwgIiIgKTsKCQlyZXR1cm4gZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCAidmFsdWUiICkgPT09ICIiOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCAidmFsdWUiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCWlmICggIWlzWE1MICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiApIHsKCQkJCXJldHVybiBlbGVtLmRlZmF1bHRWYWx1ZTsKCQkJfQoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIFVzZSBnZXRBdHRyaWJ1dGVOb2RlIHRvIGZldGNoIGJvb2xlYW5zIHdoZW4gZ2V0QXR0cmlidXRlIGxpZXMKCWlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCXJldHVybiBkaXYuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpID09IG51bGw7Cgl9KSApIHsKCQlhZGRIYW5kbGUoIGJvb2xlYW5zLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCXZhciB2YWw7CgkJCWlmICggIWlzWE1MICkgewoJCQkJcmV0dXJuIGVsZW1bIG5hbWUgXSA9PT0gdHJ1ZSA/IG5hbWUudG9Mb3dlckNhc2UoKSA6CgkJCQkJCSh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKSkgJiYgdmFsLnNwZWNpZmllZCA/CgkJCQkJCXZhbC52YWx1ZSA6CgkJCQkJbnVsbDsKCQkJfQoJCX0pOwoJfQoKCXJldHVybiBTaXp6bGU7CgoJfSkoIHdpbmRvdyApOwoKCgoJalF1ZXJ5LmZpbmQgPSBTaXp6bGU7CglqUXVlcnkuZXhwciA9IFNpenpsZS5zZWxlY3RvcnM7CglqUXVlcnkuZXhwclsiOiJdID0galF1ZXJ5LmV4cHIucHNldWRvczsKCWpRdWVyeS51bmlxdWUgPSBTaXp6bGUudW5pcXVlU29ydDsKCWpRdWVyeS50ZXh0ID0gU2l6emxlLmdldFRleHQ7CglqUXVlcnkuaXNYTUxEb2MgPSBTaXp6bGUuaXNYTUw7CglqUXVlcnkuY29udGFpbnMgPSBTaXp6bGUuY29udGFpbnM7CgoKCgl2YXIgcm5lZWRzQ29udGV4dCA9IGpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dDsKCgl2YXIgcnNpbmdsZVRhZyA9ICgvXjwoXHcrKVxzKlwvPz4oPzo8XC9cMT58KSQvKTsKCgoKCXZhciByaXNTaW1wbGUgPSAvXi5bXjojXFtcLixdKiQvOwoKCS8vIEltcGxlbWVudCB0aGUgaWRlbnRpY2FsIGZ1bmN0aW9uYWxpdHkgZm9yIGZpbHRlciBhbmQgbm90CglmdW5jdGlvbiB3aW5ub3coIGVsZW1lbnRzLCBxdWFsaWZpZXIsIG5vdCApIHsKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBxdWFsaWZpZXIgKSApIHsKCQkJcmV0dXJuIGpRdWVyeS5ncmVwKCBlbGVtZW50cywgZnVuY3Rpb24oIGVsZW0sIGkgKSB7CgkJCQkvKiBqc2hpbnQgLVcwMTggKi8KCQkJCXJldHVybiAhIXF1YWxpZmllci5jYWxsKCBlbGVtLCBpLCBlbGVtICkgIT09IG5vdDsKCQkJfSk7CgoJCX0KCgkJaWYgKCBxdWFsaWZpZXIubm9kZVR5cGUgKSB7CgkJCXJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuICggZWxlbSA9PT0gcXVhbGlmaWVyICkgIT09IG5vdDsKCQkJfSk7CgoJCX0KCgkJaWYgKCB0eXBlb2YgcXVhbGlmaWVyID09PSAic3RyaW5nIiApIHsKCQkJaWYgKCByaXNTaW1wbGUudGVzdCggcXVhbGlmaWVyICkgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LmZpbHRlciggcXVhbGlmaWVyLCBlbGVtZW50cywgbm90ICk7CgkJCX0KCgkJCXF1YWxpZmllciA9IGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMgKTsKCQl9CgoJCXJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gKCBqUXVlcnkuaW5BcnJheSggZWxlbSwgcXVhbGlmaWVyICkgPj0gMCApICE9PSBub3Q7CgkJfSk7Cgl9CgoJalF1ZXJ5LmZpbHRlciA9IGZ1bmN0aW9uKCBleHByLCBlbGVtcywgbm90ICkgewoJCXZhciBlbGVtID0gZWxlbXNbIDAgXTsKCgkJaWYgKCBub3QgKSB7CgkJCWV4cHIgPSAiOm5vdCgiICsgZXhwciArICIpIjsKCQl9CgoJCXJldHVybiBlbGVtcy5sZW5ndGggPT09IDEgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSA/CgkJCWpRdWVyeS5maW5kLm1hdGNoZXNTZWxlY3RvciggZWxlbSwgZXhwciApID8gWyBlbGVtIF0gOiBbXSA6CgkJCWpRdWVyeS5maW5kLm1hdGNoZXMoIGV4cHIsIGpRdWVyeS5ncmVwKCBlbGVtcywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMTsKCQkJfSkpOwoJfTsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQlmaW5kOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBpLAoJCQkJcmV0ID0gW10sCgkJCQlzZWxmID0gdGhpcywKCQkJCWxlbiA9IHNlbGYubGVuZ3RoOwoKCQkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciICkgewoJCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkoIHNlbGVjdG9yICkuZmlsdGVyKGZ1bmN0aW9uKCkgewoJCQkJCWZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7CgkJCQkJCWlmICggalF1ZXJ5LmNvbnRhaW5zKCBzZWxmWyBpIF0sIHRoaXMgKSApIHsKCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQl9CgkJCQkJfQoJCQkJfSkgKTsKCQkJfQoKCQkJZm9yICggaSA9IDA7IGkgPCBsZW47IGkrKyApIHsKCQkJCWpRdWVyeS5maW5kKCBzZWxlY3Rvciwgc2VsZlsgaSBdLCByZXQgKTsKCQkJfQoKCQkJLy8gTmVlZGVkIGJlY2F1c2UgJCggc2VsZWN0b3IsIGNvbnRleHQgKSBiZWNvbWVzICQoIGNvbnRleHQgKS5maW5kKCBzZWxlY3RvciApCgkJCXJldCA9IHRoaXMucHVzaFN0YWNrKCBsZW4gPiAxID8galF1ZXJ5LnVuaXF1ZSggcmV0ICkgOiByZXQgKTsKCQkJcmV0LnNlbGVjdG9yID0gdGhpcy5zZWxlY3RvciA/IHRoaXMuc2VsZWN0b3IgKyAiICIgKyBzZWxlY3RvciA6IHNlbGVjdG9yOwoJCQlyZXR1cm4gcmV0OwoJCX0sCgkJZmlsdGVyOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggd2lubm93KHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSkgKTsKCQl9LAoJCW5vdDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHdpbm5vdyh0aGlzLCBzZWxlY3RvciB8fCBbXSwgdHJ1ZSkgKTsKCQl9LAoJCWlzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiAhIXdpbm5vdygKCQkJCXRoaXMsCgoJCQkJLy8gSWYgdGhpcyBpcyBhIHBvc2l0aW9uYWwvcmVsYXRpdmUgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhlIHJldHVybmVkIHNldAoJCQkJLy8gc28gJCgicDpmaXJzdCIpLmlzKCJwOmxhc3QiKSB3b24ndCByZXR1cm4gdHJ1ZSBmb3IgYSBkb2Mgd2l0aCB0d28gInAiLgoJCQkJdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiAmJiBybmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICkgPwoJCQkJCWpRdWVyeSggc2VsZWN0b3IgKSA6CgkJCQkJc2VsZWN0b3IgfHwgW10sCgkJCQlmYWxzZQoJCQkpLmxlbmd0aDsKCQl9Cgl9KTsKCgoJLy8gSW5pdGlhbGl6ZSBhIGpRdWVyeSBvYmplY3QKCgoJLy8gQSBjZW50cmFsIHJlZmVyZW5jZSB0byB0aGUgcm9vdCBqUXVlcnkoZG9jdW1lbnQpCgl2YXIgcm9vdGpRdWVyeSwKCgkJLy8gVXNlIHRoZSBjb3JyZWN0IGRvY3VtZW50IGFjY29yZGluZ2x5IHdpdGggd2luZG93IGFyZ3VtZW50IChzYW5kYm94KQoJCWRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LAoKCQkvLyBBIHNpbXBsZSB3YXkgdG8gY2hlY2sgZm9yIEhUTUwgc3RyaW5ncwoJCS8vIFByaW9yaXRpemUgI2lkIG92ZXIgPHRhZz4gdG8gYXZvaWQgWFNTIHZpYSBsb2NhdGlvbi5oYXNoICgjOTUyMSkKCQkvLyBTdHJpY3QgSFRNTCByZWNvZ25pdGlvbiAoIzExMjkwOiBtdXN0IHN0YXJ0IHdpdGggPCkKCQlycXVpY2tFeHByID0gL14oPzpccyooPFtcd1xXXSs+KVtePl0qfCMoW1x3LV0qKSkkLywKCgkJaW5pdCA9IGpRdWVyeS5mbi5pbml0ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkgewoJCQl2YXIgbWF0Y2gsIGVsZW07CgoJCQkvLyBIQU5ETEU6ICQoIiIpLCAkKG51bGwpLCAkKHVuZGVmaW5lZCksICQoZmFsc2UpCgkJCWlmICggIXNlbGVjdG9yICkgewoJCQkJcmV0dXJuIHRoaXM7CgkJCX0KCgkJCS8vIEhhbmRsZSBIVE1MIHN0cmluZ3MKCQkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICkgewoJCQkJaWYgKCBzZWxlY3Rvci5jaGFyQXQoMCkgPT09ICI8IiAmJiBzZWxlY3Rvci5jaGFyQXQoIHNlbGVjdG9yLmxlbmd0aCAtIDEgKSA9PT0gIj4iICYmIHNlbGVjdG9yLmxlbmd0aCA+PSAzICkgewoJCQkJCS8vIEFzc3VtZSB0aGF0IHN0cmluZ3MgdGhhdCBzdGFydCBhbmQgZW5kIHdpdGggPD4gYXJlIEhUTUwgYW5kIHNraXAgdGhlIHJlZ2V4IGNoZWNrCgkJCQkJbWF0Y2ggPSBbIG51bGwsIHNlbGVjdG9yLCBudWxsIF07CgoJCQkJfSBlbHNlIHsKCQkJCQltYXRjaCA9IHJxdWlja0V4cHIuZXhlYyggc2VsZWN0b3IgKTsKCQkJCX0KCgkJCQkvLyBNYXRjaCBodG1sIG9yIG1ha2Ugc3VyZSBubyBjb250ZXh0IGlzIHNwZWNpZmllZCBmb3IgI2lkCgkJCQlpZiAoIG1hdGNoICYmIChtYXRjaFsxXSB8fCAhY29udGV4dCkgKSB7CgoJCQkJCS8vIEhBTkRMRTogJChodG1sKSAtPiAkKGFycmF5KQoJCQkJCWlmICggbWF0Y2hbMV0gKSB7CgkJCQkJCWNvbnRleHQgPSBjb250ZXh0IGluc3RhbmNlb2YgalF1ZXJ5ID8gY29udGV4dFswXSA6IGNvbnRleHQ7CgoJCQkJCQkvLyBzY3JpcHRzIGlzIHRydWUgZm9yIGJhY2stY29tcGF0CgkJCQkJCS8vIEludGVudGlvbmFsbHkgbGV0IHRoZSBlcnJvciBiZSB0aHJvd24gaWYgcGFyc2VIVE1MIGlzIG5vdCBwcmVzZW50CgkJCQkJCWpRdWVyeS5tZXJnZSggdGhpcywgalF1ZXJ5LnBhcnNlSFRNTCgKCQkJCQkJCW1hdGNoWzFdLAoJCQkJCQkJY29udGV4dCAmJiBjb250ZXh0Lm5vZGVUeXBlID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBkb2N1bWVudCwKCQkJCQkJCXRydWUKCQkJCQkJKSApOwoKCQkJCQkJLy8gSEFORExFOiAkKGh0bWwsIHByb3BzKQoJCQkJCQlpZiAoIHJzaW5nbGVUYWcudGVzdCggbWF0Y2hbMV0gKSAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdCggY29udGV4dCApICkgewoJCQkJCQkJZm9yICggbWF0Y2ggaW4gY29udGV4dCApIHsKCQkJCQkJCQkvLyBQcm9wZXJ0aWVzIG9mIGNvbnRleHQgYXJlIGNhbGxlZCBhcyBtZXRob2RzIGlmIHBvc3NpYmxlCgkJCQkJCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdGhpc1sgbWF0Y2ggXSApICkgewoJCQkJCQkJCQl0aGlzWyBtYXRjaCBdKCBjb250ZXh0WyBtYXRjaCBdICk7CgoJCQkJCQkJCS8vIC4uLmFuZCBvdGhlcndpc2Ugc2V0IGFzIGF0dHJpYnV0ZXMKCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQl0aGlzLmF0dHIoIG1hdGNoLCBjb250ZXh0WyBtYXRjaCBdICk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQlyZXR1cm4gdGhpczsKCgkJCQkJLy8gSEFORExFOiAkKCNpZCkKCQkJCQl9IGVsc2UgewoJCQkJCQllbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG1hdGNoWzJdICk7CgoJCQkJCQkvLyBDaGVjayBwYXJlbnROb2RlIHRvIGNhdGNoIHdoZW4gQmxhY2tiZXJyeSA0LjYgcmV0dXJucwoJCQkJCQkvLyBub2RlcyB0aGF0IGFyZSBubyBsb25nZXIgaW4gdGhlIGRvY3VtZW50ICM2OTYzCgkJCQkJCWlmICggZWxlbSAmJiBlbGVtLnBhcmVudE5vZGUgKSB7CgkJCQkJCQkvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgSUUgYW5kIE9wZXJhIHJldHVybiBpdGVtcwoJCQkJCQkJLy8gYnkgbmFtZSBpbnN0ZWFkIG9mIElECgkJCQkJCQlpZiAoIGVsZW0uaWQgIT09IG1hdGNoWzJdICkgewoJCQkJCQkJCXJldHVybiByb290alF1ZXJ5LmZpbmQoIHNlbGVjdG9yICk7CgkJCQkJCQl9CgoJCQkJCQkJLy8gT3RoZXJ3aXNlLCB3ZSBpbmplY3QgdGhlIGVsZW1lbnQgZGlyZWN0bHkgaW50byB0aGUgalF1ZXJ5IG9iamVjdAoJCQkJCQkJdGhpcy5sZW5ndGggPSAxOwoJCQkJCQkJdGhpc1swXSA9IGVsZW07CgkJCQkJCX0KCgkJCQkJCXRoaXMuY29udGV4dCA9IGRvY3VtZW50OwoJCQkJCQl0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0KCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKQoJCQkJfSBlbHNlIGlmICggIWNvbnRleHQgfHwgY29udGV4dC5qcXVlcnkgKSB7CgkJCQkJcmV0dXJuICggY29udGV4dCB8fCByb290alF1ZXJ5ICkuZmluZCggc2VsZWN0b3IgKTsKCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dCkKCQkJCS8vICh3aGljaCBpcyBqdXN0IGVxdWl2YWxlbnQgdG86ICQoY29udGV4dCkuZmluZChleHByKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkvLyBIQU5ETEU6ICQoRE9NRWxlbWVudCkKCQkJfSBlbHNlIGlmICggc2VsZWN0b3Iubm9kZVR5cGUgKSB7CgkJCQl0aGlzLmNvbnRleHQgPSB0aGlzWzBdID0gc2VsZWN0b3I7CgkJCQl0aGlzLmxlbmd0aCA9IDE7CgkJCQlyZXR1cm4gdGhpczsKCgkJCS8vIEhBTkRMRTogJChmdW5jdGlvbikKCQkJLy8gU2hvcnRjdXQgZm9yIGRvY3VtZW50IHJlYWR5CgkJCX0gZWxzZSBpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBzZWxlY3RvciApICkgewoJCQkJcmV0dXJuIHR5cGVvZiByb290alF1ZXJ5LnJlYWR5ICE9PSAidW5kZWZpbmVkIiA/CgkJCQkJcm9vdGpRdWVyeS5yZWFkeSggc2VsZWN0b3IgKSA6CgkJCQkJLy8gRXhlY3V0ZSBpbW1lZGlhdGVseSBpZiByZWFkeSBpcyBub3QgcHJlc2VudAoJCQkJCXNlbGVjdG9yKCBqUXVlcnkgKTsKCQkJfQoKCQkJaWYgKCBzZWxlY3Rvci5zZWxlY3RvciAhPT0gdW5kZWZpbmVkICkgewoJCQkJdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yLnNlbGVjdG9yOwoJCQkJdGhpcy5jb250ZXh0ID0gc2VsZWN0b3IuY29udGV4dDsKCQkJfQoKCQkJcmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoIHNlbGVjdG9yLCB0aGlzICk7CgkJfTsKCgkvLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9uIHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uCglpbml0LnByb3RvdHlwZSA9IGpRdWVyeS5mbjsKCgkvLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlCglyb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApOwoKCgl2YXIgcnBhcmVudHNwcmV2ID0gL14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sCgkJLy8gbWV0aG9kcyBndWFyYW50ZWVkIHRvIHByb2R1Y2UgYSB1bmlxdWUgc2V0IHdoZW4gc3RhcnRpbmcgZnJvbSBhIHVuaXF1ZSBzZXQKCQlndWFyYW50ZWVkVW5pcXVlID0gewoJCQljaGlsZHJlbjogdHJ1ZSwKCQkJY29udGVudHM6IHRydWUsCgkJCW5leHQ6IHRydWUsCgkJCXByZXY6IHRydWUKCQl9OwoKCWpRdWVyeS5leHRlbmQoewoJCWRpcjogZnVuY3Rpb24oIGVsZW0sIGRpciwgdW50aWwgKSB7CgkJCXZhciBtYXRjaGVkID0gW10sCgkJCQljdXIgPSBlbGVtWyBkaXIgXTsKCgkJCXdoaWxlICggY3VyICYmIGN1ci5ub2RlVHlwZSAhPT0gOSAmJiAodW50aWwgPT09IHVuZGVmaW5lZCB8fCBjdXIubm9kZVR5cGUgIT09IDEgfHwgIWpRdWVyeSggY3VyICkuaXMoIHVudGlsICkpICkgewoJCQkJaWYgKCBjdXIubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJbWF0Y2hlZC5wdXNoKCBjdXIgKTsKCQkJCX0KCQkJCWN1ciA9IGN1cltkaXJdOwoJCQl9CgkJCXJldHVybiBtYXRjaGVkOwoJCX0sCgoJCXNpYmxpbmc6IGZ1bmN0aW9uKCBuLCBlbGVtICkgewoJCQl2YXIgciA9IFtdOwoKCQkJZm9yICggOyBuOyBuID0gbi5uZXh0U2libGluZyApIHsKCQkJCWlmICggbi5ub2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtICkgewoJCQkJCXIucHVzaCggbiApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gcjsKCQl9Cgl9KTsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQloYXM6IGZ1bmN0aW9uKCB0YXJnZXQgKSB7CgkJCXZhciBpLAoJCQkJdGFyZ2V0cyA9IGpRdWVyeSggdGFyZ2V0LCB0aGlzICksCgkJCQlsZW4gPSB0YXJnZXRzLmxlbmd0aDsKCgkJCXJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpIHsKCQkJCWZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7CgkJCQkJaWYgKCBqUXVlcnkuY29udGFpbnMoIHRoaXMsIHRhcmdldHNbaV0gKSApIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9KTsKCQl9LAoKCQljbG9zZXN0OiBmdW5jdGlvbiggc2VsZWN0b3JzLCBjb250ZXh0ICkgewoJCQl2YXIgY3VyLAoJCQkJaSA9IDAsCgkJCQlsID0gdGhpcy5sZW5ndGgsCgkJCQltYXRjaGVkID0gW10sCgkJCQlwb3MgPSBybmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9ycyApIHx8IHR5cGVvZiBzZWxlY3RvcnMgIT09ICJzdHJpbmciID8KCQkJCQlqUXVlcnkoIHNlbGVjdG9ycywgY29udGV4dCB8fCB0aGlzLmNvbnRleHQgKSA6CgkJCQkJMDsKCgkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCWZvciAoIGN1ciA9IHRoaXNbaV07IGN1ciAmJiBjdXIgIT09IGNvbnRleHQ7IGN1ciA9IGN1ci5wYXJlbnROb2RlICkgewoJCQkJCS8vIEFsd2F5cyBza2lwIGRvY3VtZW50IGZyYWdtZW50cwoJCQkJCWlmICggY3VyLm5vZGVUeXBlIDwgMTEgJiYgKHBvcyA/CgkJCQkJCXBvcy5pbmRleChjdXIpID4gLTEgOgoKCQkJCQkJLy8gRG9uJ3QgcGFzcyBub24tZWxlbWVudHMgdG8gU2l6emxlCgkJCQkJCWN1ci5ub2RlVHlwZSA9PT0gMSAmJgoJCQkJCQkJalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1ciwgc2VsZWN0b3JzKSkgKSB7CgoJCQkJCQltYXRjaGVkLnB1c2goIGN1ciApOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggbWF0Y2hlZC5sZW5ndGggPiAxID8galF1ZXJ5LnVuaXF1ZSggbWF0Y2hlZCApIDogbWF0Y2hlZCApOwoJCX0sCgoJCS8vIERldGVybWluZSB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCB3aXRoaW4KCQkvLyB0aGUgbWF0Y2hlZCBzZXQgb2YgZWxlbWVudHMKCQlpbmRleDogZnVuY3Rpb24oIGVsZW0gKSB7CgoJCQkvLyBObyBhcmd1bWVudCwgcmV0dXJuIGluZGV4IGluIHBhcmVudAoJCQlpZiAoICFlbGVtICkgewoJCQkJcmV0dXJuICggdGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUgKSA/IHRoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoIDogLTE7CgkJCX0KCgkJCS8vIGluZGV4IGluIHNlbGVjdG9yCgkJCWlmICggdHlwZW9mIGVsZW0gPT09ICJzdHJpbmciICkgewoJCQkJcmV0dXJuIGpRdWVyeS5pbkFycmF5KCB0aGlzWzBdLCBqUXVlcnkoIGVsZW0gKSApOwoJCQl9CgoJCQkvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBkZXNpcmVkIGVsZW1lbnQKCQkJcmV0dXJuIGpRdWVyeS5pbkFycmF5KAoJCQkJLy8gSWYgaXQgcmVjZWl2ZXMgYSBqUXVlcnkgb2JqZWN0LCB0aGUgZmlyc3QgZWxlbWVudCBpcyB1c2VkCgkJCQllbGVtLmpxdWVyeSA/IGVsZW1bMF0gOiBlbGVtLCB0aGlzICk7CgkJfSwKCgkJYWRkOiBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjaygKCQkJCWpRdWVyeS51bmlxdWUoCgkJCQkJalF1ZXJ5Lm1lcmdlKCB0aGlzLmdldCgpLCBqUXVlcnkoIHNlbGVjdG9yLCBjb250ZXh0ICkgKQoJCQkJKQoJCQkpOwoJCX0sCgoJCWFkZEJhY2s6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMuYWRkKCBzZWxlY3RvciA9PSBudWxsID8KCQkJCXRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoc2VsZWN0b3IpCgkJCSk7CgkJfQoJfSk7CgoJZnVuY3Rpb24gc2libGluZyggY3VyLCBkaXIgKSB7CgkJZG8gewoJCQljdXIgPSBjdXJbIGRpciBdOwoJCX0gd2hpbGUgKCBjdXIgJiYgY3VyLm5vZGVUeXBlICE9PSAxICk7CgoJCXJldHVybiBjdXI7Cgl9CgoJalF1ZXJ5LmVhY2goewoJCXBhcmVudDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CgkJCXJldHVybiBwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlICE9PSAxMSA/IHBhcmVudCA6IG51bGw7CgkJfSwKCQlwYXJlbnRzOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sICJwYXJlbnROb2RlIiApOwoJCX0sCgkJcGFyZW50c1VudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7CgkJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIsIHVudGlsICk7CgkJfSwKCQluZXh0Og==", "base64"));
  res.write(new Buffer("IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZyggZWxlbSwgIm5leHRTaWJsaW5nIiApOwoJCX0sCgkJcHJldjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBzaWJsaW5nKCBlbGVtLCAicHJldmlvdXNTaWJsaW5nIiApOwoJCX0sCgkJbmV4dEFsbDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciICk7CgkJfSwKCQlwcmV2QWxsOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sICJwcmV2aW91c1NpYmxpbmciICk7CgkJfSwKCQluZXh0VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHsKCQkJcmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sICJuZXh0U2libGluZyIsIHVudGlsICk7CgkJfSwKCQlwcmV2VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHsKCQkJcmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sICJwcmV2aW91c1NpYmxpbmciLCB1bnRpbCApOwoJCX0sCgkJc2libGluZ3M6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4galF1ZXJ5LnNpYmxpbmcoICggZWxlbS5wYXJlbnROb2RlIHx8IHt9ICkuZmlyc3RDaGlsZCwgZWxlbSApOwoJCX0sCgkJY2hpbGRyZW46IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4galF1ZXJ5LnNpYmxpbmcoIGVsZW0uZmlyc3RDaGlsZCApOwoJCX0sCgkJY29udGVudHM6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAiaWZyYW1lIiApID8KCQkJCWVsZW0uY29udGVudERvY3VtZW50IHx8IGVsZW0uY29udGVudFdpbmRvdy5kb2N1bWVudCA6CgkJCQlqUXVlcnkubWVyZ2UoIFtdLCBlbGVtLmNoaWxkTm9kZXMgKTsKCQl9Cgl9LCBmdW5jdGlvbiggbmFtZSwgZm4gKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggdW50aWwsIHNlbGVjdG9yICkgewoJCQl2YXIgcmV0ID0galF1ZXJ5Lm1hcCggdGhpcywgZm4sIHVudGlsICk7CgoJCQlpZiAoIG5hbWUuc2xpY2UoIC01ICkgIT09ICJVbnRpbCIgKSB7CgkJCQlzZWxlY3RvciA9IHVudGlsOwoJCQl9CgoJCQlpZiAoIHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXQgPSBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgcmV0ICk7CgkJCX0KCgkJCWlmICggdGhpcy5sZW5ndGggPiAxICkgewoJCQkJLy8gUmVtb3ZlIGR1cGxpY2F0ZXMKCQkJCWlmICggIWd1YXJhbnRlZWRVbmlxdWVbIG5hbWUgXSApIHsKCQkJCQlyZXQgPSBqUXVlcnkudW5pcXVlKCByZXQgKTsKCQkJCX0KCgkJCQkvLyBSZXZlcnNlIG9yZGVyIGZvciBwYXJlbnRzKiBhbmQgcHJldi1kZXJpdmF0aXZlcwoJCQkJaWYgKCBycGFyZW50c3ByZXYudGVzdCggbmFtZSApICkgewoJCQkJCXJldCA9IHJldC5yZXZlcnNlKCk7CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggcmV0ICk7CgkJfTsKCX0pOwoJdmFyIHJub3R3aGl0ZSA9ICgvXFMrL2cpOwoKCgoJLy8gU3RyaW5nIHRvIE9iamVjdCBvcHRpb25zIGZvcm1hdCBjYWNoZQoJdmFyIG9wdGlvbnNDYWNoZSA9IHt9OwoKCS8vIENvbnZlcnQgU3RyaW5nLWZvcm1hdHRlZCBvcHRpb25zIGludG8gT2JqZWN0LWZvcm1hdHRlZCBvbmVzIGFuZCBzdG9yZSBpbiBjYWNoZQoJZnVuY3Rpb24gY3JlYXRlT3B0aW9ucyggb3B0aW9ucyApIHsKCQl2YXIgb2JqZWN0ID0gb3B0aW9uc0NhY2hlWyBvcHRpb25zIF0gPSB7fTsKCQlqUXVlcnkuZWFjaCggb3B0aW9ucy5tYXRjaCggcm5vdHdoaXRlICkgfHwgW10sIGZ1bmN0aW9uKCBfLCBmbGFnICkgewoJCQlvYmplY3RbIGZsYWcgXSA9IHRydWU7CgkJfSk7CgkJcmV0dXJuIG9iamVjdDsKCX0KCgkvKgoJICogQ3JlYXRlIGEgY2FsbGJhY2sgbGlzdCB1c2luZyB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnM6CgkgKgoJICoJb3B0aW9uczogYW4gb3B0aW9uYWwgbGlzdCBvZiBzcGFjZS1zZXBhcmF0ZWQgb3B0aW9ucyB0aGF0IHdpbGwgY2hhbmdlIGhvdwoJICoJCQl0aGUgY2FsbGJhY2sgbGlzdCBiZWhhdmVzIG9yIGEgbW9yZSB0cmFkaXRpb25hbCBvcHRpb24gb2JqZWN0CgkgKgoJICogQnkgZGVmYXVsdCBhIGNhbGxiYWNrIGxpc3Qgd2lsbCBhY3QgbGlrZSBhbiBldmVudCBjYWxsYmFjayBsaXN0IGFuZCBjYW4gYmUKCSAqICJmaXJlZCIgbXVsdGlwbGUgdGltZXMuCgkgKgoJICogUG9zc2libGUgb3B0aW9uczoKCSAqCgkgKglvbmNlOgkJCXdpbGwgZW5zdXJlIHRoZSBjYWxsYmFjayBsaXN0IGNhbiBvbmx5IGJlIGZpcmVkIG9uY2UgKGxpa2UgYSBEZWZlcnJlZCkKCSAqCgkgKgltZW1vcnk6CQkJd2lsbCBrZWVwIHRyYWNrIG9mIHByZXZpb3VzIHZhbHVlcyBhbmQgd2lsbCBjYWxsIGFueSBjYWxsYmFjayBhZGRlZAoJICoJCQkJCWFmdGVyIHRoZSBsaXN0IGhhcyBiZWVuIGZpcmVkIHJpZ2h0IGF3YXkgd2l0aCB0aGUgbGF0ZXN0ICJtZW1vcml6ZWQiCgkgKgkJCQkJdmFsdWVzIChsaWtlIGEgRGVmZXJyZWQpCgkgKgoJICoJdW5pcXVlOgkJCXdpbGwgZW5zdXJlIGEgY2FsbGJhY2sgY2FuIG9ubHkgYmUgYWRkZWQgb25jZSAobm8gZHVwbGljYXRlIGluIHRoZSBsaXN0KQoJICoKCSAqCXN0b3BPbkZhbHNlOglpbnRlcnJ1cHQgY2FsbGluZ3Mgd2hlbiBhIGNhbGxiYWNrIHJldHVybnMgZmFsc2UKCSAqCgkgKi8KCWpRdWVyeS5DYWxsYmFja3MgPSBmdW5jdGlvbiggb3B0aW9ucyApIHsKCgkJLy8gQ29udmVydCBvcHRpb25zIGZyb20gU3RyaW5nLWZvcm1hdHRlZCB0byBPYmplY3QtZm9ybWF0dGVkIGlmIG5lZWRlZAoJCS8vICh3ZSBjaGVjayBpbiBjYWNoZSBmaXJzdCkKCQlvcHRpb25zID0gdHlwZW9mIG9wdGlvbnMgPT09ICJzdHJpbmciID8KCQkJKCBvcHRpb25zQ2FjaGVbIG9wdGlvbnMgXSB8fCBjcmVhdGVPcHRpb25zKCBvcHRpb25zICkgKSA6CgkJCWpRdWVyeS5leHRlbmQoIHt9LCBvcHRpb25zICk7CgoJCXZhciAvLyBGbGFnIHRvIGtub3cgaWYgbGlzdCBpcyBjdXJyZW50bHkgZmlyaW5nCgkJCWZpcmluZywKCQkJLy8gTGFzdCBmaXJlIHZhbHVlIChmb3Igbm9uLWZvcmdldHRhYmxlIGxpc3RzKQoJCQltZW1vcnksCgkJCS8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IHdhcyBhbHJlYWR5IGZpcmVkCgkJCWZpcmVkLAoJCQkvLyBFbmQgb2YgdGhlIGxvb3Agd2hlbiBmaXJpbmcKCQkJZmlyaW5nTGVuZ3RoLAoJCQkvLyBJbmRleCBvZiBjdXJyZW50bHkgZmlyaW5nIGNhbGxiYWNrIChtb2RpZmllZCBieSByZW1vdmUgaWYgbmVlZGVkKQoJCQlmaXJpbmdJbmRleCwKCQkJLy8gRmlyc3QgY2FsbGJhY2sgdG8gZmlyZSAodXNlZCBpbnRlcm5hbGx5IGJ5IGFkZCBhbmQgZmlyZVdpdGgpCgkJCWZpcmluZ1N0YXJ0LAoJCQkvLyBBY3R1YWwgY2FsbGJhY2sgbGlzdAoJCQlsaXN0ID0gW10sCgkJCS8vIFN0YWNrIG9mIGZpcmUgY2FsbHMgZm9yIHJlcGVhdGFibGUgbGlzdHMKCQkJc3RhY2sgPSAhb3B0aW9ucy5vbmNlICYmIFtdLAoJCQkvLyBGaXJlIGNhbGxiYWNrcwoJCQlmaXJlID0gZnVuY3Rpb24oIGRhdGEgKSB7CgkJCQltZW1vcnkgPSBvcHRpb25zLm1lbW9yeSAmJiBkYXRhOwoJCQkJZmlyZWQgPSB0cnVlOwoJCQkJZmlyaW5nSW5kZXggPSBmaXJpbmdTdGFydCB8fCAwOwoJCQkJZmlyaW5nU3RhcnQgPSAwOwoJCQkJZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7CgkJCQlmaXJpbmcgPSB0cnVlOwoJCQkJZm9yICggOyBsaXN0ICYmIGZpcmluZ0luZGV4IDwgZmlyaW5nTGVuZ3RoOyBmaXJpbmdJbmRleCsrICkgewoJCQkJCWlmICggbGlzdFsgZmlyaW5nSW5kZXggXS5hcHBseSggZGF0YVsgMCBdLCBkYXRhWyAxIF0gKSA9PT0gZmFsc2UgJiYgb3B0aW9ucy5zdG9wT25GYWxzZSApIHsKCQkJCQkJbWVtb3J5ID0gZmFsc2U7IC8vIFRvIHByZXZlbnQgZnVydGhlciBjYWxscyB1c2luZyBhZGQKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQkJZmlyaW5nID0gZmFsc2U7CgkJCQlpZiAoIGxpc3QgKSB7CgkJCQkJaWYgKCBzdGFjayApIHsKCQkJCQkJaWYgKCBzdGFjay5sZW5ndGggKSB7CgkJCQkJCQlmaXJlKCBzdGFjay5zaGlmdCgpICk7CgkJCQkJCX0KCQkJCQl9IGVsc2UgaWYgKCBtZW1vcnkgKSB7CgkJCQkJCWxpc3QgPSBbXTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzZWxmLmRpc2FibGUoKTsKCQkJCQl9CgkJCQl9CgkJCX0sCgkJCS8vIEFjdHVhbCBDYWxsYmFja3Mgb2JqZWN0CgkJCXNlbGYgPSB7CgkJCQkvLyBBZGQgYSBjYWxsYmFjayBvciBhIGNvbGxlY3Rpb24gb2YgY2FsbGJhY2tzIHRvIHRoZSBsaXN0CgkJCQlhZGQ6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggbGlzdCApIHsKCQkJCQkJLy8gRmlyc3QsIHdlIHNhdmUgdGhlIGN1cnJlbnQgbGVuZ3RoCgkJCQkJCXZhciBzdGFydCA9IGxpc3QubGVuZ3RoOwoJCQkJCQkoZnVuY3Rpb24gYWRkKCBhcmdzICkgewoJCQkJCQkJalF1ZXJ5LmVhY2goIGFyZ3MsIGZ1bmN0aW9uKCBfLCBhcmcgKSB7CgkJCQkJCQkJdmFyIHR5cGUgPSBqUXVlcnkudHlwZSggYXJnICk7CgkJCQkJCQkJaWYgKCB0eXBlID09PSAiZnVuY3Rpb24iICkgewoJCQkJCQkJCQlpZiAoICFvcHRpb25zLnVuaXF1ZSB8fCAhc2VsZi5oYXMoIGFyZyApICkgewoJCQkJCQkJCQkJbGlzdC5wdXNoKCBhcmcgKTsKCQkJCQkJCQkJfQoJCQkJCQkJCX0gZWxzZSBpZiAoIGFyZyAmJiBhcmcubGVuZ3RoICYmIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJCQkJCQkvLyBJbnNwZWN0IHJlY3Vyc2l2ZWx5CgkJCQkJCQkJCWFkZCggYXJnICk7CgkJCQkJCQkJfQoJCQkJCQkJfSk7CgkJCQkJCX0pKCBhcmd1bWVudHMgKTsKCQkJCQkJLy8gRG8gd2UgbmVlZCB0byBhZGQgdGhlIGNhbGxiYWNrcyB0byB0aGUKCQkJCQkJLy8gY3VycmVudCBmaXJpbmcgYmF0Y2g/CgkJCQkJCWlmICggZmlyaW5nICkgewoJCQkJCQkJZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7CgkJCQkJCS8vIFdpdGggbWVtb3J5LCBpZiB3ZSdyZSBub3QgZmlyaW5nIHRoZW4KCQkJCQkJLy8gd2Ugc2hvdWxkIGNhbGwgcmlnaHQgYXdheQoJCQkJCQl9IGVsc2UgaWYgKCBtZW1vcnkgKSB7CgkJCQkJCQlmaXJpbmdTdGFydCA9IHN0YXJ0OwoJCQkJCQkJZmlyZSggbWVtb3J5ICk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJLy8gUmVtb3ZlIGEgY2FsbGJhY2sgZnJvbSB0aGUgbGlzdAoJCQkJcmVtb3ZlOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGxpc3QgKSB7CgkJCQkJCWpRdWVyeS5lYWNoKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBfLCBhcmcgKSB7CgkJCQkJCQl2YXIgaW5kZXg7CgkJCQkJCQl3aGlsZSAoICggaW5kZXggPSBqUXVlcnkuaW5BcnJheSggYXJnLCBsaXN0LCBpbmRleCApICkgPiAtMSApIHsKCQkJCQkJCQlsaXN0LnNwbGljZSggaW5kZXgsIDEgKTsKCQkJCQkJCQkvLyBIYW5kbGUgZmlyaW5nIGluZGV4ZXMKCQkJCQkJCQlpZiAoIGZpcmluZyApIHsKCQkJCQkJCQkJaWYgKCBpbmRleCA8PSBmaXJpbmdMZW5ndGggKSB7CgkJCQkJCQkJCQlmaXJpbmdMZW5ndGgtLTsKCQkJCQkJCQkJfQoJCQkJCQkJCQlpZiAoIGluZGV4IDw9IGZpcmluZ0luZGV4ICkgewoJCQkJCQkJCQkJZmlyaW5nSW5kZXgtLTsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCQkJCS8vIENoZWNrIGlmIGEgZ2l2ZW4gY2FsbGJhY2sgaXMgaW4gdGhlIGxpc3QuCgkJCQkvLyBJZiBubyBhcmd1bWVudCBpcyBnaXZlbiwgcmV0dXJuIHdoZXRoZXIgb3Igbm90IGxpc3QgaGFzIGNhbGxiYWNrcyBhdHRhY2hlZC4KCQkJCWhhczogZnVuY3Rpb24oIGZuICkgewoJCQkJCXJldHVybiBmbiA/IGpRdWVyeS5pbkFycmF5KCBmbiwgbGlzdCApID4gLTEgOiAhISggbGlzdCAmJiBsaXN0Lmxlbmd0aCApOwoJCQkJfSwKCQkJCS8vIFJlbW92ZSBhbGwgY2FsbGJhY2tzIGZyb20gdGhlIGxpc3QKCQkJCWVtcHR5OiBmdW5jdGlvbigpIHsKCQkJCQlsaXN0ID0gW107CgkJCQkJZmlyaW5nTGVuZ3RoID0gMDsKCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgkJCQkvLyBIYXZlIHRoZSBsaXN0IGRvIG5vdGhpbmcgYW55bW9yZQoJCQkJZGlzYWJsZTogZnVuY3Rpb24oKSB7CgkJCQkJbGlzdCA9IHN0YWNrID0gbWVtb3J5ID0gdW5kZWZpbmVkOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCQkJCS8vIElzIGl0IGRpc2FibGVkPwoJCQkJZGlzYWJsZWQ6IGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiAhbGlzdDsKCQkJCX0sCgkJCQkvLyBMb2NrIHRoZSBsaXN0IGluIGl0cyBjdXJyZW50IHN0YXRlCgkJCQlsb2NrOiBmdW5jdGlvbigpIHsKCQkJCQlzdGFjayA9IHVuZGVmaW5lZDsKCQkJCQlpZiAoICFtZW1vcnkgKSB7CgkJCQkJCXNlbGYuZGlzYWJsZSgpOwoJCQkJCX0KCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgkJCQkvLyBJcyBpdCBsb2NrZWQ/CgkJCQlsb2NrZWQ6IGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiAhc3RhY2s7CgkJCQl9LAoJCQkJLy8gQ2FsbCBhbGwgY2FsbGJhY2tzIHdpdGggdGhlIGdpdmVuIGNvbnRleHQgYW5kIGFyZ3VtZW50cwoJCQkJZmlyZVdpdGg6IGZ1bmN0aW9uKCBjb250ZXh0LCBhcmdzICkgewoJCQkJCWlmICggbGlzdCAmJiAoICFmaXJlZCB8fCBzdGFjayApICkgewoJCQkJCQlhcmdzID0gYXJncyB8fCBbXTsKCQkJCQkJYXJncyA9IFsgY29udGV4dCwgYXJncy5zbGljZSA/IGFyZ3Muc2xpY2UoKSA6IGFyZ3MgXTsKCQkJCQkJaWYgKCBmaXJpbmcgKSB7CgkJCQkJCQlzdGFjay5wdXNoKCBhcmdzICk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlmaXJlKCBhcmdzICk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJLy8gQ2FsbCBhbGwgdGhlIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBhcmd1bWVudHMKCQkJCWZpcmU6IGZ1bmN0aW9uKCkgewoJCQkJCXNlbGYuZmlyZVdpdGgoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCQkJCS8vIFRvIGtub3cgaWYgdGhlIGNhbGxiYWNrcyBoYXZlIGFscmVhZHkgYmVlbiBjYWxsZWQgYXQgbGVhc3Qgb25jZQoJCQkJZmlyZWQ6IGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiAhIWZpcmVkOwoJCQkJfQoJCQl9OwoKCQlyZXR1cm4gc2VsZjsKCX07CgoKCWpRdWVyeS5leHRlbmQoewoKCQlEZWZlcnJlZDogZnVuY3Rpb24oIGZ1bmMgKSB7CgkJCXZhciB0dXBsZXMgPSBbCgkJCQkJLy8gYWN0aW9uLCBhZGQgbGlzdGVuZXIsIGxpc3RlbmVyIGxpc3QsIGZpbmFsIHN0YXRlCgkJCQkJWyAicmVzb2x2ZSIsICJkb25lIiwgalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgInJlc29sdmVkIiBdLAoJCQkJCVsgInJlamVjdCIsICJmYWlsIiwgalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgInJlamVjdGVkIiBdLAoJCQkJCVsgIm5vdGlmeSIsICJwcm9ncmVzcyIsIGpRdWVyeS5DYWxsYmFja3MoIm1lbW9yeSIpIF0KCQkJCV0sCgkJCQlzdGF0ZSA9ICJwZW5kaW5nIiwKCQkJCXByb21pc2UgPSB7CgkJCQkJc3RhdGU6IGZ1bmN0aW9uKCkgewoJCQkJCQlyZXR1cm4gc3RhdGU7CgkJCQkJfSwKCQkJCQlhbHdheXM6IGZ1bmN0aW9uKCkgewoJCQkJCQlkZWZlcnJlZC5kb25lKCBhcmd1bWVudHMgKS5mYWlsKCBhcmd1bWVudHMgKTsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfSwKCQkJCQl0aGVuOiBmdW5jdGlvbiggLyogZm5Eb25lLCBmbkZhaWwsIGZuUHJvZ3Jlc3MgKi8gKSB7CgkJCQkJCXZhciBmbnMgPSBhcmd1bWVudHM7CgkJCQkJCXJldHVybiBqUXVlcnkuRGVmZXJyZWQoZnVuY3Rpb24oIG5ld0RlZmVyICkgewoJCQkJCQkJalF1ZXJ5LmVhY2goIHR1cGxlcywgZnVuY3Rpb24oIGksIHR1cGxlICkgewoJCQkJCQkJCXZhciBmbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBmbnNbIGkgXSApICYmIGZuc1sgaSBdOwoJCQkJCQkJCS8vIGRlZmVycmVkWyBkb25lIHwgZmFpbCB8IHByb2dyZXNzIF0gZm9yIGZvcndhcmRpbmcgYWN0aW9ucyB0byBuZXdEZWZlcgoJCQkJCQkJCWRlZmVycmVkWyB0dXBsZVsxXSBdKGZ1bmN0aW9uKCkgewoJCQkJCQkJCQl2YXIgcmV0dXJuZWQgPSBmbiAmJiBmbi5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJCQkJCQkJCWlmICggcmV0dXJuZWQgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHJldHVybmVkLnByb21pc2UgKSApIHsKCQkJCQkJCQkJCXJldHVybmVkLnByb21pc2UoKQoJCQkJCQkJCQkJCS5kb25lKCBuZXdEZWZlci5yZXNvbHZlICkKCQkJCQkJCQkJCQkuZmFpbCggbmV3RGVmZXIucmVqZWN0ICkKCQkJCQkJCQkJCQkucHJvZ3Jlc3MoIG5ld0RlZmVyLm5vdGlmeSApOwoJCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQkJbmV3RGVmZXJbIHR1cGxlWyAwIF0gKyAiV2l0aCIgXSggdGhpcyA9PT0gcHJvbWlzZSA/IG5ld0RlZmVyLnByb21pc2UoKSA6IHRoaXMsIGZuID8gWyByZXR1cm5lZCBdIDogYXJndW1lbnRzICk7CgkJCQkJCQkJCX0KCQkJCQkJCQl9KTsKCQkJCQkJCX0pOwoJCQkJCQkJZm5zID0gbnVsbDsKCQkJCQkJfSkucHJvbWlzZSgpOwoJCQkJCX0sCgkJCQkJLy8gR2V0IGEgcHJvbWlzZSBmb3IgdGhpcyBkZWZlcnJlZAoJCQkJCS8vIElmIG9iaiBpcyBwcm92aWRlZCwgdGhlIHByb21pc2UgYXNwZWN0IGlzIGFkZGVkIHRvIHRoZSBvYmplY3QKCQkJCQlwcm9taXNlOiBmdW5jdGlvbiggb2JqICkgewoJCQkJCQlyZXR1cm4gb2JqICE9IG51bGwgPyBqUXVlcnkuZXh0ZW5kKCBvYmosIHByb21pc2UgKSA6IHByb21pc2U7CgkJCQkJfQoJCQkJfSwKCQkJCWRlZmVycmVkID0ge307CgoJCQkvLyBLZWVwIHBpcGUgZm9yIGJhY2stY29tcGF0CgkJCXByb21pc2UucGlwZSA9IHByb21pc2UudGhlbjsKCgkJCS8vIEFkZCBsaXN0LXNwZWNpZmljIG1ldGhvZHMKCQkJalF1ZXJ5LmVhY2goIHR1cGxlcywgZnVuY3Rpb24oIGksIHR1cGxlICkgewoJCQkJdmFyIGxpc3QgPSB0dXBsZVsgMiBdLAoJCQkJCXN0YXRlU3RyaW5nID0gdHVwbGVbIDMgXTsKCgkJCQkvLyBwcm9taXNlWyBkb25lIHwgZmFpbCB8IHByb2dyZXNzIF0gPSBsaXN0LmFkZAoJCQkJcHJvbWlzZVsgdHVwbGVbMV0gXSA9IGxpc3QuYWRkOwoKCQkJCS8vIEhhbmRsZSBzdGF0ZQoJCQkJaWYgKCBzdGF0ZVN0cmluZyApIHsKCQkJCQlsaXN0LmFkZChmdW5jdGlvbigpIHsKCQkJCQkJLy8gc3RhdGUgPSBbIHJlc29sdmVkIHwgcmVqZWN0ZWQgXQoJCQkJCQlzdGF0ZSA9IHN0YXRlU3RyaW5nOwoKCQkJCQkvLyBbIHJlamVjdF9saXN0IHwgcmVzb2x2ZV9saXN0IF0uZGlzYWJsZTsgcHJvZ3Jlc3NfbGlzdC5sb2NrCgkJCQkJfSwgdHVwbGVzWyBpIF4gMSBdWyAyIF0uZGlzYWJsZSwgdHVwbGVzWyAyIF1bIDIgXS5sb2NrICk7CgkJCQl9CgoJCQkJLy8gZGVmZXJyZWRbIHJlc29sdmUgfCByZWplY3QgfCBub3RpZnkgXQoJCQkJZGVmZXJyZWRbIHR1cGxlWzBdIF0gPSBmdW5jdGlvbigpIHsKCQkJCQlkZWZlcnJlZFsgdHVwbGVbMF0gKyAiV2l0aCIgXSggdGhpcyA9PT0gZGVmZXJyZWQgPyBwcm9taXNlIDogdGhpcywgYXJndW1lbnRzICk7CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9OwoJCQkJZGVmZXJyZWRbIHR1cGxlWzBdICsgIldpdGgiIF0gPSBsaXN0LmZpcmVXaXRoOwoJCQl9KTsKCgkJCS8vIE1ha2UgdGhlIGRlZmVycmVkIGEgcHJvbWlzZQoJCQlwcm9taXNlLnByb21pc2UoIGRlZmVycmVkICk7CgoJCQkvLyBDYWxsIGdpdmVuIGZ1bmMgaWYgYW55CgkJCWlmICggZnVuYyApIHsKCQkJCWZ1bmMuY2FsbCggZGVmZXJyZWQsIGRlZmVycmVkICk7CgkJCX0KCgkJCS8vIEFsbCBkb25lIQoJCQlyZXR1cm4gZGVmZXJyZWQ7CgkJfSwKCgkJLy8gRGVmZXJyZWQgaGVscGVyCgkJd2hlbjogZnVuY3Rpb24oIHN1Ym9yZGluYXRlIC8qICwgLi4uLCBzdWJvcmRpbmF0ZU4gKi8gKSB7CgkJCXZhciBpID0gMCwKCQkJCXJlc29sdmVWYWx1ZXMgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSwKCQkJCWxlbmd0aCA9IHJlc29sdmVWYWx1ZXMubGVuZ3RoLAoKCQkJCS8vIHRoZSBjb3VudCBvZiB1bmNvbXBsZXRlZCBzdWJvcmRpbmF0ZXMKCQkJCXJlbWFpbmluZyA9IGxlbmd0aCAhPT0gMSB8fCAoIHN1Ym9yZGluYXRlICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCBzdWJvcmRpbmF0ZS5wcm9taXNlICkgKSA/IGxlbmd0aCA6IDAsCgoJCQkJLy8gdGhlIG1hc3RlciBEZWZlcnJlZC4gSWYgcmVzb2x2ZVZhbHVlcyBjb25zaXN0IG9mIG9ubHkgYSBzaW5nbGUgRGVmZXJyZWQsIGp1c3QgdXNlIHRoYXQuCgkJCQlkZWZlcnJlZCA9IHJlbWFpbmluZyA9PT0gMSA/IHN1Ym9yZGluYXRlIDogalF1ZXJ5LkRlZmVycmVkKCksCgoJCQkJLy8gVXBkYXRlIGZ1bmN0aW9uIGZvciBib3RoIHJlc29sdmUgYW5kIHByb2dyZXNzIHZhbHVlcwoJCQkJdXBkYXRlRnVuYyA9IGZ1bmN0aW9uKCBpLCBjb250ZXh0cywgdmFsdWVzICkgewoJCQkJCXJldHVybiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQkJCWNvbnRleHRzWyBpIF0gPSB0aGlzOwoJCQkJCQl2YWx1ZXNbIGkgXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gc2xpY2UuY2FsbCggYXJndW1lbnRzICkgOiB2YWx1ZTsKCQkJCQkJaWYgKCB2YWx1ZXMgPT09IHByb2dyZXNzVmFsdWVzICkgewoJCQkJCQkJZGVmZXJyZWQubm90aWZ5V2l0aCggY29udGV4dHMsIHZhbHVlcyApOwoKCQkJCQkJfSBlbHNlIGlmICggISgtLXJlbWFpbmluZykgKSB7CgkJCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggY29udGV4dHMsIHZhbHVlcyApOwoJCQkJCQl9CgkJCQkJfTsKCQkJCX0sCgoJCQkJcHJvZ3Jlc3NWYWx1ZXMsIHByb2dyZXNzQ29udGV4dHMsIHJlc29sdmVDb250ZXh0czsKCgkJCS8vIGFkZCBsaXN0ZW5lcnMgdG8gRGVmZXJyZWQgc3Vib3JkaW5hdGVzOyB0cmVhdCBvdGhlcnMgYXMgcmVzb2x2ZWQKCQkJaWYgKCBsZW5ndGggPiAxICkgewoJCQkJcHJvZ3Jlc3NWYWx1ZXMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJcHJvZ3Jlc3NDb250ZXh0cyA9IG5ldyBBcnJheSggbGVuZ3RoICk7CgkJCQlyZXNvbHZlQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJaWYgKCByZXNvbHZlVmFsdWVzWyBpIF0gJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlICkgKSB7CgkJCQkJCXJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlKCkKCQkJCQkJCS5kb25lKCB1cGRhdGVGdW5jKCBpLCByZXNvbHZlQ29udGV4dHMsIHJlc29sdmVWYWx1ZXMgKSApCgkJCQkJCQkuZmFpbCggZGVmZXJyZWQucmVqZWN0ICkKCQkJCQkJCS5wcm9ncmVzcyggdXBkYXRlRnVuYyggaSwgcHJvZ3Jlc3NDb250ZXh0cywgcHJvZ3Jlc3NWYWx1ZXMgKSApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCS0tcmVtYWluaW5nOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gaWYgd2UncmUgbm90IHdhaXRpbmcgb24gYW55dGhpbmcsIHJlc29sdmUgdGhlIG1hc3RlcgoJCQlpZiAoICFyZW1haW5pbmcgKSB7CgkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICk7CgkJCX0KCgkJCXJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7CgkJfQoJfSk7CgoKCS8vIFRoZSBkZWZlcnJlZCB1c2VkIG9uIERPTSByZWFkeQoJdmFyIHJlYWR5TGlzdDsKCglqUXVlcnkuZm4ucmVhZHkgPSBmdW5jdGlvbiggZm4gKSB7CgkJLy8gQWRkIHRoZSBjYWxsYmFjawoJCWpRdWVyeS5yZWFkeS5wcm9taXNlKCkuZG9uZSggZm4gKTsKCgkJcmV0dXJuIHRoaXM7Cgl9OwoKCWpRdWVyeS5leHRlbmQoewoJCS8vIElzIHRoZSBET00gcmVhZHkgdG8gYmUgdXNlZD8gU2V0IHRvIHRydWUgb25jZSBpdCBvY2N1cnMuCgkJaXNSZWFkeTogZmFsc2UsCgoJCS8vIEEgY291bnRlciB0byB0cmFjayBob3cgbWFueSBpdGVtcyB0byB3YWl0IGZvciBiZWZvcmUKCQkvLyB0aGUgcmVhZHkgZXZlbnQgZmlyZXMuIFNlZSAjNjc4MQoJCXJlYWR5V2FpdDogMSwKCgkJLy8gSG9sZCAob3IgcmVsZWFzZSkgdGhlIHJlYWR5IGV2ZW50CgkJaG9sZFJlYWR5OiBmdW5jdGlvbiggaG9sZCApIHsKCQkJaWYgKCBob2xkICkgewoJCQkJalF1ZXJ5LnJlYWR5V2FpdCsrOwoJCQl9IGVsc2UgewoJCQkJalF1ZXJ5LnJlYWR5KCB0cnVlICk7CgkJCX0KCQl9LAoKCQkvLyBIYW5kbGUgd2hlbiB0aGUgRE9NIGlzIHJlYWR5CgkJcmVhZHk6IGZ1bmN0aW9uKCB3YWl0ICkgewoKCQkJLy8gQWJvcnQgaWYgdGhlcmUgYXJlIHBlbmRpbmcgaG9sZHMgb3Igd2UncmUgYWxyZWFkeSByZWFkeQoJCQlpZiAoIHdhaXQgPT09IHRydWUgPyAtLWpRdWVyeS5yZWFkeVdhaXQgOiBqUXVlcnkuaXNSZWFkeSApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gTWFrZSBzdXJlIGJvZHkgZXhpc3RzLCBhdCBsZWFzdCwgaW4gY2FzZSBJRSBnZXRzIGEgbGl0dGxlIG92ZXJ6ZWFsb3VzICh0aWNrZXQgIzU0NDMpLgoJCQlpZiAoICFkb2N1bWVudC5ib2R5ICkgewoJCQkJcmV0dXJuIHNldFRpbWVvdXQoIGpRdWVyeS5yZWFkeSApOwoJCQl9CgoJCQkvLyBSZW1lbWJlciB0aGF0IHRoZSBET00gaXMgcmVhZHkKCQkJalF1ZXJ5LmlzUmVhZHkgPSB0cnVlOwoKCQkJLy8gSWYgYSBub3JtYWwgRE9NIFJlYWR5IGV2ZW50IGZpcmVkLCBkZWNyZW1lbnQsIGFuZCB3YWl0IGlmIG5lZWQgYmUKCQkJaWYgKCB3YWl0ICE9PSB0cnVlICYmIC0talF1ZXJ5LnJlYWR5V2FpdCA+IDAgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIElmIHRoZXJlIGFyZSBmdW5jdGlvbnMgYm91bmQsIHRvIGV4ZWN1dGUKCQkJcmVhZHlMaXN0LnJlc29sdmVXaXRoKCBkb2N1bWVudCwgWyBqUXVlcnkgXSApOwoKCQkJLy8gVHJpZ2dlciBhbnkgYm91bmQgcmVhZHkgZXZlbnRzCgkJCWlmICggalF1ZXJ5LmZuLnRyaWdnZXJIYW5kbGVyICkgewoJCQkJalF1ZXJ5KCBkb2N1bWVudCApLnRyaWdnZXJIYW5kbGVyKCAicmVhZHkiICk7CgkJCQlqUXVlcnkoIGRvY3VtZW50ICkub2ZmKCAicmVhZHkiICk7CgkJCX0KCQl9Cgl9KTsKCgkvKioKCSAqIENsZWFuLXVwIG1ldGhvZCBmb3IgZG9tIHJlYWR5IGV2ZW50cwoJICovCglmdW5jdGlvbiBkZXRhY2goKSB7CgkJaWYgKCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICkgewoJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAiRE9NQ29udGVudExvYWRlZCIsIGNvbXBsZXRlZCwgZmFsc2UgKTsKCQkJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICJsb2FkIiwgY29tcGxldGVkLCBmYWxzZSApOwoKCQl9IGVsc2UgewoJCQlkb2N1bWVudC5kZXRhY2hFdmVudCggIm9ucmVhZHlzdGF0ZWNoYW5nZSIsIGNvbXBsZXRlZCApOwoJCQl3aW5kb3cuZGV0YWNoRXZlbnQoICJvbmxvYWQiLCBjb21wbGV0ZWQgKTsKCQl9Cgl9CgoJLyoqCgkgKiBUaGUgcmVhZHkgZXZlbnQgaGFuZGxlciBhbmQgc2VsZiBjbGVhbnVwIG1ldGhvZAoJICovCglmdW5jdGlvbiBjb21wbGV0ZWQoKSB7CgkJLy8gcmVhZHlTdGF0ZSA9PT0gImNvbXBsZXRlIiBpcyBnb29kIGVub3VnaCBmb3IgdXMgdG8gY2FsbCB0aGUgZG9tIHJlYWR5IGluIG9sZElFCgkJaWYgKCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyIHx8IGV2ZW50LnR5cGUgPT09ICJsb2FkIiB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiICkgewoJCQlkZXRhY2goKTsKCQkJalF1ZXJ5LnJlYWR5KCk7CgkJfQoJfQoKCWpRdWVyeS5yZWFkeS5wcm9taXNlID0gZnVuY3Rpb24oIG9iaiApIHsKCQlpZiAoICFyZWFkeUxpc3QgKSB7CgoJCQlyZWFkeUxpc3QgPSBqUXVlcnkuRGVmZXJyZWQoKTsKCgkJCS8vIENhdGNoIGNhc2VzIHdoZXJlICQoZG9jdW1lbnQpLnJlYWR5KCkgaXMgY2FsbGVkIGFmdGVyIHRoZSBicm93c2VyIGV2ZW50IGhhcyBhbHJlYWR5IG9jY3VycmVkLgoJCQkvLyB3ZSBvbmNlIHRyaWVkIHRvIHVzZSByZWFkeVN0YXRlICJpbnRlcmFjdGl2ZSIgaGVyZSwgYnV0IGl0IGNhdXNlZCBpc3N1ZXMgbGlrZSB0aGUgb25lCgkJCS8vIGRpc2NvdmVyZWQgYnkgQ2hyaXNTIGhlcmU6IGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMjgyI2NvbW1lbnQ6MTUKCQkJaWYgKCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiICkgewoJCQkJLy8gSGFuZGxlIGl0IGFzeW5jaHJvbm91c2x5IHRvIGFsbG93IHNjcmlwdHMgdGhlIG9wcG9ydHVuaXR5IHRvIGRlbGF5IHJlYWR5CgkJCQlzZXRUaW1lb3V0KCBqUXVlcnkucmVhZHkgKTsKCgkJCS8vIFN0YW5kYXJkcy1iYXNlZCBicm93c2VycyBzdXBwb3J0IERPTUNvbnRlbnRMb2FkZWQKCQkJfSBlbHNlIGlmICggZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciApIHsKCQkJCS8vIFVzZSB0aGUgaGFuZHkgZXZlbnQgY2FsbGJhY2sKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICJET01Db250ZW50TG9hZGVkIiwgY29tcGxldGVkLCBmYWxzZSApOwoKCQkJCS8vIEEgZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrCgkJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggImxvYWQiLCBjb21wbGV0ZWQsIGZhbHNlICk7CgoJCQkvLyBJZiBJRSBldmVudCBtb2RlbCBpcyB1c2VkCgkJCX0gZWxzZSB7CgkJCQkvLyBFbnN1cmUgZmlyaW5nIGJlZm9yZSBvbmxvYWQsIG1heWJlIGxhdGUgYnV0IHNhZmUgYWxzbyBmb3IgaWZyYW1lcwoJCQkJZG9jdW1lbnQuYXR0YWNoRXZlbnQoICJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBjb21wbGV0ZWQgKTsKCgkJCQkvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29yawoJCQkJd2luZG93LmF0dGFjaEV2ZW50KCAib25sb2FkIiwgY29tcGxldGVkICk7CgoJCQkJLy8gSWYgSUUgYW5kIG5vdCBhIGZyYW1lCgkJCQkvLyBjb250aW51YWxseSBjaGVjayB0byBzZWUgaWYgdGhlIGRvY3VtZW50IGlzIHJlYWR5CgkJCQl2YXIgdG9wID0gZmFsc2U7CgoJCQkJdHJ5IHsKCQkJCQl0b3AgPSB3aW5kb3cuZnJhbWVFbGVtZW50ID09IG51bGwgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoJCQkJfSBjYXRjaChlKSB7fQoKCQkJCWlmICggdG9wICYmIHRvcC5kb1Njcm9sbCApIHsKCQkJCQkoZnVuY3Rpb24gZG9TY3JvbGxDaGVjaygpIHsKCQkJCQkJaWYgKCAhalF1ZXJ5LmlzUmVhZHkgKSB7CgoJCQkJCQkJdHJ5IHsKCQkJCQkJCQkvLyBVc2UgdGhlIHRyaWNrIGJ5IERpZWdvIFBlcmluaQoJCQkJCQkJCS8vIGh0dHA6Ly9qYXZhc2NyaXB0Lm53Ym94LmNvbS9JRUNvbnRlbnRMb2FkZWQvCgkJCQkJCQkJdG9wLmRvU2Nyb2xsKCJsZWZ0Iik7CgkJCQkJCQl9IGNhdGNoKGUpIHsKCQkJCQkJCQlyZXR1cm4gc2V0VGltZW91dCggZG9TY3JvbGxDaGVjaywgNTAgKTsKCQkJCQkJCX0KCgkJCQkJCQkvLyBkZXRhY2ggYWxsIGRvbSByZWFkeSBldmVudHMKCQkJCQkJCWRldGFjaCgpOwoKCQkJCQkJCS8vIGFuZCBleGVjdXRlIGFueSB3YWl0aW5nIGZ1bmN0aW9ucwoJCQkJCQkJalF1ZXJ5LnJlYWR5KCk7CgkJCQkJCX0KCQkJCQl9KSgpOwoJCQkJfQoJCQl9CgkJfQoJCXJldHVybiByZWFkeUxpc3QucHJvbWlzZSggb2JqICk7Cgl9OwoKCgl2YXIgc3RydW5kZWZpbmVkID0gdHlwZW9mIHVuZGVmaW5lZDsKCgoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIEl0ZXJhdGlvbiBvdmVyIG9iamVjdCdzIGluaGVyaXRlZCBwcm9wZXJ0aWVzIGJlZm9yZSBpdHMgb3duCgl2YXIgaTsKCWZvciAoIGkgaW4galF1ZXJ5KCBzdXBwb3J0ICkgKSB7CgkJYnJlYWs7Cgl9CglzdXBwb3J0Lm93bkxhc3QgPSBpICE9PSAiMCI7CgoJLy8gTm90ZTogbW9zdCBzdXBwb3J0IHRlc3RzIGFyZSBkZWZpbmVkIGluIHRoZWlyIHJlc3BlY3RpdmUgbW9kdWxlcy4KCS8vIGZhbHNlIHVudGlsIHRoZSB0ZXN0IGlzIHJ1bgoJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gZmFsc2U7CgoJLy8gRXhlY3V0ZSBBU0FQIGluIGNhc2Ugd2UgbmVlZCB0byBzZXQgYm9keS5zdHlsZS56b29tCglqUXVlcnkoZnVuY3Rpb24oKSB7CgkJLy8gTWluaWZpZWQ6IHZhciBhLGIsYyxkCgkJdmFyIHZhbCwgZGl2LCBib2R5LCBjb250YWluZXI7CgoJCWJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSggImJvZHkiIClbIDAgXTsKCQlpZiAoICFib2R5IHx8ICFib2R5LnN0eWxlICkgewoJCQkvLyBSZXR1cm4gZm9yIGZyYW1lc2V0IGRvY3MgdGhhdCBkb24ndCBoYXZlIGEgYm9keQoJCQlyZXR1cm47CgkJfQoKCQkvLyBTZXR1cAoJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweCI7CgkJYm9keS5hcHBlbmRDaGlsZCggY29udGFpbmVyICkuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQlpZiAoIHR5cGVvZiBkaXYuc3R5bGUuem9vbSAhPT0gc3RydW5kZWZpbmVkICkgewoJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCS8vIENoZWNrIGlmIG5hdGl2ZWx5IGJsb2NrLWxldmVsIGVsZW1lbnRzIGFjdCBsaWtlIGlubGluZS1ibG9jawoJCQkvLyBlbGVtZW50cyB3aGVuIHNldHRpbmcgdGhlaXIgZGlzcGxheSB0byAnaW5saW5lJyBhbmQgZ2l2aW5nCgkJCS8vIHRoZW0gbGF5b3V0CgkJCWRpdi5zdHlsZS5jc3NUZXh0ID0gImRpc3BsYXk6aW5saW5lO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MXB4O3dpZHRoOjFweDt6b29tOjEiOwoKCQkJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gdmFsID0gZGl2Lm9mZnNldFdpZHRoID09PSAzOwoJCQlpZiAoIHZhbCApIHsKCQkJCS8vIFByZXZlbnQgSUUgNiBmcm9tIGFmZmVjdGluZyBsYXlvdXQgZm9yIHBvc2l0aW9uZWQgZWxlbWVudHMgIzExMDQ4CgkJCQkvLyBQcmV2ZW50IElFIGZyb20gc2hyaW5raW5nIHRoZSBib2R5IGluIElFIDcgbW9kZSAjMTI4NjkKCQkJCS8vIFN1cHBvcnQ6IElFPDgKCQkJCWJvZHkuc3R5bGUuem9vbSA9IDE7CgkJCX0KCQl9CgoJCWJvZHkucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApOwoJfSk7CgoKCgoJKGZ1bmN0aW9uKCkgewoJCXZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoKCQkvLyBFeGVjdXRlIHRoZSB0ZXN0IG9ubHkgaWYgbm90IGFscmVhZHkgZXhlY3V0ZWQgaW4gYW5vdGhlciBtb2R1bGUuCgkJaWYgKHN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9PSBudWxsKSB7CgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJc3VwcG9ydC5kZWxldGVFeHBhbmRvID0gdHJ1ZTsKCQkJdHJ5IHsKCQkJCWRlbGV0ZSBkaXYudGVzdDsKCQkJfSBjYXRjaCggZSApIHsKCQkJCXN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9IGZhbHNlOwoJCQl9CgkJfQoKCQkvLyBOdWxsIGVsZW1lbnRzIHRvIGF2b2lkIGxlYWtzIGluIElFLgoJCWRpdiA9IG51bGw7Cgl9KSgpOwoKCgkvKioKCSAqIERldGVybWluZXMgd2hldGhlciBhbiBvYmplY3QgY2FuIGhhdmUgZGF0YQoJICovCglqUXVlcnkuYWNjZXB0RGF0YSA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXZhciBub0RhdGEgPSBqUXVlcnkubm9EYXRhWyAoZWxlbS5ub2RlTmFtZSArICIgIikudG9Mb3dlckNhc2UoKSBdLAoJCQlub2RlVHlwZSA9ICtlbGVtLm5vZGVUeXBlIHx8IDE7CgoJCS8vIERvIG5vdCBzZXQgZGF0YSBvbiBub24tZWxlbWVudCBET00gbm9kZXMgYmVjYXVzZSBpdCB3aWxsIG5vdCBiZSBjbGVhcmVkICgjODMzNSkuCgkJcmV0dXJuIG5vZGVUeXBlICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ID8KCQkJZmFsc2UgOgoKCQkJLy8gTm9kZXMgYWNjZXB0IGRhdGEgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQ7IHJlamVjdGlvbiBjYW4gYmUgY29uZGl0aW9uYWwKCQkJIW5vRGF0YSB8fCBub0RhdGEgIT09IHRydWUgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoImNsYXNzaWQiKSA9PT0gbm9EYXRhOwoJfTsKCgoJdmFyIHJicmFjZSA9IC9eKD86XHtbXHdcV10qXH18XFtbXHdcV10qXF0pJC8sCgkJcm11bHRpRGFzaCA9IC8oW0EtWl0pL2c7CgoJZnVuY3Rpb24gZGF0YUF0dHIoIGVsZW0sIGtleSwgZGF0YSApIHsKCQkvLyBJZiBub3RoaW5nIHdhcyBmb3VuZCBpbnRlcm5hbGx5LCB0cnkgdG8gZmV0Y2ggYW55CgkJLy8gZGF0YSBmcm9tIHRoZSBIVE1MNSBkYXRhLSogYXR0cmlidXRlCgkJaWYgKCBkYXRhID09PSB1bmRlZmluZWQgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCgkJCXZhciBuYW1lID0gImRhdGEtIiArIGtleS5yZXBsYWNlKCBybXVsdGlEYXNoLCAiLSQxIiApLnRvTG93ZXJDYXNlKCk7CgoJCQlkYXRhID0gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKTsKCgkJCWlmICggdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciICkgewoJCQkJdHJ5IHsKCQkJCQlkYXRhID0gZGF0YSA9PT0gInRydWUiID8gdHJ1ZSA6CgkJCQkJCWRhdGEgPT09ICJmYWxzZSIgPyBmYWxzZSA6CgkJCQkJCWRhdGEgPT09ICJudWxsIiA/IG51bGwgOgoJCQkJCQkvLyBPbmx5IGNvbnZlcnQgdG8gYSBudW1iZXIgaWYgaXQgZG9lc24ndCBjaGFuZ2UgdGhlIHN0cmluZwoJCQkJCQkrZGF0YSArICIiID09PSBkYXRhID8gK2RhdGEgOgoJCQkJCQlyYnJhY2UudGVzdCggZGF0YSApID8galF1ZXJ5LnBhcnNlSlNPTiggZGF0YSApIDoKCQkJCQkJZGF0YTsKCQkJCX0gY2F0Y2goIGUgKSB7fQoKCQkJCS8vIE1ha2Ugc3VyZSB3ZSBzZXQgdGhlIGRhdGEgc28gaXQgaXNuJ3QgY2hhbmdlZCBsYXRlcgoJCQkJalF1ZXJ5LmRhdGEoIGVsZW0sIGtleSwgZGF0YSApOwoKCQkJfSBlbHNlIHsKCQkJCWRhdGEgPSB1bmRlZmluZWQ7CgkJCX0KCQl9CgoJCXJldHVybiBkYXRhOwoJfQoKCS8vIGNoZWNrcyBhIGNhY2hlIG9iamVjdCBmb3IgZW1wdGluZXNzCglmdW5jdGlvbiBpc0VtcHR5RGF0YU9iamVjdCggb2JqICkgewoJCXZhciBuYW1lOwoJCWZvciAoIG5hbWUgaW4gb2JqICkgewoKCQkJLy8gaWYgdGhlIHB1YmxpYyBkYXRhIG9iamVjdCBpcyBlbXB0eSwgdGhlIHByaXZhdGUgaXMgc3RpbGwgZW1wdHkKCQkJaWYgKCBuYW1lID09PSAiZGF0YSIgJiYgalF1ZXJ5LmlzRW1wdHlPYmplY3QoIG9ialtuYW1lXSApICkgewoJCQkJY29udGludWU7CgkJCX0KCQkJaWYgKCBuYW1lICE9PSAidG9KU09OIiApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX0KCgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gaW50ZXJuYWxEYXRhKCBlbGVtLCBuYW1lLCBkYXRhLCBwdnQgLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8gKSB7CgkJaWYgKCAhalF1ZXJ5LmFjY2VwdERhdGEoIGVsZW0gKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIHJldCwgdGhpc0NhY2hlLAoJCQlpbnRlcm5hbEtleSA9IGpRdWVyeS5leHBhbmRvLAoKCQkJLy8gV2UgaGF2ZSB0byBoYW5kbGUgRE9NIG5vZGVzIGFuZCBKUyBvYmplY3RzIGRpZmZlcmVudGx5IGJlY2F1c2UgSUU2LTcKCQkJLy8gY2FuJ3QgR0Mgb2JqZWN0IHJlZmVyZW5jZXMgcHJvcGVybHkgYWNyb3NzIHRoZSBET00tSlMgYm91bmRhcnkKCQkJaXNOb2RlID0gZWxlbS5ub2RlVHlwZSwKCgkJCS8vIE9ubHkgRE9NIG5vZGVzIG5lZWQgdGhlIGdsb2JhbCBqUXVlcnkgY2FjaGU7IEpTIG9iamVjdCBkYXRhIGlzCgkJCS8vIGF0dGFjaGVkIGRpcmVjdGx5IHRvIHRoZSBvYmplY3Qgc28gR0MgY2FuIG9jY3VyIGF1dG9tYXRpY2FsbHkKCQkJY2FjaGUgPSBpc05vZGUgPyBqUXVlcnkuY2FjaGUgOiBlbGVtLAoKCQkJLy8gT25seSBkZWZpbmluZyBhbiBJRCBmb3IgSlMgb2JqZWN0cyBpZiBpdHMgY2FjaGUgYWxyZWFkeSBleGlzdHMgYWxsb3dzCgkJCS8vIHRoZSBjb2RlIHRvIHNob3J0Y3V0IG9uIHRoZSBzYW1lIHBhdGggYXMgYSBET00gbm9kZSB3aXRoIG5vIGNhY2hlCgkJCWlkID0gaXNOb2RlID8gZWxlbVsgaW50ZXJuYWxLZXkgXSA6IGVsZW1bIGludGVybmFsS2V5IF0gJiYgaW50ZXJuYWxLZXk7CgoJCS8vIEF2b2lkIGRvaW5nIGFueSBtb3JlIHdvcmsgdGhhbiB3ZSBuZWVkIHRvIHdoZW4gdHJ5aW5nIHRvIGdldCBkYXRhIG9uIGFuCgkJLy8gb2JqZWN0IHRoYXQgaGFzIG5vIGRhdGEgYXQgYWxsCgkJaWYgKCAoIWlkIHx8ICFjYWNoZVtpZF0gfHwgKCFwdnQgJiYgIWNhY2hlW2lkXS5kYXRhKSkgJiYgZGF0YSA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBuYW1lID09PSAic3RyaW5nIiApIHsKCQkJcmV0dXJuOwoJCX0KCgkJaWYgKCAhaWQgKSB7CgkJCS8vIE9ubHkgRE9NIG5vZGVzIG5lZWQgYSBuZXcgdW5pcXVlIElEIGZvciBlYWNoIGVsZW1lbnQgc2luY2UgdGhlaXIgZGF0YQoJCQkvLyBlbmRzIHVwIGluIHRoZSBnbG9iYWwgY2FjaGUKCQkJaWYgKCBpc05vZGUgKSB7CgkJCQlpZCA9IGVsZW1bIGludGVybmFsS2V5IF0gPSBkZWxldGVkSWRzLnBvcCgpIHx8IGpRdWVyeS5ndWlkKys7CgkJCX0gZWxzZSB7CgkJCQlpZCA9IGludGVybmFsS2V5OwoJCQl9CgkJfQoKCQlpZiAoICFjYWNoZVsgaWQgXSApIHsKCQkJLy8gQXZvaWQgZXhwb3NpbmcgalF1ZXJ5IG1ldGFkYXRhIG9uIHBsYWluIEpTIG9iamVjdHMgd2hlbiB0aGUgb2JqZWN0CgkJCS8vIGlzIHNlcmlhbGl6ZWQgdXNpbmcgSlNPTi5zdHJpbmdpZnkKCQkJY2FjaGVbIGlkIF0gPSBpc05vZGUgPyB7fSA6IHsgdG9KU09OOiBqUXVlcnkubm9vcCB9OwoJCX0KCgkJLy8gQW4gb2JqZWN0IGNhbiBiZSBwYXNzZWQgdG8galF1ZXJ5LmRhdGEgaW5zdGVhZCBvZiBhIGtleS92YWx1ZSBwYWlyOyB0aGlzIGdldHMKCQkvLyBzaGFsbG93IGNvcGllZCBvdmVyIG9udG8gdGhlIGV4aXN0aW5nIGNhY2hlCgkJaWYgKCB0eXBlb2YgbmFtZSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIG5hbWUgPT09ICJmdW5jdGlvbiIgKSB7CgkJCWlmICggcHZ0ICkgewoJCQkJY2FjaGVbIGlkIF0gPSBqUXVlcnkuZXh0ZW5kKCBjYWNoZVsgaWQgXSwgbmFtZSApOwoJCQl9IGVsc2UgewoJCQkJY2FjaGVbIGlkIF0uZGF0YSA9IGpRdWVyeS5leHRlbmQoIGNhY2hlWyBpZCBdLmRhdGEsIG5hbWUgKTsKCQkJfQoJCX0KCgkJdGhpc0NhY2hlID0gY2FjaGVbIGlkIF07CgoJCS8vIGpRdWVyeSBkYXRhKCkgaXMgc3RvcmVkIGluIGEgc2VwYXJhdGUgb2JqZWN0IGluc2lkZSB0aGUgb2JqZWN0J3MgaW50ZXJuYWwgZGF0YQoJCS8vIGNhY2hlIGluIG9yZGVyIHRvIGF2b2lkIGtleSBjb2xsaXNpb25zIGJldHdlZW4gaW50ZXJuYWwgZGF0YSBhbmQgdXNlci1kZWZpbmVkCgkJLy8gZGF0YS4KCQlpZiAoICFwdnQgKSB7CgkJCWlmICggIXRoaXNDYWNoZS5kYXRhICkgewoJCQkJdGhpc0NhY2hlLmRhdGEgPSB7fTsKCQkJfQoKCQkJdGhpc0NhY2hlID0gdGhpc0NhY2hlLmRhdGE7CgkJfQoKCQlpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHsKCQkJdGhpc0NhY2hlWyBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICkgXSA9IGRhdGE7CgkJfQoKCQkvLyBDaGVjayBmb3IgYm90aCBjb252ZXJ0ZWQtdG8tY2FtZWwgYW5kIG5vbi1jb252ZXJ0ZWQgZGF0YSBwcm9wZXJ0eSBuYW1lcwoJCS8vIElmIGEgZGF0YSBwcm9wZXJ0eSB3YXMgc3BlY2lmaWVkCgkJaWYgKCB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7CgoJCQkvLyBGaXJzdCBUcnkgdG8gZmluZCBhcy1pcyBwcm9wZXJ0eSBkYXRhCgkJCXJldCA9IHRoaXNDYWNoZVsgbmFtZSBdOwoKCQkJLy8gVGVzdCBmb3IgbnVsbHx1bmRlZmluZWQgcHJvcGVydHkgZGF0YQoJCQlpZiAoIHJldCA9PSBudWxsICkgewoKCQkJCS8vIFRyeSB0byBmaW5kIHRoZSBjYW1lbENhc2VkIHByb3BlcnR5CgkJCQlyZXQgPSB0aGlzQ2FjaGVbIGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSBdOwoJCQl9CgkJfSBlbHNlIHsKCQkJcmV0ID0gdGhpc0NhY2hlOwoJCX0KCgkJcmV0dXJuIHJldDsKCX0KCglmdW5jdGlvbiBpbnRlcm5hbFJlbW92ZURhdGEoIGVsZW0sIG5hbWUsIHB2dCApIHsKCQlpZiAoICFqUXVlcnkuYWNjZXB0RGF0YSggZWxlbSApICkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgdGhpc0NhY2hlLCBpLAoJCQlpc05vZGUgPSBlbGVtLm5vZGVUeXBlLAoKCQkJLy8gU2VlIGpRdWVyeS5kYXRhIGZvciBtb3JlIGluZm9ybWF0aW9uCgkJCWNhY2hlID0gaXNOb2RlID8galF1ZXJ5LmNhY2hlIDogZWxlbSwKCQkJaWQgPSBpc05vZGUgPyBlbGVtWyBqUXVlcnkuZXhwYW5kbyBdIDogalF1ZXJ5LmV4cGFuZG87CgoJCS8vIElmIHRoZXJlIGlzIGFscmVhZHkgbm8gY2FjaGUgZW50cnkgZm9yIHRoaXMgb2JqZWN0LCB0aGVyZSBpcyBubwoJCS8vIHB1cnBvc2UgaW4gY29udGludWluZwoJCWlmICggIWNhY2hlWyBpZCBdICkgewoJCQlyZXR1cm47CgkJfQoKCQlpZiAoIG5hbWUgKSB7CgoJCQl0aGlzQ2FjaGUgPSBwdnQgPyBjYWNoZVsgaWQgXSA6IGNhY2hlWyBpZCBdLmRhdGE7CgoJCQlpZiAoIHRoaXNDYWNoZSApIHsKCgkJCQkvLyBTdXBwb3J0IGFycmF5IG9yIHNwYWNlIHNlcGFyYXRlZCBzdHJpbmcgbmFtZXMgZm9yIGRhdGEga2V5cwoJCQkJaWYgKCAhalF1ZXJ5LmlzQXJyYXkoIG5hbWUgKSApIHsKCgkJCQkJLy8gdHJ5IHRoZSBzdHJpbmcgYXMgYSBrZXkgYmVmb3JlIGFueSBtYW5pcHVsYXRpb24KCQkJCQlpZiAoIG5hbWUgaW4gdGhpc0NhY2hlICkgewoJCQkJCQluYW1lID0gWyBuYW1lIF07CgkJCQkJfSBlbHNlIHsKCgkJCQkJCS8vIHNwbGl0IHRoZSBjYW1lbCBjYXNlZCB2ZXJzaW9uIGJ5IHNwYWNlcyB1bmxlc3MgYSBrZXkgd2l0aCB0aGUgc3BhY2VzIGV4aXN0cwoJCQkJCQluYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApOwoJCQkJCQlpZiAoIG5hbWUgaW4gdGhpc0NhY2hlICkgewoJCQkJCQkJbmFtZSA9IFsgbmFtZSBdOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJbmFtZSA9IG5hbWUuc3BsaXQoIiAiKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJLy8gSWYgIm5hbWUiIGlzIGFuIGFycmF5IG9mIGtleXMuLi4KCQkJCQkvLyBXaGVuIGRhdGEgaXMgaW5pdGlhbGx5IGNyZWF0ZWQsIHZpYSAoImtleSIsICJ2YWwiKSBzaWduYXR1cmUsCgkJCQkJLy8ga2V5cyB3aWxsIGJlIGNvbnZlcnRlZCB0byBjYW1lbENhc2UuCgkJCQkJLy8gU2luY2UgdGhlcmUgaXMgbm8gd2F5IHRvIHRlbGwgX2hvd18gYSBrZXkgd2FzIGFkZGVkLCByZW1vdmUKCQkJCQkvLyBib3RoIHBsYWluIGtleSBhbmQgY2FtZWxDYXNlIGtleS4gIzEyNzg2CgkJCQkJLy8gVGhpcyB3aWxsIG9ubHkgcGVuYWxpemUgdGhlIGFycmF5IGFyZ3VtZW50IHBhdGguCgkJCQkJbmFtZSA9IG5hbWUuY29uY2F0KCBqUXVlcnkubWFwKCBuYW1lLCBqUXVlcnkuY2FtZWxDYXNlICkgKTsKCQkJCX0KCgkJCQlpID0gbmFtZS5sZW5ndGg7CgkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQlkZWxldGUgdGhpc0NhY2hlWyBuYW1lW2ldIF07CgkJCQl9CgoJCQkJLy8gSWYgdGhlcmUgaXMgbm8gZGF0YSBsZWZ0IGluIHRoZSBjYWNoZSwgd2Ugd2FudCB0byBjb250aW51ZQoJCQkJLy8gYW5kIGxldCB0aGUgY2FjaGUgb2JqZWN0IGl0c2VsZiBnZXQgZGVzdHJveWVkCgkJCQlpZiAoIHB2dCA/ICFpc0VtcHR5RGF0YU9iamVjdCh0aGlzQ2FjaGUpIDogIWpRdWVyeS5pc0VtcHR5T2JqZWN0KHRoaXNDYWNoZSkgKSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgkJfQoKCQkvLyBTZWUgalF1ZXJ5LmRhdGEgZm9yIG1vcmUgaW5mb3JtYXRpb24KCQlpZiAoICFwdnQgKSB7CgkJCWRlbGV0ZSBjYWNoZVsgaWQgXS5kYXRhOwoKCQkJLy8gRG9uJ3QgZGVzdHJveSB0aGUgcGFyZW50IGNhY2hlIHVubGVzcyB0aGUgaW50ZXJuYWwgZGF0YSBvYmplY3QKCQkJLy8gaGFkIGJlZW4gdGhlIG9ubHkgdGhpbmcgbGVmdCBpbiBpdAoJCQlpZiAoICFpc0VtcHR5RGF0YU9iamVjdCggY2FjaGVbIGlkIF0gKSApIHsKCQkJCXJldHVybjsKCQkJfQoJCX0KCgkJLy8gRGVzdHJveSB0aGUgY2FjaGUKCQlpZiAoIGlzTm9kZSApIHsKCQkJalF1ZXJ5LmNsZWFuRGF0YSggWyBlbGVtIF0sIHRydWUgKTsKCgkJLy8gVXNlIGRlbGV0ZSB3aGVuIHN1cHBvcnRlZCBmb3IgZXhwYW5kb3Mgb3IgYGNhY2hlYCBpcyBub3QgYSB3aW5kb3cgcGVyIGlzV2luZG93ICgjMTAwODApCgkJLyoganNoaW50IGVxZXFlcTogZmFsc2UgKi8KCQl9IGVsc2UgaWYgKCBzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gfHwgY2FjaGUgIT0gY2FjaGUud2luZG93ICkgewoJCQkvKiBqc2hpbnQgZXFlcWVxOiB0cnVlICovCgkJCWRlbGV0ZSBjYWNoZVsgaWQgXTsKCgkJLy8gV2hlbiBhbGwgZWxzZSBmYWlscywgbnVsbAoJCX0gZWxzZSB7CgkJCWNhY2hlWyBpZCBdID0gbnVsbDsKCQl9Cgl9CgoJalF1ZXJ5LmV4dGVuZCh7CgkJY2FjaGU6IHt9LAoKCQkvLyBUaGUgZm9sbG93aW5nIGVsZW1lbnRzIChzcGFjZS1zdWZmaXhlZCB0byBhdm9pZCBPYmplY3QucHJvdG90eXBlIGNvbGxpc2lvbnMpCgkJLy8gdGhyb3cgdW5jYXRjaGFibGUgZXhjZXB0aW9ucyBpZiB5b3UgYXR0ZW1wdCB0byBzZXQgZXhwYW5kbyBwcm9wZXJ0aWVzCgkJbm9EYXRhOiB7CgkJCSJhcHBsZXQgIjogdHJ1ZSwKCQkJImVtYmVkICI6IHRydWUsCgkJCS8vIC4uLmJ1dCBGbGFzaCBvYmplY3RzICh3aGljaCBoYXZlIHRoaXMgY2xhc3NpZCkgKmNhbiogaGFuZGxlIGV4cGFuZG9zCgkJCSJvYmplY3QgIjogImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMCIKCQl9LAoKCQloYXNEYXRhOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJZWxlbSA9IGVsZW0ubm9kZVR5cGUgPyBqUXVlcnkuY2FjaGVbIGVsZW1balF1ZXJ5LmV4cGFuZG9dIF0gOiBlbGVtWyBqUXVlcnkuZXhwYW5kbyBdOwoJCQlyZXR1cm4gISFlbGVtICYmICFpc0VtcHR5RGF0YU9iamVjdCggZWxlbSApOwoJCX0sCgoJCWRhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBkYXRhICkgewoJCQlyZXR1cm4gaW50ZXJuYWxEYXRhKCBlbGVtLCBuYW1lLCBkYXRhICk7CgkJfSwKCgkJcmVtb3ZlRGF0YTogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkJCXJldHVybiBpbnRlcm5hbFJlbW92ZURhdGEoIGVsZW0sIG5hbWUgKTsKCQl9LAoKCQkvLyBGb3IgaW50ZXJuYWwgdXNlIG9ubHkuCgkJX2RhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBkYXRhICkgewoJCQlyZXR1cm4gaW50ZXJuYWxEYXRhKCBlbGVtLCBuYW1lLCBkYXRhLCB0cnVlICk7CgkJfSwKCgkJX3JlbW92ZURhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQlyZXR1cm4gaW50ZXJuYWxSZW1vdmVEYXRhKCBlbGVtLCBuYW1lLCB0cnVlICk7CgkJfQoJfSk7CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJZGF0YTogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7CgkJCXZhciBpLCBuYW1lLCBkYXRhLAoJCQkJZWxlbSA9IHRoaXNbMF0sCgkJCQlhdHRycyA9IGVsZW0gJiYgZWxlbS5hdHRyaWJ1dGVzOwoKCQkJLy8gU3BlY2lhbCBleHBlY3Rpb25zIG9mIC5kYXRhIGJhc2ljYWxseSB0aHdhcnQgalF1ZXJ5LmFjY2VzcywKCQkJLy8gc28gaW1wbGVtZW50IHRoZSByZWxldmFudCBiZWhhdmlvciBvdXJzZWx2ZXMKCgkJCS8vIEdldHMgYWxsIHZhbHVlcwoJCQlpZiAoIGtleSA9PT0gdW5kZWZpbmVkICkgewoJCQkJaWYgKCB0aGlzLmxlbmd0aCApIHsKCQkJCQlkYXRhID0galF1ZXJ5LmRhdGEoIGVsZW0gKTsKCgkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICYmICFqUXVlcnkuX2RhdGEoIGVsZW0sICJwYXJzZWRBdHRycyIgKSApIHsKCQkJCQkJaSA9IGF0dHJzLmxlbmd0aDsKCQkJCQkJd2hpbGUgKCBpLS0gKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUUxMSsKCQkJCQkJCS8vIFRoZSBhdHRycyBlbGVtZW50cyBjYW4gYmUgbnVsbCAoIzE0ODk0KQoJCQkJCQkJaWYgKCBhdHRyc1sgaSBdICkgewoJCQkJCQkJCW5hbWUgPSBhdHRyc1sgaSBdLm5hbWU7CgkJCQkJCQkJaWYgKCBuYW1lLmluZGV4T2YoICJkYXRhLSIgKSA9PT0gMCApIHsKCQkJCQkJCQkJbmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUuc2xpY2UoNSkgKTsKCQkJCQkJCQkJZGF0YUF0dHIoIGVsZW0sIG5hbWUsIGRhdGFbIG5hbWUgXSApOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJwYXJzZWRBdHRycyIsIHRydWUgKTsKCQkJCQl9CgkJCQl9CgoJCQkJcmV0dXJuIGRhdGE7CgkJCX0KCgkJCS8vIFNldHMgbXVsdGlwbGUgdmFsdWVzCgkJCWlmICggdHlwZW9mIGtleSA9PT0gIm9iamVjdCIgKSB7CgkJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kYXRhKCB0aGlzLCBrZXkgKTsKCQkJCX0pOwoJCQl9CgoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDEgPwoKCQkJCS8vIFNldHMgb25lIHZhbHVlCgkJCQl0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5LmRhdGEoIHRoaXMsIGtleSwgdmFsdWUgKTsKCQkJCX0pIDoKCgkJCQkvLyBHZXRzIG9uZSB2YWx1ZQoJCQkJLy8gVHJ5IHRvIGZldGNoIGFueSBpbnRlcm5hbGx5IHN0b3JlZCBkYXRhIGZpcnN0CgkJCQllbGVtID8gZGF0YUF0dHIoIGVsZW0sIGtleSwgalF1ZXJ5LmRhdGEoIGVsZW0sIGtleSApICkgOiB1bmRlZmluZWQ7CgkJfSwKCgkJcmVtb3ZlRGF0YTogZnVuY3Rpb24oIGtleSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5yZW1vdmVEYXRhKCB0aGlzLCBrZXkgKTsKCQkJfSk7CgkJfQoJfSk7CgoKCWpRdWVyeS5leHRlbmQoewoJCXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSwgZGF0YSApIHsKCQkJdmFyIHF1ZXVlOwoKCQkJaWYgKCBlbGVtICkgewoJCQkJdHlwZSA9ICggdHlwZSB8fCAiZngiICkgKyAicXVldWUiOwoJCQkJcXVldWUgPSBqUXVlcnkuX2RhdGEoIGVsZW0sIHR5cGUgKTsKCgkJCQkvLyBTcGVlZCB1cCBkZXF1ZXVlIGJ5IGdldHRpbmcgb3V0IHF1aWNrbHkgaWYgdGhpcyBpcyBqdXN0IGEgbG9va3VwCgkJCQlpZiAoIGRhdGEgKSB7CgkJCQkJaWYgKCAhcXVldWUgfHwgalF1ZXJ5LmlzQXJyYXkoZGF0YSkgKSB7CgkJCQkJCXF1ZXVlID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCB0eXBlLCBqUXVlcnkubWFrZUFycmF5KGRhdGEpICk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJcXVldWUucHVzaCggZGF0YSApOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBxdWV1ZSB8fCBbXTsKCQkJfQoJCX0sCgoJCWRlcXVldWU6IGZ1bmN0aW9uKCBlbGVtLCB0eXBlICkgewoJCQl0eXBlID0gdHlwZSB8fCAiZngiOwoKCQkJdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCBlbGVtLCB0eXBlICksCgkJCQlzdGFydExlbmd0aCA9IHF1ZXVlLmxlbmd0aCwKCQkJCWZuID0gcXVldWUuc2hpZnQoKSwKCQkJCWhvb2tzID0galF1ZXJ5Ll9xdWV1ZUhvb2tzKCBlbGVtLCB0eXBlICksCgkJCQluZXh0ID0gZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5LmRlcXVldWUoIGVsZW0sIHR5cGUgKTsKCQkJCX07CgoJCQkvLyBJZiB0aGUgZnggcXVldWUgaXMgZGVxdWV1ZWQsIGFsd2F5cyByZW1vdmUgdGhlIHByb2dyZXNzIHNlbnRpbmVsCgkJCWlmICggZm4gPT09ICJpbnByb2dyZXNzIiApIHsKCQkJCWZuID0gcXVldWUuc2hpZnQoKTsKCQkJCXN0YXJ0TGVuZ3RoLS07CgkJCX0KCgkJCWlmICggZm4gKSB7CgoJCQkJLy8gQWRkIGEgcHJvZ3Jlc3Mgc2VudGluZWwgdG8gcHJldmVudCB0aGUgZnggcXVldWUgZnJvbSBiZWluZwoJCQkJLy8gYXV0b21hdGljYWxseSBkZXF1ZXVlZAoJCQkJaWYgKCB0eXBlID09PSAiZngiICkgewoJCQkJCXF1ZXVlLnVuc2hpZnQoICJpbnByb2dyZXNzIiApOwoJCQkJfQoKCQkJCS8vIGNsZWFyIHVwIHRoZSBsYXN0IHF1ZXVlIHN0b3AgZnVuY3Rpb24KCQkJCWRlbGV0ZSBob29rcy5zdG9wOwoJCQkJZm4uY2FsbCggZWxlbSwgbmV4dCwgaG9va3MgKTsKCQkJfQoKCQkJaWYgKCAhc3RhcnRMZW5ndGggJiYgaG9va3MgKSB7CgkJCQlob29rcy5lbXB0eS5maXJlKCk7CgkJCX0KCQl9LAoKCQkvLyBub3QgaW50ZW5kZWQgZm9yIHB1YmxpYyBjb25zdW1wdGlvbiAtIGdlbmVyYXRlcyBhIHF1ZXVlSG9va3Mgb2JqZWN0LCBvciByZXR1cm5zIHRoZSBjdXJyZW50IG9uZQoJCV9xdWV1ZUhvb2tzOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQkJdmFyIGtleSA9IHR5cGUgKyAicXVldWVIb29rcyI7CgkJCXJldHVybiBqUXVlcnkuX2RhdGEoIGVsZW0sIGtleSApIHx8IGpRdWVyeS5fZGF0YSggZWxlbSwga2V5LCB7CgkJCQllbXB0eTogalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKS5hZGQoZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBlbGVtLCB0eXBlICsgInF1ZXVlIiApOwoJCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZWxlbSwga2V5ICk7CgkJCQl9KQoJCQl9KTsKCQl9Cgl9KTsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQlxdWV1ZTogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7CgkJCXZhciBzZXR0ZXIgPSAyOwoKCQkJaWYgKCB0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIgKSB7CgkJCQlkYXRhID0gdHlwZTsKCQkJCXR5cGUgPSAiZngiOwoJCQkJc2V0dGVyLS07CgkJCX0KCgkJCWlmICggYXJndW1lbnRzLmxlbmd0aCA8IHNldHRlciApIHsKCQkJCXJldHVybiBqUXVlcnkucXVldWUoIHRoaXNbMF0sIHR5cGUgKTsKCQkJfQoKCQkJcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/CgkJCQl0aGlzIDoKCQkJCXRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCQl2YXIgcXVldWUgPSBqUXVlcnkucXVldWUoIHRoaXMsIHR5cGUsIGRhdGEgKTsKCgkJCQkJLy8gZW5zdXJlIGEgaG9va3MgZm9yIHRoaXMgcXVldWUKCQkJCQlqUXVlcnkuX3F1ZXVlSG9va3MoIHRoaXMsIHR5cGUgKTsKCgkJCQkJaWYgKCB0eXBlID09PSAiZngiICYmIHF1ZXVlWzBdICE9PSAiaW5wcm9ncmVzcyIgKSB7CgkJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQkJfQoJCQkJfSk7CgkJfSwKCQlkZXF1ZXVlOiBmdW5jdGlvbiggdHlwZSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCX0pOwoJCX0sCgkJY2xlYXJRdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJfSwKCQkvLyBHZXQgYSBwcm9taXNlIHJlc29sdmVkIHdoZW4gcXVldWVzIG9mIGEgY2VydGFpbiB0eXBlCgkJLy8gYXJlIGVtcHRpZWQgKGZ4IGlzIHRoZSB0eXBlIGJ5IGRlZmF1bHQpCgkJcHJvbWlzZTogZnVuY3Rpb24oIHR5cGUsIG9iaiApIHsKCQkJdmFyIHRtcCwKCQkJCWNvdW50ID0gMSwKCQkJCWRlZmVyID0galF1ZXJ5LkRlZmVycmVkKCksCgkJCQllbGVtZW50cyA9IHRoaXMsCgkJCQlpID0gdGhpcy5sZW5ndGgsCgkJCQlyZXNvbHZlID0gZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCAhKCAtLWNvdW50ICkgKSB7CgkJCQkJCWRlZmVyLnJlc29sdmVXaXRoKCBlbGVtZW50cywgWyBlbGVtZW50cyBdICk7CgkJCQkJfQoJCQkJfTsKCgkJCWlmICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJb2JqID0gdHlwZTsKCQkJCXR5cGUgPSB1bmRlZmluZWQ7CgkJCX0KCQkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJCXdoaWxlICggaS0tICkgewoJCQkJdG1wID0galF1ZXJ5Ll9kYXRhKCBlbGVtZW50c1sgaSBdLCB0eXBlICsgInF1ZXVlSG9va3MiICk7CgkJCQlpZiAoIHRtcCAmJiB0bXAuZW1wdHkgKSB7CgkJCQkJY291bnQrKzsKCQkJCQl0bXAuZW1wdHkuYWRkKCByZXNvbHZlICk7CgkJCQl9CgkJCX0KCQkJcmVzb2x2ZSgpOwoJCQlyZXR1cm4gZGVmZXIucHJvbWlzZSggb2JqICk7CgkJfQoJfSk7Cgl2YXIgcG51bSA9ICgvWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvKS5zb3VyY2U7CgoJdmFyIGNzc0V4cGFuZCA9IFsgIlRvcCIsICJSaWdodCIsICJCb3R0b20iLCAiTGVmdCIgXTsKCgl2YXIgaXNIaWRkZW4gPSBmdW5jdGlvbiggZWxlbSwgZWwgKSB7CgkJCS8vIGlzSGlkZGVuIG1pZ2h0IGJlIGNhbGxlZCBmcm9tIGpRdWVyeSNmaWx0ZXIgZnVuY3Rpb247CgkJCS8vIGluIHRoYXQgY2FzZSwgZWxlbWVudCB3aWxsIGJlIHNlY29uZCBhcmd1bWVudAoJCQllbGVtID0gZWwgfHwgZWxlbTsKCQkJcmV0dXJuIGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApID09PSAibm9uZSIgfHwgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7CgkJfTsKCgoKCS8vIE11bHRpZnVuY3Rpb25hbCBtZXRob2QgdG8gZ2V0IGFuZCBzZXQgdmFsdWVzIG9mIGEgY29sbGVjdGlvbgoJLy8gVGhlIHZhbHVlL3MgY2FuIG9wdGlvbmFsbHkgYmUgZXhlY3V0ZWQgaWYgaXQncyBhIGZ1bmN0aW9uCgl2YXIgYWNjZXNzID0galF1ZXJ5LmFjY2VzcyA9IGZ1bmN0aW9uKCBlbGVtcywgZm4sIGtleSwgdmFsdWUsIGNoYWluYWJsZSwgZW1wdHlHZXQsIHJhdyApIHsKCQl2YXIgaSA9IDAsCgkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aCwKCQkJYnVsayA9IGtleSA9PSBudWxsOwoKCQkvLyBTZXRzIG1hbnkgdmFsdWVzCgkJaWYgKCBqUXVlcnkudHlwZSgga2V5ICkgPT09ICJvYmplY3QiICkgewoJCQljaGFpbmFibGUgPSB0cnVlOwoJCQlmb3IgKCBpIGluIGtleSApIHsKCQkJCWpRdWVyeS5hY2Nlc3MoIGVsZW1zLCBmbiwgaSwga2V5W2ldLCB0cnVlLCBlbXB0eUdldCwgcmF3ICk7CgkJCX0KCgkJLy8gU2V0cyBvbmUgdmFsdWUKCQl9IGVsc2UgaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkgewoJCQljaGFpbmFibGUgPSB0cnVlOwoKCQkJaWYgKCAhalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7CgkJCQlyYXcgPSB0cnVlOwoJCQl9CgoJCQlpZiAoIGJ1bGsgKSB7CgkJCQkvLyBCdWxrIG9wZXJhdGlvbnMgcnVuIGFnYWluc3QgdGhlIGVudGlyZSBzZXQKCQkJCWlmICggcmF3ICkgewoJCQkJCWZuLmNhbGwoIGVsZW1zLCB2YWx1ZSApOwoJCQkJCWZuID0gbnVsbDsKCgkJCQkvLyAuLi5leGNlcHQgd2hlbiBleGVjdXRpbmcgZnVuY3Rpb24gdmFsdWVzCgkJCQl9IGVsc2UgewoJCQkJCWJ1bGsgPSBmbjsKCQkJCQlmbiA9IGZ1bmN0aW9uKCBlbGVtLCBrZXksIHZhbHVlICkgewoJCQkJCQlyZXR1cm4gYnVsay5jYWxsKCBqUXVlcnkoIGVsZW0gKSwgdmFsdWUgKTsKCQkJCQl9OwoJCQkJfQoJCQl9CgoJCQlpZiAoIGZuICkgewoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJZm4oIGVsZW1zW2ldLCBrZXksIHJhdyA/IHZhbHVlIDogdmFsdWUuY2FsbCggZWxlbXNbaV0sIGksIGZuKCBlbGVtc1tpXSwga2V5ICkgKSApOwoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gY2hhaW5hYmxlID8KCQkJZWxlbXMgOgoKCQkJLy8gR2V0cwoJCQlidWxrID8KCQkJCWZuLmNhbGwoIGVsZW1zICkgOgoJCQkJbGVuZ3RoID8gZm4oIGVsZW1zWzBdLCBrZXkgKSA6IGVtcHR5R2V0OwoJfTsKCXZhciByY2hlY2thYmxlVHlwZSA9ICgvXig/OmNoZWNrYm94fHJhZGlvKSQvaSk7CgoKCgkoZnVuY3Rpb24oKSB7CgkJLy8gTWluaWZpZWQ6IHZhciBhLGIsYwoJCXZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKSwKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQkJZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CgoJCS8vIFNldHVwCgkJZGl2LmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iOwoKCQkvLyBJRSBzdHJpcHMgbGVhZGluZyB3aGl0ZXNwYWNlIHdoZW4gLmlubmVySFRNTCBpcyB1c2VkCgkJc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZSA9IGRpdi5maXJzdENoaWxkLm5vZGVUeXBlID09PSAzOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCB0Ym9keSBlbGVtZW50cyBhcmVuJ3QgYXV0b21hdGljYWxseSBpbnNlcnRlZAoJCS8vIElFIHdpbGwgaW5zZXJ0IHRoZW0gaW50byBlbXB0eSB0YWJsZXMKCQlzdXBwb3J0LnRib2R5ID0gIWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSggInRib2R5IiApLmxlbmd0aDsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgbGluayBlbGVtZW50cyBnZXQgc2VyaWFsaXplZCBjb3JyZWN0bHkgYnkgaW5uZXJIVE1MCgkJLy8gVGhpcyByZXF1aXJlcyBhIHdyYXBwZXIgZWxlbWVudCBpbiBJRQoJCXN1cHBvcnQuaHRtbFNlcmlhbGl6ZSA9ICEhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAibGluayIgKS5sZW5ndGg7CgoJCS8vIE1ha2VzIHN1cmUgY2xvbmluZyBhbiBodG1sNSBlbGVtZW50IGRvZXMgbm90IGNhdXNlIHByb2JsZW1zCgkJLy8gV2hlcmUgb3V0ZXJIVE1MIGlzIHVuZGVmaW5lZCwgdGhpcyBzdGlsbCB3b3JrcwoJCXN1cHBvcnQuaHRtbDVDbG9uZSA9CgkJCWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJuYXYiICkuY2xvbmVOb2RlKCB0cnVlICkub3V0ZXJIVE1MICE9PSAiPDpuYXY+PC86bmF2PiI7CgoJCS8vIENoZWNrIGlmIGEgZGlzY29ubmVjdGVkIGNoZWNrYm94IHdpbGwgcmV0YWluIGl0cyBjaGVja2VkCgkJLy8gdmFsdWUgb2YgdHJ1ZSBhZnRlciBhcHBlbmRlZCB0byB0aGUgRE9NIChJRTYvNykKCQlpbnB1dC50eXBlID0gImNoZWNrYm94IjsKCQlpbnB1dC5jaGVja2VkID0gdHJ1ZTsKCQlmcmFnbWVudC5hcHBlbmRDaGlsZCggaW5wdXQgKTsKCQlzdXBwb3J0LmFwcGVuZENoZWNrZWQgPSBpbnB1dC5jaGVja2VkOwoKCQkvLyBNYWtlIHN1cmUgdGV4dGFyZWEgKGFuZCBjaGVja2JveCkgZGVmYXVsdFZhbHVlIGlzIHByb3Blcmx5IGNsb25lZAoJCS8vIFN1cHBvcnQ6IElFNi1JRTExKwoJCWRpdi5pbm5lckhUTUwgPSAiPHRleHRhcmVhPng8L3RleHRhcmVhPiI7CgkJc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCA9ICEhZGl2LmNsb25lTm9kZSggdHJ1ZSApLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWU7CgoJCS8vICMxMTIxNyAtIFdlYktpdCBsb3NlcyBjaGVjayB3aGVuIHRoZSBuYW1lIGlzIGFmdGVyIHRoZSBjaGVja2VkIGF0dHJpYnV0ZQoJCWZyYWdtZW50LmFwcGVuZENoaWxkKCBkaXYgKTsKCQlkaXYuaW5uZXJIVE1MID0gIjxpbnB1dCB0eXBlPSdyYWRpbycgY2hlY2tlZD0nY2hlY2tlZCcgbmFtZT0ndCcvPiI7CgoJCS8vIFN1cHBvcnQ6IFNhZmFyaSA1LjEsIGlPUyA1LjEsIEFuZHJvaWQgNC54LCBBbmRyb2lkIDIuMwoJCS8vIG9sZCBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHMKCQlzdXBwb3J0LmNoZWNrQ2xvbmUgPSBkaXYuY2xvbmVOb2RlKCB0cnVlICkuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmNoZWNrZWQ7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQkvLyBPcGVyYSBkb2VzIG5vdCBjbG9uZSBldmVudHMgKGFuZCB0eXBlb2YgZGl2LmF0dGFjaEV2ZW50ID09PSB1bmRlZmluZWQpLgoJCS8vIElFOS0xMCBjbG9uZXMgZXZlbnRzIGJvdW5kIHZpYSBhdHRhY2hFdmVudCwgYnV0IHRoZXkgZG9uJ3QgdHJpZ2dlciB3aXRoIC5jbGljaygpCgkJc3VwcG9ydC5ub0Nsb25lRXZlbnQgPSB0cnVlOwoJCWlmICggZGl2LmF0dGFjaEV2ZW50ICkgewoJCQlkaXYuYXR0YWNoRXZlbnQoICJvbmNsaWNrIiwgZnVuY3Rpb24oKSB7CgkJCQlzdXBwb3J0Lm5vQ2xvbmVFdmVudCA9IGZhbHNlOwoJCQl9KTsKCgkJCWRpdi5jbG9uZU5vZGUoIHRydWUgKS5jbGljaygpOwoJCX0KCgkJLy8gRXhlY3V0ZSB0aGUgdGVzdCBvbmx5IGlmIG5vdCBhbHJlYWR5IGV4ZWN1dGVkIGluIGFub3RoZXIgbW9kdWxlLgoJCWlmIChzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPT0gbnVsbCkgewoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCXN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9IHRydWU7CgkJCXRyeSB7CgkJCQlkZWxldGUgZGl2LnRlc3Q7CgkJCX0gY2F0Y2goIGUgKSB7CgkJCQlzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPSBmYWxzZTsKCQkJfQoJCX0KCX0pKCk7CgoKCShmdW5jdGlvbigpIHsKCQl2YXIgaSwgZXZlbnROYW1lLAoJCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoKCQkvLyBTdXBwb3J0OiBJRTw5IChsYWNrIHN1Ym1pdC9jaGFuZ2UgYnViYmxlKSwgRmlyZWZveCAyMysgKGxhY2sgZm9jdXNpbiBldmVudCkKCQlmb3IgKCBpIGluIHsgc3VibWl0OiB0cnVlLCBjaGFuZ2U6IHRydWUsIGZvY3VzaW46IHRydWUgfSkgewoJCQlldmVudE5hbWUgPSAib24iICsgaTsKCgkJCWlmICggIShzdXBwb3J0WyBpICsgIkJ1YmJsZXMiIF0gPSBldmVudE5hbWUgaW4gd2luZG93KSApIHsKCQkJCS8vIEJld2FyZSBvZiBDU1AgcmVzdHJpY3Rpb25zIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9TZWN1cml0eS9DU1ApCgkJCQlkaXYuc2V0QXR0cmlidXRlKCBldmVudE5hbWUsICJ0IiApOwoJCQkJc3VwcG9ydFsgaSArICJCdWJibGVzIiBdID0gZGl2LmF0dHJpYnV0ZXNbIGV2ZW50TmFtZSBdLmV4cGFuZG8gPT09IGZhbHNlOwoJCQl9CgkJfQoKCQkvLyBOdWxsIGVsZW1lbnRzIHRvIGF2b2lkIGxlYWtzIGluIElFLgoJCWRpdiA9IG51bGw7Cgl9KSgpOwoKCgl2YXIgcmZvcm1FbGVtcyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhKSQvaSwKCQlya2V5RXZlbnQgPSAvXmtleS8sCgkJcm1vdXNlRXZlbnQgPSAvXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnUpfGNsaWNrLywKCQlyZm9jdXNNb3JwaCA9IC9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLywKCQlydHlwZW5hbWVzcGFjZSA9IC9eKFteLl0qKSg/OlwuKC4rKXwpJC87CgoJZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpIHsKCQlyZXR1cm4gdHJ1ZTsKCX0KCglmdW5jdGlvbiByZXR1cm5GYWxzZSgpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9CgoJZnVuY3Rpb24gc2FmZUFjdGl2ZUVsZW1lbnQoKSB7CgkJdHJ5IHsKCQkJcmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CgkJfSBjYXRjaCAoIGVyciApIHsgfQoJfQoKCS8qCgkgKiBIZWxwZXIgZnVuY3Rpb25zIGZvciBtYW5hZ2luZyBldmVudHMgLS0gbm90IHBhcnQgb2YgdGhlIHB1YmxpYyBpbnRlcmZhY2UuCgkgKiBQcm9wcyB0byBEZWFuIEVkd2FyZHMnIGFkZEV2ZW50IGxpYnJhcnkgZm9yIG1hbnkgb2YgdGhlIGlkZWFzLgoJICovCglqUXVlcnkuZXZlbnQgPSB7CgoJCWdsb2JhbDoge30sCgoJCWFkZDogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBkYXRhLCBzZWxlY3RvciApIHsKCQkJdmFyIHRtcCwgZXZlbnRzLCB0LCBoYW5kbGVPYmpJbiwKCQkJCXNwZWNpYWwsIGV2ZW50SGFuZGxlLCBoYW5kbGVPYmosCgkJCQloYW5kbGVycywgdHlwZSwgbmFtZXNwYWNlcywgb3JpZ1R5cGUsCgkJCQllbGVtRGF0YSA9IGpRdWVyeS5fZGF0YSggZWxlbSApOwoKCQkJLy8gRG9uJ3QgYXR0YWNoIGV2ZW50cyB0byBub0RhdGEgb3IgdGV4dC9jb21tZW50IG5vZGVzIChidXQgYWxsb3cgcGxhaW4gb2JqZWN0cykKCQkJaWYgKCAhZWxlbURhdGEgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFuZGxlcgoJCQlpZiAoIGhhbmRsZXIuaGFuZGxlciApIHsKCQkJCWhhbmRsZU9iakluID0gaGFuZGxlcjsKCQkJCWhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyOwoJCQkJc2VsZWN0b3IgPSBoYW5kbGVPYmpJbi5zZWxlY3RvcjsKCQkJfQoKCQkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIGhhbmRsZXIgaGFzIGEgdW5pcXVlIElELCB1c2VkIHRvIGZpbmQvcmVtb3ZlIGl0IGxhdGVyCgkJCWlmICggIWhhbmRsZXIuZ3VpZCApIHsKCQkJCWhhbmRsZXIuZ3VpZCA9IGpRdWVyeS5ndWlkKys7CgkJCX0KCgkJCS8vIEluaXQgdGhlIGVsZW1lbnQncyBldmVudCBzdHJ1Y3R1cmUgYW5kIG1haW4gaGFuZGxlciwgaWYgdGhpcyBpcyB0aGUgZmlyc3QKCQkJaWYgKCAhKGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cykgKSB7CgkJCQlldmVudHMgPSBlbGVtRGF0YS5ldmVudHMgPSB7fTsKCQkJfQoJCQlpZiAoICEoZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUpICkgewoJCQkJZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUgPSBmdW5jdGlvbiggZSApIHsKCQkJCQkvLyBEaXNjYXJkIHRoZSBzZWNvbmQgZXZlbnQgb2YgYSBqUXVlcnkuZXZlbnQudHJpZ2dlcigpIGFuZAoJCQkJCS8vIHdoZW4gYW4gZXZlbnQgaXMgY2FsbGVkIGFmdGVyIGEgcGFnZSBoYXMgdW5sb2FkZWQKCQkJCQlyZXR1cm4gdHlwZW9mIGpRdWVyeSAhPT0gc3RydW5kZWZpbmVkICYmICghZSB8fCBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICE9PSBlLnR5cGUpID8KCQkJCQkJalF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmFwcGx5KCBldmVudEhhbmRsZS5lbGVtLCBhcmd1bWVudHMgKSA6CgkJCQkJCXVuZGVmaW5lZDsKCQkJCX07CgkJCQkvLyBBZGQgZWxlbSBhcyBhIHByb3BlcnR5IG9mIHRoZSBoYW5kbGUgZm4gdG8gcHJldmVudCBhIG1lbW9yeSBsZWFrIHdpdGggSUUgbm9uLW5hdGl2ZSBldmVudHMKCQkJCWV2ZW50SGFuZGxlLmVsZW0gPSBlbGVtOwoJCQl9CgoJCQkvLyBIYW5kbGUgbXVsdGlwbGUgZXZlbnRzIHNlcGFyYXRlZCBieSBhIHNwYWNlCgkJCXR5cGVzID0gKCB0eXBlcyB8fCAiIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbICIiIF07CgkJCXQgPSB0eXBlcy5sZW5ndGg7CgkJCXdoaWxlICggdC0tICkgewoJCQkJdG1wID0gcnR5cGVuYW1lc3BhY2UuZXhlYyggdHlwZXNbdF0gKSB8fCBbXTsKCQkJCXR5cGUgPSBvcmlnVHlwZSA9IHRtcFsxXTsKCQkJCW5hbWVzcGFjZXMgPSAoIHRtcFsyXSB8fCAiIiApLnNwbGl0KCAiLiIgKS5zb3J0KCk7CgoJCQkJLy8gVGhlcmUgKm11c3QqIGJlIGEgdHlwZSwgbm8gYXR0YWNoaW5nIG5hbWVzcGFjZS1vbmx5IGhhbmRsZXJzCgkJCQlpZiAoICF0eXBlICkgewoJCQkJCWNvbnRpbnVlOwoJCQkJfQoKCQkJCS8vIElmIGV2ZW50IGNoYW5nZXMgaXRzIHR5cGUsIHVzZSB0aGUgc3BlY2lhbCBldmVudCBoYW5kbGVycyBmb3IgdGhlIGNoYW5nZWQgdHlwZQoJCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgoJCQkJLy8gSWYgc2VsZWN0b3IgZGVmaW5lZCwgZGV0ZXJtaW5lIHNwZWNpYWwgZXZlbnQgYXBpIHR5cGUsIG90aGVyd2lzZSBnaXZlbiB0eXBlCgkJCQl0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7CgoJCQkJLy8gVXBkYXRlIHNwZWNpYWwgYmFzZWQgb24gbmV3bHkgcmVzZXQgdHlwZQoJCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgoJCQkJLy8gaGFuZGxlT2JqIGlzIHBhc3NlZCB0byBhbGwgZXZlbnQgaGFuZGxlcnMKCQkJCWhhbmRsZU9iaiA9IGpRdWVyeS5leHRlbmQoewoJCQkJCXR5cGU6IHR5cGUsCgkJCQkJb3JpZ1R5cGU6IG9yaWdUeXBlLAoJCQkJCWRhdGE6IGRhdGEsCgkJCQkJaGFuZGxlcjogaGFuZGxlciwKCQkJCQlndWlkOiBoYW5kbGVyLmd1aWQsCgkJCQkJc2VsZWN0b3I6IHNlbGVjdG9yLAoJCQkJCW5lZWRzQ29udGV4dDogc2VsZWN0b3IgJiYgalF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICksCgkJCQkJbmFtZXNwYWNlOiBuYW1lc3BhY2VzLmpvaW4oIi4iKQoJCQkJfSwgaGFuZGxlT2JqSW4gKTsKCgkJCQkvLyBJbml0IHRoZSBldmVudCBoYW5kbGVyIHF1ZXVlIGlmIHdlJ3JlIHRoZSBmaXJzdAoJCQkJaWYgKCAhKGhhbmRsZXJzID0gZXZlbnRzWyB0eXBlIF0pICkgewoJCQkJCWhhbmRsZXJzID0gZXZlbnRzWyB0eXBlIF0gPSBbXTsKCQkJCQloYW5kbGVycy5kZWxlZ2F0ZUNvdW50ID0gMDsKCgkJCQkJLy8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lci9hdHRhY2hFdmVudCBpZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlCgkJCQkJaWYgKCAhc3BlY2lhbC5zZXR1cCB8fCBzcGVjaWFsLnNldHVwLmNhbGwoIGVsZW0sIGRhdGEsIG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlICkgPT09IGZhbHNlICkgewoJCQkJCQkvLyBCaW5kIHRoZSBnbG9iYWwgZXZlbnQgaGFuZGxlciB0byB0aGUgZWxlbWVudAoJCQkJCQlpZiAoIGVsZW0uYWRkRXZlbnRMaXN0ZW5lciApIHsKCQkJCQkJCWVsZW0uYWRkRXZlbnRMaXN0ZW5lciggdHlwZSwgZXZlbnRIYW5kbGUsIGZhbHNlICk7CgoJCQkJCQl9IGVsc2UgaWYgKCBlbGVtLmF0dGFjaEV2ZW50ICkgewoJCQkJCQkJZWxlbS5hdHRhY2hFdmVudCggIm9uIiArIHR5cGUsIGV2ZW50SGFuZGxlICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJaWYgKCBzcGVjaWFsLmFkZCApIHsKCQkJCQlzcGVjaWFsLmFkZC5jYWxsKCBlbGVtLCBoYW5kbGVPYmogKTsKCgkJCQkJaWYgKCAhaGFuZGxlT2JqLmhhbmRsZXIuZ3VpZCApIHsKCQkJCQkJaGFuZGxlT2JqLmhhbmRsZXIuZ3VpZCA9IGhhbmRsZXIuZ3VpZDsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gQWRkIHRvIHRoZSBlbGVtZW50J3MgaGFuZGxlciBsaXN0LCBkZWxlZ2F0ZXMgaW4gZnJvbnQKCQkJCWlmICggc2VsZWN0b3IgKSB7CgkJCQkJaGFuZGxlcnMuc3BsaWNlKCBoYW5kbGVycy5kZWxlZ2F0ZUNvdW50KyssIDAsIGhhbmRsZU9iaiApOwoJCQkJfSBlbHNlIHsKCQkJCQloYW5kbGVycy5wdXNoKCBoYW5kbGVPYmogKTsKCQkJCX0KCgkJCQkvLyBLZWVwIHRyYWNrIG9mIHdoaWNoIGV2ZW50cyBoYXZlIGV2ZXIgYmVlbiB1c2VkLCBmb3IgZXZlbnQgb3B0aW1pemF0aW9uCgkJCQlqUXVlcnkuZXZlbnQuZ2xvYmFsWyB0eXBlIF0gPSB0cnVlOwoJCQl9CgoJCQkvLyBOdWxsaWZ5IGVsZW0gdG8gcHJldmVudCBtZW1vcnkgbGVha3MgaW4gSUUKCQkJZWxlbSA9IG51bGw7CgkJfSwKCgkJLy8gRGV0YWNoIGFuIGV2ZW50IG9yIHNldCBvZiBldmVudHMgZnJvbSBhbiBlbGVtZW50CgkJcmVtb3ZlOiBmdW5jdGlvbiggZWxlbSwgdHlwZXMsIGhhbmRsZXIsIHNlbGVjdG9yLCBtYXBwZWRUeXBlcyApIHsKCQkJdmFyIGosIGhhbmRsZU9iaiwgdG1wLAoJCQkJb3JpZ0NvdW50LCB0LCBldmVudHMsCgkJCQlzcGVjaWFsLCBoYW5kbGVycywgdHlwZSwKCQkJCW5hbWVzcGFjZXMsIG9yaWdUeXBlLAoJCQkJZWxlbURhdGEgPSBqUXVlcnkuaGFzRGF0YSggZWxlbSApICYmIGpRdWVyeS5fZGF0YSggZWxlbSApOwoKCQkJaWYgKCAhZWxlbURhdGEgfHwgIShldmVudHMgPSBlbGVtRGF0YS5ldmVudHMpICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBPbmNlIGZvciBlYWNoIHR5cGUubmFtZXNwYWNlIGluIHR5cGVzOyB0eXBlIG1heSBiZSBvbWl0dGVkCgkJCXR5cGVzID0gKCB0eXBlcyB8fCAiIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbICIiIF07CgkJCXQgPSB0eXBlcy5sZW5ndGg7CgkJCXdoaWxlICggdC0tICkgewoJCQkJdG1wID0gcnR5cGVuYW1lc3BhY2UuZXhlYyggdHlwZXNbdF0gKSB8fCBbXTsKCQkJCXR5cGUgPSBvcmlnVHlwZSA9IHRtcFsxXTsKCQkJCW5hbWVzcGFjZXMgPSAoIHRtcFsyXSB8fCAiIiApLnNwbGl0KCAiLiIgKS5zb3J0KCk7CgoJCQkJLy8gVW5iaW5kIGFsbCBldmVudHMgKG9uIHRoaXMgbmFtZXNwYWNlLCBpZiBwcm92aWRlZCkgZm9yIHRoZSBlbGVtZW50CgkJCQlpZiAoICF0eXBlICkgewoJCQkJCWZvciAoIHR5cGUgaW4gZXZlbnRzICkgewoJCQkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICsgdHlwZXNbIHQgXSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUgKTsKCQkJCQl9CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCQl0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7CgkJCQloYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdIHx8IFtdOwoJCQkJdG1wID0gdG1wWzJdICYmIG5ldyBSZWdFeHAoICIoXnxcXC4pIiArIG5hbWVzcGFjZXMuam9pbigiXFwuKD86LipcXC58KSIpICsgIihcXC58JCkiICk7CgoJCQkJLy8gUmVtb3ZlIG1hdGNoaW5nIGV2ZW50cwoJCQkJb3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDsKCQkJCXdoaWxlICggai0tICkgewoJCQkJCWhhbmRsZU9iaiA9IGhhbmRsZXJzWyBqIF07CgoJCQkJCWlmICggKCBtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlICkgJiYKCQkJCQkJKCAhaGFuZGxlciB8fCBoYW5kbGVyLmd1aWQgPT09IGhhbmRsZU9iai5ndWlkICkgJiYKCQkJCQkJKCAhdG1wIHx8IHRtcC50ZXN0KCBoYW5kbGVPYmoubmFtZXNwYWNlICkgKSAmJgoJCQkJCQkoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8IHNlbGVjdG9yID09PSAiKioiICYmIGhhbmRsZU9iai5zZWxlY3RvciApICkgewoJCQkJCQloYW5kbGVycy5zcGxpY2UoIGosIDEgKTsKCgkJCQkJCWlmICggaGFuZGxlT2JqLnNlbGVjdG9yICkgewoJCQkJCQkJaGFuZGxlcnMuZGVsZWdhdGVDb3VudC0tOwoJCQkJCQl9CgkJCQkJCWlmICggc3BlY2lhbC5yZW1vdmUgKSB7CgkJCQkJCQlzcGVjaWFsLnJlbW92ZS5jYWxsKCBlbGVtLCBoYW5kbGVPYmogKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBSZW1vdmUgZ2VuZXJpYyBldmVudCBoYW5kbGVyIGlmIHdlIHJlbW92ZWQgc29tZXRoaW5nIGFuZCBubyBtb3JlIGhhbmRsZXJzIGV4aXN0CgkJCQkvLyAoYXZvaWRzIHBvdGVudGlhbCBmb3IgZW5kbGVzcyByZWN1cnNpb24gZHVyaW5nIHJlbW92YWwgb2Ygc3BlY2lhbCBldmVudCBoYW5kbGVycykKCQkJCWlmICggb3JpZ0NvdW50ICYmICFoYW5kbGVycy5sZW5ndGggKSB7CgkJCQkJaWYgKCAhc3BlY2lhbC50ZWFyZG93biB8fCBzcGVjaWFsLnRlYXJkb3duLmNhbGwoIGVsZW0sIG5hbWVzcGFjZXMsIGVsZW1EYXRhLmhhbmRsZSApID09PSBmYWxzZSApIHsKCQkJCQkJalF1ZXJ5LnJlbW92ZUV2ZW50KCBlbGVtLCB0eXBlLCBlbGVtRGF0YS5oYW5kbGUgKTsKCQkJCQl9CgoJCQkJCWRlbGV0ZSBldmVudHNbIHR5cGUgXTsKCQkJCX0KCQkJfQoKCQkJLy8gUmVtb3ZlIHRoZSBleHBhbmRvIGlmIGl0J3Mgbm8gbG9uZ2VyIHVzZWQKCQkJaWYgKCBqUXVlcnkuaXNFbXB0eU9iamVjdCggZXZlbnRzICkgKSB7CgkJCQlkZWxldGUgZWxlbURhdGEuaGFuZGxlOwoKCQkJCS8vIHJlbW92ZURhdGEgYWxzbyBjaGVja3MgZm9yIGVtcHRpbmVzcyBhbmQgY2xlYXJzIHRoZSBleHBhbmRvIGlmIGVtcHR5CgkJCQkvLyBzbyB1c2UgaXQgaW5zdGVhZCBvZiBkZWxldGUKCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZWxlbSwgImV2ZW50cyIgKTsKCQkJfQoJCX0sCgoJCXRyaWdnZXI6IGZ1bmN0aW9uKCBldmVudCwgZGF0YSwgZWxlbSwgb25seUhhbmRsZXJzICkgewoJCQl2YXIgaGFuZGxlLCBvbnR5cGUsIGN1ciwKCQkJCWJ1YmJsZVR5cGUsIHNwZWNpYWwsIHRtcCwgaSwKCQkJCWV2ZW50UGF0aCA9IFsgZWxlbSB8fCBkb2N1bWVudCBdLAoJCQkJdHlwZSA9IGhhc093bi5jYWxsKCBldmVudCwgInR5cGUiICkgPyBldmVudC50eXBlIDogZXZlbnQsCgkJCQluYW1lc3BhY2VzID0gaGFzT3duLmNhbGwoIGV2ZW50LCAibmFtZXNwYWNlIiApID8gZXZlbnQubmFtZXNwYWNlLnNwbGl0KCIuIikgOiBbXTsKCgkJCWN1ciA9IHRtcCA9IGVsZW0gPSBlbGVtIHx8IGRvY3VtZW50OwoKCQkJLy8gRG9uJ3QgZG8gZXZlbnRzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIGZvY3VzL2JsdXIgbW9ycGhzIHRvIGZvY3VzaW4vb3V0OyBlbnN1cmUgd2UncmUgbm90IGZpcmluZyB0aGVtIHJpZ2h0IG5vdwoJCQlpZiAoIHJmb2N1c01vcnBoLnRlc3QoIHR5cGUgKyBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICkgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmICggdHlwZS5pbmRleE9mKCIuIikgPj0gMCApIHsKCQkJCS8vIE5hbWVzcGFjZWQgdHJpZ2dlcjsgY3JlYXRlIGEgcmVnZXhwIHRvIG1hdGNoIGV2ZW50IHR5cGUgaW4gaGFuZGxlKCkKCQkJCW5hbWVzcGFjZXMgPSB0eXBlLnNwbGl0KCIuIik7CgkJCQl0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgpOwoJCQkJbmFtZXNwYWNlcy5zb3J0KCk7CgkJCX0KCQkJb250eXBlID0gdHlwZS5pbmRleE9mKCI6IikgPCAwICYmICJvbiIgKyB0eXBlOwoKCQkJLy8gQ2FsbGVyIGNhbiBwYXNzIGluIGEgalF1ZXJ5LkV2ZW50IG9iamVjdCwgT2JqZWN0LCBvciBqdXN0IGFuIGV2ZW50IHR5cGUgc3RyaW5nCgkJCWV2ZW50ID0gZXZlbnRbIGpRdWVyeS5leHBhbmRvIF0gPwoJCQkJZXZlbnQgOgoJCQkJbmV3IGpRdWVyeS5FdmVudCggdHlwZSwgdHlwZW9mIGV2ZW50ID09PSAib2JqZWN0IiAmJiBldmVudCApOwoKCQkJLy8gVHJpZ2dlciBiaXRtYXNrOiAmIDEgZm9yIG5hdGl2ZSBoYW5kbGVyczsgJiAyIGZvciBqUXVlcnkgKGFsd2F5cyB0cnVlKQoJCQlldmVudC5pc1RyaWdnZXIgPSBvbmx5SGFuZGxlcnMgPyAyIDogMzsKCQkJZXZlbnQubmFtZXNwYWNlID0gbmFtZXNwYWNlcy5qb2luKCIuIik7CgkJCWV2ZW50Lm5hbWVzcGFjZV9yZSA9IGV2ZW50Lm5hbWVzcGFjZSA/CgkJCQluZXcgUmVnRXhwKCAiKF58XFwuKSIgKyBuYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSArICIoXFwufCQpIiApIDoKCQkJCW51bGw7CgoJCQkvLyBDbGVhbiB1cCB0aGUgZXZlbnQgaW4gY2FzZSBpdCBpcyBiZWluZyByZXVzZWQKCQkJZXZlbnQucmVzdWx0ID0gdW5kZWZpbmVkOwoJCQlpZiAoICFldmVudC50YXJnZXQgKSB7CgkJCQlldmVudC50YXJnZXQgPSBlbGVtOwoJCQl9CgoJCQkvLyBDbG9uZSBhbnkgaW5jb21pbmcgZGF0YSBhbmQgcHJlcGVuZCB0aGUgZXZlbnQsIGNyZWF0aW5nIHRoZSBoYW5kbGVyIGFyZyBsaXN0CgkJCWRhdGEgPSBkYXRhID09IG51bGwgPwoJCQkJWyBldmVudCBdIDoKCQkJCWpRdWVyeS5tYWtlQXJyYXkoIGRhdGEsIFsgZXZlbnQgXSApOwoKCQkJLy8gQWxsb3cgc3BlY2lhbCBldmVudHMgdG8gZHJhdyBvdXRzaWRlIHRoZSBsaW5lcwoJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTsKCQkJaWYgKCAhb25seUhhbmRsZXJzICYmIHNwZWNpYWwudHJpZ2dlciAmJiBzcGVjaWFsLnRyaWdnZXIuYXBwbHkoIGVsZW0sIGRhdGEgKSA9PT0gZmFsc2UgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIERldGVybWluZSBldmVudCBwcm9wYWdhdGlvbiBwYXRoIGluIGFkdmFuY2UsIHBlciBXM0MgZXZlbnRzIHNwZWMgKCM5OTUxKQoJCQkvLyBCdWJibGUgdXAgdG8gZG9jdW1lbnQsIHRoZW4gdG8gd2luZG93OyB3YXRjaCBmb3IgYSBnbG9iYWwgb3duZXJEb2N1bWVudCB2YXIgKCM5NzI0KQoJCQlpZiAoICFvbmx5SGFuZGxlcnMgJiYgIXNwZWNpYWwubm9CdWJibGUgJiYgIWpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkgewoKCQkJCWJ1YmJsZVR5cGUgPSBzcGVjaWFsLmRlbGVnYXRlVHlwZSB8fCB0eXBlOwoJCQkJaWYgKCAhcmZvY3VzTW9ycGgudGVzdCggYnViYmxlVHlwZSArIHR5cGUgKSApIHsKCQkJCQljdXIgPSBjdXIucGFyZW50Tm9kZTsKCQkJCX0KCQkJCWZvciAoIDsgY3VyOyBjdXIgPSBjdXIucGFyZW50Tm9kZSApIHsKCQkJCQlldmVudFBhdGgucHVzaCggY3VyICk7CgkJCQkJdG1wID0gY3VyOwoJCQkJfQoKCQkJCS8vIE9ubHkgYWRkIHdpbmRvdyBpZiB3ZSBnb3QgdG8gZG9jdW1lbnQgKGUuZy4sIG5vdCBwbGFpbiBvYmogb3IgZGV0YWNoZWQgRE9NKQoJCQkJaWYgKCB0bXAgPT09IChlbGVtLm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQpICkgewoJCQkJCWV2ZW50UGF0aC5wdXNoKCB0bXAuZGVmYXVsdFZpZXcgfHwgdG1wLnBhcmVudFdpbmRvdyB8fCB3aW5kb3cgKTsKCQkJCX0KCQkJfQoKCQkJLy8gRmlyZSBoYW5kbGVycyBvbiB0aGUgZXZlbnQgcGF0aAoJCQlpID0gMDsKCQkJd2hpbGUgKCAoY3VyID0gZXZlbnRQYXRoW2krK10pICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkgewoKCQkJCWV2ZW50LnR5cGUgPSBpID4gMSA/CgkJCQkJYnViYmxlVHlwZSA6CgkJCQkJc3BlY2lhbC5iaW5kVHlwZSB8fCB0eXBlOwoKCQkJCS8vIGpRdWVyeSBoYW5kbGVyCgkJCQloYW5kbGUgPSAoIGpRdWVyeS5fZGF0YSggY3VyLCAiZXZlbnRzIiApIHx8IHt9IClbIGV2ZW50LnR5cGUgXSAmJiBqUXVlcnkuX2RhdGEoIGN1ciwgImhhbmRsZSIgKTsKCQkJCWlmICggaGFuZGxlICkgewoJCQkJCWhhbmRsZS5hcHBseSggY3VyLCBkYXRhICk7CgkJCQl9CgoJCQkJLy8gTmF0aXZlIGhhbmRsZXIKCQkJCWhhbmRsZSA9IG9udHlwZSAmJiBjdXJbIG9udHlwZSBdOwoJCQkJaWYgKCBoYW5kbGUgJiYgaGFuZGxlLmFwcGx5ICYmIGpRdWVyeS5hY2NlcHREYXRhKCBjdXIgKSApIHsKCQkJCQlldmVudC5yZXN1bHQgPSBoYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJCWlmICggZXZlbnQucmVzdWx0ID09PSBmYWxzZSApIHsKCQkJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJZXZlbnQudHlwZSA9IHR5cGU7CgoJCQkvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93CgkJCWlmICggIW9ubHlIYW5kbGVycyAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgoJCQkJaWYgKCAoIXNwZWNpYWwuX2RlZmF1bHQgfHwgc3BlY2lhbC5fZGVmYXVsdC5hcHBseSggZXZlbnRQYXRoLnBvcCgpLCBkYXRhICkgPT09IGZhbHNlKSAmJgoJCQkJCWpRdWVyeS5hY2NlcHREYXRhKCBlbGVtICkgKSB7CgoJCQkJCS8vIENhbGwgYSBuYXRpdmUgRE9NIG1ldGhvZCBvbiB0aGUgdGFyZ2V0IHdpdGggdGhlIHNhbWUgbmFtZSBuYW1lIGFzIHRoZSBldmVudC4KCQkJCQkvLyBDYW4ndCB1c2UgYW4gLmlzRnVuY3Rpb24oKSBjaGVjayBoZXJlIGJlY2F1c2UgSUU2LzcgZmFpbHMgdGhhdCB0ZXN0LgoJCQkJCS8vIERvbid0IGRvIGRlZmF1bHQgYWN0aW9ucyBvbiB3aW5kb3csIHRoYXQncyB3aGVyZSBnbG9iYWwgdmFyaWFibGVzIGJlICgjNjE3MCkKCQkJCQlpZiAoIG9udHlwZSAmJiBlbGVtWyB0eXBlIF0gJiYgIWpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkgewoKCQkJCQkJLy8gRG9uJ3QgcmUtdHJpZ2dlciBhbiBvbkZPTyBldmVudCB3aGVuIHdlIGNhbGwgaXRzIEZPTygpIG1ldGhvZAoJCQkJCQl0bXAgPSBlbGVtWyBvbnR5cGUgXTsKCgkJCQkJCWlmICggdG1wICkgewoJCQkJCQkJZWxlbVsgb250eXBlIF0gPSBudWxsOwoJCQkJCQl9CgoJCQkJCQkvLyBQcmV2ZW50IHJlLXRyaWdnZXJpbmcgb2YgdGhlIHNhbWUgZXZlbnQsIHNpbmNlIHdlIGFscmVhZHkgYnViYmxlZCBpdCBhYm92ZQoJCQkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdHlwZTsKCQkJCQkJdHJ5IHsKCQkJCQkJCWVsZW1bIHR5cGUgXSgpOwoJCQkJCQl9IGNhdGNoICggZSApIHsKCQkJCQkJCS8vIElFPDkgZGllcyBvbiBmb2N1cy9ibHVyIHRvIGhpZGRlbiBlbGVtZW50ICgjMTQ4NiwjMTI1MTgpCgkJCQkJCQkvLyBvbmx5IHJlcHJvZHVjaWJsZSBvbiB3aW5YUCBJRTggbmF0aXZlLCBub3QgSUU5IGluIElFOCBtb2RlCgkJCQkJCX0KCQkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHVuZGVmaW5lZDsKCgkJCQkJCWlmICggdG1wICkgewoJCQkJCQkJZWxlbVsgb250eXBlIF0gPSB0bXA7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiBldmVudC5yZXN1bHQ7CgkJfSwKCgkJZGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCS8vIE1ha2UgYSB3cml0YWJsZSBqUXVlcnkuRXZlbnQgZnJvbSB0aGUgbmF0aXZlIGV2ZW50IG9iamVjdAoJCQlldmVudCA9IGpRdWVyeS5ldmVudC5maXgoIGV2ZW50ICk7CgoJCQl2YXIgaSwgcmV0LCBoYW5kbGVPYmosIG1hdGNoZWQsIGosCgkJCQloYW5kbGVyUXVldWUgPSBbXSwKCQkJCWFyZ3MgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSwKCQkJCWhhbmRsZXJzID0gKCBqUXVlcnkuX2RhdGEoIHRoaXMsICJldmVudHMiICkgfHwge30gKVsgZXZlbnQudHlwZSBdIHx8IFtdLAoJCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyBldmVudC50eXBlIF0gfHwge307CgoJCQkvLyBVc2UgdGhlIGZpeC1lZCBqUXVlcnkuRXZlbnQgcmF0aGVyIHRoYW4gdGhlIChyZWFkLW9ubHkpIG5hdGl2ZSBldmVudAoJCQlhcmdzWzBdID0gZXZlbnQ7CgkJCWV2ZW50LmRlbGVnYXRlVGFyZ2V0ID0gdGhpczsKCgkJCS8vIENhbGwgdGhlIHByZURpc3BhdGNoIGhvb2sgZm9yIHRoZSBtYXBwZWQgdHlwZSwgYW5kIGxldCBpdCBiYWlsIGlmIGRlc2lyZWQKCQkJaWYgKCBzcGVjaWFsLnByZURpc3BhdGNoICYmIHNwZWNpYWwucHJlRGlzcGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKSA9PT0gZmFsc2UgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIERldGVybWluZSBoYW5kbGVycwoJCQloYW5kbGVyUXVldWUgPSBqUXVlcnkuZXZlbnQuaGFuZGxlcnMuY2FsbCggdGhpcywgZXZlbnQsIGhhbmRsZXJzICk7CgoJCQkvLyBSdW4gZGVsZWdhdGVzIGZpcnN0OyB0aGV5IG1heSB3YW50IHRvIHN0b3AgcHJvcGFnYXRpb24gYmVuZWF0aCB1cwoJCQlpID0gMDsKCQkJd2hpbGUgKCAobWF0Y2hlZCA9IGhhbmRsZXJRdWV1ZVsgaSsrIF0pICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkgewoJCQkJZXZlbnQuY3VycmVudFRhcmdldCA9IG1hdGNoZWQuZWxlbTsKCgkJCQlqID0gMDsKCQkJCXdoaWxlICggKGhhbmRsZU9iaiA9IG1hdGNoZWQuaGFuZGxlcnNbIGorKyBdKSAmJiAhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSApIHsKCgkJCQkJLy8gVHJpZ2dlcmVkIGV2ZW50IG11c3QgZWl0aGVyIDEpIGhhdmUgbm8gbmFtZXNwYWNlLCBvcgoJCQkJCS8vIDIpIGhhdmUgbmFtZXNwYWNlKHMpIGEgc3Vic2V0IG9yIGVxdWFsIHRvIHRob3NlIGluIHRoZSBib3VuZCBldmVudCAoYm90aCBjYW4gaGF2ZSBubyBuYW1lc3BhY2UpLgoJCQkJCWlmICggIWV2ZW50Lm5hbWVzcGFjZV9yZSB8fCBldmVudC5uYW1lc3BhY2VfcmUudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgewoKCQkJCQkJZXZlbnQuaGFuZGxlT2JqID0gaGFuZGxlT2JqOwoJCQkJCQlldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7CgoJCQkJCQlyZXQgPSAoIChqUXVlcnkuZXZlbnQuc3BlY2lhbFsgaGFuZGxlT2JqLm9yaWdUeXBlIF0gfHwge30pLmhhbmRsZSB8fCBoYW5kbGVPYmouaGFuZGxlciApCgkJCQkJCQkJLmFwcGx5KCBtYXRjaGVkLmVsZW0sIGFyZ3MgKTsKCgkJCQkJCWlmICggcmV0ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCQlpZiAoIChldmVudC5yZXN1bHQgPSByZXQpID09PSBmYWxzZSApIHsKCQkJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQkJCWV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBDYWxsIHRoZSBwb3N0RGlzcGF0Y2ggaG9vayBmb3IgdGhlIG1hcHBlZCB0eXBlCgkJCWlmICggc3BlY2lhbC5wb3N0RGlzcGF0Y2ggKSB7CgkJCQlzcGVjaWFsLnBvc3REaXNwYXRjaC5jYWxsKCB0aGlzLCBldmVudCApOwoJCQl9CgoJCQlyZXR1cm4gZXZlbnQucmVzdWx0OwoJCX0sCgoJCWhhbmRsZXJzOiBmdW5jdGlvbiggZXZlbnQsIGhhbmRsZXJzICkgewoJCQl2YXIgc2VsLCBoYW5kbGVPYmosIG1hdGNoZXMsIGksCgkJCQloYW5kbGVyUXVldWUgPSBbXSwKCQkJCWRlbGVnYXRlQ291bnQgPSBoYW5kbGVycy5kZWxlZ2F0ZUNvdW50LAoJCQkJY3VyID0gZXZlbnQudGFyZ2V0OwoKCQkJLy8gRmluZCBkZWxlZ2F0ZSBoYW5kbGVycwoJCQkvLyBCbGFjay1ob2xlIFNWRyA8dXNlPiBpbnN0YW5jZSB0cmVlcyAoIzEzMTgwKQoJCQkvLyBBdm9pZCBub24tbGVmdC1jbGljayBidWJibGluZyBpbiBGaXJlZm94ICgjMzg2MSkKCQkJaWYgKCBkZWxlZ2F0ZUNvdW50ICYmIGN1ci5ub2RlVHlwZSAmJiAoIWV2ZW50LmJ1dHRvbiB8fCBldmVudC50eXBlICE9PSAiY2xpY2siKSApIHsKCgkJCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCQkJZm9yICggOyBjdXIgIT0gdGhpczsgY3VyID0gY3VyLnBhcmVudE5vZGUgfHwgdGhpcyApIHsKCQkJCQkvKiBqc2hpbnQgZXFlcWVxOiB0cnVlICovCgoJCQkJCS8vIERvbid0IGNoZWNrIG5vbi1lbGVtZW50cyAoIzEzMjA4KQoJCQkJCS8vIERvbid0IHByb2Nlc3MgY2xpY2tzIG9uIGRpc2FibGVkIGVsZW1lbnRzICgjNjkxMSwgIzgxNjUsICMxMTM4MiwgIzExNzY0KQoJCQkJCWlmICggY3VyLm5vZGVUeXBlID09PSAxICYmIChjdXIuZGlzYWJsZWQgIT09IHRydWUgfHwgZXZlbnQudHlwZSAhPT0gImNsaWNrIikgKSB7CgkJCQkJCW1hdGNoZXMgPSBbXTsKCQkJCQkJZm9yICggaSA9IDA7IGkgPCBkZWxlZ2F0ZUNvdW50OyBpKysgKSB7CgkJCQkJCQloYW5kbGVPYmogPSBoYW5kbGVyc1sgaSBdOwoKCQkJCQkJCS8vIERvbid0IGNvbmZsaWN0IHdpdGggT2JqZWN0LnByb3RvdHlwZSBwcm9wZXJ0aWVzICgjMTMyMDMpCgkJCQkJCQlzZWwgPSBoYW5kbGVPYmouc2VsZWN0b3IgKyAiICI7CgoJCQkJCQkJaWYgKCBtYXRjaGVzWyBzZWwgXSA9PT0gdW5kZWZpbmVkICkgewoJCQkJCQkJCW1hdGNoZXNbIHNlbCBdID0gaGFuZGxlT2JqLm5lZWRzQ29udGV4dCA/CgkJCQkJCQkJCWpRdWVyeSggc2VsLCB0aGlzICkuaW5kZXgoIGN1ciApID49IDAgOgoJCQkJCQkJCQlqUXVlcnkuZmluZCggc2VsLCB0aGlzLCBudWxsLCBbIGN1ciBdICkubGVuZ3RoOwoJCQkJCQkJfQoJCQkJCQkJaWYgKCBtYXRjaGVzWyBzZWwgXSApIHsKCQkJCQkJCQltYXRjaGVzLnB1c2goIGhhbmRsZU9iaiApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWlmICggbWF0Y2hlcy5sZW5ndGggKSB7CgkJCQkJCQloYW5kbGVyUXVldWUucHVzaCh7IGVsZW06IGN1ciwgaGFuZGxlcnM6IG1hdGNoZXMgfSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIEFkZCB0aGUgcmVtYWluaW5nIChkaXJlY3RseS1ib3VuZCkgaGFuZGxlcnMKCQkJaWYgKCBkZWxlZ2F0ZUNvdW50IDwgaGFuZGxlcnMubGVuZ3RoICkgewoJCQkJaGFuZGxlclF1ZXVlLnB1c2goeyBlbGVtOiB0aGlzLCBoYW5kbGVyczogaGFuZGxlcnMuc2xpY2UoIGRlbGVnYXRlQ291bnQgKSB9KTsKCQkJfQoKCQkJcmV0dXJuIGhhbmRsZXJRdWV1ZTsKCQl9LAoKCQlmaXg6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJaWYgKCBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJCXJldHVybiBldmVudDsKCQkJfQoKCQkJLy8gQ3JlYXRlIGEgd3JpdGFibGUgY29weSBvZiB0aGUgZXZlbnQgb2JqZWN0IGFuZCBub3JtYWxpemUgc29tZSBwcm9wZXJ0aWVzCgkJCXZhciBpLCBwcm9wLCBjb3B5LAoJCQkJdHlwZSA9IGV2ZW50LnR5cGUsCgkJCQlvcmlnaW5hbEV2ZW50ID0gZXZlbnQsCgkJCQlmaXhIb29rID0gdGhpcy5maXhIb29rc1sgdHlwZSBdOwoKCQkJaWYgKCAhZml4SG9vayApIHsKCQkJCXRoaXMuZml4SG9va3NbIHR5cGUgXSA9IGZpeEhvb2sgPQoJCQkJCXJtb3VzZUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMubW91c2VIb29rcyA6CgkJCQkJcmtleUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMua2V5SG9va3MgOgoJCQkJCXt9OwoJCQl9CgkJCWNvcHkgPSBmaXhIb29rLnByb3BzID8gdGhpcy5wcm9wcy5jb25jYXQoIGZpeEhvb2sucHJvcHMgKSA6IHRoaXMucHJvcHM7CgoJCQlldmVudCA9IG5ldyBqUXVlcnkuRXZlbnQoIG9yaWdpbmFsRXZlbnQgKTsKCgkJCWkgPSBjb3B5Lmxlbmd0aDsKCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQlwcm9wID0gY29weVsgaSBdOwoJCQkJZXZlbnRbIHByb3AgXSA9IG9yaWdpbmFsRXZlbnRbIHByb3AgXTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBGaXggdGFyZ2V0IHByb3BlcnR5ICgjMTkyNSkKCQkJaWYgKCAhZXZlbnQudGFyZ2V0ICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gb3JpZ2luYWxFdmVudC5zcmNFbGVtZW50IHx8IGRvY3VtZW50OwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBDaHJvbWUgMjMrLCBTYWZhcmk/CgkJCS8vIFRhcmdldCBzaG91bGQgbm90IGJlIGEgdGV4dCBub2RlICgjNTA0LCAjMTMxNDMpCgkJCWlmICggZXZlbnQudGFyZ2V0Lm5vZGVUeXBlID09PSAzICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGU7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJLy8gRm9yIG1vdXNlL2tleSBldmVudHMsIG1ldGFLZXk9PWZhbHNlIGlmIGl0J3MgdW5kZWZpbmVkICgjMzM2OCwgIzExMzI4KQoJCQlldmVudC5tZXRhS2V5ID0gISFldmVudC5tZXRhS2V5OwoKCQkJcmV0dXJuIGZpeEhvb2suZmlsdGVyID8gZml4SG9vay5maWx0ZXIoIGV2ZW50LCBvcmlnaW5hbEV2ZW50ICkgOiBldmVudDsKCQl9LAoKCQkvLyBJbmNsdWRlcyBzb21lIGV2ZW50IHByb3BzIHNoYXJlZCBieSBLZXlFdmVudCBhbmQgTW91c2VFdmVudAoJCXByb3BzOiAiYWx0S2V5IGJ1YmJsZXMgY2FuY2VsYWJsZSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZXZlbnRQaGFzZSBtZXRhS2V5IHJlbGF0ZWRUYXJnZXQgc2hpZnRLZXkgdGFyZ2V0IHRpbWVTdGFtcCB2aWV3IHdoaWNoIi5zcGxpdCgiICIpLAoKCQlmaXhIb29rczoge30sCgoJCWtleUhvb2tzOiB7CgkJCXByb3BzOiAiY2hhciBjaGFyQ29kZSBrZXkga2V5Q29kZSIuc3BsaXQoIiAiKSwKCQkJZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkgewoKCQkJCS8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50cwoJCQkJaWYgKCBldmVudC53aGljaCA9PSBudWxsICkgewoJCQkJCWV2ZW50LndoaWNoID0gb3JpZ2luYWwuY2hhckNvZGUgIT0gbnVsbCA/IG9yaWdpbmFsLmNoYXJDb2RlIDogb3JpZ2luYWwua2V5Q29kZTsKCQkJCX0KCgkJCQlyZXR1cm4gZXZlbnQ7CgkJCX0KCQl9LAoKCQltb3VzZUhvb2tzOiB7CgkJCXByb3BzOiAiYnV0dG9uIGJ1dHRvbnMgY2xpZW50WCBjbGllbnRZIGZyb21FbGVtZW50IG9mZnNldFggb2Zmc2V0WSBwYWdlWCBwYWdlWSBzY3JlZW5YIHNjcmVlblkgdG9FbGVtZW50Ii5zcGxpdCgiICIpLAoJCQlmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7CgkJCQl2YXIgYm9keSwgZXZlbnREb2MsIGRvYywKCQkJCQlidXR0b24gPSBvcmlnaW5hbC5idXR0b24sCgkJCQkJZnJvbUVsZW1lbnQgPSBvcmlnaW5hbC5mcm9tRWxlbWVudDsKCgkJCQkvLyBDYWxjdWxhdGUgcGFnZVgvWSBpZiBtaXNzaW5nIGFuZCBjbGllbnRYL1kgYXZhaWxhYmxlCgkJCQlpZiAoIGV2ZW50LnBhZ2VYID09IG51bGwgJiYgb3JpZ2luYWwuY2xpZW50WCAhPSBudWxsICkgewoJCQkJCWV2ZW50RG9jID0gZXZlbnQudGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CgkJCQkJZG9jID0gZXZlbnREb2MuZG9jdW1lbnRFbGVtZW50OwoJCQkJCWJvZHkgPSBldmVudERvYy5ib2R5OwoKCQkJCQlldmVudC5wYWdlWCA9IG9yaWdpbmFsLmNsaWVudFggKyAoIGRvYyAmJiBkb2Muc2Nyb2xsTGVmdCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwICkgLSAoIGRvYyAmJiBkb2MuY2xpZW50TGVmdCB8fCBib2R5ICYmIGJvZHkuY2xpZW50TGVmdCB8fCAwICk7CgkJCQkJZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsgKCBkb2MgJiYgZG9jLnNjcm9sbFRvcCAgfHwgYm9keSAmJiBib2R5LnNjcm9sbFRvcCAgfHwgMCApIC0gKCBkb2MgJiYgZG9jLmNsaWVudFRvcCAgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCAgfHwgMCApOwoJCQkJfQoKCQkJCS8vIEFkZCByZWxhdGVkVGFyZ2V0LCBpZiBuZWNlc3NhcnkKCQkJCWlmICggIWV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgZnJvbUVsZW1lbnQgKSB7CgkJCQkJZXZlbnQucmVsYXRlZFRhcmdldCA9IGZyb21FbGVtZW50ID09PSBldmVudC50YXJnZXQgPyBvcmlnaW5hbC50b0VsZW1lbnQgOiBmcm9tRWxlbWVudDsKCQkJCX0KCgkJCQkvLyBBZGQgd2hpY2ggZm9yIGNsaWNrOiAxID09PSBsZWZ0OyAyID09PSBtaWRkbGU7IDMgPT09IHJpZ2h0CgkJCQkvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdAoJCQkJaWYgKCAhZXZlbnQud2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJZXZlbnQud2hpY2ggPSAoIGJ1dHRvbiAmIDEgPyAxIDogKCBidXR0b24gJiAyID8gMyA6ICggYnV0dG9uICYgNCA/IDIgOiAwICkgKSApOwoJCQkJfQoKCQkJCXJldHVybiBldmVudDsKCQkJfQoJCX0sCgoJCXNwZWNpYWw6IHsKCQkJbG9hZDogewoJCQkJLy8gUHJldmVudCB0cmlnZ2VyZWQgaW1hZ2UubG9hZCBldmVudHMgZnJvbSBidWJibGluZyB0byB3aW5kb3cubG9hZAoJCQkJbm9CdWJibGU6IHRydWUKCQkJfSwKCQkJZm9jdXM6IHsKCQkJCS8vIEZpcmUgbmF0aXZlIGV2ZW50IGlmIHBvc3NpYmxlIHNvIGJsdXIvZm9jdXMgc2VxdWVuY2UgaXMgY29ycmVjdAoJCQkJdHJpZ2dlcjogZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCB0aGlzICE9PSBzYWZlQWN0aXZlRWxlbWVudCgpICYmIHRoaXMuZm9jdXMgKSB7CgkJCQkJCXRyeSB7CgkJCQkJCQl0aGlzLmZvY3VzKCk7CgkJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJCX0gY2F0Y2ggKCBlICkgewoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSWYgd2UgZXJyb3Igb24gZm9jdXMgdG8gaGlkZGVuIGVsZW1lbnQgKCMxNDg2LCAjMTI1MTgpLAoJCQkJCQkJLy8gbGV0IC50cmlnZ2VyKCkgcnVuIHRoZSBoYW5kbGVycwoJCQkJCQl9CgkJCQkJfQoJCQkJfSwKCQkJCWRlbGVnYXRlVHlwZTogImZvY3VzaW4iCgkJCX0sCgkJCWJsdXI6IHsKCQkJCXRyaWdnZXI6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggdGhpcyA9PT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmJsdXIgKSB7CgkJCQkJCXRoaXMuYmx1cigpOwoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJfSwKCQkJCWRlbGVnYXRlVHlwZTogImZvY3Vzb3V0IgoJCQl9LAoJCQljbGljazogewoJCQkJLy8gRm9yIGNoZWNrYm94LCBmaXJlIG5hdGl2ZSBldmVudCBzbyBjaGVja2VkIHN0YXRlIHdpbGwgYmUgcmlnaHQKCQkJCXRyaWdnZXI6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCAiaW5wdXQiICkgJiYgdGhpcy50eXBlID09PSAiY2hlY2tib3giICYmIHRoaXMuY2xpY2sgKSB7CgkJCQkJCXRoaXMuY2xpY2soKTsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0sCgoJCQkJLy8gRm9yIGNyb3NzLWJyb3dzZXIgY29uc2lzdGVuY3ksIGRvbid0IGZpcmUgbmF0aXZlIC5jbGljaygpIG9uIGxpbmtzCgkJCQlfZGVmYXVsdDogZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJCXJldHVybiBqUXVlcnkubm9kZU5hbWUoIGV2ZW50LnRhcmdldCwgImEiICk7CgkJCQl9CgkJCX0sCgoJCQliZWZvcmV1bmxvYWQ6IHsKCQkJCXBvc3REaXNwYXRjaDogZnVuY3Rpb24oIGV2ZW50ICkgewoKCQkJCQkvLyBTdXBwb3J0OiBGaXJlZm94IDIwKwoJCQkJCS8vIEZpcmVmb3ggZG9lc24ndCBhbGVydCBpZiB0aGUgcmV0dXJuVmFsdWUgZmllbGQgaXMgbm90IHNldC4KCQkJCQlpZiAoIGV2ZW50LnJlc3VsdCAhPT0gdW5kZWZpbmVkICYmIGV2ZW50Lm9yaWdpbmFsRXZlbnQgKSB7CgkJCQkJCWV2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWUgPSBldmVudC5yZXN1bHQ7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfSwKCgkJc2ltdWxhdGU6IGZ1bmN0aW9uKCB0eXBlLCBlbGVtLCBldmVudCwgYnViYmxlICkgewoJCQkvLyBQaWdneWJhY2sgb24gYSBkb25vciBldmVudCB0byBzaW11bGF0ZSBhIGRpZmZlcmVudCBvbmUuCgkJCS8vIEZha2Ugb3JpZ2luYWxFdmVudCB0byBhdm9pZCBkb25vcidzIHN0b3BQcm9wYWdhdGlvbiwgYnV0IGlmIHRoZQoJCQkvLyBzaW11bGF0ZWQgZXZlbnQgcHJldmVudHMgZGVmYXVsdCB0aGVuIHdlIGRvIHRoZSBzYW1lIG9uIHRoZSBkb25vci4KCQkJdmFyIGUgPSBqUXVlcnkuZXh0ZW5kKAoJCQkJbmV3IGpRdWVyeS5FdmVudCgpLAoJCQkJZXZlbnQsCgkJCQl7CgkJCQkJdHlwZTogdHlwZSwKCQkJCQlpc1NpbXVsYXRlZDogdHJ1ZSwKCQkJCQlvcmlnaW5hbEV2ZW50OiB7fQoJCQkJfQoJCQkpOwoJCQlpZiAoIGJ1YmJsZSApIHsKCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCBlLCBudWxsLCBlbGVtICk7CgkJCX0gZWxzZSB7CgkJCQlqUXVlcnkuZXZlbnQuZGlzcGF0Y2guY2FsbCggZWxlbSwgZSApOwoJCQl9CgkJCWlmICggZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHsKCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCX0KCQl9Cgl9OwoKCWpRdWVyeS5yZW1vdmVFdmVudCA9IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIgPwoJCWZ1bmN0aW9uKCBlbGVtLCB0eXBlLCBoYW5kbGUgKSB7CgkJCWlmICggZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICkgewoJCQkJZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKCB0eXBlLCBoYW5kbGUsIGZhbHNlICk7CgkJCX0KCQl9IDoKCQlmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoJCQl2YXIgbmFtZSA9ICJvbiIgKyB0eXBlOwoKCQkJaWYgKCBlbGVtLmRldGFjaEV2ZW50ICkgewoKCQkJCS8vICM4NTQ1LCAjNzA1NCwgcHJldmVudGluZyBtZW1vcnkgbGVha3MgZm9yIGN1c3RvbSBldmVudHMgaW4gSUU2LTgKCQkJCS8vIGRldGFjaEV2ZW50IG5lZWRlZCBwcm9wZXJ0eSBvbiBlbGVtZW50LCBieSBuYW1lIG9mIHRoYXQgZXZlbnQsIHRvIHByb3Blcmx5IGV4cG9zZSBpdCB0byBHQwoJCQkJaWYgKCB0eXBlb2YgZWxlbVsgbmFtZSBdID09PSBzdHJ1bmRlZmluZWQgKSB7CgkJCQkJZWxlbVsgbmFtZSBdID0gbnVsbDsKCQkJCX0KCgkJCQllbGVtLmRldGFjaEV2ZW50KCBuYW1lLCBoYW5kbGUgKTsKCQkJfQoJCX07CgoJalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24oIHNyYywgcHJvcHMgKSB7CgkJLy8gQWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IHRoZSAnbmV3JyBrZXl3b3JkCgkJaWYgKCAhKHRoaXMgaW5zdGFuY2VvZiBqUXVlcnkuRXZlbnQpICkgewoJCQlyZXR1cm4gbmV3IGpRdWVyeS5FdmVudCggc3JjLCBwcm9wcyApOwoJCX0KCgkJLy8gRXZlbnQgb2JqZWN0CgkJaWYgKCBzcmMgJiYgc3JjLnR5cGUgKSB7CgkJCXRoaXMub3JpZ2luYWxFdmVudCA9IHNyYzsKCQkJdGhpcy50eXBlID0gc3JjLnR5cGU7CgoJCQkvLyBFdmVudHMgYnViYmxpbmcgdXAgdGhlIGRvY3VtZW50IG1heSBoYXZlIGJlZW4gbWFya2VkIGFzIHByZXZlbnRlZAoJCQkvLyBieSBhIGhhbmRsZXIgbG93ZXIgZG93biB0aGUgdHJlZTsgcmVmbGVjdCB0aGUgY29ycmVjdCB2YWx1ZS4KCQkJdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fAoJCQkJCXNyYy5kZWZhdWx0UHJldmVudGVkID09PSB1bmRlZmluZWQgJiYKCQkJCQkvLyBTdXBwb3J0OiBJRSA8IDksIEFuZHJvaWQgPCA0LjAKCQkJCQlzcmMucmV0dXJuVmFsdWUgPT09IGZhbHNlID8KCQkJCXJldHVyblRydWUgOgoJCQkJcmV0dXJuRmFsc2U7CgoJCS8vIEV2ZW50IHR5cGUKCQl9IGVsc2UgewoJCQl0aGlzLnR5cGUgPSBzcmM7CgkJfQoKCQkvLyBQdXQgZXhwbGljaXRseSBwcm92aWRlZCBwcm9wZXJ0aWVzIG9udG8gdGhlIGV2ZW50IG9iamVjdAoJCWlmICggcHJvcHMgKSB7CgkJCWpRdWVyeS5leHRlbmQoIHRoaXMsIHByb3BzICk7CgkJfQoKCQkvLyBDcmVhdGUgYSB0aW1lc3RhbXAgaWYgaW5jb21pbmcgZXZlbnQgZG9lc24ndCBoYXZlIG9uZQoJCXRoaXMudGltZVN0YW1wID0gc3JjICYmIHNyYy50aW1lU3RhbXAgfHwgalF1ZXJ5Lm5vdygpOwoKCQkvLyBNYXJrIGl0IGFzIGZpeGVkCgkJdGhpc1sgalF1ZXJ5LmV4cGFuZG8gXSA9IHRydWU7Cgl9OwoKCS8vIGpRdWVyeS5FdmVudCBpcyBiYXNlZCBvbiBET00zIEV2ZW50cyBhcyBzcGVjaWZpZWQgYnkgdGhlIEVDTUFTY3JpcHQgTGFuZ3VhZ2UgQmluZGluZwoJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMy9XRC1ET00tTGV2ZWwtMy1FdmVudHMtMjAwMzAzMzEvZWNtYS1zY3JpcHQtYmluZGluZy5odG1sCglqUXVlcnkuRXZlbnQucHJvdG90eXBlID0gewoJCWlzRGVmYXVsdFByZXZlbnRlZDogcmV0dXJuRmFsc2UsCgkJaXNQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLAoJCWlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwKCgkJcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZTsKCQkJaWYgKCAhZSApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gSWYgcHJldmVudERlZmF1bHQgZXhpc3RzLCBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgkJCWlmICggZS5wcmV2ZW50RGVmYXVsdCApIHsKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCgkJCS8vIFN1cHBvcnQ6IElFCgkJCS8vIE90aGVyd2lzZSBzZXQgdGhlIHJldHVyblZhbHVlIHByb3BlcnR5IG9mIHRoZSBvcmlnaW5hbCBldmVudCB0byBmYWxzZQoJCQl9IGVsc2UgewoJCQkJZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwoJCQl9CgkJfSwKCQlzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoJCQlpZiAoICFlICkgewoJCQkJcmV0dXJuOwoJCQl9CgkJCS8vIElmIHN0b3BQcm9wYWdhdGlvbiBleGlzdHMsIHJ1biBpdCBvbiB0aGUgb3JpZ2luYWwgZXZlbnQKCQkJaWYgKCBlLnN0b3BQcm9wYWdhdGlvbiApIHsKCQkJCWUuc3RvcFByb3BhZ2F0aW9uKCk7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFCgkJCS8vIFNldCB0aGUgY2FuY2VsQnViYmxlIHByb3BlcnR5IG9mIHRoZSBvcmlnaW5hbCBldmVudCB0byB0cnVlCgkJCWUuY2FuY2VsQnViYmxlID0gdHJ1ZTsKCQl9LAoJCXN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24oKSB7CgkJCXZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OwoKCQkJdGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7CgoJCQlpZiAoIGUgJiYgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gKSB7CgkJCQllLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwoJCQl9CgoJCQl0aGlzLnN0b3BQcm9wYWdhdGlvbigpOwoJCX0KCX07CgoJLy8gQ3JlYXRlIG1vdXNlZW50ZXIvbGVhdmUgZXZlbnRzIHVzaW5nIG1vdXNlb3Zlci9vdXQgYW5kIGV2ZW50LXRpbWUgY2hlY2tzCglqUXVlcnkuZWFjaCh7CgkJbW91c2VlbnRlcjogIm1vdXNlb3ZlciIsCgkJbW91c2VsZWF2ZTogIm1vdXNlb3V0IiwKCQlwb2ludGVyZW50ZXI6ICJwb2ludGVyb3ZlciIsCgkJcG9pbnRlcmxlYXZlOiAicG9pbnRlcm91dCIKCX0sIGZ1bmN0aW9uKCBvcmlnLCBmaXggKSB7CgkJalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIG9yaWcgXSA9IHsKCQkJZGVsZWdhdGVUeXBlOiBmaXgsCgkJCWJpbmRUeXBlOiBmaXgsCgoJCQloYW5kbGU6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCXZhciByZXQsCgkJCQkJdGFyZ2V0ID0gdGhpcywKCQkJCQlyZWxhdGVkID0gZXZlbnQucmVsYXRlZFRhcmdldCwKCQkJCQloYW5kbGVPYmogPSBldmVudC5oYW5kbGVPYmo7CgoJCQkJLy8gRm9yIG1vdXNlbnRlci9sZWF2ZSBjYWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0LgoJCQkJLy8gTkI6IE5vIHJlbGF0ZWRUYXJnZXQgaWYgdGhlIG1vdXNlIGxlZnQvZW50ZXJlZCB0aGUgYnJvd3NlciB3aW5kb3cKCQkJCWlmICggIXJlbGF0ZWQgfHwgKHJlbGF0ZWQgIT09IHRhcmdldCAmJiAhalF1ZXJ5LmNvbnRhaW5zKCB0YXJnZXQsIHJlbGF0ZWQgKSkgKSB7CgkJCQkJZXZlbnQudHlwZSA9IGhhbmRsZU9iai5vcmlnVHlwZTsKCQkJCQlyZXQgPSBoYW5kbGVPYmouaGFuZGxlci5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJCQkJZXZlbnQudHlwZSA9IGZpeDsKCQkJCX0KCQkJCXJldHVybiByZXQ7CgkJCX0KCQl9OwoJfSk7CgoJLy8gSUUgc3VibWl0IGRlbGVnYXRpb24KCWlmICggIXN1cHBvcnQuc3VibWl0QnViYmxlcyApIHsKCgkJalF1ZXJ5LmV2ZW50LnNwZWNpYWwuc3VibWl0ID0gewoJCQlzZXR1cDogZnVuY3Rpb24oKSB7CgkJCQkvLyBPbmx5IG5lZWQgdGhpcyBmb3IgZGVsZWdhdGVkIGZvcm0gc3VibWl0IGV2ZW50cwoJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJmb3JtIiApICkgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCgkJCQkvLyBMYXp5LWFkZCBhIHN1Ym1pdCBoYW5kbGVyIHdoZW4gYSBkZXNjZW5kYW50IGZvcm0gbWF5IHBvdGVudGlhbGx5IGJlIHN1Ym1pdHRlZAoJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImNsaWNrLl9zdWJtaXQga2V5cHJlc3MuX3N1Ym1pdCIsIGZ1bmN0aW9uKCBlICkgewoJCQkJCS8vIE5vZGUgbmFtZSBjaGVjayBhdm9pZHMgYSBWTUwtcmVsYXRlZCBjcmFzaCBpbiBJRSAoIzk4MDcpCgkJCQkJdmFyIGVsZW0gPSBlLnRhcmdldCwKCQkJCQkJZm9ybSA9IGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImlucHV0IiApIHx8IGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImJ1dHRvbiIgKSA/IGVsZW0uZm9ybSA6IHVuZGVmaW5lZDsKCQkJCQlpZiAoIGZvcm0gJiYgIWpRdWVyeS5fZGF0YSggZm9ybSwgInN1Ym1pdEJ1YmJsZXMiICkgKSB7CgkJCQkJCWpRdWVyeS5ldmVudC5hZGQoIGZvcm0sICJzdWJtaXQuX3N1Ym1pdCIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJCWV2ZW50Ll9zdWJtaXRfYnViYmxlID0gdHJ1ZTsKCQkJCQkJfSk7CgkJCQkJCWpRdWVyeS5fZGF0YSggZm9ybSwgInN1Ym1pdEJ1YmJsZXMiLCB0cnVlICk7CgkJCQkJfQoJCQkJfSk7CgkJCQkvLyByZXR1cm4gdW5kZWZpbmVkIHNpbmNlIHdlIGRvbid0IG5lZWQgYW4gZXZlbnQgbGlzdGVuZXIKCQkJfSwKCgkJCXBvc3REaXNwYXRjaDogZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJLy8gSWYgZm9ybSB3YXMgc3VibWl0dGVkIGJ5IHRoZSB1c2VyLCBidWJibGUgdGhlIGV2ZW50IHVwIHRoZSB0cmVlCgkJCQlpZiAoIGV2ZW50Ll9zdWJtaXRfYnViYmxlICkgewoJCQkJCWRlbGV0ZSBldmVudC5fc3VibWl0X2J1YmJsZTsKCQkJCQlpZiAoIHRoaXMucGFyZW50Tm9kZSAmJiAhZXZlbnQuaXNUcmlnZ2VyICkgewoJCQkJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoICJzdWJtaXQiLCB0aGlzLnBhcmVudE5vZGUsIGV2ZW50LCB0cnVlICk7CgkJCQkJfQoJCQkJfQoJCQl9LAoKCQkJdGVhcmRvd246IGZ1bmN0aW9uKCkgewoJCQkJLy8gT25seSBuZWVkIHRoaXMgZm9yIGRlbGVnYXRlZCBmb3JtIHN1Ym1pdCBldmVudHMKCQkJCWlmICggalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCAiZm9ybSIgKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGRlbGVnYXRlZCBoYW5kbGVyczsgY2xlYW5EYXRhIGV2ZW50dWFsbHkgcmVhcHMgc3VibWl0IGhhbmRsZXJzIGF0dGFjaGVkIGFib3ZlCgkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCB0aGlzLCAiLl9zdWJtaXQiICk7CgkJCX0KCQl9OwoJfQoKCS8vIElFIGNoYW5nZSBkZWxlZ2F0aW9uIGFuZCBjaGVja2JveC9yYWRpbyBmaXgKCWlmICggIXN1cHBvcnQuY2hhbmdlQnViYmxlcyApIHsKCgkJalF1ZXJ5LmV2ZW50LnNwZWNpYWwuY2hhbmdlID0gewoKCQkJc2V0dXA6IGZ1bmN0aW9uKCkgewoKCQkJCWlmICggcmZvcm1FbGVtcy50ZXN0KCB0aGlzLm5vZGVOYW1lICkgKSB7CgkJCQkJLy8gSUUgZG9lc24ndCBmaXJlIGNoYW5nZSBvbiBhIGNoZWNrL3JhZGlvIHVudGlsIGJsdXI7IHRyaWdnZXIgaXQgb24gY2xpY2sKCQkJCQkvLyBhZnRlciBhIHByb3BlcnR5Y2hhbmdlLiBFYXQgdGhlIGJsdXItY2hhbmdlIGluIHNwZWNpYWwuY2hhbmdlLmhhbmRsZS4KCQkJCQkvLyBUaGlzIHN0aWxsIGZpcmVzIG9uY2hhbmdlIGEgc2Vjb25kIHRpbWUgZm9yIGNoZWNrL3JhZGlvIGFmdGVyIGJsdXIuCgkJCQkJaWYgKCB0aGlzLnR5cGUgPT09ICJjaGVja2JveCIgfHwgdGhpcy50eXBlID09PSAicmFkaW8iICkgewoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCB0aGlzLCAicHJvcGVydHljaGFuZ2UuX2NoYW5nZSIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJCWlmICggZXZlbnQub3JpZ2luYWxFdmVudC5wcm9wZXJ0eU5hbWUgPT09ICJjaGVja2VkIiApIHsKCQkJCQkJCQl0aGlzLl9qdXN0X2NoYW5nZWQgPSB0cnVlOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImNsaWNrLl9jaGFuZ2UiLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJCQlpZiAoIHRoaXMuX2p1c3RfY2hhbmdlZCAmJiAhZXZlbnQuaXNUcmlnZ2VyICkgewoJCQkJCQkJCXRoaXMuX2p1c3RfY2hhbmdlZCA9IGZhbHNlOwoJCQkJCQkJfQoJCQkJCQkJLy8gQWxsb3cgdHJpZ2dlcmVkLCBzaW11bGF0ZWQgY2hhbmdlIGV2ZW50cyAoIzExNTAwKQoJCQkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCAiY2hhbmdlIiwgdGhpcywgZXZlbnQsIHRydWUgKTsKCQkJCQkJfSk7CgkJCQkJfQoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJCS8vIERlbGVnYXRlZCBldmVudDsgbGF6eS1hZGQgYSBjaGFuZ2UgaGFuZGxlciBvbiBkZXNjZW5kYW50IGlucHV0cwoJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImJlZm9yZWFjdGl2YXRlLl9jaGFuZ2UiLCBmdW5jdGlvbiggZSApIHsKCQkJCQl2YXIgZWxlbSA9IGUudGFyZ2V0OwoKCQkJCQlpZiAoIHJmb3JtRWxlbXMudGVzdCggZWxlbS5ub2RlTmFtZSApICYmICFqUXVlcnkuX2RhdGEoIGVsZW0sICJjaGFuZ2VCdWJibGVzIiApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBlbGVtLCAiY2hhbmdlLl9jaGFuZ2UiLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJCQlpZiAoIHRoaXMucGFyZW50Tm9kZSAmJiAhZXZlbnQuaXNTaW11bGF0ZWQgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoICJjaGFuZ2UiLCB0aGlzLnBhcmVudE5vZGUsIGV2ZW50LCB0cnVlICk7CgkJCQkJCQl9CgkJCQkJCX0pOwoJCQkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJjaGFuZ2VCdWJibGVzIiwgdHJ1ZSApOwoJCQkJCX0KCQkJCX0pOwoJCQl9LAoKCQkJaGFuZGxlOiBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQl2YXIgZWxlbSA9IGV2ZW50LnRhcmdldDsKCgkJCQkvLyBTd2FsbG93IG5hdGl2ZSBjaGFuZ2UgZXZlbnRzIGZyb20gY2hlY2tib3gvcmFkaW8sIHdlIGFscmVhZHkgdHJpZ2dlcmVkIHRoZW0gYWJvdmUKCQkJCWlmICggdGhpcyAhPT0gZWxlbSB8fCBldmVudC5pc1NpbXVsYXRlZCB8fCBldmVudC5pc1RyaWdnZXIgfHwgKGVsZW0udHlwZSAhPT0gInJhZGlvIiAmJiBlbGVtLnR5cGUgIT09ICJjaGVja2JveCIpICkgewoJCQkJCXJldHVybiBldmVudC5oYW5kbGVPYmouaGFuZGxlci5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJCQl9CgkJCX0sCgoJCQl0ZWFyZG93bjogZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCB0aGlzLCAiLl9jaGFuZ2UiICk7CgoJCQkJcmV0dXJuICFyZm9ybUVsZW1zLnRlc3QoIHRoaXMubm9kZU5hbWUgKTsKCQkJfQoJCX07Cgl9CgoJLy8gQ3JlYXRlICJidWJibGluZyIgZm9jdXMgYW5kIGJsdXIgZXZlbnRzCglpZiAoICFzdXBwb3J0LmZvY3VzaW5CdWJibGVzICkgewoJCWpRdWVyeS5lYWNoKHsgZm9jdXM6ICJmb2N1c2luIiwgYmx1cjogImZvY3Vzb3V0IiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoKCQkJLy8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIG9uIHRoZSBkb2N1bWVudCB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXQKCQkJdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCBmaXgsIGV2ZW50LnRhcmdldCwgalF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKSwgdHJ1ZSApOwoJCQkJfTsKCgkJCWpRdWVyeS5ldmVudC5zcGVjaWFsWyBmaXggXSA9IHsKCQkJCXNldHVwOiBmdW5jdGlvbigpIHsKCQkJCQl2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsCgkJCQkJCWF0dGFjaGVzID0galF1ZXJ5Ll9kYXRhKCBkb2MsIGZpeCApOwoKCQkJCQlpZiAoICFhdHRhY2hlcyApIHsKCQkJCQkJZG9jLmFkZEV2ZW50TGlzdGVuZXIoIG9yaWcsIGhhbmRsZXIsIHRydWUgKTsKCQkJCQl9CgkJCQkJalF1ZXJ5Ll9kYXRhKCBkb2MsIGZpeCwgKCBhdHRhY2hlcyB8fCAwICkgKyAxICk7CgkJCQl9LAoJCQkJdGVhcmRvd246IGZ1bmN0aW9uKCkgewoJCQkJCXZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpcywKCQkJCQkJYXR0YWNoZXMgPSBqUXVlcnkuX2RhdGEoIGRvYywgZml4ICkgLSAxOwoKCQkJCQlpZiAoICFhdHRhY2hlcyApIHsKCQkJCQkJZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoIG9yaWcsIGhhbmRsZXIsIHRydWUgKTsKCQkJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBkb2MsIGZpeCApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWpRdWVyeS5fZGF0YSggZG9jLCBmaXgsIGF0dGFjaGVzICk7CgkJCQkJfQoJCQkJfQoJCQl9OwoJCX0pOwoJfQoKCWpRdWVyeS5mbi5leHRlbmQoewoKCQlvbjogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4sIC8qSU5URVJOQUwqLyBvbmUgKSB7CgkJCXZhciB0eXBlLCBvcmlnRm47CgoJCQkvLyBUeXBlcyBjYW4gYmUgYSBtYXAgb2YgdHlwZXMvaGFuZGxlcnMKCQkJaWYgKCB0eXBlb2YgdHlwZXMgPT09ICJvYmplY3QiICkgewoJCQkJLy8gKCB0eXBlcy1PYmplY3QsIHNlbGVjdG9yLCBkYXRhICkKCQkJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiApIHsKCQkJCQkvLyAoIHR5cGVzLU9iamVjdCwgZGF0YSApCgkJCQkJZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7CgkJCQkJc2VsZWN0b3IgPSB1bmRlZmluZWQ7CgkJCQl9CgkJCQlmb3IgKCB0eXBlIGluIHR5cGVzICkgewoJCQkJCXRoaXMub24oIHR5cGUsIHNlbGVjdG9yLCBkYXRhLCB0eXBlc1sgdHlwZSBdLCBvbmUgKTsKCQkJCX0KCQkJCXJldHVybiB0aGlzOwoJCQl9CgoJCQlpZiAoIGRhdGEgPT0gbnVsbCAmJiBmbiA9PSBudWxsICkgewoJCQkJLy8gKCB0eXBlcywgZm4gKQoJCQkJZm4gPSBzZWxlY3RvcjsKCQkJCWRhdGEgPSBzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJfSBlbHNlIGlmICggZm4gPT0gbnVsbCApIHsKCQkJCWlmICggdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiApIHsKCQkJCQkvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKQoJCQkJCWZuID0gZGF0YTsKCQkJCQlkYXRhID0gdW5kZWZpbmVkOwoJCQkJfSBlbHNlIHsKCQkJCQkvLyAoIHR5cGVzLCBkYXRhLCBmbiApCgkJCQkJZm4gPSBkYXRhOwoJCQkJCWRhdGEgPSBzZWxlY3RvcjsKCQkJCQlzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJCX0KCQkJfQoJCQlpZiAoIGZuID09PSBmYWxzZSApIHsKCQkJCWZuID0gcmV0dXJuRmFsc2U7CgkJCX0gZWxzZSBpZiAoICFmbiApIHsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgoJCQlpZiAoIG9uZSA9PT0gMSApIHsKCQkJCW9yaWdGbiA9IGZuOwoJCQkJZm4gPSBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJLy8gQ2FuIHVzZSBhbiBlbXB0eSBzZXQsIHNpbmNlIGV2ZW50IGNvbnRhaW5zIHRoZSBpbmZvCgkJCQkJalF1ZXJ5KCkub2ZmKCBldmVudCApOwoJCQkJCXJldHVybiBvcmlnRm4uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJfTsKCQkJCS8vIFVzZSBzYW1lIGd1aWQgc28gY2FsbGVyIGNhbiByZW1vdmUgdXNpbmcgb3JpZ0ZuCgkJCQlmbi5ndWlkID0gb3JpZ0ZuLmd1aWQgfHwgKCBvcmlnRm4uZ3VpZCA9IGpRdWVyeS5ndWlkKysgKTsKCQkJfQoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsIHR5cGVzLCBmbiwgZGF0YSwgc2VsZWN0b3IgKTsKCQkJfSk7CgkJfSwKCQlvbmU6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgMSApOwoJCX0sCgkJb2ZmOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBmbiApIHsKCQkJdmFyIGhhbmRsZU9iaiwgdHlwZTsKCQkJaWYgKCB0eXBlcyAmJiB0eXBlcy5wcmV2ZW50RGVmYXVsdCAmJiB0eXBlcy5oYW5kbGVPYmogKSB7CgkJCQkvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50CgkJCQloYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CgkJCQlqUXVlcnkoIHR5cGVzLmRlbGVnYXRlVGFyZ2V0ICkub2ZmKAoJCQkJCWhhbmRsZU9iai5uYW1lc3BhY2UgPyBoYW5kbGVPYmoub3JpZ1R5cGUgKyAiLiIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDogaGFuZGxlT2JqLm9yaWdUeXBlLAoJCQkJCWhhbmRsZU9iai5zZWxlY3RvciwKCQkJCQloYW5kbGVPYmouaGFuZGxlcgoJCQkJKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCWlmICggdHlwZW9mIHR5cGVzID09PSAib2JqZWN0IiApIHsKCQkJCS8vICggdHlwZXMtb2JqZWN0IFssIHNlbGVjdG9yXSApCgkJCQlmb3IgKCB0eXBlIGluIHR5cGVzICkgewoJCQkJCXRoaXMub2ZmKCB0eXBlLCBzZWxlY3RvciwgdHlwZXNbIHR5cGUgXSApOwoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJCX0KCQkJaWYgKCBzZWxlY3RvciA9PT0gZmFsc2UgfHwgdHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iICkgewoJCQkJLy8gKCB0eXBlcyBbLCBmbl0gKQoJCQkJZm4gPSBzZWxlY3RvcjsKCQkJCXNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCQl9CgkJCWlmICggZm4gPT09IGZhbHNlICkgewoJCQkJZm4gPSByZXR1cm5GYWxzZTsKCQkJfQoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggdGhpcywgdHlwZXMsIGZuLCBzZWxlY3RvciApOwoJCQl9KTsKCQl9LAoKCQl0cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCB0aGlzICk7CgkJCX0pOwoJCX0sCgkJdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgZWxlbSA9IHRoaXNbMF07CgkJCWlmICggZWxlbSApIHsKCQkJCXJldHVybiBqUXVlcnkuZXZlbnQudHJpZ2dlciggdHlwZSwgZGF0YSwgZWxlbSwgdHJ1ZSApOwoJCQl9CgkJfQoJfSk7CgoKCWZ1bmN0aW9uIGNyZWF0ZVNhZmVGcmFnbWVudCggZG9jdW1lbnQgKSB7CgkJdmFyIGxpc3QgPSBub2RlTmFtZXMuc3BsaXQoICJ8IiApLAoJCQlzYWZlRnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKCgkJaWYgKCBzYWZlRnJhZy5jcmVhdGVFbGVtZW50ICkgewoJCQl3aGlsZSAoIGxpc3QubGVuZ3RoICkgewoJCQkJc2FmZUZyYWcuY3JlYXRlRWxlbWVudCgKCQkJCQlsaXN0LnBvcCgpCgkJCQkpOwoJCQl9CgkJfQoJCXJldHVybiBzYWZlRnJhZzsKCX0KCgl2YXIgbm9kZU5hbWVzID0gImFiYnJ8YXJ0aWNsZXxhc2lkZXxhdWRpb3xiZGl8Y2FudmFzfGRhdGF8ZGF0YWxpc3R8ZGV0YWlsc3xmaWdjYXB0aW9ufGZpZ3VyZXxmb290ZXJ8IiArCgkJCSJoZWFkZXJ8aGdyb3VwfG1hcmt8bWV0ZXJ8bmF2fG91dHB1dHxwcm9ncmVzc3xzZWN0aW9ufHN1bW1hcnl8dGltZXx2aWRlbyIsCgkJcmlubGluZWpRdWVyeSA9IC8galF1ZXJ5XGQrPSIoPzpudWxsfFxkKykiL2csCgkJcm5vc2hpbWNhY2hlID0gbmV3IFJlZ0V4cCgiPCg/OiIgKyBub2RlTmFtZXMgKyAiKVtcXHMvPl0iLCAiaQ==", "base64"));
  res.write(new Buffer("IiksCgkJcmxlYWRpbmdXaGl0ZXNwYWNlID0gL15ccysvLAoJCXJ4aHRtbFRhZyA9IC88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcdzpdKylbXj5dKilcLz4vZ2ksCgkJcnRhZ05hbWUgPSAvPChbXHc6XSspLywKCQlydGJvZHkgPSAvPHRib2R5L2ksCgkJcmh0bWwgPSAvPHwmIz9cdys7LywKCQlybm9Jbm5lcmh0bWwgPSAvPCg/OnNjcmlwdHxzdHlsZXxsaW5rKS9pLAoJCS8vIGNoZWNrZWQ9ImNoZWNrZWQiIG9yIGNoZWNrZWQKCQlyY2hlY2tlZCA9IC9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLAoJCXJzY3JpcHRUeXBlID0gL14kfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLAoJCXJzY3JpcHRUeXBlTWFza2VkID0gL150cnVlXC8oLiopLywKCQlyY2xlYW5TY3JpcHQgPSAvXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2csCgoJCS8vIFdlIGhhdmUgdG8gY2xvc2UgdGhlc2UgdGFncyB0byBzdXBwb3J0IFhIVE1MICgjMTMyMDApCgkJd3JhcE1hcCA9IHsKCQkJb3B0aW9uOiBbIDEsICI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+IiwgIjwvc2VsZWN0PiIgXSwKCQkJbGVnZW5kOiBbIDEsICI8ZmllbGRzZXQ+IiwgIjwvZmllbGRzZXQ+IiBdLAoJCQlhcmVhOiBbIDEsICI8bWFwPiIsICI8L21hcD4iIF0sCgkJCXBhcmFtOiBbIDEsICI8b2JqZWN0PiIsICI8L29iamVjdD4iIF0sCgkJCXRoZWFkOiBbIDEsICI8dGFibGU+IiwgIjwvdGFibGU+IiBdLAoJCQl0cjogWyAyLCAiPHRhYmxlPjx0Ym9keT4iLCAiPC90Ym9keT48L3RhYmxlPiIgXSwKCQkJY29sOiBbIDIsICI8dGFibGU+PHRib2R5PjwvdGJvZHk+PGNvbGdyb3VwPiIsICI8L2NvbGdyb3VwPjwvdGFibGU+IiBdLAoJCQl0ZDogWyAzLCAiPHRhYmxlPjx0Ym9keT48dHI+IiwgIjwvdHI+PC90Ym9keT48L3RhYmxlPiIgXSwKCgkJCS8vIElFNi04IGNhbid0IHNlcmlhbGl6ZSBsaW5rLCBzY3JpcHQsIHN0eWxlLCBvciBhbnkgaHRtbDUgKE5vU2NvcGUpIHRhZ3MsCgkJCS8vIHVubGVzcyB3cmFwcGVkIGluIGEgZGl2IHdpdGggbm9uLWJyZWFraW5nIGNoYXJhY3RlcnMgaW4gZnJvbnQgb2YgaXQuCgkJCV9kZWZhdWx0OiBzdXBwb3J0Lmh0bWxTZXJpYWxpemUgPyBbIDAsICIiLCAiIiBdIDogWyAxLCAiWDxkaXY+IiwgIjwvZGl2PiIgIF0KCQl9LAoJCXNhZmVGcmFnbWVudCA9IGNyZWF0ZVNhZmVGcmFnbWVudCggZG9jdW1lbnQgKSwKCQlmcmFnbWVudERpdiA9IHNhZmVGcmFnbWVudC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikgKTsKCgl3cmFwTWFwLm9wdGdyb3VwID0gd3JhcE1hcC5vcHRpb247Cgl3cmFwTWFwLnRib2R5ID0gd3JhcE1hcC50Zm9vdCA9IHdyYXBNYXAuY29sZ3JvdXAgPSB3cmFwTWFwLmNhcHRpb24gPSB3cmFwTWFwLnRoZWFkOwoJd3JhcE1hcC50aCA9IHdyYXBNYXAudGQ7CgoJZnVuY3Rpb24gZ2V0QWxsKCBjb250ZXh0LCB0YWcgKSB7CgkJdmFyIGVsZW1zLCBlbGVtLAoJCQlpID0gMCwKCQkJZm91bmQgPSB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gc3RydW5kZWZpbmVkID8gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggdGFnIHx8ICIqIiApIDoKCQkJCXR5cGVvZiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwgIT09IHN0cnVuZGVmaW5lZCA/IGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnIHx8ICIqIiApIDoKCQkJCXVuZGVmaW5lZDsKCgkJaWYgKCAhZm91bmQgKSB7CgkJCWZvciAoIGZvdW5kID0gW10sIGVsZW1zID0gY29udGV4dC5jaGlsZE5vZGVzIHx8IGNvbnRleHQ7IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJCWlmICggIXRhZyB8fCBqUXVlcnkubm9kZU5hbWUoIGVsZW0sIHRhZyApICkgewoJCQkJCWZvdW5kLnB1c2goIGVsZW0gKTsKCQkJCX0gZWxzZSB7CgkJCQkJalF1ZXJ5Lm1lcmdlKCBmb3VuZCwgZ2V0QWxsKCBlbGVtLCB0YWcgKSApOwoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gdGFnID09PSB1bmRlZmluZWQgfHwgdGFnICYmIGpRdWVyeS5ub2RlTmFtZSggY29udGV4dCwgdGFnICkgPwoJCQlqUXVlcnkubWVyZ2UoIFsgY29udGV4dCBdLCBmb3VuZCApIDoKCQkJZm91bmQ7Cgl9CgoJLy8gVXNlZCBpbiBidWlsZEZyYWdtZW50LCBmaXhlcyB0aGUgZGVmYXVsdENoZWNrZWQgcHJvcGVydHkKCWZ1bmN0aW9uIGZpeERlZmF1bHRDaGVja2VkKCBlbGVtICkgewoJCWlmICggcmNoZWNrYWJsZVR5cGUudGVzdCggZWxlbS50eXBlICkgKSB7CgkJCWVsZW0uZGVmYXVsdENoZWNrZWQgPSBlbGVtLmNoZWNrZWQ7CgkJfQoJfQoKCS8vIFN1cHBvcnQ6IElFPDgKCS8vIE1hbmlwdWxhdGluZyB0YWJsZXMgcmVxdWlyZXMgYSB0Ym9keQoJZnVuY3Rpb24gbWFuaXB1bGF0aW9uVGFyZ2V0KCBlbGVtLCBjb250ZW50ICkgewoJCXJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJ0YWJsZSIgKSAmJgoJCQlqUXVlcnkubm9kZU5hbWUoIGNvbnRlbnQubm9kZVR5cGUgIT09IDExID8gY29udGVudCA6IGNvbnRlbnQuZmlyc3RDaGlsZCwgInRyIiApID8KCgkJCWVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IilbMF0gfHwKCQkJCWVsZW0uYXBwZW5kQ2hpbGQoIGVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpICkgOgoJCQllbGVtOwoJfQoKCS8vIFJlcGxhY2UvcmVzdG9yZSB0aGUgdHlwZSBhdHRyaWJ1dGUgb2Ygc2NyaXB0IGVsZW1lbnRzIGZvciBzYWZlIERPTSBtYW5pcHVsYXRpb24KCWZ1bmN0aW9uIGRpc2FibGVTY3JpcHQoIGVsZW0gKSB7CgkJZWxlbS50eXBlID0gKGpRdWVyeS5maW5kLmF0dHIoIGVsZW0sICJ0eXBlIiApICE9PSBudWxsKSArICIvIiArIGVsZW0udHlwZTsKCQlyZXR1cm4gZWxlbTsKCX0KCWZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoIGVsZW0gKSB7CgkJdmFyIG1hdGNoID0gcnNjcmlwdFR5cGVNYXNrZWQuZXhlYyggZWxlbS50eXBlICk7CgkJaWYgKCBtYXRjaCApIHsKCQkJZWxlbS50eXBlID0gbWF0Y2hbMV07CgkJfSBlbHNlIHsKCQkJZWxlbS5yZW1vdmVBdHRyaWJ1dGUoInR5cGUiKTsKCQl9CgkJcmV0dXJuIGVsZW07Cgl9CgoJLy8gTWFyayBzY3JpcHRzIGFzIGhhdmluZyBhbHJlYWR5IGJlZW4gZXZhbHVhdGVkCglmdW5jdGlvbiBzZXRHbG9iYWxFdmFsKCBlbGVtcywgcmVmRWxlbWVudHMgKSB7CgkJdmFyIGVsZW0sCgkJCWkgPSAwOwoJCWZvciAoIDsgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkgewoJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJnbG9iYWxFdmFsIiwgIXJlZkVsZW1lbnRzIHx8IGpRdWVyeS5fZGF0YSggcmVmRWxlbWVudHNbaV0sICJnbG9iYWxFdmFsIiApICk7CgkJfQoJfQoKCWZ1bmN0aW9uIGNsb25lQ29weUV2ZW50KCBzcmMsIGRlc3QgKSB7CgoJCWlmICggZGVzdC5ub2RlVHlwZSAhPT0gMSB8fCAhalF1ZXJ5Lmhhc0RhdGEoIHNyYyApICkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgdHlwZSwgaSwgbCwKCQkJb2xkRGF0YSA9IGpRdWVyeS5fZGF0YSggc3JjICksCgkJCWN1ckRhdGEgPSBqUXVlcnkuX2RhdGEoIGRlc3QsIG9sZERhdGEgKSwKCQkJZXZlbnRzID0gb2xkRGF0YS5ldmVudHM7CgoJCWlmICggZXZlbnRzICkgewoJCQlkZWxldGUgY3VyRGF0YS5oYW5kbGU7CgkJCWN1ckRhdGEuZXZlbnRzID0ge307CgoJCQlmb3IgKCB0eXBlIGluIGV2ZW50cyApIHsKCQkJCWZvciAoIGkgPSAwLCBsID0gZXZlbnRzWyB0eXBlIF0ubGVuZ3RoOyBpIDwgbDsgaSsrICkgewoJCQkJCWpRdWVyeS5ldmVudC5hZGQoIGRlc3QsIHR5cGUsIGV2ZW50c1sgdHlwZSBdWyBpIF0gKTsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gbWFrZSB0aGUgY2xvbmVkIHB1YmxpYyBkYXRhIG9iamVjdCBhIGNvcHkgZnJvbSB0aGUgb3JpZ2luYWwKCQlpZiAoIGN1ckRhdGEuZGF0YSApIHsKCQkJY3VyRGF0YS5kYXRhID0galF1ZXJ5LmV4dGVuZCgge30sIGN1ckRhdGEuZGF0YSApOwoJCX0KCX0KCglmdW5jdGlvbiBmaXhDbG9uZU5vZGVJc3N1ZXMoIHNyYywgZGVzdCApIHsKCQl2YXIgbm9kZU5hbWUsIGUsIGRhdGE7CgoJCS8vIFdlIGRvIG5vdCBuZWVkIHRvIGRvIGFueXRoaW5nIGZvciBub24tRWxlbWVudHMKCQlpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgKSB7CgkJCXJldHVybjsKCQl9CgoJCW5vZGVOYW1lID0gZGVzdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoKCQkvLyBJRTYtOCBjb3BpZXMgZXZlbnRzIGJvdW5kIHZpYSBhdHRhY2hFdmVudCB3aGVuIHVzaW5nIGNsb25lTm9kZS4KCQlpZiAoICFzdXBwb3J0Lm5vQ2xvbmVFdmVudCAmJiBkZXN0WyBqUXVlcnkuZXhwYW5kbyBdICkgewoJCQlkYXRhID0galF1ZXJ5Ll9kYXRhKCBkZXN0ICk7CgoJCQlmb3IgKCBlIGluIGRhdGEuZXZlbnRzICkgewoJCQkJalF1ZXJ5LnJlbW92ZUV2ZW50KCBkZXN0LCBlLCBkYXRhLmhhbmRsZSApOwoJCQl9CgoJCQkvLyBFdmVudCBkYXRhIGdldHMgcmVmZXJlbmNlZCBpbnN0ZWFkIG9mIGNvcGllZCBpZiB0aGUgZXhwYW5kbyBnZXRzIGNvcGllZCB0b28KCQkJZGVzdC5yZW1vdmVBdHRyaWJ1dGUoIGpRdWVyeS5leHBhbmRvICk7CgkJfQoKCQkvLyBJRSBibGFua3MgY29udGVudHMgd2hlbiBjbG9uaW5nIHNjcmlwdHMsIGFuZCB0cmllcyB0byBldmFsdWF0ZSBuZXdseS1zZXQgdGV4dAoJCWlmICggbm9kZU5hbWUgPT09ICJzY3JpcHQiICYmIGRlc3QudGV4dCAhPT0gc3JjLnRleHQgKSB7CgkJCWRpc2FibGVTY3JpcHQoIGRlc3QgKS50ZXh0ID0gc3JjLnRleHQ7CgkJCXJlc3RvcmVTY3JpcHQoIGRlc3QgKTsKCgkJLy8gSUU2LTEwIGltcHJvcGVybHkgY2xvbmVzIGNoaWxkcmVuIG9mIG9iamVjdCBlbGVtZW50cyB1c2luZyBjbGFzc2lkLgoJCS8vIElFMTAgdGhyb3dzIE5vTW9kaWZpY2F0aW9uQWxsb3dlZEVycm9yIGlmIHBhcmVudCBpcyBudWxsLCAjMTIxMzIuCgkJfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJvYmplY3QiICkgewoJCQlpZiAoIGRlc3QucGFyZW50Tm9kZSApIHsKCQkJCWRlc3Qub3V0ZXJIVE1MID0gc3JjLm91dGVySFRNTDsKCQkJfQoKCQkJLy8gVGhpcyBwYXRoIGFwcGVhcnMgdW5hdm9pZGFibGUgZm9yIElFOS4gV2hlbiBjbG9uaW5nIGFuIG9iamVjdAoJCQkvLyBlbGVtZW50IGluIElFOSwgdGhlIG91dGVySFRNTCBzdHJhdGVneSBhYm92ZSBpcyBub3Qgc3VmZmljaWVudC4KCQkJLy8gSWYgdGhlIHNyYyBoYXMgaW5uZXJIVE1MIGFuZCB0aGUgZGVzdGluYXRpb24gZG9lcyBub3QsCgkJCS8vIGNvcHkgdGhlIHNyYy5pbm5lckhUTUwgaW50byB0aGUgZGVzdC5pbm5lckhUTUwuICMxMDMyNAoJCQlpZiAoIHN1cHBvcnQuaHRtbDVDbG9uZSAmJiAoIHNyYy5pbm5lckhUTUwgJiYgIWpRdWVyeS50cmltKGRlc3QuaW5uZXJIVE1MKSApICkgewoJCQkJZGVzdC5pbm5lckhUTUwgPSBzcmMuaW5uZXJIVE1MOwoJCQl9CgoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAiaW5wdXQiICYmIHJjaGVja2FibGVUeXBlLnRlc3QoIHNyYy50eXBlICkgKSB7CgkJCS8vIElFNi04IGZhaWxzIHRvIHBlcnNpc3QgdGhlIGNoZWNrZWQgc3RhdGUgb2YgYSBjbG9uZWQgY2hlY2tib3gKCQkJLy8gb3IgcmFkaW8gYnV0dG9uLiBXb3JzZSwgSUU2LTcgZmFpbCB0byBnaXZlIHRoZSBjbG9uZWQgZWxlbWVudAoJCQkvLyBhIGNoZWNrZWQgYXBwZWFyYW5jZSBpZiB0aGUgZGVmYXVsdENoZWNrZWQgdmFsdWUgaXNuJ3QgYWxzbyBzZXQKCgkJCWRlc3QuZGVmYXVsdENoZWNrZWQgPSBkZXN0LmNoZWNrZWQgPSBzcmMuY2hlY2tlZDsKCgkJCS8vIElFNi03IGdldCBjb25mdXNlZCBhbmQgZW5kIHVwIHNldHRpbmcgdGhlIHZhbHVlIG9mIGEgY2xvbmVkCgkJCS8vIGNoZWNrYm94L3JhZGlvIGJ1dHRvbiB0byBhbiBlbXB0eSBzdHJpbmcgaW5zdGVhZCBvZiAib24iCgkJCWlmICggZGVzdC52YWx1ZSAhPT0gc3JjLnZhbHVlICkgewoJCQkJZGVzdC52YWx1ZSA9IHNyYy52YWx1ZTsKCQkJfQoKCQkvLyBJRTYtOCBmYWlscyB0byByZXR1cm4gdGhlIHNlbGVjdGVkIG9wdGlvbiB0byB0aGUgZGVmYXVsdCBzZWxlY3RlZAoJCS8vIHN0YXRlIHdoZW4gY2xvbmluZyBvcHRpb25zCgkJfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJvcHRpb24iICkgewoJCQlkZXN0LmRlZmF1bHRTZWxlY3RlZCA9IGRlc3Quc2VsZWN0ZWQgPSBzcmMuZGVmYXVsdFNlbGVjdGVkOwoKCQkvLyBJRTYtOCBmYWlscyB0byBzZXQgdGhlIGRlZmF1bHRWYWx1ZSB0byB0aGUgY29ycmVjdCB2YWx1ZSB3aGVuCgkJLy8gY2xvbmluZyBvdGhlciB0eXBlcyBvZiBpbnB1dCBmaWVsZHMKCQl9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gImlucHV0IiB8fCBub2RlTmFtZSA9PT0gInRleHRhcmVhIiApIHsKCQkJZGVzdC5kZWZhdWx0VmFsdWUgPSBzcmMuZGVmYXVsdFZhbHVlOwoJCX0KCX0KCglqUXVlcnkuZXh0ZW5kKHsKCQljbG9uZTogZnVuY3Rpb24oIGVsZW0sIGRhdGFBbmRFdmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICkgewoJCQl2YXIgZGVzdEVsZW1lbnRzLCBub2RlLCBjbG9uZSwgaSwgc3JjRWxlbWVudHMsCgkJCQlpblBhZ2UgPSBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApOwoKCQkJaWYgKCBzdXBwb3J0Lmh0bWw1Q2xvbmUgfHwgalF1ZXJ5LmlzWE1MRG9jKGVsZW0pIHx8ICFybm9zaGltY2FjaGUudGVzdCggIjwiICsgZWxlbS5ub2RlTmFtZSArICI+IiApICkgewoJCQkJY2xvbmUgPSBlbGVtLmNsb25lTm9kZSggdHJ1ZSApOwoKCQkJLy8gSUU8PTggZG9lcyBub3QgcHJvcGVybHkgY2xvbmUgZGV0YWNoZWQsIHVua25vd24gZWxlbWVudCBub2RlcwoJCQl9IGVsc2UgewoJCQkJZnJhZ21lbnREaXYuaW5uZXJIVE1MID0gZWxlbS5vdXRlckhUTUw7CgkJCQlmcmFnbWVudERpdi5yZW1vdmVDaGlsZCggY2xvbmUgPSBmcmFnbWVudERpdi5maXJzdENoaWxkICk7CgkJCX0KCgkJCWlmICggKCFzdXBwb3J0Lm5vQ2xvbmVFdmVudCB8fCAhc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCkgJiYKCQkJCQkoZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBlbGVtLm5vZGVUeXBlID09PSAxMSkgJiYgIWpRdWVyeS5pc1hNTERvYyhlbGVtKSApIHsKCgkJCQkvLyBXZSBlc2NoZXcgU2l6emxlIGhlcmUgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnM6IGh0dHA6Ly9qc3BlcmYuY29tL2dldGFsbC12cy1zaXp6bGUvMgoJCQkJZGVzdEVsZW1lbnRzID0gZ2V0QWxsKCBjbG9uZSApOwoJCQkJc3JjRWxlbWVudHMgPSBnZXRBbGwoIGVsZW0gKTsKCgkJCQkvLyBGaXggYWxsIElFIGNsb25pbmcgaXNzdWVzCgkJCQlmb3IgKCBpID0gMDsgKG5vZGUgPSBzcmNFbGVtZW50c1tpXSkgIT0gbnVsbDsgKytpICkgewoJCQkJCS8vIEVuc3VyZSB0aGF0IHRoZSBkZXN0aW5hdGlvbiBub2RlIGlzIG5vdCBudWxsOyBGaXhlcyAjOTU4NwoJCQkJCWlmICggZGVzdEVsZW1lbnRzW2ldICkgewoJCQkJCQlmaXhDbG9uZU5vZGVJc3N1ZXMoIG5vZGUsIGRlc3RFbGVtZW50c1tpXSApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gQ29weSB0aGUgZXZlbnRzIGZyb20gdGhlIG9yaWdpbmFsIHRvIHRoZSBjbG9uZQoJCQlpZiAoIGRhdGFBbmRFdmVudHMgKSB7CgkJCQlpZiAoIGRlZXBEYXRhQW5kRXZlbnRzICkgewoJCQkJCXNyY0VsZW1lbnRzID0gc3JjRWxlbWVudHMgfHwgZ2V0QWxsKCBlbGVtICk7CgkJCQkJZGVzdEVsZW1lbnRzID0gZGVzdEVsZW1lbnRzIHx8IGdldEFsbCggY2xvbmUgKTsKCgkJCQkJZm9yICggaSA9IDA7IChub2RlID0gc3JjRWxlbWVudHNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJCQkJY2xvbmVDb3B5RXZlbnQoIG5vZGUsIGRlc3RFbGVtZW50c1tpXSApOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJY2xvbmVDb3B5RXZlbnQoIGVsZW0sIGNsb25lICk7CgkJCQl9CgkJCX0KCgkJCS8vIFByZXNlcnZlIHNjcmlwdCBldmFsdWF0aW9uIGhpc3RvcnkKCQkJZGVzdEVsZW1lbnRzID0gZ2V0QWxsKCBjbG9uZSwgInNjcmlwdCIgKTsKCQkJaWYgKCBkZXN0RWxlbWVudHMubGVuZ3RoID4gMCApIHsKCQkJCXNldEdsb2JhbEV2YWwoIGRlc3RFbGVtZW50cywgIWluUGFnZSAmJiBnZXRBbGwoIGVsZW0sICJzY3JpcHQiICkgKTsKCQkJfQoKCQkJZGVzdEVsZW1lbnRzID0gc3JjRWxlbWVudHMgPSBub2RlID0gbnVsbDsKCgkJCS8vIFJldHVybiB0aGUgY2xvbmVkIHNldAoJCQlyZXR1cm4gY2xvbmU7CgkJfSwKCgkJYnVpbGRGcmFnbWVudDogZnVuY3Rpb24oIGVsZW1zLCBjb250ZXh0LCBzY3JpcHRzLCBzZWxlY3Rpb24gKSB7CgkJCXZhciBqLCBlbGVtLCBjb250YWlucywKCQkJCXRtcCwgdGFnLCB0Ym9keSwgd3JhcCwKCQkJCWwgPSBlbGVtcy5sZW5ndGgsCgoJCQkJLy8gRW5zdXJlIGEgc2FmZSBmcmFnbWVudAoJCQkJc2FmZSA9IGNyZWF0ZVNhZmVGcmFnbWVudCggY29udGV4dCApLAoKCQkJCW5vZGVzID0gW10sCgkJCQlpID0gMDsKCgkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCWVsZW0gPSBlbGVtc1sgaSBdOwoKCQkJCWlmICggZWxlbSB8fCBlbGVtID09PSAwICkgewoKCQkJCQkvLyBBZGQgbm9kZXMgZGlyZWN0bHkKCQkJCQlpZiAoIGpRdWVyeS50eXBlKCBlbGVtICkgPT09ICJvYmplY3QiICkgewoJCQkJCQlqUXVlcnkubWVyZ2UoIG5vZGVzLCBlbGVtLm5vZGVUeXBlID8gWyBlbGVtIF0gOiBlbGVtICk7CgoJCQkJCS8vIENvbnZlcnQgbm9uLWh0bWwgaW50byBhIHRleHQgbm9kZQoJCQkJCX0gZWxzZSBpZiAoICFyaHRtbC50ZXN0KCBlbGVtICkgKSB7CgkJCQkJCW5vZGVzLnB1c2goIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIGVsZW0gKSApOwoKCQkJCQkvLyBDb252ZXJ0IGh0bWwgaW50byBET00gbm9kZXMKCQkJCQl9IGVsc2UgewoJCQkJCQl0bXAgPSB0bXAgfHwgc2FmZS5hcHBlbmRDaGlsZCggY29udGV4dC5jcmVhdGVFbGVtZW50KCJkaXYiKSApOwoKCQkJCQkJLy8gRGVzZXJpYWxpemUgYSBzdGFuZGFyZCByZXByZXNlbnRhdGlvbgoJCQkJCQl0YWcgPSAocnRhZ05hbWUuZXhlYyggZWxlbSApIHx8IFsgIiIsICIiIF0pWyAxIF0udG9Mb3dlckNhc2UoKTsKCQkJCQkJd3JhcCA9IHdyYXBNYXBbIHRhZyBdIHx8IHdyYXBNYXAuX2RlZmF1bHQ7CgoJCQkJCQl0bXAuaW5uZXJIVE1MID0gd3JhcFsxXSArIGVsZW0ucmVwbGFjZSggcnhodG1sVGFnLCAiPCQxPjwvJDI+IiApICsgd3JhcFsyXTsKCgkJCQkJCS8vIERlc2NlbmQgdGhyb3VnaCB3cmFwcGVycyB0byB0aGUgcmlnaHQgY29udGVudAoJCQkJCQlqID0gd3JhcFswXTsKCQkJCQkJd2hpbGUgKCBqLS0gKSB7CgkJCQkJCQl0bXAgPSB0bXAubGFzdENoaWxkOwoJCQkJCQl9CgoJCQkJCQkvLyBNYW51YWxseSBhZGQgbGVhZGluZyB3aGl0ZXNwYWNlIHJlbW92ZWQgYnkgSUUKCQkJCQkJaWYgKCAhc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZSAmJiBybGVhZGluZ1doaXRlc3BhY2UudGVzdCggZWxlbSApICkgewoJCQkJCQkJbm9kZXMucHVzaCggY29udGV4dC5jcmVhdGVUZXh0Tm9kZSggcmxlYWRpbmdXaGl0ZXNwYWNlLmV4ZWMoIGVsZW0gKVswXSApICk7CgkJCQkJCX0KCgkJCQkJCS8vIFJlbW92ZSBJRSdzIGF1dG9pbnNlcnRlZCA8dGJvZHk+IGZyb20gdGFibGUgZnJhZ21lbnRzCgkJCQkJCWlmICggIXN1cHBvcnQudGJvZHkgKSB7CgoJCQkJCQkJLy8gU3RyaW5nIHdhcyBhIDx0YWJsZT4sICptYXkqIGhhdmUgc3B1cmlvdXMgPHRib2R5PgoJCQkJCQkJZWxlbSA9IHRhZyA9PT0gInRhYmxlIiAmJiAhcnRib2R5LnRlc3QoIGVsZW0gKSA/CgkJCQkJCQkJdG1wLmZpcnN0Q2hpbGQgOgoKCQkJCQkJCQkvLyBTdHJpbmcgd2FzIGEgYmFyZSA8dGhlYWQ+IG9yIDx0Zm9vdD4KCQkJCQkJCQl3cmFwWzFdID09PSAiPHRhYmxlPiIgJiYgIXJ0Ym9keS50ZXN0KCBlbGVtICkgPwoJCQkJCQkJCQl0bXAgOgoJCQkJCQkJCQkwOwoKCQkJCQkJCWogPSBlbGVtICYmIGVsZW0uY2hpbGROb2Rlcy5sZW5ndGg7CgkJCQkJCQl3aGlsZSAoIGotLSApIHsKCQkJCQkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggKHRib2R5ID0gZWxlbS5jaGlsZE5vZGVzW2pdKSwgInRib2R5IiApICYmICF0Ym9keS5jaGlsZE5vZGVzLmxlbmd0aCApIHsKCQkJCQkJCQkJZWxlbS5yZW1vdmVDaGlsZCggdGJvZHkgKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCWpRdWVyeS5tZXJnZSggbm9kZXMsIHRtcC5jaGlsZE5vZGVzICk7CgoJCQkJCQkvLyBGaXggIzEyMzkyIGZvciBXZWJLaXQgYW5kIElFID4gOQoJCQkJCQl0bXAudGV4dENvbnRlbnQgPSAiIjsKCgkJCQkJCS8vIEZpeCAjMTIzOTIgZm9yIG9sZElFCgkJCQkJCXdoaWxlICggdG1wLmZpcnN0Q2hpbGQgKSB7CgkJCQkJCQl0bXAucmVtb3ZlQ2hpbGQoIHRtcC5maXJzdENoaWxkICk7CgkJCQkJCX0KCgkJCQkJCS8vIFJlbWVtYmVyIHRoZSB0b3AtbGV2ZWwgY29udGFpbmVyIGZvciBwcm9wZXIgY2xlYW51cAoJCQkJCQl0bXAgPSBzYWZlLmxhc3RDaGlsZDsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIEZpeCAjMTEzNTY6IENsZWFyIGVsZW1lbnRzIGZyb20gZnJhZ21lbnQKCQkJaWYgKCB0bXAgKSB7CgkJCQlzYWZlLnJlbW92ZUNoaWxkKCB0bXAgKTsKCQkJfQoKCQkJLy8gUmVzZXQgZGVmYXVsdENoZWNrZWQgZm9yIGFueSByYWRpb3MgYW5kIGNoZWNrYm94ZXMKCQkJLy8gYWJvdXQgdG8gYmUgYXBwZW5kZWQgdG8gdGhlIERPTSBpbiBJRSA2LzcgKCM4MDYwKQoJCQlpZiAoICFzdXBwb3J0LmFwcGVuZENoZWNrZWQgKSB7CgkJCQlqUXVlcnkuZ3JlcCggZ2V0QWxsKCBub2RlcywgImlucHV0IiApLCBmaXhEZWZhdWx0Q2hlY2tlZCApOwoJCQl9CgoJCQlpID0gMDsKCQkJd2hpbGUgKCAoZWxlbSA9IG5vZGVzWyBpKysgXSkgKSB7CgoJCQkJLy8gIzQwODcgLSBJZiBvcmlnaW4gYW5kIGRlc3RpbmF0aW9uIGVsZW1lbnRzIGFyZSB0aGUgc2FtZSwgYW5kIHRoaXMgaXMKCQkJCS8vIHRoYXQgZWxlbWVudCwgZG8gbm90IGRvIGFueXRoaW5nCgkJCQlpZiAoIHNlbGVjdGlvbiAmJiBqUXVlcnkuaW5BcnJheSggZWxlbSwgc2VsZWN0aW9uICkgIT09IC0xICkgewoJCQkJCWNvbnRpbnVlOwoJCQkJfQoKCQkJCWNvbnRhaW5zID0galF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCgkJCQkvLyBBcHBlbmQgdG8gZnJhZ21lbnQKCQkJCXRtcCA9IGdldEFsbCggc2FmZS5hcHBlbmRDaGlsZCggZWxlbSApLCAic2NyaXB0IiApOwoKCQkJCS8vIFByZXNlcnZlIHNjcmlwdCBldmFsdWF0aW9uIGhpc3RvcnkKCQkJCWlmICggY29udGFpbnMgKSB7CgkJCQkJc2V0R2xvYmFsRXZhbCggdG1wICk7CgkJCQl9CgoJCQkJLy8gQ2FwdHVyZSBleGVjdXRhYmxlcwoJCQkJaWYgKCBzY3JpcHRzICkgewoJCQkJCWogPSAwOwoJCQkJCXdoaWxlICggKGVsZW0gPSB0bXBbIGorKyBdKSApIHsKCQkJCQkJaWYgKCByc2NyaXB0VHlwZS50ZXN0KCBlbGVtLnR5cGUgfHwgIiIgKSApIHsKCQkJCQkJCXNjcmlwdHMucHVzaCggZWxlbSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQl0bXAgPSBudWxsOwoKCQkJcmV0dXJuIHNhZmU7CgkJfSwKCgkJY2xlYW5EYXRhOiBmdW5jdGlvbiggZWxlbXMsIC8qIGludGVybmFsICovIGFjY2VwdERhdGEgKSB7CgkJCXZhciBlbGVtLCB0eXBlLCBpZCwgZGF0YSwKCQkJCWkgPSAwLAoJCQkJaW50ZXJuYWxLZXkgPSBqUXVlcnkuZXhwYW5kbywKCQkJCWNhY2hlID0galF1ZXJ5LmNhY2hlLAoJCQkJZGVsZXRlRXhwYW5kbyA9IHN1cHBvcnQuZGVsZXRlRXhwYW5kbywKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbDsKCgkJCWZvciAoIDsgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkgewoJCQkJaWYgKCBhY2NlcHREYXRhIHx8IGpRdWVyeS5hY2NlcHREYXRhKCBlbGVtICkgKSB7CgoJCQkJCWlkID0gZWxlbVsgaW50ZXJuYWxLZXkgXTsKCQkJCQlkYXRhID0gaWQgJiYgY2FjaGVbIGlkIF07CgoJCQkJCWlmICggZGF0YSApIHsKCQkJCQkJaWYgKCBkYXRhLmV2ZW50cyApIHsKCQkJCQkJCWZvciAoIHR5cGUgaW4gZGF0YS5ldmVudHMgKSB7CgkJCQkJCQkJaWYgKCBzcGVjaWFsWyB0eXBlIF0gKSB7CgkJCQkJCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIGVsZW0sIHR5cGUgKTsKCgkJCQkJCQkJLy8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1vdmUncyBvdmVyaGVhZAoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUgKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIFJlbW92ZSBjYWNoZSBvbmx5IGlmIGl0IHdhcyBub3QgYWxyZWFkeSByZW1vdmVkIGJ5IGpRdWVyeS5ldmVudC5yZW1vdmUKCQkJCQkJaWYgKCBjYWNoZVsgaWQgXSApIHsKCgkJCQkJCQlkZWxldGUgY2FjaGVbIGlkIF07CgoJCQkJCQkJLy8gSUUgZG9lcyBub3QgYWxsb3cgdXMgdG8gZGVsZXRlIGV4cGFuZG8gcHJvcGVydGllcyBmcm9tIG5vZGVzLAoJCQkJCQkJLy8gbm9yIGRvZXMgaXQgaGF2ZSBhIHJlbW92ZUF0dHJpYnV0ZSBmdW5jdGlvbiBvbiBEb2N1bWVudCBub2RlczsKCQkJCQkJCS8vIHdlIG11c3QgaGFuZGxlIGFsbCBvZiB0aGVzZSBjYXNlcwoJCQkJCQkJaWYgKCBkZWxldGVFeHBhbmRvICkgewoJCQkJCQkJCWRlbGV0ZSBlbGVtWyBpbnRlcm5hbEtleSBdOwoKCQkJCQkJCX0gZWxzZSBpZiAoIHR5cGVvZiBlbGVtLnJlbW92ZUF0dHJpYnV0ZSAhPT0gc3RydW5kZWZpbmVkICkgewoJCQkJCQkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCBpbnRlcm5hbEtleSApOwoKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJZWxlbVsgaW50ZXJuYWxLZXkgXSA9IG51bGw7CgkJCQkJCQl9CgoJCQkJCQkJZGVsZXRlZElkcy5wdXNoKCBpZCApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfSk7CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJdGV4dDogZnVuY3Rpb24oIHZhbHVlICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQlyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/CgkJCQkJalF1ZXJ5LnRleHQoIHRoaXMgKSA6CgkJCQkJdGhpcy5lbXB0eSgpLmFwcGVuZCggKCB0aGlzWzBdICYmIHRoaXNbMF0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApLmNyZWF0ZVRleHROb2RlKCB2YWx1ZSApICk7CgkJCX0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoICk7CgkJfSwKCgkJYXBwZW5kOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHsKCQkJCQl2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KCB0aGlzLCBlbGVtICk7CgkJCQkJdGFyZ2V0LmFwcGVuZENoaWxkKCBlbGVtICk7CgkJCQl9CgkJCX0pOwoJCX0sCgoJCXByZXBlbmQ6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkgewoJCQkJCXZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTsKCQkJCQl0YXJnZXQuaW5zZXJ0QmVmb3JlKCBlbGVtLCB0YXJnZXQuZmlyc3RDaGlsZCApOwoJCQkJfQoJCQl9KTsKCQl9LAoKCQliZWZvcmU6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5wYXJlbnROb2RlICkgewoJCQkJCXRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMgKTsKCQkJCX0KCQkJfSk7CgkJfSwKCgkJYWZ0ZXI6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5wYXJlbnROb2RlICkgewoJCQkJCXRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMubmV4dFNpYmxpbmcgKTsKCQkJCX0KCQkJfSk7CgkJfSwKCgkJcmVtb3ZlOiBmdW5jdGlvbiggc2VsZWN0b3IsIGtlZXBEYXRhIC8qIEludGVybmFsIFVzZSBPbmx5ICovICkgewoJCQl2YXIgZWxlbSwKCQkJCWVsZW1zID0gc2VsZWN0b3IgPyBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgdGhpcyApIDogdGhpcywKCQkJCWkgPSAwOwoKCQkJZm9yICggOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7CgoJCQkJaWYgKCAha2VlcERhdGEgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQlqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIGVsZW0gKSApOwoJCQkJfQoKCQkJCWlmICggZWxlbS5wYXJlbnROb2RlICkgewoJCQkJCWlmICgga2VlcERhdGEgJiYgalF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKSApIHsKCQkJCQkJc2V0R2xvYmFsRXZhbCggZ2V0QWxsKCBlbGVtLCAic2NyaXB0IiApICk7CgkJCQkJfQoJCQkJCWVsZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggZWxlbSApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGhpczsKCQl9LAoKCQllbXB0eTogZnVuY3Rpb24oKSB7CgkJCXZhciBlbGVtLAoJCQkJaSA9IDA7CgoJCQlmb3IgKCA7IChlbGVtID0gdGhpc1tpXSkgIT0gbnVsbDsgaSsrICkgewoJCQkJLy8gUmVtb3ZlIGVsZW1lbnQgbm9kZXMgYW5kIHByZXZlbnQgbWVtb3J5IGxlYWtzCgkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGFueSByZW1haW5pbmcgbm9kZXMKCQkJCXdoaWxlICggZWxlbS5maXJzdENoaWxkICkgewoJCQkJCWVsZW0ucmVtb3ZlQ2hpbGQoIGVsZW0uZmlyc3RDaGlsZCApOwoJCQkJfQoKCQkJCS8vIElmIHRoaXMgaXMgYSBzZWxlY3QsIGVuc3VyZSB0aGF0IGl0IGRpc3BsYXlzIGVtcHR5ICgjMTIzMzYpCgkJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCQlpZiAoIGVsZW0ub3B0aW9ucyAmJiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJzZWxlY3QiICkgKSB7CgkJCQkJZWxlbS5vcHRpb25zLmxlbmd0aCA9IDA7CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCWNsb25lOiBmdW5jdGlvbiggZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJCWRhdGFBbmRFdmVudHMgPSBkYXRhQW5kRXZlbnRzID09IG51bGwgPyBmYWxzZSA6IGRhdGFBbmRFdmVudHM7CgkJCWRlZXBEYXRhQW5kRXZlbnRzID0gZGVlcERhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGRhdGFBbmRFdmVudHMgOiBkZWVwRGF0YUFuZEV2ZW50czsKCgkJCXJldHVybiB0aGlzLm1hcChmdW5jdGlvbigpIHsKCQkJCXJldHVybiBqUXVlcnkuY2xvbmUoIHRoaXMsIGRhdGFBbmRFdmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICk7CgkJCX0pOwoJCX0sCgoJCWh0bWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJdmFyIGVsZW0gPSB0aGlzWyAwIF0gfHwge30sCgkJCQkJaSA9IDAsCgkJCQkJbCA9IHRoaXMubGVuZ3RoOwoKCQkJCWlmICggdmFsdWUgPT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMSA/CgkJCQkJCWVsZW0uaW5uZXJIVE1MLnJlcGxhY2UoIHJpbmxpbmVqUXVlcnksICIiICkgOgoJCQkJCQl1bmRlZmluZWQ7CgkJCQl9CgoJCQkJLy8gU2VlIGlmIHdlIGNhbiB0YWtlIGEgc2hvcnRjdXQgYW5kIGp1c3QgdXNlIGlubmVySFRNTAoJCQkJaWYgKCB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmICFybm9Jbm5lcmh0bWwudGVzdCggdmFsdWUgKSAmJgoJCQkJCSggc3VwcG9ydC5odG1sU2VyaWFsaXplIHx8ICFybm9zaGltY2FjaGUudGVzdCggdmFsdWUgKSAgKSAmJgoJCQkJCSggc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZSB8fCAhcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoIHZhbHVlICkgKSAmJgoJCQkJCSF3cmFwTWFwWyAocnRhZ05hbWUuZXhlYyggdmFsdWUgKSB8fCBbICIiLCAiIiBdKVsgMSBdLnRvTG93ZXJDYXNlKCkgXSApIHsKCgkJCQkJdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCByeGh0bWxUYWcsICI8JDE+PC8kMj4iICk7CgoJCQkJCXRyeSB7CgkJCQkJCWZvciAoOyBpIDwgbDsgaSsrICkgewoJCQkJCQkJLy8gUmVtb3ZlIGVsZW1lbnQgbm9kZXMgYW5kIHByZXZlbnQgbWVtb3J5IGxlYWtzCgkJCQkJCQllbGVtID0gdGhpc1tpXSB8fCB7fTsKCQkJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQkJCQlqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIGVsZW0sIGZhbHNlICkgKTsKCQkJCQkJCQllbGVtLmlubmVySFRNTCA9IHZhbHVlOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQllbGVtID0gMDsKCgkJCQkJLy8gSWYgdXNpbmcgaW5uZXJIVE1MIHRocm93cyBhbiBleGNlcHRpb24sIHVzZSB0aGUgZmFsbGJhY2sgbWV0aG9kCgkJCQkJfSBjYXRjaChlKSB7fQoJCQkJfQoKCQkJCWlmICggZWxlbSApIHsKCQkJCQl0aGlzLmVtcHR5KCkuYXBwZW5kKCB2YWx1ZSApOwoJCQkJfQoJCQl9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCApOwoJCX0sCgoJCXJlcGxhY2VXaXRoOiBmdW5jdGlvbigpIHsKCQkJdmFyIGFyZyA9IGFyZ3VtZW50c1sgMCBdOwoKCQkJLy8gTWFrZSB0aGUgY2hhbmdlcywgcmVwbGFjaW5nIGVhY2ggY29udGV4dCBlbGVtZW50IHdpdGggdGhlIG5ldyBjb250ZW50CgkJCXRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlhcmcgPSB0aGlzLnBhcmVudE5vZGU7CgoJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCB0aGlzICkgKTsKCgkJCQlpZiAoIGFyZyApIHsKCQkJCQlhcmcucmVwbGFjZUNoaWxkKCBlbGVtLCB0aGlzICk7CgkJCQl9CgkJCX0pOwoKCQkJLy8gRm9yY2UgcmVtb3ZhbCBpZiB0aGVyZSB3YXMgbm8gbmV3IGNvbnRlbnQgKGUuZy4sIGZyb20gZW1wdHkgYXJndW1lbnRzKQoJCQlyZXR1cm4gYXJnICYmIChhcmcubGVuZ3RoIHx8IGFyZy5ub2RlVHlwZSkgPyB0aGlzIDogdGhpcy5yZW1vdmUoKTsKCQl9LAoKCQlkZXRhY2g6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMucmVtb3ZlKCBzZWxlY3RvciwgdHJ1ZSApOwoJCX0sCgoJCWRvbU1hbmlwOiBmdW5jdGlvbiggYXJncywgY2FsbGJhY2sgKSB7CgoJCQkvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCgkJCWFyZ3MgPSBjb25jYXQuYXBwbHkoIFtdLCBhcmdzICk7CgoJCQl2YXIgZmlyc3QsIG5vZGUsIGhhc1NjcmlwdHMsCgkJCQlzY3JpcHRzLCBkb2MsIGZyYWdtZW50LAoJCQkJaSA9IDAsCgkJCQlsID0gdGhpcy5sZW5ndGgsCgkJCQlzZXQgPSB0aGlzLAoJCQkJaU5vQ2xvbmUgPSBsIC0gMSwKCQkJCXZhbHVlID0gYXJnc1swXSwKCQkJCWlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTsKCgkJCS8vIFdlIGNhbid0IGNsb25lTm9kZSBmcmFnbWVudHMgdGhhdCBjb250YWluIGNoZWNrZWQsIGluIFdlYktpdAoJCQlpZiAoIGlzRnVuY3Rpb24gfHwKCQkJCQkoIGwgPiAxICYmIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYKCQkJCQkJIXN1cHBvcnQuY2hlY2tDbG9uZSAmJiByY2hlY2tlZC50ZXN0KCB2YWx1ZSApICkgKSB7CgkJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpbmRleCApIHsKCQkJCQl2YXIgc2VsZiA9IHNldC5lcSggaW5kZXggKTsKCQkJCQlpZiAoIGlzRnVuY3Rpb24gKSB7CgkJCQkJCWFyZ3NbMF0gPSB2YWx1ZS5jYWxsKCB0aGlzLCBpbmRleCwgc2VsZi5odG1sKCkgKTsKCQkJCQl9CgkJCQkJc2VsZi5kb21NYW5pcCggYXJncywgY2FsbGJhY2sgKTsKCQkJCX0pOwoJCQl9CgoJCQlpZiAoIGwgKSB7CgkJCQlmcmFnbWVudCA9IGpRdWVyeS5idWlsZEZyYWdtZW50KCBhcmdzLCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCwgZmFsc2UsIHRoaXMgKTsKCQkJCWZpcnN0ID0gZnJhZ21lbnQuZmlyc3RDaGlsZDsKCgkJCQlpZiAoIGZyYWdtZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICkgewoJCQkJCWZyYWdtZW50ID0gZmlyc3Q7CgkJCQl9CgoJCQkJaWYgKCBmaXJzdCApIHsKCQkJCQlzY3JpcHRzID0galF1ZXJ5Lm1hcCggZ2V0QWxsKCBmcmFnbWVudCwgInNjcmlwdCIgKSwgZGlzYWJsZVNjcmlwdCApOwoJCQkJCWhhc1NjcmlwdHMgPSBzY3JpcHRzLmxlbmd0aDsKCgkJCQkJLy8gVXNlIHRoZSBvcmlnaW5hbCBmcmFnbWVudCBmb3IgdGhlIGxhc3QgaXRlbSBpbnN0ZWFkIG9mIHRoZSBmaXJzdCBiZWNhdXNlIGl0IGNhbiBlbmQgdXAKCQkJCQkvLyBiZWluZyBlbXB0aWVkIGluY29ycmVjdGx5IGluIGNlcnRhaW4gc2l0dWF0aW9ucyAoIzgwNzApLgoJCQkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCQkJbm9kZSA9IGZyYWdtZW50OwoKCQkJCQkJaWYgKCBpICE9PSBpTm9DbG9uZSApIHsKCQkJCQkJCW5vZGUgPSBqUXVlcnkuY2xvbmUoIG5vZGUsIHRydWUsIHRydWUgKTsKCgkJCQkJCQkvLyBLZWVwIHJlZmVyZW5jZXMgdG8gY2xvbmVkIHNjcmlwdHMgZm9yIGxhdGVyIHJlc3RvcmF0aW9uCgkJCQkJCQlpZiAoIGhhc1NjcmlwdHMgKSB7CgkJCQkJCQkJalF1ZXJ5Lm1lcmdlKCBzY3JpcHRzLCBnZXRBbGwoIG5vZGUsICJzY3JpcHQiICkgKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJY2FsbGJhY2suY2FsbCggdGhpc1tpXSwgbm9kZSwgaSApOwoJCQkJCX0KCgkJCQkJaWYgKCBoYXNTY3JpcHRzICkgewoJCQkJCQlkb2MgPSBzY3JpcHRzWyBzY3JpcHRzLmxlbmd0aCAtIDEgXS5vd25lckRvY3VtZW50OwoKCQkJCQkJLy8gUmVlbmFibGUgc2NyaXB0cwoJCQkJCQlqUXVlcnkubWFwKCBzY3JpcHRzLCByZXN0b3JlU2NyaXB0ICk7CgoJCQkJCQkvLyBFdmFsdWF0ZSBleGVjdXRhYmxlIHNjcmlwdHMgb24gZmlyc3QgZG9jdW1lbnQgaW5zZXJ0aW9uCgkJCQkJCWZvciAoIGkgPSAwOyBpIDwgaGFzU2NyaXB0czsgaSsrICkgewoJCQkJCQkJbm9kZSA9IHNjcmlwdHNbIGkgXTsKCQkJCQkJCWlmICggcnNjcmlwdFR5cGUudGVzdCggbm9kZS50eXBlIHx8ICIiICkgJiYKCQkJCQkJCQkhalF1ZXJ5Ll9kYXRhKCBub2RlLCAiZ2xvYmFsRXZhbCIgKSAmJiBqUXVlcnkuY29udGFpbnMoIGRvYywgbm9kZSApICkgewoKCQkJCQkJCQlpZiAoIG5vZGUuc3JjICkgewoJCQkJCQkJCQkvLyBPcHRpb25hbCBBSkFYIGRlcGVuZGVuY3ksIGJ1dCB3b24ndCBydW4gc2NyaXB0cyBpZiBub3QgcHJlc2VudAoJCQkJCQkJCQlpZiAoIGpRdWVyeS5fZXZhbFVybCApIHsKCQkJCQkJCQkJCWpRdWVyeS5fZXZhbFVybCggbm9kZS5zcmMgKTsKCQkJCQkJCQkJfQoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCWpRdWVyeS5nbG9iYWxFdmFsKCAoIG5vZGUudGV4dCB8fCBub2RlLnRleHRDb250ZW50IHx8IG5vZGUuaW5uZXJIVE1MIHx8ICIiICkucmVwbGFjZSggcmNsZWFuU2NyaXB0LCAiIiApICk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBGaXggIzExODA5OiBBdm9pZCBsZWFraW5nIG1lbW9yeQoJCQkJCWZyYWdtZW50ID0gZmlyc3QgPSBudWxsOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGhpczsKCQl9Cgl9KTsKCglqUXVlcnkuZWFjaCh7CgkJYXBwZW5kVG86ICJhcHBlbmQiLAoJCXByZXBlbmRUbzogInByZXBlbmQiLAoJCWluc2VydEJlZm9yZTogImJlZm9yZSIsCgkJaW5zZXJ0QWZ0ZXI6ICJhZnRlciIsCgkJcmVwbGFjZUFsbDogInJlcGxhY2VXaXRoIgoJfSwgZnVuY3Rpb24oIG5hbWUsIG9yaWdpbmFsICkgewoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQl2YXIgZWxlbXMsCgkJCQlpID0gMCwKCQkJCXJldCA9IFtdLAoJCQkJaW5zZXJ0ID0galF1ZXJ5KCBzZWxlY3RvciApLAoJCQkJbGFzdCA9IGluc2VydC5sZW5ndGggLSAxOwoKCQkJZm9yICggOyBpIDw9IGxhc3Q7IGkrKyApIHsKCQkJCWVsZW1zID0gaSA9PT0gbGFzdCA/IHRoaXMgOiB0aGlzLmNsb25lKHRydWUpOwoJCQkJalF1ZXJ5KCBpbnNlcnRbaV0gKVsgb3JpZ2luYWwgXSggZWxlbXMgKTsKCgkJCQkvLyBNb2Rlcm4gYnJvd3NlcnMgY2FuIGFwcGx5IGpRdWVyeSBjb2xsZWN0aW9ucyBhcyBhcnJheXMsIGJ1dCBvbGRJRSBuZWVkcyBhIC5nZXQoKQoJCQkJcHVzaC5hcHBseSggcmV0LCBlbGVtcy5nZXQoKSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHJldCApOwoJCX07Cgl9KTsKCgoJdmFyIGlmcmFtZSwKCQllbGVtZGlzcGxheSA9IHt9OwoKCS8qKgoJICogUmV0cmlldmUgdGhlIGFjdHVhbCBkaXNwbGF5IG9mIGEgZWxlbWVudAoJICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgbm9kZU5hbWUgb2YgdGhlIGVsZW1lbnQKCSAqIEBwYXJhbSB7T2JqZWN0fSBkb2MgRG9jdW1lbnQgb2JqZWN0CgkgKi8KCS8vIENhbGxlZCBvbmx5IGZyb20gd2l0aGluIGRlZmF1bHREaXNwbGF5CglmdW5jdGlvbiBhY3R1YWxEaXNwbGF5KCBuYW1lLCBkb2MgKSB7CgkJdmFyIHN0eWxlLAoJCQllbGVtID0galF1ZXJ5KCBkb2MuY3JlYXRlRWxlbWVudCggbmFtZSApICkuYXBwZW5kVG8oIGRvYy5ib2R5ICksCgoJCQkvLyBnZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSBtaWdodCBiZSByZWxpYWJseSB1c2VkIG9ubHkgb24gYXR0YWNoZWQgZWxlbWVudAoJCQlkaXNwbGF5ID0gd2luZG93LmdldERlZmF1bHRDb21wdXRlZFN0eWxlICYmICggc3R5bGUgPSB3aW5kb3cuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUoIGVsZW1bIDAgXSApICkgPwoKCQkJCS8vIFVzZSBvZiB0aGlzIG1ldGhvZCBpcyBhIHRlbXBvcmFyeSBmaXggKG1vcmUgbGlrZSBvcHRtaXphdGlvbikgdW50aWwgc29tZXRoaW5nIGJldHRlciBjb21lcyBhbG9uZywKCQkJCS8vIHNpbmNlIGl0IHdhcyByZW1vdmVkIGZyb20gc3BlY2lmaWNhdGlvbiBhbmQgc3VwcG9ydGVkIG9ubHkgaW4gRkYKCQkJCXN0eWxlLmRpc3BsYXkgOiBqUXVlcnkuY3NzKCBlbGVtWyAwIF0sICJkaXNwbGF5IiApOwoKCQkvLyBXZSBkb24ndCBoYXZlIGFueSBkYXRhIHN0b3JlZCBvbiB0aGUgZWxlbWVudCwKCQkvLyBzbyB1c2UgImRldGFjaCIgbWV0aG9kIGFzIGZhc3Qgd2F5IHRvIGdldCByaWQgb2YgdGhlIGVsZW1lbnQKCQllbGVtLmRldGFjaCgpOwoKCQlyZXR1cm4gZGlzcGxheTsKCX0KCgkvKioKCSAqIFRyeSB0byBkZXRlcm1pbmUgdGhlIGRlZmF1bHQgZGlzcGxheSB2YWx1ZSBvZiBhbiBlbGVtZW50CgkgKiBAcGFyYW0ge1N0cmluZ30gbm9kZU5hbWUKCSAqLwoJZnVuY3Rpb24gZGVmYXVsdERpc3BsYXkoIG5vZGVOYW1lICkgewoJCXZhciBkb2MgPSBkb2N1bWVudCwKCQkJZGlzcGxheSA9IGVsZW1kaXNwbGF5WyBub2RlTmFtZSBdOwoKCQlpZiAoICFkaXNwbGF5ICkgewoJCQlkaXNwbGF5ID0gYWN0dWFsRGlzcGxheSggbm9kZU5hbWUsIGRvYyApOwoKCQkJLy8gSWYgdGhlIHNpbXBsZSB3YXkgZmFpbHMsIHJlYWQgZnJvbSBpbnNpZGUgYW4gaWZyYW1lCgkJCWlmICggZGlzcGxheSA9PT0gIm5vbmUiIHx8ICFkaXNwbGF5ICkgewoKCQkJCS8vIFVzZSB0aGUgYWxyZWFkeS1jcmVhdGVkIGlmcmFtZSBpZiBwb3NzaWJsZQoJCQkJaWZyYW1lID0gKGlmcmFtZSB8fCBqUXVlcnkoICI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+IiApKS5hcHBlbmRUbyggZG9jLmRvY3VtZW50RWxlbWVudCApOwoKCQkJCS8vIEFsd2F5cyB3cml0ZSBhIG5ldyBIVE1MIHNrZWxldG9uIHNvIFdlYmtpdCBhbmQgRmlyZWZveCBkb24ndCBjaG9rZSBvbiByZXVzZQoJCQkJZG9jID0gKCBpZnJhbWVbIDAgXS5jb250ZW50V2luZG93IHx8IGlmcmFtZVsgMCBdLmNvbnRlbnREb2N1bWVudCApLmRvY3VtZW50OwoKCQkJCS8vIFN1cHBvcnQ6IElFCgkJCQlkb2Mud3JpdGUoKTsKCQkJCWRvYy5jbG9zZSgpOwoKCQkJCWRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7CgkJCQlpZnJhbWUuZGV0YWNoKCk7CgkJCX0KCgkJCS8vIFN0b3JlIHRoZSBjb3JyZWN0IGRlZmF1bHQgZGlzcGxheQoJCQllbGVtZGlzcGxheVsgbm9kZU5hbWUgXSA9IGRpc3BsYXk7CgkJfQoKCQlyZXR1cm4gZGlzcGxheTsKCX0KCgoJKGZ1bmN0aW9uKCkgewoJCXZhciBzaHJpbmtXcmFwQmxvY2tzVmFsOwoKCQlzdXBwb3J0LnNocmlua1dyYXBCbG9ja3MgPSBmdW5jdGlvbigpIHsKCQkJaWYgKCBzaHJpbmtXcmFwQmxvY2tzVmFsICE9IG51bGwgKSB7CgkJCQlyZXR1cm4gc2hyaW5rV3JhcEJsb2Nrc1ZhbDsKCQkJfQoKCQkJLy8gV2lsbCBiZSBjaGFuZ2VkIGxhdGVyIGlmIG5lZWRlZC4KCQkJc2hyaW5rV3JhcEJsb2Nrc1ZhbCA9IGZhbHNlOwoKCQkJLy8gTWluaWZpZWQ6IHZhciBiLGMsZAoJCQl2YXIgZGl2LCBib2R5LCBjb250YWluZXI7CgoJCQlib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJib2R5IiApWyAwIF07CgkJCWlmICggIWJvZHkgfHwgIWJvZHkuc3R5bGUgKSB7CgkJCQkvLyBUZXN0IGZpcmVkIHRvbyBlYXJseSBvciBpbiBhbiB1bnN1cHBvcnRlZCBlbnZpcm9ubWVudCwgZXhpdC4KCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gU2V0dXAKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQkJY29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHgiOwoJCQlib2R5LmFwcGVuZENoaWxkKCBjb250YWluZXIgKS5hcHBlbmRDaGlsZCggZGl2ICk7CgoJCQkvLyBTdXBwb3J0OiBJRTYKCQkJLy8gQ2hlY2sgaWYgZWxlbWVudHMgd2l0aCBsYXlvdXQgc2hyaW5rLXdyYXAgdGhlaXIgY2hpbGRyZW4KCQkJaWYgKCB0eXBlb2YgZGl2LnN0eWxlLnpvb20gIT09IHN0cnVuZGVmaW5lZCApIHsKCQkJCS8vIFJlc2V0IENTUzogYm94LXNpemluZzsgZGlzcGxheTsgbWFyZ2luOyBib3JkZXIKCQkJCWRpdi5zdHlsZS5jc3NUZXh0ID0KCQkJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCQkJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCQkJCSItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94OyIgKwoJCQkJCSJib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7IiArCgkJCQkJInBhZGRpbmc6MXB4O3dpZHRoOjFweDt6b29tOjEiOwoJCQkJZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICkuc3R5bGUud2lkdGggPSAiNXB4IjsKCQkJCXNocmlua1dyYXBCbG9ja3NWYWwgPSBkaXYub2Zmc2V0V2lkdGggIT09IDM7CgkJCX0KCgkJCWJvZHkucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7CgkJfTsKCgl9KSgpOwoJdmFyIHJtYXJnaW4gPSAoL15tYXJnaW4vKTsKCgl2YXIgcm51bW5vbnB4ID0gbmV3IFJlZ0V4cCggIl4oIiArIHBudW0gKyAiKSg/IXB4KVthLXolXSskIiwgImkiICk7CgoKCgl2YXIgZ2V0U3R5bGVzLCBjdXJDU1MsCgkJcnBvc2l0aW9uID0gL14odG9wfHJpZ2h0fGJvdHRvbXxsZWZ0KSQvOwoKCWlmICggd2luZG93LmdldENvbXB1dGVkU3R5bGUgKSB7CgkJZ2V0U3R5bGVzID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCS8vIFN1cHBvcnQ6IElFPD0xMSssIEZpcmVmb3g8PTMwKyAoIzE1MDk4LCAjMTQxNTApCgkJCS8vIElFIHRocm93cyBvbiBlbGVtZW50cyBjcmVhdGVkIGluIHBvcHVwcwoJCQkvLyBGRiBtZWFud2hpbGUgdGhyb3dzIG9uIGZyYW1lIGVsZW1lbnRzIHRocm91Z2ggImRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUiCgkJCWlmICggZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3Lm9wZW5lciApIHsKCQkJCXJldHVybiBlbGVtLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbSwgbnVsbCApOwoJCQl9CgoJCQlyZXR1cm4gd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGVsZW0sIG51bGwgKTsKCQl9OwoKCQljdXJDU1MgPSBmdW5jdGlvbiggZWxlbSwgbmFtZSwgY29tcHV0ZWQgKSB7CgkJCXZhciB3aWR0aCwgbWluV2lkdGgsIG1heFdpZHRoLCByZXQsCgkJCQlzdHlsZSA9IGVsZW0uc3R5bGU7CgoJCQljb21wdXRlZCA9IGNvbXB1dGVkIHx8IGdldFN0eWxlcyggZWxlbSApOwoKCQkJLy8gZ2V0UHJvcGVydHlWYWx1ZSBpcyBvbmx5IG5lZWRlZCBmb3IgLmNzcygnZmlsdGVyJykgaW4gSUU5LCBzZWUgIzEyNTM3CgkJCXJldCA9IGNvbXB1dGVkID8gY29tcHV0ZWQuZ2V0UHJvcGVydHlWYWx1ZSggbmFtZSApIHx8IGNvbXB1dGVkWyBuYW1lIF0gOiB1bmRlZmluZWQ7CgoJCQlpZiAoIGNvbXB1dGVkICkgewoKCQkJCWlmICggcmV0ID09PSAiIiAmJiAhalF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKSApIHsKCQkJCQlyZXQgPSBqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUgKTsKCQkJCX0KCgkJCQkvLyBBIHRyaWJ1dGUgdG8gdGhlICJhd2Vzb21lIGhhY2sgYnkgRGVhbiBFZHdhcmRzIgoJCQkJLy8gQ2hyb21lIDwgMTcgYW5kIFNhZmFyaSA1LjAgdXNlcyAiY29tcHV0ZWQgdmFsdWUiIGluc3RlYWQgb2YgInVzZWQgdmFsdWUiIGZvciBtYXJnaW4tcmlnaHQKCQkJCS8vIFNhZmFyaSA1LjEuNyAoYXQgbGVhc3QpIHJldHVybnMgcGVyY2VudGFnZSBmb3IgYSBsYXJnZXIgc2V0IG9mIHZhbHVlcywgYnV0IHdpZHRoIHNlZW1zIHRvIGJlIHJlbGlhYmx5IHBpeGVscwoJCQkJLy8gdGhpcyBpcyBhZ2FpbnN0IHRoZSBDU1NPTSBkcmFmdCBzcGVjOiBodHRwOi8vZGV2LnczLm9yZy9jc3N3Zy9jc3NvbS8jcmVzb2x2ZWQtdmFsdWVzCgkJCQlpZiAoIHJudW1ub25weC50ZXN0KCByZXQgKSAmJiBybWFyZ2luLnRlc3QoIG5hbWUgKSApIHsKCgkJCQkJLy8gUmVtZW1iZXIgdGhlIG9yaWdpbmFsIHZhbHVlcwoJCQkJCXdpZHRoID0gc3R5bGUud2lkdGg7CgkJCQkJbWluV2lkdGggPSBzdHlsZS5taW5XaWR0aDsKCQkJCQltYXhXaWR0aCA9IHN0eWxlLm1heFdpZHRoOwoKCQkJCQkvLyBQdXQgaW4gdGhlIG5ldyB2YWx1ZXMgdG8gZ2V0IGEgY29tcHV0ZWQgdmFsdWUgb3V0CgkJCQkJc3R5bGUubWluV2lkdGggPSBzdHlsZS5tYXhXaWR0aCA9IHN0eWxlLndpZHRoID0gcmV0OwoJCQkJCXJldCA9IGNvbXB1dGVkLndpZHRoOwoKCQkJCQkvLyBSZXZlcnQgdGhlIGNoYW5nZWQgdmFsdWVzCgkJCQkJc3R5bGUud2lkdGggPSB3aWR0aDsKCQkJCQlzdHlsZS5taW5XaWR0aCA9IG1pbldpZHRoOwoJCQkJCXN0eWxlLm1heFdpZHRoID0gbWF4V2lkdGg7CgkJCQl9CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFCgkJCS8vIElFIHJldHVybnMgekluZGV4IHZhbHVlIGFzIGFuIGludGVnZXIuCgkJCXJldHVybiByZXQgPT09IHVuZGVmaW5lZCA/CgkJCQlyZXQgOgoJCQkJcmV0ICsgIiI7CgkJfTsKCX0gZWxzZSBpZiAoIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jdXJyZW50U3R5bGUgKSB7CgkJZ2V0U3R5bGVzID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBlbGVtLmN1cnJlbnRTdHlsZTsKCQl9OwoKCQljdXJDU1MgPSBmdW5jdGlvbiggZWxlbSwgbmFtZSwgY29tcHV0ZWQgKSB7CgkJCXZhciBsZWZ0LCBycywgcnNMZWZ0LCByZXQsCgkJCQlzdHlsZSA9IGVsZW0uc3R5bGU7CgoJCQljb21wdXRlZCA9IGNvbXB1dGVkIHx8IGdldFN0eWxlcyggZWxlbSApOwoJCQlyZXQgPSBjb21wdXRlZCA/IGNvbXB1dGVkWyBuYW1lIF0gOiB1bmRlZmluZWQ7CgoJCQkvLyBBdm9pZCBzZXR0aW5nIHJldCB0byBlbXB0eSBzdHJpbmcgaGVyZQoJCQkvLyBzbyB3ZSBkb24ndCBkZWZhdWx0IHRvIGF1dG8KCQkJaWYgKCByZXQgPT0gbnVsbCAmJiBzdHlsZSAmJiBzdHlsZVsgbmFtZSBdICkgewoJCQkJcmV0ID0gc3R5bGVbIG5hbWUgXTsKCQkJfQoKCQkJLy8gRnJvbSB0aGUgYXdlc29tZSBoYWNrIGJ5IERlYW4gRWR3YXJkcwoJCQkvLyBodHRwOi8vZXJpay5lYWUubmV0L2FyY2hpdmVzLzIwMDcvMDcvMjcvMTguNTQuMTUvI2NvbW1lbnQtMTAyMjkxCgoJCQkvLyBJZiB3ZSdyZSBub3QgZGVhbGluZyB3aXRoIGEgcmVndWxhciBwaXhlbCBudW1iZXIKCQkJLy8gYnV0IGEgbnVtYmVyIHRoYXQgaGFzIGEgd2VpcmQgZW5kaW5nLCB3ZSBuZWVkIHRvIGNvbnZlcnQgaXQgdG8gcGl4ZWxzCgkJCS8vIGJ1dCBub3QgcG9zaXRpb24gY3NzIGF0dHJpYnV0ZXMsIGFzIHRob3NlIGFyZSBwcm9wb3J0aW9uYWwgdG8gdGhlIHBhcmVudCBlbGVtZW50IGluc3RlYWQKCQkJLy8gYW5kIHdlIGNhbid0IG1lYXN1cmUgdGhlIHBhcmVudCBpbnN0ZWFkIGJlY2F1c2UgaXQgbWlnaHQgdHJpZ2dlciBhICJzdGFja2luZyBkb2xscyIgcHJvYmxlbQoJCQlpZiAoIHJudW1ub25weC50ZXN0KCByZXQgKSAmJiAhcnBvc2l0aW9uLnRlc3QoIG5hbWUgKSApIHsKCgkJCQkvLyBSZW1lbWJlciB0aGUgb3JpZ2luYWwgdmFsdWVzCgkJCQlsZWZ0ID0gc3R5bGUubGVmdDsKCQkJCXJzID0gZWxlbS5ydW50aW1lU3R5bGU7CgkJCQlyc0xlZnQgPSBycyAmJiBycy5sZWZ0OwoKCQkJCS8vIFB1dCBpbiB0aGUgbmV3IHZhbHVlcyB0byBnZXQgYSBjb21wdXRlZCB2YWx1ZSBvdXQKCQkJCWlmICggcnNMZWZ0ICkgewoJCQkJCXJzLmxlZnQgPSBlbGVtLmN1cnJlbnRTdHlsZS5sZWZ0OwoJCQkJfQoJCQkJc3R5bGUubGVmdCA9IG5hbWUgPT09ICJmb250U2l6ZSIgPyAiMWVtIiA6IHJldDsKCQkJCXJldCA9IHN0eWxlLnBpeGVsTGVmdCArICJweCI7CgoJCQkJLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwoJCQkJc3R5bGUubGVmdCA9IGxlZnQ7CgkJCQlpZiAoIHJzTGVmdCApIHsKCQkJCQlycy5sZWZ0ID0gcnNMZWZ0OwoJCQkJfQoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBJRSByZXR1cm5zIHpJbmRleCB2YWx1ZSBhcyBhbiBpbnRlZ2VyLgoJCQlyZXR1cm4gcmV0ID09PSB1bmRlZmluZWQgPwoJCQkJcmV0IDoKCQkJCXJldCArICIiIHx8ICJhdXRvIjsKCQl9OwoJfQoKCgoKCWZ1bmN0aW9uIGFkZEdldEhvb2tJZiggY29uZGl0aW9uRm4sIGhvb2tGbiApIHsKCQkvLyBEZWZpbmUgdGhlIGhvb2ssIHdlJ2xsIGNoZWNrIG9uIHRoZSBmaXJzdCBydW4gaWYgaXQncyByZWFsbHkgbmVlZGVkLgoJCXJldHVybiB7CgkJCWdldDogZnVuY3Rpb24oKSB7CgkJCQl2YXIgY29uZGl0aW9uID0gY29uZGl0aW9uRm4oKTsKCgkJCQlpZiAoIGNvbmRpdGlvbiA9PSBudWxsICkgewoJCQkJCS8vIFRoZSB0ZXN0IHdhcyBub3QgcmVhZHkgYXQgdGhpcyBwb2ludDsgc2NyZXcgdGhlIGhvb2sgdGhpcyB0aW1lCgkJCQkJLy8gYnV0IGNoZWNrIGFnYWluIHdoZW4gbmVlZGVkIG5leHQgdGltZS4KCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJaWYgKCBjb25kaXRpb24gKSB7CgkJCQkJLy8gSG9vayBub3QgbmVlZGVkIChvciBpdCdzIG5vdCBwb3NzaWJsZSB0byB1c2UgaXQgZHVlIHRvIG1pc3NpbmcgZGVwZW5kZW5jeSksCgkJCQkJLy8gcmVtb3ZlIGl0LgoJCQkJCS8vIFNpbmNlIHRoZXJlIGFyZSBubyBvdGhlciBob29rcyBmb3IgbWFyZ2luUmlnaHQsIHJlbW92ZSB0aGUgd2hvbGUgb2JqZWN0LgoJCQkJCWRlbGV0ZSB0aGlzLmdldDsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gSG9vayBuZWVkZWQ7IHJlZGVmaW5lIGl0IHNvIHRoYXQgdGhlIHN1cHBvcnQgdGVzdCBpcyBub3QgZXhlY3V0ZWQgYWdhaW4uCgoJCQkJcmV0dXJuICh0aGlzLmdldCA9IGhvb2tGbikuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQl9CgkJfTsKCX0KCgoJKGZ1bmN0aW9uKCkgewoJCS8vIE1pbmlmaWVkOiB2YXIgYixjLGQsZSxmLGcsIGgsaQoJCXZhciBkaXYsIHN0eWxlLCBhLCBwaXhlbFBvc2l0aW9uVmFsLCBib3hTaXppbmdSZWxpYWJsZVZhbCwKCQkJcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsLCByZWxpYWJsZU1hcmdpblJpZ2h0VmFsOwoKCQkvLyBTZXR1cAoJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJZGl2LmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iOwoJCWEgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJhIiApWyAwIF07CgkJc3R5bGUgPSBhICYmIGEuc3R5bGU7CgoJCS8vIEZpbmlzaCBlYXJseSBpbiBsaW1pdGVkIChub24tYnJvd3NlcikgZW52aXJvbm1lbnRzCgkJaWYgKCAhc3R5bGUgKSB7CgkJCXJldHVybjsKCQl9CgoJCXN0eWxlLmNzc1RleHQgPSAiZmxvYXQ6bGVmdDtvcGFjaXR5Oi41IjsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCS8vIE1ha2Ugc3VyZSB0aGF0IGVsZW1lbnQgb3BhY2l0eSBleGlzdHMgKGFzIG9wcG9zZWQgdG8gZmlsdGVyKQoJCXN1cHBvcnQub3BhY2l0eSA9IHN0eWxlLm9wYWNpdHkgPT09ICIwLjUiOwoKCQkvLyBWZXJpZnkgc3R5bGUgZmxvYXQgZXhpc3RlbmNlCgkJLy8gKElFIHVzZXMgc3R5bGVGbG9hdCBpbnN0ZWFkIG9mIGNzc0Zsb2F0KQoJCXN1cHBvcnQuY3NzRmxvYXQgPSAhIXN0eWxlLmNzc0Zsb2F0OwoKCQlkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSAiY29udGVudC1ib3giOwoJCWRpdi5jbG9uZU5vZGUoIHRydWUgKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICIiOwoJCXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlID0gZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwID09PSAiY29udGVudC1ib3giOwoKCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCXN1cHBvcnQuYm94U2l6aW5nID0gc3R5bGUuYm94U2l6aW5nID09PSAiIiB8fCBzdHlsZS5Nb3pCb3hTaXppbmcgPT09ICIiIHx8CgkJCXN0eWxlLldlYmtpdEJveFNpemluZyA9PT0gIiI7CgoJCWpRdWVyeS5leHRlbmQoc3VwcG9ydCwgewoJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHM6IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHJlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbDsKCQkJfSwKCgkJCWJveFNpemluZ1JlbGlhYmxlOiBmdW5jdGlvbigpIHsKCQkJCWlmICggYm94U2l6aW5nUmVsaWFibGVWYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIGJveFNpemluZ1JlbGlhYmxlVmFsOwoJCQl9LAoKCQkJcGl4ZWxQb3NpdGlvbjogZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHBpeGVsUG9zaXRpb25WYWw7CgkJCX0sCgoJCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDIuMwoJCQlyZWxpYWJsZU1hcmdpblJpZ2h0OiBmdW5jdGlvbigpIHsKCQkJCWlmICggcmVsaWFibGVNYXJnaW5SaWdodFZhbCA9PSBudWxsICkgewoJCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCQl9CgkJCQlyZXR1cm4gcmVsaWFibGVNYXJnaW5SaWdodFZhbDsKCQkJfQoJCX0pOwoKCQlmdW5jdGlvbiBjb21wdXRlU3R5bGVUZXN0cygpIHsKCQkJLy8gTWluaWZpZWQ6IHZhciBiLGMsZCxqCgkJCXZhciBkaXYsIGJvZHksIGNvbnRhaW5lciwgY29udGVudHM7CgoJCQlib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJib2R5IiApWyAwIF07CgkJCWlmICggIWJvZHkgfHwgIWJvZHkuc3R5bGUgKSB7CgkJCQkvLyBUZXN0IGZpcmVkIHRvbyBlYXJseSBvciBpbiBhbiB1bnN1cHBvcnRlZCBlbnZpcm9ubWVudCwgZXhpdC4KCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gU2V0dXAKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQkJY29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHgiOwoJCQlib2R5LmFwcGVuZENoaWxkKCBjb250YWluZXIgKS5hcHBlbmRDaGlsZCggZGl2ICk7CgoJCQlkaXYuc3R5bGUuY3NzVGV4dCA9CgkJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCQkJLy8gVmVuZG9yLXByZWZpeCBib3gtc2l6aW5nCgkJCQkiLXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7IiArCgkJCQkiYm94LXNpemluZzpib3JkZXItYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luLXRvcDoxJTt0b3A6MSU7IiArCgkJCQkiYm9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo0cHg7cG9zaXRpb246YWJzb2x1dGUiOwoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBBc3N1bWUgcmVhc29uYWJsZSB2YWx1ZXMgaW4gdGhlIGFic2VuY2Ugb2YgZ2V0Q29tcHV0ZWRTdHlsZQoJCQlwaXhlbFBvc2l0aW9uVmFsID0gYm94U2l6aW5nUmVsaWFibGVWYWwgPSBmYWxzZTsKCQkJcmVsaWFibGVNYXJnaW5SaWdodFZhbCA9IHRydWU7CgoJCQkvLyBDaGVjayBmb3IgZ2V0Q29tcHV0ZWRTdHlsZSBzbyB0aGF0IHRoaXMgY29kZSBpcyBub3QgcnVuIGluIElFPDkuCgkJCWlmICggd2luZG93LmdldENvbXB1dGVkU3R5bGUgKSB7CgkJCQlwaXhlbFBvc2l0aW9uVmFsID0gKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZGl2LCBudWxsICkgfHwge30gKS50b3AgIT09ICIxJSI7CgkJCQlib3hTaXppbmdSZWxpYWJsZVZhbCA9CgkJCQkJKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZGl2LCBudWxsICkgfHwgeyB3aWR0aDogIjRweCIgfSApLndpZHRoID09PSAiNHB4IjsKCgkJCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDIuMwoJCQkJLy8gRGl2IHdpdGggZXhwbGljaXQgd2lkdGggYW5kIG5vIG1hcmdpbi1yaWdodCBpbmNvcnJlY3RseQoJCQkJLy8gZ2V0cyBjb21wdXRlZCBtYXJnaW4tcmlnaHQgYmFzZWQgb24gd2lkdGggb2YgY29udGFpbmVyICgjMzMzMykKCQkJCS8vIFdlYktpdCBCdWcgMTMzNDMgLSBnZXRDb21wdXRlZFN0eWxlIHJldHVybnMgd3JvbmcgdmFsdWUgZm9yIG1hcmdpbi1yaWdodAoJCQkJY29udGVudHMgPSBkaXYuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICkgKTsKCgkJCQkvLyBSZXNldCBDU1M6IGJveC1zaXppbmc7IGRpc3BsYXk7IG1hcmdpbjsgYm9yZGVyOyBwYWRkaW5nCgkJCQljb250ZW50cy5zdHlsZS5jc3NUZXh0ID0gZGl2LnN0eWxlLmNzc1RleHQgPQoJCQkJCS8vIFN1cHBvcnQ6IEZpcmVmb3g8MjksIEFuZHJvaWQgMi4zCgkJCQkJLy8gVmVuZG9yLXByZWZpeCBib3gtc2l6aW5nCgkJCQkJIi13ZWJraXQtYm94LXNpemluZzpjb250ZW50LWJveDstbW96LWJveC1zaXppbmc6Y29udGVudC1ib3g7IiArCgkJCQkJImJveC1zaXppbmc6Y29udGVudC1ib3g7ZGlzcGxheTpibG9jazttYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjAiOwoJCQkJY29udGVudHMuc3R5bGUubWFyZ2luUmlnaHQgPSBjb250ZW50cy5zdHlsZS53aWR0aCA9ICIwIjsKCQkJCWRpdi5zdHlsZS53aWR0aCA9ICIxcHgiOwoKCQkJCXJlbGlhYmxlTWFyZ2luUmlnaHRWYWwgPQoJCQkJCSFwYXJzZUZsb2F0KCAoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBjb250ZW50cywgbnVsbCApIHx8IHt9ICkubWFyZ2luUmlnaHQgKTsKCgkJCQlkaXYucmVtb3ZlQ2hpbGQoIGNvbnRlbnRzICk7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFOAoJCQkvLyBDaGVjayBpZiB0YWJsZSBjZWxscyBzdGlsbCBoYXZlIG9mZnNldFdpZHRoL0hlaWdodCB3aGVuIHRoZXkgYXJlIHNldAoJCQkvLyB0byBkaXNwbGF5Om5vbmUgYW5kIHRoZXJlIGFyZSBzdGlsbCBvdGhlciB2aXNpYmxlIHRhYmxlIGNlbGxzIGluIGEKCQkJLy8gdGFibGUgcm93OyBpZiBzbywgb2Zmc2V0V2lkdGgvSGVpZ2h0IGFyZSBub3QgcmVsaWFibGUgZm9yIHVzZSB3aGVuCgkJCS8vIGRldGVybWluaW5nIGlmIGFuIGVsZW1lbnQgaGFzIGJlZW4gaGlkZGVuIGRpcmVjdGx5IHVzaW5nCgkJCS8vIGRpc3BsYXk6bm9uZSAoaXQgaXMgc3RpbGwgc2FmZSB0byB1c2Ugb2Zmc2V0cyBpZiBhIHBhcmVudCBlbGVtZW50IGlzCgkJCS8vIGhpZGRlbjsgZG9uIHNhZmV0eSBnb2dnbGVzIGFuZCBzZWUgYnVnICM0NTEyIGZvciBtb3JlIGluZm9ybWF0aW9uKS4KCQkJZGl2LmlubmVySFRNTCA9ICI8dGFibGU+PHRyPjx0ZD48L3RkPjx0ZD50PC90ZD48L3RyPjwvdGFibGU+IjsKCQkJY29udGVudHMgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJ0ZCIgKTsKCQkJY29udGVudHNbIDAgXS5zdHlsZS5jc3NUZXh0ID0gIm1hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MDtkaXNwbGF5Om5vbmUiOwoJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPSBjb250ZW50c1sgMCBdLm9mZnNldEhlaWdodCA9PT0gMDsKCQkJaWYgKCByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgKSB7CgkJCQljb250ZW50c1sgMCBdLnN0eWxlLmRpc3BsYXkgPSAiIjsKCQkJCWNvbnRlbnRzWyAxIF0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCXJlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbCA9IGNvbnRlbnRzWyAwIF0ub2Zmc2V0SGVpZ2h0ID09PSAwOwoJCQl9CgoJCQlib2R5LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCQl9CgoJfSkoKTsKCgoJLy8gQSBtZXRob2QgZm9yIHF1aWNrbHkgc3dhcHBpbmcgaW4vb3V0IENTUyBwcm9wZXJ0aWVzIHRvIGdldCBjb3JyZWN0IGNhbGN1bGF0aW9ucy4KCWpRdWVyeS5zd2FwID0gZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGNhbGxiYWNrLCBhcmdzICkgewoJCXZhciByZXQsIG5hbWUsCgkJCW9sZCA9IHt9OwoKCQkvLyBSZW1lbWJlciB0aGUgb2xkIHZhbHVlcywgYW5kIGluc2VydCB0aGUgbmV3IG9uZXMKCQlmb3IgKCBuYW1lIGluIG9wdGlvbnMgKSB7CgkJCW9sZFsgbmFtZSBdID0gZWxlbS5zdHlsZVsgbmFtZSBdOwoJCQllbGVtLnN0eWxlWyBuYW1lIF0gPSBvcHRpb25zWyBuYW1lIF07CgkJfQoKCQlyZXQgPSBjYWxsYmFjay5hcHBseSggZWxlbSwgYXJncyB8fCBbXSApOwoKCQkvLyBSZXZlcnQgdGhlIG9sZCB2YWx1ZXMKCQlmb3IgKCBuYW1lIGluIG9wdGlvbnMgKSB7CgkJCWVsZW0uc3R5bGVbIG5hbWUgXSA9IG9sZFsgbmFtZSBdOwoJCX0KCgkJcmV0dXJuIHJldDsKCX07CgoKCXZhcgoJCQlyYWxwaGEgPSAvYWxwaGFcKFteKV0qXCkvaSwKCQlyb3BhY2l0eSA9IC9vcGFjaXR5XHMqPVxzKihbXildKikvLAoKCQkvLyBzd2FwcGFibGUgaWYgZGlzcGxheSBpcyBub25lIG9yIHN0YXJ0cyB3aXRoIHRhYmxlIGV4Y2VwdCAidGFibGUiLCAidGFibGUtY2VsbCIsIG9yICJ0YWJsZS1jYXB0aW9uIgoJCS8vIHNlZSBoZXJlIGZvciBkaXNwbGF5IHZhbHVlczogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9DU1MvZGlzcGxheQoJCXJkaXNwbGF5c3dhcCA9IC9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLywKCQlybnVtc3BsaXQgPSBuZXcgUmVnRXhwKCAiXigiICsgcG51bSArICIpKC4qKSQiLCAiaSIgKSwKCQlycmVsTnVtID0gbmV3IFJlZ0V4cCggIl4oWystXSk9KCIgKyBwbnVtICsgIikiLCAiaSIgKSwKCgkJY3NzU2hvdyA9IHsgcG9zaXRpb246ICJhYnNvbHV0ZSIsIHZpc2liaWxpdHk6ICJoaWRkZW4iLCBkaXNwbGF5OiAiYmxvY2siIH0sCgkJY3NzTm9ybWFsVHJhbnNmb3JtID0gewoJCQlsZXR0ZXJTcGFjaW5nOiAiMCIsCgkJCWZvbnRXZWlnaHQ6ICI0MDAiCgkJfSwKCgkJY3NzUHJlZml4ZXMgPSBbICJXZWJraXQiLCAiTyIsICJNb3oiLCAibXMiIF07CgoKCS8vIHJldHVybiBhIGNzcyBwcm9wZXJ0eSBtYXBwZWQgdG8gYSBwb3RlbnRpYWxseSB2ZW5kb3IgcHJlZml4ZWQgcHJvcGVydHkKCWZ1bmN0aW9uIHZlbmRvclByb3BOYW1lKCBzdHlsZSwgbmFtZSApIHsKCgkJLy8gc2hvcnRjdXQgZm9yIG5hbWVzIHRoYXQgYXJlIG5vdCB2ZW5kb3IgcHJlZml4ZWQKCQlpZiAoIG5hbWUgaW4gc3R5bGUgKSB7CgkJCXJldHVybiBuYW1lOwoJCX0KCgkJLy8gY2hlY2sgZm9yIHZlbmRvciBwcmVmaXhlZCBuYW1lcwoJCXZhciBjYXBOYW1lID0gbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSksCgkJCW9yaWdOYW1lID0gbmFtZSwKCQkJaSA9IGNzc1ByZWZpeGVzLmxlbmd0aDsKCgkJd2hpbGUgKCBpLS0gKSB7CgkJCW5hbWUgPSBjc3NQcmVmaXhlc1sgaSBdICsgY2FwTmFtZTsKCQkJaWYgKCBuYW1lIGluIHN0eWxlICkgewoJCQkJcmV0dXJuIG5hbWU7CgkJCX0KCQl9CgoJCXJldHVybiBvcmlnTmFtZTsKCX0KCglmdW5jdGlvbiBzaG93SGlkZSggZWxlbWVudHMsIHNob3cgKSB7CgkJdmFyIGRpc3BsYXksIGVsZW0sIGhpZGRlbiwKCQkJdmFsdWVzID0gW10sCgkJCWluZGV4ID0gMCwKCQkJbGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQllbGVtID0gZWxlbWVudHNbIGluZGV4IF07CgkJCWlmICggIWVsZW0uc3R5bGUgKSB7CgkJCQljb250aW51ZTsKCQkJfQoKCQkJdmFsdWVzWyBpbmRleCBdID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xkZGlzcGxheSIgKTsKCQkJZGlzcGxheSA9IGVsZW0uc3R5bGUuZGlzcGxheTsKCQkJaWYgKCBzaG93ICkgewoJCQkJLy8gUmVzZXQgdGhlIGlubGluZSBkaXNwbGF5IG9mIHRoaXMgZWxlbWVudCB0byBsZWFybiBpZiBpdCBpcwoJCQkJLy8gYmVpbmcgaGlkZGVuIGJ5IGNhc2NhZGVkIHJ1bGVzIG9yIG5vdAoJCQkJaWYgKCAhdmFsdWVzWyBpbmRleCBdICYmIGRpc3BsYXkgPT09ICJub25lIiApIHsKCQkJCQllbGVtLnN0eWxlLmRpc3BsYXkgPSAiIjsKCQkJCX0KCgkJCQkvLyBTZXQgZWxlbWVudHMgd2hpY2ggaGF2ZSBiZWVuIG92ZXJyaWRkZW4gd2l0aCBkaXNwbGF5OiBub25lCgkJCQkvLyBpbiBhIHN0eWxlc2hlZXQgdG8gd2hhdGV2ZXIgdGhlIGRlZmF1bHQgYnJvd3NlciBzdHlsZSBpcwoJCQkJLy8gZm9yIHN1Y2ggYW4gZWxlbWVudAoJCQkJaWYgKCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09ICIiICYmIGlzSGlkZGVuKCBlbGVtICkgKSB7CgkJCQkJdmFsdWVzWyBpbmRleCBdID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xkZGlzcGxheSIsIGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpICk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQloaWRkZW4gPSBpc0hpZGRlbiggZWxlbSApOwoKCQkJCWlmICggZGlzcGxheSAmJiBkaXNwbGF5ICE9PSAibm9uZSIgfHwgIWhpZGRlbiApIHsKCQkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJvbGRkaXNwbGF5IiwgaGlkZGVuID8gZGlzcGxheSA6IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApICk7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIFNldCB0aGUgZGlzcGxheSBvZiBtb3N0IG9mIHRoZSBlbGVtZW50cyBpbiBhIHNlY29uZCBsb29wCgkJLy8gdG8gYXZvaWQgdGhlIGNvbnN0YW50IHJlZmxvdwoJCWZvciAoIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KysgKSB7CgkJCWVsZW0gPSBlbGVtZW50c1sgaW5kZXggXTsKCQkJaWYgKCAhZWxlbS5zdHlsZSApIHsKCQkJCWNvbnRpbnVlOwoJCQl9CgkJCWlmICggIXNob3cgfHwgZWxlbS5zdHlsZS5kaXNwbGF5ID09PSAibm9uZSIgfHwgZWxlbS5zdHlsZS5kaXNwbGF5ID09PSAiIiApIHsKCQkJCWVsZW0uc3R5bGUuZGlzcGxheSA9IHNob3cgPyB2YWx1ZXNbIGluZGV4IF0gfHwgIiIgOiAibm9uZSI7CgkJCX0KCQl9CgoJCXJldHVybiBlbGVtZW50czsKCX0KCglmdW5jdGlvbiBzZXRQb3NpdGl2ZU51bWJlciggZWxlbSwgdmFsdWUsIHN1YnRyYWN0ICkgewoJCXZhciBtYXRjaGVzID0gcm51bXNwbGl0LmV4ZWMoIHZhbHVlICk7CgkJcmV0dXJuIG1hdGNoZXMgPwoJCQkvLyBHdWFyZCBhZ2FpbnN0IHVuZGVmaW5lZCAic3VidHJhY3QiLCBlLmcuLCB3aGVuIHVzZWQgYXMgaW4gY3NzSG9va3MKCQkJTWF0aC5tYXgoIDAsIG1hdGNoZXNbIDEgXSAtICggc3VidHJhY3QgfHwgMCApICkgKyAoIG1hdGNoZXNbIDIgXSB8fCAicHgiICkgOgoJCQl2YWx1ZTsKCX0KCglmdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEsIGlzQm9yZGVyQm94LCBzdHlsZXMgKSB7CgkJdmFyIGkgPSBleHRyYSA9PT0gKCBpc0JvcmRlckJveCA/ICJib3JkZXIiIDogImNvbnRlbnQiICkgPwoJCQkvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgdGhlIHJpZ2h0IG1lYXN1cmVtZW50LCBhdm9pZCBhdWdtZW50YXRpb24KCQkJNCA6CgkJCS8vIE90aGVyd2lzZSBpbml0aWFsaXplIGZvciBob3Jpem9udGFsIG9yIHZlcnRpY2FsIHByb3BlcnRpZXMKCQkJbmFtZSA9PT0gIndpZHRoIiA/IDEgOiAwLAoKCQkJdmFsID0gMDsKCgkJZm9yICggOyBpIDwgNDsgaSArPSAyICkgewoJCQkvLyBib3RoIGJveCBtb2RlbHMgZXhjbHVkZSBtYXJnaW4sIHNvIGFkZCBpdCBpZiB3ZSB3YW50IGl0CgkJCWlmICggZXh0cmEgPT09ICJtYXJnaW4iICkgewoJCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sIGV4dHJhICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApOwoJCQl9CgoJCQlpZiAoIGlzQm9yZGVyQm94ICkgewoJCQkJLy8gYm9yZGVyLWJveCBpbmNsdWRlcyBwYWRkaW5nLCBzbyByZW1vdmUgaXQgaWYgd2Ugd2FudCBjb250ZW50CgkJCQlpZiAoIGV4dHJhID09PSAiY29udGVudCIgKSB7CgkJCQkJdmFsIC09IGpRdWVyeS5jc3MoIGVsZW0sICJwYWRkaW5nIiArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTsKCQkJCX0KCgkJCQkvLyBhdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBib3JkZXIgbm9yIG1hcmdpbiwgc28gcmVtb3ZlIGJvcmRlcgoJCQkJaWYgKCBleHRyYSAhPT0gIm1hcmdpbiIgKSB7CgkJCQkJdmFsIC09IGpRdWVyeS5jc3MoIGVsZW0sICJib3JkZXIiICsgY3NzRXhwYW5kWyBpIF0gKyAiV2lkdGgiLCB0cnVlLCBzdHlsZXMgKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCS8vIGF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQsIHNvIGFkZCBwYWRkaW5nCgkJCQl2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgInBhZGRpbmciICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApOwoKCQkJCS8vIGF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQgbm9yIHBhZGRpbmcsIHNvIGFkZCBib3JkZXIKCQkJCWlmICggZXh0cmEgIT09ICJwYWRkaW5nIiApIHsKCQkJCQl2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgImJvcmRlciIgKyBjc3NFeHBhbmRbIGkgXSArICJXaWR0aCIsIHRydWUsIHN0eWxlcyApOwoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gdmFsOwoJfQoKCWZ1bmN0aW9uIGdldFdpZHRoT3JIZWlnaHQoIGVsZW0sIG5hbWUsIGV4dHJhICkgewoKCQkvLyBTdGFydCB3aXRoIG9mZnNldCBwcm9wZXJ0eSwgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgYm9yZGVyLWJveCB2YWx1ZQoJCXZhciB2YWx1ZUlzQm9yZGVyQm94ID0gdHJ1ZSwKCQkJdmFsID0gbmFtZSA9PT0gIndpZHRoIiA/IGVsZW0ub2Zmc2V0V2lkdGggOiBlbGVtLm9mZnNldEhlaWdodCwKCQkJc3R5bGVzID0gZ2V0U3R5bGVzKCBlbGVtICksCgkJCWlzQm9yZGVyQm94ID0gc3VwcG9ydC5ib3hTaXppbmcgJiYgalF1ZXJ5LmNzcyggZWxlbSwgImJveFNpemluZyIsIGZhbHNlLCBzdHlsZXMgKSA9PT0gImJvcmRlci1ib3giOwoKCQkvLyBzb21lIG5vbi1odG1sIGVsZW1lbnRzIHJldHVybiB1bmRlZmluZWQgZm9yIG9mZnNldFdpZHRoLCBzbyBjaGVjayBmb3IgbnVsbC91bmRlZmluZWQKCQkvLyBzdmcgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDkyODUKCQkvLyBNYXRoTUwgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD00OTE2NjgKCQlpZiAoIHZhbCA8PSAwIHx8IHZhbCA9PSBudWxsICkgewoJCQkvLyBGYWxsIGJhY2sgdG8gY29tcHV0ZWQgdGhlbiB1bmNvbXB1dGVkIGNzcyBpZiBuZWNlc3NhcnkKCQkJdmFsID0gY3VyQ1NTKCBlbGVtLCBuYW1lLCBzdHlsZXMgKTsKCQkJaWYgKCB2YWwgPCAwIHx8IHZhbCA9PSBudWxsICkgewoJCQkJdmFsID0gZWxlbS5zdHlsZVsgbmFtZSBdOwoJCQl9CgoJCQkvLyBDb21wdXRlZCB1bml0IGlzIG5vdCBwaXhlbHMuIFN0b3AgaGVyZSBhbmQgcmV0dXJuLgoJCQlpZiAoIHJudW1ub25weC50ZXN0KHZhbCkgKSB7CgkJCQlyZXR1cm4gdmFsOwoJCQl9CgoJCQkvLyB3ZSBuZWVkIHRoZSBjaGVjayBmb3Igc3R5bGUgaW4gY2FzZSBhIGJyb3dzZXIgd2hpY2ggcmV0dXJucyB1bnJlbGlhYmxlIHZhbHVlcwoJCQkvLyBmb3IgZ2V0Q29tcHV0ZWRTdHlsZSBzaWxlbnRseSBmYWxscyBiYWNrIHRvIHRoZSByZWxpYWJsZSBlbGVtLnN0eWxlCgkJCXZhbHVlSXNCb3JkZXJCb3ggPSBpc0JvcmRlckJveCAmJiAoIHN1cHBvcnQuYm94U2l6aW5nUmVsaWFibGUoKSB8fCB2YWwgPT09IGVsZW0uc3R5bGVbIG5hbWUgXSApOwoKCQkJLy8gTm9ybWFsaXplICIiLCBhdXRvLCBhbmQgcHJlcGFyZSBmb3IgZXh0cmEKCQkJdmFsID0gcGFyc2VGbG9hdCggdmFsICkgfHwgMDsKCQl9CgoJCS8vIHVzZSB0aGUgYWN0aXZlIGJveC1zaXppbmcgbW9kZWwgdG8gYWRkL3N1YnRyYWN0IGlycmVsZXZhbnQgc3R5bGVzCgkJcmV0dXJuICggdmFsICsKCQkJYXVnbWVudFdpZHRoT3JIZWlnaHQoCgkJCQllbGVtLAoJCQkJbmFtZSwKCQkJCWV4dHJhIHx8ICggaXNCb3JkZXJCb3ggPyAiYm9yZGVyIiA6ICJjb250ZW50IiApLAoJCQkJdmFsdWVJc0JvcmRlckJveCwKCQkJCXN0eWxlcwoJCQkpCgkJKSArICJweCI7Cgl9CgoJalF1ZXJ5LmV4dGVuZCh7CgkJLy8gQWRkIGluIHN0eWxlIHByb3BlcnR5IGhvb2tzIGZvciBvdmVycmlkaW5nIHRoZSBkZWZhdWx0CgkJLy8gYmVoYXZpb3Igb2YgZ2V0dGluZyBhbmQgc2V0dGluZyBhIHN0eWxlIHByb3BlcnR5CgkJY3NzSG9va3M6IHsKCQkJb3BhY2l0eTogewoJCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7CgkJCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCQkJLy8gV2Ugc2hvdWxkIGFsd2F5cyBnZXQgYSBudW1iZXIgYmFjayBmcm9tIG9wYWNpdHkKCQkJCQkJdmFyIHJldCA9IGN1ckNTUyggZWxlbSwgIm9wYWNpdHkiICk7CgkJCQkJCXJldHVybiByZXQgPT09ICIiID8gIjEiIDogcmV0OwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0sCgoJCS8vIERvbid0IGF1dG9tYXRpY2FsbHkgYWRkICJweCIgdG8gdGhlc2UgcG9zc2libHktdW5pdGxlc3MgcHJvcGVydGllcwoJCWNzc051bWJlcjogewoJCQkiY29sdW1uQ291bnQiOiB0cnVlLAoJCQkiZmlsbE9wYWNpdHkiOiB0cnVlLAoJCQkiZmxleEdyb3ciOiB0cnVlLAoJCQkiZmxleFNocmluayI6IHRydWUsCgkJCSJmb250V2VpZ2h0IjogdHJ1ZSwKCQkJImxpbmVIZWlnaHQiOiB0cnVlLAoJCQkib3BhY2l0eSI6IHRydWUsCgkJCSJvcmRlciI6IHRydWUsCgkJCSJvcnBoYW5zIjogdHJ1ZSwKCQkJIndpZG93cyI6IHRydWUsCgkJCSJ6SW5kZXgiOiB0cnVlLAoJCQkiem9vbSI6IHRydWUKCQl9LAoKCQkvLyBBZGQgaW4gcHJvcGVydGllcyB3aG9zZSBuYW1lcyB5b3Ugd2lzaCB0byBmaXggYmVmb3JlCgkJLy8gc2V0dGluZyBvciBnZXR0aW5nIHRoZSB2YWx1ZQoJCWNzc1Byb3BzOiB7CgkJCS8vIG5vcm1hbGl6ZSBmbG9hdCBjc3MgcHJvcGVydHkKCQkJImZsb2F0Ijogc3VwcG9ydC5jc3NGbG9hdCA/ICJjc3NGbG9hdCIgOiAic3R5bGVGbG9hdCIKCQl9LAoKCQkvLyBHZXQgYW5kIHNldCB0aGUgc3R5bGUgcHJvcGVydHkgb24gYSBET00gTm9kZQoJCXN0eWxlOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUsIGV4dHJhICkgewoJCQkvLyBEb24ndCBzZXQgc3R5bGVzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQkJaWYgKCAhZWxlbSB8fCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwgIWVsZW0uc3R5bGUgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCQl2YXIgcmV0LCB0eXBlLCBob29rcywKCQkJCW9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApLAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJbmFtZSA9IGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fCAoIGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSA9IHZlbmRvclByb3BOYW1lKCBzdHlsZSwgb3JpZ05hbWUgKSApOwoKCQkJLy8gZ2V0cyBob29rIGZvciB0aGUgcHJlZml4ZWQgdmVyc2lvbgoJCQkvLyBmb2xsb3dlZCBieSB0aGUgdW5wcmVmaXhlZCB2ZXJzaW9uCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdOwoKCQkJLy8gQ2hlY2sgaWYgd2UncmUgc2V0dGluZyBhIHZhbHVlCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCXR5cGUgPSB0eXBlb2YgdmFsdWU7CgoJCQkJLy8gY29udmVydCByZWxhdGl2ZSBudW1iZXIgc3RyaW5ncyAoKz0gb3IgLT0pIHRvIHJlbGF0aXZlIG51bWJlcnMuICM3MzQ1CgkJCQlpZiAoIHR5cGUgPT09ICJzdHJpbmciICYmIChyZXQgPSBycmVsTnVtLmV4ZWMoIHZhbHVlICkpICkgewoJCQkJCXZhbHVlID0gKCByZXRbMV0gKyAxICkgKiByZXRbMl0gKyBwYXJzZUZsb2F0KCBqUXVlcnkuY3NzKCBlbGVtLCBuYW1lICkgKTsKCQkJCQkvLyBGaXhlcyBidWcgIzkyMzcKCQkJCQl0eXBlID0gIm51bWJlciI7CgkJCQl9CgoJCQkJLy8gTWFrZSBzdXJlIHRoYXQgbnVsbCBhbmQgTmFOIHZhbHVlcyBhcmVuJ3Qgc2V0LiBTZWU6ICM3MTE2CgkJCQlpZiAoIHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlICkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQkvLyBJZiBhIG51bWJlciB3YXMgcGFzc2VkIGluLCBhZGQgJ3B4JyB0byB0aGUgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcykKCQkJCWlmICggdHlwZSA9PT0gIm51bWJlciIgJiYgIWpRdWVyeS5jc3NOdW1iZXJbIG9yaWdOYW1lIF0gKSB7CgkJCQkJdmFsdWUgKz0gInB4IjsKCQkJCX0KCgkJCQkvLyBGaXhlcyAjODkwOCwgaXQgY2FuIGJlIGRvbmUgbW9yZSBjb3JyZWN0bHkgYnkgc3BlY2lmaW5nIHNldHRlcnMgaW4gY3NzSG9va3MsCgkJCQkvLyBidXQgaXQgd291bGQgbWVhbiB0byBkZWZpbmUgZWlnaHQgKGZvciBldmVyeSBwcm9ibGVtYXRpYyBwcm9wZXJ0eSkgaWRlbnRpY2FsIGZ1bmN0aW9ucwoJCQkJaWYgKCAhc3VwcG9ydC5jbGVhckNsb25lU3R5bGUgJiYgdmFsdWUgPT09ICIiICYmIG5hbWUuaW5kZXhPZigiYmFja2dyb3VuZCIpID09PSAwICkgewoJCQkJCXN0eWxlWyBuYW1lIF0gPSAiaW5oZXJpdCI7CgkJCQl9CgoJCQkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCwgdXNlIHRoYXQgdmFsdWUsIG90aGVyd2lzZSBqdXN0IHNldCB0aGUgc3BlY2lmaWVkIHZhbHVlCgkJCQlpZiAoICFob29rcyB8fCAhKCJzZXQiIGluIGhvb2tzKSB8fCAodmFsdWUgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBleHRyYSApKSAhPT0gdW5kZWZpbmVkICkgewoKCQkJCQkvLyBTdXBwb3J0OiBJRQoJCQkJCS8vIFN3YWxsb3cgZXJyb3JzIGZyb20gJ2ludmFsaWQnIENTUyB2YWx1ZXMgKCM1NTA5KQoJCQkJCXRyeSB7CgkJCQkJCXN0eWxlWyBuYW1lIF0gPSB2YWx1ZTsKCQkJCQl9IGNhdGNoKGUpIHt9CgkJCQl9CgoJCQl9IGVsc2UgewoJCQkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIG5vbi1jb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlCgkJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIGZhbHNlLCBleHRyYSApKSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiByZXQ7CgkJCQl9CgoJCQkJLy8gT3RoZXJ3aXNlIGp1c3QgZ2V0IHRoZSB2YWx1ZSBmcm9tIHRoZSBzdHlsZSBvYmplY3QKCQkJCXJldHVybiBzdHlsZVsgbmFtZSBdOwoJCQl9CgkJfSwKCgkJY3NzOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZXh0cmEsIHN0eWxlcyApIHsKCQkJdmFyIG51bSwgdmFsLCBob29rcywKCQkJCW9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApOwoKCQkJLy8gTWFrZSBzdXJlIHRoYXQgd2UncmUgd29ya2luZyB3aXRoIHRoZSByaWdodCBuYW1lCgkJCW5hbWUgPSBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gfHwgKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggZWxlbS5zdHlsZSwgb3JpZ05hbWUgKSApOwoKCQkJLy8gZ2V0cyBob29rIGZvciB0aGUgcHJlZml4ZWQgdmVyc2lvbgoJCQkvLyBmb2xsb3dlZCBieSB0aGUgdW5wcmVmaXhlZCB2ZXJzaW9uCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdOwoKCQkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmUKCQkJaWYgKCBob29rcyAmJiAiZ2V0IiBpbiBob29rcyApIHsKCQkJCXZhbCA9IGhvb2tzLmdldCggZWxlbSwgdHJ1ZSwgZXh0cmEgKTsKCQkJfQoKCQkJLy8gT3RoZXJ3aXNlLCBpZiBhIHdheSB0byBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGV4aXN0cywgdXNlIHRoYXQKCQkJaWYgKCB2YWwgPT09IHVuZGVmaW5lZCApIHsKCQkJCXZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7CgkJCX0KCgkJCS8vY29udmVydCAibm9ybWFsIiB0byBjb21wdXRlZCB2YWx1ZQoJCQlpZiAoIHZhbCA9PT0gIm5vcm1hbCIgJiYgbmFtZSBpbiBjc3NOb3JtYWxUcmFuc2Zvcm0gKSB7CgkJCQl2YWwgPSBjc3NOb3JtYWxUcmFuc2Zvcm1bIG5hbWUgXTsKCQkJfQoKCQkJLy8gUmV0dXJuLCBjb252ZXJ0aW5nIHRvIG51bWJlciBpZiBmb3JjZWQgb3IgYSBxdWFsaWZpZXIgd2FzIHByb3ZpZGVkIGFuZCB2YWwgbG9va3MgbnVtZXJpYwoJCQlpZiAoIGV4dHJhID09PSAiIiB8fCBleHRyYSApIHsKCQkJCW51bSA9IHBhcnNlRmxvYXQoIHZhbCApOwoJCQkJcmV0dXJuIGV4dHJhID09PSB0cnVlIHx8IGpRdWVyeS5pc051bWVyaWMoIG51bSApID8gbnVtIHx8IDAgOiB2YWw7CgkJCX0KCQkJcmV0dXJuIHZhbDsKCQl9Cgl9KTsKCglqUXVlcnkuZWFjaChbICJoZWlnaHQiLCAid2lkdGgiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoJCWpRdWVyeS5jc3NIb29rc1sgbmFtZSBdID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCwgZXh0cmEgKSB7CgkJCQlpZiAoIGNvbXB1dGVkICkgewoJCQkJCS8vIGNlcnRhaW4gZWxlbWVudHMgY2FuIGhhdmUgZGltZW5zaW9uIGluZm8gaWYgd2UgaW52aXNpYmx5IHNob3cgdGhlbQoJCQkJCS8vIGhvd2V2ZXIsIGl0IG11c3QgaGF2ZSBhIGN1cnJlbnQgZGlzcGxheSBzdHlsZSB0aGF0IHdvdWxkIGJlbmVmaXQgZnJvbSB0aGlzCgkJCQkJcmV0dXJuIHJkaXNwbGF5c3dhcC50ZXN0KCBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSApICYmIGVsZW0ub2Zmc2V0V2lkdGggPT09IDAgPwoJCQkJCQlqUXVlcnkuc3dhcCggZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24oKSB7CgkJCQkJCQlyZXR1cm4gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJCQkJfSkgOgoJCQkJCQlnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApOwoJCQkJfQoJCQl9LAoKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIGV4dHJhICkgewoJCQkJdmFyIHN0eWxlcyA9IGV4dHJhICYmIGdldFN0eWxlcyggZWxlbSApOwoJCQkJcmV0dXJuIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgZXh0cmEgPwoJCQkJCWF1Z21lbnRXaWR0aE9ySGVpZ2h0KAoJCQkJCQllbGVtLAoJCQkJCQluYW1lLAoJCQkJCQlleHRyYSwKCQkJCQkJc3VwcG9ydC5ib3hTaXppbmcgJiYgalF1ZXJ5LmNzcyggZWxlbSwgImJveFNpemluZyIsIGZhbHNlLCBzdHlsZXMgKSA9PT0gImJvcmRlci1ib3giLAoJCQkJCQlzdHlsZXMKCQkJCQkpIDogMAoJCQkJKTsKCQkJfQoJCX07Cgl9KTsKCglpZiAoICFzdXBwb3J0Lm9wYWNpdHkgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzLm9wYWNpdHkgPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQkJLy8gSUUgdXNlcyBmaWx0ZXJzIGZvciBvcGFjaXR5CgkJCQlyZXR1cm4gcm9wYWNpdHkudGVzdCggKGNvbXB1dGVkICYmIGVsZW0uY3VycmVudFN0eWxlID8gZWxlbS5jdXJyZW50U3R5bGUuZmlsdGVyIDogZWxlbS5zdHlsZS5maWx0ZXIpIHx8ICIiICkgPwoJCQkJCSggMC4wMSAqIHBhcnNlRmxvYXQoIFJlZ0V4cC4kMSApICkgKyAiIiA6CgkJCQkJY29tcHV0ZWQgPyAiMSIgOiAiIjsKCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJdmFyIHN0eWxlID0gZWxlbS5zdHlsZSwKCQkJCQljdXJyZW50U3R5bGUgPSBlbGVtLmN1cnJlbnRTdHlsZSwKCQkJCQlvcGFjaXR5ID0galF1ZXJ5LmlzTnVtZXJpYyggdmFsdWUgKSA/ICJhbHBoYShvcGFjaXR5PSIgKyB2YWx1ZSAqIDEwMCArICIpIiA6ICIiLAoJCQkJCWZpbHRlciA9IGN1cnJlbnRTdHlsZSAmJiBjdXJyZW50U3R5bGUuZmlsdGVyIHx8IHN0eWxlLmZpbHRlciB8fCAiIjsKCgkJCQkvLyBJRSBoYXMgdHJvdWJsZSB3aXRoIG9wYWNpdHkgaWYgaXQgZG9lcyBub3QgaGF2ZSBsYXlvdXQKCQkJCS8vIEZvcmNlIGl0IGJ5IHNldHRpbmcgdGhlIHpvb20gbGV2ZWwKCQkJCXN0eWxlLnpvb20gPSAxOwoKCQkJCS8vIGlmIHNldHRpbmcgb3BhY2l0eSB0byAxLCBhbmQgbm8gb3RoZXIgZmlsdGVycyBleGlzdCAtIGF0dGVtcHQgdG8gcmVtb3ZlIGZpbHRlciBhdHRyaWJ1dGUgIzY2NTIKCQkJCS8vIGlmIHZhbHVlID09PSAiIiwgdGhlbiByZW1vdmUgaW5saW5lIG9wYWNpdHkgIzEyNjg1CgkJCQlpZiAoICggdmFsdWUgPj0gMSB8fCB2YWx1ZSA9PT0gIiIgKSAmJgoJCQkJCQlqUXVlcnkudHJpbSggZmlsdGVyLnJlcGxhY2UoIHJhbHBoYSwgIiIgKSApID09PSAiIiAmJgoJCQkJCQlzdHlsZS5yZW1vdmVBdHRyaWJ1dGUgKSB7CgoJCQkJCS8vIFNldHRpbmcgc3R5bGUuZmlsdGVyIHRvIG51bGwsICIiICYgIiAiIHN0aWxsIGxlYXZlICJmaWx0ZXI6IiBpbiB0aGUgY3NzVGV4dAoJCQkJCS8vIGlmICJmaWx0ZXI6IiBpcyBwcmVzZW50IGF0IGFsbCwgY2xlYXJUeXBlIGlzIGRpc2FibGVkLCB3ZSB3YW50IHRvIGF2b2lkIHRoaXMKCQkJCQkvLyBzdHlsZS5yZW1vdmVBdHRyaWJ1dGUgaXMgSUUgT25seSwgYnV0IHNvIGFwcGFyZW50bHkgaXMgdGhpcyBjb2RlIHBhdGguLi4KCQkJCQlzdHlsZS5yZW1vdmVBdHRyaWJ1dGUoICJmaWx0ZXIiICk7CgoJCQkJCS8vIGlmIHRoZXJlIGlzIG5vIGZpbHRlciBzdHlsZSBhcHBsaWVkIGluIGEgY3NzIHJ1bGUgb3IgdW5zZXQgaW5saW5lIG9wYWNpdHksIHdlIGFyZSBkb25lCgkJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgfHwgY3VycmVudFN0eWxlICYmICFjdXJyZW50U3R5bGUuZmlsdGVyICkgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoKCQkJCS8vIG90aGVyd2lzZSwgc2V0IG5ldyBmaWx0ZXIgdmFsdWVzCgkJCQlzdHlsZS5maWx0ZXIgPSByYWxwaGEudGVzdCggZmlsdGVyICkgPwoJCQkJCWZpbHRlci5yZXBsYWNlKCByYWxwaGEsIG9wYWNpdHkgKSA6CgkJCQkJZmlsdGVyICsgIiAiICsgb3BhY2l0eTsKCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmNzc0hvb2tzLm1hcmdpblJpZ2h0ID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQsCgkJZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQlpZiAoIGNvbXB1dGVkICkgewoJCQkJLy8gV2ViS2l0IEJ1ZyAxMzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3IgbWFyZ2luLXJpZ2h0CgkJCQkvLyBXb3JrIGFyb3VuZCBieSB0ZW1wb3JhcmlseSBzZXR0aW5nIGVsZW1lbnQgZGlzcGxheSB0byBpbmxpbmUtYmxvY2sKCQkJCXJldHVybiBqUXVlcnkuc3dhcCggZWxlbSwgeyAiZGlzcGxheSI6ICJpbmxpbmUtYmxvY2siIH0sCgkJCQkJY3VyQ1NTLCBbIGVsZW0sICJtYXJnaW5SaWdodCIgXSApOwoJCQl9CgkJfQoJKTsKCgkvLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzCglqUXVlcnkuZWFjaCh7CgkJbWFyZ2luOiAiIiwKCQlwYWRkaW5nOiAiIiwKCQlib3JkZXI6ICJXaWR0aCIKCX0sIGZ1bmN0aW9uKCBwcmVmaXgsIHN1ZmZpeCApIHsKCQlqUXVlcnkuY3NzSG9va3NbIHByZWZpeCArIHN1ZmZpeCBdID0gewoJCQlleHBhbmQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJCXZhciBpID0gMCwKCQkJCQlleHBhbmRlZCA9IHt9LAoKCQkJCQkvLyBhc3N1bWVzIGEgc2luZ2xlIG51bWJlciBpZiBub3QgYSBzdHJpbmcKCQkJCQlwYXJ0cyA9IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgPyB2YWx1ZS5zcGxpdCgiICIpIDogWyB2YWx1ZSBdOwoKCQkJCWZvciAoIDsgaSA8IDQ7IGkrKyApIHsKCQkJCQlleHBhbmRlZFsgcHJlZml4ICsgY3NzRXhwYW5kWyBpIF0gKyBzdWZmaXggXSA9CgkJCQkJCXBhcnRzWyBpIF0gfHwgcGFydHNbIGkgLSAyIF0gfHwgcGFydHNbIDAgXTsKCQkJCX0KCgkJCQlyZXR1cm4gZXhwYW5kZWQ7CgkJCX0KCQl9OwoKCQlpZiAoICFybWFyZ2luLnRlc3QoIHByZWZpeCApICkgewoJCQlqUXVlcnkuY3NzSG9va3NbIHByZWZpeCArIHN1ZmZpeCBdLnNldCA9IHNldFBvc2l0aXZlTnVtYmVyOwoJCX0KCX0pOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWNzczogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJCQl2YXIgc3R5bGVzLCBsZW4sCgkJCQkJbWFwID0ge30sCgkJCQkJaSA9IDA7CgoJCQkJaWYgKCBqUXVlcnkuaXNBcnJheSggbmFtZSApICkgewoJCQkJCXN0eWxlcyA9IGdldFN0eWxlcyggZWxlbSApOwoJCQkJCWxlbiA9IG5hbWUubGVuZ3RoOwoKCQkJCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQkJbWFwWyBuYW1lWyBpIF0gXSA9IGpRdWVyeS5jc3MoIGVsZW0sIG5hbWVbIGkgXSwgZmFsc2UsIHN0eWxlcyApOwoJCQkJCX0KCgkJCQkJcmV0dXJuIG1hcDsKCQkJCX0KCgkJCQlyZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/CgkJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCBuYW1lLCB2YWx1ZSApIDoKCQkJCQlqUXVlcnkuY3NzKCBlbGVtLCBuYW1lICk7CgkJCX0sIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApOwoJCX0sCgkJc2hvdzogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBzaG93SGlkZSggdGhpcywgdHJ1ZSApOwoJCX0sCgkJaGlkZTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBzaG93SGlkZSggdGhpcyApOwoJCX0sCgkJdG9nZ2xlOiBmdW5jdGlvbiggc3RhdGUgKSB7CgkJCWlmICggdHlwZW9mIHN0YXRlID09PSAiYm9vbGVhbiIgKSB7CgkJCQlyZXR1cm4gc3RhdGUgPyB0aGlzLnNob3coKSA6IHRoaXMuaGlkZSgpOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBpc0hpZGRlbiggdGhpcyApICkgewoJCQkJCWpRdWVyeSggdGhpcyApLnNob3coKTsKCQkJCX0gZWxzZSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkuaGlkZSgpOwoJCQkJfQoJCQl9KTsKCQl9Cgl9KTsKCgoJZnVuY3Rpb24gVHdlZW4oIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nICkgewoJCXJldHVybiBuZXcgVHdlZW4ucHJvdG90eXBlLmluaXQoIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nICk7Cgl9CglqUXVlcnkuVHdlZW4gPSBUd2VlbjsKCglUd2Vlbi5wcm90b3R5cGUgPSB7CgkJY29uc3RydWN0b3I6IFR3ZWVuLAoJCWluaXQ6IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZywgdW5pdCApIHsKCQkJdGhpcy5lbGVtID0gZWxlbTsKCQkJdGhpcy5wcm9wID0gcHJvcDsKCQkJdGhpcy5lYXNpbmcgPSBlYXNpbmcgfHwgInN3aW5nIjsKCQkJdGhpcy5vcHRpb25zID0gb3B0aW9uczsKCQkJdGhpcy5zdGFydCA9IHRoaXMubm93ID0gdGhpcy5jdXIoKTsKCQkJdGhpcy5lbmQgPSBlbmQ7CgkJCXRoaXMudW5pdCA9IHVuaXQgfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gPyAiIiA6ICJweCIgKTsKCQl9LAoJCWN1cjogZnVuY3Rpb24oKSB7CgkJCXZhciBob29rcyA9IFR3ZWVuLnByb3BIb29rc1sgdGhpcy5wcm9wIF07CgoJCQlyZXR1cm4gaG9va3MgJiYgaG9va3MuZ2V0ID8KCQkJCWhvb2tzLmdldCggdGhpcyApIDoKCQkJCVR3ZWVuLnByb3BIb29rcy5fZGVmYXVsdC5nZXQoIHRoaXMgKTsKCQl9LAoJCXJ1bjogZnVuY3Rpb24oIHBlcmNlbnQgKSB7CgkJCXZhciBlYXNlZCwKCQkJCWhvb2tzID0gVHdlZW4ucHJvcEhvb2tzWyB0aGlzLnByb3AgXTsKCgkJCWlmICggdGhpcy5vcHRpb25zLmR1cmF0aW9uICkgewoJCQkJdGhpcy5wb3MgPSBlYXNlZCA9IGpRdWVyeS5lYXNpbmdbIHRoaXMuZWFzaW5nIF0oCgkJCQkJcGVyY2VudCwgdGhpcy5vcHRpb25zLmR1cmF0aW9uICogcGVyY2VudCwgMCwgMSwgdGhpcy5vcHRpb25zLmR1cmF0aW9uCgkJCQkpOwoJCQl9IGVsc2UgewoJCQkJdGhpcy5wb3MgPSBlYXNlZCA9IHBlcmNlbnQ7CgkJCX0KCQkJdGhpcy5ub3cgPSAoIHRoaXMuZW5kIC0gdGhpcy5zdGFydCApICogZWFzZWQgKyB0aGlzLnN0YXJ0OwoKCQkJaWYgKCB0aGlzLm9wdGlvbnMuc3RlcCApIHsKCQkJCXRoaXMub3B0aW9ucy5zdGVwLmNhbGwoIHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMgKTsKCQkJfQoKCQkJaWYgKCBob29rcyAmJiBob29rcy5zZXQgKSB7CgkJCQlob29rcy5zZXQoIHRoaXMgKTsKCQkJfSBlbHNlIHsKCQkJCVR3ZWVuLnByb3BIb29rcy5fZGVmYXVsdC5zZXQoIHRoaXMgKTsKCQkJfQoJCQlyZXR1cm4gdGhpczsKCQl9Cgl9OwoKCVR3ZWVuLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZSA9IFR3ZWVuLnByb3RvdHlwZTsKCglUd2Vlbi5wcm9wSG9va3MgPSB7CgkJX2RlZmF1bHQ6IHsKCQkJZ2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7CgkJCQl2YXIgcmVzdWx0OwoKCQkJCWlmICggdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdICE9IG51bGwgJiYKCQkJCQkoIXR3ZWVuLmVsZW0uc3R5bGUgfHwgdHdlZW4uZWxlbS5zdHlsZVsgdHdlZW4ucHJvcCBdID09IG51bGwpICkgewoJCQkJCXJldHVybiB0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF07CgkJCQl9CgoJCQkJLy8gcGFzc2luZyBhbiBlbXB0eSBzdHJpbmcgYXMgYSAzcmQgcGFyYW1ldGVyIHRvIC5jc3Mgd2lsbCBhdXRvbWF0aWNhbGx5CgkJCQkvLyBhdHRlbXB0IGEgcGFyc2VGbG9hdCBhbmQgZmFsbGJhY2sgdG8gYSBzdHJpbmcgaWYgdGhlIHBhcnNlIGZhaWxzCgkJCQkvLyBzbywgc2ltcGxlIHZhbHVlcyBzdWNoIGFzICIxMHB4IiBhcmUgcGFyc2VkIHRvIEZsb2F0LgoJCQkJLy8gY29tcGxleCB2YWx1ZXMgc3VjaCBhcyAicm90YXRlKDFyYWQpIiBhcmUgcmV0dXJuZWQgYXMgaXMuCgkJCQlyZXN1bHQgPSBqUXVlcnkuY3NzKCB0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCAiIiApOwoJCQkJLy8gRW1wdHkgc3RyaW5ncywgbnVsbCwgdW5kZWZpbmVkIGFuZCAiYXV0byIgYXJlIGNvbnZlcnRlZCB0byAwLgoJCQkJcmV0dXJuICFyZXN1bHQgfHwgcmVzdWx0ID09PSAiYXV0byIgPyAwIDogcmVzdWx0OwoJCQl9LAoJCQlzZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHsKCQkJCS8vIHVzZSBzdGVwIGhvb2sgZm9yIGJhY2sgY29tcGF0IC0gdXNlIGNzc0hvb2sgaWYgaXRzIHRoZXJlIC0gdXNlIC5zdHlsZSBpZiBpdHMKCQkJCS8vIGF2YWlsYWJsZSBhbmQgdXNlIHBsYWluIHByb3BlcnRpZXMgd2hlcmUgYXZhaWxhYmxlCgkJCQlpZiAoIGpRdWVyeS5meC5zdGVwWyB0d2Vlbi5wcm9wIF0gKSB7CgkJCQkJalF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSggdHdlZW4gKTsKCQkJCX0gZWxzZSBpZiAoIHR3ZWVuLmVsZW0uc3R5bGUgJiYgKCB0d2Vlbi5lbGVtLnN0eWxlWyBqUXVlcnkuY3NzUHJvcHNbIHR3ZWVuLnByb3AgXSBdICE9IG51bGwgfHwgalF1ZXJ5LmNzc0hvb2tzWyB0d2Vlbi5wcm9wIF0gKSApIHsKCQkJCQlqUXVlcnkuc3R5bGUoIHR3ZWVuLmVsZW0sIHR3ZWVuLnByb3AsIHR3ZWVuLm5vdyArIHR3ZWVuLnVuaXQgKTsKCQkJCX0gZWxzZSB7CgkJCQkJdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdID0gdHdlZW4ubm93OwoJCQkJfQoJCQl9CgkJfQoJfTsKCgkvLyBTdXBwb3J0OiBJRSA8PTkKCS8vIFBhbmljIGJhc2VkIGFwcHJvYWNoIHRvIHNldHRpbmcgdGhpbmdzIG9uIGRpc2Nvbm5lY3RlZCBub2RlcwoKCVR3ZWVuLnByb3BIb29rcy5zY3JvbGxUb3AgPSBUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsTGVmdCA9IHsKCQlzZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHsKCQkJaWYgKCB0d2Vlbi5lbGVtLm5vZGVUeXBlICYmIHR3ZWVuLmVsZW0ucGFyZW50Tm9kZSApIHsKCQkJCXR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSA9IHR3ZWVuLm5vdzsKCQkJfQoJCX0KCX07CgoJalF1ZXJ5LmVhc2luZyA9IHsKCQlsaW5lYXI6IGZ1bmN0aW9uKCBwICkgewoJCQlyZXR1cm4gcDsKCQl9LAoJCXN3aW5nOiBmdW5jdGlvbiggcCApIHsKCQkJcmV0dXJuIDAuNSAtIE1hdGguY29zKCBwICogTWF0aC5QSSApIC8gMjsKCQl9Cgl9OwoKCWpRdWVyeS5meCA9IFR3ZWVuLnByb3RvdHlwZS5pbml0OwoKCS8vIEJhY2sgQ29tcGF0IDwxLjggZXh0ZW5zaW9uIHBvaW50CglqUXVlcnkuZnguc3RlcCA9IHt9OwoKCgoKCXZhcgoJCWZ4Tm93LCB0aW1lcklkLAoJCXJmeHR5cGVzID0gL14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLAoJCXJmeG51bSA9IG5ldyBSZWdFeHAoICJeKD86KFsrLV0pPXwpKCIgKyBwbnVtICsgIikoW2EteiVdKikkIiwgImkiICksCgkJcnJ1biA9IC9xdWV1ZUhvb2tzJC8sCgkJYW5pbWF0aW9uUHJlZmlsdGVycyA9IFsgZGVmYXVsdFByZWZpbHRlciBdLAoJCXR3ZWVuZXJzID0gewoJCQkiKiI6IFsgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkgewoJCQkJdmFyIHR3ZWVuID0gdGhpcy5jcmVhdGVUd2VlbiggcHJvcCwgdmFsdWUgKSwKCQkJCQl0YXJnZXQgPSB0d2Vlbi5jdXIoKSwKCQkJCQlwYXJ0cyA9IHJmeG51bS5leGVjKCB2YWx1ZSApLAoJCQkJCXVuaXQgPSBwYXJ0cyAmJiBwYXJ0c1sgMyBdIHx8ICggalF1ZXJ5LmNzc051bWJlclsgcHJvcCBdID8gIiIgOiAicHgiICksCgoJCQkJCS8vIFN0YXJ0aW5nIHZhbHVlIGNvbXB1dGF0aW9uIGlzIHJlcXVpcmVkIGZvciBwb3RlbnRpYWwgdW5pdCBtaXNtYXRjaGVzCgkJCQkJc3RhcnQgPSAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSB8fCB1bml0ICE9PSAicHgiICYmICt0YXJnZXQgKSAmJgoJCQkJCQlyZnhudW0uZXhlYyggalF1ZXJ5LmNzcyggdHdlZW4uZWxlbSwgcHJvcCApICksCgkJCQkJc2NhbGUgPSAxLAoJCQkJCW1heEl0ZXJhdGlvbnMgPSAyMDsKCgkJCQlpZiAoIHN0YXJ0ICYmIHN0YXJ0WyAzIF0gIT09IHVuaXQgKSB7CgkJCQkJLy8gVHJ1c3QgdW5pdHMgcmVwb3J0ZWQgYnkgalF1ZXJ5LmNzcwoJCQkJCXVuaXQgPSB1bml0IHx8IHN0YXJ0WyAzIF07CgoJCQkJCS8vIE1ha2Ugc3VyZSB3ZSB1cGRhdGUgdGhlIHR3ZWVuIHByb3BlcnRpZXMgbGF0ZXIgb24KCQkJCQlwYXJ0cyA9IHBhcnRzIHx8IFtdOwoKCQkJCQkvLyBJdGVyYXRpdmVseSBhcHByb3hpbWF0ZSBmcm9tIGEgbm9uemVybyBzdGFydGluZyBwb2ludAoJCQkJCXN0YXJ0ID0gK3RhcmdldCB8fCAxOwoKCQkJCQlkbyB7CgkJCQkJCS8vIElmIHByZXZpb3VzIGl0ZXJhdGlvbiB6ZXJvZWQgb3V0LCBkb3VibGUgdW50aWwgd2UgZ2V0ICpzb21ldGhpbmcqCgkJCQkJCS8vIFVzZSBhIHN0cmluZyBmb3IgZG91YmxpbmcgZmFjdG9yIHNvIHdlIGRvbid0IGFjY2lkZW50YWxseSBzZWUgc2NhbGUgYXMgdW5jaGFuZ2VkIGJlbG93CgkJCQkJCXNjYWxlID0gc2NhbGUgfHwgIi41IjsKCgkJCQkJCS8vIEFkanVzdCBhbmQgYXBwbHkKCQkJCQkJc3RhcnQgPSBzdGFydCAvIHNjYWxlOwoJCQkJCQlqUXVlcnkuc3R5bGUoIHR3ZWVuLmVsZW0sIHByb3AsIHN0YXJ0ICsgdW5pdCApOwoKCQkJCQkvLyBVcGRhdGUgc2NhbGUsIHRvbGVyYXRpbmcgemVybyBvciBOYU4gZnJvbSB0d2Vlbi5jdXIoKQoJCQkJCS8vIEFuZCBicmVha2luZyB0aGUgbG9vcCBpZiBzY2FsZSBpcyB1bmNoYW5nZWQgb3IgcGVyZmVjdCwgb3IgaWYgd2UndmUganVzdCBoYWQgZW5vdWdoCgkJCQkJfSB3aGlsZSAoIHNjYWxlICE9PSAoc2NhbGUgPSB0d2Vlbi5jdXIoKSAvIHRhcmdldCkgJiYgc2NhbGUgIT09IDEgJiYgLS1tYXhJdGVyYXRpb25zICk7CgkJCQl9CgoJCQkJLy8gVXBkYXRlIHR3ZWVuIHByb3BlcnRpZXMKCQkJCWlmICggcGFydHMgKSB7CgkJCQkJc3RhcnQgPSB0d2Vlbi5zdGFydCA9ICtzdGFydCB8fCArdGFyZ2V0IHx8IDA7CgkJCQkJdHdlZW4udW5pdCA9IHVuaXQ7CgkJCQkJLy8gSWYgYSArPS8tPSB0b2tlbiB3YXMgcHJvdmlkZWQsIHdlJ3JlIGRvaW5nIGEgcmVsYXRpdmUgYW5pbWF0aW9uCgkJCQkJdHdlZW4uZW5kID0gcGFydHNbIDEgXSA/CgkJCQkJCXN0YXJ0ICsgKCBwYXJ0c1sgMSBdICsgMSApICogcGFydHNbIDIgXSA6CgkJCQkJCStwYXJ0c1sgMiBdOwoJCQkJfQoKCQkJCXJldHVybiB0d2VlbjsKCQkJfSBdCgkJfTsKCgkvLyBBbmltYXRpb25zIGNyZWF0ZWQgc3luY2hyb25vdXNseSB3aWxsIHJ1biBzeW5jaHJvbm91c2x5CglmdW5jdGlvbiBjcmVhdGVGeE5vdygpIHsKCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQlmeE5vdyA9IHVuZGVmaW5lZDsKCQl9KTsKCQlyZXR1cm4gKCBmeE5vdyA9IGpRdWVyeS5ub3coKSApOwoJfQoKCS8vIEdlbmVyYXRlIHBhcmFtZXRlcnMgdG8gY3JlYXRlIGEgc3RhbmRhcmQgYW5pbWF0aW9uCglmdW5jdGlvbiBnZW5GeCggdHlwZSwgaW5jbHVkZVdpZHRoICkgewoJCXZhciB3aGljaCwKCQkJYXR0cnMgPSB7IGhlaWdodDogdHlwZSB9LAoJCQlpID0gMDsKCgkJLy8gaWYgd2UgaW5jbHVkZSB3aWR0aCwgc3RlcCB2YWx1ZSBpcyAxIHRvIGRvIGFsbCBjc3NFeHBhbmQgdmFsdWVzLAoJCS8vIGlmIHdlIGRvbid0IGluY2x1ZGUgd2lkdGgsIHN0ZXAgdmFsdWUgaXMgMiB0byBza2lwIG92ZXIgTGVmdCBhbmQgUmlnaHQKCQlpbmNsdWRlV2lkdGggPSBpbmNsdWRlV2lkdGggPyAxIDogMDsKCQlmb3IgKCA7IGkgPCA0IDsgaSArPSAyIC0gaW5jbHVkZVdpZHRoICkgewoJCQl3aGljaCA9IGNzc0V4cGFuZFsgaSBdOwoJCQlhdHRyc1sgIm1hcmdpbiIgKyB3aGljaCBdID0gYXR0cnNbICJwYWRkaW5nIiArIHdoaWNoIF0gPSB0eXBlOwoJCX0KCgkJaWYgKCBpbmNsdWRlV2lkdGggKSB7CgkJCWF0dHJzLm9wYWNpdHkgPSBhdHRycy53aWR0aCA9IHR5cGU7CgkJfQoKCQlyZXR1cm4gYXR0cnM7Cgl9CgoJZnVuY3Rpb24gY3JlYXRlVHdlZW4oIHZhbHVlLCBwcm9wLCBhbmltYXRpb24gKSB7CgkJdmFyIHR3ZWVuLAoJCQljb2xsZWN0aW9uID0gKCB0d2VlbmVyc1sgcHJvcCBdIHx8IFtdICkuY29uY2F0KCB0d2VlbmVyc1sgIioiIF0gKSwKCQkJaW5kZXggPSAwLAoJCQlsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDsKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQlpZiAoICh0d2VlbiA9IGNvbGxlY3Rpb25bIGluZGV4IF0uY2FsbCggYW5pbWF0aW9uLCBwcm9wLCB2YWx1ZSApKSApIHsKCgkJCQkvLyB3ZSdyZSBkb25lIHdpdGggdGhpcyBwcm9wZXJ0eQoJCQkJcmV0dXJuIHR3ZWVuOwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIGRlZmF1bHRQcmVmaWx0ZXIoIGVsZW0sIHByb3BzLCBvcHRzICkgewoJCS8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi8KCQl2YXIgcHJvcCwgdmFsdWUsIHRvZ2dsZSwgdHdlZW4sIGhvb2tzLCBvbGRmaXJlLCBkaXNwbGF5LCBjaGVja0Rpc3BsYXksCgkJCWFuaW0gPSB0aGlzLAoJCQlvcmlnID0ge30sCgkJCXN0eWxlID0gZWxlbS5zdHlsZSwKCQkJaGlkZGVuID0gZWxlbS5ub2RlVHlwZSAmJiBpc0hpZGRlbiggZWxlbSApLAoJCQlkYXRhU2hvdyA9IGpRdWVyeS5fZGF0YSggZWxlbSwgImZ4c2hvdyIgKTsKCgkJLy8gaGFuZGxlIHF1ZXVlOiBmYWxzZSBwcm9taXNlcwoJCWlmICggIW9wdHMucXVldWUgKSB7CgkJCWhvb2tzID0galF1ZXJ5Ll9xdWV1ZUhvb2tzKCBlbGVtLCAiZngiICk7CgkJCWlmICggaG9va3MudW5xdWV1ZWQgPT0gbnVsbCApIHsKCQkJCWhvb2tzLnVucXVldWVkID0gMDsKCQkJCW9sZGZpcmUgPSBob29rcy5lbXB0eS5maXJlOwoJCQkJaG9va3MuZW1wdHkuZmlyZSA9IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggIWhvb2tzLnVucXVldWVkICkgewoJCQkJCQlvbGRmaXJlKCk7CgkJCQkJfQoJCQkJfTsKCQkJfQoJCQlob29rcy51bnF1ZXVlZCsrOwoKCQkJYW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7CgkJCQkvLyBkb2luZyB0aGlzIG1ha2VzIHN1cmUgdGhhdCB0aGUgY29tcGxldGUgaGFuZGxlciB3aWxsIGJlIGNhbGxlZAoJCQkJLy8gYmVmb3JlIHRoaXMgY29tcGxldGVzCgkJCQlhbmltLmFsd2F5cyhmdW5jdGlvbigpIHsKCQkJCQlob29rcy51bnF1ZXVlZC0tOwoJCQkJCWlmICggIWpRdWVyeS5xdWV1ZSggZWxlbSwgImZ4IiApLmxlbmd0aCApIHsKCQkJCQkJaG9va3MuZW1wdHkuZmlyZSgpOwoJCQkJCX0KCQkJCX0pOwoJCQl9KTsKCQl9CgoJCS8vIGhlaWdodC93aWR0aCBvdmVyZmxvdyBwYXNzCgkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICYmICggImhlaWdodCIgaW4gcHJvcHMgfHwgIndpZHRoIiBpbiBwcm9wcyApICkgewoJCQkvLyBNYWtlIHN1cmUgdGhhdCBub3RoaW5nIHNuZWFrcyBvdXQKCQkJLy8gUmVjb3JkIGFsbCAzIG92ZXJmbG93IGF0dHJpYnV0ZXMgYmVjYXVzZSBJRSBkb2VzIG5vdAoJCQkvLyBjaGFuZ2UgdGhlIG92ZXJmbG93IGF0dHJpYnV0ZSB3aGVuIG92ZXJmbG93WCBhbmQKCQkJLy8gb3ZlcmZsb3dZIGFyZSBzZXQgdG8gdGhlIHNhbWUgdmFsdWUKCQkJb3B0cy5vdmVyZmxvdyA9IFsgc3R5bGUub3ZlcmZsb3csIHN0eWxlLm92ZXJmbG93WCwgc3R5bGUub3ZlcmZsb3dZIF07CgoJCQkvLyBTZXQgZGlzcGxheSBwcm9wZXJ0eSB0byBpbmxpbmUtYmxvY2sgZm9yIGhlaWdodC93aWR0aAoJCQkvLyBhbmltYXRpb25zIG9uIGlubGluZSBlbGVtZW50cyB0aGF0IGFyZSBoYXZpbmcgd2lkdGgvaGVpZ2h0IGFuaW1hdGVkCgkJCWRpc3BsYXkgPSBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKTsKCgkJCS8vIFRlc3QgZGVmYXVsdCBkaXNwbGF5IGlmIGRpc3BsYXkgaXMgY3VycmVudGx5ICJub25lIgoJCQljaGVja0Rpc3BsYXkgPSBkaXNwbGF5ID09PSAibm9uZSIgPwoJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xkZGlzcGxheSIgKSB8fCBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApIDogZGlzcGxheTsKCgkJCWlmICggY2hlY2tEaXNwbGF5ID09PSAiaW5saW5lIiAmJiBqUXVlcnkuY3NzKCBlbGVtLCAiZmxvYXQiICkgPT09ICJub25lIiApIHsKCgkJCQkvLyBpbmxpbmUtbGV2ZWwgZWxlbWVudHMgYWNjZXB0IGlubGluZS1ibG9jazsKCQkJCS8vIGJsb2NrLWxldmVsIGVsZW1lbnRzIG5lZWQgdG8gYmUgaW5saW5lIHdpdGggbGF5b3V0CgkJCQlpZiAoICFzdXBwb3J0LmlubGluZUJsb2NrTmVlZHNMYXlvdXQgfHwgZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA9PT0gImlubGluZSIgKSB7CgkJCQkJc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUtYmxvY2siOwoJCQkJfSBlbHNlIHsKCQkJCQlzdHlsZS56b29tID0gMTsKCQkJCX0KCQkJfQoJCX0KCgkJaWYgKCBvcHRzLm92ZXJmbG93ICkgewoJCQlzdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwoJCQlpZiAoICFzdXBwb3J0LnNocmlua1dyYXBCbG9ja3MoKSApIHsKCQkJCWFuaW0uYWx3YXlzKGZ1bmN0aW9uKCkgewoJCQkJCXN0eWxlLm92ZXJmbG93ID0gb3B0cy5vdmVyZmxvd1sgMCBdOwoJCQkJCXN0eWxlLm92ZXJmbG93WCA9IG9wdHMub3ZlcmZsb3dbIDEgXTsKCQkJCQlzdHlsZS5vdmVyZmxvd1kgPSBvcHRzLm92ZXJmbG93WyAyIF07CgkJCQl9KTsKCQkJfQoJCX0KCgkJLy8gc2hvdy9oaWRlIHBhc3MKCQlmb3IgKCBwcm9wIGluIHByb3BzICkgewoJCQl2YWx1ZSA9IHByb3BzWyBwcm9wIF07CgkJCWlmICggcmZ4dHlwZXMuZXhlYyggdmFsdWUgKSApIHsKCQkJCWRlbGV0ZSBwcm9wc1sgcHJvcCBdOwoJCQkJdG9nZ2xlID0gdG9nZ2xlIHx8IHZhbHVlID09PSAidG9nZ2xlIjsKCQkJCWlmICggdmFsdWUgPT09ICggaGlkZGVuID8gImhpZGUiIDogInNob3ciICkgKSB7CgoJCQkJCS8vIElmIHRoZXJlIGlzIGRhdGFTaG93IGxlZnQgb3ZlciBmcm9tIGEgc3RvcHBlZCBoaWRlIG9yIHNob3cgYW5kIHdlIGFyZSBnb2luZyB0byBwcm9jZWVkIHdpdGggc2hvdywgd2Ugc2hvdWxkIHByZXRlbmQgdG8gYmUgaGlkZGVuCgkJCQkJaWYgKCB2YWx1ZSA9PT0gInNob3ciICYmIGRhdGFTaG93ICYmIGRhdGFTaG93WyBwcm9wIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJaGlkZGVuID0gdHJ1ZTsKCQkJCQl9IGVsc2UgewoJCQkJCQljb250aW51ZTsKCQkJCQl9CgkJCQl9CgkJCQlvcmlnWyBwcm9wIF0gPSBkYXRhU2hvdyAmJiBkYXRhU2hvd1sgcHJvcCBdIHx8IGpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCApOwoKCQkJLy8gQW55IG5vbi1meCB2YWx1ZSBzdG9wcyB1cyBmcm9tIHJlc3RvcmluZyB0aGUgb3JpZ2luYWwgZGlzcGxheSB2YWx1ZQoJCQl9IGVsc2UgewoJCQkJZGlzcGxheSA9IHVuZGVmaW5lZDsKCQkJfQoJCX0KCgkJaWYgKCAhalF1ZXJ5LmlzRW1wdHlPYmplY3QoIG9yaWcgKSApIHsKCQkJaWYgKCBkYXRhU2hvdyApIHsKCQkJCWlmICggImhpZGRlbiIgaW4gZGF0YVNob3cgKSB7CgkJCQkJaGlkZGVuID0gZGF0YVNob3cuaGlkZGVuOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZGF0YVNob3cgPSBqUXVlcnkuX2RhdGEoIGVsZW0sICJmeHNob3ciLCB7fSApOwoJCQl9CgoJCQkvLyBzdG9yZSBzdGF0ZSBpZiBpdHMgdG9nZ2xlIC0gZW5hYmxlcyAuc3RvcCgpLnRvZ2dsZSgpIHRvICJyZXZlcnNlIgoJCQlpZiAoIHRvZ2dsZSApIHsKCQkJCWRhdGFTaG93LmhpZGRlbiA9ICFoaWRkZW47CgkJCX0KCQkJaWYgKCBoaWRkZW4gKSB7CgkJCQlqUXVlcnkoIGVsZW0gKS5zaG93KCk7CgkJCX0gZWxzZSB7CgkJCQlhbmltLmRvbmUoZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5KCBlbGVtICkuaGlkZSgpOwoJCQkJfSk7CgkJCX0KCQkJYW5pbS5kb25lKGZ1bmN0aW9uKCkgewoJCQkJdmFyIHByb3A7CgkJCQlqUXVlcnkuX3JlbW92ZURhdGEoIGVsZW0sICJmeHNob3ciICk7CgkJCQlmb3IgKCBwcm9wIGluIG9yaWcgKSB7CgkJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCBwcm9wLCBvcmlnWyBwcm9wIF0gKTsKCQkJCX0KCQkJfSk7CgkJCWZvciAoIHByb3AgaW4gb3JpZyApIHsKCQkJCXR3ZWVuID0gY3JlYXRlVHdlZW4oIGhpZGRlbiA/IGRhdGFTaG93WyBwcm9wIF0gOiAwLCBwcm9wLCBhbmltICk7CgoJCQkJaWYgKCAhKCBwcm9wIGluIGRhdGFTaG93ICkgKSB7CgkJCQkJZGF0YVNob3dbIHByb3AgXSA9IHR3ZWVuLnN0YXJ0OwoJCQkJCWlmICggaGlkZGVuICkgewoJCQkJCQl0d2Vlbi5lbmQgPSB0d2Vlbi5zdGFydDsKCQkJCQkJdHdlZW4uc3RhcnQgPSBwcm9wID09PSAid2lkdGgiIHx8IHByb3AgPT09ICJoZWlnaHQiID8gMSA6IDA7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCS8vIElmIHRoaXMgaXMgYSBub29wIGxpa2UgLmhpZGUoKS5oaWRlKCksIHJlc3RvcmUgYW4gb3ZlcndyaXR0ZW4gZGlzcGxheSB2YWx1ZQoJCX0gZWxzZSBpZiAoIChkaXNwbGF5ID09PSAibm9uZSIgPyBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApIDogZGlzcGxheSkgPT09ICJpbmxpbmUiICkgewoJCQlzdHlsZS5kaXNwbGF5ID0gZGlzcGxheTsKCQl9Cgl9CgoJZnVuY3Rpb24gcHJvcEZpbHRlciggcHJvcHMsIHNwZWNpYWxFYXNpbmcgKSB7CgkJdmFyIGluZGV4LCBuYW1lLCBlYXNpbmcsIHZhbHVlLCBob29rczsKCgkJLy8gY2FtZWxDYXNlLCBzcGVjaWFsRWFzaW5nIGFuZCBleHBhbmQgY3NzSG9vayBwYXNzCgkJZm9yICggaW5kZXggaW4gcHJvcHMgKSB7CgkJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBpbmRleCApOwoJCQllYXNpbmcgPSBzcGVjaWFsRWFzaW5nWyBuYW1lIF07CgkJCXZhbHVlID0gcHJvcHNbIGluZGV4IF07CgkJCWlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7CgkJCQllYXNpbmcgPSB2YWx1ZVsgMSBdOwoJCQkJdmFsdWUgPSBwcm9wc1sgaW5kZXggXSA9IHZhbHVlWyAwIF07CgkJCX0KCgkJCWlmICggaW5kZXggIT09IG5hbWUgKSB7CgkJCQlwcm9wc1sgbmFtZSBdID0gdmFsdWU7CgkJCQlkZWxldGUgcHJvcHNbIGluZGV4IF07CgkJCX0KCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF07CgkJCWlmICggaG9va3MgJiYgImV4cGFuZCIgaW4gaG9va3MgKSB7CgkJCQl2YWx1ZSA9IGhvb2tzLmV4cGFuZCggdmFsdWUgKTsKCQkJCWRlbGV0ZSBwcm9wc1sgbmFtZSBdOwoKCQkJCS8vIG5vdCBxdWl0ZSAkLmV4dGVuZCwgdGhpcyB3b250IG92ZXJ3cml0ZSBrZXlzIGFscmVhZHkgcHJlc2VudC4KCQkJCS8vIGFsc28gLSByZXVzaW5nICdpbmRleCcgZnJvbSBhYm92ZSBiZWNhdXNlIHdlIGhhdmUgdGhlIGNvcnJlY3QgIm5hbWUiCgkJCQlmb3IgKCBpbmRleCBpbiB2YWx1ZSApIHsKCQkJCQlpZiAoICEoIGluZGV4IGluIHByb3BzICkgKSB7CgkJCQkJCXByb3BzWyBpbmRleCBdID0gdmFsdWVbIGluZGV4IF07CgkJCQkJCXNwZWNpYWxFYXNpbmdbIGluZGV4IF0gPSBlYXNpbmc7CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJc3BlY2lhbEVhc2luZ1sgbmFtZSBdID0gZWFzaW5nOwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIEFuaW1hdGlvbiggZWxlbSwgcHJvcGVydGllcywgb3B0aW9ucyApIHsKCQl2YXIgcmVzdWx0LAoJCQlzdG9wcGVkLAoJCQlpbmRleCA9IDAsCgkJCWxlbmd0aCA9IGFuaW1hdGlvblByZWZpbHRlcnMubGVuZ3RoLAoJCQlkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLmFsd2F5cyggZnVuY3Rpb24oKSB7CgkJCQkvLyBkb24ndCBtYXRjaCBlbGVtIGluIHRoZSA6YW5pbWF0ZWQgc2VsZWN0b3IKCQkJCWRlbGV0ZSB0aWNrLmVsZW07CgkJCX0pLAoJCQl0aWNrID0gZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHN0b3BwZWQgKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQkJdmFyIGN1cnJlbnRUaW1lID0gZnhOb3cgfHwgY3JlYXRlRnhOb3coKSwKCQkJCQlyZW1haW5pbmcgPSBNYXRoLm1heCggMCwgYW5pbWF0aW9uLnN0YXJ0VGltZSArIGFuaW1hdGlvbi5kdXJhdGlvbiAtIGN1cnJlbnRUaW1lICksCgkJCQkJLy8gYXJjaGFpYyBjcmFzaCBidWcgd29uJ3QgYWxsb3cgdXMgdG8gdXNlIDEgLSAoIDAuNSB8fCAwICkgKCMxMjQ5NykKCQkJCQl0ZW1wID0gcmVtYWluaW5nIC8gYW5pbWF0aW9uLmR1cmF0aW9uIHx8IDAsCgkJCQkJcGVyY2VudCA9IDEgLSB0ZW1wLAoJCQkJCWluZGV4ID0gMCwKCQkJCQlsZW5ndGggPSBhbmltYXRpb24udHdlZW5zLmxlbmd0aDsKCgkJCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHsKCQkJCQlhbmltYXRpb24udHdlZW5zWyBpbmRleCBdLnJ1biggcGVyY2VudCApOwoJCQkJfQoKCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBwZXJjZW50LCByZW1haW5pbmcgXSk7CgoJCQkJaWYgKCBwZXJjZW50IDwgMSAmJiBsZW5ndGggKSB7CgkJCQkJcmV0dXJuIHJlbWFpbmluZzsKCQkJCX0gZWxzZSB7CgkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uIF0gKTsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0sCgkJCWFuaW1hdGlvbiA9IGRlZmVycmVkLnByb21pc2UoewoJCQkJZWxlbTogZWxlbSwKCQkJCXByb3BzOiBqUXVlcnkuZXh0ZW5kKCB7fSwgcHJvcGVydGllcyApLAoJCQkJb3B0czogalF1ZXJ5LmV4dGVuZCggdHJ1ZSwgeyBzcGVjaWFsRWFzaW5nOiB7fSB9LCBvcHRpb25zICksCgkJCQlvcmlnaW5hbFByb3BlcnRpZXM6IHByb3BlcnRpZXMsCgkJCQlvcmlnaW5hbE9wdGlvbnM6IG9wdGlvbnMsCgkJCQlzdGFydFRpbWU6IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksCgkJCQlkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbiwKCQkJCXR3ZWVuczogW10sCgkJCQljcmVhdGVUd2VlbjogZnVuY3Rpb24oIHByb3AsIGVuZCApIHsKCQkJCQl2YXIgdHdlZW4gPSBqUXVlcnkuVHdlZW4oIGVsZW0sIGFuaW1hdGlvbi5vcHRzLCBwcm9wLCBlbmQsCgkJCQkJCQlhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nWyBwcm9wIF0gfHwgYW5pbWF0aW9uLm9wdHMuZWFzaW5nICk7CgkJCQkJYW5pbWF0aW9uLnR3ZWVucy5wdXNoKCB0d2VlbiApOwoJCQkJCXJldHVybiB0d2VlbjsKCQkJCX0sCgkJCQlzdG9wOiBmdW5jdGlvbiggZ290b0VuZCApIHsKCQkJCQl2YXIgaW5kZXggPSAwLAoJCQkJCQkvLyBpZiB3ZSBhcmUgZ29pbmcgdG8gdGhlIGVuZCwgd2Ugd2FudCB0byBydW4gYWxsIHRoZSB0d2VlbnMKCQkJCQkJLy8gb3RoZXJ3aXNlIHdlIHNraXAgdGhpcyBwYXJ0CgkJCQkJCWxlbmd0aCA9IGdvdG9FbmQgPyBhbmltYXRpb24udHdlZW5zLmxlbmd0aCA6IDA7CgkJCQkJaWYgKCBzdG9wcGVkICkgewoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9CgkJCQkJc3RvcHBlZCA9IHRydWU7CgkJCQkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCQkJCWFuaW1hdGlvbi50d2VlbnNbIGluZGV4IF0ucnVuKCAxICk7CgkJCQkJfQoKCQkJCQkvLyByZXNvbHZlIHdoZW4gd2UgcGxheWVkIHRoZSBsYXN0IGZyYW1lCgkJCQkJLy8gb3RoZXJ3aXNlLCByZWplY3QKCQkJCQlpZiAoIGdvdG9FbmQgKSB7CgkJCQkJCWRlZmVycmVkLnJlc29sdmVXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgZ290b0VuZCBdICk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJZGVmZXJyZWQucmVqZWN0V2l0aCggZWxlbSwgWyBhbmltYXRpb24sIGdvdG9FbmQgXSApOwoJCQkJCX0KCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0KCQkJfSksCgkJCXByb3BzID0gYW5pbWF0aW9uLnByb3BzOwoKCQlwcm9wRmlsdGVyKCBwcm9wcywgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZyApOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHsKCQkJcmVzdWx0ID0gYW5pbWF0aW9uUHJlZmlsdGVyc1sgaW5kZXggXS5jYWxsKCBhbmltYXRpb24sIGVsZW0sIHByb3BzLCBhbmltYXRpb24ub3B0cyApOwoJCQlpZiAoIHJlc3VsdCApIHsKCQkJCXJldHVybiByZXN1bHQ7CgkJCX0KCQl9CgoJCWpRdWVyeS5tYXAoIHByb3BzLCBjcmVhdGVUd2VlbiwgYW5pbWF0aW9uICk7CgoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGFuaW1hdGlvbi5vcHRzLnN0YXJ0ICkgKSB7CgkJCWFuaW1hdGlvbi5vcHRzLnN0YXJ0LmNhbGwoIGVsZW0sIGFuaW1hdGlvbiApOwoJCX0KCgkJalF1ZXJ5LmZ4LnRpbWVyKAoJCQlqUXVlcnkuZXh0ZW5kKCB0aWNrLCB7CgkJCQllbGVtOiBlbGVtLAoJCQkJYW5pbTogYW5pbWF0aW9uLAoJCQkJcXVldWU6IGFuaW1hdGlvbi5vcHRzLnF1ZXVlCgkJCX0pCgkJKTsKCgkJLy8gYXR0YWNoIGNhbGxiYWNrcyBmcm9tIG9wdGlvbnMKCQlyZXR1cm4gYW5pbWF0aW9uLnByb2dyZXNzKCBhbmltYXRpb24ub3B0cy5wcm9ncmVzcyApCgkJCS5kb25lKCBhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSApCgkJCS5mYWlsKCBhbmltYXRpb24ub3B0cy5mYWlsICkKCQkJLmFsd2F5cyggYW5pbWF0aW9uLm9wdHMuYWx3YXlzICk7Cgl9CgoJalF1ZXJ5LkFuaW1hdGlvbiA9IGpRdWVyeS5leHRlbmQoIEFuaW1hdGlvbiwgewoJCXR3ZWVuZXI6IGZ1bmN0aW9uKCBwcm9wcywgY2FsbGJhY2sgKSB7CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHByb3BzICkgKSB7CgkJCQljYWxsYmFjayA9IHByb3BzOwoJCQkJcHJvcHMgPSBbICIqIiBdOwoJCQl9IGVsc2UgewoJCQkJcHJvcHMgPSBwcm9wcy5zcGxpdCgiICIpOwoJCQl9CgoJCQl2YXIgcHJvcCwKCQkJCWluZGV4ID0gMCwKCQkJCWxlbmd0aCA9IHByb3BzLmxlbmd0aDsKCgkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJcHJvcCA9IHByb3BzWyBpbmRleCBdOwoJCQkJdHdlZW5lcnNbIHByb3AgXSA9IHR3ZWVuZXJzWyBwcm9wIF0gfHwgW107CgkJCQl0d2VlbmVyc1sgcHJvcCBdLnVuc2hpZnQoIGNhbGxiYWNrICk7CgkJCX0KCQl9LAoKCQlwcmVmaWx0ZXI6IGZ1bmN0aW9uKCBjYWxsYmFjaywgcHJlcGVuZCApIHsKCQkJaWYgKCBwcmVwZW5kICkgewoJCQkJYW5pbWF0aW9uUHJlZmlsdGVycy51bnNoaWZ0KCBjYWxsYmFjayApOwoJCQl9IGVsc2UgewoJCQkJYW5pbWF0aW9uUHJlZmlsdGVycy5wdXNoKCBjYWxsYmFjayApOwoJCQl9CgkJfQoJfSk7CgoJalF1ZXJ5LnNwZWVkID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGZuICkgewoJCXZhciBvcHQgPSBzcGVlZCAmJiB0eXBlb2Ygc3BlZWQgPT09ICJvYmplY3QiID8galF1ZXJ5LmV4dGVuZCgge30sIHNwZWVkICkgOiB7CgkJCWNvbXBsZXRlOiBmbiB8fCAhZm4gJiYgZWFzaW5nIHx8CgkJCQlqUXVlcnkuaXNGdW5jdGlvbiggc3BlZWQgKSAmJiBzcGVlZCwKCQkJZHVyYXRpb246IHNwZWVkLAoJCQllYXNpbmc6IGZuICYmIGVhc2luZyB8fCBlYXNpbmcgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKCBlYXNpbmcgKSAmJiBlYXNpbmcKCQl9OwoKCQlvcHQuZHVyYXRpb24gPSBqUXVlcnkuZngub2ZmID8gMCA6IHR5cGVvZiBvcHQuZHVyYXRpb24gPT09ICJudW1iZXIiID8gb3B0LmR1cmF0aW9uIDoKCQkJb3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHMgPyBqUXVlcnkuZnguc3BlZWRzWyBvcHQuZHVyYXRpb24gXSA6IGpRdWVyeS5meC5zcGVlZHMuX2RlZmF1bHQ7CgoJCS8vIG5vcm1hbGl6ZSBvcHQucXVldWUgLSB0cnVlL3VuZGVmaW5lZC9udWxsIC0+ICJmeCIKCQlpZiAoIG9wdC5xdWV1ZSA9PSBudWxsIHx8IG9wdC5xdWV1ZSA9PT0gdHJ1ZSApIHsKCQkJb3B0LnF1ZXVlID0gImZ4IjsKCQl9CgoJCS8vIFF1ZXVlaW5nCgkJb3B0Lm9sZCA9IG9wdC5jb21wbGV0ZTsKCgkJb3B0LmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIG9wdC5vbGQgKSApIHsKCQkJCW9wdC5vbGQuY2FsbCggdGhpcyApOwoJCQl9CgoJCQlpZiAoIG9wdC5xdWV1ZSApIHsKCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCBvcHQucXVldWUgKTsKCQkJfQoJCX07CgoJCXJldHVybiBvcHQ7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWZhZGVUbzogZnVuY3Rpb24oIHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjayApIHsKCgkJCS8vIHNob3cgYW55IGhpZGRlbiBlbGVtZW50cyBhZnRlciBzZXR0aW5nIG9wYWNpdHkgdG8gMAoJCQlyZXR1cm4gdGhpcy5maWx0ZXIoIGlzSGlkZGVuICkuY3NzKCAib3BhY2l0eSIsIDAgKS5zaG93KCkKCgkJCQkvLyBhbmltYXRlIHRvIHRoZSB2YWx1ZSBzcGVjaWZpZWQKCQkJCS5lbmQoKS5hbmltYXRlKHsgb3BhY2l0eTogdG8gfSwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTsKCQl9LAoJCWFuaW1hdGU6IGZ1bmN0aW9uKCBwcm9wLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsKCQkJdmFyIGVtcHR5ID0galF1ZXJ5LmlzRW1wdHlPYmplY3QoIHByb3AgKSwKCQkJCW9wdGFsbCA9IGpRdWVyeS5zcGVlZCggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSwKCQkJCWRvQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7CgkJCQkJLy8gT3BlcmF0ZSBvbiBhIGNvcHkgb2YgcHJvcCBzbyBwZXItcHJvcGVydHkgZWFzaW5nIHdvbid0IGJlIGxvc3QKCQkJCQl2YXIgYW5pbSA9IEFuaW1hdGlvbiggdGhpcywgalF1ZXJ5LmV4dGVuZCgge30sIHByb3AgKSwgb3B0YWxsICk7CgoJCQkJCS8vIEVtcHR5IGFuaW1hdGlvbnMsIG9yIGZpbmlzaGluZyByZXNvbHZlcyBpbW1lZGlhdGVseQoJCQkJCWlmICggZW1wdHkgfHwgalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiZmluaXNoIiApICkgewoJCQkJCQlhbmltLnN0b3AoIHRydWUgKTsKCQkJCQl9CgkJCQl9OwoJCQkJZG9BbmltYXRpb24uZmluaXNoID0gZG9BbmltYXRpb247CgoJCQlyZXR1cm4gZW1wdHkgfHwgb3B0YWxsLnF1ZXVlID09PSBmYWxzZSA/CgkJCQl0aGlzLmVhY2goIGRvQW5pbWF0aW9uICkgOgoJCQkJdGhpcy5xdWV1ZSggb3B0YWxsLnF1ZXVlLCBkb0FuaW1hdGlvbiApOwoJCX0sCgkJc3RvcDogZnVuY3Rpb24oIHR5cGUsIGNsZWFyUXVldWUsIGdvdG9FbmQgKSB7CgkJCXZhciBzdG9wUXVldWUgPSBmdW5jdGlvbiggaG9va3MgKSB7CgkJCQl2YXIgc3RvcCA9IGhvb2tzLnN0b3A7CgkJCQlkZWxldGUgaG9va3Muc3RvcDsKCQkJCXN0b3AoIGdvdG9FbmQgKTsKCQkJfTsKCgkJCWlmICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJZ290b0VuZCA9IGNsZWFyUXVldWU7CgkJCQljbGVhclF1ZXVlID0gdHlwZTsKCQkJCXR5cGUgPSB1bmRlZmluZWQ7CgkJCX0KCQkJaWYgKCBjbGVhclF1ZXVlICYmIHR5cGUgIT09IGZhbHNlICkgewoJCQkJdGhpcy5xdWV1ZSggdHlwZSB8fCAiZngiLCBbXSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJdmFyIGRlcXVldWUgPSB0cnVlLAoJCQkJCWluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyAicXVldWVIb29rcyIsCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlkYXRhID0galF1ZXJ5Ll9kYXRhKCB0aGlzICk7CgoJCQkJaWYgKCBpbmRleCApIHsKCQkJCQlpZiAoIGRhdGFbIGluZGV4IF0gJiYgZGF0YVsgaW5kZXggXS5zdG9wICkgewoJCQkJCQlzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWZvciAoIGluZGV4IGluIGRhdGEgKSB7CgkJCQkJCWlmICggZGF0YVsgaW5kZXggXSAmJiBkYXRhWyBpbmRleCBdLnN0b3AgJiYgcnJ1bi50ZXN0KCBpbmRleCApICkgewoJCQkJCQkJc3RvcFF1ZXVlKCBkYXRhWyBpbmRleCBdICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmICh0eXBlID09IG51bGwgfHwgdGltZXJzWyBpbmRleCBdLnF1ZXVlID09PSB0eXBlKSApIHsKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggZ290b0VuZCApOwoJCQkJCQlkZXF1ZXVlID0gZmFsc2U7CgkJCQkJCXRpbWVycy5zcGxpY2UoIGluZGV4LCAxICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIHN0YXJ0IHRoZSBuZXh0IGluIHRoZSBxdWV1ZSBpZiB0aGUgbGFzdCBzdGVwIHdhc24ndCBmb3JjZWQKCQkJCS8vIHRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2ggd2lsbCBkZXF1ZXVlCgkJCQkvLyBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZAoJCQkJaWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQl9CgkJCX0pOwoJCX0sCgkJZg==", "base64"));
  res.write(new Buffer("aW5pc2g6IGZ1bmN0aW9uKCB0eXBlICkgewoJCQlpZiAoIHR5cGUgIT09IGZhbHNlICkgewoJCQkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCQkJfQoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJdmFyIGluZGV4LAoJCQkJCWRhdGEgPSBqUXVlcnkuX2RhdGEoIHRoaXMgKSwKCQkJCQlxdWV1ZSA9IGRhdGFbIHR5cGUgKyAicXVldWUiIF0sCgkJCQkJaG9va3MgPSBkYXRhWyB0eXBlICsgInF1ZXVlSG9va3MiIF0sCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlsZW5ndGggPSBxdWV1ZSA/IHF1ZXVlLmxlbmd0aCA6IDA7CgoJCQkJLy8gZW5hYmxlIGZpbmlzaGluZyBmbGFnIG9uIHByaXZhdGUgZGF0YQoJCQkJZGF0YS5maW5pc2ggPSB0cnVlOwoKCQkJCS8vIGVtcHR5IHRoZSBxdWV1ZSBmaXJzdAoJCQkJalF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBbXSApOwoKCQkJCWlmICggaG9va3MgJiYgaG9va3Muc3RvcCApIHsKCQkJCQlob29rcy5zdG9wLmNhbGwoIHRoaXMsIHRydWUgKTsKCQkJCX0KCgkJCQkvLyBsb29rIGZvciBhbnkgYWN0aXZlIGFuaW1hdGlvbnMsIGFuZCBmaW5pc2ggdGhlbQoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmIHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApIHsKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggdHJ1ZSApOwoJCQkJCQl0aW1lcnMuc3BsaWNlKCBpbmRleCwgMSApOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBsb29rIGZvciBhbnkgYW5pbWF0aW9ucyBpbiB0aGUgb2xkIHF1ZXVlIGFuZCBmaW5pc2ggdGhlbQoJCQkJZm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJCQlpZiAoIHF1ZXVlWyBpbmRleCBdICYmIHF1ZXVlWyBpbmRleCBdLmZpbmlzaCApIHsKCQkJCQkJcXVldWVbIGluZGV4IF0uZmluaXNoLmNhbGwoIHRoaXMgKTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gdHVybiBvZmYgZmluaXNoaW5nIGZsYWcKCQkJCWRlbGV0ZSBkYXRhLmZpbmlzaDsKCQkJfSk7CgkJfQoJfSk7CgoJalF1ZXJ5LmVhY2goWyAidG9nZ2xlIiwgInNob3ciLCAiaGlkZSIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJdmFyIGNzc0ZuID0galF1ZXJ5LmZuWyBuYW1lIF07CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXJldHVybiBzcGVlZCA9PSBudWxsIHx8IHR5cGVvZiBzcGVlZCA9PT0gImJvb2xlYW4iID8KCQkJCWNzc0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSA6CgkJCQl0aGlzLmFuaW1hdGUoIGdlbkZ4KCBuYW1lLCB0cnVlICksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7CgkJfTsKCX0pOwoKCS8vIEdlbmVyYXRlIHNob3J0Y3V0cyBmb3IgY3VzdG9tIGFuaW1hdGlvbnMKCWpRdWVyeS5lYWNoKHsKCQlzbGlkZURvd246IGdlbkZ4KCJzaG93IiksCgkJc2xpZGVVcDogZ2VuRngoImhpZGUiKSwKCQlzbGlkZVRvZ2dsZTogZ2VuRngoInRvZ2dsZSIpLAoJCWZhZGVJbjogeyBvcGFjaXR5OiAic2hvdyIgfSwKCQlmYWRlT3V0OiB7IG9wYWNpdHk6ICJoaWRlIiB9LAoJCWZhZGVUb2dnbGU6IHsgb3BhY2l0eTogInRvZ2dsZSIgfQoJfSwgZnVuY3Rpb24oIG5hbWUsIHByb3BzICkgewoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgewoJCQlyZXR1cm4gdGhpcy5hbmltYXRlKCBwcm9wcywgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTsKCQl9OwoJfSk7CgoJalF1ZXJ5LnRpbWVycyA9IFtdOwoJalF1ZXJ5LmZ4LnRpY2sgPSBmdW5jdGlvbigpIHsKCQl2YXIgdGltZXIsCgkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJCWkgPSAwOwoKCQlmeE5vdyA9IGpRdWVyeS5ub3coKTsKCgkJZm9yICggOyBpIDwgdGltZXJzLmxlbmd0aDsgaSsrICkgewoJCQl0aW1lciA9IHRpbWVyc1sgaSBdOwoJCQkvLyBDaGVja3MgdGhlIHRpbWVyIGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlbW92ZWQKCQkJaWYgKCAhdGltZXIoKSAmJiB0aW1lcnNbIGkgXSA9PT0gdGltZXIgKSB7CgkJCQl0aW1lcnMuc3BsaWNlKCBpLS0sIDEgKTsKCQkJfQoJCX0KCgkJaWYgKCAhdGltZXJzLmxlbmd0aCApIHsKCQkJalF1ZXJ5LmZ4LnN0b3AoKTsKCQl9CgkJZnhOb3cgPSB1bmRlZmluZWQ7Cgl9OwoKCWpRdWVyeS5meC50aW1lciA9IGZ1bmN0aW9uKCB0aW1lciApIHsKCQlqUXVlcnkudGltZXJzLnB1c2goIHRpbWVyICk7CgkJaWYgKCB0aW1lcigpICkgewoJCQlqUXVlcnkuZnguc3RhcnQoKTsKCQl9IGVsc2UgewoJCQlqUXVlcnkudGltZXJzLnBvcCgpOwoJCX0KCX07CgoJalF1ZXJ5LmZ4LmludGVydmFsID0gMTM7CgoJalF1ZXJ5LmZ4LnN0YXJ0ID0gZnVuY3Rpb24oKSB7CgkJaWYgKCAhdGltZXJJZCApIHsKCQkJdGltZXJJZCA9IHNldEludGVydmFsKCBqUXVlcnkuZngudGljaywgalF1ZXJ5LmZ4LmludGVydmFsICk7CgkJfQoJfTsKCglqUXVlcnkuZnguc3RvcCA9IGZ1bmN0aW9uKCkgewoJCWNsZWFySW50ZXJ2YWwoIHRpbWVySWQgKTsKCQl0aW1lcklkID0gbnVsbDsKCX07CgoJalF1ZXJ5LmZ4LnNwZWVkcyA9IHsKCQlzbG93OiA2MDAsCgkJZmFzdDogMjAwLAoJCS8vIERlZmF1bHQgc3BlZWQKCQlfZGVmYXVsdDogNDAwCgl9OwoKCgkvLyBCYXNlZCBvZmYgb2YgdGhlIHBsdWdpbiBieSBDbGludCBIZWxmZXJzLCB3aXRoIHBlcm1pc3Npb24uCgkvLyBodHRwOi8vYmxpbmRzaWduYWxzLmNvbS9pbmRleC5waHAvMjAwOS8wNy9qcXVlcnktZGVsYXkvCglqUXVlcnkuZm4uZGVsYXkgPSBmdW5jdGlvbiggdGltZSwgdHlwZSApIHsKCQl0aW1lID0galF1ZXJ5LmZ4ID8galF1ZXJ5LmZ4LnNwZWVkc1sgdGltZSBdIHx8IHRpbWUgOiB0aW1lOwoJCXR5cGUgPSB0eXBlIHx8ICJmeCI7CgoJCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlLCBmdW5jdGlvbiggbmV4dCwgaG9va3MgKSB7CgkJCXZhciB0aW1lb3V0ID0gc2V0VGltZW91dCggbmV4dCwgdGltZSApOwoJCQlob29rcy5zdG9wID0gZnVuY3Rpb24oKSB7CgkJCQljbGVhclRpbWVvdXQoIHRpbWVvdXQgKTsKCQkJfTsKCQl9KTsKCX07CgoKCShmdW5jdGlvbigpIHsKCQkvLyBNaW5pZmllZDogdmFyIGEsYixjLGQsZQoJCXZhciBpbnB1dCwgZGl2LCBzZWxlY3QsIGEsIG9wdDsKCgkJLy8gU2V0dXAKCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCWRpdi5zZXRBdHRyaWJ1dGUoICJjbGFzc05hbWUiLCAidCIgKTsKCQlkaXYuaW5uZXJIVE1MID0gIiAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7CgkJYSA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWyAwIF07CgoJCS8vIEZpcnN0IGJhdGNoIG9mIHRlc3RzLgoJCXNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpOwoJCW9wdCA9IHNlbGVjdC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIikgKTsKCQlpbnB1dCA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKVsgMCBdOwoKCQlhLnN0eWxlLmNzc1RleHQgPSAidG9wOjFweCI7CgoJCS8vIFRlc3Qgc2V0QXR0cmlidXRlIG9uIGNhbWVsQ2FzZSBjbGFzcy4gSWYgaXQgd29ya3MsIHdlIG5lZWQgYXR0ckZpeGVzIHdoZW4gZG9pbmcgZ2V0L3NldEF0dHJpYnV0ZSAoaWU2LzcpCgkJc3VwcG9ydC5nZXRTZXRBdHRyaWJ1dGUgPSBkaXYuY2xhc3NOYW1lICE9PSAidCI7CgoJCS8vIEdldCB0aGUgc3R5bGUgaW5mb3JtYXRpb24gZnJvbSBnZXRBdHRyaWJ1dGUKCQkvLyAoSUUgdXNlcyAuY3NzVGV4dCBpbnN0ZWFkKQoJCXN1cHBvcnQuc3R5bGUgPSAvdG9wLy50ZXN0KCBhLmdldEF0dHJpYnV0ZSgic3R5bGUiKSApOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCBVUkxzIGFyZW4ndCBtYW5pcHVsYXRlZAoJCS8vIChJRSBub3JtYWxpemVzIGl0IGJ5IGRlZmF1bHQpCgkJc3VwcG9ydC5ocmVmTm9ybWFsaXplZCA9IGEuZ2V0QXR0cmlidXRlKCJocmVmIikgPT09ICIvYSI7CgoJCS8vIENoZWNrIHRoZSBkZWZhdWx0IGNoZWNrYm94L3JhZGlvIHZhbHVlICgiIiBvbiBXZWJLaXQ7ICJvbiIgZWxzZXdoZXJlKQoJCXN1cHBvcnQuY2hlY2tPbiA9ICEhaW5wdXQudmFsdWU7CgoJCS8vIE1ha2Ugc3VyZSB0aGF0IGEgc2VsZWN0ZWQtYnktZGVmYXVsdCBvcHRpb24gaGFzIGEgd29ya2luZyBzZWxlY3RlZCBwcm9wZXJ0eS4KCQkvLyAoV2ViS2l0IGRlZmF1bHRzIHRvIGZhbHNlIGluc3RlYWQgb2YgdHJ1ZSwgSUUgdG9vLCBpZiBpdCdzIGluIGFuIG9wdGdyb3VwKQoJCXN1cHBvcnQub3B0U2VsZWN0ZWQgPSBvcHQuc2VsZWN0ZWQ7CgoJCS8vIFRlc3RzIGZvciBlbmN0eXBlIHN1cHBvcnQgb24gYSBmb3JtICgjNjc0MykKCQlzdXBwb3J0LmVuY3R5cGUgPSAhIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImZvcm0iKS5lbmN0eXBlOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCB0aGUgb3B0aW9ucyBpbnNpZGUgZGlzYWJsZWQgc2VsZWN0cyBhcmVuJ3QgbWFya2VkIGFzIGRpc2FibGVkCgkJLy8gKFdlYktpdCBtYXJrcyB0aGVtIGFzIGRpc2FibGVkKQoJCXNlbGVjdC5kaXNhYmxlZCA9IHRydWU7CgkJc3VwcG9ydC5vcHREaXNhYmxlZCA9ICFvcHQuZGlzYWJsZWQ7CgoJCS8vIFN1cHBvcnQ6IElFOCBvbmx5CgkJLy8gQ2hlY2sgaWYgd2UgY2FuIHRydXN0IGdldEF0dHJpYnV0ZSgidmFsdWUiKQoJCWlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImlucHV0IiApOwoJCWlucHV0LnNldEF0dHJpYnV0ZSggInZhbHVlIiwgIiIgKTsKCQlzdXBwb3J0LmlucHV0ID0gaW5wdXQuZ2V0QXR0cmlidXRlKCAidmFsdWUiICkgPT09ICIiOwoKCQkvLyBDaGVjayBpZiBhbiBpbnB1dCBtYWludGFpbnMgaXRzIHZhbHVlIGFmdGVyIGJlY29taW5nIGEgcmFkaW8KCQlpbnB1dC52YWx1ZSA9ICJ0IjsKCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ0eXBlIiwgInJhZGlvIiApOwoJCXN1cHBvcnQucmFkaW9WYWx1ZSA9IGlucHV0LnZhbHVlID09PSAidCI7Cgl9KSgpOwoKCgl2YXIgcnJldHVybiA9IC9cci9nOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCXZhbDogZnVuY3Rpb24oIHZhbHVlICkgewoJCQl2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbiwKCQkJCWVsZW0gPSB0aGlzWzBdOwoKCQkJaWYgKCAhYXJndW1lbnRzLmxlbmd0aCApIHsKCQkJCWlmICggZWxlbSApIHsKCQkJCQlob29rcyA9IGpRdWVyeS52YWxIb29rc1sgZWxlbS50eXBlIF0gfHwgalF1ZXJ5LnZhbEhvb2tzWyBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgXTsKCgkJCQkJaWYgKCBob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCAidmFsdWUiICkpICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCXJldHVybiByZXQ7CgkJCQkJfQoKCQkJCQlyZXQgPSBlbGVtLnZhbHVlOwoKCQkJCQlyZXR1cm4gdHlwZW9mIHJldCA9PT0gInN0cmluZyIgPwoJCQkJCQkvLyBoYW5kbGUgbW9zdCBjb21tb24gc3RyaW5nIGNhc2VzCgkJCQkJCXJldC5yZXBsYWNlKHJyZXR1cm4sICIiKSA6CgkJCQkJCS8vIGhhbmRsZSBjYXNlcyB3aGVyZSB2YWx1ZSBpcyBudWxsL3VuZGVmIG9yIG51bWJlcgoJCQkJCQlyZXQgPT0gbnVsbCA/ICIiIDogcmV0OwoJCQkJfQoKCQkJCXJldHVybjsKCQkJfQoKCQkJaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApOwoKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHsKCQkJCXZhciB2YWw7CgoJCQkJaWYgKCB0aGlzLm5vZGVUeXBlICE9PSAxICkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAoIGlzRnVuY3Rpb24gKSB7CgkJCQkJdmFsID0gdmFsdWUuY2FsbCggdGhpcywgaSwgalF1ZXJ5KCB0aGlzICkudmFsKCkgKTsKCQkJCX0gZWxzZSB7CgkJCQkJdmFsID0gdmFsdWU7CgkJCQl9CgoJCQkJLy8gVHJlYXQgbnVsbC91bmRlZmluZWQgYXMgIiI7IGNvbnZlcnQgbnVtYmVycyB0byBzdHJpbmcKCQkJCWlmICggdmFsID09IG51bGwgKSB7CgkJCQkJdmFsID0gIiI7CgkJCQl9IGVsc2UgaWYgKCB0eXBlb2YgdmFsID09PSAibnVtYmVyIiApIHsKCQkJCQl2YWwgKz0gIiI7CgkJCQl9IGVsc2UgaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsICkgKSB7CgkJCQkJdmFsID0galF1ZXJ5Lm1hcCggdmFsLCBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQkJCXJldHVybiB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1ZSArICIiOwoJCQkJCX0pOwoJCQkJfQoKCQkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyB0aGlzLnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIHRoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdOwoKCQkJCS8vIElmIHNldCByZXR1cm5zIHVuZGVmaW5lZCwgZmFsbCBiYWNrIHRvIG5vcm1hbCBzZXR0aW5nCgkJCQlpZiAoICFob29rcyB8fCAhKCJzZXQiIGluIGhvb2tzKSB8fCBob29rcy5zZXQoIHRoaXMsIHZhbCwgInZhbHVlIiApID09PSB1bmRlZmluZWQgKSB7CgkJCQkJdGhpcy52YWx1ZSA9IHZhbDsKCQkJCX0KCQkJfSk7CgkJfQoJfSk7CgoJalF1ZXJ5LmV4dGVuZCh7CgkJdmFsSG9va3M6IHsKCQkJb3B0aW9uOiB7CgkJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXZhciB2YWwgPSBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCAidmFsdWUiICk7CgkJCQkJcmV0dXJuIHZhbCAhPSBudWxsID8KCQkJCQkJdmFsIDoKCQkJCQkJLy8gU3VwcG9ydDogSUUxMC0xMSsKCQkJCQkJLy8gb3B0aW9uLnRleHQgdGhyb3dzIGV4Y2VwdGlvbnMgKCMxNDY4NiwgIzE0ODU4KQoJCQkJCQlqUXVlcnkudHJpbSggalF1ZXJ5LnRleHQoIGVsZW0gKSApOwoJCQkJfQoJCQl9LAoJCQlzZWxlY3Q6IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIHZhbHVlLCBvcHRpb24sCgkJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJCWluZGV4ID0gZWxlbS5zZWxlY3RlZEluZGV4LAoJCQkJCQlvbmUgPSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIiB8fCBpbmRleCA8IDAsCgkJCQkJCXZhbHVlcyA9IG9uZSA/IG51bGwgOiBbXSwKCQkJCQkJbWF4ID0gb25lID8gaW5kZXggKyAxIDogb3B0aW9ucy5sZW5ndGgsCgkJCQkJCWkgPSBpbmRleCA8IDAgPwoJCQkJCQkJbWF4IDoKCQkJCQkJCW9uZSA/IGluZGV4IDogMDsKCgkJCQkJLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgc2VsZWN0ZWQgb3B0aW9ucwoJCQkJCWZvciAoIDsgaSA8IG1heDsgaSsrICkgewoJCQkJCQlvcHRpb24gPSBvcHRpb25zWyBpIF07CgoJCQkJCQkvLyBvbGRJRSBkb2Vzbid0IHVwZGF0ZSBzZWxlY3RlZCBhZnRlciBmb3JtIHJlc2V0ICgjMjU1MSkKCQkJCQkJaWYgKCAoIG9wdGlvbi5zZWxlY3RlZCB8fCBpID09PSBpbmRleCApICYmCgkJCQkJCQkJLy8gRG9uJ3QgcmV0dXJuIG9wdGlvbnMgdGhhdCBhcmUgZGlzYWJsZWQgb3IgaW4gYSBkaXNhYmxlZCBvcHRncm91cAoJCQkJCQkJCSggc3VwcG9ydC5vcHREaXNhYmxlZCA/ICFvcHRpb24uZGlzYWJsZWQgOiBvcHRpb24uZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpID09PSBudWxsICkgJiYKCQkJCQkJCQkoICFvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZCB8fCAhalF1ZXJ5Lm5vZGVOYW1lKCBvcHRpb24ucGFyZW50Tm9kZSwgIm9wdGdyb3VwIiApICkgKSB7CgoJCQkJCQkJLy8gR2V0IHRoZSBzcGVjaWZpYyB2YWx1ZSBmb3IgdGhlIG9wdGlvbgoJCQkJCQkJdmFsdWUgPSBqUXVlcnkoIG9wdGlvbiApLnZhbCgpOwoKCQkJCQkJCS8vIFdlIGRvbid0IG5lZWQgYW4gYXJyYXkgZm9yIG9uZSBzZWxlY3RzCgkJCQkJCQlpZiAoIG9uZSApIHsKCQkJCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQkJCQl9CgoJCQkJCQkJLy8gTXVsdGktU2VsZWN0cyByZXR1cm4gYW4gYXJyYXkKCQkJCQkJCXZhbHVlcy5wdXNoKCB2YWx1ZSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQlyZXR1cm4gdmFsdWVzOwoJCQkJfSwKCgkJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCQl2YXIgb3B0aW9uU2V0LCBvcHRpb24sCgkJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJCXZhbHVlcyA9IGpRdWVyeS5tYWtlQXJyYXkoIHZhbHVlICksCgkJCQkJCWkgPSBvcHRpb25zLmxlbmd0aDsKCgkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCW9wdGlvbiA9IG9wdGlvbnNbIGkgXTsKCgkJCQkJCWlmICggalF1ZXJ5LmluQXJyYXkoIGpRdWVyeS52YWxIb29rcy5vcHRpb24uZ2V0KCBvcHRpb24gKSwgdmFsdWVzICkgPj0gMCApIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRTYKCQkJCQkJCS8vIFdoZW4gbmV3IG9wdGlvbiBlbGVtZW50IGlzIGFkZGVkIHRvIHNlbGVjdCBib3ggd2UgbmVlZCB0bwoJCQkJCQkJLy8gZm9yY2UgcmVmbG93IG9mIG5ld2x5IGFkZGVkIG5vZGUgaW4gb3JkZXIgdG8gd29ya2Fyb3VuZCBkZWxheQoJCQkJCQkJLy8gb2YgaW5pdGlhbGl6YXRpb24gcHJvcGVydGllcwoJCQkJCQkJdHJ5IHsKCQkJCQkJCQlvcHRpb24uc2VsZWN0ZWQgPSBvcHRpb25TZXQgPSB0cnVlOwoKCQkJCQkJCX0gY2F0Y2ggKCBfICkgewoKCQkJCQkJCQkvLyBXaWxsIGJlIGV4ZWN1dGVkIG9ubHkgaW4gSUU2CgkJCQkJCQkJb3B0aW9uLnNjcm9sbEhlaWdodDsKCQkJCQkJCX0KCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlvcHRpb24uc2VsZWN0ZWQgPSBmYWxzZTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gRm9yY2UgYnJvd3NlcnMgdG8gYmVoYXZlIGNvbnNpc3RlbnRseSB3aGVuIG5vbi1tYXRjaGluZyB2YWx1ZSBpcyBzZXQKCQkJCQlpZiAoICFvcHRpb25TZXQgKSB7CgkJCQkJCWVsZW0uc2VsZWN0ZWRJbmRleCA9IC0xOwoJCQkJCX0KCgkJCQkJcmV0dXJuIG9wdGlvbnM7CgkJCQl9CgkJCX0KCQl9Cgl9KTsKCgkvLyBSYWRpb3MgYW5kIGNoZWNrYm94ZXMgZ2V0dGVyL3NldHRlcgoJalF1ZXJ5LmVhY2goWyAicmFkaW8iLCAiY2hlY2tib3giIF0sIGZ1bmN0aW9uKCkgewoJCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdID0gewoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCWlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7CgkJCQkJcmV0dXJuICggZWxlbS5jaGVja2VkID0galF1ZXJ5LmluQXJyYXkoIGpRdWVyeShlbGVtKS52YWwoKSwgdmFsdWUgKSA+PSAwICk7CgkJCQl9CgkJCX0KCQl9OwoJCWlmICggIXN1cHBvcnQuY2hlY2tPbiApIHsKCQkJalF1ZXJ5LnZhbEhvb2tzWyB0aGlzIF0uZ2V0ID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBTdXBwb3J0OiBXZWJraXQKCQkJCS8vICIiIGlzIHJldHVybmVkIGluc3RlYWQgb2YgIm9uIiBpZiBhIHZhbHVlIGlzbid0IHNwZWNpZmllZAoJCQkJcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpID09PSBudWxsID8gIm9uIiA6IGVsZW0udmFsdWU7CgkJCX07CgkJfQoJfSk7CgoKCgoJdmFyIG5vZGVIb29rLCBib29sSG9vaywKCQlhdHRySGFuZGxlID0galF1ZXJ5LmV4cHIuYXR0ckhhbmRsZSwKCQlydXNlRGVmYXVsdCA9IC9eKD86Y2hlY2tlZHxzZWxlY3RlZCkkL2ksCgkJZ2V0U2V0QXR0cmlidXRlID0gc3VwcG9ydC5nZXRTZXRBdHRyaWJ1dGUsCgkJZ2V0U2V0SW5wdXQgPSBzdXBwb3J0LmlucHV0OwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWF0dHI6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgalF1ZXJ5LmF0dHIsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApOwoJCX0sCgoJCXJlbW92ZUF0dHI6IGZ1bmN0aW9uKCBuYW1lICkgewoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIHRoaXMsIG5hbWUgKTsKCQkJfSk7CgkJfQoJfSk7CgoJalF1ZXJ5LmV4dGVuZCh7CgkJYXR0cjogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIHZhbHVlICkgewoJCQl2YXIgaG9va3MsIHJldCwKCQkJCW5UeXBlID0gZWxlbS5ub2RlVHlwZTsKCgkJCS8vIGRvbid0IGdldC9zZXQgYXR0cmlidXRlcyBvbiB0ZXh0LCBjb21tZW50IGFuZCBhdHRyaWJ1dGUgbm9kZXMKCQkJaWYgKCAhZWxlbSB8fCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMiApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gRmFsbGJhY2sgdG8gcHJvcCB3aGVuIGF0dHJpYnV0ZXMgYXJlIG5vdCBzdXBwb3J0ZWQKCQkJaWYgKCB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUgPT09IHN0cnVuZGVmaW5lZCApIHsKCQkJCXJldHVybiBqUXVlcnkucHJvcCggZWxlbSwgbmFtZSwgdmFsdWUgKTsKCQkJfQoKCQkJLy8gQWxsIGF0dHJpYnV0ZXMgYXJlIGxvd2VyY2FzZQoJCQkvLyBHcmFiIG5lY2Vzc2FyeSBob29rIGlmIG9uZSBpcyBkZWZpbmVkCgkJCWlmICggblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApICkgewoJCQkJbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCQkJCWhvb2tzID0galF1ZXJ5LmF0dHJIb29rc1sgbmFtZSBdIHx8CgkJCQkJKCBqUXVlcnkuZXhwci5tYXRjaC5ib29sLnRlc3QoIG5hbWUgKSA/IGJvb2xIb29rIDogbm9kZUhvb2sgKTsKCQkJfQoKCQkJaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkgewoKCQkJCWlmICggdmFsdWUgPT09IG51bGwgKSB7CgkJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTsKCgkJCQl9IGVsc2UgaWYgKCBob29rcyAmJiAic2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApKSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiByZXQ7CgoJCQkJfSBlbHNlIHsKCQkJCQllbGVtLnNldEF0dHJpYnV0ZSggbmFtZSwgdmFsdWUgKyAiIiApOwoJCQkJCXJldHVybiB2YWx1ZTsKCQkJCX0KCgkJCX0gZWxzZSBpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSkgIT09IG51bGwgKSB7CgkJCQlyZXR1cm4gcmV0OwoKCQkJfSBlbHNlIHsKCQkJCXJldCA9IGpRdWVyeS5maW5kLmF0dHIoIGVsZW0sIG5hbWUgKTsKCgkJCQkvLyBOb24tZXhpc3RlbnQgYXR0cmlidXRlcyByZXR1cm4gbnVsbCwgd2Ugbm9ybWFsaXplIHRvIHVuZGVmaW5lZAoJCQkJcmV0dXJuIHJldCA9PSBudWxsID8KCQkJCQl1bmRlZmluZWQgOgoJCQkJCXJldDsKCQkJfQoJCX0sCgoJCXJlbW92ZUF0dHI6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJdmFyIG5hbWUsIHByb3BOYW1lLAoJCQkJaSA9IDAsCgkJCQlhdHRyTmFtZXMgPSB2YWx1ZSAmJiB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICk7CgoJCQlpZiAoIGF0dHJOYW1lcyAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQkJd2hpbGUgKCAobmFtZSA9IGF0dHJOYW1lc1tpKytdKSApIHsKCQkJCQlwcm9wTmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCgkJCQkJLy8gQm9vbGVhbiBhdHRyaWJ1dGVzIGdldCBzcGVjaWFsIHRyZWF0bWVudCAoIzEwODcwKQoJCQkJCWlmICggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgKSB7CgkJCQkJCS8vIFNldCBjb3JyZXNwb25kaW5nIHByb3BlcnR5IHRvIGZhbHNlCgkJCQkJCWlmICggZ2V0U2V0SW5wdXQgJiYgZ2V0U2V0QXR0cmlidXRlIHx8ICFydXNlRGVmYXVsdC50ZXN0KCBuYW1lICkgKSB7CgkJCQkJCQllbGVtWyBwcm9wTmFtZSBdID0gZmFsc2U7CgkJCQkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJCQkJLy8gQWxzbyBjbGVhciBkZWZhdWx0Q2hlY2tlZC9kZWZhdWx0U2VsZWN0ZWQgKGlmIGFwcHJvcHJpYXRlKQoJCQkJCQl9IGVsc2UgewoJCQkJCQkJZWxlbVsgalF1ZXJ5LmNhbWVsQ2FzZSggImRlZmF1bHQtIiArIG5hbWUgKSBdID0KCQkJCQkJCQllbGVtWyBwcm9wTmFtZSBdID0gZmFsc2U7CgkJCQkJCX0KCgkJCQkJLy8gU2VlICM5Njk5IGZvciBleHBsYW5hdGlvbiBvZiB0aGlzIGFwcHJvYWNoIChzZXR0aW5nIGZpcnN0LCB0aGVuIHJlbW92YWwpCgkJCQkJfSBlbHNlIHsKCQkJCQkJalF1ZXJ5LmF0dHIoIGVsZW0sIG5hbWUsICIiICk7CgkJCQkJfQoKCQkJCQllbGVtLnJlbW92ZUF0dHJpYnV0ZSggZ2V0U2V0QXR0cmlidXRlID8gbmFtZSA6IHByb3BOYW1lICk7CgkJCQl9CgkJCX0KCQl9LAoKCQlhdHRySG9va3M6IHsKCQkJdHlwZTogewoJCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCQkJaWYgKCAhc3VwcG9ydC5yYWRpb1ZhbHVlICYmIHZhbHVlID09PSAicmFkaW8iICYmIGpRdWVyeS5ub2RlTmFtZShlbGVtLCAiaW5wdXQiKSApIHsKCQkJCQkJLy8gU2V0dGluZyB0aGUgdHlwZSBvbiBhIHJhZGlvIGJ1dHRvbiBhZnRlciB0aGUgdmFsdWUgcmVzZXRzIHRoZSB2YWx1ZSBpbiBJRTYtOQoJCQkJCQkvLyBSZXNldCB2YWx1ZSB0byBkZWZhdWx0IGluIGNhc2UgdHlwZSBpcyBzZXQgYWZ0ZXIgdmFsdWUgZHVyaW5nIGNyZWF0aW9uCgkJCQkJCXZhciB2YWwgPSBlbGVtLnZhbHVlOwoJCQkJCQllbGVtLnNldEF0dHJpYnV0ZSggInR5cGUiLCB2YWx1ZSApOwoJCQkJCQlpZiAoIHZhbCApIHsKCQkJCQkJCWVsZW0udmFsdWUgPSB2YWw7CgkJCQkJCX0KCQkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCX0pOwoKCS8vIEhvb2sgZm9yIGJvb2xlYW4gYXR0cmlidXRlcwoJYm9vbEhvb2sgPSB7CgkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCWlmICggdmFsdWUgPT09IGZhbHNlICkgewoJCQkJLy8gUmVtb3ZlIGJvb2xlYW4gYXR0cmlidXRlcyB3aGVuIHNldCB0byBmYWxzZQoJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTsKCQkJfSBlbHNlIGlmICggZ2V0U2V0SW5wdXQgJiYgZ2V0U2V0QXR0cmlidXRlIHx8ICFydXNlRGVmYXVsdC50ZXN0KCBuYW1lICkgKSB7CgkJCQkvLyBJRTw4IG5lZWRzIHRoZSAqcHJvcGVydHkqIG5hbWUKCQkJCWVsZW0uc2V0QXR0cmlidXRlKCAhZ2V0U2V0QXR0cmlidXRlICYmIGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZSwgbmFtZSApOwoKCQkJLy8gVXNlIGRlZmF1bHRDaGVja2VkIGFuZCBkZWZhdWx0U2VsZWN0ZWQgZm9yIG9sZElFCgkJCX0gZWxzZSB7CgkJCQllbGVtWyBqUXVlcnkuY2FtZWxDYXNlKCAiZGVmYXVsdC0iICsgbmFtZSApIF0gPSBlbGVtWyBuYW1lIF0gPSB0cnVlOwoJCQl9CgoJCQlyZXR1cm4gbmFtZTsKCQl9Cgl9OwoKCS8vIFJldHJpZXZlIGJvb2xlYW5zIHNwZWNpYWxseQoJalF1ZXJ5LmVhY2goIGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKCAvXHcrL2cgKSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgoJCXZhciBnZXR0ZXIgPSBhdHRySGFuZGxlWyBuYW1lIF0gfHwgalF1ZXJ5LmZpbmQuYXR0cjsKCgkJYXR0ckhhbmRsZVsgbmFtZSBdID0gZ2V0U2V0SW5wdXQgJiYgZ2V0U2V0QXR0cmlidXRlIHx8ICFydXNlRGVmYXVsdC50ZXN0KCBuYW1lICkgPwoJCQlmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCQl2YXIgcmV0LCBoYW5kbGU7CgkJCQlpZiAoICFpc1hNTCApIHsKCQkJCQkvLyBBdm9pZCBhbiBpbmZpbml0ZSBsb29wIGJ5IHRlbXBvcmFyaWx5IHJlbW92aW5nIHRoaXMgZnVuY3Rpb24gZnJvbSB0aGUgZ2V0dGVyCgkJCQkJaGFuZGxlID0gYXR0ckhhbmRsZVsgbmFtZSBdOwoJCQkJCWF0dHJIYW5kbGVbIG5hbWUgXSA9IHJldDsKCQkJCQlyZXQgPSBnZXR0ZXIoIGVsZW0sIG5hbWUsIGlzWE1MICkgIT0gbnVsbCA/CgkJCQkJCW5hbWUudG9Mb3dlckNhc2UoKSA6CgkJCQkJCW51bGw7CgkJCQkJYXR0ckhhbmRsZVsgbmFtZSBdID0gaGFuZGxlOwoJCQkJfQoJCQkJcmV0dXJuIHJldDsKCQkJfSA6CgkJCWZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHsKCQkJCWlmICggIWlzWE1MICkgewoJCQkJCXJldHVybiBlbGVtWyBqUXVlcnkuY2FtZWxDYXNlKCAiZGVmYXVsdC0iICsgbmFtZSApIF0gPwoJCQkJCQluYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJCQludWxsOwoJCQkJfQoJCQl9OwoJfSk7CgoJLy8gZml4IG9sZElFIGF0dHJvcGVydGllcwoJaWYgKCAhZ2V0U2V0SW5wdXQgfHwgIWdldFNldEF0dHJpYnV0ZSApIHsKCQlqUXVlcnkuYXR0ckhvb2tzLnZhbHVlID0gewoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgbmFtZSApIHsKCQkJCWlmICggalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAiaW5wdXQiICkgKSB7CgkJCQkJLy8gRG9lcyBub3QgcmV0dXJuIHNvIHRoYXQgc2V0QXR0cmlidXRlIGlzIGFsc28gdXNlZAoJCQkJCWVsZW0uZGVmYXVsdFZhbHVlID0gdmFsdWU7CgkJCQl9IGVsc2UgewoJCQkJCS8vIFVzZSBub2RlSG9vayBpZiBkZWZpbmVkICgjMTk1NCk7IG90aGVyd2lzZSBzZXRBdHRyaWJ1dGUgaXMgZmluZQoJCQkJCXJldHVybiBub2RlSG9vayAmJiBub2RlSG9vay5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICk7CgkJCQl9CgkJCX0KCQl9OwoJfQoKCS8vIElFNi83IGRvIG5vdCBzdXBwb3J0IGdldHRpbmcvc2V0dGluZyBzb21lIGF0dHJpYnV0ZXMgd2l0aCBnZXQvc2V0QXR0cmlidXRlCglpZiAoICFnZXRTZXRBdHRyaWJ1dGUgKSB7CgoJCS8vIFVzZSB0aGlzIGZvciBhbnkgYXR0cmlidXRlIGluIElFNi83CgkJLy8gVGhpcyBmaXhlcyBhbG1vc3QgZXZlcnkgSUU2LzcgaXNzdWUKCQlub2RlSG9vayA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCQkvLyBTZXQgdGhlIGV4aXN0aW5nIG9yIGNyZWF0ZSBhIG5ldyBhdHRyaWJ1dGUgbm9kZQoJCQkJdmFyIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSggbmFtZSApOwoJCQkJaWYgKCAhcmV0ICkgewoJCQkJCWVsZW0uc2V0QXR0cmlidXRlTm9kZSgKCQkJCQkJKHJldCA9IGVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoIG5hbWUgKSkKCQkJCQkpOwoJCQkJfQoKCQkJCXJldC52YWx1ZSA9IHZhbHVlICs9ICIiOwoKCQkJCS8vIEJyZWFrIGFzc29jaWF0aW9uIHdpdGggY2xvbmVkIGVsZW1lbnRzIGJ5IGFsc28gdXNpbmcgc2V0QXR0cmlidXRlICgjOTY0NikKCQkJCWlmICggbmFtZSA9PT0gInZhbHVlIiB8fCB2YWx1ZSA9PT0gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKSApIHsKCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQl9CgkJCX0KCQl9OwoKCQkvLyBTb21lIGF0dHJpYnV0ZXMgYXJlIGNvbnN0cnVjdGVkIHdpdGggZW1wdHktc3RyaW5nIHZhbHVlcyB3aGVuIG5vdCBkZWZpbmVkCgkJYXR0ckhhbmRsZS5pZCA9IGF0dHJIYW5kbGUubmFtZSA9IGF0dHJIYW5kbGUuY29vcmRzID0KCQkJZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQkJdmFyIHJldDsKCQkJCWlmICggIWlzWE1MICkgewoJCQkJCXJldHVybiAocmV0ID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCBuYW1lICkpICYmIHJldC52YWx1ZSAhPT0gIiIgPwoJCQkJCQlyZXQudmFsdWUgOgoJCQkJCQludWxsOwoJCQkJfQoJCQl9OwoKCQkvLyBGaXhpbmcgdmFsdWUgcmV0cmlldmFsIG9uIGEgYnV0dG9uIHJlcXVpcmVzIHRoaXMgbW9kdWxlCgkJalF1ZXJ5LnZhbEhvb2tzLmJ1dHRvbiA9IHsKCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkJCXZhciByZXQgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKTsKCQkJCWlmICggcmV0ICYmIHJldC5zcGVjaWZpZWQgKSB7CgkJCQkJcmV0dXJuIHJldC52YWx1ZTsKCQkJCX0KCQkJfSwKCQkJc2V0OiBub2RlSG9vay5zZXQKCQl9OwoKCQkvLyBTZXQgY29udGVudGVkaXRhYmxlIHRvIGZhbHNlIG9uIHJlbW92YWxzKCMxMDQyOSkKCQkvLyBTZXR0aW5nIHRvIGVtcHR5IHN0cmluZyB0aHJvd3MgYW4gZXJyb3IgYXMgYW4gaW52YWxpZCB2YWx1ZQoJCWpRdWVyeS5hdHRySG9va3MuY29udGVudGVkaXRhYmxlID0gewoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgbmFtZSApIHsKCQkJCW5vZGVIb29rLnNldCggZWxlbSwgdmFsdWUgPT09ICIiID8gZmFsc2UgOiB2YWx1ZSwgbmFtZSApOwoJCQl9CgkJfTsKCgkJLy8gU2V0IHdpZHRoIGFuZCBoZWlnaHQgdG8gYXV0byBpbnN0ZWFkIG9mIDAgb24gZW1wdHkgc3RyaW5nKCBCdWcgIzgxNTAgKQoJCS8vIFRoaXMgaXMgZm9yIHJlbW92YWxzCgkJalF1ZXJ5LmVhY2goWyAid2lkdGgiLCAiaGVpZ2h0IiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCQkJalF1ZXJ5LmF0dHJIb29rc1sgbmFtZSBdID0gewoJCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgKSB7CgkJCQkJCWVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCAiYXV0byIgKTsKCQkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJCX0KCQkJCX0KCQkJfTsKCQl9KTsKCX0KCglpZiAoICFzdXBwb3J0LnN0eWxlICkgewoJCWpRdWVyeS5hdHRySG9va3Muc3R5bGUgPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBSZXR1cm4gdW5kZWZpbmVkIGluIHRoZSBjYXNlIG9mIGVtcHR5IHN0cmluZwoJCQkJLy8gTm90ZTogSUUgdXBwZXJjYXNlcyBjc3MgcHJvcGVydHkgbmFtZXMsIGJ1dCBpZiB3ZSB3ZXJlIHRvIC50b0xvd2VyQ2FzZSgpCgkJCQkvLyAuY3NzVGV4dCwgdGhhdCB3b3VsZCBkZXN0cm95IGNhc2Ugc2Vuc3RpdGl2aXR5IGluIFVSTCdzLCBsaWtlIGluICJiYWNrZ3JvdW5kIgoJCQkJcmV0dXJuIGVsZW0uc3R5bGUuY3NzVGV4dCB8fCB1bmRlZmluZWQ7CgkJCX0sCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJcmV0dXJuICggZWxlbS5zdHlsZS5jc3NUZXh0ID0gdmFsdWUgKyAiIiApOwoJCQl9CgkJfTsKCX0KCgoKCgl2YXIgcmZvY3VzYWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QpJC9pLAoJCXJjbGlja2FibGUgPSAvXig/OmF8YXJlYSkkL2k7CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJcHJvcDogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBqUXVlcnkucHJvcCwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxICk7CgkJfSwKCgkJcmVtb3ZlUHJvcDogZnVuY3Rpb24oIG5hbWUgKSB7CgkJCW5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWU7CgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQkvLyB0cnkvY2F0Y2ggaGFuZGxlcyBjYXNlcyB3aGVyZSBJRSBiYWxrcyAoc3VjaCBhcyByZW1vdmluZyBhIHByb3BlcnR5IG9uIHdpbmRvdykKCQkJCXRyeSB7CgkJCQkJdGhpc1sgbmFtZSBdID0gdW5kZWZpbmVkOwoJCQkJCWRlbGV0ZSB0aGlzWyBuYW1lIF07CgkJCQl9IGNhdGNoKCBlICkge30KCQkJfSk7CgkJfQoJfSk7CgoJalF1ZXJ5LmV4dGVuZCh7CgkJcHJvcEZpeDogewoJCQkiZm9yIjogImh0bWxGb3IiLAoJCQkiY2xhc3MiOiAiY2xhc3NOYW1lIgoJCX0sCgoJCXByb3A6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHsKCQkJdmFyIHJldCwgaG9va3MsIG5vdHhtbCwKCQkJCW5UeXBlID0gZWxlbS5ub2RlVHlwZTsKCgkJCS8vIGRvbid0IGdldC9zZXQgcHJvcGVydGllcyBvbiB0ZXh0LCBjb21tZW50IGFuZCBhdHRyaWJ1dGUgbm9kZXMKCQkJaWYgKCAhZWxlbSB8fCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMiApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJbm90eG1sID0gblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApOwoKCQkJaWYgKCBub3R4bWwgKSB7CgkJCQkvLyBGaXggbmFtZSBhbmQgYXR0YWNoIGhvb2tzCgkJCQluYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lOwoJCQkJaG9va3MgPSBqUXVlcnkucHJvcEhvb2tzWyBuYW1lIF07CgkJCX0KCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCXJldHVybiBob29rcyAmJiAic2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApKSAhPT0gdW5kZWZpbmVkID8KCQkJCQlyZXQgOgoJCQkJCSggZWxlbVsgbmFtZSBdID0gdmFsdWUgKTsKCgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldCggZWxlbSwgbmFtZSApKSAhPT0gbnVsbCA/CgkJCQkJcmV0IDoKCQkJCQllbGVtWyBuYW1lIF07CgkJCX0KCQl9LAoKCQlwcm9wSG9va3M6IHsKCQkJdGFiSW5kZXg6IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJLy8gZWxlbS50YWJJbmRleCBkb2Vzbid0IGFsd2F5cyByZXR1cm4gdGhlIGNvcnJlY3QgdmFsdWUgd2hlbiBpdCBoYXNuJ3QgYmVlbiBleHBsaWNpdGx5IHNldAoJCQkJCS8vIGh0dHA6Ly9mbHVpZHByb2plY3Qub3JnL2Jsb2cvMjAwOC8wMS8wOS9nZXR0aW5nLXNldHRpbmctYW5kLXJlbW92aW5nLXRhYmluZGV4LXZhbHVlcy13aXRoLWphdmFzY3JpcHQvCgkJCQkJLy8gVXNlIHByb3BlciBhdHRyaWJ1dGUgcmV0cmlldmFsKCMxMjA3MikKCQkJCQl2YXIgdGFiaW5kZXggPSBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCAidGFiaW5kZXgiICk7CgoJCQkJCXJldHVybiB0YWJpbmRleCA/CgkJCQkJCXBhcnNlSW50KCB0YWJpbmRleCwgMTAgKSA6CgkJCQkJCXJmb2N1c2FibGUudGVzdCggZWxlbS5ub2RlTmFtZSApIHx8IHJjbGlja2FibGUudGVzdCggZWxlbS5ub2RlTmFtZSApICYmIGVsZW0uaHJlZiA/CgkJCQkJCQkwIDoKCQkJCQkJCS0xOwoJCQkJfQoJCQl9CgkJfQoJfSk7CgoJLy8gU29tZSBhdHRyaWJ1dGVzIHJlcXVpcmUgYSBzcGVjaWFsIGNhbGwgb24gSUUKCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKCWlmICggIXN1cHBvcnQuaHJlZk5vcm1hbGl6ZWQgKSB7CgkJLy8gaHJlZi9zcmMgcHJvcGVydHkgc2hvdWxkIGdldCB0aGUgZnVsbCBub3JtYWxpemVkIFVSTCAoIzEwMjk5LyMxMjkxNSkKCQlqUXVlcnkuZWFjaChbICJocmVmIiwgInNyYyIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJCWpRdWVyeS5wcm9wSG9va3NbIG5hbWUgXSA9IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lLCA0ICk7CgkJCQl9CgkJCX07CgkJfSk7Cgl9CgoJLy8gU3VwcG9ydDogU2FmYXJpLCBJRTkrCgkvLyBtaXMtcmVwb3J0cyB0aGUgZGVmYXVsdCBzZWxlY3RlZCBwcm9wZXJ0eSBvZiBhbiBvcHRpb24KCS8vIEFjY2Vzc2luZyB0aGUgcGFyZW50J3Mgc2VsZWN0ZWRJbmRleCBwcm9wZXJ0eSBmaXhlcyBpdAoJaWYgKCAhc3VwcG9ydC5vcHRTZWxlY3RlZCApIHsKCQlqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKCgkJCQlpZiAoIHBhcmVudCApIHsKCQkJCQlwYXJlbnQuc2VsZWN0ZWRJbmRleDsKCgkJCQkJLy8gTWFrZSBzdXJlIHRoYXQgaXQgYWxzbyB3b3JrcyB3aXRoIG9wdGdyb3Vwcywgc2VlICM1NzAxCgkJCQkJaWYgKCBwYXJlbnQucGFyZW50Tm9kZSApIHsKCQkJCQkJcGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmVhY2goWwoJCSJ0YWJJbmRleCIsCgkJInJlYWRPbmx5IiwKCQkibWF4TGVuZ3RoIiwKCQkiY2VsbFNwYWNpbmciLAoJCSJjZWxsUGFkZGluZyIsCgkJInJvd1NwYW4iLAoJCSJjb2xTcGFuIiwKCQkidXNlTWFwIiwKCQkiZnJhbWVCb3JkZXIiLAoJCSJjb250ZW50RWRpdGFibGUiCgldLCBmdW5jdGlvbigpIHsKCQlqUXVlcnkucHJvcEZpeFsgdGhpcy50b0xvd2VyQ2FzZSgpIF0gPSB0aGlzOwoJfSk7CgoJLy8gSUU2LzcgY2FsbCBlbmN0eXBlIGVuY29kaW5nCglpZiAoICFzdXBwb3J0LmVuY3R5cGUgKSB7CgkJalF1ZXJ5LnByb3BGaXguZW5jdHlwZSA9ICJlbmNvZGluZyI7Cgl9CgoKCgoJdmFyIHJjbGFzcyA9IC9bXHRcclxuXGZdL2c7CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJYWRkQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY2xhenosIGosIGZpbmFsVmFsdWUsCgkJCQlpID0gMCwKCQkJCWxlbiA9IHRoaXMubGVuZ3RoLAoJCQkJcHJvY2VlZCA9IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWU7CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaiApIHsKCQkJCQlqUXVlcnkoIHRoaXMgKS5hZGRDbGFzcyggdmFsdWUuY2FsbCggdGhpcywgaiwgdGhpcy5jbGFzc05hbWUgKSApOwoJCQkJfSk7CgkJCX0KCgkJCWlmICggcHJvY2VlZCApIHsKCQkJCS8vIFRoZSBkaXNqdW5jdGlvbiBoZXJlIGlzIGZvciBiZXR0ZXIgY29tcHJlc3NpYmlsaXR5IChzZWUgcmVtb3ZlQ2xhc3MpCgkJCQljbGFzc2VzID0gKCB2YWx1ZSB8fCAiIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQllbGVtID0gdGhpc1sgaSBdOwoJCQkJCWN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgKCBlbGVtLmNsYXNzTmFtZSA/CgkJCQkJCSggIiAiICsgZWxlbS5jbGFzc05hbWUgKyAiICIgKS5yZXBsYWNlKCByY2xhc3MsICIgIiApIDoKCQkJCQkJIiAiCgkJCQkJKTsKCgkJCQkJaWYgKCBjdXIgKSB7CgkJCQkJCWogPSAwOwoJCQkJCQl3aGlsZSAoIChjbGF6eiA9IGNsYXNzZXNbaisrXSkgKSB7CgkJCQkJCQlpZiAoIGN1ci5pbmRleE9mKCAiICIgKyBjbGF6eiArICIgIiApIDwgMCApIHsKCQkJCQkJCQljdXIgKz0gY2xhenogKyAiICI7CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIG9ubHkgYXNzaWduIGlmIGRpZmZlcmVudCB0byBhdm9pZCB1bm5lZWRlZCByZW5kZXJpbmcuCgkJCQkJCWZpbmFsVmFsdWUgPSBqUXVlcnkudHJpbSggY3VyICk7CgkJCQkJCWlmICggZWxlbS5jbGFzc05hbWUgIT09IGZpbmFsVmFsdWUgKSB7CgkJCQkJCQllbGVtLmNsYXNzTmFtZSA9IGZpbmFsVmFsdWU7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCXJlbW92ZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCXZhciBjbGFzc2VzLCBlbGVtLCBjdXIsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQkJaSA9IDAsCgkJCQlsZW4gPSB0aGlzLmxlbmd0aCwKCQkJCXByb2NlZWQgPSBhcmd1bWVudHMubGVuZ3RoID09PSAwIHx8IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWU7CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaiApIHsKCQkJCQlqUXVlcnkoIHRoaXMgKS5yZW1vdmVDbGFzcyggdmFsdWUuY2FsbCggdGhpcywgaiwgdGhpcy5jbGFzc05hbWUgKSApOwoJCQkJfSk7CgkJCX0KCQkJaWYgKCBwcm9jZWVkICkgewoJCQkJY2xhc3NlcyA9ICggdmFsdWUgfHwgIiIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCQkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCQkJZWxlbSA9IHRoaXNbIGkgXTsKCQkJCQkvLyBUaGlzIGV4cHJlc3Npb24gaXMgaGVyZSBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIGFkZENsYXNzKQoJCQkJCWN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgKCBlbGVtLmNsYXNzTmFtZSA/CgkJCQkJCSggIiAiICsgZWxlbS5jbGFzc05hbWUgKyAiICIgKS5yZXBsYWNlKCByY2xhc3MsICIgIiApIDoKCQkJCQkJIiIKCQkJCQkpOwoKCQkJCQlpZiAoIGN1ciApIHsKCQkJCQkJaiA9IDA7CgkJCQkJCXdoaWxlICggKGNsYXp6ID0gY2xhc3Nlc1tqKytdKSApIHsKCQkJCQkJCS8vIFJlbW92ZSAqYWxsKiBpbnN0YW5jZXMKCQkJCQkJCXdoaWxlICggY3VyLmluZGV4T2YoICIgIiArIGNsYXp6ICsgIiAiICkgPj0gMCApIHsKCQkJCQkJCQljdXIgPSBjdXIucmVwbGFjZSggIiAiICsgY2xhenogKyAiICIsICIgIiApOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgoJCQkJCQlmaW5hbFZhbHVlID0gdmFsdWUgPyBqUXVlcnkudHJpbSggY3VyICkgOiAiIjsKCQkJCQkJaWYgKCBlbGVtLmNsYXNzTmFtZSAhPT0gZmluYWxWYWx1ZSApIHsKCQkJCQkJCWVsZW0uY2xhc3NOYW1lID0gZmluYWxWYWx1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSwgc3RhdGVWYWwgKSB7CgkJCXZhciB0eXBlID0gdHlwZW9mIHZhbHVlOwoKCQkJaWYgKCB0eXBlb2Ygc3RhdGVWYWwgPT09ICJib29sZWFuIiAmJiB0eXBlID09PSAic3RyaW5nIiApIHsKCQkJCXJldHVybiBzdGF0ZVZhbCA/IHRoaXMuYWRkQ2xhc3MoIHZhbHVlICkgOiB0aGlzLnJlbW92ZUNsYXNzKCB2YWx1ZSApOwoJCQl9CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHsKCQkJCQlqUXVlcnkoIHRoaXMgKS50b2dnbGVDbGFzcyggdmFsdWUuY2FsbCh0aGlzLCBpLCB0aGlzLmNsYXNzTmFtZSwgc3RhdGVWYWwpLCBzdGF0ZVZhbCApOwoJCQkJfSk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHR5cGUgPT09ICJzdHJpbmciICkgewoJCQkJCS8vIHRvZ2dsZSBpbmRpdmlkdWFsIGNsYXNzIG5hbWVzCgkJCQkJdmFyIGNsYXNzTmFtZSwKCQkJCQkJaSA9IDAsCgkJCQkJCXNlbGYgPSBqUXVlcnkoIHRoaXMgKSwKCQkJCQkJY2xhc3NOYW1lcyA9IHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCQkJd2hpbGUgKCAoY2xhc3NOYW1lID0gY2xhc3NOYW1lc1sgaSsrIF0pICkgewoJCQkJCQkvLyBjaGVjayBlYWNoIGNsYXNzTmFtZSBnaXZlbiwgc3BhY2Ugc2VwYXJhdGVkIGxpc3QKCQkJCQkJaWYgKCBzZWxmLmhhc0NsYXNzKCBjbGFzc05hbWUgKSApIHsKCQkJCQkJCXNlbGYucmVtb3ZlQ2xhc3MoIGNsYXNzTmFtZSApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJc2VsZi5hZGRDbGFzcyggY2xhc3NOYW1lICk7CgkJCQkJCX0KCQkJCQl9CgoJCQkJLy8gVG9nZ2xlIHdob2xlIGNsYXNzIG5hbWUKCQkJCX0gZWxzZSBpZiAoIHR5cGUgPT09IHN0cnVuZGVmaW5lZCB8fCB0eXBlID09PSAiYm9vbGVhbiIgKSB7CgkJCQkJaWYgKCB0aGlzLmNsYXNzTmFtZSApIHsKCQkJCQkJLy8gc3RvcmUgY2xhc3NOYW1lIGlmIHNldAoJCQkJCQlqUXVlcnkuX2RhdGEoIHRoaXMsICJfX2NsYXNzTmFtZV9fIiwgdGhpcy5jbGFzc05hbWUgKTsKCQkJCQl9CgoJCQkJCS8vIElmIHRoZSBlbGVtZW50IGhhcyBhIGNsYXNzIG5hbWUgb3IgaWYgd2UncmUgcGFzc2VkICJmYWxzZSIsCgkJCQkJLy8gdGhlbiByZW1vdmUgdGhlIHdob2xlIGNsYXNzbmFtZSAoaWYgdGhlcmUgd2FzIG9uZSwgdGhlIGFib3ZlIHNhdmVkIGl0KS4KCQkJCQkvLyBPdGhlcndpc2UgYnJpbmcgYmFjayB3aGF0ZXZlciB3YXMgcHJldmlvdXNseSBzYXZlZCAoaWYgYW55dGhpbmcpLAoJCQkJCS8vIGZhbGxpbmcgYmFjayB0byB0aGUgZW1wdHkgc3RyaW5nIGlmIG5vdGhpbmcgd2FzIHN0b3JlZC4KCQkJCQl0aGlzLmNsYXNzTmFtZSA9IHRoaXMuY2xhc3NOYW1lIHx8IHZhbHVlID09PSBmYWxzZSA/ICIiIDogalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiX19jbGFzc05hbWVfXyIgKSB8fCAiIjsKCQkJCX0KCQkJfSk7CgkJfSwKCgkJaGFzQ2xhc3M6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJdmFyIGNsYXNzTmFtZSA9ICIgIiArIHNlbGVjdG9yICsgIiAiLAoJCQkJaSA9IDAsCgkJCQlsID0gdGhpcy5sZW5ndGg7CgkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCWlmICggdGhpc1tpXS5ub2RlVHlwZSA9PT0gMSAmJiAoIiAiICsgdGhpc1tpXS5jbGFzc05hbWUgKyAiICIpLnJlcGxhY2UocmNsYXNzLCAiICIpLmluZGV4T2YoIGNsYXNzTmFtZSApID49IDAgKSB7CgkJCQkJcmV0dXJuIHRydWU7CgkJCQl9CgkJCX0KCgkJCXJldHVybiBmYWxzZTsKCQl9Cgl9KTsKCgoKCgkvLyBSZXR1cm4galF1ZXJ5IGZvciBhdHRyaWJ1dGVzLW9ubHkgaW5jbHVzaW9uCgoKCWpRdWVyeS5lYWNoKCAoImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrICIgKwoJCSJtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSAiICsKCQkiY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvciBjb250ZXh0bWVudSIpLnNwbGl0KCIgIiksIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoKCQkvLyBIYW5kbGUgZXZlbnQgYmluZGluZwoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPwoJCQkJdGhpcy5vbiggbmFtZSwgbnVsbCwgZGF0YSwgZm4gKSA6CgkJCQl0aGlzLnRyaWdnZXIoIG5hbWUgKTsKCQl9OwoJfSk7CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJaG92ZXI6IGZ1bmN0aW9uKCBmbk92ZXIsIGZuT3V0ICkgewoJCQlyZXR1cm4gdGhpcy5tb3VzZWVudGVyKCBmbk92ZXIgKS5tb3VzZWxlYXZlKCBmbk91dCB8fCBmbk92ZXIgKTsKCQl9LAoKCQliaW5kOiBmdW5jdGlvbiggdHlwZXMsIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vbiggdHlwZXMsIG51bGwsIGRhdGEsIGZuICk7CgkJfSwKCQl1bmJpbmQ6IGZ1bmN0aW9uKCB0eXBlcywgZm4gKSB7CgkJCXJldHVybiB0aGlzLm9mZiggdHlwZXMsIG51bGwsIGZuICk7CgkJfSwKCgkJZGVsZWdhdGU6IGZ1bmN0aW9uKCBzZWxlY3RvciwgdHlwZXMsIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApOwoJCX0sCgkJdW5kZWxlZ2F0ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCB0eXBlcywgZm4gKSB7CgkJCS8vICggbmFtZXNwYWNlICkgb3IgKCBzZWxlY3RvciwgdHlwZXMgWywgZm5dICkKCQkJcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgPyB0aGlzLm9mZiggc2VsZWN0b3IsICIqKiIgKSA6IHRoaXMub2ZmKCB0eXBlcywgc2VsZWN0b3IgfHwgIioqIiwgZm4gKTsKCQl9Cgl9KTsKCgoJdmFyIG5vbmNlID0galF1ZXJ5Lm5vdygpOwoKCXZhciBycXVlcnkgPSAoL1w/Lyk7CgoKCgl2YXIgcnZhbGlkdG9rZW5zID0gLygsKXwoXFt8eyl8KH18XSl8Iig/OlteIlxcXHJcbl18XFxbIlxcXC9iZm5ydF18XFx1W1xkYS1mQS1GXXs0fSkqIlxzKjo/fHRydWV8ZmFsc2V8bnVsbHwtPyg/ITBcZClcZCsoPzpcLlxkK3wpKD86W2VFXVsrLV0/XGQrfCkvZzsKCglqUXVlcnkucGFyc2VKU09OID0gZnVuY3Rpb24oIGRhdGEgKSB7CgkJLy8gQXR0ZW1wdCB0byBwYXJzZSB1c2luZyB0aGUgbmF0aXZlIEpTT04gcGFyc2VyIGZpcnN0CgkJaWYgKCB3aW5kb3cuSlNPTiAmJiB3aW5kb3cuSlNPTi5wYXJzZSApIHsKCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJLy8gV29ya2Fyb3VuZCBmYWlsdXJlIHRvIHN0cmluZy1jYXN0IG51bGwgaW5wdXQKCQkJcmV0dXJuIHdpbmRvdy5KU09OLnBhcnNlKCBkYXRhICsgIiIgKTsKCQl9CgoJCXZhciByZXF1aXJlTm9uQ29tbWEsCgkJCWRlcHRoID0gbnVsbCwKCQkJc3RyID0galF1ZXJ5LnRyaW0oIGRhdGEgKyAiIiApOwoKCQkvLyBHdWFyZCBhZ2FpbnN0IGludmFsaWQgKGFuZCBwb3NzaWJseSBkYW5nZXJvdXMpIGlucHV0IGJ5IGVuc3VyaW5nIHRoYXQgbm90aGluZyByZW1haW5zCgkJLy8gYWZ0ZXIgcmVtb3ZpbmcgdmFsaWQgdG9rZW5zCgkJcmV0dXJuIHN0ciAmJiAhalF1ZXJ5LnRyaW0oIHN0ci5yZXBsYWNlKCBydmFsaWR0b2tlbnMsIGZ1bmN0aW9uKCB0b2tlbiwgY29tbWEsIG9wZW4sIGNsb3NlICkgewoKCQkJLy8gRm9yY2UgdGVybWluYXRpb24gaWYgd2Ugc2VlIGEgbWlzcGxhY2VkIGNvbW1hCgkJCWlmICggcmVxdWlyZU5vbkNvbW1hICYmIGNvbW1hICkgewoJCQkJZGVwdGggPSAwOwoJCQl9CgoJCQkvLyBQZXJmb3JtIG5vIG1vcmUgcmVwbGFjZW1lbnRzIGFmdGVyIHJldHVybmluZyB0byBvdXRlcm1vc3QgZGVwdGgKCQkJaWYgKCBkZXB0aCA9PT0gMCApIHsKCQkJCXJldHVybiB0b2tlbjsKCQkJfQoKCQkJLy8gQ29tbWFzIG11c3Qgbm90IGZvbGxvdyAiWyIsICJ7Iiwgb3IgIiwiCgkJCXJlcXVpcmVOb25Db21tYSA9IG9wZW4gfHwgY29tbWE7CgoJCQkvLyBEZXRlcm1pbmUgbmV3IGRlcHRoCgkJCS8vIGFycmF5L29iamVjdCBvcGVuICgiWyIgb3IgInsiKTogZGVwdGggKz0gdHJ1ZSAtIGZhbHNlIChpbmNyZW1lbnQpCgkJCS8vIGFycmF5L29iamVjdCBjbG9zZSAoIl0iIG9yICJ9Iik6IGRlcHRoICs9IGZhbHNlIC0gdHJ1ZSAoZGVjcmVtZW50KQoJCQkvLyBvdGhlciBjYXNlcyAoIiwiIG9yIHByaW1pdGl2ZSk6IGRlcHRoICs9IHRydWUgLSB0cnVlIChudW1lcmljIGNhc3QpCgkJCWRlcHRoICs9ICFjbG9zZSAtICFvcGVuOwoKCQkJLy8gUmVtb3ZlIHRoaXMgdG9rZW4KCQkJcmV0dXJuICIiOwoJCX0pICkgPwoJCQkoIEZ1bmN0aW9uKCAicmV0dXJuICIgKyBzdHIgKSApKCkgOgoJCQlqUXVlcnkuZXJyb3IoICJJbnZhbGlkIEpTT046ICIgKyBkYXRhICk7Cgl9OwoKCgkvLyBDcm9zcy1icm93c2VyIHhtbCBwYXJzaW5nCglqUXVlcnkucGFyc2VYTUwgPSBmdW5jdGlvbiggZGF0YSApIHsKCQl2YXIgeG1sLCB0bXA7CgkJaWYgKCAhZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gInN0cmluZyIgKSB7CgkJCXJldHVybiBudWxsOwoJCX0KCQl0cnkgewoJCQlpZiAoIHdpbmRvdy5ET01QYXJzZXIgKSB7IC8vIFN0YW5kYXJkCgkJCQl0bXAgPSBuZXcgRE9NUGFyc2VyKCk7CgkJCQl4bWwgPSB0bXAucGFyc2VGcm9tU3RyaW5nKCBkYXRhLCAidGV4dC94bWwiICk7CgkJCX0gZWxzZSB7IC8vIElFCgkJCQl4bWwgPSBuZXcgQWN0aXZlWE9iamVjdCggIk1pY3Jvc29mdC5YTUxET00iICk7CgkJCQl4bWwuYXN5bmMgPSAiZmFsc2UiOwoJCQkJeG1sLmxvYWRYTUwoIGRhdGEgKTsKCQkJfQoJCX0gY2F0Y2goIGUgKSB7CgkJCXhtbCA9IHVuZGVmaW5lZDsKCQl9CgkJaWYgKCAheG1sIHx8ICF4bWwuZG9jdW1lbnRFbGVtZW50IHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSggInBhcnNlcmVycm9yIiApLmxlbmd0aCApIHsKCQkJalF1ZXJ5LmVycm9yKCAiSW52YWxpZCBYTUw6ICIgKyBkYXRhICk7CgkJfQoJCXJldHVybiB4bWw7Cgl9OwoKCgl2YXIKCQkvLyBEb2N1bWVudCBsb2NhdGlvbgoJCWFqYXhMb2NQYXJ0cywKCQlhamF4TG9jYXRpb24sCgoJCXJoYXNoID0gLyMuKiQvLAoJCXJ0cyA9IC8oWz8mXSlfPVteJl0qLywKCQlyaGVhZGVycyA9IC9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKVxyPyQvbWcsIC8vIElFIGxlYXZlcyBhbiBcciBjaGFyYWN0ZXIgYXQgRU9MCgkJLy8gIzc2NTMsICM4MTI1LCAjODE1MjogbG9jYWwgcHJvdG9jb2wgZGV0ZWN0aW9uCgkJcmxvY2FsUHJvdG9jb2wgPSAvXig/OmFib3V0fGFwcHxhcHAtc3RvcmFnZXwuKy1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLywKCQlybm9Db250ZW50ID0gL14oPzpHRVR8SEVBRCkkLywKCQlycHJvdG9jb2wgPSAvXlwvXC8vLAoJCXJ1cmwgPSAvXihbXHcuKy1dKzopKD86XC9cLyg/OlteXC8/I10qQHwpKFteXC8/IzpdKikoPzo6KFxkKyl8KXwpLywKCgkJLyogUHJlZmlsdGVycwoJCSAqIDEpIFRoZXkgYXJlIHVzZWZ1bCB0byBpbnRyb2R1Y2UgY3VzdG9tIGRhdGFUeXBlcyAoc2VlIGFqYXgvanNvbnAuanMgZm9yIGFuIGV4YW1wbGUpCgkJICogMikgVGhlc2UgYXJlIGNhbGxlZDoKCQkgKiAgICAtIEJFRk9SRSBhc2tpbmcgZm9yIGEgdHJhbnNwb3J0CgkJICogICAgLSBBRlRFUiBwYXJhbSBzZXJpYWxpemF0aW9uIChzLmRhdGEgaXMgYSBzdHJpbmcgaWYgcy5wcm9jZXNzRGF0YSBpcyB0cnVlKQoJCSAqIDMpIGtleSBpcyB0aGUgZGF0YVR5cGUKCQkgKiA0KSB0aGUgY2F0Y2hhbGwgc3ltYm9sICIqIiBjYW4gYmUgdXNlZAoJCSAqIDUpIGV4ZWN1dGlvbiB3aWxsIHN0YXJ0IHdpdGggdHJhbnNwb3J0IGRhdGFUeXBlIGFuZCBUSEVOIGNvbnRpbnVlIGRvd24gdG8gIioiIGlmIG5lZWRlZAoJCSAqLwoJCXByZWZpbHRlcnMgPSB7fSwKCgkJLyogVHJhbnNwb3J0cyBiaW5kaW5ncwoJCSAqIDEpIGtleSBpcyB0aGUgZGF0YVR5cGUKCQkgKiAyKSB0aGUgY2F0Y2hhbGwgc3ltYm9sICIqIiBjYW4gYmUgdXNlZAoJCSAqIDMpIHNlbGVjdGlvbiB3aWxsIHN0YXJ0IHdpdGggdHJhbnNwb3J0IGRhdGFUeXBlIGFuZCBUSEVOIGdvIHRvICIqIiBpZiBuZWVkZWQKCQkgKi8KCQl0cmFuc3BvcnRzID0ge30sCgoJCS8vIEF2b2lkIGNvbW1lbnQtcHJvbG9nIGNoYXIgc2VxdWVuY2UgKCMxMDA5OCk7IG11c3QgYXBwZWFzZSBsaW50IGFuZCBldmFkZSBjb21wcmVzc2lvbgoJCWFsbFR5cGVzID0gIiovIi5jb25jYXQoIioiKTsKCgkvLyAjODEzOCwgSUUgbWF5IHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZwoJLy8gYSBmaWVsZCBmcm9tIHdpbmRvdy5sb2NhdGlvbiBpZiBkb2N1bWVudC5kb21haW4gaGFzIGJlZW4gc2V0Cgl0cnkgewoJCWFqYXhMb2NhdGlvbiA9IGxvY2F0aW9uLmhyZWY7Cgl9IGNhdGNoKCBlICkgewoJCS8vIFVzZSB0aGUgaHJlZiBhdHRyaWJ1dGUgb2YgYW4gQSBlbGVtZW50CgkJLy8gc2luY2UgSUUgd2lsbCBtb2RpZnkgaXQgZ2l2ZW4gZG9jdW1lbnQubG9jYXRpb24KCQlhamF4TG9jYXRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiYSIgKTsKCQlhamF4TG9jYXRpb24uaHJlZiA9ICIiOwoJCWFqYXhMb2NhdGlvbiA9IGFqYXhMb2NhdGlvbi5ocmVmOwoJfQoKCS8vIFNlZ21lbnQgbG9jYXRpb24gaW50byBwYXJ0cwoJYWpheExvY1BhcnRzID0gcnVybC5leGVjKCBhamF4TG9jYXRpb24udG9Mb3dlckNhc2UoKSApIHx8IFtdOwoKCS8vIEJhc2UgImNvbnN0cnVjdG9yIiBmb3IgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIgYW5kIGpRdWVyeS5hamF4VHJhbnNwb3J0CglmdW5jdGlvbiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHN0cnVjdHVyZSApIHsKCgkJLy8gZGF0YVR5cGVFeHByZXNzaW9uIGlzIG9wdGlvbmFsIGFuZCBkZWZhdWx0cyB0byAiKiIKCQlyZXR1cm4gZnVuY3Rpb24oIGRhdGFUeXBlRXhwcmVzc2lvbiwgZnVuYyApIHsKCgkJCWlmICggdHlwZW9mIGRhdGFUeXBlRXhwcmVzc2lvbiAhPT0gInN0cmluZyIgKSB7CgkJCQlmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uOwoJCQkJZGF0YVR5cGVFeHByZXNzaW9uID0gIioiOwoJCQl9CgoJCQl2YXIgZGF0YVR5cGUsCgkJCQlpID0gMCwKCQkJCWRhdGFUeXBlcyA9IGRhdGFUeXBlRXhwcmVzc2lvbi50b0xvd2VyQ2FzZSgpLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGZ1bmMgKSApIHsKCQkJCS8vIEZvciBlYWNoIGRhdGFUeXBlIGluIHRoZSBkYXRhVHlwZUV4cHJlc3Npb24KCQkJCXdoaWxlICggKGRhdGFUeXBlID0gZGF0YVR5cGVzW2krK10pICkgewoJCQkJCS8vIFByZXBlbmQgaWYgcmVxdWVzdGVkCgkJCQkJaWYgKCBkYXRhVHlwZS5jaGFyQXQoIDAgKSA9PT0gIisiICkgewoJCQkJCQlkYXRhVHlwZSA9IGRhdGFUeXBlLnNsaWNlKCAxICkgfHwgIioiOwoJCQkJCQkoc3RydWN0dXJlWyBkYXRhVHlwZSBdID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdKS51bnNoaWZ0KCBmdW5jICk7CgoJCQkJCS8vIE90aGVyd2lzZSBhcHBlbmQKCQkJCQl9IGVsc2UgewoJCQkJCQkoc3RydWN0dXJlWyBkYXRhVHlwZSBdID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdKS5wdXNoKCBmdW5jICk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCX0KCgkvLyBCYXNlIGluc3BlY3Rpb24gZnVuY3Rpb24gZm9yIHByZWZpbHRlcnMgYW5kIHRyYW5zcG9ydHMKCWZ1bmN0aW9uIGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBzdHJ1Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKSB7CgoJCXZhciBpbnNwZWN0ZWQgPSB7fSwKCQkJc2Vla2luZ1RyYW5zcG9ydCA9ICggc3RydWN0dXJlID09PSB0cmFuc3BvcnRzICk7CgoJCWZ1bmN0aW9uIGluc3BlY3QoIGRhdGFUeXBlICkgewoJCQl2YXIgc2VsZWN0ZWQ7CgkJCWluc3BlY3RlZFsgZGF0YVR5cGUgXSA9IHRydWU7CgkJCWpRdWVyeS5lYWNoKCBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10sIGZ1bmN0aW9uKCBfLCBwcmVmaWx0ZXJPckZhY3RvcnkgKSB7CgkJCQl2YXIgZGF0YVR5cGVPclRyYW5zcG9ydCA9IHByZWZpbHRlck9yRmFjdG9yeSggb3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUiApOwoJCQkJaWYgKCB0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydCA9PT0gInN0cmluZyIgJiYgIXNlZWtpbmdUcmFuc3BvcnQgJiYgIWluc3BlY3RlZFsgZGF0YVR5cGVPclRyYW5zcG9ydCBdICkgewoJCQkJCW9wdGlvbnMuZGF0YVR5cGVzLnVuc2hpZnQoIGRhdGFUeXBlT3JUcmFuc3BvcnQgKTsKCQkJCQlpbnNwZWN0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfSBlbHNlIGlmICggc2Vla2luZ1RyYW5zcG9ydCApIHsKCQkJCQlyZXR1cm4gISggc2VsZWN0ZWQgPSBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQl9CgkJCX0pOwoJCQlyZXR1cm4gc2VsZWN0ZWQ7CgkJfQoKCQlyZXR1cm4gaW5zcGVjdCggb3B0aW9ucy5kYXRhVHlwZXNbIDAgXSApIHx8ICFpbnNwZWN0ZWRbICIqIiBdICYmIGluc3BlY3QoICIqIiApOwoJfQoKCS8vIEEgc3BlY2lhbCBleHRlbmQgZm9yIGFqYXggb3B0aW9ucwoJLy8gdGhhdCB0YWtlcyAiZmxhdCIgb3B0aW9ucyAobm90IHRvIGJlIGRlZXAgZXh0ZW5kZWQpCgkvLyBGaXhlcyAjOTg4NwoJZnVuY3Rpb24gYWpheEV4dGVuZCggdGFyZ2V0LCBzcmMgKSB7CgkJdmFyIGRlZXAsIGtleSwKCQkJZmxhdE9wdGlvbnMgPSBqUXVlcnkuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zIHx8IHt9OwoKCQlmb3IgKCBrZXkgaW4gc3JjICkgewoJCQlpZiAoIHNyY1sga2V5IF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCSggZmxhdE9wdGlvbnNbIGtleSBdID8gdGFyZ2V0IDogKCBkZWVwIHx8IChkZWVwID0ge30pICkgKVsga2V5IF0gPSBzcmNbIGtleSBdOwoJCQl9CgkJfQoJCWlmICggZGVlcCApIHsKCQkJalF1ZXJ5LmV4dGVuZCggdHJ1ZSwgdGFyZ2V0LCBkZWVwICk7CgkJfQoKCQlyZXR1cm4gdGFyZ2V0OwoJfQoKCS8qIEhhbmRsZXMgcmVzcG9uc2VzIHRvIGFuIGFqYXggcmVxdWVzdDoKCSAqIC0gZmluZHMgdGhlIHJpZ2h0IGRhdGFUeXBlIChtZWRpYXRlcyBiZXR3ZWVuIGNvbnRlbnQtdHlwZSBhbmQgZXhwZWN0ZWQgZGF0YVR5cGUpCgkgKiAtIHJldHVybnMgdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKCSAqLwoJZnVuY3Rpb24gYWpheEhhbmRsZVJlc3BvbnNlcyggcywganFYSFIsIHJlc3BvbnNlcyApIHsKCQl2YXIgZmlyc3REYXRhVHlwZSwgY3QsIGZpbmFsRGF0YVR5cGUsIHR5cGUsCgkJCWNvbnRlbnRzID0gcy5jb250ZW50cywKCQkJZGF0YVR5cGVzID0gcy5kYXRhVHlwZXM7CgoJCS8vIFJlbW92ZSBhdXRvIGRhdGFUeXBlIGFuZCBnZXQgY29udGVudC10eXBlIGluIHRoZSBwcm9jZXNzCgkJd2hpbGUgKCBkYXRhVHlwZXNbIDAgXSA9PT0gIioiICkgewoJCQlkYXRhVHlwZXMuc2hpZnQoKTsKCQkJaWYgKCBjdCA9PT0gdW5kZWZpbmVkICkgewoJCQkJY3QgPSBzLm1pbWVUeXBlIHx8IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKTsKCQkJfQoJCX0KCgkJLy8gQ2hlY2sgaWYgd2UncmUgZGVhbGluZyB3aXRoIGEga25vd24gY29udGVudC10eXBlCgkJaWYgKCBjdCApIHsKCQkJZm9yICggdHlwZSBpbiBjb250ZW50cyApIHsKCQkJCWlmICggY29udGVudHNbIHR5cGUgXSAmJiBjb250ZW50c1sgdHlwZSBdLnRlc3QoIGN0ICkgKSB7CgkJCQkJZGF0YVR5cGVzLnVuc2hpZnQoIHR5cGUgKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gQ2hlY2sgdG8gc2VlIGlmIHdlIGhhdmUgYSByZXNwb25zZSBmb3IgdGhlIGV4cGVjdGVkIGRhdGFUeXBlCgkJaWYgKCBkYXRhVHlwZXNbIDAgXSBpbiByZXNwb25zZXMgKSB7CgkJCWZpbmFsRGF0YVR5cGUgPSBkYXRhVHlwZXNbIDAgXTsKCQl9IGVsc2UgewoJCQkvLyBUcnkgY29udmVydGlibGUgZGF0YVR5cGVzCgkJCWZvciAoIHR5cGUgaW4gcmVzcG9uc2VzICkgewoJCQkJaWYgKCAhZGF0YVR5cGVzWyAwIF0gfHwgcy5jb252ZXJ0ZXJzWyB0eXBlICsgIiAiICsgZGF0YVR5cGVzWzBdIF0gKSB7CgkJCQkJZmluYWxEYXRhVHlwZSA9IHR5cGU7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQlpZiAoICFmaXJzdERhdGFUeXBlICkgewoJCQkJCWZpcnN0RGF0YVR5cGUgPSB0eXBlOwoJCQkJfQoJCQl9CgkJCS8vIE9yIGp1c3QgdXNlIGZpcnN0IG9uZQoJCQlmaW5hbERhdGFUeXBlID0gZmluYWxEYXRhVHlwZSB8fCBmaXJzdERhdGFUeXBlOwoJCX0KCgkJLy8gSWYgd2UgZm91bmQgYSBkYXRhVHlwZQoJCS8vIFdlIGFkZCB0aGUgZGF0YVR5cGUgdG8gdGhlIGxpc3QgaWYgbmVlZGVkCgkJLy8gYW5kIHJldHVybiB0aGUgY29ycmVzcG9uZGluZyByZXNwb25zZQoJCWlmICggZmluYWxEYXRhVHlwZSApIHsKCQkJaWYgKCBmaW5hbERhdGFUeXBlICE9PSBkYXRhVHlwZXNbIDAgXSApIHsKCQkJCWRhdGFUeXBlcy51bnNoaWZ0KCBmaW5hbERhdGFUeXBlICk7CgkJCX0KCQkJcmV0dXJuIHJlc3BvbnNlc1sgZmluYWxEYXRhVHlwZSBdOwoJCX0KCX0KCgkvKiBDaGFpbiBjb252ZXJzaW9ucyBnaXZlbiB0aGUgcmVxdWVzdCBhbmQgdGhlIG9yaWdpbmFsIHJlc3BvbnNlCgkgKiBBbHNvIHNldHMgdGhlIHJlc3BvbnNlWFhYIGZpZWxkcyBvbiB0aGUganFYSFIgaW5zdGFuY2UKCSAqLwoJZnVuY3Rpb24gYWpheENvbnZlcnQoIHMsIHJlc3BvbnNlLCBqcVhIUiwgaXNTdWNjZXNzICkgewoJCXZhciBjb252MiwgY3VycmVudCwgY29udiwgdG1wLCBwcmV2LAoJCQljb252ZXJ0ZXJzID0ge30sCgkJCS8vIFdvcmsgd2l0aCBhIGNvcHkgb2YgZGF0YVR5cGVzIGluIGNhc2Ugd2UgbmVlZCB0byBtb2RpZnkgaXQgZm9yIGNvbnZlcnNpb24KCQkJZGF0YVR5cGVzID0gcy5kYXRhVHlwZXMuc2xpY2UoKTsKCgkJLy8gQ3JlYXRlIGNvbnZlcnRlcnMgbWFwIHdpdGggbG93ZXJjYXNlZCBrZXlzCgkJaWYgKCBkYXRhVHlwZXNbIDEgXSApIHsKCQkJZm9yICggY29udiBpbiBzLmNvbnZlcnRlcnMgKSB7CgkJCQljb252ZXJ0ZXJzWyBjb252LnRvTG93ZXJDYXNlKCkgXSA9IHMuY29udmVydGVyc1sgY29udiBdOwoJCQl9CgkJfQoKCQljdXJyZW50ID0gZGF0YVR5cGVzLnNoaWZ0KCk7CgoJCS8vIENvbnZlcnQgdG8gZWFjaCBzZXF1ZW50aWFsIGRhdGFUeXBlCgkJd2hpbGUgKCBjdXJyZW50ICkgewoKCQkJaWYgKCBzLnJlc3BvbnNlRmllbGRzWyBjdXJyZW50IF0gKSB7CgkJCQlqcVhIUlsgcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdIF0gPSByZXNwb25zZTsKCQkJfQoKCQkJLy8gQXBwbHkgdGhlIGRhdGFGaWx0ZXIgaWYgcHJvdmlkZWQKCQkJaWYgKCAhcHJldiAmJiBpc1N1Y2Nlc3MgJiYgcy5kYXRhRmlsdGVyICkgewoJCQkJcmVzcG9uc2UgPSBzLmRhdGFGaWx0ZXIoIHJlc3BvbnNlLCBzLmRhdGFUeXBlICk7CgkJCX0KCgkJCXByZXYgPSBjdXJyZW50OwoJCQljdXJyZW50ID0gZGF0YVR5cGVzLnNoaWZ0KCk7CgoJCQlpZiAoIGN1cnJlbnQgKSB7CgoJCQkJLy8gVGhlcmUncyBvbmx5IHdvcmsgdG8gZG8gaWYgY3VycmVudCBkYXRhVHlwZSBpcyBub24tYXV0bwoJCQkJaWYgKCBjdXJyZW50ID09PSAiKiIgKSB7CgoJCQkJCWN1cnJlbnQgPSBwcmV2OwoKCQkJCS8vIENvbnZlcnQgcmVzcG9uc2UgaWYgcHJldiBkYXRhVHlwZSBpcyBub24tYXV0byBhbmQgZGlmZmVycyBmcm9tIGN1cnJlbnQKCQkJCX0gZWxzZSBpZiAoIHByZXYgIT09ICIqIiAmJiBwcmV2ICE9PSBjdXJyZW50ICkgewoKCQkJCQkvLyBTZWVrIGEgZGlyZWN0IGNvbnZlcnRlcgoJCQkJCWNvbnYgPSBjb252ZXJ0ZXJzWyBwcmV2ICsgIiAiICsgY3VycmVudCBdIHx8IGNvbnZlcnRlcnNbICIqICIgKyBjdXJyZW50IF07CgoJCQkJCS8vIElmIG5vbmUgZm91bmQsIHNlZWsgYSBwYWlyCgkJCQkJaWYgKCAhY29udiApIHsKCQkJCQkJZm9yICggY29udjIgaW4gY29udmVydGVycyApIHsKCgkJCQkJCQkvLyBJZiBjb252MiBvdXRwdXRzIGN1cnJlbnQKCQkJCQkJCXRtcCA9IGNvbnYyLnNwbGl0KCAiICIgKTsKCQkJCQkJCWlmICggdG1wWyAxIF0gPT09IGN1cnJlbnQgKSB7CgoJCQkJCQkJCS8vIElmIHByZXYgY2FuIGJlIGNvbnZlcnRlZCB0byBhY2NlcHRlZCBpbnB1dAoJCQkJCQkJCWNvbnYgPSBjb252ZXJ0ZXJzWyBwcmV2ICsgIiAiICsgdG1wWyAwIF0gXSB8fAoJCQkJCQkJCQljb252ZXJ0ZXJzWyAiKiAiICsgdG1wWyAwIF0gXTsKCQkJCQkJCQlpZiAoIGNvbnYgKSB7CgkJCQkJCQkJCS8vIENvbmRlbnNlIGVxdWl2YWxlbmNlIGNvbnZlcnRlcnMKCQkJCQkJCQkJaWYgKCBjb252ID09PSB0cnVlICkgewoJCQkJCQkJCQkJY29udiA9IGNvbnZlcnRlcnNbIGNvbnYyIF07CgoJCQkJCQkJCQkvLyBPdGhlcndpc2UsIGluc2VydCB0aGUgaW50ZXJtZWRpYXRlIGRhdGFUeXBlCgkJCQkJCQkJCX0gZWxzZSBpZiAoIGNvbnZlcnRlcnNbIGNvbnYyIF0gIT09IHRydWUgKSB7CgkJCQkJCQkJCQljdXJyZW50ID0gdG1wWyAwIF07CgkJCQkJCQkJCQlkYXRhVHlwZXMudW5zaGlmdCggdG1wWyAxIF0gKTsKCQkJCQkJCQkJfQoJCQkJCQkJCQlicmVhazsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIEFwcGx5IGNvbnZlcnRlciAoaWYgbm90IGFuIGVxdWl2YWxlbmNlKQoJCQkJCWlmICggY29udiAhPT0gdHJ1ZSApIHsKCgkJCQkJCS8vIFVubGVzcyBlcnJvcnMgYXJlIGFsbG93ZWQgdG8gYnViYmxlLCBjYXRjaCBhbmQgcmV0dXJuIHRoZW0KCQkJCQkJaWYgKCBjb252ICYmIHNbICJ0aHJvd3MiIF0gKSB7CgkJCQkJCQlyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQl0cnkgewoJCQkJCQkJCXJlc3BvbnNlID0gY29udiggcmVzcG9uc2UgKTsKCQkJCQkJCX0gY2F0Y2ggKCBlICkgewoJCQkJCQkJCXJldHVybiB7IHN0YXRlOiAicGFyc2VyZXJyb3IiLCBlcnJvcjogY29udiA/IGUgOiAiTm8gY29udmVyc2lvbiBmcm9tICIgKyBwcmV2ICsgIiB0byAiICsgY3VycmVudCB9OwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4geyBzdGF0ZTogInN1Y2Nlc3MiLCBkYXRhOiByZXNwb25zZSB9OwoJfQoKCWpRdWVyeS5leHRlbmQoewoKCQkvLyBDb3VudGVyIGZvciBob2xkaW5nIHRoZSBudW1iZXIgb2YgYWN0aXZlIHF1ZXJpZXMKCQlhY3RpdmU6IDAsCgoJCS8vIExhc3QtTW9kaWZpZWQgaGVhZGVyIGNhY2hlIGZvciBuZXh0IHJlcXVlc3QKCQlsYXN0TW9kaWZpZWQ6IHt9LAoJCWV0YWc6IHt9LAoKCQlhamF4U2V0dGluZ3M6IHsKCQkJdXJsOiBhamF4TG9jYXRpb24sCgkJCXR5cGU6ICJHRVQiLAoJCQlpc0xvY2FsOiBybG9jYWxQcm90b2NvbC50ZXN0KCBhamF4TG9jUGFydHNbIDEgXSApLAoJCQlnbG9iYWw6IHRydWUsCgkJCXByb2Nlc3NEYXRhOiB0cnVlLAoJCQlhc3luYzogdHJ1ZSwKCQkJY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLAoJCQkvKgoJCQl0aW1lb3V0OiAwLAoJCQlkYXRhOiBudWxsLAoJCQlkYXRhVHlwZTogbnVsbCwKCQkJdXNlcm5hbWU6IG51bGwsCgkJCXBhc3N3b3JkOiBudWxsLAoJCQljYWNoZTogbnVsbCwKCQkJdGhyb3dzOiBmYWxzZSwKCQkJdHJhZGl0aW9uYWw6IGZhbHNlLAoJCQloZWFkZXJzOiB7fSwKCQkJKi8KCgkJCWFjY2VwdHM6IHsKCQkJCSIqIjogYWxsVHlwZXMsCgkJCQl0ZXh0OiAidGV4dC9wbGFpbiIsCgkJCQlodG1sOiAidGV4dC9odG1sIiwKCQkJCXhtbDogImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLAoJCQkJanNvbjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCIKCQkJfSwKCgkJCWNvbnRlbnRzOiB7CgkJCQl4bWw6IC94bWwvLAoJCQkJaHRtbDogL2h0bWwvLAoJCQkJanNvbjogL2pzb24vCgkJCX0sCgoJCQlyZXNwb25zZUZpZWxkczogewoJCQkJeG1sOiAicmVzcG9uc2VYTUwiLAoJCQkJdGV4dDogInJlc3BvbnNlVGV4dCIsCgkJCQlqc29uOiAicmVzcG9uc2VKU09OIgoJCQl9LAoKCQkJLy8gRGF0YSBjb252ZXJ0ZXJzCgkJCS8vIEtleXMgc2VwYXJhdGUgc291cmNlIChvciBjYXRjaGFsbCAiKiIpIGFuZCBkZXN0aW5hdGlvbiB0eXBlcyB3aXRoIGEgc2luZ2xlIHNwYWNlCgkJCWNvbnZlcnRlcnM6IHsKCgkJCQkvLyBDb252ZXJ0IGFueXRoaW5nIHRvIHRleHQKCQkJCSIqIHRleHQiOiBTdHJpbmcsCgoJCQkJLy8gVGV4dCB0byBodG1sICh0cnVlID0gbm8gdHJhbnNmb3JtYXRpb24pCgkJCQkidGV4dCBodG1sIjogdHJ1ZSwKCgkJCQkvLyBFdmFsdWF0ZSB0ZXh0IGFzIGEganNvbiBleHByZXNzaW9uCgkJCQkidGV4dCBqc29uIjogalF1ZXJ5LnBhcnNlSlNPTiwKCgkJCQkvLyBQYXJzZSB0ZXh0IGFzIHhtbAoJCQkJInRleHQgeG1sIjogalF1ZXJ5LnBhcnNlWE1MCgkJCX0sCgoJCQkvLyBGb3Igb3B0aW9ucyB0aGF0IHNob3VsZG4ndCBiZSBkZWVwIGV4dGVuZGVkOgoJCQkvLyB5b3UgY2FuIGFkZCB5b3VyIG93biBjdXN0b20gb3B0aW9ucyBoZXJlIGlmCgkJCS8vIGFuZCB3aGVuIHlvdSBjcmVhdGUgb25lIHRoYXQgc2hvdWxkbid0IGJlCgkJCS8vIGRlZXAgZXh0ZW5kZWQgKHNlZSBhamF4RXh0ZW5kKQoJCQlmbGF0T3B0aW9uczogewoJCQkJdXJsOiB0cnVlLAoJCQkJY29udGV4dDogdHJ1ZQoJCQl9CgkJfSwKCgkJLy8gQ3JlYXRlcyBhIGZ1bGwgZmxlZGdlZCBzZXR0aW5ncyBvYmplY3QgaW50byB0YXJnZXQKCQkvLyB3aXRoIGJvdGggYWpheFNldHRpbmdzIGFuZCBzZXR0aW5ncyBmaWVsZHMuCgkJLy8gSWYgdGFyZ2V0IGlzIG9taXR0ZWQsIHdyaXRlcyBpbnRvIGFqYXhTZXR0aW5ncy4KCQlhamF4U2V0dXA6IGZ1bmN0aW9uKCB0YXJnZXQsIHNldHRpbmdzICkgewoJCQlyZXR1cm4gc2V0dGluZ3MgPwoKCQkJCS8vIEJ1aWxkaW5nIGEgc2V0dGluZ3Mgb2JqZWN0CgkJCQlhamF4RXh0ZW5kKCBhamF4RXh0ZW5kKCB0YXJnZXQsIGpRdWVyeS5hamF4U2V0dGluZ3MgKSwgc2V0dGluZ3MgKSA6CgoJCQkJLy8gRXh0ZW5kaW5nIGFqYXhTZXR0aW5ncwoJCQkJYWpheEV4dGVuZCggalF1ZXJ5LmFqYXhTZXR0aW5ncywgdGFyZ2V0ICk7CgkJfSwKCgkJYWpheFByZWZpbHRlcjogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzICksCgkJYWpheFRyYW5zcG9ydDogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCB0cmFuc3BvcnRzICksCgoJCS8vIE1haW4gbWV0aG9kCgkJYWpheDogZnVuY3Rpb24oIHVybCwgb3B0aW9ucyApIHsKCgkJCS8vIElmIHVybCBpcyBhbiBvYmplY3QsIHNpbXVsYXRlIHByZS0xLjUgc2lnbmF0dXJlCgkJCWlmICggdHlwZW9mIHVybCA9PT0gIm9iamVjdCIgKSB7CgkJCQlvcHRpb25zID0gdXJsOwoJCQkJdXJsID0gdW5kZWZpbmVkOwoJCQl9CgoJCQkvLyBGb3JjZSBvcHRpb25zIHRvIGJlIGFuIG9iamVjdAoJCQlvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCgkJCXZhciAvLyBDcm9zcy1kb21haW4gZGV0ZWN0aW9uIHZhcnMKCQkJCXBhcnRzLAoJCQkJLy8gTG9vcCB2YXJpYWJsZQoJCQkJaSwKCQkJCS8vIFVSTCB3aXRob3V0IGFudGktY2FjaGUgcGFyYW0KCQkJCWNhY2hlVVJMLAoJCQkJLy8gUmVzcG9uc2UgaGVhZGVycyBhcyBzdHJpbmcKCQkJCXJlc3BvbnNlSGVhZGVyc1N0cmluZywKCQkJCS8vIHRpbWVvdXQgaGFuZGxlCgkJCQl0aW1lb3V0VGltZXIsCgoJCQkJLy8gVG8ga25vdyBpZiBnbG9iYWwgZXZlbnRzIGFyZSB0byBiZSBkaXNwYXRjaGVkCgkJCQlmaXJlR2xvYmFscywKCgkJCQl0cmFuc3BvcnQsCgkJCQkvLyBSZXNwb25zZSBoZWFkZXJzCgkJCQlyZXNwb25zZUhlYWRlcnMsCgkJCQkvLyBDcmVhdGUgdGhlIGZpbmFsIG9wdGlvbnMgb2JqZWN0CgkJCQlzID0galF1ZXJ5LmFqYXhTZXR1cCgge30sIG9wdGlvbnMgKSwKCQkJCS8vIENhbGxiYWNrcyBjb250ZXh0CgkJCQljYWxsYmFja0NvbnRleHQgPSBzLmNvbnRleHQgfHwgcywKCQkJCS8vIENvbnRleHQgZm9yIGdsb2JhbCBldmVudHMgaXMgY2FsbGJhY2tDb250ZXh0IGlmIGl0IGlzIGEgRE9NIG5vZGUgb3IgalF1ZXJ5IGNvbGxlY3Rpb24KCQkJCWdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJiAoIGNhbGxiYWNrQ29udGV4dC5ub2RlVHlwZSB8fCBjYWxsYmFja0NvbnRleHQuanF1ZXJ5ICkgPwoJCQkJCWpRdWVyeSggY2FsbGJhY2tDb250ZXh0ICkgOgoJCQkJCWpRdWVyeS5ldmVudCwKCQkJCS8vIERlZmVycmVkcwoJCQkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKSwKCQkJCWNvbXBsZXRlRGVmZXJyZWQgPSBqUXVlcnkuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLAoJCQkJLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKCQkJCXN0YXR1c0NvZGUgPSBzLnN0YXR1c0NvZGUgfHwge30sCgkJCQkvLyBIZWFkZXJzICh0aGV5IGFyZSBzZW50IGFsbCBhdCBvbmNlKQoJCQkJcmVxdWVzdEhlYWRlcnMgPSB7fSwKCQkJCXJlcXVlc3RIZWFkZXJzTmFtZXMgPSB7fSwKCQkJCS8vIFRoZSBqcVhIUiBzdGF0ZQoJCQkJc3RhdGUgPSAwLAoJCQkJLy8gRGVmYXVsdCBhYm9ydCBtZXNzYWdlCgkJCQlzdHJBYm9ydCA9ICJjYW5jZWxlZCIsCgkJCQkvLyBGYWtlIHhocgoJCQkJanFYSFIgPSB7CgkJCQkJcmVhZHlTdGF0ZTogMCwKCgkJCQkJLy8gQnVpbGRzIGhlYWRlcnMgaGFzaHRhYmxlIGlmIG5lZWRlZAoJCQkJCWdldFJlc3BvbnNlSGVhZGVyOiBmdW5jdGlvbigga2V5ICkgewoJCQkJCQl2YXIgbWF0Y2g7CgkJCQkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQkJCQlpZiAoICFyZXNwb25zZUhlYWRlcnMgKSB7CgkJCQkJCQkJcmVzcG9uc2VIZWFkZXJzID0ge307CgkJCQkJCQkJd2hpbGUgKCAobWF0Y2ggPSByaGVhZGVycy5leGVjKCByZXNwb25zZUhlYWRlcnNTdHJpbmcgKSkgKSB7CgkJCQkJCQkJCXJlc3BvbnNlSGVhZGVyc1sgbWF0Y2hbMV0udG9Mb3dlckNhc2UoKSBdID0gbWF0Y2hbIDIgXTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQltYXRjaCA9IHJlc3BvbnNlSGVhZGVyc1sga2V5LnRvTG93ZXJDYXNlKCkgXTsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gbWF0Y2ggPT0gbnVsbCA/IG51bGwgOiBtYXRjaDsKCQkJCQl9LAoKCQkJCQkvLyBSYXcgc3RyaW5nCgkJCQkJZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHsKCQkJCQkJcmV0dXJuIHN0YXRlID09PSAyID8gcmVzcG9uc2VIZWFkZXJzU3RyaW5nIDogbnVsbDsKCQkJCQl9LAoKCQkJCQkvLyBDYWNoZXMgdGhlIGhlYWRlcgoJCQkJCXNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHsKCQkJCQkJdmFyIGxuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpOwoJCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJCW5hbWUgPSByZXF1ZXN0SGVhZGVyc05hbWVzWyBsbmFtZSBdID0gcmVxdWVzdEhlYWRlcnNOYW1lc1sgbG5hbWUgXSB8fCBuYW1lOwoJCQkJCQkJcmVxdWVzdEhlYWRlcnNbIG5hbWUgXSA9IHZhbHVlOwoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIE92ZXJyaWRlcyByZXNwb25zZSBjb250ZW50LXR5cGUgaGVhZGVyCgkJCQkJb3ZlcnJpZGVNaW1lVHlwZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCQkJCWlmICggIXN0YXRlICkgewoJCQkJCQkJcy5taW1lVHlwZSA9IHR5cGU7CgkJCQkJCX0KCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfSwKCgkJCQkJLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKCQkJCQlzdGF0dXNDb2RlOiBmdW5jdGlvbiggbWFwICkgewoJCQkJCQl2YXIgY29kZTsKCQkJCQkJaWYgKCBtYXAgKSB7CgkJCQkJCQlpZiAoIHN0YXRlIDwgMiApIHsKCQkJCQkJCQlmb3IgKCBjb2RlIGluIG1hcCApIHsKCQkJCQkJCQkJLy8gTGF6eS1hZGQgdGhlIG5ldyBjYWxsYmFjayBpbiBhIHdheSB0aGF0IHByZXNlcnZlcyBvbGQgb25lcwoJCQkJCQkJCQlzdGF0dXNDb2RlWyBjb2RlIF0gPSBbIHN0YXR1c0NvZGVbIGNvZGUgXSwgbWFwWyBjb2RlIF0gXTsKCQkJCQkJCQl9CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCS8vIEV4ZWN1dGUgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrcwoJCQkJCQkJCWpxWEhSLmFsd2F5cyggbWFwWyBqcVhIUi5zdGF0dXMgXSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIENhbmNlbCB0aGUgcmVxdWVzdAoJCQkJCWFib3J0OiBmdW5jdGlvbiggc3RhdHVzVGV4dCApIHsKCQkJCQkJdmFyIGZpbmFsVGV4dCA9IHN0YXR1c1RleHQgfHwgc3RyQWJvcnQ7CgkJCQkJCWlmICggdHJhbnNwb3J0ICkgewoJCQkJCQkJdHJhbnNwb3J0LmFib3J0KCBmaW5hbFRleHQgKTsKCQkJCQkJfQoJCQkJCQlkb25lKCAwLCBmaW5hbFRleHQgKTsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfQoJCQkJfTsKCgkJCS8vIEF0dGFjaCBkZWZlcnJlZHMKCQkJZGVmZXJyZWQucHJvbWlzZSgganFYSFIgKS5jb21wbGV0ZSA9IGNvbXBsZXRlRGVmZXJyZWQuYWRkOwoJCQlqcVhIUi5zdWNjZXNzID0ganFYSFIuZG9uZTsKCQkJanFYSFIuZXJyb3IgPSBqcVhIUi5mYWlsOwoKCQkJLy8gUmVtb3ZlIGhhc2ggY2hhcmFjdGVyICgjNzUzMTogYW5kIHN0cmluZyBwcm9tb3Rpb24pCgkJCS8vIEFkZCBwcm90b2NvbCBpZiBub3QgcHJvdmlkZWQgKCM1ODY2OiBJRTcgaXNzdWUgd2l0aCBwcm90b2NvbC1sZXNzIHVybHMpCgkJCS8vIEhhbmRsZSBmYWxzeSB1cmwgaW4gdGhlIHNldHRpbmdzIG9iamVjdCAoIzEwMDkzOiBjb25zaXN0ZW5jeSB3aXRoIG9sZCBzaWduYXR1cmUpCgkJCS8vIFdlIGFsc28gdXNlIHRoZSB1cmwgcGFyYW1ldGVyIGlmIGF2YWlsYWJsZQoJCQlzLnVybCA9ICggKCB1cmwgfHwgcy51cmwgfHwgYWpheExvY2F0aW9uICkgKyAiIiApLnJlcGxhY2UoIHJoYXNoLCAiIiApLnJlcGxhY2UoIHJwcm90b2NvbCwgYWpheExvY1BhcnRzWyAxIF0gKyAiLy8iICk7CgoJCQkvLyBBbGlhcyBtZXRob2Qgb3B0aW9uIHRvIHR5cGUgYXMgcGVyIHRpY2tldCAjMTIwMDQKCQkJcy50eXBlID0gb3B0aW9ucy5tZXRob2QgfHwgb3B0aW9ucy50eXBlIHx8IHMubWV0aG9kIHx8IHMudHlwZTsKCgkJCS8vIEV4dHJhY3QgZGF0YVR5cGVzIGxpc3QKCQkJcy5kYXRhVHlwZXMgPSBqUXVlcnkudHJpbSggcy5kYXRhVHlwZSB8fCAiKiIgKS50b0xvd2VyQ2FzZSgpLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbICIiIF07CgoJCQkvLyBBIGNyb3NzLWRvbWFpbiByZXF1ZXN0IGlzIGluIG9yZGVyIHdoZW4gd2UgaGF2ZSBhIHByb3RvY29sOmhvc3Q6cG9ydCBtaXNtYXRjaAoJCQlpZiAoIHMuY3Jvc3NEb21haW4gPT0gbnVsbCApIHsKCQkJCXBhcnRzID0gcnVybC5leGVjKCBzLnVybC50b0xvd2VyQ2FzZSgpICk7CgkJCQlzLmNyb3NzRG9tYWluID0gISEoIHBhcnRzICYmCgkJCQkJKCBwYXJ0c1sgMSBdICE9PSBhamF4TG9jUGFydHNbIDEgXSB8fCBwYXJ0c1sgMiBdICE9PSBhamF4TG9jUGFydHNbIDIgXSB8fAoJCQkJCQkoIHBhcnRzWyAzIF0gfHwgKCBwYXJ0c1sgMSBdID09PSAiaHR0cDoiID8gIjgwIiA6ICI0NDMiICkgKSAhPT0KCQkJCQkJCSggYWpheExvY1BhcnRzWyAzIF0gfHwgKCBhamF4TG9jUGFydHNbIDEgXSA9PT0gImh0dHA6IiA/ICI4MCIgOiAiNDQzIiApICkgKQoJCQkJKTsKCQkJfQoKCQkJLy8gQ29udmVydCBkYXRhIGlmIG5vdCBhbHJlYWR5IGEgc3RyaW5nCgkJCWlmICggcy5kYXRhICYmIHMucHJvY2Vzc0RhdGEgJiYgdHlwZW9mIHMuZGF0YSAhPT0gInN0cmluZyIgKSB7CgkJCQlzLmRhdGEgPSBqUXVlcnkucGFyYW0oIHMuZGF0YSwgcy50cmFkaXRpb25hbCApOwoJCQl9CgoJCQkvLyBBcHBseSBwcmVmaWx0ZXJzCgkJCWluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzLCBzLCBvcHRpb25zLCBqcVhIUiApOwoKCQkJLy8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYSBwcmVmaWx0ZXIsIHN0b3AgdGhlcmUKCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCXJldHVybiBqcVhIUjsKCQkJfQoKCQkJLy8gV2UgY2FuIGZpcmUgZ2xvYmFsIGV2ZW50cyBhcyBvZiBub3cgaWYgYXNrZWQgdG8KCQkJLy8gRG9uJ3QgZmlyZSBldmVudHMgaWYgalF1ZXJ5LmV2ZW50IGlzIHVuZGVmaW5lZCBpbiBhbiBBTUQtdXNhZ2Ugc2NlbmFyaW8gKCMxNTExOCkKCQkJZmlyZUdsb2JhbHMgPSBqUXVlcnkuZXZlbnQgJiYgcy5nbG9iYWw7CgoJCQkvLyBXYXRjaCBmb3IgYSBuZXcgc2V0IG9mIHJlcXVlc3RzCgkJCWlmICggZmlyZUdsb2JhbHMgJiYgalF1ZXJ5LmFjdGl2ZSsrID09PSAwICkgewoJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpOwoJCQl9CgoJCQkvLyBVcHBlcmNhc2UgdGhlIHR5cGUKCQkJcy50eXBlID0gcy50eXBlLnRvVXBwZXJDYXNlKCk7CgoJCQkvLyBEZXRlcm1pbmUgaWYgcmVxdWVzdCBoYXMgY29udGVudAoJCQlzLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KCBzLnR5cGUgKTsKCgkJCS8vIFNhdmUgdGhlIFVSTCBpbiBjYXNlIHdlJ3JlIHRveWluZyB3aXRoIHRoZSBJZi1Nb2RpZmllZC1TaW5jZQoJCQkvLyBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIgbGF0ZXIgb24KCQkJY2FjaGVVUkwgPSBzLnVybDsKCgkJCS8vIE1vcmUgb3B0aW9ucyBoYW5kbGluZyBmb3IgcmVxdWVzdHMgd2l0aCBubyBjb250ZW50CgkJCWlmICggIXMuaGFzQ29udGVudCApIHsKCgkJCQkvLyBJZiBkYXRhIGlzIGF2YWlsYWJsZSwgYXBwZW5kIGRhdGEgdG8gdXJsCgkJCQlpZiAoIHMuZGF0YSApIHsKCQkJCQljYWNoZVVSTCA9ICggcy51cmwgKz0gKCBycXVlcnkudGVzdCggY2FjaGVVUkwgKSA/ICImIiA6ICI/IiApICsgcy5kYXRhICk7CgkJCQkJLy8gIzk2ODI6IHJlbW92ZSBkYXRhIHNvIHRoYXQgaXQncyBub3QgdXNlZCBpbiBhbiBldmVudHVhbCByZXRyeQoJCQkJCWRlbGV0ZSBzLmRhdGE7CgkJCQl9CgoJCQkJLy8gQWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZAoJCQkJaWYgKCBzLmNhY2hlID09PSBmYWxzZSApIHsKCQkJCQlzLnVybCA9IHJ0cy50ZXN0KCBjYWNoZVVSTCApID8KCgkJCQkJCS8vIElmIHRoZXJlIGlzIGFscmVhZHkgYSAnXycgcGFyYW1ldGVyLCBzZXQgaXRzIHZhbHVlCgkJCQkJCWNhY2hlVVJMLnJlcGxhY2UoIHJ0cywgIiQxXz0iICsgbm9uY2UrKyApIDoKCgkJCQkJCS8vIE90aGVyd2lzZSBhZGQgb25lIHRvIHRoZSBlbmQKCQkJCQkJY2FjaGVVUkwgKyAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gIiYiIDogIj8iICkgKyAiXz0iICsgbm9uY2UrKzsKCQkJCX0KCQkJfQoKCQkJLy8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS4KCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQlpZiAoIGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gKSB7CgkJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIklmLU1vZGlmaWVkLVNpbmNlIiwgalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApOwoJCQkJfQoJCQkJaWYgKCBqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSApIHsKCQkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCAiSWYtTm9uZS1NYXRjaCIsIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICk7CgkJCQl9CgkJCX0KCgkJCS8vIFNldCB0aGUgY29ycmVjdCBoZWFkZXIsIGlmIGRhdGEgaXMgYmVpbmcgc2VudAoJCQlpZiAoIHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSApIHsKCQkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoICJDb250ZW50LVR5cGUiLCBzLmNvbnRlbnRUeXBlICk7CgkJCX0KCgkJCS8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRlcGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlcigKCQkJCSJBY2NlcHQiLAoJCQkJcy5kYXRhVHlwZXNbIDAgXSAmJiBzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWzBdIF0gPwoJCQkJCXMuYWNjZXB0c1sgcy5kYXRhVHlwZXNbMF0gXSArICggcy5kYXRhVHlwZXNbIDAgXSAhPT0gIioiID8gIiwgIiArIGFsbFR5cGVzICsgIjsgcT0wLjAxIiA6ICIiICkgOgoJCQkJCXMuYWNjZXB0c1sgIioiIF0KCQkJKTsKCgkJCS8vIENoZWNrIGZvciBoZWFkZXJzIG9wdGlvbgoJCQlmb3IgKCBpIGluIHMuaGVhZGVycyApIHsKCQkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIGksIHMuaGVhZGVyc1sgaSBdICk7CgkJCX0KCgkJCS8vIEFsbG93IGN1c3RvbSBoZWFkZXJzL21pbWV0eXBlcyBhbmQgZWFybHkgYWJvcnQKCQkJaWYgKCBzLmJlZm9yZVNlbmQgJiYgKCBzLmJlZm9yZVNlbmQuY2FsbCggY2FsbGJhY2tDb250ZXh0LCBqcVhIUiwgcyApID09PSBmYWxzZSB8fCBzdGF0ZSA9PT0gMiApICkgewoJCQkJLy8gQWJvcnQgaWYgbm90IGRvbmUgYWxyZWFkeSBhbmQgcmV0dXJuCgkJCQlyZXR1cm4ganFYSFIuYWJvcnQoKTsKCQkJfQoKCQkJLy8gYWJvcnRpbmcgaXMgbm8gbG9uZ2VyIGEgY2FuY2VsbGF0aW9uCgkJCXN0ckFib3J0ID0gImFib3J0IjsKCgkJCS8vIEluc3RhbGwgY2FsbGJhY2tzIG9uIGRlZmVycmVkcwoJCQlmb3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0gKSB7CgkJCQlqcVhIUlsgaSBdKCBzWyBpIF0gKTsKCQkJfQoKCQkJLy8gR2V0IHRyYW5zcG9ydAoJCQl0cmFuc3BvcnQgPSBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJCS8vIElmIG5vIHRyYW5zcG9ydCwgd2UgYXV0by1hYm9ydAoJCQlpZiAoICF0cmFuc3BvcnQgKSB7CgkJCQlkb25lKCAtMSwgIk5vIFRyYW5zcG9ydCIgKTsKCQkJfSBlbHNlIHsKCQkJCWpxWEhSLnJlYWR5U3RhdGUgPSAxOwoKCQkJCS8vIFNlbmQgZ2xvYmFsIGV2ZW50CgkJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCAiYWpheFNlbmQiLCBbIGpxWEhSLCBzIF0gKTsKCQkJCX0KCQkJCS8vIFRpbWVvdXQKCQkJCWlmICggcy5hc3luYyAmJiBzLnRpbWVvdXQgPiAwICkgewoJCQkJCXRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCQkJCWpxWEhSLmFib3J0KCJ0aW1lb3V0Iik7CgkJCQkJfSwgcy50aW1lb3V0ICk7CgkJCQl9CgoJCQkJdHJ5IHsKCQkJCQlzdGF0ZSA9IDE7CgkJCQkJdHJhbnNwb3J0LnNlbmQoIHJlcXVlc3RIZWFkZXJzLCBkb25lICk7CgkJCQl9IGNhdGNoICggZSApIHsKCQkJCQkvLyBQcm9wYWdhdGUgZXhjZXB0aW9uIGFzIGVycm9yIGlmIG5vdCBkb25lCgkJCQkJaWYgKCBzdGF0ZSA8IDIgKSB7CgkJCQkJCWRvbmUoIC0xLCBlICk7CgkJCQkJLy8gU2ltcGx5IHJldGhyb3cgb3RoZXJ3aXNlCgkJCQkJfSBlbHNlIHsKCQkJCQkJdGhyb3cgZTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIENhbGxiYWNrIGZvciB3aGVuIGV2ZXJ5dGhpbmcgaXMgZG9uZQoJCQlmdW5jdGlvbiBkb25lKCBzdGF0dXMsIG5hdGl2ZVN0YXR1c1RleHQsIHJlc3BvbnNlcywgaGVhZGVycyApIHsKCQkJCXZhciBpc1N1Y2Nlc3MsIHN1Y2Nlc3MsIGVycm9yLCByZXNwb25zZSwgbW9kaWZpZWQsCgkJCQkJc3RhdHVzVGV4dCA9IG5hdGl2ZVN0YXR1c1RleHQ7CgoJCQkJLy8gQ2FsbGVkIG9uY2UKCQkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCS8vIFN0YXRlIGlzICJkb25lIiBub3cKCQkJCXN0YXRlID0gMjsKCgkJCQkvLyBDbGVhciB0aW1lb3V0IGlmIGl0IGV4aXN0cwoJCQkJaWYgKCB0aW1lb3V0VGltZXIgKSB7CgkJCQkJY2xlYXJUaW1lb3V0KCB0aW1lb3V0VGltZXIgKTsKCQkJCX0KCgkJCQkvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5IGdhcmJhZ2UgY29sbGVjdGlvbgoJCQkJLy8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZCkKCQkJCXRyYW5zcG9ydCA9IHVuZGVmaW5lZDsKCgkJCQkvLyBDYWNoZSByZXNwb25zZSBoZWFkZXJzCgkJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcgPSBoZWFkZXJzIHx8ICIiOwoKCQkJCS8vIFNldCByZWFkeVN0YXRlCgkJCQlqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwOwoKCQkJCS8vIERldGVybWluZSBpZiBzdWNjZXNzZnVsCgkJCQlpc1N1Y2Nlc3MgPSBzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNDsKCgkJCQkvLyBHZXQgcmVzcG9uc2UgZGF0YQoJCQkJaWYgKCByZXNwb25zZXMgKSB7CgkJCQkJcmVzcG9uc2UgPSBhamF4SGFuZGxlUmVzcG9uc2VzKCBzLCBqcVhIUiwgcmVzcG9uc2VzICk7CgkJCQl9CgoJCQkJLy8gQ29udmVydCBubyBtYXR0ZXIgd2hhdCAodGhhdCB3YXkgcmVzcG9uc2VYWFggZmllbGRzIGFyZSBhbHdheXMgc2V0KQoJCQkJcmVzcG9uc2UgPSBhamF4Q29udmVydCggcywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MgKTsKCgkJCQkvLyBJZiBzdWNjZXNzZnVsLCBoYW5kbGUgdHlwZSBjaGFpbmluZwoJCQkJaWYgKCBpc1N1Y2Nlc3MgKSB7CgoJCQkJCS8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuCgkJCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQkJCW1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKTsKCQkJCQkJaWYgKCBtb2RpZmllZCApIHsKCQkJCQkJCWpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gPSBtb2RpZmllZDsKCQkJCQkJfQoJCQkJCQltb2RpZmllZCA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJldGFnIik7CgkJCQkJCWlmICggbW9kaWZpZWQgKSB7CgkJCQkJCQlqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSA9IG1vZGlmaWVkOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBpZiBubyBjb250ZW50CgkJCQkJaWYgKCBzdGF0dXMgPT09IDIwNCB8fCBzLnR5cGUgPT09ICJIRUFEIiApIHsKCQkJCQkJc3RhdHVzVGV4dCA9ICJub2NvbnRlbnQiOwoKCQkJCQkvLyBpZiBub3QgbW9kaWZpZWQKCQkJCQl9IGVsc2UgaWYgKCBzdGF0dXMgPT09IDMwNCApIHsKCQkJCQkJc3RhdHVzVGV4dCA9ICJub3Rtb2RpZmllZCI7CgoJCQkJCS8vIElmIHdlIGhhdmUgZGF0YSwgbGV0J3MgY29udmVydCBpdAoJCQkJCX0gZWxzZSB7CgkJCQkJCXN0YXR1c1RleHQgPSByZXNwb25zZS5zdGF0ZTsKCQkJCQkJc3VjY2VzcyA9IHJlc3BvbnNlLmRhdGE7CgkJCQkJCWVycm9yID0gcmVzcG9uc2UuZXJyb3I7CgkJCQkJCWlzU3VjY2VzcyA9ICFlcnJvcjsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCS8vIFdlIGV4dHJhY3QgZXJyb3IgZnJvbSBzdGF0dXNUZXh0CgkJCQkJLy8gdGhlbiBub3JtYWxpemUgc3RhdHVzVGV4dCBhbmQgc3RhdHVzIGZvciBub24tYWJvcnRzCgkJCQkJZXJyb3IgPSBzdGF0dXNUZXh0OwoJCQkJCWlmICggc3RhdHVzIHx8ICFzdGF0dXNUZXh0ICkgewoJCQkJCQlzdGF0dXNUZXh0ID0gImVycm9yIjsKCQkJCQkJaWYgKCBzdGF0dXMgPCAwICkgewoJCQkJCQkJc3RhdHVzID0gMDsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBTZXQgZGF0YSBmb3IgdGhlIGZha2UgeGhyIG9iamVjdAoJCQkJanFYSFIuc3RhdHVzID0gc3RhdHVzOwoJCQkJanFYSFIuc3RhdHVzVGV4dCA9ICggbmF0aXZlU3RhdHVzVGV4dCB8fCBzdGF0dXNUZXh0ICkgKyAiIjsKCgkJCQkvLyBTdWNjZXNzL0Vycm9yCgkJCQlpZiAoIGlzU3VjY2VzcyApIHsKCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIHN1Y2Nlc3MsIHN0YXR1c1RleHQsIGpxWEhSIF0gKTsKCQkJCX0gZWxzZSB7CgkJCQkJZGVmZXJyZWQucmVqZWN0V2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIGpxWEhSLCBzdGF0dXNUZXh0LCBlcnJvciBdICk7CgkJCQl9CgoJCQkJLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKCQkJCWpxWEhSLnN0YXR1c0NvZGUoIHN0YXR1c0NvZGUgKTsKCQkJCXN0YXR1c0NvZGUgPSB1bmRlZmluZWQ7CgoJCQkJaWYgKCBmaXJlR2xvYmFscyApIHsKCQkJCQlnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggaXNTdWNjZXNzID8gImFqYXhTdWNjZXNzIiA6ICJhamF4RXJyb3IiLAoJCQkJCQlbIGpxWEhSLCBzLCBpc1N1Y2Nlc3MgPyBzdWNjZXNzIDogZXJyb3IgXSApOwoJCQkJfQoKCQkJCS8vIENvbXBsZXRlCgkJCQljb21wbGV0ZURlZmVycmVkLmZpcmVXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsganFYSFIsIHN0YXR1c1RleHQgXSApOwoKCQkJCWlmICggZmlyZUdsb2JhbHMgKSB7CgkJCQkJZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoICJhamF4Q29tcGxldGUiLCBbIGpxWEhSLCBzIF0gKTsKCQkJCQkvLyBIYW5kbGUgdGhlIGdsb2JhbCBBSkFYIGNvdW50ZXIKCQkJCQlpZiAoICEoIC0talF1ZXJ5LmFjdGl2ZSApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiBqcVhIUjsKCQl9LAoKCQlnZXRKU09OOiBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgZGF0YSwgY2FsbGJhY2ssICJqc29uIiApOwoJCX0sCgoJCWdldFNjcmlwdDogZnVuY3Rpb24oIHVybCwgY2FsbGJhY2sgKSB7CgkJCXJldHVybiBqUXVlcnkuZ2V0KCB1cmwsIHVuZGVmaW5lZCwgY2FsbGJhY2ssICJzY3JpcHQiICk7CgkJfQoJfSk7CgoJalF1ZXJ5LmVhY2goIFsgImdldCIsICJwb3N0IiBdLCBmdW5jdGlvbiggaSwgbWV0aG9kICkgewoJCWpRdWVyeVsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjaywgdHlwZSApIHsKCQkJLy8gc2hpZnQgYXJndW1lbnRzIGlmIGRhdGEgYXJndW1lbnQgd2FzIG9taXR0ZWQKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggZGF0YSApICkgewoJCQkJdHlwZSA9IHR5cGUgfHwgY2FsbGJhY2s7CgkJCQljYWxsYmFjayA9IGRhdGE7CgkJCQlkYXRhID0gdW5kZWZpbmVkOwoJCQl9CgoJCQlyZXR1cm4galF1ZXJ5LmFqYXgoewoJCQkJdXJsOiB1cmwsCgkJCQl0eXBlOiBtZXRob2QsCgkJCQlkYXRhVHlwZTogdHlwZSwKCQkJCWRhdGE6IGRhdGEsCgkJCQlzdWNjZXNzOiBjYWxsYmFjawoJCQl9KTsKCQl9OwoJfSk7CgoKCWpRdWVyeS5fZXZhbFVybCA9IGZ1bmN0aW9uKCB1cmwgKSB7CgkJcmV0dXJuIGpRdWVyeS5hamF4KHsKCQkJdXJsOiB1cmwsCgkJCXR5cGU6ICJHRVQiLAoJCQlkYXRhVHlwZTogInNjcmlwdCIsCgkJCWFzeW5jOiBmYWxzZSwKCQkJZ2xvYmFsOiBmYWxzZSwKCQkJInRocm93cyI6IHRydWUKCQl9KTsKCX07CgoKCWpRdWVyeS5mbi5leHRlbmQoewoJCXdyYXBBbGw6IGZ1bmN0aW9uKCBodG1sICkgewoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICkgKSB7CgkJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpIHsKCQkJCQlqUXVlcnkodGhpcykud3JhcEFsbCggaHRtbC5jYWxsKHRoaXMsIGkpICk7CgkJCQl9KTsKCQkJfQoKCQkJaWYgKCB0aGlzWzBdICkgewoJCQkJLy8gVGhlIGVsZW1lbnRzIHRvIHdyYXAgdGhlIHRhcmdldCBhcm91bmQKCQkJCXZhciB3cmFwID0galF1ZXJ5KCBodG1sLCB0aGlzWzBdLm93bmVyRG9jdW1lbnQgKS5lcSgwKS5jbG9uZSh0cnVlKTsKCgkJCQlpZiAoIHRoaXNbMF0ucGFyZW50Tm9kZSApIHsKCQkJCQl3cmFwLmluc2VydEJlZm9yZSggdGhpc1swXSApOwoJCQkJfQoKCQkJCXdyYXAubWFwKGZ1bmN0aW9uKCkgewoJCQkJCXZhciBlbGVtID0gdGhpczsKCgkJCQkJd2hpbGUgKCBlbGVtLmZpcnN0Q2hpbGQgJiYgZWxlbS5maXJzdENoaWxkLm5vZGVUeXBlID09PSAxICkgewoJCQkJCQllbGVtID0gZWxlbS5maXJzdENoaWxkOwoJCQkJCX0KCgkJCQkJcmV0dXJuIGVsZW07CgkJCQl9KS5hcHBlbmQoIHRoaXMgKTsKCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJd3JhcElubmVyOiBmdW5jdGlvbiggaHRtbCApIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7CgkJCQkJalF1ZXJ5KHRoaXMpLndyYXBJbm5lciggaHRtbC5jYWxsKHRoaXMsIGkpICk7CgkJCQl9KTsKCQkJfQoKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCXZhciBzZWxmID0galF1ZXJ5KCB0aGlzICksCgkJCQkJY29udGVudHMgPSBzZWxmLmNvbnRlbnRzKCk7CgoJCQkJaWYgKCBjb250ZW50cy5sZW5ndGggKSB7CgkJCQkJY29udGVudHMud3JhcEFsbCggaHRtbCApOwoKCQkJCX0gZWxzZSB7CgkJCQkJc2VsZi5hcHBlbmQoIGh0bWwgKTsKCQkJCX0KCQkJfSk7CgkJfSwKCgkJd3JhcDogZnVuY3Rpb24oIGh0bWwgKSB7CgkJCXZhciBpc0Z1bmN0aW9uID0galF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwgKTsKCgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSkgewoJCQkJalF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaXNGdW5jdGlvbiA/IGh0bWwuY2FsbCh0aGlzLCBpKSA6IGh0bWwgKTsKCQkJfSk7CgkJfSwKCgkJdW53cmFwOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMucGFyZW50KCkuZWFjaChmdW5jdGlvbigpIHsKCQkJCWlmICggIWpRdWVyeS5ub2RlTmFtZSggdGhpcywgImJvZHkiICkgKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkucmVwbGFjZVdpdGgoIHRoaXMuY2hpbGROb2RlcyApOwoJCQkJfQoJCQl9KS5lbmQoKTsKCQl9Cgl9KTsKCgoJalF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4gPSBmdW5jdGlvbiggZWxlbSApIHsKCQkvLyBTdXBwb3J0OiBPcGVyYSA8PSAxMi4xMgoJCS8vIE9wZXJhIHJlcG9ydHMgb2Zmc2V0V2lkdGhzIGFuZCBvZmZzZXRIZWlnaHRzIGxlc3MgdGhhbiB6ZXJvIG9uIHNvbWUgZWxlbWVudHMKCQlyZXR1cm4gZWxlbS5vZmZzZXRXaWR0aCA8PSAwICYmIGVsZW0ub2Zmc2V0SGVpZ2h0IDw9IDAgfHwKCQkJKCFzdXBwb3J0LnJlbGlhYmxlSGlkZGVuT2Zmc2V0cygpICYmCgkJCQkoKGVsZW0uc3R5bGUgJiYgZWxlbS5zdHlsZS5kaXNwbGF5KSB8fCBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSkgPT09ICJub25lIik7Cgl9OwoKCWpRdWVyeS5leHByLmZpbHRlcnMudmlzaWJsZSA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiAhalF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4oIGVsZW0gKTsKCX07CgoKCgoJdmFyIHIyMCA9IC8lMjAvZywKCQlyYnJhY2tldCA9IC9cW1xdJC8sCgkJckNSTEYgPSAvXHI/XG4vZywKCQlyc3VibWl0dGVyVHlwZXMgPSAvXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksCgkJcnN1Ym1pdHRhYmxlID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pOwoKCWZ1bmN0aW9uIGJ1aWxkUGFyYW1zKCBwcmVmaXgsIG9iaiwgdHJhZGl0aW9uYWwsIGFkZCApIHsKCQl2YXIgbmFtZTsKCgkJaWYgKCBqUXVlcnkuaXNBcnJheSggb2JqICkgKSB7CgkJCS8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLgoJCQlqUXVlcnkuZWFjaCggb2JqLCBmdW5jdGlvbiggaSwgdiApIHsKCQkJCWlmICggdHJhZGl0aW9uYWwgfHwgcmJyYWNrZXQudGVzdCggcHJlZml4ICkgKSB7CgkJCQkJLy8gVHJlYXQgZWFjaCBhcnJheSBpdGVtIGFzIGEgc2NhbGFyLgoJCQkJCWFkZCggcHJlZml4LCB2ICk7CgoJCQkJfSBlbHNlIHsKCQkJCQkvLyBJdGVtIGlzIG5vbi1zY2FsYXIgKGFycmF5IG9yIG9iamVjdCksIGVuY29kZSBpdHMgbnVtZXJpYyBpbmRleC4KCQkJCQlidWlsZFBhcmFtcyggcHJlZml4ICsgIlsiICsgKCB0eXBlb2YgdiA9PT0gIm9iamVjdCIgPyBpIDogIiIgKSArICJdIiwgdiwgdHJhZGl0aW9uYWwsIGFkZCApOwoJCQkJfQoJCQl9KTsKCgkJfSBlbHNlIGlmICggIXRyYWRpdGlvbmFsICYmIGpRdWVyeS50eXBlKCBvYmogKSA9PT0gIm9iamVjdCIgKSB7CgkJCS8vIFNlcmlhbGl6ZSBvYmplY3QgaXRlbS4KCQkJZm9yICggbmFtZSBpbiBvYmogKSB7CgkJCQlidWlsZFBhcmFtcyggcHJlZml4ICsgIlsiICsgbmFtZSArICJdIiwgb2JqWyBuYW1lIF0sIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQkJfQoKCQl9IGVsc2UgewoJCQkvLyBTZXJpYWxpemUgc2NhbGFyIGl0ZW0uCgkJCWFkZCggcHJlZml4LCBvYmogKTsKCQl9Cgl9CgoJLy8gU2VyaWFsaXplIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMgb3IgYSBzZXQgb2YKCS8vIGtleS92YWx1ZXMgaW50byBhIHF1ZXJ5IHN0cmluZwoJalF1ZXJ5LnBhcmFtID0gZnVuY3Rpb24oIGEsIHRyYWRpdGlvbmFsICkgewoJCXZhciBwcmVmaXgsCgkJCXMgPSBbXSwKCQkJYWRkID0gZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7CgkJCQkvLyBJZiB2YWx1ZSBpcyBhIGZ1bmN0aW9uLCBpbnZva2UgaXQgYW5kIHJldHVybiBpdHMgdmFsdWUKCQkJCXZhbHVlID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgPyB2YWx1ZSgpIDogKCB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1ZSApOwoJCQkJc1sgcy5sZW5ndGggXSA9IGVuY29kZVVSSUNvbXBvbmVudCgga2V5ICkgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQoIHZhbHVlICk7CgkJCX07CgoJCS8vIFNldCB0cmFkaXRpb25hbCB0byB0cnVlIGZvciBqUXVlcnkgPD0gMS4zLjIgYmVoYXZpb3IuCgkJaWYgKCB0cmFkaXRpb25hbCA9PT0gdW5kZWZpbmVkICkgewoJCQl0cmFkaXRpb25hbCA9IGpRdWVyeS5hamF4U2V0dGluZ3MgJiYgalF1ZXJ5LmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbDsKCQl9CgoJCS8vIElmIGFuIGFycmF5IHdhcyBwYXNzZWQgaW4sIGFzc3VtZSB0aGF0IGl0IGlzIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMuCgkJaWYgKCBqUXVlcnkuaXNBcnJheSggYSApIHx8ICggYS5qcXVlcnkgJiYgIWpRdWVyeS5pc1BsYWluT2JqZWN0KCBhICkgKSApIHsKCQkJLy8gU2VyaWFsaXplIHRoZSBmb3JtIGVsZW1lbnRzCgkJCWpRdWVyeS5lYWNoKCBhLCBmdW5jdGlvbigpIHsKCQkJCWFkZCggdGhpcy5uYW1lLCB0aGlzLnZhbHVlICk7CgkJCX0pOwoKCQl9IGVsc2UgewoJCQkvLyBJZiB0cmFkaXRpb25hbCwgZW5jb2RlIHRoZSAib2xkIiB3YXkgKHRoZSB3YXkgMS4zLjIgb3Igb2xkZXIKCQkJLy8gZGlkIGl0KSwgb3RoZXJ3aXNlIGVuY29kZSBwYXJhbXMgcmVjdXJzaXZlbHkuCgkJCWZvciAoIHByZWZpeCBpbiBhICkgewoJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCwgYVsgcHJlZml4IF0sIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQkJfQoJCX0KCgkJLy8gUmV0dXJuIHRoZSByZXN1bHRpbmcgc2VyaWFsaXphdGlvbgoJCXJldHVybiBzLmpvaW4oICImIiApLnJlcGxhY2UoIHIyMCwgIisiICk7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCXNlcmlhbGl6ZTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBqUXVlcnkucGFyYW0oIHRoaXMuc2VyaWFsaXplQXJyYXkoKSApOwoJCX0sCgkJc2VyaWFsaXplQXJyYXk6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7CgkJCQkvLyBDYW4gYWRkIHByb3BIb29rIGZvciAiZWxlbWVudHMiIHRvIGZpbHRlciBvciBhZGQgZm9ybSBlbGVtZW50cwoJCQkJdmFyIGVsZW1lbnRzID0galF1ZXJ5LnByb3AoIHRoaXMsICJlbGVtZW50cyIgKTsKCQkJCXJldHVybiBlbGVtZW50cyA/IGpRdWVyeS5tYWtlQXJyYXkoIGVsZW1lbnRzICkgOiB0aGlzOwoJCQl9KQoJCQkuZmlsdGVyKGZ1bmN0aW9uKCkgewoJCQkJdmFyIHR5cGUgPSB0aGlzLnR5cGU7CgkJCQkvLyBVc2UgLmlzKCI6ZGlzYWJsZWQiKSBzbyB0aGF0IGZpZWxkc2V0W2Rpc2FibGVkXSB3b3JrcwoJCQkJcmV0dXJuIHRoaXMubmFtZSAmJiAhalF1ZXJ5KCB0aGlzICkuaXMoICI6ZGlzYWJsZWQiICkgJiYKCQkJCQlyc3VibWl0dGFibGUudGVzdCggdGhpcy5ub2RlTmFtZSApICYmICFyc3VibWl0dGVyVHlwZXMudGVzdCggdHlwZSApICYmCgkJCQkJKCB0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QoIHR5cGUgKSApOwoJCQl9KQoJCQkubWFwKGZ1bmN0aW9uKCBpLCBlbGVtICkgewoJCQkJdmFyIHZhbCA9IGpRdWVyeSggdGhpcyApLnZhbCgpOwoKCQkJCXJldHVybiB2YWwgPT0gbnVsbCA/CgkJCQkJbnVsbCA6CgkJCQkJalF1ZXJ5LmlzQXJyYXkoIHZhbCApID8KCQkJCQkJalF1ZXJ5Lm1hcCggdmFsLCBmdW5jdGlvbiggdmFsICkgewoJCQkJCQkJcmV0dXJuIHsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCAiXHJcbiIgKSB9OwoJCQkJCQl9KSA6CgkJCQkJCXsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCAiXHJcbiIgKSB9OwoJCQl9KS5nZXQoKTsKCQl9Cgl9KTsKCgoJLy8gQ3JlYXRlIHRoZSByZXF1ZXN0IG9iamVjdAoJLy8gKFRoaXMgaXMgc3RpbGwgYXR0YWNoZWQgdG8gYWpheFNldHRpbmdzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5KQoJalF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIgPSB3aW5kb3cuQWN0aXZlWE9iamVjdCAhPT0gdW5kZWZpbmVkID8KCQkvLyBTdXBwb3J0OiBJRTYrCgkJZnVuY3Rpb24oKSB7CgoJCQkvLyBYSFIgY2Fubm90IGFjY2VzcyBsb2NhbCBmaWxlcywgYWx3YXlzIHVzZSBBY3RpdmVYIGZvciB0aGF0IGNhc2UKCQkJcmV0dXJuICF0aGlzLmlzTG9jYWwgJiYKCgkJCQkvLyBTdXBwb3J0OiBJRTctOAoJCQkJLy8gb2xkSUUgWEhSIGRvZXMgbm90IHN1cHBvcnQgbm9uLVJGQzI2MTYgbWV0aG9kcyAoIzEzMjQwKQoJCQkJLy8gU2VlIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9tczUzNjY0OCh2PXZzLjg1KS5hc3B4CgkJCQkvLyBhbmQgaHR0cDovL3d3dy53My5vcmcvUHJvdG9jb2xzL3JmYzI2MTYvcmZjMjYxNi1zZWM5Lmh0bWwjc2VjOQoJCQkJLy8gQWx0aG91Z2ggdGhpcyBjaGVjayBmb3Igc2l4IG1ldGhvZHMgaW5zdGVhZCBvZiBlaWdodAoJCQkJLy8gc2luY2UgSUUgYWxzbyBkb2VzIG5vdCBzdXBwb3J0ICJ0cmFjZSIgYW5kICJjb25uZWN0IgoJCQkJL14oZ2V0fHBvc3R8aGVhZHxwdXR8ZGVsZXRlfG9wdGlvbnMpJC9pLnRlc3QoIHRoaXMudHlwZSApICYmCgoJCQkJY3JlYXRlU3RhbmRhcmRYSFIoKSB8fCBjcmVhdGVBY3RpdmVYSFIoKTsKCQl9IDoKCQkvLyBGb3IgYWxsIG90aGVyIGJyb3dzZXJzLCB1c2UgdGhlIHN0YW5kYXJkIFhNTEh0dHBSZXF1ZXN0IG9iamVjdAoJCWNyZWF0ZVN0YW5kYXJkWEhSOwoKCXZhciB4aHJJZCA9IDAsCgkJeGhyQ2FsbGJhY2tzID0ge30sCgkJeGhyU3VwcG9ydGVkID0galF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIoKTsKCgkvLyBTdXBwb3J0OiBJRTwxMAoJLy8gT3BlbiByZXF1ZXN0cyBtdXN0IGJlIG1hbnVhbGx5IGFib3J0ZWQgb24gdW5sb2FkICgjNTI4MCkKCS8vIFNlZSBodHRwczovL3N1cHBvcnQubWljcm9zb2Z0LmNvbS9rYi8yODU2NzQ2IGZvciBtb3JlIGluZm8KCWlmICggd2luZG93LmF0dGFjaEV2ZW50ICkgewoJCXdpbmRvdy5hdHRhY2hFdmVudCggIm9udW5sb2FkIiwgZnVuY3Rpb24oKSB7CgkJCWZvciAoIHZhciBrZXkgaW4geGhyQ2FsbGJhY2tzICkgewoJCQkJeGhyQ2FsbGJhY2tzWyBrZXkgXSggdW5kZWZpbmVkLCB0cnVlICk7CgkJCX0KCQl9KTsKCX0KCgkvLyBEZXRlcm1pbmUgc3VwcG9ydCBwcm9wZXJ0aWVzCglzdXBwb3J0LmNvcnMgPSAhIXhoclN1cHBvcnRlZCAmJiAoICJ3aXRoQ3JlZGVudGlhbHMiIGluIHhoclN1cHBvcnRlZCApOwoJeGhyU3VwcG9ydGVkID0gc3VwcG9ydC5hamF4ID0gISF4aHJTdXBwb3J0ZWQ7CgoJLy8gQ3JlYXRlIHRyYW5zcG9ydCBpZiB0aGUgYnJvd3NlciBjYW4gcHJvdmlkZSBhbiB4aHIKCWlmICggeGhyU3VwcG9ydGVkICkgewoKCQlqUXVlcnkuYWpheFRyYW5zcG9ydChmdW5jdGlvbiggb3B0aW9ucyApIHsKCQkJLy8gQ3Jvc3MgZG9tYWluIG9ubHkgYWxsb3dlZCBpZiBzdXBwb3J0ZWQgdGhyb3VnaCBYTUxIdHRwUmVxdWVzdAoJCQlpZiAoICFvcHRpb25zLmNyb3NzRG9tYWluIHx8IHN1cHBvcnQuY29ycyApIHsKCgkJCQl2YXIgY2FsbGJhY2s7CgoJCQkJcmV0dXJuIHsKCQkJCQlzZW5kOiBmdW5jdGlvbiggaGVhZGVycywgY29tcGxldGUgKSB7CgkJCQkJCXZhciBpLAoJCQkJCQkJeGhyID0gb3B0aW9ucy54aHIoKSwKCQkJCQkJCWlkID0gKyt4aHJJZDsKCgkJCQkJCS8vIE9wZW4gdGhlIHNvY2tldAoJCQkJCQl4aHIub3Blbiggb3B0aW9ucy50eXBlLCBvcHRpb25zLnVybCwgb3B0aW9ucy5hc3luYywgb3B0aW9ucy51c2VybmFtZSwgb3B0aW9ucy5wYXNzd29yZCApOwoKCQkJCQkJLy8gQXBwbHkgY3VzdG9tIGZpZWxkcyBpZiBwcm92aWRlZAoJCQkJCQlpZiAoIG9wdGlvbnMueGhyRmllbGRzICkgewoJCQkJCQkJZm9yICggaSBpbiBvcHRpb25zLnhockZpZWxkcyApIHsKCQkJCQkJCQl4aHJbIGkgXSA9IG9wdGlvbnMueGhyRmllbGRzWyBpIF07CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIE92ZXJyaWRlIG1pbWUgdHlwZSBpZiBuZWVkZWQKCQkJCQkJaWYgKCBvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlICkgewoJCQkJCQkJeGhyLm92ZXJyaWRlTWltZVR5cGUoIG9wdGlvbnMubWltZVR5cGUgKTsKCQkJCQkJfQoKCQkJCQkJLy8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXIKCQkJCQkJLy8gRm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cywgc2VlaW5nIGFzIGNvbmRpdGlvbnMgZm9yIGEgcHJlZmxpZ2h0IGFyZQoJCQkJCQkvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLgoJCQkJCQkvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cCkKCQkJCQkJLy8gRm9yIHNhbWUtZG9tYWluIHJlcXVlc3RzLCB3b24ndCBjaGFuZ2UgaGVhZGVyIGlmIGFscmVhZHkgcHJvdmlkZWQuCgkJCQkJCWlmICggIW9wdGlvbnMuY3Jvc3NEb21haW4gJiYgIWhlYWRlcnNbIlgtUmVxdWVzdGVkLVdpdGgiXSApIHsKCQkJCQkJCWhlYWRlcnNbIlgtUmVxdWVzdGVkLVdpdGgiXSA9ICJYTUxIdHRwUmVxdWVzdCI7CgkJCQkJCX0KCgkJCQkJCS8vIFNldCBoZWFkZXJzCgkJCQkJCWZvciAoIGkgaW4gaGVhZGVycyApIHsKCQkJCQkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJCQkJCS8vIElFJ3MgQWN0aXZlWE9iamVjdCB0aHJvd3MgYSAnVHlwZSBNaXNtYXRjaCcgZXhjZXB0aW9uIHdoZW4gc2V0dGluZwoJCQkJCQkJLy8gcmVxdWVzdCBoZWFkZXIgdG8gYSBudWxsLXZhbHVlLgoJCQkJCQkJLy8KCQkJCQkJCS8vIFRvIGtlZXAgY29uc2lzdGVudCB3aXRoIG90aGVyIFhIUiBpbXBsZW1lbnRhdGlvbnMsIGNhc3QgdGhlIHZhbHVlCgkJCQkJCQkvLyB0byBzdHJpbmcgYW5kIGlnbm9yZSBgdW5kZWZpbmVkYC4KCQkJCQkJCWlmICggaGVhZGVyc1sgaSBdICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIGksIGhlYWRlcnNbIGkgXSArICIiICk7CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIERvIHNlbmQgdGhlIHJlcXVlc3QKCQkJCQkJLy8gVGhpcyBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uIHdoaWNoIGlzIGFjdHVhbGx5CgkJCQkJCS8vIGhhbmRsZWQgaW4galF1ZXJ5LmFqYXggKHNvIG5vIHRyeS9jYXRjaCBoZXJlKQoJCQkJCQl4aHIuc2VuZCggKCBvcHRpb25zLmhhc0NvbnRlbnQgJiYgb3B0aW9ucy5kYXRhICkgfHwgbnVsbCApOwoKCQkJCQkJLy8gTGlzdGVuZXIKCQkJCQkJY2FsbGJhY2sgPSBmdW5jdGlvbiggXywgaXNBYm9ydCApIHsKCQkJCQkJCXZhciBzdGF0dXMsIHN0YXR1c1RleHQsIHJlc3BvbnNlczsKCgkJCQkJCQkvLyBXYXMgbmV2ZXIgY2FsbGVkIGFuZCBpcyBhYm9ydGVkIG9yIGNvbXBsZXRlCgkJCQkJCQlpZiAoIGNhbGxiYWNrICYmICggaXNBYm9ydCB8fCB4aHIucmVhZHlTdGF0ZSA9PT0gNCApICkgewoJCQkJCQkJCS8vIENsZWFuIHVwCgkJCQkJCQkJZGVsZXRlIHhockNhbGxiYWNrc1sgaWQgXTsKCQkJCQkJCQljYWxsYmFjayA9IHVuZGVmaW5lZDsKCQkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0galF1ZXJ5Lm5vb3A7CgoJCQkJCQkJCS8vIEFib3J0IG1hbnVhbGx5IGlmIG5lZWRlZAoJCQkJCQkJCWlmICggaXNBYm9ydCApIHsKCQkJCQkJCQkJaWYgKCB4aHIucmVhZHlTdGF0ZSAhPT0gNCApIHsKCQkJCQkJCQkJCXhoci5hYm9ydCgpOwoJCQkJCQkJCQl9CgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJcmVzcG9uc2VzID0ge307CgkJCQkJCQkJCXN0YXR1cyA9IHhoci5zdGF0dXM7CgoJCQkJCQkJCQkvLyBTdXBwb3J0OiBJRTwxMAoJCQkJCQkJCQkvLyBBY2Nlc3NpbmcgYmluYXJ5LWRhdGEgcmVzcG9uc2VUZXh0IHRocm93cyBhbiBleGNlcHRpb24KCQkJCQkJCQkJLy8gKCMxMTQyNikKCQkJCQkJCQkJaWYgKCB0eXBlb2YgeGhyLnJlc3BvbnNlVGV4dCA9PT0gInN0cmluZyIgKSB7CgkJCQkJCQkJCQlyZXNwb25zZXMudGV4dCA9IHhoci5yZXNwb25zZVRleHQ7CgkJCQkJCQkJCX0KCgkJCQkJCQkJCS8vIEZpcmVmb3ggdGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZwoJCQkJCQkJCQkvLyBzdGF0dXNUZXh0IGZvciBmYXVsdHkgY3Jvc3MtZG9tYWluIHJlcXVlc3RzCgkJCQkJCQkJCXRyeSB7CgkJCQkJCQkJCQlzdGF0dXNUZXh0ID0geGhyLnN0YXR1c1RleHQ7CgkJCQkJCQkJCX0gY2F0Y2goIGUgKSB7CgkJCQkJCQkJCQkvLyBXZSBub3JtYWxpemUgd2l0aCBXZWJraXQgZ2l2aW5nIGFuIGVtcHR5IHN0YXR1c1RleHQKCQkJCQkJCQkJCXN0YXR1c1RleHQgPSAiIjsKCQkJCQkJCQkJfQoKCQkJCQkJCQkJLy8gRmlsdGVyIHN0YXR1cyBmb3Igbm9uIHN0YW5kYXJkIGJlaGF2aW9ycwoKCQkJCQkJCQkJLy8gSWYgdGhlIHJlcXVlc3QgaXMgbG9jYWwgYW5kIHdlIGhhdmUgZGF0YTogYXNzdW1lIGEgc3VjY2VzcwoJCQkJCQkJCQkvLyAoc3VjY2VzcyB3aXRoIG5vIGRhdGEgd29uJ3QgZ2V0IG5vdGlmaWVkLCB0aGF0J3MgdGhlIGJlc3Qgd2UKCQkJCQkJCQkJLy8gY2FuIGRvIGdpdmVuIGN1cnJlbnQgaW1wbGVtZW50YXRpb25zKQoJCQkJCQkJCQlpZiAoICFzdGF0dXMgJiYgb3B0aW9ucy5pc0xvY2FsICYmICFvcHRpb25zLmNyb3NzRG9tYWluICkgewoJCQkJCQkJCQkJc3RhdHVzID0gcmVzcG9uc2VzLnRleHQgPyAyMDAgOiA0MDQ7CgkJCQkJCQkJCS8vIElFIC0gIzE0NTA6IHNvbWV0aW1lcyByZXR1cm5zIDEyMjMgd2hlbiBpdCBzaG91bGQgYmUgMjA0CgkJCQkJCQkJCX0gZWxzZSBpZiAoIHN0YXR1cyA9PT0gMTIyMyApIHsKCQkJCQkJCQkJCXN0YXR1cyA9IDIwNDsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQkvLyBDYWxsIGNvbXBsZXRlIGlmIG5lZWRlZAoJCQkJCQkJaWYgKCByZXNwb25zZXMgKSB7CgkJCQkJCQkJY29tcGxldGUoIHN0YXR1cywgc3RhdHVzVGV4dCwgcmVzcG9uc2VzLCB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgKTsKCQkJCQkJCX0KCQkJCQkJfTsKCgkJCQkJCWlmICggIW9wdGlvbnMuYXN5bmMgKSB7CgkJCQkJCQkvLyBpZiB3ZSdyZSBpbiBzeW5jIG1vZGUgd2UgZmlyZSB0aGUgY2FsbGJhY2sKCQkJCQkJCWNhbGxiYWNrKCk7CgkJCQkJCX0gZWxzZSBpZiAoIHhoci5yZWFkeVN0YXRlID09PSA0ICkgewoJCQkJCQkJLy8gKElFNiAmIElFNykgaWYgaXQncyBpbiBjYWNoZSBhbmQgaGFzIGJlZW4KCQkJCQkJCS8vIHJldHJpZXZlZCBkaXJlY3RseSB3ZSBuZWVkIHRvIGZpcmUgdGhlIGNhbGxiYWNrCgkJCQkJCQlzZXRUaW1lb3V0KCBjYWxsYmFjayApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJLy8gQWRkIHRvIHRoZSBsaXN0IG9mIGFjdGl2ZSB4aHIgY2FsbGJhY2tzCgkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0geGhyQ2FsbGJhY2tzWyBpZCBdID0gY2FsbGJhY2s7CgkJCQkJCX0KCQkJCQl9LAoKCQkJCQlhYm9ydDogZnVuY3Rpb24oKSB7CgkJCQkJCWlmICggY2FsbGJhY2sgKSB7CgkJCQkJCQljYWxsYmFjayggdW5kZWZpbmVkLCB0cnVlICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9OwoJCQl9CgkJfSk7Cgl9CgoJLy8gRnVuY3Rpb25zIHRvIGNyZWF0ZSB4aHJzCglmdW5jdGlvbiBjcmVhdGVTdGFuZGFyZFhIUigpIHsKCQl0cnkgewoJCQlyZXR1cm4gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpOwoJCX0gY2F0Y2goIGUgKSB7fQoJfQoKCWZ1bmN0aW9uIGNyZWF0ZUFjdGl2ZVhIUigpIHsKCQl0cnkgewoJCQlyZXR1cm4gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KCAiTWljcm9zb2Z0LlhNTEhUVFAiICk7CgkJfSBjYXRjaCggZSApIHt9Cgl9CgoKCgoJLy8gSW5zdGFsbCBzY3JpcHQgZGF0YVR5cGUKCWpRdWVyeS5hamF4U2V0dXAoewoJCWFjY2VwdHM6IHsKCQkJc2NyaXB0OiAidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQiCgkJfSwKCQljb250ZW50czogewoJCQlzY3JpcHQ6IC8oPzpqYXZhfGVjbWEpc2NyaXB0LwoJCX0sCgkJY29udmVydGVyczogewoJCQkidGV4dCBzY3JpcHQiOiBmdW5jdGlvbiggdGV4dCApIHsKCQkJCWpRdWVyeS5nbG9iYWxFdmFsKCB0ZXh0ICk7CgkJCQlyZXR1cm4gdGV4dDsKCQkJfQoJCX0KCX0pOwoKCS8vIEhhbmRsZSBjYWNoZSdzIHNwZWNpYWwgY2FzZSBhbmQgZ2xvYmFsCglqUXVlcnkuYWpheFByZWZpbHRlciggInNjcmlwdCIsIGZ1bmN0aW9uKCBzICkgewoJCWlmICggcy5jYWNoZSA9PT0gdW5kZWZpbmVkICkgewoJCQlzLmNhY2hlID0gZmFsc2U7CgkJfQoJCWlmICggcy5jcm9zc0RvbWFpbiApIHsKCQkJcy50eXBlID0gIkdFVCI7CgkJCXMuZ2xvYmFsID0gZmFsc2U7CgkJfQoJfSk7CgoJLy8gQmluZCBzY3JpcHQgdGFnIGhhY2sgdHJhbnNwb3J0CglqUXVlcnkuYWpheFRyYW5zcG9ydCggInNjcmlwdCIsIGZ1bmN0aW9uKHMpIHsKCgkJLy8gVGhpcyB0cmFuc3BvcnQgb25seSBkZWFscyB3aXRoIGNyb3NzIGRvbWFpbiByZXF1ZXN0cwoJCWlmICggcy5jcm9zc0RvbWFpbiApIHsKCgkJCXZhciBzY3JpcHQsCgkJCQloZWFkID0gZG9jdW1lbnQuaGVhZCB8fCBqUXVlcnkoImhlYWQiKVswXSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJCQlyZXR1cm4gewoKCQkJCXNlbmQ6IGZ1bmN0aW9uKCBfLCBjYWxsYmFjayApIHsKCgkJCQkJc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CgoJCQkJCXNjcmlwdC5hc3luYyA9IHRydWU7CgoJCQkJCWlmICggcy5zY3JpcHRDaGFyc2V0ICkgewoJCQkJCQlzY3JpcHQuY2hhcnNldCA9IHMuc2NyaXB0Q2hhcnNldDsKCQkJCQl9CgoJCQkJCXNjcmlwdC5zcmMgPSBzLnVybDsKCgkJCQkJLy8gQXR0YWNoIGhhbmRsZXJzIGZvciBhbGwgYnJvd3NlcnMKCQkJCQlzY3JpcHQub25sb2FkID0gc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCBfLCBpc0Fib3J0ICkgewoKCQkJCQkJaWYgKCBpc0Fib3J0IHx8ICFzY3JpcHQucmVhZHlTdGF0ZSB8fCAvbG9hZGVkfGNvbXBsZXRlLy50ZXN0KCBzY3JpcHQucmVhZHlTdGF0ZSApICkgewoKCQkJCQkJCS8vIEhhbmRsZSBtZW1vcnkgbGVhayBpbiBJRQoJCQkJCQkJc2NyaXB0Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwoKCQkJCQkJCS8vIFJlbW92ZSB0aGUgc2NyaXB0CgkJCQkJCQlpZiAoIHNjcmlwdC5wYXJlbnROb2RlICkgewoJCQkJCQkJCXNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBzY3JpcHQgKTsKCQkJCQkJCX0KCgkJCQkJCQkvLyBEZXJlZmVyZW5jZSB0aGUgc2NyaXB0CgkJCQkJCQlzY3JpcHQgPSBudWxsOwoKCQkJCQkJCS8vIENhbGxiYWNrIGlmIG5vdCBhYm9ydAoJCQkJCQkJaWYgKCAhaXNBYm9ydCApIHsKCQkJCQkJCQljYWxsYmFjayggMjAwLCAic3VjY2VzcyIgKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX07CgoJCQkJCS8vIENpcmN1bXZlbnQgSUU2IGJ1Z3Mgd2l0aCBiYXNlIGVsZW1lbnRzICgjMjcwOSBhbmQgIzQzNzgpIGJ5IHByZXBlbmRpbmcKCQkJCQkvLyBVc2UgbmF0aXZlIERPTSBtYW5pcHVsYXRpb24gdG8gYXZvaWQgb3VyIGRvbU1hbmlwIEFKQVggdHJpY2tlcnkKCQkJCQloZWFkLmluc2VydEJlZm9yZSggc2NyaXB0LCBoZWFkLmZpcnN0Q2hpbGQgKTsKCQkJCX0sCgoJCQkJYWJvcnQ6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggc2NyaXB0ICkgewoJCQkJCQlzY3JpcHQub25sb2FkKCB1bmRlZmluZWQsIHRydWUgKTsKCQkJCQl9CgkJCQl9CgkJCX07CgkJfQoJfSk7CgoKCgoJdmFyIG9sZENhbGxiYWNrcyA9IFtdLAoJCXJqc29ucCA9IC8oPSlcPyg/PSZ8JCl8XD9cPy87CgoJLy8gRGVmYXVsdCBqc29ucCBzZXR0aW5ncwoJalF1ZXJ5LmFqYXhTZXR1cCh7CgkJanNvbnA6ICJjYWxsYmFjayIsCgkJanNvbnBDYWxsYmFjazogZnVuY3Rpb24oKSB7CgkJCXZhciBjYWxsYmFjayA9IG9sZENhbGxiYWNrcy5wb3AoKSB8fCAoIGpRdWVyeS5leHBhbmRvICsgIl8iICsgKCBub25jZSsrICkgKTsKCQkJdGhpc1sgY2FsbGJhY2sgXSA9IHRydWU7CgkJCXJldHVybiBjYWxsYmFjazsKCQl9Cgl9KTsKCgkvLyBEZXRlY3QsIG5vcm1hbGl6ZSBvcHRpb25zIGFuZCBpbnN0YWxsIGNhbGxiYWNrcyBmb3IganNvbnAgcmVxdWVzdHMKCWpRdWVyeS5hamF4UHJlZmlsdGVyKCAianNvbiBqc29ucCIsIGZ1bmN0aW9uKCBzLCBvcmlnaW5hbFNldHRpbmdzLCBqcVhIUiApIHsKCgkJdmFyIGNhbGxiYWNrTmFtZSwgb3ZlcndyaXR0ZW4sIHJlc3BvbnNlQ29udGFpbmVyLAoJCQlqc29uUHJvcCA9IHMuanNvbnAgIT09IGZhbHNlICYmICggcmpzb25wLnRlc3QoIHMudXJsICkgPwoJCQkJInVybCIgOgoJCQkJdHlwZW9mIHMuZGF0YSA9PT0gInN0cmluZyIgJiYgISggcy5jb250ZW50VHlwZSB8fCAiIiApLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpICYmIHJqc29ucC50ZXN0KCBzLmRhdGEgKSAmJiAiZGF0YSIKCQkJKTsKCgkJLy8gSGFuZGxlIGlmZiB0aGUgZXhwZWN0ZWQgZGF0YSB0eXBlIGlzICJqc29ucCIgb3Igd2UgaGF2ZSBhIHBhcmFtZXRlciB0byBzZXQKCQlpZiAoIGpzb25Qcm9wIHx8IHMuZGF0YVR5cGVzWyAwIF0gPT09ICJqc29ucCIgKSB7CgoJCQkvLyBHZXQgY2FsbGJhY2sgbmFtZSwgcmVtZW1iZXJpbmcgcHJlZXhpc3RpbmcgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIGl0CgkJCWNhbGxiYWNrTmFtZSA9IHMuanNvbnBDYWxsYmFjayA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBzLmpzb25wQ2FsbGJhY2sgKSA/CgkJCQlzLmpzb25wQ2FsbGJhY2soKSA6CgkJCQlzLmpzb25wQ2FsbGJhY2s7CgoJCQkvLyBJbnNlcnQgY2FsbGJhY2sgaW50byB1cmwgb3IgZm9ybSBkYXRhCgkJCWlmICgganNvblByb3AgKSB7CgkJCQlzWyBqc29uUHJvcCBdID0gc1sganNvblByb3AgXS5yZXBsYWNlKCByanNvbnAsICIkMSIgKyBjYWxsYmFja05hbWUgKTsKCQkJfSBlbHNlIGlmICggcy5qc29ucCAhPT0gZmFsc2UgKSB7CgkJCQlzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBzLnVybCApID8gIiYiIDogIj8iICkgKyBzLmpzb25wICsgIj0iICsgY2FsbGJhY2tOYW1lOwoJCQl9CgoJCQkvLyBVc2UgZGF0YSBjb252ZXJ0ZXIgdG8gcmV0cmlldmUganNvbiBhZnRlciBzY3JpcHQgZXhlY3V0aW9uCgkJCXMuY29udmVydGVyc1sic2NyaXB0IGpzb24iXSA9IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCAhcmVzcG9uc2VDb250YWluZXIgKSB7CgkJCQkJalF1ZXJ5LmVycm9yKCBjYWxsYmFja05hbWUgKyAiIHdhcyBub3QgY2FsbGVkIiApOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07CgkJCX07CgoJCQkvLyBmb3JjZSBqc29uIGRhdGFUeXBlCgkJCXMuZGF0YVR5cGVzWyAwIF0gPSAianNvbiI7CgoJCQkvLyBJbnN0YWxsIGNhbGxiYWNrCgkJCW92ZXJ3cml0dGVuID0gd2luZG93WyBjYWxsYmFja05hbWUgXTsKCQkJd2luZG93WyBjYWxsYmFja05hbWUgXSA9IGZ1bmN0aW9uKCkgewoJCQkJcmVzcG9uc2VDb250YWluZXIgPSBhcmd1bWVudHM7CgkJCX07CgoJCQkvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycykKCQkJanFYSFIuYWx3YXlzKGZ1bmN0aW9uKCkgewoJCQkJLy8gUmVzdG9yZSBwcmVleGlzdGluZyB2YWx1ZQoJCQkJd2luZG93WyBjYWxsYmFja05hbWUgXSA9IG92ZXJ3cml0dGVuOwoKCQkJCS8vIFNhdmUgYmFjayBhcyBmcmVlCgkJCQlpZiAoIHNbIGNhbGxiYWNrTmFtZSBdICkgewoJCQkJCS8vIG1ha2Ugc3VyZSB0aGF0IHJlLXVzaW5nIHRoZSBvcHRpb25zIGRvZXNuJ3Qgc2NyZXcgdGhpbmdzIGFyb3VuZAoJCQkJCXMuanNvbnBDYWxsYmFjayA9IG9yaWdpbmFsU2V0dGluZ3MuanNvbnBDYWxsYmFjazsKCgkJCQkJLy8gc2F2ZSB0aGUgY2FsbGJhY2sgbmFtZSBmb3IgZnV0dXJlIHVzZQoJCQkJCW9sZENhbGxiYWNrcy5wdXNoKCBjYWxsYmFja05hbWUgKTsKCQkJCX0KCgkJCQkvLyBDYWxsIGlmIGl0IHdhcyBhIGZ1bmN0aW9uIGFuZCB3ZSBoYXZlIGEgcmVzcG9uc2UKCQkJCWlmICggcmVzcG9uc2VDb250YWluZXIgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIG92ZXJ3cml0dGVuICkgKSB7CgkJCQkJb3ZlcndyaXR0ZW4oIHJlc3BvbnNlQ29udGFpbmVyWyAwIF0gKTsKCQkJCX0KCgkJCQlyZXNwb25zZUNvbnRhaW5lciA9IG92ZXJ3cml0dGVuID0gdW5kZWZpbmVkOwoJCQl9KTsKCgkJCS8vIERlbGVnYXRlIHRvIHNjcmlwdAoJCQlyZXR1cm4gInNjcmlwdCI7CgkJfQoJfSk7CgoKCgoJLy8gZGF0YTogc3RyaW5nIG9mIGh0bWwKCS8vIGNvbnRleHQgKG9wdGlvbmFsKTogSWYgc3BlY2lmaWVkLCB0aGUgZnJhZ21lbnQgd2lsbCBiZSBjcmVhdGVkIGluIHRoaXMgY29udGV4dCwgZGVmYXVsdHMgdG8gZG9jdW1lbnQKCS8vIGtlZXBTY3JpcHRzIChvcHRpb25hbCk6IElmIHRydWUsIHdpbGwgaW5jbHVkZSBzY3JpcHRzIHBhc3NlZCBpbiB0aGUgaHRtbCBzdHJpbmcKCWpRdWVyeS5wYXJzZUhUTUwgPSBmdW5jdGlvbiggZGF0YSwgY29udGV4dCwga2VlcFNjcmlwdHMgKSB7CgkJaWYgKCAhZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gInN0cmluZyIgKSB7CgkJCXJldHVybiBudWxsOwoJCX0KCQlpZiAoIHR5cGVvZiBjb250ZXh0ID09PSAiYm9vbGVhbiIgKSB7CgkJCWtlZXBTY3JpcHRzID0gY29udGV4dDsKCQkJY29udGV4dCA9IGZhbHNlOwoJCX0KCQljb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDsKCgkJdmFyIHBhcnNlZCA9IHJzaW5nbGVUYWcuZXhlYyggZGF0YSApLAoJCQlzY3JpcHRzID0gIWtlZXBTY3JpcHRzICYmIFtdOwoKCQkvLyBTaW5nbGUgdGFnCgkJaWYgKCBwYXJzZWQgKSB7CgkJCXJldHVybiBbIGNvbnRleHQuY3JlYXRlRWxlbWVudCggcGFyc2VkWzFdICkgXTsKCQl9CgoJCXBhcnNlZCA9IGpRdWVyeS5idWlsZEZyYWdtZW50KCBbIGRhdGEgXSwgY29udGV4dCwgc2NyaXB0cyApOwoKCQlpZiAoIHNjcmlwdHMgJiYgc2NyaXB0cy5sZW5ndGggKSB7Cg==", "base64"));
  res.write(new Buffer("CQkJalF1ZXJ5KCBzY3JpcHRzICkucmVtb3ZlKCk7CgkJfQoKCQlyZXR1cm4galF1ZXJ5Lm1lcmdlKCBbXSwgcGFyc2VkLmNoaWxkTm9kZXMgKTsKCX07CgoKCS8vIEtlZXAgYSBjb3B5IG9mIHRoZSBvbGQgbG9hZCBtZXRob2QKCXZhciBfbG9hZCA9IGpRdWVyeS5mbi5sb2FkOwoKCS8qKgoJICogTG9hZCBhIHVybCBpbnRvIGEgcGFnZQoJICovCglqUXVlcnkuZm4ubG9hZCA9IGZ1bmN0aW9uKCB1cmwsIHBhcmFtcywgY2FsbGJhY2sgKSB7CgkJaWYgKCB0eXBlb2YgdXJsICE9PSAic3RyaW5nIiAmJiBfbG9hZCApIHsKCQkJcmV0dXJuIF9sb2FkLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQl9CgoJCXZhciBzZWxlY3RvciwgcmVzcG9uc2UsIHR5cGUsCgkJCXNlbGYgPSB0aGlzLAoJCQlvZmYgPSB1cmwuaW5kZXhPZigiICIpOwoKCQlpZiAoIG9mZiA+PSAwICkgewoJCQlzZWxlY3RvciA9IGpRdWVyeS50cmltKCB1cmwuc2xpY2UoIG9mZiwgdXJsLmxlbmd0aCApICk7CgkJCXVybCA9IHVybC5zbGljZSggMCwgb2ZmICk7CgkJfQoKCQkvLyBJZiBpdCdzIGEgZnVuY3Rpb24KCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwYXJhbXMgKSApIHsKCgkJCS8vIFdlIGFzc3VtZSB0aGF0IGl0J3MgdGhlIGNhbGxiYWNrCgkJCWNhbGxiYWNrID0gcGFyYW1zOwoJCQlwYXJhbXMgPSB1bmRlZmluZWQ7CgoJCS8vIE90aGVyd2lzZSwgYnVpbGQgYSBwYXJhbSBzdHJpbmcKCQl9IGVsc2UgaWYgKCBwYXJhbXMgJiYgdHlwZW9mIHBhcmFtcyA9PT0gIm9iamVjdCIgKSB7CgkJCXR5cGUgPSAiUE9TVCI7CgkJfQoKCQkvLyBJZiB3ZSBoYXZlIGVsZW1lbnRzIHRvIG1vZGlmeSwgbWFrZSB0aGUgcmVxdWVzdAoJCWlmICggc2VsZi5sZW5ndGggPiAwICkgewoJCQlqUXVlcnkuYWpheCh7CgkJCQl1cmw6IHVybCwKCgkJCQkvLyBpZiAidHlwZSIgdmFyaWFibGUgaXMgdW5kZWZpbmVkLCB0aGVuICJHRVQiIG1ldGhvZCB3aWxsIGJlIHVzZWQKCQkJCXR5cGU6IHR5cGUsCgkJCQlkYXRhVHlwZTogImh0bWwiLAoJCQkJZGF0YTogcGFyYW1zCgkJCX0pLmRvbmUoZnVuY3Rpb24oIHJlc3BvbnNlVGV4dCApIHsKCgkJCQkvLyBTYXZlIHJlc3BvbnNlIGZvciB1c2UgaW4gY29tcGxldGUgY2FsbGJhY2sKCQkJCXJlc3BvbnNlID0gYXJndW1lbnRzOwoKCQkJCXNlbGYuaHRtbCggc2VsZWN0b3IgPwoKCQkJCQkvLyBJZiBhIHNlbGVjdG9yIHdhcyBzcGVjaWZpZWQsIGxvY2F0ZSB0aGUgcmlnaHQgZWxlbWVudHMgaW4gYSBkdW1teSBkaXYKCQkJCQkvLyBFeGNsdWRlIHNjcmlwdHMgdG8gYXZvaWQgSUUgJ1Blcm1pc3Npb24gRGVuaWVkJyBlcnJvcnMKCQkJCQlqUXVlcnkoIjxkaXY+IikuYXBwZW5kKCBqUXVlcnkucGFyc2VIVE1MKCByZXNwb25zZVRleHQgKSApLmZpbmQoIHNlbGVjdG9yICkgOgoKCQkJCQkvLyBPdGhlcndpc2UgdXNlIHRoZSBmdWxsIHJlc3VsdAoJCQkJCXJlc3BvbnNlVGV4dCApOwoKCQkJfSkuY29tcGxldGUoIGNhbGxiYWNrICYmIGZ1bmN0aW9uKCBqcVhIUiwgc3RhdHVzICkgewoJCQkJc2VsZi5lYWNoKCBjYWxsYmFjaywgcmVzcG9uc2UgfHwgWyBqcVhIUi5yZXNwb25zZVRleHQsIHN0YXR1cywganFYSFIgXSApOwoJCQl9KTsKCQl9CgoJCXJldHVybiB0aGlzOwoJfTsKCgoKCgkvLyBBdHRhY2ggYSBidW5jaCBvZiBmdW5jdGlvbnMgZm9yIGhhbmRsaW5nIGNvbW1vbiBBSkFYIGV2ZW50cwoJalF1ZXJ5LmVhY2goIFsgImFqYXhTdGFydCIsICJhamF4U3RvcCIsICJhamF4Q29tcGxldGUiLCAiYWpheEVycm9yIiwgImFqYXhTdWNjZXNzIiwgImFqYXhTZW5kIiBdLCBmdW5jdGlvbiggaSwgdHlwZSApIHsKCQlqUXVlcnkuZm5bIHR5cGUgXSA9IGZ1bmN0aW9uKCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGUsIGZuICk7CgkJfTsKCX0pOwoKCgoKCWpRdWVyeS5leHByLmZpbHRlcnMuYW5pbWF0ZWQgPSBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4galF1ZXJ5LmdyZXAoalF1ZXJ5LnRpbWVycywgZnVuY3Rpb24oIGZuICkgewoJCQlyZXR1cm4gZWxlbSA9PT0gZm4uZWxlbTsKCQl9KS5sZW5ndGg7Cgl9OwoKCgoKCgl2YXIgZG9jRWxlbSA9IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJLyoqCgkgKiBHZXRzIGEgd2luZG93IGZyb20gYW4gZWxlbWVudAoJICovCglmdW5jdGlvbiBnZXRXaW5kb3coIGVsZW0gKSB7CgkJcmV0dXJuIGpRdWVyeS5pc1dpbmRvdyggZWxlbSApID8KCQkJZWxlbSA6CgkJCWVsZW0ubm9kZVR5cGUgPT09IDkgPwoJCQkJZWxlbS5kZWZhdWx0VmlldyB8fCBlbGVtLnBhcmVudFdpbmRvdyA6CgkJCQlmYWxzZTsKCX0KCglqUXVlcnkub2Zmc2V0ID0gewoJCXNldE9mZnNldDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGkgKSB7CgkJCXZhciBjdXJQb3NpdGlvbiwgY3VyTGVmdCwgY3VyQ1NTVG9wLCBjdXJUb3AsIGN1ck9mZnNldCwgY3VyQ1NTTGVmdCwgY2FsY3VsYXRlUG9zaXRpb24sCgkJCQlwb3NpdGlvbiA9IGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSwKCQkJCWN1ckVsZW0gPSBqUXVlcnkoIGVsZW0gKSwKCQkJCXByb3BzID0ge307CgoJCQkvLyBzZXQgcG9zaXRpb24gZmlyc3QsIGluLWNhc2UgdG9wL2xlZnQgYXJlIHNldCBldmVuIG9uIHN0YXRpYyBlbGVtCgkJCWlmICggcG9zaXRpb24gPT09ICJzdGF0aWMiICkgewoJCQkJZWxlbS5zdHlsZS5wb3NpdGlvbiA9ICJyZWxhdGl2ZSI7CgkJCX0KCgkJCWN1ck9mZnNldCA9IGN1ckVsZW0ub2Zmc2V0KCk7CgkJCWN1ckNTU1RvcCA9IGpRdWVyeS5jc3MoIGVsZW0sICJ0b3AiICk7CgkJCWN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCAibGVmdCIgKTsKCQkJY2FsY3VsYXRlUG9zaXRpb24gPSAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09PSAiZml4ZWQiICkgJiYKCQkJCWpRdWVyeS5pbkFycmF5KCJhdXRvIiwgWyBjdXJDU1NUb3AsIGN1ckNTU0xlZnQgXSApID4gLTE7CgoJCQkvLyBuZWVkIHRvIGJlIGFibGUgdG8gY2FsY3VsYXRlIHBvc2l0aW9uIGlmIGVpdGhlciB0b3Agb3IgbGVmdCBpcyBhdXRvIGFuZCBwb3NpdGlvbiBpcyBlaXRoZXIgYWJzb2x1dGUgb3IgZml4ZWQKCQkJaWYgKCBjYWxjdWxhdGVQb3NpdGlvbiApIHsKCQkJCWN1clBvc2l0aW9uID0gY3VyRWxlbS5wb3NpdGlvbigpOwoJCQkJY3VyVG9wID0gY3VyUG9zaXRpb24udG9wOwoJCQkJY3VyTGVmdCA9IGN1clBvc2l0aW9uLmxlZnQ7CgkJCX0gZWxzZSB7CgkJCQljdXJUb3AgPSBwYXJzZUZsb2F0KCBjdXJDU1NUb3AgKSB8fCAwOwoJCQkJY3VyTGVmdCA9IHBhcnNlRmxvYXQoIGN1ckNTU0xlZnQgKSB8fCAwOwoJCQl9CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBvcHRpb25zICkgKSB7CgkJCQlvcHRpb25zID0gb3B0aW9ucy5jYWxsKCBlbGVtLCBpLCBjdXJPZmZzZXQgKTsKCQkJfQoKCQkJaWYgKCBvcHRpb25zLnRvcCAhPSBudWxsICkgewoJCQkJcHJvcHMudG9wID0gKCBvcHRpb25zLnRvcCAtIGN1ck9mZnNldC50b3AgKSArIGN1clRvcDsKCQkJfQoJCQlpZiAoIG9wdGlvbnMubGVmdCAhPSBudWxsICkgewoJCQkJcHJvcHMubGVmdCA9ICggb3B0aW9ucy5sZWZ0IC0gY3VyT2Zmc2V0LmxlZnQgKSArIGN1ckxlZnQ7CgkJCX0KCgkJCWlmICggInVzaW5nIiBpbiBvcHRpb25zICkgewoJCQkJb3B0aW9ucy51c2luZy5jYWxsKCBlbGVtLCBwcm9wcyApOwoJCQl9IGVsc2UgewoJCQkJY3VyRWxlbS5jc3MoIHByb3BzICk7CgkJCX0KCQl9Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCW9mZnNldDogZnVuY3Rpb24oIG9wdGlvbnMgKSB7CgkJCWlmICggYXJndW1lbnRzLmxlbmd0aCApIHsKCQkJCXJldHVybiBvcHRpb25zID09PSB1bmRlZmluZWQgPwoJCQkJCXRoaXMgOgoJCQkJCXRoaXMuZWFjaChmdW5jdGlvbiggaSApIHsKCQkJCQkJalF1ZXJ5Lm9mZnNldC5zZXRPZmZzZXQoIHRoaXMsIG9wdGlvbnMsIGkgKTsKCQkJCQl9KTsKCQkJfQoKCQkJdmFyIGRvY0VsZW0sIHdpbiwKCQkJCWJveCA9IHsgdG9wOiAwLCBsZWZ0OiAwIH0sCgkJCQllbGVtID0gdGhpc1sgMCBdLAoJCQkJZG9jID0gZWxlbSAmJiBlbGVtLm93bmVyRG9jdW1lbnQ7CgoJCQlpZiAoICFkb2MgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50OwoKCQkJLy8gTWFrZSBzdXJlIGl0J3Mgbm90IGEgZGlzY29ubmVjdGVkIERPTSBub2RlCgkJCWlmICggIWpRdWVyeS5jb250YWlucyggZG9jRWxlbSwgZWxlbSApICkgewoJCQkJcmV0dXJuIGJveDsKCQkJfQoKCQkJLy8gSWYgd2UgZG9uJ3QgaGF2ZSBnQkNSLCBqdXN0IHVzZSAwLDAgcmF0aGVyIHRoYW4gZXJyb3IKCQkJLy8gQmxhY2tCZXJyeSA1LCBpT1MgMyAob3JpZ2luYWwgaVBob25lKQoJCQlpZiAoIHR5cGVvZiBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCAhPT0gc3RydW5kZWZpbmVkICkgewoJCQkJYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCQkJfQoJCQl3aW4gPSBnZXRXaW5kb3coIGRvYyApOwoJCQlyZXR1cm4gewoJCQkJdG9wOiBib3gudG9wICArICggd2luLnBhZ2VZT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsVG9wICkgIC0gKCBkb2NFbGVtLmNsaWVudFRvcCAgfHwgMCApLAoJCQkJbGVmdDogYm94LmxlZnQgKyAoIHdpbi5wYWdlWE9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbExlZnQgKSAtICggZG9jRWxlbS5jbGllbnRMZWZ0IHx8IDAgKQoJCQl9OwoJCX0sCgoJCXBvc2l0aW9uOiBmdW5jdGlvbigpIHsKCQkJaWYgKCAhdGhpc1sgMCBdICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQl2YXIgb2Zmc2V0UGFyZW50LCBvZmZzZXQsCgkJCQlwYXJlbnRPZmZzZXQgPSB7IHRvcDogMCwgbGVmdDogMCB9LAoJCQkJZWxlbSA9IHRoaXNbIDAgXTsKCgkJCS8vIGZpeGVkIGVsZW1lbnRzIGFyZSBvZmZzZXQgZnJvbSB3aW5kb3cgKHBhcmVudE9mZnNldCA9IHt0b3A6MCwgbGVmdDogMH0sIGJlY2F1c2UgaXQgaXMgaXRzIG9ubHkgb2Zmc2V0IHBhcmVudAoJCQlpZiAoIGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSA9PT0gImZpeGVkIiApIHsKCQkJCS8vIHdlIGFzc3VtZSB0aGF0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBpcyBhdmFpbGFibGUgd2hlbiBjb21wdXRlZCBwb3NpdGlvbiBpcyBmaXhlZAoJCQkJb2Zmc2V0ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCQkJfSBlbHNlIHsKCQkJCS8vIEdldCAqcmVhbCogb2Zmc2V0UGFyZW50CgkJCQlvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCgpOwoKCQkJCS8vIEdldCBjb3JyZWN0IG9mZnNldHMKCQkJCW9mZnNldCA9IHRoaXMub2Zmc2V0KCk7CgkJCQlpZiAoICFqUXVlcnkubm9kZU5hbWUoIG9mZnNldFBhcmVudFsgMCBdLCAiaHRtbCIgKSApIHsKCQkJCQlwYXJlbnRPZmZzZXQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0KCk7CgkJCQl9CgoJCQkJLy8gQWRkIG9mZnNldFBhcmVudCBib3JkZXJzCgkJCQlwYXJlbnRPZmZzZXQudG9wICArPSBqUXVlcnkuY3NzKCBvZmZzZXRQYXJlbnRbIDAgXSwgImJvcmRlclRvcFdpZHRoIiwgdHJ1ZSApOwoJCQkJcGFyZW50T2Zmc2V0LmxlZnQgKz0galF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50WyAwIF0sICJib3JkZXJMZWZ0V2lkdGgiLCB0cnVlICk7CgkJCX0KCgkJCS8vIFN1YnRyYWN0IHBhcmVudCBvZmZzZXRzIGFuZCBlbGVtZW50IG1hcmdpbnMKCQkJLy8gbm90ZTogd2hlbiBhbiBlbGVtZW50IGhhcyBtYXJnaW46IGF1dG8gdGhlIG9mZnNldExlZnQgYW5kIG1hcmdpbkxlZnQKCQkJLy8gYXJlIHRoZSBzYW1lIGluIFNhZmFyaSBjYXVzaW5nIG9mZnNldC5sZWZ0IHRvIGluY29ycmVjdGx5IGJlIDAKCQkJcmV0dXJuIHsKCQkJCXRvcDogIG9mZnNldC50b3AgIC0gcGFyZW50T2Zmc2V0LnRvcCAtIGpRdWVyeS5jc3MoIGVsZW0sICJtYXJnaW5Ub3AiLCB0cnVlICksCgkJCQlsZWZ0OiBvZmZzZXQubGVmdCAtIHBhcmVudE9mZnNldC5sZWZ0IC0galF1ZXJ5LmNzcyggZWxlbSwgIm1hcmdpbkxlZnQiLCB0cnVlKQoJCQl9OwoJCX0sCgoJCW9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLm1hcChmdW5jdGlvbigpIHsKCQkJCXZhciBvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCB8fCBkb2NFbGVtOwoKCQkJCXdoaWxlICggb2Zmc2V0UGFyZW50ICYmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50LCAiaHRtbCIgKSAmJiBqUXVlcnkuY3NzKCBvZmZzZXRQYXJlbnQsICJwb3NpdGlvbiIgKSA9PT0gInN0YXRpYyIgKSApIHsKCQkJCQlvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50OwoJCQkJfQoJCQkJcmV0dXJuIG9mZnNldFBhcmVudCB8fCBkb2NFbGVtOwoJCQl9KTsKCQl9Cgl9KTsKCgkvLyBDcmVhdGUgc2Nyb2xsTGVmdCBhbmQgc2Nyb2xsVG9wIG1ldGhvZHMKCWpRdWVyeS5lYWNoKCB7IHNjcm9sbExlZnQ6ICJwYWdlWE9mZnNldCIsIHNjcm9sbFRvcDogInBhZ2VZT2Zmc2V0IiB9LCBmdW5jdGlvbiggbWV0aG9kLCBwcm9wICkgewoJCXZhciB0b3AgPSAvWS8udGVzdCggcHJvcCApOwoKCQlqUXVlcnkuZm5bIG1ldGhvZCBdID0gZnVuY3Rpb24oIHZhbCApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG1ldGhvZCwgdmFsICkgewoJCQkJdmFyIHdpbiA9IGdldFdpbmRvdyggZWxlbSApOwoKCQkJCWlmICggdmFsID09PSB1bmRlZmluZWQgKSB7CgkJCQkJcmV0dXJuIHdpbiA/IChwcm9wIGluIHdpbikgPyB3aW5bIHByb3AgXSA6CgkJCQkJCXdpbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbIG1ldGhvZCBdIDoKCQkJCQkJZWxlbVsgbWV0aG9kIF07CgkJCQl9CgoJCQkJaWYgKCB3aW4gKSB7CgkJCQkJd2luLnNjcm9sbFRvKAoJCQkJCQkhdG9wID8gdmFsIDogalF1ZXJ5KCB3aW4gKS5zY3JvbGxMZWZ0KCksCgkJCQkJCXRvcCA/IHZhbCA6IGpRdWVyeSggd2luICkuc2Nyb2xsVG9wKCkKCQkJCQkpOwoKCQkJCX0gZWxzZSB7CgkJCQkJZWxlbVsgbWV0aG9kIF0gPSB2YWw7CgkJCQl9CgkJCX0sIG1ldGhvZCwgdmFsLCBhcmd1bWVudHMubGVuZ3RoLCBudWxsICk7CgkJfTsKCX0pOwoKCS8vIEFkZCB0aGUgdG9wL2xlZnQgY3NzSG9va3MgdXNpbmcgalF1ZXJ5LmZuLnBvc2l0aW9uCgkvLyBXZWJraXQgYnVnOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjkwODQKCS8vIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyBwZXJjZW50IHdoZW4gc3BlY2lmaWVkIGZvciB0b3AvbGVmdC9ib3R0b20vcmlnaHQKCS8vIHJhdGhlciB0aGFuIG1ha2UgdGhlIGNzcyBtb2R1bGUgZGVwZW5kIG9uIHRoZSBvZmZzZXQgbW9kdWxlLCB3ZSBqdXN0IGNoZWNrIGZvciBpdCBoZXJlCglqUXVlcnkuZWFjaCggWyAidG9wIiwgImxlZnQiIF0sIGZ1bmN0aW9uKCBpLCBwcm9wICkgewoJCWpRdWVyeS5jc3NIb29rc1sgcHJvcCBdID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnBpeGVsUG9zaXRpb24sCgkJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJCWlmICggY29tcHV0ZWQgKSB7CgkJCQkJY29tcHV0ZWQgPSBjdXJDU1MoIGVsZW0sIHByb3AgKTsKCQkJCQkvLyBpZiBjdXJDU1MgcmV0dXJucyBwZXJjZW50YWdlLCBmYWxsYmFjayB0byBvZmZzZXQKCQkJCQlyZXR1cm4gcm51bW5vbnB4LnRlc3QoIGNvbXB1dGVkICkgPwoJCQkJCQlqUXVlcnkoIGVsZW0gKS5wb3NpdGlvbigpWyBwcm9wIF0gKyAicHgiIDoKCQkJCQkJY29tcHV0ZWQ7CgkJCQl9CgkJCX0KCQkpOwoJfSk7CgoKCS8vIENyZWF0ZSBpbm5lckhlaWdodCwgaW5uZXJXaWR0aCwgaGVpZ2h0LCB3aWR0aCwgb3V0ZXJIZWlnaHQgYW5kIG91dGVyV2lkdGggbWV0aG9kcwoJalF1ZXJ5LmVhY2goIHsgSGVpZ2h0OiAiaGVpZ2h0IiwgV2lkdGg6ICJ3aWR0aCIgfSwgZnVuY3Rpb24oIG5hbWUsIHR5cGUgKSB7CgkJalF1ZXJ5LmVhY2goIHsgcGFkZGluZzogImlubmVyIiArIG5hbWUsIGNvbnRlbnQ6IHR5cGUsICIiOiAib3V0ZXIiICsgbmFtZSB9LCBmdW5jdGlvbiggZGVmYXVsdEV4dHJhLCBmdW5jTmFtZSApIHsKCQkJLy8gbWFyZ2luIGlzIG9ubHkgZm9yIG91dGVySGVpZ2h0LCBvdXRlcldpZHRoCgkJCWpRdWVyeS5mblsgZnVuY05hbWUgXSA9IGZ1bmN0aW9uKCBtYXJnaW4sIHZhbHVlICkgewoJCQkJdmFyIGNoYWluYWJsZSA9IGFyZ3VtZW50cy5sZW5ndGggJiYgKCBkZWZhdWx0RXh0cmEgfHwgdHlwZW9mIG1hcmdpbiAhPT0gImJvb2xlYW4iICksCgkJCQkJZXh0cmEgPSBkZWZhdWx0RXh0cmEgfHwgKCBtYXJnaW4gPT09IHRydWUgfHwgdmFsdWUgPT09IHRydWUgPyAibWFyZ2luIiA6ICJib3JkZXIiICk7CgoJCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIHR5cGUsIHZhbHVlICkgewoJCQkJCXZhciBkb2M7CgoJCQkJCWlmICggalF1ZXJ5LmlzV2luZG93KCBlbGVtICkgKSB7CgkJCQkJCS8vIEFzIG9mIDUvOC8yMDEyIHRoaXMgd2lsbCB5aWVsZCBpbmNvcnJlY3QgcmVzdWx0cyBmb3IgTW9iaWxlIFNhZmFyaSwgYnV0IHRoZXJlCgkJCQkJCS8vIGlzbid0IGEgd2hvbGUgbG90IHdlIGNhbiBkby4gU2VlIHB1bGwgcmVxdWVzdCBhdCB0aGlzIFVSTCBmb3IgZGlzY3Vzc2lvbjoKCQkJCQkJLy8gaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC83NjQKCQkJCQkJcmV0dXJuIGVsZW0uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyAiY2xpZW50IiArIG5hbWUgXTsKCQkJCQl9CgoJCQkJCS8vIEdldCBkb2N1bWVudCB3aWR0aCBvciBoZWlnaHQKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDkgKSB7CgkJCQkJCWRvYyA9IGVsZW0uZG9jdW1lbnRFbGVtZW50OwoKCQkJCQkJLy8gRWl0aGVyIHNjcm9sbFtXaWR0aC9IZWlnaHRdIG9yIG9mZnNldFtXaWR0aC9IZWlnaHRdIG9yIGNsaWVudFtXaWR0aC9IZWlnaHRdLCB3aGljaGV2ZXIgaXMgZ3JlYXRlc3QKCQkJCQkJLy8gdW5mb3J0dW5hdGVseSwgdGhpcyBjYXVzZXMgYnVnICMzODM4IGluIElFNi84IG9ubHksIGJ1dCB0aGVyZSBpcyBjdXJyZW50bHkgbm8gZ29vZCwgc21hbGwgd2F5IHRvIGZpeCBpdC4KCQkJCQkJcmV0dXJuIE1hdGgubWF4KAoJCQkJCQkJZWxlbS5ib2R5WyAic2Nyb2xsIiArIG5hbWUgXSwgZG9jWyAic2Nyb2xsIiArIG5hbWUgXSwKCQkJCQkJCWVsZW0uYm9keVsgIm9mZnNldCIgKyBuYW1lIF0sIGRvY1sgIm9mZnNldCIgKyBuYW1lIF0sCgkJCQkJCQlkb2NbICJjbGllbnQiICsgbmFtZSBdCgkJCQkJCSk7CgkJCQkJfQoKCQkJCQlyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/CgkJCQkJCS8vIEdldCB3aWR0aCBvciBoZWlnaHQgb24gdGhlIGVsZW1lbnQsIHJlcXVlc3RpbmcgYnV0IG5vdCBmb3JjaW5nIHBhcnNlRmxvYXQKCQkJCQkJalF1ZXJ5LmNzcyggZWxlbSwgdHlwZSwgZXh0cmEgKSA6CgoJCQkJCQkvLyBTZXQgd2lkdGggb3IgaGVpZ2h0IG9uIHRoZSBlbGVtZW50CgkJCQkJCWpRdWVyeS5zdHlsZSggZWxlbSwgdHlwZSwgdmFsdWUsIGV4dHJhICk7CgkJCQl9LCB0eXBlLCBjaGFpbmFibGUgPyBtYXJnaW4gOiB1bmRlZmluZWQsIGNoYWluYWJsZSwgbnVsbCApOwoJCQl9OwoJCX0pOwoJfSk7CgoKCS8vIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgY29udGFpbmVkIGluIHRoZSBtYXRjaGVkIGVsZW1lbnQgc2V0CglqUXVlcnkuZm4uc2l6ZSA9IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLmxlbmd0aDsKCX07CgoJalF1ZXJ5LmZuLmFuZFNlbGYgPSBqUXVlcnkuZm4uYWRkQmFjazsKCgoKCgkvLyBSZWdpc3RlciBhcyBhIG5hbWVkIEFNRCBtb2R1bGUsIHNpbmNlIGpRdWVyeSBjYW4gYmUgY29uY2F0ZW5hdGVkIHdpdGggb3RoZXIKCS8vIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsIGJ1dCBub3QgdmlhIGEgcHJvcGVyIGNvbmNhdGVuYXRpb24gc2NyaXB0IHRoYXQKCS8vIHVuZGVyc3RhbmRzIGFub255bW91cyBBTUQgbW9kdWxlcy4gQSBuYW1lZCBBTUQgaXMgc2FmZXN0IGFuZCBtb3N0IHJvYnVzdAoJLy8gd2F5IHRvIHJlZ2lzdGVyLiBMb3dlcmNhc2UganF1ZXJ5IGlzIHVzZWQgYmVjYXVzZSBBTUQgbW9kdWxlIG5hbWVzIGFyZQoJLy8gZGVyaXZlZCBmcm9tIGZpbGUgbmFtZXMsIGFuZCBqUXVlcnkgaXMgbm9ybWFsbHkgZGVsaXZlcmVkIGluIGEgbG93ZXJjYXNlCgkvLyBmaWxlIG5hbWUuIERvIHRoaXMgYWZ0ZXIgY3JlYXRpbmcgdGhlIGdsb2JhbCBzbyB0aGF0IGlmIGFuIEFNRCBtb2R1bGUgd2FudHMKCS8vIHRvIGNhbGwgbm9Db25mbGljdCB0byBoaWRlIHRoaXMgdmVyc2lvbiBvZiBqUXVlcnksIGl0IHdpbGwgd29yay4KCgkvLyBOb3RlIHRoYXQgZm9yIG1heGltdW0gcG9ydGFiaWxpdHksIGxpYnJhcmllcyB0aGF0IGFyZSBub3QgalF1ZXJ5IHNob3VsZAoJLy8gZGVjbGFyZSB0aGVtc2VsdmVzIGFzIGFub255bW91cyBtb2R1bGVzLCBhbmQgYXZvaWQgc2V0dGluZyBhIGdsb2JhbCBpZiBhbgoJLy8gQU1EIGxvYWRlciBpcyBwcmVzZW50LiBqUXVlcnkgaXMgYSBzcGVjaWFsIGNhc2UuIEZvciBtb3JlIGluZm9ybWF0aW9uLCBzZWUKCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL3JlcXVpcmVqcy93aWtpL1VwZGF0aW5nLWV4aXN0aW5nLWxpYnJhcmllcyN3aWtpLWFub24KCglpZiAoIHRydWUgKSB7CgkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7CgkJCXJldHVybiBqUXVlcnk7CgkJfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJfQoKCgoKCXZhcgoJCS8vIE1hcCBvdmVyIGpRdWVyeSBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJCV9qUXVlcnkgPSB3aW5kb3cualF1ZXJ5LAoKCQkvLyBNYXAgb3ZlciB0aGUgJCBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJCV8kID0gd2luZG93LiQ7CgoJalF1ZXJ5Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbiggZGVlcCApIHsKCQlpZiAoIHdpbmRvdy4kID09PSBqUXVlcnkgKSB7CgkJCXdpbmRvdy4kID0gXyQ7CgkJfQoKCQlpZiAoIGRlZXAgJiYgd2luZG93LmpRdWVyeSA9PT0galF1ZXJ5ICkgewoJCQl3aW5kb3cualF1ZXJ5ID0gX2pRdWVyeTsKCQl9CgoJCXJldHVybiBqUXVlcnk7Cgl9OwoKCS8vIEV4cG9zZSBqUXVlcnkgYW5kICQgaWRlbnRpZmllcnMsIGV2ZW4gaW4KCS8vIEFNRCAoIzcxMDIjY29tbWVudDoxMCwgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC81NTcpCgkvLyBhbmQgQ29tbW9uSlMgZm9yIGJyb3dzZXIgZW11bGF0b3JzICgjMTM1NjYpCglpZiAoIHR5cGVvZiBub0dsb2JhbCA9PT0gc3RydW5kZWZpbmVkICkgewoJCXdpbmRvdy5qUXVlcnkgPSB3aW5kb3cuJCA9IGpRdWVyeTsKCX0KCgoKCglyZXR1cm4galF1ZXJ5OwoKCX0pKTsKCgovKioqLyB9LAovKiA1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qKiEKCgkgQGxpY2Vuc2UKCSBoYW5kbGViYXJzIHY0LjAuNgoKCUNvcHlyaWdodCAoQykgMjAxMS0yMDE2IGJ5IFllaHVkYSBLYXR6CgoJUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQoJb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKCWluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKCXRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwKCWNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwoJZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKCglUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgoJYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgoJVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKCUlNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAoJRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCglBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCglMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAoJT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTgoJVEhFIFNPRlRXQVJFLgoKCSovCgkvKiohCgoJIEBsaWNlbnNlCgkgaGFuZGxlYmFycyB2NC4wLjYKCglDb3B5cmlnaHQgKEMpIDIwMTEtMjAxNiBieSBZZWh1ZGEgS2F0egoKCVBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKCW9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCglpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCgl0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCgljb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKCWZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CgoJVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KCWFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoKCVRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCglJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKCUZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQoJQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgoJTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKCU9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4KCVRIRSBTT0ZUV0FSRS4KCgkqLwoJLyoqIQoKCSBAbGljZW5zZQoJIGhhbmRsZWJhcnMgdjQuMC42CgoJQ29weXJpZ2h0IChDKSAyMDExLTIwMTYgYnkgWWVodWRhIEthdHoKCglQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5CglvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoJaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwoJdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAoJY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCglmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKCVRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCglhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCglUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgoJSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCglGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKCUFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKCUxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCglPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCglUSEUgU09GVFdBUkUuCgoJKi8KCShmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CgkJaWYodHJ1ZSkKCQkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgkJZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpCgkJCWRlZmluZShbXSwgZmFjdG9yeSk7CgkJZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpCgkJCWV4cG9ydHNbIkhhbmRsZWJhcnMiXSA9IGZhY3RvcnkoKTsKCQllbHNlCgkJCXJvb3RbIkhhbmRsZWJhcnMiXSA9IGZhY3RvcnkoKTsKCX0pKHRoaXMsIGZ1bmN0aW9uKCkgewoJcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKCS8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCgkvKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCgkvKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KCS8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7CgoJLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKCS8qKioqKiovIAkJaWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pCgkvKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKCgkvKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCgkvKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKCS8qKioqKiovIAkJCWV4cG9ydHM6IHt9LAoJLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAoJLyoqKioqKi8gCQkJbG9hZGVkOiBmYWxzZQoJLyoqKioqKi8gCQl9OwoKCS8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCgkvKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwoKCS8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAoJLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCgkvKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCgkvKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKCS8qKioqKiovIAl9CgoKCS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CgoJLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsKCgkvKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCgkvKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCgkvKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7CgkvKioqKioqLyB9KQoJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCS8qKioqKiovIChbCgkvKiAwICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF9oYW5kbGViYXJzUnVudGltZSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CgoJCXZhciBfaGFuZGxlYmFyc1J1bnRpbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc1J1bnRpbWUpOwoKCQkvLyBDb21waWxlciBpbXBvcnRzCgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyQXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyQXN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNDb21waWxlckFzdCk7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyQmFzZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpOwoKCQl2YXIgX2hhbmRsZWJhcnNDb21waWxlckNvbXBpbGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCk7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVySmF2YXNjcmlwdENvbXBpbGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVySmF2YXNjcmlwdENvbXBpbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNDb21waWxlckphdmFzY3JpcHRDb21waWxlcik7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyVmlzaXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKCQl2YXIgX2hhbmRsZWJhcnNDb21waWxlclZpc2l0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc0NvbXBpbGVyVmlzaXRvcik7CgoJCXZhciBfaGFuZGxlYmFyc05vQ29uZmxpY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCgkJdmFyIF9oYW5kbGViYXJzTm9Db25mbGljdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYW5kbGViYXJzTm9Db25mbGljdCk7CgoJCXZhciBfY3JlYXRlID0gX2hhbmRsZWJhcnNSdW50aW1lMlsnZGVmYXVsdCddLmNyZWF0ZTsKCQlmdW5jdGlvbiBjcmVhdGUoKSB7CgkJICB2YXIgaGIgPSBfY3JlYXRlKCk7CgoJCSAgaGIuY29tcGlsZSA9IGZ1bmN0aW9uIChpbnB1dCwgb3B0aW9ucykgewoJCSAgICByZXR1cm4gX2hhbmRsZWJhcnNDb21waWxlckNvbXBpbGVyLmNvbXBpbGUoaW5wdXQsIG9wdGlvbnMsIGhiKTsKCQkgIH07CgkJICBoYi5wcmVjb21waWxlID0gZnVuY3Rpb24gKGlucHV0LCBvcHRpb25zKSB7CgkJICAgIHJldHVybiBfaGFuZGxlYmFyc0NvbXBpbGVyQ29tcGlsZXIucHJlY29tcGlsZShpbnB1dCwgb3B0aW9ucywgaGIpOwoJCSAgfTsKCgkJICBoYi5BU1QgPSBfaGFuZGxlYmFyc0NvbXBpbGVyQXN0MlsnZGVmYXVsdCddOwoJCSAgaGIuQ29tcGlsZXIgPSBfaGFuZGxlYmFyc0NvbXBpbGVyQ29tcGlsZXIuQ29tcGlsZXI7CgkJICBoYi5KYXZhU2NyaXB0Q29tcGlsZXIgPSBfaGFuZGxlYmFyc0NvbXBpbGVySmF2YXNjcmlwdENvbXBpbGVyMlsnZGVmYXVsdCddOwoJCSAgaGIuUGFyc2VyID0gX2hhbmRsZWJhcnNDb21waWxlckJhc2UucGFyc2VyOwoJCSAgaGIucGFyc2UgPSBfaGFuZGxlYmFyc0NvbXBpbGVyQmFzZS5wYXJzZTsKCgkJICByZXR1cm4gaGI7CgkJfQoKCQl2YXIgaW5zdCA9IGNyZWF0ZSgpOwoJCWluc3QuY3JlYXRlID0gY3JlYXRlOwoKCQlfaGFuZGxlYmFyc05vQ29uZmxpY3QyWydkZWZhdWx0J10oaW5zdCk7CgoJCWluc3QuVmlzaXRvciA9IF9oYW5kbGViYXJzQ29tcGlsZXJWaXNpdG9yMlsnZGVmYXVsdCddOwoKCQlpbnN0WydkZWZhdWx0J10gPSBpbnN0OwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBpbnN0OwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkJInVzZSBzdHJpY3QiOwoKCQlleHBvcnRzWyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAob2JqKSB7CgkJICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewoJCSAgICAiZGVmYXVsdCI6IG9iagoJCSAgfTsKCQl9OwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCS8qKiovIH0sCgkvKiAyICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpWydkZWZhdWx0J107CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX2hhbmRsZWJhcnNCYXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKCgkJdmFyIGJhc2UgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfaGFuZGxlYmFyc0Jhc2UpOwoKCQkvLyBFYWNoIG9mIHRoZXNlIGF1Z21lbnQgdGhlIEhhbmRsZWJhcnMgb2JqZWN0LiBObyBuZWVkIHRvIHNldHVwIGhlcmUuCgkJLy8gKFRoaXMgaXMgZG9uZSB0byBlYXNpbHkgc2hhcmUgY29kZSBiZXR3ZWVuIGNvbW1vbmpzIGFuZCBicm93c2UgZW52cykKCgkJdmFyIF9oYW5kbGViYXJzU2FmZVN0cmluZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpOwoKCQl2YXIgX2hhbmRsZWJhcnNTYWZlU3RyaW5nMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNTYWZlU3RyaW5nKTsKCgkJdmFyIF9oYW5kbGViYXJzRXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9oYW5kbGViYXJzRXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNFeGNlcHRpb24pOwoKCQl2YXIgX2hhbmRsZWJhcnNVdGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBVdGlscyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9oYW5kbGViYXJzVXRpbHMpOwoKCQl2YXIgX2hhbmRsZWJhcnNSdW50aW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7CgoJCXZhciBydW50aW1lID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2hhbmRsZWJhcnNSdW50aW1lKTsKCgkJdmFyIF9oYW5kbGViYXJzTm9Db25mbGljdCA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoKCQl2YXIgX2hhbmRsZWJhcnNOb0NvbmZsaWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNOb0NvbmZsaWN0KTsKCgkJLy8gRm9yIGNvbXBhdGliaWxpdHkgYW5kIHVzYWdlIG91dHNpZGUgb2YgbW9kdWxlIHN5c3RlbXMsIG1ha2UgdGhlIEhhbmRsZWJhcnMgb2JqZWN0IGEgbmFtZXNwYWNlCgkJZnVuY3Rpb24gY3JlYXRlKCkgewoJCSAgdmFyIGhiID0gbmV3IGJhc2UuSGFuZGxlYmFyc0Vudmlyb25tZW50KCk7CgoJCSAgVXRpbHMuZXh0ZW5kKGhiLCBiYXNlKTsKCQkgIGhiLlNhZmVTdHJpbmcgPSBfaGFuZGxlYmFyc1NhZmVTdHJpbmcyWydkZWZhdWx0J107CgkJICBoYi5FeGNlcHRpb24gPSBfaGFuZGxlYmFyc0V4Y2VwdGlvbjJbJ2RlZmF1bHQnXTsKCQkgIGhiLlV0aWxzID0gVXRpbHM7CgkJICBoYi5lc2NhcGVFeHByZXNzaW9uID0gVXRpbHMuZXNjYXBlRXhwcmVzc2lvbjsKCgkJICBoYi5WTSA9IHJ1bnRpbWU7CgkJICBoYi50ZW1wbGF0ZSA9IGZ1bmN0aW9uIChzcGVjKSB7CgkJICAgIHJldHVybiBydW50aW1lLnRlbXBsYXRlKHNwZWMsIGhiKTsKCQkgIH07CgoJCSAgcmV0dXJuIGhiOwoJCX0KCgkJdmFyIGluc3QgPSBjcmVhdGUoKTsKCQlpbnN0LmNyZWF0ZSA9IGNyZWF0ZTsKCgkJX2hhbmRsZWJhcnNOb0NvbmZsaWN0MlsnZGVmYXVsdCddKGluc3QpOwoKCQlpbnN0WydkZWZhdWx0J10gPSBpbnN0OwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBpbnN0OwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAzICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkJInVzZSBzdHJpY3QiOwoKCQlleHBvcnRzWyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAob2JqKSB7CgkJICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CgkJICAgIHJldHVybiBvYmo7CgkJICB9IGVsc2UgewoJCSAgICB2YXIgbmV3T2JqID0ge307CgoJCSAgICBpZiAob2JqICE9IG51bGwpIHsKCQkgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CgkJICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKCQkgICAgICB9CgkJICAgIH0KCgkJICAgIG5ld09ialsiZGVmYXVsdCJdID0gb2JqOwoJCSAgICByZXR1cm4gbmV3T2JqOwoJCSAgfQoJCX07CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJLyoqKi8gfSwKCS8qIDQgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMuSGFuZGxlYmFyc0Vudmlyb25tZW50ID0gSGFuZGxlYmFyc0Vudmlyb25tZW50OwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKCQl2YXIgX2V4Y2VwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGNlcHRpb24pOwoKCQl2YXIgX2hlbHBlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgkJdmFyIF9kZWNvcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CgoJCXZhciBfbG9nZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7CgoJCXZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7CgoJCXZhciBWRVJTSU9OID0gJzQuMC41JzsKCQlleHBvcnRzLlZFUlNJT04gPSBWRVJTSU9OOwoJCXZhciBDT01QSUxFUl9SRVZJU0lPTiA9IDc7CgoJCWV4cG9ydHMuQ09NUElMRVJfUkVWSVNJT04gPSBDT01QSUxFUl9SRVZJU0lPTjsKCQl2YXIgUkVWSVNJT05fQ0hBTkdFUyA9IHsKCQkgIDE6ICc8PSAxLjAucmMuMicsIC8vIDEuMC5yYy4yIGlzIGFjdHVhbGx5IHJldjIgYnV0IGRvZXNuJ3QgcmVwb3J0IGl0CgkJICAyOiAnPT0gMS4wLjAtcmMuMycsCgkJICAzOiAnPT0gMS4wLjAtcmMuNCcsCgkJICA0OiAnPT0gMS54LngnLAoJCSAgNTogJz09IDIuMC4wLWFscGhhLngnLAoJCSAgNjogJz49IDIuMC4wLWJldGEuMScsCgkJICA3OiAnPj0gNC4wLjAnCgkJfTsKCgkJZXhwb3J0cy5SRVZJU0lPTl9DSEFOR0VTID0gUkVWSVNJT05fQ0hBTkdFUzsKCQl2YXIgb2JqZWN0VHlwZSA9ICdbb2JqZWN0IE9iamVjdF0nOwoKCQlmdW5jdGlvbiBIYW5kbGViYXJzRW52aXJvbm1lbnQoaGVscGVycywgcGFydGlhbHMsIGRlY29yYXRvcnMpIHsKCQkgIHRoaXMuaGVscGVycyA9IGhlbHBlcnMgfHwge307CgkJICB0aGlzLnBhcnRpYWxzID0gcGFydGlhbHMgfHwge307CgkJICB0aGlzLmRlY29yYXRvcnMgPSBkZWNvcmF0b3JzIHx8IHt9OwoKCQkgIF9oZWxwZXJzLnJlZ2lzdGVyRGVmYXVsdEhlbHBlcnModGhpcyk7CgkJICBfZGVjb3JhdG9ycy5yZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzKHRoaXMpOwoJCX0KCgkJSGFuZGxlYmFyc0Vudmlyb25tZW50LnByb3RvdHlwZSA9IHsKCQkgIGNvbnN0cnVjdG9yOiBIYW5kbGViYXJzRW52aXJvbm1lbnQsCgoJCSAgbG9nZ2VyOiBfbG9nZ2VyMlsnZGVmYXVsdCddLAoJCSAgbG9nOiBfbG9nZ2VyMlsnZGVmYXVsdCddLmxvZywKCgkJICByZWdpc3RlckhlbHBlcjogZnVuY3Rpb24gcmVnaXN0ZXJIZWxwZXIobmFtZSwgZm4pIHsKCQkgICAgaWYgKF91dGlscy50b1N0cmluZy5jYWxsKG5hbWUpID09PSBvYmplY3RUeXBlKSB7CgkJICAgICAgaWYgKGZuKSB7CgkJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBoZWxwZXJzJyk7CgkJICAgICAgfQoJCSAgICAgIF91dGlscy5leHRlbmQodGhpcy5oZWxwZXJzLCBuYW1lKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLmhlbHBlcnNbbmFtZV0gPSBmbjsKCQkgICAgfQoJCSAgfSwKCQkgIHVucmVnaXN0ZXJIZWxwZXI6IGZ1bmN0aW9uIHVucmVnaXN0ZXJIZWxwZXIobmFtZSkgewoJCSAgICBkZWxldGUgdGhpcy5oZWxwZXJzW25hbWVdOwoJCSAgfSwKCgkJICByZWdpc3RlclBhcnRpYWw6IGZ1bmN0aW9uIHJlZ2lzdGVyUGFydGlhbChuYW1lLCBwYXJ0aWFsKSB7CgkJICAgIGlmIChfdXRpbHMudG9TdHJpbmcuY2FsbChuYW1lKSA9PT0gb2JqZWN0VHlwZSkgewoJCSAgICAgIF91dGlscy5leHRlbmQodGhpcy5wYXJ0aWFscywgbmFtZSk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgaWYgKHR5cGVvZiBwYXJ0aWFsID09PSAndW5kZWZpbmVkJykgewoJCSAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ0F0dGVtcHRpbmcgdG8gcmVnaXN0ZXIgYSBwYXJ0aWFsIGNhbGxlZCAiJyArIG5hbWUgKyAnIiBhcyB1bmRlZmluZWQnKTsKCQkgICAgICB9CgkJICAgICAgdGhpcy5wYXJ0aWFsc1tuYW1lXSA9IHBhcnRpYWw7CgkJICAgIH0KCQkgIH0sCgkJICB1bnJlZ2lzdGVyUGFydGlhbDogZnVuY3Rpb24gdW5yZWdpc3RlclBhcnRpYWwobmFtZSkgewoJCSAgICBkZWxldGUgdGhpcy5wYXJ0aWFsc1tuYW1lXTsKCQkgIH0sCgoJCSAgcmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uIHJlZ2lzdGVyRGVjb3JhdG9yKG5hbWUsIGZuKSB7CgkJICAgIGlmIChfdXRpbHMudG9TdHJpbmcuY2FsbChuYW1lKSA9PT0gb2JqZWN0VHlwZSkgewoJCSAgICAgIGlmIChmbikgewoJCSAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ0FyZyBub3Qgc3VwcG9ydGVkIHdpdGggbXVsdGlwbGUgZGVjb3JhdG9ycycpOwoJCSAgICAgIH0KCQkgICAgICBfdXRpbHMuZXh0ZW5kKHRoaXMuZGVjb3JhdG9ycywgbmFtZSk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5kZWNvcmF0b3JzW25hbWVdID0gZm47CgkJICAgIH0KCQkgIH0sCgkJICB1bnJlZ2lzdGVyRGVjb3JhdG9yOiBmdW5jdGlvbiB1bnJlZ2lzdGVyRGVjb3JhdG9yKG5hbWUpIHsKCQkgICAgZGVsZXRlIHRoaXMuZGVjb3JhdG9yc1tuYW1lXTsKCQkgIH0KCQl9OwoKCQl2YXIgbG9nID0gX2xvZ2dlcjJbJ2RlZmF1bHQnXS5sb2c7CgoJCWV4cG9ydHMubG9nID0gbG9nOwoJCWV4cG9ydHMuY3JlYXRlRnJhbWUgPSBfdXRpbHMuY3JlYXRlRnJhbWU7CgkJZXhwb3J0cy5sb2dnZXIgPSBfbG9nZ2VyMlsnZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiA1ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMuZXh0ZW5kID0gZXh0ZW5kOwoJCWV4cG9ydHMuaW5kZXhPZiA9IGluZGV4T2Y7CgkJZXhwb3J0cy5lc2NhcGVFeHByZXNzaW9uID0gZXNjYXBlRXhwcmVzc2lvbjsKCQlleHBvcnRzLmlzRW1wdHkgPSBpc0VtcHR5OwoJCWV4cG9ydHMuY3JlYXRlRnJhbWUgPSBjcmVhdGVGcmFtZTsKCQlleHBvcnRzLmJsb2NrUGFyYW1zID0gYmxvY2tQYXJhbXM7CgkJZXhwb3J0cy5hcHBlbmRDb250ZXh0UGF0aCA9IGFwcGVuZENvbnRleHRQYXRoOwoJCXZhciBlc2NhcGUgPSB7CgkJICAnJic6ICcmYW1wOycsCgkJICAnPCc6ICcmbHQ7JywKCQkgICc+JzogJyZndDsnLAoJCSAgJyInOiAnJnF1b3Q7JywKCQkgICInIjogJyYjeDI3OycsCgkJICAnYCc6ICcmI3g2MDsnLAoJCSAgJz0nOiAnJiN4M0Q7JwoJCX07CgoJCXZhciBiYWRDaGFycyA9IC9bJjw+IidgPV0vZywKCQkgICAgcG9zc2libGUgPSAvWyY8PiInYD1dLzsKCgkJZnVuY3Rpb24gZXNjYXBlQ2hhcihjaHIpIHsKCQkgIHJldHVybiBlc2NhcGVbY2hyXTsKCQl9CgoJCWZ1bmN0aW9uIGV4dGVuZChvYmogLyogLCAuLi5zb3VyY2UgKi8pIHsKCQkgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkJICAgIGZvciAodmFyIGtleSBpbiBhcmd1bWVudHNbaV0pIHsKCQkgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGFyZ3VtZW50c1tpXSwga2V5KSkgewoJCSAgICAgICAgb2JqW2tleV0gPSBhcmd1bWVudHNbaV1ba2V5XTsKCQkgICAgICB9CgkJICAgIH0KCQkgIH0KCgkJICByZXR1cm4gb2JqOwoJCX0KCgkJdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCgkJZXhwb3J0cy50b1N0cmluZyA9IHRvU3RyaW5nOwoJCS8vIFNvdXJjZWQgZnJvbSBsb2Rhc2gKCQkvLyBodHRwczovL2dpdGh1Yi5jb20vYmVzdGllanMvbG9kYXNoL2Jsb2IvbWFzdGVyL0xJQ0VOU0UudHh0CgkJLyogZXNsaW50LWRpc2FibGUgZnVuYy1zdHlsZSAqLwoJCXZhciBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkgewoJCSAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJzsKCQl9OwoJCS8vIGZhbGxiYWNrIGZvciBvbGRlciB2ZXJzaW9ucyBvZiBDaHJvbWUgYW5kIFNhZmFyaQoJCS8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJaWYgKGlzRnVuY3Rpb24oL3gvKSkgewoJCSAgZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbiA9IGZ1bmN0aW9uICh2YWx1ZSkgewoJCSAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBGdW5jdGlvbl0nOwoJCSAgfTsKCQl9CgkJZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjsKCgkJLyogZXNsaW50LWVuYWJsZSBmdW5jLXN0eWxlICovCgoJCS8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uICh2YWx1ZSkgewoJCSAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgPyB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJyA6IGZhbHNlOwoJCX07CgoJCWV4cG9ydHMuaXNBcnJheSA9IGlzQXJyYXk7CgkJLy8gT2xkZXIgSUUgdmVyc2lvbnMgZG8gbm90IGRpcmVjdGx5IHN1cHBvcnQgaW5kZXhPZiBzbyB3ZSBtdXN0IGltcGxlbWVudCBvdXIgb3duLCBzYWRseS4KCgkJZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgdmFsdWUpIHsKCQkgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykgewoJCSAgICBpZiAoYXJyYXlbaV0gPT09IHZhbHVlKSB7CgkJICAgICAgcmV0dXJuIGk7CgkJICAgIH0KCQkgIH0KCQkgIHJldHVybiAtMTsKCQl9CgoJCWZ1bmN0aW9uIGVzY2FwZUV4cHJlc3Npb24oc3RyaW5nKSB7CgkJICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHsKCQkgICAgLy8gZG9uJ3QgZXNjYXBlIFNhZmVTdHJpbmdzLCBzaW5jZSB0aGV5J3JlIGFscmVhZHkgc2FmZQoJCSAgICBpZiAoc3RyaW5nICYmIHN0cmluZy50b0hUTUwpIHsKCQkgICAgICByZXR1cm4gc3RyaW5nLnRvSFRNTCgpOwoJCSAgICB9IGVsc2UgaWYgKHN0cmluZyA9PSBudWxsKSB7CgkJICAgICAgcmV0dXJuICcnOwoJCSAgICB9IGVsc2UgaWYgKCFzdHJpbmcpIHsKCQkgICAgICByZXR1cm4gc3RyaW5nICsgJyc7CgkJICAgIH0KCgkJICAgIC8vIEZvcmNlIGEgc3RyaW5nIGNvbnZlcnNpb24gYXMgdGhpcyB3aWxsIGJlIGRvbmUgYnkgdGhlIGFwcGVuZCByZWdhcmRsZXNzIGFuZAoJCSAgICAvLyB0aGUgcmVnZXggdGVzdCB3aWxsIGRvIHRoaXMgdHJhbnNwYXJlbnRseSBiZWhpbmQgdGhlIHNjZW5lcywgY2F1c2luZyBpc3N1ZXMgaWYKCQkgICAgLy8gYW4gb2JqZWN0J3MgdG8gc3RyaW5nIGhhcyBlc2NhcGVkIGNoYXJhY3RlcnMgaW4gaXQuCgkJICAgIHN0cmluZyA9ICcnICsgc3RyaW5nOwoJCSAgfQoKCQkgIGlmICghcG9zc2libGUudGVzdChzdHJpbmcpKSB7CgkJICAgIHJldHVybiBzdHJpbmc7CgkJICB9CgkJICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoYmFkQ2hhcnMsIGVzY2FwZUNoYXIpOwoJCX0KCgkJZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSkgewoJCSAgaWYgKCF2YWx1ZSAmJiB2YWx1ZSAhPT0gMCkgewoJCSAgICByZXR1cm4gdHJ1ZTsKCQkgIH0gZWxzZSBpZiAoaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAwKSB7CgkJICAgIHJldHVybiB0cnVlOwoJCSAgfSBlbHNlIHsKCQkgICAgcmV0dXJuIGZhbHNlOwoJCSAgfQoJCX0KCgkJZnVuY3Rpb24gY3JlYXRlRnJhbWUob2JqZWN0KSB7CgkJICB2YXIgZnJhbWUgPSBleHRlbmQoe30sIG9iamVjdCk7CgkJICBmcmFtZS5fcGFyZW50ID0gb2JqZWN0OwoJCSAgcmV0dXJuIGZyYW1lOwoJCX0KCgkJZnVuY3Rpb24gYmxvY2tQYXJhbXMocGFyYW1zLCBpZHMpIHsKCQkgIHBhcmFtcy5wYXRoID0gaWRzOwoJCSAgcmV0dXJuIHBhcmFtczsKCQl9CgoJCWZ1bmN0aW9uIGFwcGVuZENvbnRleHRQYXRoKGNvbnRleHRQYXRoLCBpZCkgewoJCSAgcmV0dXJuIChjb250ZXh0UGF0aCA/IGNvbnRleHRQYXRoICsgJy4nIDogJycpICsgaWQ7CgkJfQoKCS8qKiovIH0sCgkvKiA2ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX09iamVjdCRkZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oNylbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIGVycm9yUHJvcHMgPSBbJ2Rlc2NyaXB0aW9uJywgJ2ZpbGVOYW1lJywgJ2xpbmVOdW1iZXInLCAnbWVzc2FnZScsICduYW1lJywgJ251bWJlcicsICdzdGFjayddOwoKCQlmdW5jdGlvbiBFeGNlcHRpb24obWVzc2FnZSwgbm9kZSkgewoJCSAgdmFyIGxvYyA9IG5vZGUgJiYgbm9kZS5sb2MsCgkJICAgICAgbGluZSA9IHVuZGVmaW5lZCwKCQkgICAgICBjb2x1bW4gPSB1bmRlZmluZWQ7CgkJICBpZiAobG9jKSB7CgkJICAgIGxpbmUgPSBsb2Muc3RhcnQubGluZTsKCQkgICAgY29sdW1uID0gbG9jLnN0YXJ0LmNvbHVtbjsKCgkJICAgIG1lc3NhZ2UgKz0gJyAtICcgKyBsaW5lICsgJzonICsgY29sdW1uOwoJCSAgfQoKCQkgIHZhciB0bXAgPSBFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCh0aGlzLCBtZXNzYWdlKTsKCgkJICAvLyBVbmZvcnR1bmF0ZWx5IGVycm9ycyBhcmUgbm90IGVudW1lcmFibGUgaW4gQ2hyb21lIChhdCBsZWFzdCksIHNvIGBmb3IgcHJvcCBpbiB0bXBgIGRvZXNuJ3Qgd29yay4KCQkgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGVycm9yUHJvcHMubGVuZ3RoOyBpZHgrKykgewoJCSAgICB0aGlzW2Vycm9yUHJvcHNbaWR4XV0gPSB0bXBbZXJyb3JQcm9wc1tpZHhdXTsKCQkgIH0KCgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwoJCSAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7CgkJICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIEV4Y2VwdGlvbik7CgkJICB9CgoJCSAgdHJ5IHsKCQkgICAgaWYgKGxvYykgewoJCSAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmU7CgoJCSAgICAgIC8vIFdvcmsgYXJvdW5kIGlzc3VlIHVuZGVyIHNhZmFyaSB3aGVyZSB3ZSBjYW4ndCBkaXJlY3RseSBzZXQgdGhlIGNvbHVtbiB2YWx1ZQoJCSAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJICAgICAgaWYgKF9PYmplY3QkZGVmaW5lUHJvcGVydHkpIHsKCQkgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnY29sdW1uJywgeyB2YWx1ZTogY29sdW1uIH0pOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICB0aGlzLmNvbHVtbiA9IGNvbHVtbjsKCQkgICAgICB9CgkJICAgIH0KCQkgIH0gY2F0Y2ggKG5vcCkgewoJCSAgICAvKiBJZ25vcmUgaWYgdGhlIGJyb3dzZXIgaXMgdmVyeSBwYXJ0aWN1bGFyICovCgkJICB9CgkJfQoKCQlFeGNlcHRpb24ucHJvdG90eXBlID0gbmV3IEVycm9yKCk7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IEV4Y2VwdGlvbjsKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogNyAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oOCksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9LAoJLyogOCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCXZhciAkID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCQltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpewoJCSAgcmV0dXJuICQuc2V0RGVzYyhpdCwga2V5LCBkZXNjKTsKCQl9OwoKCS8qKiovIH0sCgkvKiA5ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkJdmFyICRPYmplY3QgPSBPYmplY3Q7CgkJbW9kdWxlLmV4cG9ydHMgPSB7CgkJICBjcmVhdGU6ICAgICAkT2JqZWN0LmNyZWF0ZSwKCQkgIGdldFByb3RvOiAgICRPYmplY3QuZ2V0UHJvdG90eXBlT2YsCgkJICBpc0VudW06ICAgICB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSwKCQkgIGdldERlc2M6ICAgICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLAoJCSAgc2V0RGVzYzogICAgJE9iamVjdC5kZWZpbmVQcm9wZXJ0eSwKCQkgIHNldERlc2NzOiAgICRPYmplY3QuZGVmaW5lUHJvcGVydGllcywKCQkgIGdldEtleXM6ICAgICRPYmplY3Qua2V5cywKCQkgIGdldE5hbWVzOiAgICRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcywKCQkgIGdldFN5bWJvbHM6ICRPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzLAoJCSAgZWFjaDogICAgICAgW10uZm9yRWFjaAoJCX07CgoJLyoqKi8gfSwKCS8qIDEwICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCQlleHBvcnRzLnJlZ2lzdGVyRGVmYXVsdEhlbHBlcnMgPSByZWdpc3RlckRlZmF1bHRIZWxwZXJzOwoKCQl2YXIgX2hlbHBlcnNCbG9ja0hlbHBlck1pc3NpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTsKCgkJdmFyIF9oZWxwZXJzQmxvY2tIZWxwZXJNaXNzaW5nMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNCbG9ja0hlbHBlck1pc3NpbmcpOwoKCQl2YXIgX2hlbHBlcnNFYWNoID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7CgoJCXZhciBfaGVscGVyc0VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0VhY2gpOwoKCQl2YXIgX2hlbHBlcnNIZWxwZXJNaXNzaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CgoJCXZhciBfaGVscGVyc0hlbHBlck1pc3NpbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0hlbHBlck1pc3NpbmcpOwoKCQl2YXIgX2hlbHBlcnNJZiA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpOwoKCQl2YXIgX2hlbHBlcnNJZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oZWxwZXJzSWYpOwoKCQl2YXIgX2hlbHBlcnNMb2cgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsKCgkJdmFyIF9oZWxwZXJzTG9nMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNMb2cpOwoKCQl2YXIgX2hlbHBlcnNMb29rdXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKCgkJdmFyIF9oZWxwZXJzTG9va3VwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNMb29rdXApOwoKCQl2YXIgX2hlbHBlcnNXaXRoID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7CgoJCXZhciBfaGVscGVyc1dpdGgyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc1dpdGgpOwoKCQlmdW5jdGlvbiByZWdpc3RlckRlZmF1bHRIZWxwZXJzKGluc3RhbmNlKSB7CgkJICBfaGVscGVyc0Jsb2NrSGVscGVyTWlzc2luZzJbJ2RlZmF1bHQnXShpbnN0YW5jZSk7CgkJICBfaGVscGVyc0VhY2gyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCSAgX2hlbHBlcnNIZWxwZXJNaXNzaW5nMlsnZGVmYXVsdCddKGluc3RhbmNlKTsKCQkgIF9oZWxwZXJzSWYyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCSAgX2hlbHBlcnNMb2cyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCSAgX2hlbHBlcnNMb29rdXAyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCSAgX2hlbHBlcnNXaXRoMlsnZGVmYXVsdCddKGluc3RhbmNlKTsKCQl9CgoJLyoqKi8gfSwKCS8qIDExICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignYmxvY2tIZWxwZXJNaXNzaW5nJywgZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMpIHsKCQkgICAgdmFyIGludmVyc2UgPSBvcHRpb25zLmludmVyc2UsCgkJICAgICAgICBmbiA9IG9wdGlvbnMuZm47CgoJCSAgICBpZiAoY29udGV4dCA9PT0gdHJ1ZSkgewoJCSAgICAgIHJldHVybiBmbih0aGlzKTsKCQkgICAgfSBlbHNlIGlmIChjb250ZXh0ID09PSBmYWxzZSB8fCBjb250ZXh0ID09IG51bGwpIHsKCQkgICAgICByZXR1cm4gaW52ZXJzZSh0aGlzKTsKCQkgICAgfSBlbHNlIGlmIChfdXRpbHMuaXNBcnJheShjb250ZXh0KSkgewoJCSAgICAgIGlmIChjb250ZXh0Lmxlbmd0aCA+IDApIHsKCQkgICAgICAgIGlmIChvcHRpb25zLmlkcykgewoJCSAgICAgICAgICBvcHRpb25zLmlkcyA9IFtvcHRpb25zLm5hbWVdOwoJCSAgICAgICAgfQoKCQkgICAgICAgIHJldHVybiBpbnN0YW5jZS5oZWxwZXJzLmVhY2goY29udGV4dCwgb3B0aW9ucyk7CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpOwoJCSAgICAgIH0KCQkgICAgfSBlbHNlIHsKCQkgICAgICBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuaWRzKSB7CgkJICAgICAgICB2YXIgZGF0YSA9IF91dGlscy5jcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpOwoJCSAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IF91dGlscy5hcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMubmFtZSk7CgkJICAgICAgICBvcHRpb25zID0geyBkYXRhOiBkYXRhIH07CgkJICAgICAgfQoKCQkgICAgICByZXR1cm4gZm4oY29udGV4dCwgb3B0aW9ucyk7CgkJICAgIH0KCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxMiAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgewoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2VhY2gnLCBmdW5jdGlvbiAoY29udGV4dCwgb3B0aW9ucykgewoJCSAgICBpZiAoIW9wdGlvbnMpIHsKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnTXVzdCBwYXNzIGl0ZXJhdG9yIHRvICNlYWNoJyk7CgkJICAgIH0KCgkJICAgIHZhciBmbiA9IG9wdGlvbnMuZm4sCgkJICAgICAgICBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlLAoJCSAgICAgICAgaSA9IDAsCgkJICAgICAgICByZXQgPSAnJywKCQkgICAgICAgIGRhdGEgPSB1bmRlZmluZWQsCgkJICAgICAgICBjb250ZXh0UGF0aCA9IHVuZGVmaW5lZDsKCgkJICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHsKCQkgICAgICBjb250ZXh0UGF0aCA9IF91dGlscy5hcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMuaWRzWzBdKSArICcuJzsKCQkgICAgfQoKCQkgICAgaWYgKF91dGlscy5pc0Z1bmN0aW9uKGNvbnRleHQpKSB7CgkJICAgICAgY29udGV4dCA9IGNvbnRleHQuY2FsbCh0aGlzKTsKCQkgICAgfQoKCQkgICAgaWYgKG9wdGlvbnMuZGF0YSkgewoJCSAgICAgIGRhdGEgPSBfdXRpbHMuY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTsKCQkgICAgfQoKCQkgICAgZnVuY3Rpb24gZXhlY0l0ZXJhdGlvbihmaWVsZCwgaW5kZXgsIGxhc3QpIHsKCQkgICAgICBpZiAoZGF0YSkgewoJCSAgICAgICAgZGF0YS5rZXkgPSBmaWVsZDsKCQkgICAgICAgIGRhdGEuaW5kZXggPSBpbmRleDsKCQkgICAgICAgIGRhdGEuZmlyc3QgPSBpbmRleCA9PT0gMDsKCQkgICAgICAgIGRhdGEubGFzdCA9ICEhbGFzdDsKCgkJICAgICAgICBpZiAoY29udGV4dFBhdGgpIHsKCQkgICAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IGNvbnRleHRQYXRoICsgZmllbGQ7CgkJICAgICAgICB9CgkJICAgICAgfQoKCQkgICAgICByZXQgPSByZXQgKyBmbihjb250ZXh0W2ZpZWxkXSwgewoJCSAgICAgICAgZGF0YTogZGF0YSwKCQkgICAgICAgIGJsb2NrUGFyYW1zOiBfdXRpbHMuYmxvY2tQYXJhbXMoW2NvbnRleHRbZmllbGRdLCBmaWVsZF0sIFtjb250ZXh0UGF0aCArIGZpZWxkLCBudWxsXSkKCQkgICAgICB9KTsKCQkgICAgfQoKCQkgICAgaWYgKGNvbnRleHQgJiYgdHlwZW9mIGNvbnRleHQgPT09ICdvYmplY3QnKSB7CgkJICAgICAgaWYgKF91dGlscy5pc0FycmF5KGNvbnRleHQpKSB7CgkJICAgICAgICBmb3IgKHZhciBqID0gY29udGV4dC5sZW5ndGg7IGkgPCBqOyBpKyspIHsKCQkgICAgICAgICAgaWYgKGkgaW4gY29udGV4dCkgewoJCSAgICAgICAgICAgIGV4ZWNJdGVyYXRpb24oaSwgaSwgaSA9PT0gY29udGV4dC5sZW5ndGggLSAxKTsKCQkgICAgICAgICAgfQoJCSAgICAgICAgfQoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICB2YXIgcHJpb3JLZXkgPSB1bmRlZmluZWQ7CgoJCSAgICAgICAgZm9yICh2YXIga2V5IGluIGNvbnRleHQpIHsKCQkgICAgICAgICAgaWYgKGNvbnRleHQuaGFzT3duUHJvcGVydHkoa2V5KSkgewoJCSAgICAgICAgICAgIC8vIFdlJ3JlIHJ1bm5pbmcgdGhlIGl0ZXJhdGlvbnMgb25lIHN0ZXAgb3V0IG9mIHN5bmMgc28gd2UgY2FuIGRldGVjdAoJCSAgICAgICAgICAgIC8vIHRoZSBsYXN0IGl0ZXJhdGlvbiB3aXRob3V0IGhhdmUgdG8gc2NhbiB0aGUgb2JqZWN0IHR3aWNlIGFuZCBjcmVhdGUKCQkgICAgICAgICAgICAvLyBhbiBpdGVybWVkaWF0ZSBrZXlzIGFycmF5LgoJCSAgICAgICAgICAgIGlmIChwcmlvcktleSAhPT0gdW5kZWZpbmVkKSB7CgkJICAgICAgICAgICAgICBleGVjSXRlcmF0aW9uKHByaW9yS2V5LCBpIC0gMSk7CgkJICAgICAgICAgICAgfQoJCSAgICAgICAgICAgIHByaW9yS2V5ID0ga2V5OwoJCSAgICAgICAgICAgIGkrKzsKCQkgICAgICAgICAgfQoJCSAgICAgICAgfQoJCSAgICAgICAgaWYgKHByaW9yS2V5ICE9PSB1bmRlZmluZWQpIHsKCQkgICAgICAgICAgZXhlY0l0ZXJhdGlvbihwcmlvcktleSwgaSAtIDEsIHRydWUpOwoJCSAgICAgICAgfQoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgaWYgKGkgPT09IDApIHsKCQkgICAgICByZXQgPSBpbnZlcnNlKHRoaXMpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gcmV0OwoJCSAgfSk7CgkJfTsKCgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDEzICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKCQl2YXIgX2V4Y2VwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGNlcHRpb24pOwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHsKCQkgIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdoZWxwZXJNaXNzaW5nJywgZnVuY3Rpb24gKCkgLyogW2FyZ3MsIF1vcHRpb25zICovewoJCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewoJCSAgICAgIC8vIEEgbWlzc2luZyBmaWVsZCBpbiBhIHt7Zm9vfX0gY29uc3RydWN0LgoJCSAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgLy8gU29tZW9uZSBpcyBhY3R1YWxseSB0cnlpbmcgdG8gY2FsbCBzb21ldGhpbmcsIGJsb3cgdXAuCgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ01pc3NpbmcgaGVscGVyOiAiJyArIGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0ubmFtZSArICciJyk7CgkJICAgIH0KCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxNCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgewoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2lmJywgZnVuY3Rpb24gKGNvbmRpdGlvbmFsLCBvcHRpb25zKSB7CgkJICAgIGlmIChfdXRpbHMuaXNGdW5jdGlvbihjb25kaXRpb25hbCkpIHsKCQkgICAgICBjb25kaXRpb25hbCA9IGNvbmRpdGlvbmFsLmNhbGwodGhpcyk7CgkJICAgIH0KCgkJICAgIC8vIERlZmF1bHQgYmVoYXZpb3IgaXMgdG8gcmVuZGVyIHRoZSBwb3NpdGl2ZSBwYXRoIGlmIHRoZSB2YWx1ZSBpcyB0cnV0aHkgYW5kIG5vdCBlbXB0eS4KCQkgICAgLy8gVGhlIGBpbmNsdWRlWmVyb2Agb3B0aW9uIG1heSBiZSBzZXQgdG8gdHJlYXQgdGhlIGNvbmR0aW9uYWwgYXMgcHVyZWx5IG5vdCBlbXB0eSBiYXNlZCBvbiB0aGUKCQkgICAgLy8gYmVoYXZpb3Igb2YgaXNFbXB0eS4gRWZmZWN0aXZlbHkgdGhpcyBkZXRlcm1pbmVzIGlmIDAgaXMgaGFuZGxlZCBieSB0aGUgcG9zaXRpdmUgcGF0aCBvciBuZWdhdGl2ZS4KCQkgICAgaWYgKCFvcHRpb25zLmhhc2guaW5jbHVkZVplcm8gJiYgIWNvbmRpdGlvbmFsIHx8IF91dGlscy5pc0VtcHR5KGNvbmRpdGlvbmFsKSkgewoJCSAgICAgIHJldHVybiBvcHRpb25zLmludmVyc2UodGhpcyk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcmV0dXJuIG9wdGlvbnMuZm4odGhpcyk7CgkJICAgIH0KCQkgIH0pOwoKCQkgIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCd1bmxlc3MnLCBmdW5jdGlvbiAoY29uZGl0aW9uYWwsIG9wdGlvbnMpIHsKCQkgICAgcmV0dXJuIGluc3RhbmNlLmhlbHBlcnNbJ2lmJ10uY2FsbCh0aGlzLCBjb25kaXRpb25hbCwgeyBmbjogb3B0aW9ucy5pbnZlcnNlLCBpbnZlcnNlOiBvcHRpb25zLmZuLCBoYXNoOiBvcHRpb25zLmhhc2ggfSk7CgkJICB9KTsKCQl9OwoKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMTUgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgewoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2xvZycsIGZ1bmN0aW9uICgpIC8qIG1lc3NhZ2UsIG9wdGlvbnMgKi97CgkJICAgIHZhciBhcmdzID0gW3VuZGVmaW5lZF0sCgkJICAgICAgICBvcHRpb25zID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXTsKCQkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoIC0gMTsgaSsrKSB7CgkJICAgICAgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7CgkJICAgIH0KCgkJICAgIHZhciBsZXZlbCA9IDE7CgkJICAgIGlmIChvcHRpb25zLmhhc2gubGV2ZWwgIT0gbnVsbCkgewoJCSAgICAgIGxldmVsID0gb3B0aW9ucy5oYXNoLmxldmVsOwoJCSAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmRhdGEubGV2ZWwgIT0gbnVsbCkgewoJCSAgICAgIGxldmVsID0gb3B0aW9ucy5kYXRhLmxldmVsOwoJCSAgICB9CgkJICAgIGFyZ3NbMF0gPSBsZXZlbDsKCgkJICAgIGluc3RhbmNlLmxvZy5hcHBseShpbnN0YW5jZSwgYXJncyk7CgkJICB9KTsKCQl9OwoKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMTYgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgewoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2xvb2t1cCcsIGZ1bmN0aW9uIChvYmosIGZpZWxkKSB7CgkJICAgIHJldHVybiBvYmogJiYgb2JqW2ZpZWxkXTsKCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxNyAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgewoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ3dpdGgnLCBmdW5jdGlvbiAoY29udGV4dCwgb3B0aW9ucykgewoJCSAgICBpZiAoX3V0aWxzLmlzRnVuY3Rpb24oY29udGV4dCkpIHsKCQkgICAgICBjb250ZXh0ID0gY29udGV4dC5jYWxsKHRoaXMpOwoJCSAgICB9CgoJCSAgICB2YXIgZm4gPSBvcHRpb25zLmZuOwoKCQkgICAgaWYgKCFfdXRpbHMuaXNFbXB0eShjb250ZXh0KSkgewoJCSAgICAgIHZhciBkYXRhID0gb3B0aW9ucy5kYXRhOwoJCSAgICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHsKCQkgICAgICAgIGRhdGEgPSBfdXRpbHMuY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTsKCQkgICAgICAgIGRhdGEuY29udGV4dFBhdGggPSBfdXRpbHMuYXBwZW5kQ29udGV4dFBhdGgob3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoLCBvcHRpb25zLmlkc1swXSk7CgkJICAgICAgfQoKCQkgICAgICByZXR1cm4gZm4oY29udGV4dCwgewoJCSAgICAgICAgZGF0YTogZGF0YSwKCQkgICAgICAgIGJsb2NrUGFyYW1zOiBfdXRpbHMuYmxvY2tQYXJhbXMoW2NvbnRleHRdLCBbZGF0YSAmJiBkYXRhLmNvbnRleHRQYXRoXSkKCQkgICAgICB9KTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICByZXR1cm4gb3B0aW9ucy5pbnZlcnNlKHRoaXMpOwoJCSAgICB9CgkJICB9KTsKCQl9OwoKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMTggKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMucmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9ycyA9IHJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnM7CgoJCXZhciBfZGVjb3JhdG9yc0lubGluZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwoKCQl2YXIgX2RlY29yYXRvcnNJbmxpbmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVjb3JhdG9yc0lubGluZSk7CgoJCWZ1bmN0aW9uIHJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnMoaW5zdGFuY2UpIHsKCQkgIF9kZWNvcmF0b3JzSW5saW5lMlsnZGVmYXVsdCddKGluc3RhbmNlKTsKCQl9CgoJLyoqKi8gfSwKCS8qIDE5ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckRlY29yYXRvcignaW5saW5lJywgZnVuY3Rpb24gKGZuLCBwcm9wcywgY29udGFpbmVyLCBvcHRpb25zKSB7CgkJICAgIHZhciByZXQgPSBmbjsKCQkgICAgaWYgKCFwcm9wcy5wYXJ0aWFscykgewoJCSAgICAgIHByb3BzLnBhcnRpYWxzID0ge307CgkJICAgICAgcmV0ID0gZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMpIHsKCQkgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBwYXJ0aWFscyBzdGFjayBmcmFtZSBwcmlvciB0byBleGVjLgoJCSAgICAgICAgdmFyIG9yaWdpbmFsID0gY29udGFpbmVyLnBhcnRpYWxzOwoJCSAgICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gX3V0aWxzLmV4dGVuZCh7fSwgb3JpZ2luYWwsIHByb3BzLnBhcnRpYWxzKTsKCQkgICAgICAgIHZhciByZXQgPSBmbihjb250ZXh0LCBvcHRpb25zKTsKCQkgICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9yaWdpbmFsOwoJCSAgICAgICAgcmV0dXJuIHJldDsKCQkgICAgICB9OwoJCSAgICB9CgoJCSAgICBwcm9wcy5wYXJ0aWFsc1tvcHRpb25zLmFyZ3NbMF1dID0gb3B0aW9ucy5mbjsKCgkJICAgIHJldHVybiByZXQ7CgkJICB9KTsKCQl9OwoKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMjAgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQl2YXIgbG9nZ2VyID0gewoJCSAgbWV0aG9kTWFwOiBbJ2RlYnVnJywgJ2luZm8nLCAnd2FybicsICdlcnJvciddLAoJCSAgbGV2ZWw6ICdpbmZvJywKCgkJICAvLyBNYXBzIGEgZ2l2ZW4gbGV2ZWwgdmFsdWUgdG8gdGhlIGBtZXRob2RNYXBgIGluZGV4ZXMgYWJvdmUuCgkJICBsb29rdXBMZXZlbDogZnVuY3Rpb24gbG9va3VwTGV2ZWwobGV2ZWwpIHsKCQkgICAgaWYgKHR5cGVvZiBsZXZlbCA9PT0gJ3N0cmluZycpIHsKCQkgICAgICB2YXIgbGV2ZWxNYXAgPSBfdXRpbHMuaW5kZXhPZihsb2dnZXIubWV0aG9kTWFwLCBsZXZlbC50b0xvd2VyQ2FzZSgpKTsKCQkgICAgICBpZiAobGV2ZWxNYXAgPj0gMCkgewoJCSAgICAgICAgbGV2ZWwgPSBsZXZlbE1hcDsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgbGV2ZWwgPSBwYXJzZUludChsZXZlbCwgMTApOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgcmV0dXJuIGxldmVsOwoJCSAgfSwKCgkJICAvLyBDYW4gYmUgb3ZlcnJpZGRlbiBpbiB0aGUgaG9zdCBlbnZpcm9ubWVudAoJCSAgbG9nOiBmdW5jdGlvbiBsb2cobGV2ZWwpIHsKCQkgICAgbGV2ZWwgPSBsb2dnZXIubG9va3VwTGV2ZWwobGV2ZWwpOwoKCQkgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBsb2dnZXIubG9va3VwTGV2ZWwobG9nZ2VyLmxldmVsKSA8PSBsZXZlbCkgewoJCSAgICAgIHZhciBtZXRob2QgPSBsb2dnZXIubWV0aG9kTWFwW2xldmVsXTsKCQkgICAgICBpZiAoIWNvbnNvbGVbbWV0aG9kXSkgewoJCSAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgkJICAgICAgICBtZXRob2QgPSAnbG9nJzsKCQkgICAgICB9CgoJCSAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBtZXNzYWdlID0gQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykgewoJCSAgICAgICAgbWVzc2FnZVtfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07CgkJICAgICAgfQoKCQkgICAgICBjb25zb2xlW21ldGhvZF0uYXBwbHkoY29uc29sZSwgbWVzc2FnZSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZQoJCSAgICB9CgkJICB9CgkJfTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gbG9nZ2VyOwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAyMSAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJCS8vIEJ1aWxkIG91dCBvdXIgYmFzaWMgU2FmZVN0cmluZyB0eXBlCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWZ1bmN0aW9uIFNhZmVTdHJpbmcoc3RyaW5nKSB7CgkJICB0aGlzLnN0cmluZyA9IHN0cmluZzsKCQl9CgoJCVNhZmVTdHJpbmcucHJvdG90eXBlLnRvU3RyaW5nID0gU2FmZVN0cmluZy5wcm90b3R5cGUudG9IVE1MID0gZnVuY3Rpb24gKCkgewoJCSAgcmV0dXJuICcnICsgdGhpcy5zdHJpbmc7CgkJfTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gU2FmZVN0cmluZzsKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMjIgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCA9IF9fd2VicGFja19yZXF1aXJlX18oMylbJ2RlZmF1bHQnXTsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZXhwb3J0cy5jaGVja1JldmlzaW9uID0gY2hlY2tSZXZpc2lvbjsKCQlleHBvcnRzLnRlbXBsYXRlID0gdGVtcGxhdGU7CgkJZXhwb3J0cy53cmFwUHJvZ3JhbSA9IHdyYXBQcm9ncmFtOwoJCWV4cG9ydHMucmVzb2x2ZVBhcnRpYWwgPSByZXNvbHZlUGFydGlhbDsKCQlleHBvcnRzLmludm9rZVBhcnRpYWwgPSBpbnZva2VQYXJ0aWFsOwoJCWV4cG9ydHMubm9vcCA9IG5vb3A7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQl2YXIgVXRpbHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHMpOwoKCQl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7CgoJCXZhciBfYmFzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7CgoJCWZ1bmN0aW9uIGNoZWNrUmV2aXNpb24oY29tcGlsZXJJbmZvKSB7CgkJICB2YXIgY29tcGlsZXJSZXZpc2lvbiA9IGNvbXBpbGVySW5mbyAmJiBjb21waWxlckluZm9bMF0gfHwgMSwKCQkgICAgICBjdXJyZW50UmV2aXNpb24gPSBfYmFzZS5DT01QSUxFUl9SRVZJU0lPTjsKCgkJICBpZiAoY29tcGlsZXJSZXZpc2lvbiAhPT0gY3VycmVudFJldmlzaW9uKSB7CgkJICAgIGlmIChjb21waWxlclJldmlzaW9uIDwgY3VycmVudFJldmlzaW9uKSB7CgkJICAgICAgdmFyIHJ1bnRpbWVWZXJzaW9ucyA9IF9iYXNlLlJFVklTSU9OX0NIQU5HRVNbY3VycmVudFJldmlzaW9uXSwKCQkgICAgICAgICAgY29tcGlsZXJWZXJzaW9ucyA9IF9iYXNlLlJFVklTSU9OX0NIQU5HRVNbY29tcGlsZXJSZXZpc2lvbl07CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1RlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGFuIG9sZGVyIHZlcnNpb24gb2YgSGFuZGxlYmFycyB0aGFuIHRoZSBjdXJyZW50IHJ1bnRpbWUuICcgKyAnUGxlYXNlIHVwZGF0ZSB5b3VyIHByZWNvbXBpbGVyIHRvIGEgbmV3ZXIgdmVyc2lvbiAoJyArIHJ1bnRpbWVWZXJzaW9ucyArICcpIG9yIGRvd25ncmFkZSB5b3VyIHJ1bnRpbWUgdG8gYW4gb2xkZXIgdmVyc2lvbiAoJyArIGNvbXBpbGVyVmVyc2lvbnMgKyAnKS4nKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICAvLyBVc2UgdGhlIGVtYmVkZGVkIHZlcnNpb24gaW5mbyBzaW5jZSB0aGUgcnVudGltZSBkb2Vzbid0IGtub3cgYWJvdXQgdGhpcyByZXZpc2lvbiB5ZXQKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVGVtcGxhdGUgd2FzIHByZWNvbXBpbGVkIHdpdGggYSBuZXdlciB2ZXJzaW9uIG9mIEhhbmRsZWJhcnMgdGhhbiB0aGUgY3VycmVudCBydW50aW1lLiAnICsgJ1BsZWFzZSB1cGRhdGUgeW91ciBydW50aW1lIHRvIGEgbmV3ZXIgdmVyc2lvbiAoJyArIGNvbXBpbGVySW5mb1sxXSArICcpLicpOwoJCSAgICB9CgkJICB9CgkJfQoKCQlmdW5jdGlvbiB0ZW1wbGF0ZSh0ZW1wbGF0ZVNwZWMsIGVudikgewoJCSAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQkgIGlmICghZW52KSB7CgkJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdObyBlbnZpcm9ubWVudCBwYXNzZWQgdG8gdGVtcGxhdGUnKTsKCQkgIH0KCQkgIGlmICghdGVtcGxhdGVTcGVjIHx8ICF0ZW1wbGF0ZVNwZWMubWFpbikgewoJCSAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVW5rbm93biB0ZW1wbGF0ZSBvYmplY3Q6ICcgKyB0eXBlb2YgdGVtcGxhdGVTcGVjKTsKCQkgIH0KCgkJICB0ZW1wbGF0ZVNwZWMubWFpbi5kZWNvcmF0b3IgPSB0ZW1wbGF0ZVNwZWMubWFpbl9kOwoKCQkgIC8vIE5vdGU6IFVzaW5nIGVudi5WTSByZWZlcmVuY2VzIHJhdGhlciB0aGFuIGxvY2FsIHZhciByZWZlcmVuY2VzIHRocm91Z2hvdXQgdGhpcyBzZWN0aW9uIHRvIGFsbG93CgkJICAvLyBmb3IgZXh0ZXJuYWwgdXNlcnMgdG8gb3ZlcnJpZGUgdGhlc2UgYXMgcHN1ZWRvLXN1cHBvcnRlZCBBUElzLgoJCSAgZW52LlZNLmNoZWNrUmV2aXNpb24odGVtcGxhdGVTcGVjLmNvbXBpbGVyKTsKCgkJICBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsV3JhcHBlcihwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKSB7CgkJICAgIGlmIChvcHRpb25zLmhhc2gpIHsKCQkgICAgICBjb250ZXh0ID0gVXRpbHMuZXh0ZW5kKHt9LCBjb250ZXh0LCBvcHRpb25zLmhhc2gpOwoJCSAgICAgIGlmIChvcHRpb25zLmlkcykgewoJCSAgICAgICAgb3B0aW9ucy5pZHNbMF0gPSB0cnVlOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgcGFydGlhbCA9IGVudi5WTS5yZXNvbHZlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpOwoJCSAgICB2YXIgcmVzdWx0ID0gZW52LlZNLmludm9rZVBhcnRpYWwuY2FsbCh0aGlzLCBwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKTsKCgkJICAgIGlmIChyZXN1bHQgPT0gbnVsbCAmJiBlbnYuY29tcGlsZSkgewoJCSAgICAgIG9wdGlvbnMucGFydGlhbHNbb3B0aW9ucy5uYW1lXSA9IGVudi5jb21waWxlKHBhcnRpYWwsIHRlbXBsYXRlU3BlYy5jb21waWxlck9wdGlvbnMsIGVudik7CgkJICAgICAgcmVzdWx0ID0gb3B0aW9ucy5wYXJ0aWFsc1tvcHRpb25zLm5hbWVdKGNvbnRleHQsIG9wdGlvbnMpOwoJCSAgICB9CgkJICAgIGlmIChyZXN1bHQgIT0gbnVsbCkgewoJCSAgICAgIGlmIChvcHRpb25zLmluZGVudCkgewoJCSAgICAgICAgdmFyIGxpbmVzID0gcmVzdWx0LnNwbGl0KCdcbicpOwoJCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBsaW5lcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCQkgICAgICAgICAgaWYgKCFsaW5lc1tpXSAmJiBpICsgMSA9PT0gbCkgewoJCSAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICB9CgoJCSAgICAgICAgICBsaW5lc1tpXSA9IG9wdGlvbnMuaW5kZW50ICsgbGluZXNbaV07CgkJICAgICAgICB9CgkJICAgICAgICByZXN1bHQgPSBsaW5lcy5qb2luKCdcbicpOwoJCSAgICAgIH0KCQkgICAgICByZXR1cm4gcmVzdWx0OwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdUaGUgcGFydGlhbCAnICsgb3B0aW9ucy5uYW1lICsgJyBjb3VsZCBub3QgYmUgY29tcGlsZWQgd2hlbiBydW5uaW5nIGluIHJ1bnRpbWUtb25seSBtb2RlJyk7CgkJICAgIH0KCQkgIH0KCgkJICAvLyBKdXN0IGFkZCB3YXRlcgoJCSAgdmFyIGNvbnRhaW5lciA9IHsKCQkgICAgc3RyaWN0OiBmdW5jdGlvbiBzdHJpY3Qob2JqLCBuYW1lKSB7CgkJICAgICAgaWYgKCEobmFtZSBpbiBvYmopKSB7CgkJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnIicgKyBuYW1lICsgJyIgbm90IGRlZmluZWQgaW4gJyArIG9iaik7CgkJICAgICAgfQoJCSAgICAgIHJldHVybiBvYmpbbmFtZV07CgkJICAgIH0sCgkJICAgIGxvb2t1cDogZnVuY3Rpb24gbG9va3VwKGRlcHRocywgbmFtZSkgewoJCSAgICAgIHZhciBsZW4gPSBkZXB0aHMubGVuZ3RoOwoJCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICAgIGlmIChkZXB0aHNbaV0gJiYgZGVwdGhzW2ldW25hbWVdICE9IG51bGwpIHsKCQkgICAgICAgICAgcmV0dXJuIGRlcHRoc1tpXVtuYW1lXTsKCQkgICAgICAgIH0KCQkgICAgICB9CgkJICAgIH0sCgkJICAgIGxhbWJkYTogZnVuY3Rpb24gbGFtYmRhKGN1cnJlbnQsIGNvbnRleHQpIHsKCQkgICAgICByZXR1cm4gdHlwZW9mIGN1cnJlbnQgPT09ICdmdW5jdGlvbicgPyBjdXJyZW50LmNhbGwoY29udGV4dCkgOiBjdXJyZW50OwoJCSAgICB9LAoKCQkgICAgZXNjYXBlRXhwcmVzc2lvbjogVXRpbHMuZXNjYXBlRXhwcmVzc2lvbiwKCQkgICAgaW52b2tlUGFydGlhbDogaW52b2tlUGFydGlhbFdyYXBwZXIsCgoJCSAgICBmbjogZnVuY3Rpb24gZm4oaSkgewoJCSAgICAgIHZhciByZXQgPSB0ZW1wbGF0ZVNwZWNbaV07CgkJICAgICAgcmV0LmRlY29yYXRvciA9IHRlbXBsYXRlU3BlY1tpICsgJ19kJ107CgkJICAgICAgcmV0dXJuIHJldDsKCQkgICAgfSwKCgkJICAgIHByb2dyYW1zOiBbXSwKCQkgICAgcHJvZ3JhbTogZnVuY3Rpb24gcHJvZ3JhbShpLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7CgkJICAgICAgdmFyIHByb2dyYW1XcmFwcGVyID0gdGhpcy5wcm9ncmFtc1tpXSwKCQkgICAgICAgICAgZm4gPSB0aGlzLmZuKGkpOwoJCSAgICAgIGlmIChkYXRhIHx8IGRlcHRocyB8fCBibG9ja1BhcmFtcyB8fCBkZWNsYXJlZEJsb2NrUGFyYW1zKSB7CgkJICAgICAgICBwcm9ncmFtV3JhcHBlciA9IHdyYXBQcm9ncmFtKHRoaXMsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKTsKCQkgICAgICB9IGVsc2UgaWYgKCFwcm9ncmFtV3JhcHBlcikgewoJCSAgICAgICAgcHJvZ3JhbVdyYXBwZXIgPSB0aGlzLnByb2dyYW1zW2ldID0gd3JhcFByb2dyYW0odGhpcywgaSwgZm4pOwoJCSAgICAgIH0KCQkgICAgICByZXR1cm4gcHJvZ3JhbVdyYXBwZXI7CgkJICAgIH0sCgoJCSAgICBkYXRhOiBmdW5jdGlvbiBkYXRhKHZhbHVlLCBkZXB0aCkgewoJCSAgICAgIHdoaWxlICh2YWx1ZSAmJiBkZXB0aC0tKSB7CgkJICAgICAgICB2YWx1ZSA9IHZhbHVlLl9wYXJlbnQ7CgkJICAgICAgfQoJCSAgICAgIHJldHVybiB2YWx1ZTsKCQkgICAgfSwKCQkgICAgbWVyZ2U6IGZ1bmN0aW9uIG1lcmdlKHBhcmFtLCBjb21tb24pIHsKCQkgICAgICB2YXIgb2JqID0gcGFyYW0gfHwgY29tbW9uOwoKCQkgICAgICBpZiAocGFyYW0gJiYgY29tbW9uICYmIHBhcmFtICE9PSBjb21tb24pIHsKCQkgICAgICAgIG9iaiA9IFV0aWxzLmV4dGVuZCh7fSwgY29tbW9uLCBwYXJhbSk7CgkJICAgICAgfQoKCQkgICAgICByZXR1cm4gb2JqOwoJCSAgICB9LAoKCQkgICAgbm9vcDogZW52LlZNLm5vb3AsCgkJICAgIGNvbXBpbGVySW5mbzogdGVtcGxhdGVTcGVjLmNvbXBpbGVyCgkJICB9OwoKCQkgIGZ1bmN0aW9uIHJldChjb250ZXh0KSB7CgkJICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07CgoJCSAgICB2YXIgZGF0YSA9IG9wdGlvbnMuZGF0YTsKCgkJICAgIHJldC5fc2V0dXAob3B0aW9ucyk7CgkJICAgIGlmICghb3B0aW9ucy5wYXJ0aWFsICYmIHRlbXBsYXRlU3BlYy51c2VEYXRhKSB7CgkJICAgICAgZGF0YSA9IGluaXREYXRhKGNvbnRleHQsIGRhdGEpOwoJCSAgICB9CgkJICAgIHZhciBkZXB0aHMgPSB1bmRlZmluZWQsCgkJICAgICAgICBibG9ja1BhcmFtcyA9IHRlbXBsYXRlU3BlYy51c2VCbG9ja1BhcmFtcyA/IFtdIDogdW5kZWZpbmVkOwoJCSAgICBpZiAodGVtcGxhdGVTcGVjLnVzZURlcHRocykgewoJCSAgICAgIGlmIChvcHRpb25zLmRlcHRocykgewoJCSAgICAgICAgZGVwdGhzID0gY29udGV4dCAhPSBvcHRpb25zLmRlcHRoc1swXSA/IFtjb250ZXh0XS5jb25jYXQob3B0aW9ucy5kZXB0aHMpIDogb3B0aW9ucy5kZXB0aHM7CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIGRlcHRocyA9IFtjb250ZXh0XTsKCQkgICAgICB9CgkJICAgIH0KCgkJICAgIGZ1bmN0aW9uIG1haW4oY29udGV4dCAvKiwgb3B0aW9ucyovKSB7CgkJICAgICAgcmV0dXJuICcnICsgdGVtcGxhdGVTcGVjLm1haW4oY29udGFpbmVyLCBjb250ZXh0LCBjb250YWluZXIuaGVscGVycywgY29udGFpbmVyLnBhcnRpYWxzLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKTsKCQkgICAgfQoJCSAgICBtYWluID0gZXhlY3V0ZURlY29yYXRvcnModGVtcGxhdGVTcGVjLm1haW4sIG1haW4sIGNvbnRhaW5lciwgb3B0aW9ucy5kZXB0aHMgfHwgW10sIGRhdGEsIGJsb2NrUGFyYW1zKTsKCQkgICAgcmV0dXJuIG1haW4oY29udGV4dCwgb3B0aW9ucyk7CgkJICB9CgkJICByZXQuaXNUb3AgPSB0cnVlOwoKCQkgIHJldC5fc2V0dXAgPSBmdW5jdGlvbiAob3B0aW9ucykgewoJCSAgICBpZiAoIW9wdGlvbnMucGFydGlhbCkgewoJCSAgICAgIGNvbnRhaW5lci5oZWxwZXJzID0gY29udGFpbmVyLm1lcmdlKG9wdGlvbnMuaGVscGVycywgZW52LmhlbHBlcnMpOwoKCQkgICAgICBpZiAodGVtcGxhdGVTcGVjLnVzZVBhcnRpYWwpIHsKCQkgICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLnBhcnRpYWxzLCBlbnYucGFydGlhbHMpOwoJCSAgICAgIH0KCQkgICAgICBpZiAodGVtcGxhdGVTcGVjLnVzZVBhcnRpYWwgfHwgdGVtcGxhdGVTcGVjLnVzZURlY29yYXRvcnMpIHsKCQkgICAgICAgIGNvbnRhaW5lci5kZWNvcmF0b3JzID0gY29udGFpbmVyLm1lcmdlKG9wdGlvbnMuZGVjb3JhdG9ycywgZW52LmRlY29yYXRvcnMpOwoJCSAgICAgIH0KCQkgICAgfSBlbHNlIHsKCQkgICAgICBjb250YWluZXIuaGVscGVycyA9IG9wdGlvbnMuaGVscGVyczsKCQkgICAgICBjb250YWluZXIucGFydGlhbHMgPSBvcHRpb25zLnBhcnRpYWxzOwoJCSAgICAgIGNvbnRhaW5lci5kZWNvcmF0b3JzID0gb3B0aW9ucy5kZWNvcmF0b3JzOwoJCSAgICB9CgkJICB9OwoKCQkgIHJldC5fY2hpbGQgPSBmdW5jdGlvbiAoaSwgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocykgewoJCSAgICBpZiAodGVtcGxhdGVTcGVjLnVzZUJsb2NrUGFyYW1zICYmICFibG9ja1BhcmFtcykgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdtdXN0IHBhc3MgYmxvY2sgcGFyYW1zJyk7CgkJICAgIH0KCQkgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VEZXB0aHMgJiYgIWRlcHRocykgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdtdXN0IHBhc3MgcGFyZW50IGRlcHRocycpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gd3JhcFByb2dyYW0oY29udGFpbmVyLCBpLCB0ZW1wbGF0ZVNwZWNbaV0sIGRhdGEsIDAsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOwoJCSAgfTsKCQkgIHJldHVybiByZXQ7CgkJfQoKCQlmdW5jdGlvbiB3cmFwUHJvZ3JhbShjb250YWluZXIsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7CgkJICBmdW5jdGlvbiBwcm9nKGNvbnRleHQpIHsKCQkgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTsKCgkJICAgIHZhciBjdXJyZW50RGVwdGhzID0gZGVwdGhzOwoJCSAgICBpZiAoZGVwdGhzICYmIGNvbnRleHQgIT0gZGVwdGhzWzBdKSB7CgkJICAgICAgY3VycmVudERlcHRocyA9IFtjb250ZXh0XS5jb25jYXQoZGVwdGhzKTsKCQkgICAgfQoKCQkgICAgcmV0dXJuIGZuKGNvbnRhaW5lciwgY29udGV4dCwgY29udGFpbmVyLmhlbHBlcnMsIGNvbnRhaW5lci5wYXJ0aWFscywgb3B0aW9ucy5kYXRhIHx8IGRhdGEsIGJsb2NrUGFyYW1zICYmIFtvcHRpb25zLmJsb2NrUGFyYW1zXS5jb25jYXQoYmxvY2tQYXJhbXMpLCBjdXJyZW50RGVwdGhzKTsKCQkgIH0KCgkJICBwcm9nID0gZXhlY3V0ZURlY29yYXRvcnMoZm4sIHByb2csIGNvbnRhaW5lciwgZGVwdGhzLCBkYXRhLCBibG9ja1BhcmFtcyk7CgoJCSAgcHJvZy5wcm9ncmFtID0gaTsKCQkgIHByb2cuZGVwdGggPSBkZXB0aHMgPyBkZXB0aHMubGVuZ3RoIDogMDsKCQkgIHByb2cuYmxvY2tQYXJhbXMgPSBkZWNsYXJlZEJsb2NrUGFyYW1zIHx8IDA7CgkJICByZXR1cm4gcHJvZzsKCQl9CgoJCWZ1bmN0aW9uIHJlc29sdmVQYXJ0aWFsKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHsKCQkgIGlmICghcGFydGlhbCkgewoJCSAgICBpZiAob3B0aW9ucy5uYW1lID09PSAnQHBhcnRpYWwtYmxvY2snKSB7CgkJICAgICAgdmFyIGRhdGEgPSBvcHRpb25zLmRhdGE7CgkJICAgICAgd2hpbGUgKGRhdGFbJ3BhcnRpYWwtYmxvY2snXSA9PT0gbm9vcCkgewoJCSAgICAgICAgZGF0YSA9IGRhdGEuX3BhcmVudDsKCQkgICAgICB9CgkJICAgICAgcGFydGlhbCA9IGRhdGFbJ3BhcnRpYWwtYmxvY2snXTsKCQkgICAgICBkYXRhWydwYXJ0aWFsLWJsb2NrJ10gPSBub29wOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHBhcnRpYWwgPSBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV07CgkJICAgIH0KCQkgIH0gZWxzZSBpZiAoIXBhcnRpYWwuY2FsbCAmJiAhb3B0aW9ucy5uYW1lKSB7CgkJICAgIC8vIFRoaXMgaXMgYSBkeW5hbWljIHBhcnRpYWwgdGhhdCByZXR1cm5lZCBhIHN0cmluZwoJCSAgICBvcHRpb25zLm5hbWUgPSBwYXJ0aWFsOwoJCSAgICBwYXJ0aWFsID0gb3B0aW9ucy5wYXJ0aWFsc1twYXJ0aWFsXTsKCQkgIH0KCQkgIHJldHVybiBwYXJ0aWFsOwoJCX0KCgkJZnVuY3Rpb24gaW52b2tlUGFydGlhbChwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKSB7CgkJICBvcHRpb25zLnBhcnRpYWwgPSB0cnVlOwoJCSAgaWYgKG9wdGlvbnMuaWRzKSB7CgkJICAgIG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCA9IG9wdGlvbnMuaWRzWzBdIHx8IG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aDsKCQkgIH0KCgkJICB2YXIgcGFydGlhbEJsb2NrID0gdW5kZWZpbmVkOwoJCSAgaWYgKG9wdGlvbnMuZm4gJiYgb3B0aW9ucy5mbiAhPT0gbm9vcCkgewoJCSAgICBvcHRpb25zLmRhdGEgPSBfYmFzZS5jcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpOwoJCSAgICBwYXJ0aWFsQmxvY2sgPSBvcHRpb25zLmRhdGFbJ3BhcnRpYWwtYmxvY2snXSA9IG9wdGlvbnMuZm47CgoJCSAgICBpZiAocGFydGlhbEJsb2NrLnBhcnRpYWxzKSB7CgkJICAgICAgb3B0aW9ucy5wYXJ0aWFscyA9IFV0aWxzLmV4dGVuZCh7fSwgb3B0aW9ucy5wYXJ0aWFscywgcGFydGlhbEJsb2NrLnBhcnRpYWxzKTsKCQkgICAgfQoJCSAgfQoKCQkgIGlmIChwYXJ0aWFsID09PSB1bmRlZmluZWQgJiYgcGFydGlhbEJsb2NrKSB7CgkJICAgIHBhcnRpYWwgPSBwYXJ0aWFsQmxvY2s7CgkJICB9CgoJCSAgaWYgKHBhcnRpYWwgPT09IHVuZGVmaW5lZCkgewoJCSAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVGhlIHBhcnRpYWwgJyArIG9wdGlvbnMubmFtZSArICcgY291bGQgbm90IGJlIGZvdW5kJyk7CgkJICB9IGVsc2UgaWYgKHBhcnRpYWwgaW5zdGFuY2VvZiBGdW5jdGlvbikgewoJCSAgICByZXR1cm4gcGFydGlhbChjb250ZXh0LCBvcHRpb25zKTsKCQkgIH0KCQl9CgoJCWZ1bmN0aW9uIG5vb3AoKSB7CgkJICByZXR1cm4gJyc7CgkJfQoKCQlmdW5jdGlvbiBpbml0RGF0YShjb250ZXh0LCBkYXRhKSB7CgkJICBpZiAoIWRhdGEgfHwgISgncm9vdCcgaW4gZGF0YSkpIHsKCQkgICAgZGF0YSA9IGRhdGEgPyBfYmFzZS5jcmVhdGVGcmFtZShkYXRhKSA6IHt9OwoJCSAgICBkYXRhLnJvb3QgPSBjb250ZXh0OwoJCSAgfQoJCSAgcmV0dXJuIGRhdGE7CgkJfQoKCQlmdW5jdGlvbiBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKSB7CgkJICBpZiAoZm4uZGVjb3JhdG9yKSB7CgkJICAgIHZhciBwcm9wcyA9IHt9OwoJCSAgICBwcm9nID0gZm4uZGVjb3JhdG9yKHByb2csIHByb3BzLCBjb250YWluZXIsIGRlcHRocyAmJiBkZXB0aHNbMF0sIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOwoJCSAgICBVdGlscy5leHRlbmQocHJvZywgcHJvcHMpOwoJCSAgfQoJCSAgcmV0dXJuIHByb2c7CgkJfQoKCS8qKiovIH0sCgkvKiAyMyAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvKiBnbG9iYWwgd2luZG93ICovCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAoSGFuZGxlYmFycykgewoJCSAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQkgIHZhciByb290ID0gdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB3aW5kb3csCgkJICAgICAgJEhhbmRsZWJhcnMgPSByb290LkhhbmRsZWJhcnM7CgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgSGFuZGxlYmFycy5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkgewoJCSAgICBpZiAocm9vdC5IYW5kbGViYXJzID09PSBIYW5kbGViYXJzKSB7CgkJICAgICAgcm9vdC5IYW5kbGViYXJzID0gJEhhbmRsZWJhcnM7CgkJICAgIH0KCQkgICAgcmV0dXJuIEhhbmRsZWJhcnM7CgkJICB9OwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoJCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCgkvKioqLyB9LAoJLyogMjQgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJdmFyIEFTVCA9IHsKCQkgIC8vIFB1YmxpYyBBUEkgdXNlZCB0byBldmFsdWF0ZSBkZXJpdmVkIGF0dHJpYnV0ZXMgcmVnYXJkaW5nIEFTVCBub2RlcwoJCSAgaGVscGVyczogewoJCSAgICAvLyBhIG11c3RhY2hlIGlzIGRlZmluaXRlbHkgYSBoZWxwZXIgaWY6CgkJICAgIC8vICogaXQgaXMgYW4gZWxpZ2libGUgaGVscGVyLCBhbmQKCQkgICAgLy8gKiBpdCBoYXMgYXQgbGVhc3Qgb25lIHBhcmFtZXRlciBvciBoYXNoIHNlZ21lbnQKCQkgICAgaGVscGVyRXhwcmVzc2lvbjogZnVuY3Rpb24gaGVscGVyRXhwcmVzc2lvbihub2RlKSB7CgkJICAgICAgcmV0dXJuIG5vZGUudHlwZSA9PT0gJ1N1YkV4cHJlc3Npb24nIHx8IChub2RlLnR5cGUgPT09ICdNdXN0YWNoZVN0YXRlbWVudCcgfHwgbm9kZS50eXBlID09PSAnQmxvY2tTdGF0ZW1lbnQnKSAmJiAhIShub2RlLnBhcmFtcyAmJiBub2RlLnBhcmFtcy5sZW5ndGggfHwgbm9kZS5oYXNoKTsKCQkgICAgfSwKCgkJICAgIHNjb3BlZElkOiBmdW5jdGlvbiBzY29wZWRJZChwYXRoKSB7CgkJICAgICAgcmV0dXJuICgvXlwufHRoaXNcYi8udGVzdChwYXRoLm9yaWdpbmFsKQoJCSAgICAgICk7CgkJICAgIH0sCgoJCSAgICAvLyBhbiBJRCBpcyBzaW1wbGUgaWYgaXQgb25seSBoYXMgb25lIHBhcnQsIGFuZCB0aGF0IHBhcnQgaXMgbm90CgkJICAgIC8vIGAuLmAgb3IgYHRoaXNgLgoJCSAgICBzaW1wbGVJZDogZnVuY3Rpb24gc2ltcGxlSWQocGF0aCkgewoJCSAgICAgIHJldHVybiBwYXRoLnBhcnRzLmxlbmd0aCA9PT0gMSAmJiAhQVNULmhlbHBlcnMuc2NvcGVkSWQocGF0aCkgJiYgIXBhdGguZGVwdGg7CgkJICAgIH0KCQkgIH0KCQl9OwoKCQkvLyBNdXN0IGJlIGV4cG9ydGVkIGFzIGFuIG9iamVjdCByYXRoZXIgdGhhbiB0aGUgcm9vdCBvZiB0aGUgbW9kdWxlIGFzIHRoZSBqaXNvbiBsZXhlcgoJCS8vIG11c3QgbW9kaWZ5IHRoZSBvYmplY3QgdG8gb3BlcmF0ZSBwcm9wZXJseS4KCQlleHBvcnRzWydkZWZhdWx0J10gPSBBU1Q7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDI1ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMucGFyc2UgPSBwYXJzZTsKCgkJdmFyIF9wYXJzZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTsKCgkJdmFyIF9wYXJzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGFyc2VyKTsKCgkJdmFyIF93aGl0ZXNwYWNlQ29udHJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpOwoKCQl2YXIgX3doaXRlc3BhY2VDb250cm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3doaXRlc3BhY2VDb250cm9sKTsKCgkJdmFyIF9oZWxwZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7CgoJCXZhciBIZWxwZXJzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2hlbHBlcnMpOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJZXhwb3J0cy5wYXJzZXIgPSBfcGFyc2VyMlsnZGVmYXVsdCddOwoKCQl2YXIgeXkgPSB7fTsKCQlfdXRpbHMuZXh0ZW5kKHl5LCBIZWxwZXJzKTsKCgkJZnVuY3Rpb24gcGFyc2UoaW5wdXQsIG9wdGlvbnMpIHsKCQkgIC8vIEp1c3QgcmV0dXJuIGlmIGFuIGFscmVhZHktY29tcGlsZWQgQVNUIHdhcyBwYXNzZWQgaW4uCgkJICBpZiAoaW5wdXQudHlwZSA9PT0gJ1Byb2dyYW0nKSB7CgkJICAgIHJldHVybiBpbnB1dDsKCQkgIH0KCgkJICBfcGFyc2VyMlsnZGVmYXVsdCddLnl5ID0geXk7CgoJCSAgLy8gQWx0ZXJpbmcgdGhlIHNoYXJlZCBvYmplY3QgaGVyZSwgYnV0IHRoaXMgaXMgb2sgYXMgcGFyc2VyIGlzIGEgc3luYyBvcGVyYXRpb24KCQkgIHl5LmxvY0luZm8gPSBmdW5jdGlvbiAobG9jSW5mbykgewoJCSAgICByZXR1cm4gbmV3IHl5LlNvdXJjZUxvY2F0aW9uKG9wdGlvbnMgJiYgb3B0aW9ucy5zcmNOYW1lLCBsb2NJbmZvKTsKCQkgIH07CgoJCSAgdmFyIHN0cmlwID0gbmV3IF93aGl0ZXNwYWNlQ29udHJvbDJbJ2RlZmF1bHQnXShvcHRpb25zKTsKCQkgIHJldHVybiBzdHJpcC5hY2NlcHQoX3BhcnNlcjJbJ2RlZmF1bHQnXS5wYXJzZShpbnB1dCkpOwoJCX0KCgkvKioqLyB9LAoJLyogMjYgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCS8qIEppc29uIGdlbmVyYXRlZCBwYXJzZXIgKi8KCQkidXNlIHN0cmljdCI7CgoJCXZhciBoYW5kbGViYXJzID0gKGZ1bmN0aW9uICgpIHsKCQkgICAgdmFyIHBhcnNlciA9IHsgdHJhY2U6IGZ1bmN0aW9uIHRyYWNlKCkge30sCgkJICAgICAgICB5eToge30sCgkJICAgICAgICBzeW1ib2xzXzogeyAiZXJyb3IiOiAyLCAicm9vdCI6IDMsICJwcm9ncmFtIjogNCwgIkVPRiI6IDUsICJwcm9ncmFtX3JlcGV0aXRpb24wIjogNiwgInN0YXRlbWVudCI6IDcsICJtdXN0YWNoZSI6IDgsICJibG9jayI6IDksICJyYXdCbG9jayI6IDEwLCAicGFydGlhbCI6IDExLCAicGFydGlhbEJsb2NrIjogMTIsICJjb250ZW50IjogMTMsICJDT01NRU5UIjogMTQsICJDT05URU5UIjogMTUsICJvcGVuUmF3QmxvY2siOiAxNiwgInJhd0Jsb2NrX3JlcGV0aXRpb25fcGx1czAiOiAxNywgIkVORF9SQVdfQkxPQ0siOiAxOCwgIk9QRU5fUkFXX0JMT0NLIjogMTksICJoZWxwZXJOYW1lIjogMjAsICJvcGVuUmF3QmxvY2tfcmVwZXRpdGlvbjAiOiAyMSwgIm9wZW5SYXdCbG9ja19vcHRpb24wIjogMjIsICJDTE9TRV9SQVdfQkxPQ0siOiAyMywgIm9wZW5CbG9jayI6IDI0LCAiYmxvY2tfb3B0aW9uMCI6IDI1LCAiY2xvc2VCbG9jayI6IDI2LCAib3BlbkludmVyc2UiOiAyNywgImJsb2NrX29wdGlvbjEiOiAyOCwgIk9QRU5fQkxPQ0siOiAyOSwgIm9wZW5CbG9ja19yZXBldGl0aW9uMCI6IDMwLCAib3BlbkJsb2NrX29wdGlvbjAiOiAzMSwgIm9wZW5CbG9ja19vcHRpb24xIjogMzIsICJDTE9TRSI6IDMzLCAiT1BFTl9JTlZFUlNFIjogMzQsICJvcGVuSW52ZXJzZV9yZXBldGl0aW9uMCI6IDM1LCAib3BlbkludmVyc2Vfb3B0aW9uMCI6IDM2LCAib3BlbkludmVyc2Vfb3B0aW9uMSI6IDM3LCAib3BlbkludmVyc2VDaGFpbiI6IDM4LCAiT1BFTl9JTlZFUlNFX0NIQUlOIjogMzksICJvcGVuSW52ZXJzZUNoYWluX3JlcGV0aXRpb24wIjogNDAsICJvcGVuSW52ZXJzZUNoYWluX29wdGlvbjAiOiA0MSwgIm9wZW5JbnZlcnNlQ2hhaW5fb3B0aW9uMSI6IDQyLCAiaW52ZXJzZUFuZFByb2dyYW0iOiA0MywgIklOVkVSU0UiOiA0NCwgImludmVyc2VDaGFpbiI6IDQ1LCAiaW52ZXJzZUNoYWluX29wdGlvbjAiOiA0NiwgIk9QRU5fRU5EQkxPQ0siOiA0NywgIk9QRU4iOiA0OCwgIm11c3RhY2hlX3JlcGV0aXRpb24wIjogNDksICJtdXN0YWNoZV9vcHRpb24wIjogNTAsICJPUEVOX1VORVNDQVBFRCI6IDUxLCAibXVzdGFjaGVfcmVwZXRpdGlvbjEiOiA1MiwgIm11c3RhY2hlX29wdGlvbjEiOiA1MywgIkNMT1NFX1VORVNDQVBFRCI6IDU0LCAiT1BFTl9QQVJUSUFMIjogNTUsICJwYXJ0aWFsTmFtZSI6IDU2LCAicGFydGlhbF9yZXBldGl0aW9uMCI6IDU3LCAicGFydGlhbF9vcHRpb24wIjogNTgsICJvcGVuUGFydGlhbEJsb2NrIjogNTksICJPUEVOX1BBUlRJQUxfQkxPQ0siOiA2MCwgIm9wZW5QYXJ0aWFsQmxvY2tfcmVwZXRpdGlvbjAiOiA2MSwgIm9wZW5QYXJ0aWFsQmxvY2tfb3B0aW9uMCI6IDYyLCAicGFyYW0iOiA2MywgInNleHByIjogNjQsICJPUEVOX1NFWFBSIjogNjUsICJzZXhwcl9yZXBldGl0aW9uMCI6IDY2LCAic2V4cHJfb3B0aW9uMCI6IDY3LCAiQ0xPU0VfU0VYUFIiOiA2OCwgImhhc2giOiA2OSwgImhhc2hfcmVwZXRpdGlvbl9wbHVzMCI6IDcwLCAiaGFzaFNlZ21lbnQiOiA3MSwgIklEIjogNzIsICJFUVVBTFMiOiA3MywgImJsb2NrUGFyYW1zIjogNzQsICJPUEVOX0JMT0NLX1BBUkFNUyI6IDc1LCAiYmxvY2tQYXJhbXNfcmVwZXRpdGlvbl9wbHVzMCI6IDc2LCAiQ0xPU0VfQkxPQ0tfUEFSQU1TIjogNzcsICJwYXRoIjogNzgsICJkYXRhTmFtZSI6IDc5LCAiU1RSSU5HIjogODAsICJOVU1CRVIiOiA4MSwgIkJPT0xFQU4iOiA4MiwgIlVOREVGSU5FRCI6IDgzLCAiTlVMTCI6IDg0LCAiREFUQSI6IDg1LCAicGF0aFNlZ21lbnRzIjogODYsICJTRVAiOiA4NywgIiRhY2NlcHQiOiAwLCAiJGVuZCI6IDEgfSwKCQkgICAgICAgIHRlcm1pbmFsc186IHsgMjogImVycm9yIiwgNTogIkVPRiIsIDE0OiAiQ09NTUVOVCIsIDE1OiAiQ09OVEVOVCIsIDE4OiAiRU5EX1JBV19CTE9DSyIsIDE5OiAiT1BFTl9SQVdfQkxPQ0siLCAyMzogIkNMT1NFX1JBV19CTE9DSyIsIDI5OiAiT1BFTl9CTE9DSyIsIDMzOiAiQ0xPU0UiLCAzNDogIk9QRU5fSU5WRVJTRSIsIDM5OiAiT1BFTl9JTlZFUlNFX0NIQUlOIiwgNDQ6ICJJTlZFUlNFIiwgNDc6ICJPUEVOX0VOREJMT0NLIiwgNDg6ICJPUEVOIiwgNTE6ICJPUEVOX1VORVNDQVBFRCIsIDU0OiAiQ0xPU0VfVU5FU0NBUEVEIiwgNTU6ICJPUEVOX1BBUlRJQUwiLCA2MDogIk9QRU5fUEFSVElBTF9CTE9DSyIsIDY1OiAiT1BFTl9TRVhQUiIsIDY4OiAiQ0xPU0VfU0VYUFIiLCA3MjogIklEIiwgNzM6ICJFUVVBTFMiLCA3NTogIk9QRU5fQkxPQ0tfUEFSQU1TIiwgNzc6ICJDTE9TRV9CTE9DS19QQVJBTVMiLCA4MDogIlNUUklORyIsIDgxOiAiTlVNQkVSIiwgODI6ICJCT09MRUFOIiwgODM6ICJVTkRFRklORUQiLCA4NDogIk5VTEwiLCA4NTogIkRBVEEiLCA4NzogIlNFUCIgfSwKCQkgICAgICAgIHByb2R1Y3Rpb25zXzogWzAsIFszLCAyXSwgWzQsIDFdLCBbNywgMV0sIFs3LCAxXSwgWzcsIDFdLCBbNywgMV0sIFs3LCAxXSwgWzcsIDFdLCBbNywgMV0sIFsxMywgMV0sIFsxMCwgM10sIFsxNiwgNV0sIFs5LCA0XSwgWzksIDRdLCBbMjQsIDZdLCBbMjcsIDZdLCBbMzgsIDZdLCBbNDMsIDJdLCBbNDUsIDNdLCBbNDUsIDFdLCBbMjYsIDNdLCBbOCwgNV0sIFs4LCA1XSwgWzExLCA1XSwgWzEyLCAzXSwgWzU5LCA1XSwgWzYzLCAxXSwgWzYzLCAxXSwgWzY0LCA1XSwgWzY5LCAxXSwgWzcxLCAzXSwgWzc0LCAzXSwgWzIwLCAxXSwgWzIwLCAxXSwgWzIwLCAxXSwgWzIwLCAxXSwgWzIwLCAxXSwgWzIwLCAxXSwgWzIwLCAxXSwgWzU2LCAxXSwgWzU2LCAxXSwgWzc5LCAyXSwgWzc4LCAxXSwgWzg2LCAzXSwgWzg2LCAxXSwgWzYsIDBdLCBbNiwgMl0sIFsxNywgMV0sIFsxNywgMl0sIFsyMSwgMF0sIFsyMSwgMl0sIFsyMiwgMF0sIFsyMiwgMV0sIFsyNSwgMF0sIFsyNSwgMV0sIFsyOCwgMF0sIFsyOCwgMV0sIFszMCwgMF0sIFszMCwgMl0sIFszMSwgMF0sIFszMSwgMV0sIFszMiwgMF0sIFszMiwgMV0sIFszNSwgMF0sIFszNSwgMl0sIFszNiwgMF0sIFszNiwgMV0sIFszNywgMF0sIFszNywgMV0sIFs0MCwgMF0sIFs0MCwgMl0sIFs0MSwgMF0sIFs0MSwgMV0sIFs0MiwgMF0sIFs0MiwgMV0sIFs0NiwgMF0sIFs0NiwgMV0sIFs0OSwgMF0sIFs0OSwgMl0sIFs1MCwgMF0sIFs1MCwgMV0sIFs1MiwgMF0sIFs1MiwgMl0sIFs1MywgMF0sIFs1MywgMV0sIFs1NywgMF0sIFs1NywgMl0sIFs1OCwgMF0sIFs1OCwgMV0sIFs2MSwgMF0sIFs2MSwgMl0sIFs2MiwgMF0sIFs2MiwgMV0sIFs2NiwgMF0sIFs2NiwgMl0sIFs2NywgMF0sIFs2NywgMV0sIFs3MCwgMV0sIFs3MCwgMl0sIFs3NiwgMV0sIFs3NiwgMl1dLAoJCSAgICAgICAgcGVyZm9ybUFjdGlvbjogZnVuY3Rpb24gYW5vbnltb3VzKHl5dGV4dCwgeXlsZW5nLCB5eWxpbmVubywgeXksIHl5c3RhdGUsICQkLCBfJAoJCSAgICAgICAgLyoqLykgewoKCQkgICAgICAgICAgICB2YXIgJDAgPSAkJC5sZW5ndGggLSAxOwoJCSAgICAgICAgICAgIHN3aXRjaCAoeXlzdGF0ZSkgewoJCSAgICAgICAgICAgICAgICBjYXNlIDE6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gJCRbJDAgLSAxXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlUHJvZ3JhbSgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA1OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDc6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgOToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsKCQkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQ29tbWVudFN0YXRlbWVudCcsCgkJICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHl5LnN0cmlwQ29tbWVudCgkJFskMF0pLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwXSwgJCRbJDBdKSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkKCQkgICAgICAgICAgICAgICAgICAgIH07CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTA6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0NvbnRlbnRTdGF0ZW1lbnQnLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsOiAkJFskMF0sCgkJICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICQkWyQwXSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkKCQkgICAgICAgICAgICAgICAgICAgIH07CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTE6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlUmF3QmxvY2soJCRbJDAgLSAyXSwgJCRbJDAgLSAxXSwgJCRbJDBdLCB0aGlzLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDEyOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBwYXRoOiAkJFskMCAtIDNdLCBwYXJhbXM6ICQkWyQwIC0gMl0sIGhhc2g6ICQkWyQwIC0gMV0gfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDEzOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZUJsb2NrKCQkWyQwIC0gM10sICQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgZmFsc2UsIHRoaXMuXyQpOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlQmxvY2soJCRbJDAgLSAzXSwgJCRbJDAgLSAyXSwgJCRbJDAgLSAxXSwgJCRbJDBdLCB0cnVlLCB0aGlzLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE1OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBvcGVuOiAkJFskMCAtIDVdLCBwYXRoOiAkJFskMCAtIDRdLCBwYXJhbXM6ICQkWyQwIC0gM10sIGhhc2g6ICQkWyQwIC0gMl0sIGJsb2NrUGFyYW1zOiAkJFskMCAtIDFdLCBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDVdLCAkJFskMF0pIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxNjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgcGF0aDogJCRbJDAgLSA0XSwgcGFyYW1zOiAkJFskMCAtIDNdLCBoYXNoOiAkJFskMCAtIDJdLCBibG9ja1BhcmFtczogJCRbJDAgLSAxXSwgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSA1XSwgJCRbJDBdKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTc6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHBhdGg6ICQkWyQwIC0gNF0sIHBhcmFtczogJCRbJDAgLSAzXSwgaGFzaDogJCRbJDAgLSAyXSwgYmxvY2tQYXJhbXM6ICQkWyQwIC0gMV0sIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNV0sICQkWyQwXSkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDFdLCAkJFskMCAtIDFdKSwgcHJvZ3JhbTogJCRbJDBdIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxOToKCQkgICAgICAgICAgICAgICAgICAgIHZhciBpbnZlcnNlID0geXkucHJlcGFyZUJsb2NrKCQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgJCRbJDBdLCBmYWxzZSwgdGhpcy5fJCksCgkJICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3JhbSA9IHl5LnByZXBhcmVQcm9ncmFtKFtpbnZlcnNlXSwgJCRbJDAgLSAxXS5sb2MpOwoJCSAgICAgICAgICAgICAgICAgICAgcHJvZ3JhbS5jaGFpbmVkID0gdHJ1ZTsKCgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHN0cmlwOiAkJFskMCAtIDJdLnN0cmlwLCBwcm9ncmFtOiBwcm9ncmFtLCBjaGFpbjogdHJ1ZSB9OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDIwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjE6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHBhdGg6ICQkWyQwIC0gMV0sIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gMl0sICQkWyQwXSkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDIyOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZU11c3RhY2hlKCQkWyQwIC0gM10sICQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwIC0gNF0sIHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSA0XSwgJCRbJDBdKSwgdGhpcy5fJCk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMzoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVNdXN0YWNoZSgkJFskMCAtIDNdLCAkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMCAtIDRdLCB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNF0sICQkWyQwXSksIHRoaXMuXyQpOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BhcnRpYWxTdGF0ZW1lbnQnLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICQkWyQwIC0gM10sCgkJICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiAkJFskMCAtIDJdLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6ICQkWyQwIC0gMV0sCgkJICAgICAgICAgICAgICAgICAgICAgICAgaW5kZW50OiAnJywKCQkgICAgICAgICAgICAgICAgICAgICAgICBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDRdLCAkJFskMF0pLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKQoJCSAgICAgICAgICAgICAgICAgICAgfTsKCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyNToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVQYXJ0aWFsQmxvY2soJCRbJDAgLSAyXSwgJCRbJDAgLSAxXSwgJCRbJDBdLCB0aGlzLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI2OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBwYXRoOiAkJFskMCAtIDNdLCBwYXJhbXM6ICQkWyQwIC0gMl0sIGhhc2g6ICQkWyQwIC0gMV0sIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNF0sICQkWyQwXSkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI3OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjg6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyOToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsKCQkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnU3ViRXhwcmVzc2lvbicsCgkJICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogJCRbJDAgLSAzXSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6ICQkWyQwIC0gMl0sCgkJICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDogJCRbJDAgLSAxXSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkKCQkgICAgICAgICAgICAgICAgICAgIH07CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzA6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdIYXNoJywgcGFpcnM6ICQkWyQwXSwgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzMToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ0hhc2hQYWlyJywga2V5OiB5eS5pZCgkJFskMCAtIDJdKSwgdmFsdWU6ICQkWyQwXSwgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzMjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LmlkKCQkWyQwIC0gMV0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzM6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzNDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM1OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnU3RyaW5nTGl0ZXJhbCcsIHZhbHVlOiAkJFskMF0sIG9yaWdpbmFsOiAkJFskMF0sIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzY6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdOdW1iZXJMaXRlcmFsJywgdmFsdWU6IE51bWJlcigkJFskMF0pLCBvcmlnaW5hbDogTnVtYmVyKCQkWyQwXSksIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzc6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdCb29sZWFuTGl0ZXJhbCcsIHZhbHVlOiAkJFskMF0gPT09ICd0cnVlJywgb3JpZ2luYWw6ICQkWyQwXSA9PT0gJ3RydWUnLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnVW5kZWZpbmVkTGl0ZXJhbCcsIG9yaWdpbmFsOiB1bmRlZmluZWQsIHZhbHVlOiB1bmRlZmluZWQsIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzk6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdOdWxsTGl0ZXJhbCcsIG9yaWdpbmFsOiBudWxsLCB2YWx1ZTogbnVsbCwgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0MDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQxOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDI6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlUGF0aCh0cnVlLCAkJFskMF0sIHRoaXMuXyQpOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDM6Cg==", "base64"));
  res.write(new Buffer("CQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVQYXRoKGZhbHNlLCAkJFskMF0sIHRoaXMuXyQpOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDQ6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDJdLnB1c2goeyBwYXJ0OiB5eS5pZCgkJFskMF0pLCBvcmlnaW5hbDogJCRbJDBdLCBzZXBhcmF0b3I6ICQkWyQwIC0gMV0gfSk7dGhpcy4kID0gJCRbJDAgLSAyXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ1OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW3sgcGFydDogeXkuaWQoJCRbJDBdKSwgb3JpZ2luYWw6ICQkWyQwXSB9XTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ2OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0NzoKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDg6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbJCRbJDBdXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ5OgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA1MDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNTE6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDU4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA1OToKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNjQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDY1OgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA3MDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNzE6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDc4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA3OToKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgODI6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDgzOgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA4NjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgODc6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDkwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA5MToKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgOTQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDk1OgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA5ODoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFskJFskMF1dOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgOTk6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDEwMDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFskJFskMF1dOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTAxOgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICB9CgkJICAgICAgICB9LAoJCSAgICAgICAgdGFibGU6IFt7IDM6IDEsIDQ6IDIsIDU6IFsyLCA0Nl0sIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgNDg6IFsyLCA0Nl0sIDUxOiBbMiwgNDZdLCA1NTogWzIsIDQ2XSwgNjA6IFsyLCA0Nl0gfSwgeyAxOiBbM10gfSwgeyA1OiBbMSwgNF0gfSwgeyA1OiBbMiwgMl0sIDc6IDUsIDg6IDYsIDk6IDcsIDEwOiA4LCAxMTogOSwgMTI6IDEwLCAxMzogMTEsIDE0OiBbMSwgMTJdLCAxNTogWzEsIDIwXSwgMTY6IDE3LCAxOTogWzEsIDIzXSwgMjQ6IDE1LCAyNzogMTYsIDI5OiBbMSwgMjFdLCAzNDogWzEsIDIyXSwgMzk6IFsyLCAyXSwgNDQ6IFsyLCAyXSwgNDc6IFsyLCAyXSwgNDg6IFsxLCAxM10sIDUxOiBbMSwgMTRdLCA1NTogWzEsIDE4XSwgNTk6IDE5LCA2MDogWzEsIDI0XSB9LCB7IDE6IFsyLCAxXSB9LCB7IDU6IFsyLCA0N10sIDE0OiBbMiwgNDddLCAxNTogWzIsIDQ3XSwgMTk6IFsyLCA0N10sIDI5OiBbMiwgNDddLCAzNDogWzIsIDQ3XSwgMzk6IFsyLCA0N10sIDQ0OiBbMiwgNDddLCA0NzogWzIsIDQ3XSwgNDg6IFsyLCA0N10sIDUxOiBbMiwgNDddLCA1NTogWzIsIDQ3XSwgNjA6IFsyLCA0N10gfSwgeyA1OiBbMiwgM10sIDE0OiBbMiwgM10sIDE1OiBbMiwgM10sIDE5OiBbMiwgM10sIDI5OiBbMiwgM10sIDM0OiBbMiwgM10sIDM5OiBbMiwgM10sIDQ0OiBbMiwgM10sIDQ3OiBbMiwgM10sIDQ4OiBbMiwgM10sIDUxOiBbMiwgM10sIDU1OiBbMiwgM10sIDYwOiBbMiwgM10gfSwgeyA1OiBbMiwgNF0sIDE0OiBbMiwgNF0sIDE1OiBbMiwgNF0sIDE5OiBbMiwgNF0sIDI5OiBbMiwgNF0sIDM0OiBbMiwgNF0sIDM5OiBbMiwgNF0sIDQ0OiBbMiwgNF0sIDQ3OiBbMiwgNF0sIDQ4OiBbMiwgNF0sIDUxOiBbMiwgNF0sIDU1OiBbMiwgNF0sIDYwOiBbMiwgNF0gfSwgeyA1OiBbMiwgNV0sIDE0OiBbMiwgNV0sIDE1OiBbMiwgNV0sIDE5OiBbMiwgNV0sIDI5OiBbMiwgNV0sIDM0OiBbMiwgNV0sIDM5OiBbMiwgNV0sIDQ0OiBbMiwgNV0sIDQ3OiBbMiwgNV0sIDQ4OiBbMiwgNV0sIDUxOiBbMiwgNV0sIDU1OiBbMiwgNV0sIDYwOiBbMiwgNV0gfSwgeyA1OiBbMiwgNl0sIDE0OiBbMiwgNl0sIDE1OiBbMiwgNl0sIDE5OiBbMiwgNl0sIDI5OiBbMiwgNl0sIDM0OiBbMiwgNl0sIDM5OiBbMiwgNl0sIDQ0OiBbMiwgNl0sIDQ3OiBbMiwgNl0sIDQ4OiBbMiwgNl0sIDUxOiBbMiwgNl0sIDU1OiBbMiwgNl0sIDYwOiBbMiwgNl0gfSwgeyA1OiBbMiwgN10sIDE0OiBbMiwgN10sIDE1OiBbMiwgN10sIDE5OiBbMiwgN10sIDI5OiBbMiwgN10sIDM0OiBbMiwgN10sIDM5OiBbMiwgN10sIDQ0OiBbMiwgN10sIDQ3OiBbMiwgN10sIDQ4OiBbMiwgN10sIDUxOiBbMiwgN10sIDU1OiBbMiwgN10sIDYwOiBbMiwgN10gfSwgeyA1OiBbMiwgOF0sIDE0OiBbMiwgOF0sIDE1OiBbMiwgOF0sIDE5OiBbMiwgOF0sIDI5OiBbMiwgOF0sIDM0OiBbMiwgOF0sIDM5OiBbMiwgOF0sIDQ0OiBbMiwgOF0sIDQ3OiBbMiwgOF0sIDQ4OiBbMiwgOF0sIDUxOiBbMiwgOF0sIDU1OiBbMiwgOF0sIDYwOiBbMiwgOF0gfSwgeyA1OiBbMiwgOV0sIDE0OiBbMiwgOV0sIDE1OiBbMiwgOV0sIDE5OiBbMiwgOV0sIDI5OiBbMiwgOV0sIDM0OiBbMiwgOV0sIDM5OiBbMiwgOV0sIDQ0OiBbMiwgOV0sIDQ3OiBbMiwgOV0sIDQ4OiBbMiwgOV0sIDUxOiBbMiwgOV0sIDU1OiBbMiwgOV0sIDYwOiBbMiwgOV0gfSwgeyAyMDogMjUsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDM2LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDQ6IDM3LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDM5OiBbMiwgNDZdLCA0NDogWzIsIDQ2XSwgNDc6IFsyLCA0Nl0sIDQ4OiBbMiwgNDZdLCA1MTogWzIsIDQ2XSwgNTU6IFsyLCA0Nl0sIDYwOiBbMiwgNDZdIH0sIHsgNDogMzgsIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgNDQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDEzOiA0MCwgMTU6IFsxLCAyMF0sIDE3OiAzOSB9LCB7IDIwOiA0MiwgNTY6IDQxLCA2NDogNDMsIDY1OiBbMSwgNDRdLCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDQ6IDQ1LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDU6IFsyLCAxMF0sIDE0OiBbMiwgMTBdLCAxNTogWzIsIDEwXSwgMTg6IFsyLCAxMF0sIDE5OiBbMiwgMTBdLCAyOTogWzIsIDEwXSwgMzQ6IFsyLCAxMF0sIDM5OiBbMiwgMTBdLCA0NDogWzIsIDEwXSwgNDc6IFsyLCAxMF0sIDQ4OiBbMiwgMTBdLCA1MTogWzIsIDEwXSwgNTU6IFsyLCAxMF0sIDYwOiBbMiwgMTBdIH0sIHsgMjA6IDQ2LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDIwOiA0NywgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNDgsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDQyLCA1NjogNDksIDY0OiA0MywgNjU6IFsxLCA0NF0sIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMzM6IFsyLCA3OF0sIDQ5OiA1MCwgNjU6IFsyLCA3OF0sIDcyOiBbMiwgNzhdLCA4MDogWzIsIDc4XSwgODE6IFsyLCA3OF0sIDgyOiBbMiwgNzhdLCA4MzogWzIsIDc4XSwgODQ6IFsyLCA3OF0sIDg1OiBbMiwgNzhdIH0sIHsgMjM6IFsyLCAzM10sIDMzOiBbMiwgMzNdLCA1NDogWzIsIDMzXSwgNjU6IFsyLCAzM10sIDY4OiBbMiwgMzNdLCA3MjogWzIsIDMzXSwgNzU6IFsyLCAzM10sIDgwOiBbMiwgMzNdLCA4MTogWzIsIDMzXSwgODI6IFsyLCAzM10sIDgzOiBbMiwgMzNdLCA4NDogWzIsIDMzXSwgODU6IFsyLCAzM10gfSwgeyAyMzogWzIsIDM0XSwgMzM6IFsyLCAzNF0sIDU0OiBbMiwgMzRdLCA2NTogWzIsIDM0XSwgNjg6IFsyLCAzNF0sIDcyOiBbMiwgMzRdLCA3NTogWzIsIDM0XSwgODA6IFsyLCAzNF0sIDgxOiBbMiwgMzRdLCA4MjogWzIsIDM0XSwgODM6IFsyLCAzNF0sIDg0OiBbMiwgMzRdLCA4NTogWzIsIDM0XSB9LCB7IDIzOiBbMiwgMzVdLCAzMzogWzIsIDM1XSwgNTQ6IFsyLCAzNV0sIDY1OiBbMiwgMzVdLCA2ODogWzIsIDM1XSwgNzI6IFsyLCAzNV0sIDc1OiBbMiwgMzVdLCA4MDogWzIsIDM1XSwgODE6IFsyLCAzNV0sIDgyOiBbMiwgMzVdLCA4MzogWzIsIDM1XSwgODQ6IFsyLCAzNV0sIDg1OiBbMiwgMzVdIH0sIHsgMjM6IFsyLCAzNl0sIDMzOiBbMiwgMzZdLCA1NDogWzIsIDM2XSwgNjU6IFsyLCAzNl0sIDY4OiBbMiwgMzZdLCA3MjogWzIsIDM2XSwgNzU6IFsyLCAzNl0sIDgwOiBbMiwgMzZdLCA4MTogWzIsIDM2XSwgODI6IFsyLCAzNl0sIDgzOiBbMiwgMzZdLCA4NDogWzIsIDM2XSwgODU6IFsyLCAzNl0gfSwgeyAyMzogWzIsIDM3XSwgMzM6IFsyLCAzN10sIDU0OiBbMiwgMzddLCA2NTogWzIsIDM3XSwgNjg6IFsyLCAzN10sIDcyOiBbMiwgMzddLCA3NTogWzIsIDM3XSwgODA6IFsyLCAzN10sIDgxOiBbMiwgMzddLCA4MjogWzIsIDM3XSwgODM6IFsyLCAzN10sIDg0OiBbMiwgMzddLCA4NTogWzIsIDM3XSB9LCB7IDIzOiBbMiwgMzhdLCAzMzogWzIsIDM4XSwgNTQ6IFsyLCAzOF0sIDY1OiBbMiwgMzhdLCA2ODogWzIsIDM4XSwgNzI6IFsyLCAzOF0sIDc1OiBbMiwgMzhdLCA4MDogWzIsIDM4XSwgODE6IFsyLCAzOF0sIDgyOiBbMiwgMzhdLCA4MzogWzIsIDM4XSwgODQ6IFsyLCAzOF0sIDg1OiBbMiwgMzhdIH0sIHsgMjM6IFsyLCAzOV0sIDMzOiBbMiwgMzldLCA1NDogWzIsIDM5XSwgNjU6IFsyLCAzOV0sIDY4OiBbMiwgMzldLCA3MjogWzIsIDM5XSwgNzU6IFsyLCAzOV0sIDgwOiBbMiwgMzldLCA4MTogWzIsIDM5XSwgODI6IFsyLCAzOV0sIDgzOiBbMiwgMzldLCA4NDogWzIsIDM5XSwgODU6IFsyLCAzOV0gfSwgeyAyMzogWzIsIDQzXSwgMzM6IFsyLCA0M10sIDU0OiBbMiwgNDNdLCA2NTogWzIsIDQzXSwgNjg6IFsyLCA0M10sIDcyOiBbMiwgNDNdLCA3NTogWzIsIDQzXSwgODA6IFsyLCA0M10sIDgxOiBbMiwgNDNdLCA4MjogWzIsIDQzXSwgODM6IFsyLCA0M10sIDg0OiBbMiwgNDNdLCA4NTogWzIsIDQzXSwgODc6IFsxLCA1MV0gfSwgeyA3MjogWzEsIDM1XSwgODY6IDUyIH0sIHsgMjM6IFsyLCA0NV0sIDMzOiBbMiwgNDVdLCA1NDogWzIsIDQ1XSwgNjU6IFsyLCA0NV0sIDY4OiBbMiwgNDVdLCA3MjogWzIsIDQ1XSwgNzU6IFsyLCA0NV0sIDgwOiBbMiwgNDVdLCA4MTogWzIsIDQ1XSwgODI6IFsyLCA0NV0sIDgzOiBbMiwgNDVdLCA4NDogWzIsIDQ1XSwgODU6IFsyLCA0NV0sIDg3OiBbMiwgNDVdIH0sIHsgNTI6IDUzLCA1NDogWzIsIDgyXSwgNjU6IFsyLCA4Ml0sIDcyOiBbMiwgODJdLCA4MDogWzIsIDgyXSwgODE6IFsyLCA4Ml0sIDgyOiBbMiwgODJdLCA4MzogWzIsIDgyXSwgODQ6IFsyLCA4Ml0sIDg1OiBbMiwgODJdIH0sIHsgMjU6IDU0LCAzODogNTYsIDM5OiBbMSwgNThdLCA0MzogNTcsIDQ0OiBbMSwgNTldLCA0NTogNTUsIDQ3OiBbMiwgNTRdIH0sIHsgMjg6IDYwLCA0MzogNjEsIDQ0OiBbMSwgNTldLCA0NzogWzIsIDU2XSB9LCB7IDEzOiA2MywgMTU6IFsxLCAyMF0sIDE4OiBbMSwgNjJdIH0sIHsgMTU6IFsyLCA0OF0sIDE4OiBbMiwgNDhdIH0sIHsgMzM6IFsyLCA4Nl0sIDU3OiA2NCwgNjU6IFsyLCA4Nl0sIDcyOiBbMiwgODZdLCA4MDogWzIsIDg2XSwgODE6IFsyLCA4Nl0sIDgyOiBbMiwgODZdLCA4MzogWzIsIDg2XSwgODQ6IFsyLCA4Nl0sIDg1OiBbMiwgODZdIH0sIHsgMzM6IFsyLCA0MF0sIDY1OiBbMiwgNDBdLCA3MjogWzIsIDQwXSwgODA6IFsyLCA0MF0sIDgxOiBbMiwgNDBdLCA4MjogWzIsIDQwXSwgODM6IFsyLCA0MF0sIDg0OiBbMiwgNDBdLCA4NTogWzIsIDQwXSB9LCB7IDMzOiBbMiwgNDFdLCA2NTogWzIsIDQxXSwgNzI6IFsyLCA0MV0sIDgwOiBbMiwgNDFdLCA4MTogWzIsIDQxXSwgODI6IFsyLCA0MV0sIDgzOiBbMiwgNDFdLCA4NDogWzIsIDQxXSwgODU6IFsyLCA0MV0gfSwgeyAyMDogNjUsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjY6IDY2LCA0NzogWzEsIDY3XSB9LCB7IDMwOiA2OCwgMzM6IFsyLCA1OF0sIDY1OiBbMiwgNThdLCA3MjogWzIsIDU4XSwgNzU6IFsyLCA1OF0sIDgwOiBbMiwgNThdLCA4MTogWzIsIDU4XSwgODI6IFsyLCA1OF0sIDgzOiBbMiwgNThdLCA4NDogWzIsIDU4XSwgODU6IFsyLCA1OF0gfSwgeyAzMzogWzIsIDY0XSwgMzU6IDY5LCA2NTogWzIsIDY0XSwgNzI6IFsyLCA2NF0sIDc1OiBbMiwgNjRdLCA4MDogWzIsIDY0XSwgODE6IFsyLCA2NF0sIDgyOiBbMiwgNjRdLCA4MzogWzIsIDY0XSwgODQ6IFsyLCA2NF0sIDg1OiBbMiwgNjRdIH0sIHsgMjE6IDcwLCAyMzogWzIsIDUwXSwgNjU6IFsyLCA1MF0sIDcyOiBbMiwgNTBdLCA4MDogWzIsIDUwXSwgODE6IFsyLCA1MF0sIDgyOiBbMiwgNTBdLCA4MzogWzIsIDUwXSwgODQ6IFsyLCA1MF0sIDg1OiBbMiwgNTBdIH0sIHsgMzM6IFsyLCA5MF0sIDYxOiA3MSwgNjU6IFsyLCA5MF0sIDcyOiBbMiwgOTBdLCA4MDogWzIsIDkwXSwgODE6IFsyLCA5MF0sIDgyOiBbMiwgOTBdLCA4MzogWzIsIDkwXSwgODQ6IFsyLCA5MF0sIDg1OiBbMiwgOTBdIH0sIHsgMjA6IDc1LCAzMzogWzIsIDgwXSwgNTA6IDcyLCA2MzogNzMsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY5OiA3NCwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgNzI6IFsxLCA4MF0gfSwgeyAyMzogWzIsIDQyXSwgMzM6IFsyLCA0Ml0sIDU0OiBbMiwgNDJdLCA2NTogWzIsIDQyXSwgNjg6IFsyLCA0Ml0sIDcyOiBbMiwgNDJdLCA3NTogWzIsIDQyXSwgODA6IFsyLCA0Ml0sIDgxOiBbMiwgNDJdLCA4MjogWzIsIDQyXSwgODM6IFsyLCA0Ml0sIDg0OiBbMiwgNDJdLCA4NTogWzIsIDQyXSwgODc6IFsxLCA1MV0gfSwgeyAyMDogNzUsIDUzOiA4MSwgNTQ6IFsyLCA4NF0sIDYzOiA4MiwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDgzLCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyNjogODQsIDQ3OiBbMSwgNjddIH0sIHsgNDc6IFsyLCA1NV0gfSwgeyA0OiA4NSwgNjogMywgMTQ6IFsyLCA0Nl0sIDE1OiBbMiwgNDZdLCAxOTogWzIsIDQ2XSwgMjk6IFsyLCA0Nl0sIDM0OiBbMiwgNDZdLCAzOTogWzIsIDQ2XSwgNDQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDQ3OiBbMiwgMjBdIH0sIHsgMjA6IDg2LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDQ6IDg3LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDI2OiA4OCwgNDc6IFsxLCA2N10gfSwgeyA0NzogWzIsIDU3XSB9LCB7IDU6IFsyLCAxMV0sIDE0OiBbMiwgMTFdLCAxNTogWzIsIDExXSwgMTk6IFsyLCAxMV0sIDI5OiBbMiwgMTFdLCAzNDogWzIsIDExXSwgMzk6IFsyLCAxMV0sIDQ0OiBbMiwgMTFdLCA0NzogWzIsIDExXSwgNDg6IFsyLCAxMV0sIDUxOiBbMiwgMTFdLCA1NTogWzIsIDExXSwgNjA6IFsyLCAxMV0gfSwgeyAxNTogWzIsIDQ5XSwgMTg6IFsyLCA0OV0gfSwgeyAyMDogNzUsIDMzOiBbMiwgODhdLCA1ODogODksIDYzOiA5MCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDkxLCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA2NTogWzIsIDk0XSwgNjY6IDkyLCA2ODogWzIsIDk0XSwgNzI6IFsyLCA5NF0sIDgwOiBbMiwgOTRdLCA4MTogWzIsIDk0XSwgODI6IFsyLCA5NF0sIDgzOiBbMiwgOTRdLCA4NDogWzIsIDk0XSwgODU6IFsyLCA5NF0gfSwgeyA1OiBbMiwgMjVdLCAxNDogWzIsIDI1XSwgMTU6IFsyLCAyNV0sIDE5OiBbMiwgMjVdLCAyOTogWzIsIDI1XSwgMzQ6IFsyLCAyNV0sIDM5OiBbMiwgMjVdLCA0NDogWzIsIDI1XSwgNDc6IFsyLCAyNV0sIDQ4OiBbMiwgMjVdLCA1MTogWzIsIDI1XSwgNTU6IFsyLCAyNV0sIDYwOiBbMiwgMjVdIH0sIHsgMjA6IDkzLCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDIwOiA3NSwgMzE6IDk0LCAzMzogWzIsIDYwXSwgNjM6IDk1LCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogOTYsIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzU6IFsyLCA2MF0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNzUsIDMzOiBbMiwgNjZdLCAzNjogOTcsIDYzOiA5OCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDk5LCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc1OiBbMiwgNjZdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDc1LCAyMjogMTAwLCAyMzogWzIsIDUyXSwgNjM6IDEwMSwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDEwMiwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDc1LCAzMzogWzIsIDkyXSwgNjI6IDEwMywgNjM6IDEwNCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDEwNSwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMzM6IFsxLCAxMDZdIH0sIHsgMzM6IFsyLCA3OV0sIDY1OiBbMiwgNzldLCA3MjogWzIsIDc5XSwgODA6IFsyLCA3OV0sIDgxOiBbMiwgNzldLCA4MjogWzIsIDc5XSwgODM6IFsyLCA3OV0sIDg0OiBbMiwgNzldLCA4NTogWzIsIDc5XSB9LCB7IDMzOiBbMiwgODFdIH0sIHsgMjM6IFsyLCAyN10sIDMzOiBbMiwgMjddLCA1NDogWzIsIDI3XSwgNjU6IFsyLCAyN10sIDY4OiBbMiwgMjddLCA3MjogWzIsIDI3XSwgNzU6IFsyLCAyN10sIDgwOiBbMiwgMjddLCA4MTogWzIsIDI3XSwgODI6IFsyLCAyN10sIDgzOiBbMiwgMjddLCA4NDogWzIsIDI3XSwgODU6IFsyLCAyN10gfSwgeyAyMzogWzIsIDI4XSwgMzM6IFsyLCAyOF0sIDU0OiBbMiwgMjhdLCA2NTogWzIsIDI4XSwgNjg6IFsyLCAyOF0sIDcyOiBbMiwgMjhdLCA3NTogWzIsIDI4XSwgODA6IFsyLCAyOF0sIDgxOiBbMiwgMjhdLCA4MjogWzIsIDI4XSwgODM6IFsyLCAyOF0sIDg0OiBbMiwgMjhdLCA4NTogWzIsIDI4XSB9LCB7IDIzOiBbMiwgMzBdLCAzMzogWzIsIDMwXSwgNTQ6IFsyLCAzMF0sIDY4OiBbMiwgMzBdLCA3MTogMTA3LCA3MjogWzEsIDEwOF0sIDc1OiBbMiwgMzBdIH0sIHsgMjM6IFsyLCA5OF0sIDMzOiBbMiwgOThdLCA1NDogWzIsIDk4XSwgNjg6IFsyLCA5OF0sIDcyOiBbMiwgOThdLCA3NTogWzIsIDk4XSB9LCB7IDIzOiBbMiwgNDVdLCAzMzogWzIsIDQ1XSwgNTQ6IFsyLCA0NV0sIDY1OiBbMiwgNDVdLCA2ODogWzIsIDQ1XSwgNzI6IFsyLCA0NV0sIDczOiBbMSwgMTA5XSwgNzU6IFsyLCA0NV0sIDgwOiBbMiwgNDVdLCA4MTogWzIsIDQ1XSwgODI6IFsyLCA0NV0sIDgzOiBbMiwgNDVdLCA4NDogWzIsIDQ1XSwgODU6IFsyLCA0NV0sIDg3OiBbMiwgNDVdIH0sIHsgMjM6IFsyLCA0NF0sIDMzOiBbMiwgNDRdLCA1NDogWzIsIDQ0XSwgNjU6IFsyLCA0NF0sIDY4OiBbMiwgNDRdLCA3MjogWzIsIDQ0XSwgNzU6IFsyLCA0NF0sIDgwOiBbMiwgNDRdLCA4MTogWzIsIDQ0XSwgODI6IFsyLCA0NF0sIDgzOiBbMiwgNDRdLCA4NDogWzIsIDQ0XSwgODU6IFsyLCA0NF0sIDg3OiBbMiwgNDRdIH0sIHsgNTQ6IFsxLCAxMTBdIH0sIHsgNTQ6IFsyLCA4M10sIDY1OiBbMiwgODNdLCA3MjogWzIsIDgzXSwgODA6IFsyLCA4M10sIDgxOiBbMiwgODNdLCA4MjogWzIsIDgzXSwgODM6IFsyLCA4M10sIDg0OiBbMiwgODNdLCA4NTogWzIsIDgzXSB9LCB7IDU0OiBbMiwgODVdIH0sIHsgNTogWzIsIDEzXSwgMTQ6IFsyLCAxM10sIDE1OiBbMiwgMTNdLCAxOTogWzIsIDEzXSwgMjk6IFsyLCAxM10sIDM0OiBbMiwgMTNdLCAzOTogWzIsIDEzXSwgNDQ6IFsyLCAxM10sIDQ3OiBbMiwgMTNdLCA0ODogWzIsIDEzXSwgNTE6IFsyLCAxM10sIDU1OiBbMiwgMTNdLCA2MDogWzIsIDEzXSB9LCB7IDM4OiA1NiwgMzk6IFsxLCA1OF0sIDQzOiA1NywgNDQ6IFsxLCA1OV0sIDQ1OiAxMTIsIDQ2OiAxMTEsIDQ3OiBbMiwgNzZdIH0sIHsgMzM6IFsyLCA3MF0sIDQwOiAxMTMsIDY1OiBbMiwgNzBdLCA3MjogWzIsIDcwXSwgNzU6IFsyLCA3MF0sIDgwOiBbMiwgNzBdLCA4MTogWzIsIDcwXSwgODI6IFsyLCA3MF0sIDgzOiBbMiwgNzBdLCA4NDogWzIsIDcwXSwgODU6IFsyLCA3MF0gfSwgeyA0NzogWzIsIDE4XSB9LCB7IDU6IFsyLCAxNF0sIDE0OiBbMiwgMTRdLCAxNTogWzIsIDE0XSwgMTk6IFsyLCAxNF0sIDI5OiBbMiwgMTRdLCAzNDogWzIsIDE0XSwgMzk6IFsyLCAxNF0sIDQ0OiBbMiwgMTRdLCA0NzogWzIsIDE0XSwgNDg6IFsyLCAxNF0sIDUxOiBbMiwgMTRdLCA1NTogWzIsIDE0XSwgNjA6IFsyLCAxNF0gfSwgeyAzMzogWzEsIDExNF0gfSwgeyAzMzogWzIsIDg3XSwgNjU6IFsyLCA4N10sIDcyOiBbMiwgODddLCA4MDogWzIsIDg3XSwgODE6IFsyLCA4N10sIDgyOiBbMiwgODddLCA4MzogWzIsIDg3XSwgODQ6IFsyLCA4N10sIDg1OiBbMiwgODddIH0sIHsgMzM6IFsyLCA4OV0gfSwgeyAyMDogNzUsIDYzOiAxMTYsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY3OiAxMTUsIDY4OiBbMiwgOTZdLCA2OTogMTE3LCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAzMzogWzEsIDExOF0gfSwgeyAzMjogMTE5LCAzMzogWzIsIDYyXSwgNzQ6IDEyMCwgNzU6IFsxLCAxMjFdIH0sIHsgMzM6IFsyLCA1OV0sIDY1OiBbMiwgNTldLCA3MjogWzIsIDU5XSwgNzU6IFsyLCA1OV0sIDgwOiBbMiwgNTldLCA4MTogWzIsIDU5XSwgODI6IFsyLCA1OV0sIDgzOiBbMiwgNTldLCA4NDogWzIsIDU5XSwgODU6IFsyLCA1OV0gfSwgeyAzMzogWzIsIDYxXSwgNzU6IFsyLCA2MV0gfSwgeyAzMzogWzIsIDY4XSwgMzc6IDEyMiwgNzQ6IDEyMywgNzU6IFsxLCAxMjFdIH0sIHsgMzM6IFsyLCA2NV0sIDY1OiBbMiwgNjVdLCA3MjogWzIsIDY1XSwgNzU6IFsyLCA2NV0sIDgwOiBbMiwgNjVdLCA4MTogWzIsIDY1XSwgODI6IFsyLCA2NV0sIDgzOiBbMiwgNjVdLCA4NDogWzIsIDY1XSwgODU6IFsyLCA2NV0gfSwgeyAzMzogWzIsIDY3XSwgNzU6IFsyLCA2N10gfSwgeyAyMzogWzEsIDEyNF0gfSwgeyAyMzogWzIsIDUxXSwgNjU6IFsyLCA1MV0sIDcyOiBbMiwgNTFdLCA4MDogWzIsIDUxXSwgODE6IFsyLCA1MV0sIDgyOiBbMiwgNTFdLCA4MzogWzIsIDUxXSwgODQ6IFsyLCA1MV0sIDg1OiBbMiwgNTFdIH0sIHsgMjM6IFsyLCA1M10gfSwgeyAzMzogWzEsIDEyNV0gfSwgeyAzMzogWzIsIDkxXSwgNjU6IFsyLCA5MV0sIDcyOiBbMiwgOTFdLCA4MDogWzIsIDkxXSwgODE6IFsyLCA5MV0sIDgyOiBbMiwgOTFdLCA4MzogWzIsIDkxXSwgODQ6IFsyLCA5MV0sIDg1OiBbMiwgOTFdIH0sIHsgMzM6IFsyLCA5M10gfSwgeyA1OiBbMiwgMjJdLCAxNDogWzIsIDIyXSwgMTU6IFsyLCAyMl0sIDE5OiBbMiwgMjJdLCAyOTogWzIsIDIyXSwgMzQ6IFsyLCAyMl0sIDM5OiBbMiwgMjJdLCA0NDogWzIsIDIyXSwgNDc6IFsyLCAyMl0sIDQ4OiBbMiwgMjJdLCA1MTogWzIsIDIyXSwgNTU6IFsyLCAyMl0sIDYwOiBbMiwgMjJdIH0sIHsgMjM6IFsyLCA5OV0sIDMzOiBbMiwgOTldLCA1NDogWzIsIDk5XSwgNjg6IFsyLCA5OV0sIDcyOiBbMiwgOTldLCA3NTogWzIsIDk5XSB9LCB7IDczOiBbMSwgMTA5XSB9LCB7IDIwOiA3NSwgNjM6IDEyNiwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA1OiBbMiwgMjNdLCAxNDogWzIsIDIzXSwgMTU6IFsyLCAyM10sIDE5OiBbMiwgMjNdLCAyOTogWzIsIDIzXSwgMzQ6IFsyLCAyM10sIDM5OiBbMiwgMjNdLCA0NDogWzIsIDIzXSwgNDc6IFsyLCAyM10sIDQ4OiBbMiwgMjNdLCA1MTogWzIsIDIzXSwgNTU6IFsyLCAyM10sIDYwOiBbMiwgMjNdIH0sIHsgNDc6IFsyLCAxOV0gfSwgeyA0NzogWzIsIDc3XSB9LCB7IDIwOiA3NSwgMzM6IFsyLCA3Ml0sIDQxOiAxMjcsIDYzOiAxMjgsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY5OiAxMjksIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzU6IFsyLCA3Ml0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA1OiBbMiwgMjRdLCAxNDogWzIsIDI0XSwgMTU6IFsyLCAyNF0sIDE5OiBbMiwgMjRdLCAyOTogWzIsIDI0XSwgMzQ6IFsyLCAyNF0sIDM5OiBbMiwgMjRdLCA0NDogWzIsIDI0XSwgNDc6IFsyLCAyNF0sIDQ4OiBbMiwgMjRdLCA1MTogWzIsIDI0XSwgNTU6IFsyLCAyNF0sIDYwOiBbMiwgMjRdIH0sIHsgNjg6IFsxLCAxMzBdIH0sIHsgNjU6IFsyLCA5NV0sIDY4OiBbMiwgOTVdLCA3MjogWzIsIDk1XSwgODA6IFsyLCA5NV0sIDgxOiBbMiwgOTVdLCA4MjogWzIsIDk1XSwgODM6IFsyLCA5NV0sIDg0OiBbMiwgOTVdLCA4NTogWzIsIDk1XSB9LCB7IDY4OiBbMiwgOTddIH0sIHsgNTogWzIsIDIxXSwgMTQ6IFsyLCAyMV0sIDE1OiBbMiwgMjFdLCAxOTogWzIsIDIxXSwgMjk6IFsyLCAyMV0sIDM0OiBbMiwgMjFdLCAzOTogWzIsIDIxXSwgNDQ6IFsyLCAyMV0sIDQ3OiBbMiwgMjFdLCA0ODogWzIsIDIxXSwgNTE6IFsyLCAyMV0sIDU1OiBbMiwgMjFdLCA2MDogWzIsIDIxXSB9LCB7IDMzOiBbMSwgMTMxXSB9LCB7IDMzOiBbMiwgNjNdIH0sIHsgNzI6IFsxLCAxMzNdLCA3NjogMTMyIH0sIHsgMzM6IFsxLCAxMzRdIH0sIHsgMzM6IFsyLCA2OV0gfSwgeyAxNTogWzIsIDEyXSB9LCB7IDE0OiBbMiwgMjZdLCAxNTogWzIsIDI2XSwgMTk6IFsyLCAyNl0sIDI5OiBbMiwgMjZdLCAzNDogWzIsIDI2XSwgNDc6IFsyLCAyNl0sIDQ4OiBbMiwgMjZdLCA1MTogWzIsIDI2XSwgNTU6IFsyLCAyNl0sIDYwOiBbMiwgMjZdIH0sIHsgMjM6IFsyLCAzMV0sIDMzOiBbMiwgMzFdLCA1NDogWzIsIDMxXSwgNjg6IFsyLCAzMV0sIDcyOiBbMiwgMzFdLCA3NTogWzIsIDMxXSB9LCB7IDMzOiBbMiwgNzRdLCA0MjogMTM1LCA3NDogMTM2LCA3NTogWzEsIDEyMV0gfSwgeyAzMzogWzIsIDcxXSwgNjU6IFsyLCA3MV0sIDcyOiBbMiwgNzFdLCA3NTogWzIsIDcxXSwgODA6IFsyLCA3MV0sIDgxOiBbMiwgNzFdLCA4MjogWzIsIDcxXSwgODM6IFsyLCA3MV0sIDg0OiBbMiwgNzFdLCA4NTogWzIsIDcxXSB9LCB7IDMzOiBbMiwgNzNdLCA3NTogWzIsIDczXSB9LCB7IDIzOiBbMiwgMjldLCAzMzogWzIsIDI5XSwgNTQ6IFsyLCAyOV0sIDY1OiBbMiwgMjldLCA2ODogWzIsIDI5XSwgNzI6IFsyLCAyOV0sIDc1OiBbMiwgMjldLCA4MDogWzIsIDI5XSwgODE6IFsyLCAyOV0sIDgyOiBbMiwgMjldLCA4MzogWzIsIDI5XSwgODQ6IFsyLCAyOV0sIDg1OiBbMiwgMjldIH0sIHsgMTQ6IFsyLCAxNV0sIDE1OiBbMiwgMTVdLCAxOTogWzIsIDE1XSwgMjk6IFsyLCAxNV0sIDM0OiBbMiwgMTVdLCAzOTogWzIsIDE1XSwgNDQ6IFsyLCAxNV0sIDQ3OiBbMiwgMTVdLCA0ODogWzIsIDE1XSwgNTE6IFsyLCAxNV0sIDU1OiBbMiwgMTVdLCA2MDogWzIsIDE1XSB9LCB7IDcyOiBbMSwgMTM4XSwgNzc6IFsxLCAxMzddIH0sIHsgNzI6IFsyLCAxMDBdLCA3NzogWzIsIDEwMF0gfSwgeyAxNDogWzIsIDE2XSwgMTU6IFsyLCAxNl0sIDE5OiBbMiwgMTZdLCAyOTogWzIsIDE2XSwgMzQ6IFsyLCAxNl0sIDQ0OiBbMiwgMTZdLCA0NzogWzIsIDE2XSwgNDg6IFsyLCAxNl0sIDUxOiBbMiwgMTZdLCA1NTogWzIsIDE2XSwgNjA6IFsyLCAxNl0gfSwgeyAzMzogWzEsIDEzOV0gfSwgeyAzMzogWzIsIDc1XSB9LCB7IDMzOiBbMiwgMzJdIH0sIHsgNzI6IFsyLCAxMDFdLCA3NzogWzIsIDEwMV0gfSwgeyAxNDogWzIsIDE3XSwgMTU6IFsyLCAxN10sIDE5OiBbMiwgMTddLCAyOTogWzIsIDE3XSwgMzQ6IFsyLCAxN10sIDM5OiBbMiwgMTddLCA0NDogWzIsIDE3XSwgNDc6IFsyLCAxN10sIDQ4OiBbMiwgMTddLCA1MTogWzIsIDE3XSwgNTU6IFsyLCAxN10sIDYwOiBbMiwgMTddIH1dLAoJCSAgICAgICAgZGVmYXVsdEFjdGlvbnM6IHsgNDogWzIsIDFdLCA1NTogWzIsIDU1XSwgNTc6IFsyLCAyMF0sIDYxOiBbMiwgNTddLCA3NDogWzIsIDgxXSwgODM6IFsyLCA4NV0sIDg3OiBbMiwgMThdLCA5MTogWzIsIDg5XSwgMTAyOiBbMiwgNTNdLCAxMDU6IFsyLCA5M10sIDExMTogWzIsIDE5XSwgMTEyOiBbMiwgNzddLCAxMTc6IFsyLCA5N10sIDEyMDogWzIsIDYzXSwgMTIzOiBbMiwgNjldLCAxMjQ6IFsyLCAxMl0sIDEzNjogWzIsIDc1XSwgMTM3OiBbMiwgMzJdIH0sCgkJICAgICAgICBwYXJzZUVycm9yOiBmdW5jdGlvbiBwYXJzZUVycm9yKHN0ciwgaGFzaCkgewoJCSAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihzdHIpOwoJCSAgICAgICAgfSwKCQkgICAgICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZShpbnB1dCkgewoJCSAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcywKCQkgICAgICAgICAgICAgICAgc3RhY2sgPSBbMF0sCgkJICAgICAgICAgICAgICAgIHZzdGFjayA9IFtudWxsXSwKCQkgICAgICAgICAgICAgICAgbHN0YWNrID0gW10sCgkJICAgICAgICAgICAgICAgIHRhYmxlID0gdGhpcy50YWJsZSwKCQkgICAgICAgICAgICAgICAgeXl0ZXh0ID0gIiIsCgkJICAgICAgICAgICAgICAgIHl5bGluZW5vID0gMCwKCQkgICAgICAgICAgICAgICAgeXlsZW5nID0gMCwKCQkgICAgICAgICAgICAgICAgcmVjb3ZlcmluZyA9IDAsCgkJICAgICAgICAgICAgICAgIFRFUlJPUiA9IDIsCgkJICAgICAgICAgICAgICAgIEVPRiA9IDE7CgkJICAgICAgICAgICAgdGhpcy5sZXhlci5zZXRJbnB1dChpbnB1dCk7CgkJICAgICAgICAgICAgdGhpcy5sZXhlci55eSA9IHRoaXMueXk7CgkJICAgICAgICAgICAgdGhpcy55eS5sZXhlciA9IHRoaXMubGV4ZXI7CgkJICAgICAgICAgICAgdGhpcy55eS5wYXJzZXIgPSB0aGlzOwoJCSAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5sZXhlci55eWxsb2MgPT0gInVuZGVmaW5lZCIpIHRoaXMubGV4ZXIueXlsbG9jID0ge307CgkJICAgICAgICAgICAgdmFyIHl5bG9jID0gdGhpcy5sZXhlci55eWxsb2M7CgkJICAgICAgICAgICAgbHN0YWNrLnB1c2goeXlsb2MpOwoJCSAgICAgICAgICAgIHZhciByYW5nZXMgPSB0aGlzLmxleGVyLm9wdGlvbnMgJiYgdGhpcy5sZXhlci5vcHRpb25zLnJhbmdlczsKCQkgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMueXkucGFyc2VFcnJvciA9PT0gImZ1bmN0aW9uIikgdGhpcy5wYXJzZUVycm9yID0gdGhpcy55eS5wYXJzZUVycm9yOwoJCSAgICAgICAgICAgIGZ1bmN0aW9uIHBvcFN0YWNrKG4pIHsKCQkgICAgICAgICAgICAgICAgc3RhY2subGVuZ3RoID0gc3RhY2subGVuZ3RoIC0gMiAqIG47CgkJICAgICAgICAgICAgICAgIHZzdGFjay5sZW5ndGggPSB2c3RhY2subGVuZ3RoIC0gbjsKCQkgICAgICAgICAgICAgICAgbHN0YWNrLmxlbmd0aCA9IGxzdGFjay5sZW5ndGggLSBuOwoJCSAgICAgICAgICAgIH0KCQkgICAgICAgICAgICBmdW5jdGlvbiBsZXgoKSB7CgkJICAgICAgICAgICAgICAgIHZhciB0b2tlbjsKCQkgICAgICAgICAgICAgICAgdG9rZW4gPSBzZWxmLmxleGVyLmxleCgpIHx8IDE7CgkJICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG9rZW4gIT09ICJudW1iZXIiKSB7CgkJICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHNlbGYuc3ltYm9sc19bdG9rZW5dIHx8IHRva2VuOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjsKCQkgICAgICAgICAgICB9CgkJICAgICAgICAgICAgdmFyIHN5bWJvbCwKCQkgICAgICAgICAgICAgICAgcHJlRXJyb3JTeW1ib2wsCgkJICAgICAgICAgICAgICAgIHN0YXRlLAoJCSAgICAgICAgICAgICAgICBhY3Rpb24sCgkJICAgICAgICAgICAgICAgIGEsCgkJICAgICAgICAgICAgICAgIHIsCgkJICAgICAgICAgICAgICAgIHl5dmFsID0ge30sCgkJICAgICAgICAgICAgICAgIHAsCgkJICAgICAgICAgICAgICAgIGxlbiwKCQkgICAgICAgICAgICAgICAgbmV3U3RhdGUsCgkJICAgICAgICAgICAgICAgIGV4cGVjdGVkOwoJCSAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7CgkJICAgICAgICAgICAgICAgIHN0YXRlID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07CgkJICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlZmF1bHRBY3Rpb25zW3N0YXRlXSkgewoJCSAgICAgICAgICAgICAgICAgICAgYWN0aW9uID0gdGhpcy5kZWZhdWx0QWN0aW9uc1tzdGF0ZV07CgkJICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICBpZiAoc3ltYm9sID09PSBudWxsIHx8IHR5cGVvZiBzeW1ib2wgPT0gInVuZGVmaW5lZCIpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2wgPSBsZXgoKTsKCQkgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IHRhYmxlW3N0YXRlXSAmJiB0YWJsZVtzdGF0ZV1bc3ltYm9sXTsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFjdGlvbiA9PT0gInVuZGVmaW5lZCIgfHwgIWFjdGlvbi5sZW5ndGggfHwgIWFjdGlvblswXSkgewoJCSAgICAgICAgICAgICAgICAgICAgdmFyIGVyclN0ciA9ICIiOwoJCSAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWNvdmVyaW5nKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHAgaW4gdGFibGVbc3RhdGVdKSBpZiAodGhpcy50ZXJtaW5hbHNfW3BdICYmIHAgPiAyKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkLnB1c2goIiciICsgdGhpcy50ZXJtaW5hbHNfW3BdICsgIiciKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubGV4ZXIuc2hvd1Bvc2l0aW9uKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICJQYXJzZSBlcnJvciBvbiBsaW5lICIgKyAoeXlsaW5lbm8gKyAxKSArICI6XG4iICsgdGhpcy5sZXhlci5zaG93UG9zaXRpb24oKSArICJcbkV4cGVjdGluZyAiICsgZXhwZWN0ZWQuam9pbigiLCAiKSArICIsIGdvdCAnIiArICh0aGlzLnRlcm1pbmFsc19bc3ltYm9sXSB8fCBzeW1ib2wpICsgIiciOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICJQYXJzZSBlcnJvciBvbiBsaW5lICIgKyAoeXlsaW5lbm8gKyAxKSArICI6IFVuZXhwZWN0ZWQgIiArIChzeW1ib2wgPT0gMSA/ICJlbmQgb2YgaW5wdXQiIDogIiciICsgKHRoaXMudGVybWluYWxzX1tzeW1ib2xdIHx8IHN5bWJvbCkgKyAiJyIpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlRXJyb3IoZXJyU3RyLCB7IHRleHQ6IHRoaXMubGV4ZXIubWF0Y2gsIHRva2VuOiB0aGlzLnRlcm1pbmFsc19bc3ltYm9sXSB8fCBzeW1ib2wsIGxpbmU6IHRoaXMubGV4ZXIueXlsaW5lbm8sIGxvYzogeXlsb2MsIGV4cGVjdGVkOiBleHBlY3RlZCB9KTsKCQkgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBpZiAoYWN0aW9uWzBdIGluc3RhbmNlb2YgQXJyYXkgJiYgYWN0aW9uLmxlbmd0aCA+IDEpIHsKCQkgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiUGFyc2UgRXJyb3I6IG11bHRpcGxlIGFjdGlvbnMgcG9zc2libGUgYXQgc3RhdGU6ICIgKyBzdGF0ZSArICIsIHRva2VuOiAiICsgc3ltYm9sKTsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBzd2l0Y2ggKGFjdGlvblswXSkgewoJCSAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goc3ltYm9sKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB2c3RhY2sucHVzaCh0aGlzLmxleGVyLnl5dGV4dCk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgbHN0YWNrLnB1c2godGhpcy5sZXhlci55eWxsb2MpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goYWN0aW9uWzFdKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2wgPSBudWxsOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJlRXJyb3JTeW1ib2wpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXlsZW5nID0gdGhpcy5sZXhlci55eWxlbmc7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl5dGV4dCA9IHRoaXMubGV4ZXIueXl0ZXh0OwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB5eWxpbmVubyA9IHRoaXMubGV4ZXIueXlsaW5lbm87CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl5bG9jID0gdGhpcy5sZXhlci55eWxsb2M7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWNvdmVyaW5nID4gMCkgcmVjb3ZlcmluZy0tOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5bWJvbCA9IHByZUVycm9yU3ltYm9sOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVFcnJvclN5bWJvbCA9IG51bGw7CgkJICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgoJCSAgICAgICAgICAgICAgICAgICAgICAgIGxlbiA9IHRoaXMucHJvZHVjdGlvbnNfW2FjdGlvblsxXV1bMV07CgkJICAgICAgICAgICAgICAgICAgICAgICAgeXl2YWwuJCA9IHZzdGFja1t2c3RhY2subGVuZ3RoIC0gbGVuXTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB5eXZhbC5fJCA9IHsgZmlyc3RfbGluZTogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAobGVuIHx8IDEpXS5maXJzdF9saW5lLCBsYXN0X2xpbmU6IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gMV0ubGFzdF9saW5lLCBmaXJzdF9jb2x1bW46IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gKGxlbiB8fCAxKV0uZmlyc3RfY29sdW1uLCBsYXN0X2NvbHVtbjogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAxXS5sYXN0X2NvbHVtbiB9OwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZXMpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXl2YWwuXyQucmFuZ2UgPSBbbHN0YWNrW2xzdGFjay5sZW5ndGggLSAobGVuIHx8IDEpXS5yYW5nZVswXSwgbHN0YWNrW2xzdGFjay5sZW5ndGggLSAxXS5yYW5nZVsxXV07CgkJICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgIHIgPSB0aGlzLnBlcmZvcm1BY3Rpb24uY2FsbCh5eXZhbCwgeXl0ZXh0LCB5eWxlbmcsIHl5bGluZW5vLCB0aGlzLnl5LCBhY3Rpb25bMV0sIHZzdGFjaywgbHN0YWNrKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICJ1bmRlZmluZWQiKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGVuKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrID0gc3RhY2suc2xpY2UoMCwgLTEgKiBsZW4gKiAyKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnN0YWNrID0gdnN0YWNrLnNsaWNlKDAsIC0xICogbGVuKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbHN0YWNrID0gbHN0YWNrLnNsaWNlKDAsIC0xICogbGVuKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaCh0aGlzLnByb2R1Y3Rpb25zX1thY3Rpb25bMV1dWzBdKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB2c3RhY2sucHVzaCh5eXZhbC4kKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBsc3RhY2sucHVzaCh5eXZhbC5fJCk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGUgPSB0YWJsZVtzdGFja1tzdGFjay5sZW5ndGggLSAyXV1bc3RhY2tbc3RhY2subGVuZ3RoIC0gMV1dOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobmV3U3RhdGUpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgoJCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgfQoJCSAgICAgICAgICAgIHJldHVybiB0cnVlOwoJCSAgICAgICAgfQoJCSAgICB9OwoJCSAgICAvKiBKaXNvbiBnZW5lcmF0ZWQgbGV4ZXIgKi8KCQkgICAgdmFyIGxleGVyID0gKGZ1bmN0aW9uICgpIHsKCQkgICAgICAgIHZhciBsZXhlciA9IHsgRU9GOiAxLAoJCSAgICAgICAgICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uIHBhcnNlRXJyb3Ioc3RyLCBoYXNoKSB7CgkJICAgICAgICAgICAgICAgIGlmICh0aGlzLnl5LnBhcnNlcikgewoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eS5wYXJzZXIucGFyc2VFcnJvcihzdHIsIGhhc2gpOwoJCSAgICAgICAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHN0cik7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIHNldElucHV0OiBmdW5jdGlvbiBzZXRJbnB1dChpbnB1dCkgewoJCSAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dCA9IGlucHV0OwoJCSAgICAgICAgICAgICAgICB0aGlzLl9tb3JlID0gdGhpcy5fbGVzcyA9IHRoaXMuZG9uZSA9IGZhbHNlOwoJCSAgICAgICAgICAgICAgICB0aGlzLnl5bGluZW5vID0gdGhpcy55eWxlbmcgPSAwOwoJCSAgICAgICAgICAgICAgICB0aGlzLnl5dGV4dCA9IHRoaXMubWF0Y2hlZCA9IHRoaXMubWF0Y2ggPSAnJzsKCQkgICAgICAgICAgICAgICAgdGhpcy5jb25kaXRpb25TdGFjayA9IFsnSU5JVElBTCddOwoJCSAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYyA9IHsgZmlyc3RfbGluZTogMSwgZmlyc3RfY29sdW1uOiAwLCBsYXN0X2xpbmU6IDEsIGxhc3RfY29sdW1uOiAwIH07CgkJICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB0aGlzLnl5bGxvYy5yYW5nZSA9IFswLCAwXTsKCQkgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSAwOwoJCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIGlucHV0OiBmdW5jdGlvbiBpbnB1dCgpIHsKCQkgICAgICAgICAgICAgICAgdmFyIGNoID0gdGhpcy5faW5wdXRbMF07CgkJICAgICAgICAgICAgICAgIHRoaXMueXl0ZXh0ICs9IGNoOwoJCSAgICAgICAgICAgICAgICB0aGlzLnl5bGVuZysrOwoJCSAgICAgICAgICAgICAgICB0aGlzLm9mZnNldCsrOwoJCSAgICAgICAgICAgICAgICB0aGlzLm1hdGNoICs9IGNoOwoJCSAgICAgICAgICAgICAgICB0aGlzLm1hdGNoZWQgKz0gY2g7CgkJICAgICAgICAgICAgICAgIHZhciBsaW5lcyA9IGNoLm1hdGNoKC8oPzpcclxuP3xcbikuKi9nKTsKCQkgICAgICAgICAgICAgICAgaWYgKGxpbmVzKSB7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGluZW5vKys7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2xpbmUrKzsKCQkgICAgICAgICAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uKys7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHRoaXMueXlsbG9jLnJhbmdlWzFdKys7CgoJCSAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX2lucHV0LnNsaWNlKDEpOwoJCSAgICAgICAgICAgICAgICByZXR1cm4gY2g7CgkJICAgICAgICAgICAgfSwKCQkgICAgICAgICAgICB1bnB1dDogZnVuY3Rpb24gdW5wdXQoY2gpIHsKCQkgICAgICAgICAgICAgICAgdmFyIGxlbiA9IGNoLmxlbmd0aDsKCQkgICAgICAgICAgICAgICAgdmFyIGxpbmVzID0gY2guc3BsaXQoLyg/OlxyXG4/fFxuKS9nKTsKCgkJICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0ID0gY2ggKyB0aGlzLl9pbnB1dDsKCQkgICAgICAgICAgICAgICAgdGhpcy55eXRleHQgPSB0aGlzLnl5dGV4dC5zdWJzdHIoMCwgdGhpcy55eXRleHQubGVuZ3RoIC0gbGVuIC0gMSk7CgkJICAgICAgICAgICAgICAgIC8vdGhpcy55eWxlbmcgLT0gbGVuOwoJCSAgICAgICAgICAgICAgICB0aGlzLm9mZnNldCAtPSBsZW47CgkJICAgICAgICAgICAgICAgIHZhciBvbGRMaW5lcyA9IHRoaXMubWF0Y2guc3BsaXQoLyg/OlxyXG4/fFxuKS9nKTsKCQkgICAgICAgICAgICAgICAgdGhpcy5tYXRjaCA9IHRoaXMubWF0Y2guc3Vic3RyKDAsIHRoaXMubWF0Y2gubGVuZ3RoIC0gMSk7CgkJICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hlZCA9IHRoaXMubWF0Y2hlZC5zdWJzdHIoMCwgdGhpcy5tYXRjaGVkLmxlbmd0aCAtIDEpOwoKCQkgICAgICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCAtIDEpIHRoaXMueXlsaW5lbm8gLT0gbGluZXMubGVuZ3RoIC0gMTsKCQkgICAgICAgICAgICAgICAgdmFyIHIgPSB0aGlzLnl5bGxvYy5yYW5nZTsKCgkJICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jID0geyBmaXJzdF9saW5lOiB0aGlzLnl5bGxvYy5maXJzdF9saW5lLAoJCSAgICAgICAgICAgICAgICAgICAgbGFzdF9saW5lOiB0aGlzLnl5bGluZW5vICsgMSwKCQkgICAgICAgICAgICAgICAgICAgIGZpcnN0X2NvbHVtbjogdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uLAoJCSAgICAgICAgICAgICAgICAgICAgbGFzdF9jb2x1bW46IGxpbmVzID8gKGxpbmVzLmxlbmd0aCA9PT0gb2xkTGluZXMubGVuZ3RoID8gdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uIDogMCkgKyBvbGRMaW5lc1tvbGRMaW5lcy5sZW5ndGggLSBsaW5lcy5sZW5ndGhdLmxlbmd0aCAtIGxpbmVzWzBdLmxlbmd0aCA6IHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbiAtIGxlbgoJCSAgICAgICAgICAgICAgICB9OwoKCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlID0gW3JbMF0sIHJbMF0gKyB0aGlzLnl5bGVuZyAtIGxlbl07CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkJICAgICAgICAgICAgfSwKCQkgICAgICAgICAgICBtb3JlOiBmdW5jdGlvbiBtb3JlKCkgewoJCSAgICAgICAgICAgICAgICB0aGlzLl9tb3JlID0gdHJ1ZTsKCQkgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkJICAgICAgICAgICAgfSwKCQkgICAgICAgICAgICBsZXNzOiBmdW5jdGlvbiBsZXNzKG4pIHsKCQkgICAgICAgICAgICAgICAgdGhpcy51bnB1dCh0aGlzLm1hdGNoLnNsaWNlKG4pKTsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIHBhc3RJbnB1dDogZnVuY3Rpb24gcGFzdElucHV0KCkgewoJCSAgICAgICAgICAgICAgICB2YXIgcGFzdCA9IHRoaXMubWF0Y2hlZC5zdWJzdHIoMCwgdGhpcy5tYXRjaGVkLmxlbmd0aCAtIHRoaXMubWF0Y2gubGVuZ3RoKTsKCQkgICAgICAgICAgICAgICAgcmV0dXJuIChwYXN0Lmxlbmd0aCA+IDIwID8gJy4uLicgOiAnJykgKyBwYXN0LnN1YnN0cigtMjApLnJlcGxhY2UoL1xuL2csICIiKTsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIHVwY29taW5nSW5wdXQ6IGZ1bmN0aW9uIHVwY29taW5nSW5wdXQoKSB7CgkJICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gdGhpcy5tYXRjaDsKCQkgICAgICAgICAgICAgICAgaWYgKG5leHQubGVuZ3RoIDwgMjApIHsKCQkgICAgICAgICAgICAgICAgICAgIG5leHQgKz0gdGhpcy5faW5wdXQuc3Vic3RyKDAsIDIwIC0gbmV4dC5sZW5ndGgpOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHJldHVybiAobmV4dC5zdWJzdHIoMCwgMjApICsgKG5leHQubGVuZ3RoID4gMjAgPyAnLi4uJyA6ICcnKSkucmVwbGFjZSgvXG4vZywgIiIpOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgc2hvd1Bvc2l0aW9uOiBmdW5jdGlvbiBzaG93UG9zaXRpb24oKSB7CgkJICAgICAgICAgICAgICAgIHZhciBwcmUgPSB0aGlzLnBhc3RJbnB1dCgpOwoJCSAgICAgICAgICAgICAgICB2YXIgYyA9IG5ldyBBcnJheShwcmUubGVuZ3RoICsgMSkuam9pbigiLSIpOwoJCSAgICAgICAgICAgICAgICByZXR1cm4gcHJlICsgdGhpcy51cGNvbWluZ0lucHV0KCkgKyAiXG4iICsgYyArICJeIjsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7CgkJICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbmUpIHsKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkVPRjsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2lucHV0KSB0aGlzLmRvbmUgPSB0cnVlOwoKCQkgICAgICAgICAgICAgICAgdmFyIHRva2VuLCBtYXRjaCwgdGVtcE1hdGNoLCBpbmRleCwgY29sLCBsaW5lczsKCQkgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9tb3JlKSB7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5dGV4dCA9ICcnOwoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRjaCA9ICcnOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHZhciBydWxlcyA9IHRoaXMuX2N1cnJlbnRSdWxlcygpOwoJCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICAgICAgICAgICAgICB0ZW1wTWF0Y2ggPSB0aGlzLl9pbnB1dC5tYXRjaCh0aGlzLnJ1bGVzW3J1bGVzW2ldXSk7CgkJICAgICAgICAgICAgICAgICAgICBpZiAodGVtcE1hdGNoICYmICghbWF0Y2ggfHwgdGVtcE1hdGNoWzBdLmxlbmd0aCA+IG1hdGNoWzBdLmxlbmd0aCkpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IHRlbXBNYXRjaDsKCQkgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZmxleCkgYnJlYWs7CgkJICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7CgkJICAgICAgICAgICAgICAgICAgICBsaW5lcyA9IG1hdGNoWzBdLm1hdGNoKC8oPzpcclxuP3xcbikuKi9nKTsKCQkgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lcykgdGhpcy55eWxpbmVubyArPSBsaW5lcy5sZW5ndGg7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYyA9IHsgZmlyc3RfbGluZTogdGhpcy55eWxsb2MubGFzdF9saW5lLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfbGluZTogdGhpcy55eWxpbmVubyArIDEsCgkJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfY29sdW1uOiB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbiwKCQkgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X2NvbHVtbjogbGluZXMgPyBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5sZW5ndGggLSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5tYXRjaCgvXHI/XG4/LylbMF0ubGVuZ3RoIDogdGhpcy55eWxsb2MubGFzdF9jb2x1bW4gKyBtYXRjaFswXS5sZW5ndGggfTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXl0ZXh0ICs9IG1hdGNoWzBdOwoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRjaCArPSBtYXRjaFswXTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hlcyA9IG1hdGNoOwoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxlbmcgPSB0aGlzLnl5dGV4dC5sZW5ndGg7CgkJICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlID0gW3RoaXMub2Zmc2V0LCB0aGlzLm9mZnNldCArPSB0aGlzLnl5bGVuZ107CgkJICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3JlID0gZmFsc2U7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX2lucHV0LnNsaWNlKG1hdGNoWzBdLmxlbmd0aCk7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdGNoZWQgKz0gbWF0Y2hbMF07CgkJICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKHRoaXMsIHRoaXMueXksIHRoaXMsIHJ1bGVzW2luZGV4XSwgdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdKTsKCQkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbmUgJiYgdGhpcy5faW5wdXQpIHRoaXMuZG9uZSA9IGZhbHNlOwoJCSAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuKSByZXR1cm4gdG9rZW47ZWxzZSByZXR1cm47CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lucHV0ID09PSAiIikgewoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuRU9GOwoJCSAgICAgICAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VFcnJvcignTGV4aWNhbCBlcnJvciBvbiBsaW5lICcgKyAodGhpcy55eWxpbmVubyArIDEpICsgJy4gVW5yZWNvZ25pemVkIHRleHQuXG4nICsgdGhpcy5zaG93UG9zaXRpb24oKSwgeyB0ZXh0OiAiIiwgdG9rZW46IG51bGwsIGxpbmU6IHRoaXMueXlsaW5lbm8gfSk7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIGxleDogZnVuY3Rpb24gbGV4KCkgewoJCSAgICAgICAgICAgICAgICB2YXIgciA9IHRoaXMubmV4dCgpOwoJCSAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICd1bmRlZmluZWQnKSB7CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjsKCQkgICAgICAgICAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxleCgpOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgfSwKCQkgICAgICAgICAgICBiZWdpbjogZnVuY3Rpb24gYmVnaW4oY29uZGl0aW9uKSB7CgkJICAgICAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uU3RhY2sucHVzaChjb25kaXRpb24pOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgcG9wU3RhdGU6IGZ1bmN0aW9uIHBvcFN0YXRlKCkgewoJCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFjay5wb3AoKTsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIF9jdXJyZW50UnVsZXM6IGZ1bmN0aW9uIF9jdXJyZW50UnVsZXMoKSB7CgkJICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvbnNbdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdXS5ydWxlczsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIHRvcFN0YXRlOiBmdW5jdGlvbiB0b3BTdGF0ZSgpIHsKCQkgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAyXTsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIHB1c2hTdGF0ZTogZnVuY3Rpb24gYmVnaW4oY29uZGl0aW9uKSB7CgkJICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oY29uZGl0aW9uKTsKCQkgICAgICAgICAgICB9IH07CgkJICAgICAgICBsZXhlci5vcHRpb25zID0ge307CgkJICAgICAgICBsZXhlci5wZXJmb3JtQWN0aW9uID0gZnVuY3Rpb24gYW5vbnltb3VzKHl5LCB5eV8sICRhdm9pZGluZ19uYW1lX2NvbGxpc2lvbnMsIFlZX1NUQVJUCgkJICAgICAgICAvKiovKSB7CgoJCSAgICAgICAgICAgIGZ1bmN0aW9uIHN0cmlwKHN0YXJ0LCBlbmQpIHsKCQkgICAgICAgICAgICAgICAgcmV0dXJuIHl5Xy55eXRleHQgPSB5eV8ueXl0ZXh0LnN1YnN0cihzdGFydCwgeXlfLnl5bGVuZyAtIGVuZCk7CgkJICAgICAgICAgICAgfQoKCQkgICAgICAgICAgICB2YXIgWVlTVEFURSA9IFlZX1NUQVJUOwoJCSAgICAgICAgICAgIHN3aXRjaCAoJGF2b2lkaW5nX25hbWVfY29sbGlzaW9ucykgewoJCSAgICAgICAgICAgICAgICBjYXNlIDA6CgkJICAgICAgICAgICAgICAgICAgICBpZiAoeXlfLnl5dGV4dC5zbGljZSgtMikgPT09ICJcXFxcIikgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN0cmlwKDAsIDEpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oIm11Iik7CgkJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHl5Xy55eXRleHQuc2xpY2UoLTEpID09PSAiXFwiKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaXAoMCwgMSk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigiZW11Iik7CgkJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oIm11Iik7CgkJICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICBpZiAoeXlfLnl5dGV4dCkgcmV0dXJuIDE1OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOwoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE1OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLmJlZ2luKCdyYXcnKTtyZXR1cm4gMTU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOwoJCSAgICAgICAgICAgICAgICAgICAgLy8gU2hvdWxkIGJlIHVzaW5nIGB0aGlzLnRvcFN0YXRlKClgIGJlbG93LCBidXQgaXQgY3VycmVudGx5CgkJICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm5zIHRoZSBzZWNvbmQgdG9wIGluc3RlYWQgb2YgdGhlIGZpcnN0IHRvcC4gT3BlbmVkIGFuCgkJICAgICAgICAgICAgICAgICAgICAvLyBpc3N1ZSBhYm91dCBpdCBhdCBodHRwczovL2dpdGh1Yi5jb20vemFhY2gvamlzb24vaXNzdWVzLzI5MQoJCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxXSA9PT0gJ3JhdycpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTU7CgkJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHl5Xy55eXRleHQgPSB5eV8ueXl0ZXh0LnN1YnN0cig1LCB5eV8ueXlsZW5nIC0gOSk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdFTkRfUkFXX0JMT0NLJzsKCQkgICAgICAgICAgICAgICAgICAgIH0KCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA1OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE1OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTsKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAxNDsKCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA3OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDY1OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgODoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA2ODsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDk6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxMDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oJ3JhdycpOwoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDIzOwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDExOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDU1OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTI6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNjA7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxMzoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAyOTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE0OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDQ3OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTU6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7cmV0dXJuIDQ0OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTY6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7cmV0dXJuIDQ0OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTc6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMzQ7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxODoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAzOTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE5OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDUxOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjA6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNDg7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMudW5wdXQoeXlfLnl5dGV4dCk7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLmJlZ2luKCdjb20nKTsKCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTsKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAxNDsKCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMzoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA0ODsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI0OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDczOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjU6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNzI7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyNjoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA3MjsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI3OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDg3OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjg6CgkJICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgd2hpdGVzcGFjZQoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjk6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7cmV0dXJuIDU0OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzA6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7cmV0dXJuIDMzOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzE6CgkJICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0gc3RyaXAoMSwgMikucmVwbGFjZSgvXFwiL2csICciJyk7cmV0dXJuIDgwOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzI6CgkJICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0gc3RyaXAoMSwgMikucmVwbGFjZSgvXFwnL2csICInIik7cmV0dXJuIDgwOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzM6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzNDoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA4MjsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM1OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDgyOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzY6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODM7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzNzoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA4NDsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM4OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDgxOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzk6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNzU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0MDoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA3NzsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQxOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDcyOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDI6CgkJICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0geXlfLnl5dGV4dC5yZXBsYWNlKC9cXChbXFxcXV0pL2csICckMScpO3JldHVybiA3MjsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQzOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdJTlZBTElEJzsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ0OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICB9CgkJICAgICAgICB9OwoJCSAgICAgICAgbGV4ZXIucnVsZXMgPSBbL14oPzpbXlx4MDBdKj8oPz0oXHtceykpKS8sIC9eKD86W15ceDAwXSspLywgL14oPzpbXlx4MDBdezIsfT8oPz0oXHtce3xcXFx7XHt8XFxcXFx7XHt8JCkpKS8sIC9eKD86XHtce1x7XHsoPz1bXlwvXSkpLywgL14oPzpce1x7XHtce1wvW15ccyEiIyUtLFwuXC87LT5AXFstXF5gXHstfl0rKD89Wz19XHNcLy5dKVx9XH1cfVx9KS8sIC9eKD86W15ceDAwXSo/KD89KFx7XHtce1x7KSkpLywgL14oPzpbXHNcU10qPy0tKH4pP1x9XH0pLywgL14oPzpcKCkvLCAvXig/OlwpKS8sIC9eKD86XHtce1x7XHspLywgL14oPzpcfVx9XH1cfSkvLCAvXig/Olx7XHsofik/PikvLCAvXig/Olx7XHsofik/Iz4pLywgL14oPzpce1x7KH4pPyNcKj8pLywgL14oPzpce1x7KH4pP1wvKS8sIC9eKD86XHtceyh+KT9cXlxzKih+KT9cfVx9KS8sIC9eKD86XHtceyh+KT9ccyplbHNlXHMqKH4pP1x9XH0pLywgL14oPzpce1x7KH4pP1xeKS8sIC9eKD86XHtceyh+KT9ccyplbHNlXGIpLywgL14oPzpce1x7KH4pP1x7KS8sIC9eKD86XHtceyh+KT8mKS8sIC9eKD86XHtceyh+KT8hLS0pLywgL14oPzpce1x7KH4pPyFbXHNcU10qP1x9XH0pLywgL14oPzpce1x7KH4pP1wqPykvLCAvXig/Oj0pLywgL14oPzpcLlwuKS8sIC9eKD86XC4oPz0oWz1+fVxzXC8uKXxdKSkpLywgL14oPzpbXC8uXSkvLCAvXig/OlxzKykvLCAvXig/Olx9KH4pP1x9XH0pLywgL14oPzoofik/XH1cfSkvLCAvXig/OiIoXFxbIl18W14iXSkqIikvLCAvXig/OicoXFxbJ118W14nXSkqJykvLCAvXig/OkApLywgL14oPzp0cnVlKD89KFt+fVxzKV0pKSkvLCAvXig/OmZhbHNlKD89KFt+fVxzKV0pKSkvLCAvXig/OnVuZGVmaW5lZCg/PShbfn1ccyldKSkpLywgL14oPzpudWxsKD89KFt+fVxzKV0pKSkvLCAvXig/Oi0/WzAtOV0rKD86XC5bMC05XSspPyg/PShbfn1ccyldKSkpLywgL14oPzphc1xzK1x8KS8sIC9eKD86XHwpLywgL14oPzooW15ccyEiIyUtLFwuXC87LT5AXFstXF5gXHstfl0rKD89KFs9fn1cc1wvLil8XSkpKSkvLCAvXig/OlxbKFxcXF18W15cXV0pKlxdKS8sIC9eKD86LikvLCAvXig/OiQpL107CgkJICAgICAgICBsZXhlci5jb25kaXRpb25zID0geyAibXUiOiB7ICJydWxlcyI6IFs3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3LCAyOCwgMjksIDMwLCAzMSwgMzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDRdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgImVtdSI6IHsgInJ1bGVzIjogWzJdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgImNvbSI6IHsgInJ1bGVzIjogWzZdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgInJhdyI6IHsgInJ1bGVzIjogWzMsIDQsIDVdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgIklOSVRJQUwiOiB7ICJydWxlcyI6IFswLCAxLCA0NF0sICJpbmNsdXNpdmUiOiB0cnVlIH0gfTsKCQkgICAgICAgIHJldHVybiBsZXhlcjsKCQkgICAgfSkoKTsKCQkgICAgcGFyc2VyLmxleGVyID0gbGV4ZXI7CgkJICAgIGZ1bmN0aW9uIFBhcnNlcigpIHsKCQkgICAgICAgIHRoaXMueXkgPSB7fTsKCQkgICAgfVBhcnNlci5wcm90b3R5cGUgPSBwYXJzZXI7cGFyc2VyLlBhcnNlciA9IFBhcnNlcjsKCQkgICAgcmV0dXJuIG5ldyBQYXJzZXIoKTsKCQl9KSgpO2V4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZXhwb3J0c1snZGVmYXVsdCddID0gaGFuZGxlYmFyczsKCgkvKioqLyB9LAoJLyogMjcgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX3Zpc2l0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCgkJdmFyIF92aXNpdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Zpc2l0b3IpOwoKCQlmdW5jdGlvbiBXaGl0ZXNwYWNlQ29udHJvbCgpIHsKCQkgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07CgoJCSAgdGhpcy5vcHRpb25zID0gb3B0aW9uczsKCQl9CgkJV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlID0gbmV3IF92aXNpdG9yMlsnZGVmYXVsdCddKCk7CgoJCVdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5Qcm9ncmFtID0gZnVuY3Rpb24gKHByb2dyYW0pIHsKCQkgIHZhciBkb1N0YW5kYWxvbmUgPSAhdGhpcy5vcHRpb25zLmlnbm9yZVN0YW5kYWxvbmU7CgoJCSAgdmFyIGlzUm9vdCA9ICF0aGlzLmlzUm9vdFNlZW47CgkJICB0aGlzLmlzUm9vdFNlZW4gPSB0cnVlOwoKCQkgIHZhciBib2R5ID0gcHJvZ3JhbS5ib2R5OwoJCSAgZm9yICh2YXIgaSA9IDAsIGwgPSBib2R5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewoJCSAgICB2YXIgY3VycmVudCA9IGJvZHlbaV0sCgkJICAgICAgICBzdHJpcCA9IHRoaXMuYWNjZXB0KGN1cnJlbnQpOwoKCQkgICAgaWYgKCFzdHJpcCkgewoJCSAgICAgIGNvbnRpbnVlOwoJCSAgICB9CgoJCSAgICB2YXIgX2lzUHJldldoaXRlc3BhY2UgPSBpc1ByZXZXaGl0ZXNwYWNlKGJvZHksIGksIGlzUm9vdCksCgkJICAgICAgICBfaXNOZXh0V2hpdGVzcGFjZSA9IGlzTmV4dFdoaXRlc3BhY2UoYm9keSwgaSwgaXNSb290KSwKCQkgICAgICAgIG9wZW5TdGFuZGFsb25lID0gc3RyaXAub3BlblN0YW5kYWxvbmUgJiYgX2lzUHJldldoaXRlc3BhY2UsCgkJICAgICAgICBjbG9zZVN0YW5kYWxvbmUgPSBzdHJpcC5jbG9zZVN0YW5kYWxvbmUgJiYgX2lzTmV4dFdoaXRlc3BhY2UsCgkJICAgICAgICBpbmxpbmVTdGFuZGFsb25lID0gc3RyaXAuaW5saW5lU3RhbmRhbG9uZSAmJiBfaXNQcmV2V2hpdGVzcGFjZSAmJiBfaXNOZXh0V2hpdGVzcGFjZTsKCgkJICAgIGlmIChzdHJpcC5jbG9zZSkgewoJCSAgICAgIG9taXRSaWdodChib2R5LCBpLCB0cnVlKTsKCQkgICAgfQoJCSAgICBpZiAoc3RyaXAub3BlbikgewoJCSAgICAgIG9taXRMZWZ0KGJvZHksIGksIHRydWUpOwoJCSAgICB9CgoJCSAgICBpZiAoZG9TdGFuZGFsb25lICYmIGlubGluZVN0YW5kYWxvbmUpIHsKCQkgICAgICBvbWl0UmlnaHQoYm9keSwgaSk7CgoJCSAgICAgIGlmIChvbWl0TGVmdChib2R5LCBpKSkgewoJCSAgICAgICAgLy8gSWYgd2UgYXJlIG9uIGEgc3RhbmRhbG9uZSBub2RlLCBzYXZlIHRoZSBpbmRlbnQgaW5mbyBmb3IgcGFydGlhbHMKCQkgICAgICAgIGlmIChjdXJyZW50LnR5cGUgPT09ICdQYXJ0aWFsU3RhdGVtZW50JykgewoJCSAgICAgICAgICAvLyBQdWxsIG91dCB0aGUgd2hpdGVzcGFjZSBmcm9tIHRoZSBmaW5hbCBsaW5lCgkJICAgICAgICAgIGN1cnJlbnQuaW5kZW50ID0gLyhbIFx0XSskKS8uZXhlYyhib2R5W2kgLSAxXS5vcmlnaW5hbClbMV07CgkJICAgICAgICB9CgkJICAgICAgfQoJCSAgICB9CgkJICAgIGlmIChkb1N0YW5kYWxvbmUgJiYgb3BlblN0YW5kYWxvbmUpIHsKCQkgICAgICBvbWl0UmlnaHQoKGN1cnJlbnQucHJvZ3JhbSB8fCBjdXJyZW50LmludmVyc2UpLmJvZHkpOwoKCQkgICAgICAvLyBTdHJpcCBvdXQgdGhlIHByZXZpb3VzIGNvbnRlbnQgbm9kZSBpZiBpdCdzIHdoaXRlc3BhY2Ugb25seQoJCSAgICAgIG9taXRMZWZ0KGJvZHksIGkpOwoJCSAgICB9CgkJICAgIGlmIChkb1N0YW5kYWxvbmUgJiYgY2xvc2VTdGFuZGFsb25lKSB7CgkJICAgICAgLy8gQWx3YXlzIHN0cmlwIHRoZSBuZXh0IG5vZGUKCQkgICAgICBvbWl0UmlnaHQoYm9keSwgaSk7CgoJCSAgICAgIG9taXRMZWZ0KChjdXJyZW50LmludmVyc2UgfHwgY3VycmVudC5wcm9ncmFtKS5ib2R5KTsKCQkgICAgfQoJCSAgfQoKCQkgIHJldHVybiBwcm9ncmFtOwoJCX07CgoJCVdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5CbG9ja1N0YXRlbWVudCA9IFdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5EZWNvcmF0b3JCbG9jayA9IFdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5QYXJ0aWFsQmxvY2tTdGF0ZW1lbnQgPSBmdW5jdGlvbiAoYmxvY2spIHsKCQkgIHRoaXMuYWNjZXB0KGJsb2NrLnByb2dyYW0pOwoJCSAgdGhpcy5hY2NlcHQoYmxvY2suaW52ZXJzZSk7CgoJCSAgLy8gRmluZCB0aGUgaW52ZXJzZSBwcm9ncmFtIHRoYXQgaXMgaW52b2xlZCB3aXRoIHdoaXRlc3BhY2Ugc3RyaXBwaW5nLgoJCSAgdmFyIHByb2dyYW0gPSBibG9jay5wcm9ncmFtIHx8IGJsb2NrLmludmVyc2UsCgkJICAgICAgaW52ZXJzZSA9IGJsb2NrLnByb2dyYW0gJiYgYmxvY2suaW52ZXJzZSwKCQkgICAgICBmaXJzdEludmVyc2UgPSBpbnZlcnNlLAoJCSAgICAgIGxhc3RJbnZlcnNlID0gaW52ZXJzZTsKCgkJICBpZiAoaW52ZXJzZSAmJiBpbnZlcnNlLmNoYWluZWQpIHsKCQkgICAgZmlyc3RJbnZlcnNlID0gaW52ZXJzZS5ib2R5WzBdLnByb2dyYW07CgoJCSAgICAvLyBXYWxrIHRoZSBpbnZlcnNlIGNoYWluIHRvIGZpbmQgdGhlIGxhc3QgaW52ZXJzZSB0aGF0IGlzIGFjdHVhbGx5IGluIHRoZSBjaGFpbi4KCQkgICAgd2hpbGUgKGxhc3RJbnZlcnNlLmNoYWluZWQpIHsKCQkgICAgICBsYXN0SW52ZXJzZSA9IGxhc3RJbnZlcnNlLmJvZHlbbGFzdEludmVyc2UuYm9keS5sZW5ndGggLSAxXS5wcm9ncmFtOwoJCSAgICB9CgkJICB9CgoJCSAgdmFyIHN0cmlwID0gewoJCSAgICBvcGVuOiBibG9jay5vcGVuU3RyaXAub3BlbiwKCQkgICAgY2xvc2U6IGJsb2NrLmNsb3NlU3RyaXAuY2xvc2UsCgoJCSAgICAvLyBEZXRlcm1pbmUgdGhlIHN0YW5kYWxvbmUgY2FuZGlhY3kuIEJhc2ljYWxseSBmbGFnIG91ciBjb250ZW50IGFzIGJlaW5nIHBvc3NpYmx5IHN0YW5kYWxvbmUKCQkgICAgLy8gc28gb3VyIHBhcmVudCBjYW4gZGV0ZXJtaW5lIGlmIHdlIGFjdHVhbGx5IGFyZSBzdGFuZGFsb25lCgkJICAgIG9wZW5TdGFuZGFsb25lOiBpc05leHRXaGl0ZXNwYWNlKHByb2dyYW0uYm9keSksCgkJICAgIGNsb3NlU3RhbmRhbG9uZTogaXNQcmV2V2hpdGVzcGFjZSgoZmlyc3RJbnZlcnNlIHx8IHByb2dyYW0pLmJvZHkpCgkJICB9OwoKCQkgIGlmIChibG9jay5vcGVuU3RyaXAuY2xvc2UpIHsKCQkgICAgb21pdFJpZ2h0KHByb2dyYW0uYm9keSwgbnVsbCwgdHJ1ZSk7CgkJICB9CgoJCSAgaWYgKGludmVyc2UpIHsKCQkgICAgdmFyIGludmVyc2VTdHJpcCA9IGJsb2NrLmludmVyc2VTdHJpcDsKCgkJICAgIGlmIChpbnZlcnNlU3RyaXAub3BlbikgewoJCSAgICAgIG9taXRMZWZ0KHByb2dyYW0uYm9keSwgbnVsbCwgdHJ1ZSk7CgkJICAgIH0KCgkJICAgIGlmIChpbnZlcnNlU3RyaXAuY2xvc2UpIHsKCQkgICAgICBvbWl0UmlnaHQoZmlyc3RJbnZlcnNlLmJvZHksIG51bGwsIHRydWUpOwoJCSAgICB9CgkJICAgIGlmIChibG9jay5jbG9zZVN0cmlwLm9wZW4pIHsKCQkgICAgICBvbWl0TGVmdChsYXN0SW52ZXJzZS5ib2R5LCBudWxsLCB0cnVlKTsKCQkgICAgfQoKCQkgICAgLy8gRmluZCBzdGFuZGFsb25lIGVsc2Ugc3RhdG1lbnRzCgkJICAgIGlmICghdGhpcy5vcHRpb25zLmlnbm9yZVN0YW5kYWxvbmUgJiYgaXNQcmV2V2hpdGVzcGFjZShwcm9ncmFtLmJvZHkpICYmIGlzTmV4dFdoaXRlc3BhY2UoZmlyc3RJbnZlcnNlLmJvZHkpKSB7CgkJICAgICAgb21pdExlZnQocHJvZ3JhbS5ib2R5KTsKCQkgICAgICBvbWl0UmlnaHQoZmlyc3RJbnZlcnNlLmJvZHkpOwoJCSAgICB9CgkJICB9IGVsc2UgaWYgKGJsb2NrLmNsb3NlU3RyaXAub3BlbikgewoJCSAgICBvbWl0TGVmdChwcm9ncmFtLmJvZHksIG51bGwsIHRydWUpOwoJCSAgfQoKCQkgIHJldHVybiBzdHJpcDsKCQl9OwoKCQlXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUuRGVjb3JhdG9yID0gV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLk11c3RhY2hlU3RhdGVtZW50ID0gZnVuY3Rpb24gKG11c3RhY2hlKSB7CgkJICByZXR1cm4gbXVzdGFjaGUuc3RyaXA7CgkJfTsKCgkJV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLlBhcnRpYWxTdGF0ZW1lbnQgPSBXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUuQ29tbWVudFN0YXRlbWVudCA9IGZ1bmN0aW9uIChub2RlKSB7CgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgdmFyIHN0cmlwID0gbm9kZS5zdHJpcCB8fCB7fTsKCQkgIHJldHVybiB7CgkJICAgIGlubGluZVN0YW5kYWxvbmU6IHRydWUsCgkJICAgIG9wZW46IHN0cmlwLm9wZW4sCgkJICAgIGNsb3NlOiBzdHJpcC5jbG9zZQoJCSAgfTsKCQl9OwoKCQlmdW5jdGlvbiBpc1ByZXZXaGl0ZXNwYWNlKGJvZHksIGksIGlzUm9vdCkgewoJCSAgaWYgKGkgPT09IHVuZGVmaW5lZCkgewoJCSAgICBpID0gYm9keS5sZW5ndGg7CgkJICB9CgoJCSAgLy8gTm9kZXMgdGhhdCBlbmQgd2l0aCBuZXdsaW5lcyBhcmUgY29uc2lkZXJlZCB3aGl0ZXNwYWNlIChidXQgYXJlIHNwZWNpYWwKCQkgIC8vIGNhc2VkIGZvciBzdHJpcCBvcGVyYXRpb25zKQoJCSAgdmFyIHByZXYgPSBib2R5W2kgLSAxXSwKCQkgICAgICBzaWJsaW5nID0gYm9keVtpIC0gMl07CgkJICBpZiAoIXByZXYpIHsKCQkgICAgcmV0dXJuIGlzUm9vdDsKCQkgIH0KCgkJICBpZiAocHJldi50eXBlID09PSAnQ29udGVudFN0YXRlbWVudCcpIHsKCQkgICAgcmV0dXJuIChzaWJsaW5nIHx8ICFpc1Jvb3QgPyAvXHI/XG5ccyo/JC8gOiAvKF58XHI/XG4pXHMqPyQvKS50ZXN0KHByZXYub3JpZ2luYWwpOwoJCSAgfQoJCX0KCQlmdW5jdGlvbiBpc05leHRXaGl0ZXNwYWNlKGJvZHksIGksIGlzUm9vdCkgewoJCSAgaWYgKGkgPT09IHVuZGVmaW5lZCkgewoJCSAgICBpID0gLTE7CgkJICB9CgoJCSAgdmFyIG5leHQgPSBib2R5W2kgKyAxXSwKCQkgICAgICBzaWJsaW5nID0gYm9keVtpICsgMl07CgkJICBpZiAoIW5leHQpIHsKCQkgICAgcmV0dXJuIGlzUm9vdDsKCQkgIH0KCgkJICBpZiAobmV4dC50eXBlID09PSAnQ29udGVudFN0YXRlbWVudCcpIHsKCQkgICAgcmV0dXJuIChzaWJsaW5nIHx8ICFpc1Jvb3QgPyAvXlxzKj9ccj9cbi8gOiAvXlxzKj8oXHI/XG58JCkvKS50ZXN0KG5leHQub3JpZ2luYWwpOwoJCSAgfQoJCX0KCgkJLy8gTWFya3MgdGhlIG5vZGUgdG8gdGhlIHJpZ2h0IG9mIHRoZSBwb3NpdGlvbiBhcyBvbWl0dGVkLgoJCS8vIEkuZS4ge3tmb299fScgJyB3aWxsIG1hcmsgdGhlICcgJyBub2RlIGFzIG9taXR0ZWQuCgkJLy8KCQkvLyBJZiBpIGlzIHVuZGVmaW5lZCwgdGhlbiB0aGUgZmlyc3QgY2hpbGQgd2lsbCBiZSBtYXJrZWQgYXMgc3VjaC4KCQkvLwoJCS8vIElmIG11bGl0cGxlIGlzIHRydXRoeSB0aGVuIGFsbCB3aGl0ZXNwYWNlIHdpbGwgYmUgc3RyaXBwZWQgb3V0IHVudGlsIG5vbi13aGl0ZXNwYWNlCgkJLy8gY29udGVudCBpcyBtZXQuCgkJZnVuY3Rpb24gb21pdFJpZ2h0KGJvZHksIGksIG11bHRpcGxlKSB7CgkJICB2YXIgY3VycmVudCA9IGJvZHlbaSA9PSBudWxsID8gMCA6IGkgKyAxXTsKCQkgIGlmICghY3VycmVudCB8fCBjdXJyZW50LnR5cGUgIT09ICdDb250ZW50U3RhdGVtZW50JyB8fCAhbXVsdGlwbGUgJiYgY3VycmVudC5yaWdodFN0cmlwcGVkKSB7CgkJICAgIHJldHVybjsKCQkgIH0KCgkJICB2YXIgb3JpZ2luYWwgPSBjdXJyZW50LnZhbHVlOwoJCSAgY3VycmVudC52YWx1ZSA9IGN1cnJlbnQudmFsdWUucmVwbGFjZShtdWx0aXBsZSA/IC9eXHMrLyA6IC9eWyBcdF0qXHI/XG4/LywgJycpOwoJCSAgY3VycmVudC5yaWdodFN0cmlwcGVkID0gY3VycmVudC52YWx1ZSAhPT0gb3JpZ2luYWw7CgkJfQoKCQkvLyBNYXJrcyB0aGUgbm9kZSB0byB0aGUgbGVmdCBvZiB0aGUgcG9zaXRpb24gYXMgb21pdHRlZC4KCQkvLyBJLmUuICcgJ3t7Zm9vfX0gd2lsbCBtYXJrIHRoZSAnICcgbm9kZSBhcyBvbWl0dGVkLgoJCS8vCgkJLy8gSWYgaSBpcyB1bmRlZmluZWQgdGhlbiB0aGUgbGFzdCBjaGlsZCB3aWxsIGJlIG1hcmtlZCBhcyBzdWNoLgoJCS8vCgkJLy8gSWYgbXVsaXRwbGUgaXMgdHJ1dGh5IHRoZW4gYWxsIHdoaXRlc3BhY2Ugd2lsbCBiZSBzdHJpcHBlZCBvdXQgdW50aWwgbm9uLXdoaXRlc3BhY2UKCQkvLyBjb250ZW50IGlzIG1ldC4KCQlmdW5jdGlvbiBvbWl0TGVmdChib2R5LCBpLCBtdWx0aXBsZSkgewoJCSAgdmFyIGN1cnJlbnQgPSBib2R5W2kgPT0gbnVsbCA/IGJvZHkubGVuZ3RoIC0gMSA6IGkgLSAxXTsKCQkgIGlmICghY3VycmVudCB8fCBjdXJyZW50LnR5cGUgIT09ICdDb250ZW50U3RhdGVtZW50JyB8fCAhbXVsdGlwbGUgJiYgY3VycmVudC5sZWZ0U3RyaXBwZWQpIHsKCQkgICAgcmV0dXJuOwoJCSAgfQoKCQkgIC8vIFdlIG9taXQgdGhlIGxhc3Qgbm9kZSBpZiBpdCdzIHdoaXRlc3BhY2Ugb25seSBhbmQgbm90IHByZWNlZWRlZCBieSBhIG5vbi1jb250ZW50IG5vZGUuCgkJICB2YXIgb3JpZ2luYWwgPSBjdXJyZW50LnZhbHVlOwoJCSAgY3VycmVudC52YWx1ZSA9IGN1cnJlbnQudmFsdWUucmVwbGFjZShtdWx0aXBsZSA/IC9ccyskLyA6IC9bIFx0XSskLywgJycpOwoJCSAgY3VycmVudC5sZWZ0U3RyaXBwZWQgPSBjdXJyZW50LnZhbHVlICE9PSBvcmlnaW5hbDsKCQkgIHJldHVybiBjdXJyZW50LmxlZnRTdHJpcHBlZDsKCQl9CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IFdoaXRlc3BhY2VDb250cm9sOwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAyOCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsKCgkJZnVuY3Rpb24gVmlzaXRvcigpIHsKCQkgIHRoaXMucGFyZW50cyA9IFtdOwoJCX0KCgkJVmlzaXRvci5wcm90b3R5cGUgPSB7CgkJICBjb25zdHJ1Y3RvcjogVmlzaXRvciwKCQkgIG11dGF0aW5nOiBmYWxzZSwKCgkJICAvLyBWaXNpdHMgYSBnaXZlbiB2YWx1ZS4gSWYgbXV0YXRpbmcsIHdpbGwgcmVwbGFjZSB0aGUgdmFsdWUgaWYgbmVjZXNzYXJ5LgoJCSAgYWNjZXB0S2V5OiBmdW5jdGlvbiBhY2NlcHRLZXkobm9kZSwgbmFtZSkgewoJCSAgICB2YXIgdmFsdWUgPSB0aGlzLmFjY2VwdChub2RlW25hbWVdKTsKCQkgICAgaWYgKHRoaXMubXV0YXRpbmcpIHsKCQkgICAgICAvLyBIYWNreSBzYW5pdHkgY2hlY2s6IFRoaXMgbWF5IGhhdmUgYSBmZXcgZmFsc2UgcG9zaXRpdmVzIGZvciB0eXBlIGZvciB0aGUgaGVscGVyCgkJICAgICAgLy8gbWV0aG9kcyBidXQgd2lsbCBnZW5lcmFsbHkgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGhvdXQgYSBsb3Qgb2Ygb3ZlcmhlYWQuCgkJICAgICAgaWYgKHZhbHVlICYmICFWaXNpdG9yLnByb3RvdHlwZVt2YWx1ZS50eXBlXSkgewoJCSAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1VuZXhwZWN0ZWQgbm9kZSB0eXBlICInICsgdmFsdWUudHlwZSArICciIGZvdW5kIHdoZW4gYWNjZXB0aW5nICcgKyBuYW1lICsgJyBvbiAnICsgbm9kZS50eXBlKTsKCQkgICAgICB9CgkJICAgICAgbm9kZVtuYW1lXSA9IHZhbHVlOwoJCSAgICB9CgkJICB9LAoKCQkgIC8vIFBlcmZvcm1zIGFuIGFjY2VwdCBvcGVyYXRpb24gd2l0aCBhZGRlZCBzYW5pdHkgY2hlY2sgdG8gZW5zdXJlCgkJICAvLyByZXF1aXJlZCBrZXlzIGFyZSBub3QgcmVtb3ZlZC4KCQkgIGFjY2VwdFJlcXVpcmVkOiBmdW5jdGlvbiBhY2NlcHRSZXF1aXJlZChub2RlLCBuYW1lKSB7CgkJICAgIHRoaXMuYWNjZXB0S2V5KG5vZGUsIG5hbWUpOwoKCQkgICAgaWYgKCFub2RlW25hbWVdKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10obm9kZS50eXBlICsgJyByZXF1aXJlcyAnICsgbmFtZSk7CgkJICAgIH0KCQkgIH0sCgoJCSAgLy8gVHJhdmVyc2VzIGEgZ2l2ZW4gYXJyYXkuIElmIG11dGF0aW5nLCBlbXB0eSByZXNwbnNlcyB3aWxsIGJlIHJlbW92ZWQKCQkgIC8vIGZvciBjaGlsZCBlbGVtZW50cy4KCQkgIGFjY2VwdEFycmF5OiBmdW5jdGlvbiBhY2NlcHRBcnJheShhcnJheSkgewoJCSAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewoJCSAgICAgIHRoaXMuYWNjZXB0S2V5KGFycmF5LCBpKTsKCgkJICAgICAgaWYgKCFhcnJheVtpXSkgewoJCSAgICAgICAgYXJyYXkuc3BsaWNlKGksIDEpOwoJCSAgICAgICAgaS0tOwoJCSAgICAgICAgbC0tOwoJCSAgICAgIH0KCQkgICAgfQoJCSAgfSwKCgkJICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdChvYmplY3QpIHsKCQkgICAgaWYgKCFvYmplY3QpIHsKCQkgICAgICByZXR1cm47CgkJICAgIH0KCgkJICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBTYW5pdHkgY29kZSAqLwoJCSAgICBpZiAoIXRoaXNbb2JqZWN0LnR5cGVdKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1Vua25vd24gdHlwZTogJyArIG9iamVjdC50eXBlLCBvYmplY3QpOwoJCSAgICB9CgoJCSAgICBpZiAodGhpcy5jdXJyZW50KSB7CgkJICAgICAgdGhpcy5wYXJlbnRzLnVuc2hpZnQodGhpcy5jdXJyZW50KTsKCQkgICAgfQoJCSAgICB0aGlzLmN1cnJlbnQgPSBvYmplY3Q7CgoJCSAgICB2YXIgcmV0ID0gdGhpc1tvYmplY3QudHlwZV0ob2JqZWN0KTsKCgkJICAgIHRoaXMuY3VycmVudCA9IHRoaXMucGFyZW50cy5zaGlmdCgpOwoKCQkgICAgaWYgKCF0aGlzLm11dGF0aW5nIHx8IHJldCkgewoJCSAgICAgIHJldHVybiByZXQ7CgkJICAgIH0gZWxzZSBpZiAocmV0ICE9PSBmYWxzZSkgewoJCSAgICAgIHJldHVybiBvYmplY3Q7CgkJICAgIH0KCQkgIH0sCgoJCSAgUHJvZ3JhbTogZnVuY3Rpb24gUHJvZ3JhbShwcm9ncmFtKSB7CgkJICAgIHRoaXMuYWNjZXB0QXJyYXkocHJvZ3JhbS5ib2R5KTsKCQkgIH0sCgoJCSAgTXVzdGFjaGVTdGF0ZW1lbnQ6IHZpc2l0U3ViRXhwcmVzc2lvbiwKCQkgIERlY29yYXRvcjogdmlzaXRTdWJFeHByZXNzaW9uLAoKCQkgIEJsb2NrU3RhdGVtZW50OiB2aXNpdEJsb2NrLAoJCSAgRGVjb3JhdG9yQmxvY2s6IHZpc2l0QmxvY2ssCgoJCSAgUGFydGlhbFN0YXRlbWVudDogdmlzaXRQYXJ0aWFsLAoJCSAgUGFydGlhbEJsb2NrU3RhdGVtZW50OiBmdW5jdGlvbiBQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQocGFydGlhbCkgewoJCSAgICB2aXNpdFBhcnRpYWwuY2FsbCh0aGlzLCBwYXJ0aWFsKTsKCgkJICAgIHRoaXMuYWNjZXB0S2V5KHBhcnRpYWwsICdwcm9ncmFtJyk7CgkJICB9LAoKCQkgIENvbnRlbnRTdGF0ZW1lbnQ6IGZ1bmN0aW9uIENvbnRlbnRTdGF0ZW1lbnQoKSAvKiBjb250ZW50ICove30sCgkJICBDb21tZW50U3RhdGVtZW50OiBmdW5jdGlvbiBDb21tZW50U3RhdGVtZW50KCkgLyogY29tbWVudCAqL3t9LAoKCQkgIFN1YkV4cHJlc3Npb246IHZpc2l0U3ViRXhwcmVzc2lvbiwKCgkJICBQYXRoRXhwcmVzc2lvbjogZnVuY3Rpb24gUGF0aEV4cHJlc3Npb24oKSAvKiBwYXRoICove30sCgoJCSAgU3RyaW5nTGl0ZXJhbDogZnVuY3Rpb24gU3RyaW5nTGl0ZXJhbCgpIC8qIHN0cmluZyAqL3t9LAoJCSAgTnVtYmVyTGl0ZXJhbDogZnVuY3Rpb24gTnVtYmVyTGl0ZXJhbCgpIC8qIG51bWJlciAqL3t9LAoJCSAgQm9vbGVhbkxpdGVyYWw6IGZ1bmN0aW9uIEJvb2xlYW5MaXRlcmFsKCkgLyogYm9vbCAqL3t9LAoJCSAgVW5kZWZpbmVkTGl0ZXJhbDogZnVuY3Rpb24gVW5kZWZpbmVkTGl0ZXJhbCgpIC8qIGxpdGVyYWwgKi97fSwKCQkgIE51bGxMaXRlcmFsOiBmdW5jdGlvbiBOdWxsTGl0ZXJhbCgpIC8qIGxpdGVyYWwgKi97fSwKCgkJICBIYXNoOiBmdW5jdGlvbiBIYXNoKGhhc2gpIHsKCQkgICAgdGhpcy5hY2NlcHRBcnJheShoYXNoLnBhaXJzKTsKCQkgIH0sCgkJICBIYXNoUGFpcjogZnVuY3Rpb24gSGFzaFBhaXIocGFpcikgewoJCSAgICB0aGlzLmFjY2VwdFJlcXVpcmVkKHBhaXIsICd2YWx1ZScpOwoJCSAgfQoJCX07CgoJCWZ1bmN0aW9uIHZpc2l0U3ViRXhwcmVzc2lvbihtdXN0YWNoZSkgewoJCSAgdGhpcy5hY2NlcHRSZXF1aXJlZChtdXN0YWNoZSwgJ3BhdGgnKTsKCQkgIHRoaXMuYWNjZXB0QXJyYXkobXVzdGFjaGUucGFyYW1zKTsKCQkgIHRoaXMuYWNjZXB0S2V5KG11c3RhY2hlLCAnaGFzaCcpOwoJCX0KCQlmdW5jdGlvbiB2aXNpdEJsb2NrKGJsb2NrKSB7CgkJICB2aXNpdFN1YkV4cHJlc3Npb24uY2FsbCh0aGlzLCBibG9jayk7CgoJCSAgdGhpcy5hY2NlcHRLZXkoYmxvY2ssICdwcm9ncmFtJyk7CgkJICB0aGlzLmFjY2VwdEtleShibG9jaywgJ2ludmVyc2UnKTsKCQl9CgkJZnVuY3Rpb24gdmlzaXRQYXJ0aWFsKHBhcnRpYWwpIHsKCQkgIHRoaXMuYWNjZXB0UmVxdWlyZWQocGFydGlhbCwgJ25hbWUnKTsKCQkgIHRoaXMuYWNjZXB0QXJyYXkocGFydGlhbC5wYXJhbXMpOwoJCSAgdGhpcy5hY2NlcHRLZXkocGFydGlhbCwgJ2hhc2gnKTsKCQl9CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IFZpc2l0b3I7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDI5ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCQlleHBvcnRzLlNvdXJjZUxvY2F0aW9uID0gU291cmNlTG9jYXRpb247CgkJZXhwb3J0cy5pZCA9IGlkOwoJCWV4cG9ydHMuc3RyaXBGbGFncyA9IHN0cmlwRmxhZ3M7CgkJZXhwb3J0cy5zdHJpcENvbW1lbnQgPSBzdHJpcENvbW1lbnQ7CgkJZXhwb3J0cy5wcmVwYXJlUGF0aCA9IHByZXBhcmVQYXRoOwoJCWV4cG9ydHMucHJlcGFyZU11c3RhY2hlID0gcHJlcGFyZU11c3RhY2hlOwoJCWV4cG9ydHMucHJlcGFyZVJhd0Jsb2NrID0gcHJlcGFyZVJhd0Jsb2NrOwoJCWV4cG9ydHMucHJlcGFyZUJsb2NrID0gcHJlcGFyZUJsb2NrOwoJCWV4cG9ydHMucHJlcGFyZVByb2dyYW0gPSBwcmVwYXJlUHJvZ3JhbTsKCQlleHBvcnRzLnByZXBhcmVQYXJ0aWFsQmxvY2sgPSBwcmVwYXJlUGFydGlhbEJsb2NrOwoKCQl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7CgoJCWZ1bmN0aW9uIHZhbGlkYXRlQ2xvc2Uob3BlbiwgY2xvc2UpIHsKCQkgIGNsb3NlID0gY2xvc2UucGF0aCA/IGNsb3NlLnBhdGgub3JpZ2luYWwgOiBjbG9zZTsKCgkJICBpZiAob3Blbi5wYXRoLm9yaWdpbmFsICE9PSBjbG9zZSkgewoJCSAgICB2YXIgZXJyb3JOb2RlID0geyBsb2M6IG9wZW4ucGF0aC5sb2MgfTsKCgkJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKG9wZW4ucGF0aC5vcmlnaW5hbCArICIgZG9lc24ndCBtYXRjaCAiICsgY2xvc2UsIGVycm9yTm9kZSk7CgkJICB9CgkJfQoKCQlmdW5jdGlvbiBTb3VyY2VMb2NhdGlvbihzb3VyY2UsIGxvY0luZm8pIHsKCQkgIHRoaXMuc291cmNlID0gc291cmNlOwoJCSAgdGhpcy5zdGFydCA9IHsKCQkgICAgbGluZTogbG9jSW5mby5maXJzdF9saW5lLAoJCSAgICBjb2x1bW46IGxvY0luZm8uZmlyc3RfY29sdW1uCgkJICB9OwoJCSAgdGhpcy5lbmQgPSB7CgkJICAgIGxpbmU6IGxvY0luZm8ubGFzdF9saW5lLAoJCSAgICBjb2x1bW46IGxvY0luZm8ubGFzdF9jb2x1bW4KCQkgIH07CgkJfQoKCQlmdW5jdGlvbiBpZCh0b2tlbikgewoJCSAgaWYgKC9eXFsuKlxdJC8udGVzdCh0b2tlbikpIHsKCQkgICAgcmV0dXJuIHRva2VuLnN1YnN0cigxLCB0b2tlbi5sZW5ndGggLSAyKTsKCQkgIH0gZWxzZSB7CgkJICAgIHJldHVybiB0b2tlbjsKCQkgIH0KCQl9CgoJCWZ1bmN0aW9uIHN0cmlwRmxhZ3Mob3BlbiwgY2xvc2UpIHsKCQkgIHJldHVybiB7CgkJICAgIG9wZW46IG9wZW4uY2hhckF0KDIpID09PSAnficsCgkJICAgIGNsb3NlOiBjbG9zZS5jaGFyQXQoY2xvc2UubGVuZ3RoIC0gMykgPT09ICd+JwoJCSAgfTsKCQl9CgoJCWZ1bmN0aW9uIHN0cmlwQ29tbWVudChjb21tZW50KSB7CgkJICByZXR1cm4gY29tbWVudC5yZXBsYWNlKC9eXHtce34/XCEtPy0/LywgJycpLnJlcGxhY2UoLy0/LT9+P1x9XH0kLywgJycpOwoJCX0KCgkJZnVuY3Rpb24gcHJlcGFyZVBhdGgoZGF0YSwgcGFydHMsIGxvYykgewoJCSAgbG9jID0gdGhpcy5sb2NJbmZvKGxvYyk7CgoJCSAgdmFyIG9yaWdpbmFsID0gZGF0YSA/ICdAJyA6ICcnLAoJCSAgICAgIGRpZyA9IFtdLAoJCSAgICAgIGRlcHRoID0gMCwKCQkgICAgICBkZXB0aFN0cmluZyA9ICcnOwoKCQkgIGZvciAodmFyIGkgPSAwLCBsID0gcGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkJICAgIHZhciBwYXJ0ID0gcGFydHNbaV0ucGFydCwKCgkJICAgIC8vIElmIHdlIGhhdmUgW10gc3ludGF4IHRoZW4gd2UgZG8gbm90IHRyZWF0IHBhdGggcmVmZXJlbmNlcyBhcyBvcGVyYXRvcnMsCgkJICAgIC8vIGkuZS4gZm9vLlt0aGlzXSByZXNvbHZlcyB0byBhcHByb3hpbWF0ZWx5IGNvbnRleHQuZm9vWyd0aGlzJ10KCQkgICAgaXNMaXRlcmFsID0gcGFydHNbaV0ub3JpZ2luYWwgIT09IHBhcnQ7CgkJICAgIG9yaWdpbmFsICs9IChwYXJ0c1tpXS5zZXBhcmF0b3IgfHwgJycpICsgcGFydDsKCgkJICAgIGlmICghaXNMaXRlcmFsICYmIChwYXJ0ID09PSAnLi4nIHx8IHBhcnQgPT09ICcuJyB8fCBwYXJ0ID09PSAndGhpcycpKSB7CgkJICAgICAgaWYgKGRpZy5sZW5ndGggPiAwKSB7CgkJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnSW52YWxpZCBwYXRoOiAnICsgb3JpZ2luYWwsIHsgbG9jOiBsb2MgfSk7CgkJICAgICAgfSBlbHNlIGlmIChwYXJ0ID09PSAnLi4nKSB7CgkJICAgICAgICBkZXB0aCsrOwoJCSAgICAgICAgZGVwdGhTdHJpbmcgKz0gJy4uLyc7CgkJICAgICAgfQoJCSAgICB9IGVsc2UgewoJCSAgICAgIGRpZy5wdXNoKHBhcnQpOwoJCSAgICB9CgkJICB9CgoJCSAgcmV0dXJuIHsKCQkgICAgdHlwZTogJ1BhdGhFeHByZXNzaW9uJywKCQkgICAgZGF0YTogZGF0YSwKCQkgICAgZGVwdGg6IGRlcHRoLAoJCSAgICBwYXJ0czogZGlnLAoJCSAgICBvcmlnaW5hbDogb3JpZ2luYWwsCgkJICAgIGxvYzogbG9jCgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gcHJlcGFyZU11c3RhY2hlKHBhdGgsIHBhcmFtcywgaGFzaCwgb3Blbiwgc3RyaXAsIGxvY0luZm8pIHsKCQkgIC8vIE11c3QgdXNlIGNoYXJBdCB0byBzdXBwb3J0IElFIHByZS0xMAoJCSAgdmFyIGVzY2FwZUZsYWcgPSBvcGVuLmNoYXJBdCgzKSB8fCBvcGVuLmNoYXJBdCgyKSwKCQkgICAgICBlc2NhcGVkID0gZXNjYXBlRmxhZyAhPT0gJ3snICYmIGVzY2FwZUZsYWcgIT09ICcmJzsKCgkJICB2YXIgZGVjb3JhdG9yID0gL1wqLy50ZXN0KG9wZW4pOwoJCSAgcmV0dXJuIHsKCQkgICAgdHlwZTogZGVjb3JhdG9yID8gJ0RlY29yYXRvcicgOiAnTXVzdGFjaGVTdGF0ZW1lbnQnLAoJCSAgICBwYXRoOiBwYXRoLAoJCSAgICBwYXJhbXM6IHBhcmFtcywKCQkgICAgaGFzaDogaGFzaCwKCQkgICAgZXNjYXBlZDogZXNjYXBlZCwKCQkgICAgc3RyaXA6IHN0cmlwLAoJCSAgICBsb2M6IHRoaXMubG9jSW5mbyhsb2NJbmZvKQoJCSAgfTsKCQl9CgoJCWZ1bmN0aW9uIHByZXBhcmVSYXdCbG9jayhvcGVuUmF3QmxvY2ssIGNvbnRlbnRzLCBjbG9zZSwgbG9jSW5mbykgewoJCSAgdmFsaWRhdGVDbG9zZShvcGVuUmF3QmxvY2ssIGNsb3NlKTsKCgkJICBsb2NJbmZvID0gdGhpcy5sb2NJbmZvKGxvY0luZm8pOwoJCSAgdmFyIHByb2dyYW0gPSB7CgkJICAgIHR5cGU6ICdQcm9ncmFtJywKCQkgICAgYm9keTogY29udGVudHMsCgkJICAgIHN0cmlwOiB7fSwKCQkgICAgbG9jOiBsb2NJbmZvCgkJICB9OwoKCQkgIHJldHVybiB7CgkJICAgIHR5cGU6ICdCbG9ja1N0YXRlbWVudCcsCgkJICAgIHBhdGg6IG9wZW5SYXdCbG9jay5wYXRoLAoJCSAgICBwYXJhbXM6IG9wZW5SYXdCbG9jay5wYXJhbXMsCgkJICAgIGhhc2g6IG9wZW5SYXdCbG9jay5oYXNoLAoJCSAgICBwcm9ncmFtOiBwcm9ncmFtLAoJCSAgICBvcGVuU3RyaXA6IHt9LAoJCSAgICBpbnZlcnNlU3RyaXA6IHt9LAoJCSAgICBjbG9zZVN0cmlwOiB7fSwKCQkgICAgbG9jOiBsb2NJbmZvCgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gcHJlcGFyZUJsb2NrKG9wZW5CbG9jaywgcHJvZ3JhbSwgaW52ZXJzZUFuZFByb2dyYW0sIGNsb3NlLCBpbnZlcnRlZCwgbG9jSW5mbykgewoJCSAgaWYgKGNsb3NlICYmIGNsb3NlLnBhdGgpIHsKCQkgICAgdmFsaWRhdGVDbG9zZShvcGVuQmxvY2ssIGNsb3NlKTsKCQkgIH0KCgkJICB2YXIgZGVjb3JhdG9yID0gL1wqLy50ZXN0KG9wZW5CbG9jay5vcGVuKTsKCgkJICBwcm9ncmFtLmJsb2NrUGFyYW1zID0gb3BlbkJsb2NrLmJsb2NrUGFyYW1zOwoKCQkgIHZhciBpbnZlcnNlID0gdW5kZWZpbmVkLAoJCSAgICAgIGludmVyc2VTdHJpcCA9IHVuZGVmaW5lZDsKCgkJICBpZiAoaW52ZXJzZUFuZFByb2dyYW0pIHsKCQkgICAgaWYgKGRlY29yYXRvcikgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbmV4cGVjdGVkIGludmVyc2UgYmxvY2sgb24gZGVjb3JhdG9yJywgaW52ZXJzZUFuZFByb2dyYW0pOwoJCSAgICB9CgoJCSAgICBpZiAoaW52ZXJzZUFuZFByb2dyYW0uY2hhaW4pIHsKCQkgICAgICBpbnZlcnNlQW5kUHJvZ3JhbS5wcm9ncmFtLmJvZHlbMF0uY2xvc2VTdHJpcCA9IGNsb3NlLnN0cmlwOwoJCSAgICB9CgoJCSAgICBpbnZlcnNlU3RyaXAgPSBpbnZlcnNlQW5kUHJvZ3JhbS5zdHJpcDsKCQkgICAgaW52ZXJzZSA9IGludmVyc2VBbmRQcm9ncmFtLnByb2dyYW07CgkJICB9CgoJCSAgaWYgKGludmVydGVkKSB7CgkJICAgIGludmVydGVkID0gaW52ZXJzZTsKCQkgICAgaW52ZXJzZSA9IHByb2dyYW07CgkJICAgIHByb2dyYW0gPSBpbnZlcnRlZDsKCQkgIH0KCgkJICByZXR1cm4gewoJCSAgICB0eXBlOiBkZWNvcmF0b3IgPyAnRGVjb3JhdG9yQmxvY2snIDogJ0Jsb2NrU3RhdGVtZW50JywKCQkgICAgcGF0aDogb3BlbkJsb2NrLnBhdGgsCgkJICAgIHBhcmFtczogb3BlbkJsb2NrLnBhcmFtcywKCQkgICAgaGFzaDogb3BlbkJsb2NrLmhhc2gsCgkJICAgIHByb2dyYW06IHByb2dyYW0sCgkJICAgIGludmVyc2U6IGludmVyc2UsCgkJICAgIG9wZW5TdHJpcDogb3BlbkJsb2NrLnN0cmlwLAoJCSAgICBpbnZlcnNlU3RyaXA6IGludmVyc2VTdHJpcCwKCQkgICAgY2xvc2VTdHJpcDogY2xvc2UgJiYgY2xvc2Uuc3RyaXAsCgkJICAgIGxvYzogdGhpcy5sb2NJbmZvKGxvY0luZm8pCgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gcHJlcGFyZVByb2dyYW0oc3RhdGVtZW50cywgbG9jKSB7CgkJICBpZiAoIWxvYyAmJiBzdGF0ZW1lbnRzLmxlbmd0aCkgewoJCSAgICB2YXIgZmlyc3RMb2MgPSBzdGF0ZW1lbnRzWzBdLmxvYywKCQkgICAgICAgIGxhc3RMb2MgPSBzdGF0ZW1lbnRzW3N0YXRlbWVudHMubGVuZ3RoIC0gMV0ubG9jOwoKCQkgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KCQkgICAgaWYgKGZpcnN0TG9jICYmIGxhc3RMb2MpIHsKCQkgICAgICBsb2MgPSB7CgkJICAgICAgICBzb3VyY2U6IGZpcnN0TG9jLnNvdXJjZSwKCQkgICAgICAgIHN0YXJ0OiB7CgkJICAgICAgICAgIGxpbmU6IGZpcnN0TG9jLnN0YXJ0LmxpbmUsCgkJICAgICAgICAgIGNvbHVtbjogZmlyc3RMb2Muc3RhcnQuY29sdW1uCgkJICAgICAgICB9LAoJCSAgICAgICAgZW5kOiB7CgkJICAgICAgICAgIGxpbmU6IGxhc3RMb2MuZW5kLmxpbmUsCgkJICAgICAgICAgIGNvbHVtbjogbGFzdExvYy5lbmQuY29sdW1uCgkJICAgICAgICB9CgkJICAgICAgfTsKCQkgICAgfQoJCSAgfQoKCQkgIHJldHVybiB7CgkJICAgIHR5cGU6ICdQcm9ncmFtJywKCQkgICAgYm9keTogc3RhdGVtZW50cywKCQkgICAgc3RyaXA6IHt9LAoJCSAgICBsb2M6IGxvYwoJCSAgfTsKCQl9CgoJCWZ1bmN0aW9uIHByZXBhcmVQYXJ0aWFsQmxvY2sob3BlbiwgcHJvZ3JhbSwgY2xvc2UsIGxvY0luZm8pIHsKCQkgIHZhbGlkYXRlQ2xvc2Uob3BlbiwgY2xvc2UpOwoKCQkgIHJldHVybiB7CgkJICAgIHR5cGU6ICdQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQnLAoJCSAgICBuYW1lOiBvcGVuLnBhdGgsCgkJICAgIHBhcmFtczogb3Blbi5wYXJhbXMsCgkJICAgIGhhc2g6IG9wZW4uaGFzaCwKCQkgICAgcHJvZ3JhbTogcHJvZ3JhbSwKCQkgICAgb3BlblN0cmlwOiBvcGVuLnN0cmlwLAoJCSAgICBjbG9zZVN0cmlwOiBjbG9zZSAmJiBjbG9zZS5zdHJpcCwKCQkgICAgbG9jOiB0aGlzLmxvY0luZm8obG9jSW5mbykKCQkgIH07CgkJfQoKCS8qKiovIH0sCgkvKiAzMCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCS8qIGVzbGludC1kaXNhYmxlIG5ldy1jYXAgKi8KCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCQlleHBvcnRzLkNvbXBpbGVyID0gQ29tcGlsZXI7CgkJZXhwb3J0cy5wcmVjb21waWxlID0gcHJlY29tcGlsZTsKCQlleHBvcnRzLmNvbXBpbGUgPSBjb21waWxlOwoKCQl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQl2YXIgX2FzdCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoKCQl2YXIgX2FzdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hc3QpOwoKCQl2YXIgc2xpY2UgPSBbXS5zbGljZTsKCgkJZnVuY3Rpb24gQ29tcGlsZXIoKSB7fQoKCQkvLyB0aGUgZm91bmRIZWxwZXIgcmVnaXN0ZXIgd2lsbCBkaXNhbWJpZ3VhdGUgaGVscGVyIGxvb2t1cCBmcm9tIGZpbmRpbmcgYQoJCS8vIGZ1bmN0aW9uIGluIGEgY29udGV4dC4gVGhpcyBpcyBuZWNlc3NhcnkgZm9yIG11c3RhY2hlIGNvbXBhdGliaWxpdHksIHdoaWNoCgkJLy8gcmVxdWlyZXMgdGhhdCBjb250ZXh0IGZ1bmN0aW9ucyBpbiBibG9ja3MgYXJlIGV2YWx1YXRlZCBieSBibG9ja0hlbHBlck1pc3NpbmcsCgkJLy8gYW5kIHRoZW4gcHJvY2VlZCBhcyBpZiB0aGUgcmVzdWx0aW5nIHZhbHVlIHdhcyBwcm92aWRlZCB0byBibG9ja0hlbHBlck1pc3NpbmcuCgoJCUNvbXBpbGVyLnByb3RvdHlwZSA9IHsKCQkgIGNvbXBpbGVyOiBDb21waWxlciwKCgkJICBlcXVhbHM6IGZ1bmN0aW9uIGVxdWFscyhvdGhlcikgewoJCSAgICB2YXIgbGVuID0gdGhpcy5vcGNvZGVzLmxlbmd0aDsKCQkgICAgaWYgKG90aGVyLm9wY29kZXMubGVuZ3RoICE9PSBsZW4pIHsKCQkgICAgICByZXR1cm4gZmFsc2U7CgkJICAgIH0KCgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICB2YXIgb3Bjb2RlID0gdGhpcy5vcGNvZGVzW2ldLAoJCSAgICAgICAgICBvdGhlck9wY29kZSA9IG90aGVyLm9wY29kZXNbaV07CgkJICAgICAgaWYgKG9wY29kZS5vcGNvZGUgIT09IG90aGVyT3Bjb2RlLm9wY29kZSB8fCAhYXJnRXF1YWxzKG9wY29kZS5hcmdzLCBvdGhlck9wY29kZS5hcmdzKSkgewoJCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgLy8gV2Uga25vdyB0aGF0IGxlbmd0aCBpcyB0aGUgc2FtZSBiZXR3ZWVuIHRoZSB0d28gYXJyYXlzIGJlY2F1c2UgdGhleSBhcmUgZGlyZWN0bHkgdGllZAoJCSAgICAvLyB0byB0aGUgb3Bjb2RlIGJlaGF2aW9yIGFib3ZlLgoJCSAgICBsZW4gPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsKCQkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewoJCSAgICAgIGlmICghdGhpcy5jaGlsZHJlbltpXS5lcXVhbHMob3RoZXIuY2hpbGRyZW5baV0pKSB7CgkJICAgICAgICByZXR1cm4gZmFsc2U7CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICByZXR1cm4gdHJ1ZTsKCQkgIH0sCgoJCSAgZ3VpZDogMCwKCgkJICBjb21waWxlOiBmdW5jdGlvbiBjb21waWxlKHByb2dyYW0sIG9wdGlvbnMpIHsKCQkgICAgdGhpcy5zb3VyY2VOb2RlID0gW107CgkJICAgIHRoaXMub3Bjb2RlcyA9IFtdOwoJCSAgICB0aGlzLmNoaWxkcmVuID0gW107CgkJICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CgkJICAgIHRoaXMuc3RyaW5nUGFyYW1zID0gb3B0aW9ucy5zdHJpbmdQYXJhbXM7CgkJICAgIHRoaXMudHJhY2tJZHMgPSBvcHRpb25zLnRyYWNrSWRzOwoKCQkgICAgb3B0aW9ucy5ibG9ja1BhcmFtcyA9IG9wdGlvbnMuYmxvY2tQYXJhbXMgfHwgW107CgoJCSAgICAvLyBUaGVzZSBjaGFuZ2VzIHdpbGwgcHJvcGFnYXRlIHRvIHRoZSBvdGhlciBjb21waWxlciBjb21wb25lbnRzCgkJICAgIHZhciBrbm93bkhlbHBlcnMgPSBvcHRpb25zLmtub3duSGVscGVyczsKCQkgICAgb3B0aW9ucy5rbm93bkhlbHBlcnMgPSB7CgkJICAgICAgJ2hlbHBlck1pc3NpbmcnOiB0cnVlLAoJCSAgICAgICdibG9ja0hlbHBlck1pc3NpbmcnOiB0cnVlLAoJCSAgICAgICdlYWNoJzogdHJ1ZSwKCQkgICAgICAnaWYnOiB0cnVlLAoJCSAgICAgICd1bmxlc3MnOiB0cnVlLAoJCSAgICAgICd3aXRoJzogdHJ1ZSwKCQkgICAgICAnbG9nJzogdHJ1ZSwKCQkgICAgICAnbG9va3VwJzogdHJ1ZQoJCSAgICB9OwoJCSAgICBpZiAoa25vd25IZWxwZXJzKSB7CgkJICAgICAgZm9yICh2YXIgX25hbWUgaW4ga25vd25IZWxwZXJzKSB7CgkJICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwoJCSAgICAgICAgaWYgKF9uYW1lIGluIGtub3duSGVscGVycykgewoJCSAgICAgICAgICBvcHRpb25zLmtub3duSGVscGVyc1tfbmFtZV0gPSBrbm93bkhlbHBlcnNbX25hbWVdOwoJCSAgICAgICAgfQoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgcmV0dXJuIHRoaXMuYWNjZXB0KHByb2dyYW0pOwoJCSAgfSwKCgkJICBjb21waWxlUHJvZ3JhbTogZnVuY3Rpb24gY29tcGlsZVByb2dyYW0ocHJvZ3JhbSkgewoJCSAgICB2YXIgY2hpbGRDb21waWxlciA9IG5ldyB0aGlzLmNvbXBpbGVyKCksCgkJICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5ldy1jYXAKCQkgICAgcmVzdWx0ID0gY2hpbGRDb21waWxlci5jb21waWxlKHByb2dyYW0sIHRoaXMub3B0aW9ucyksCgkJICAgICAgICBndWlkID0gdGhpcy5ndWlkKys7CgoJCSAgICB0aGlzLnVzZVBhcnRpYWwgPSB0aGlzLnVzZVBhcnRpYWwgfHwgcmVzdWx0LnVzZVBhcnRpYWw7CgoJCSAgICB0aGlzLmNoaWxkcmVuW2d1aWRdID0gcmVzdWx0OwoJCSAgICB0aGlzLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzIHx8IHJlc3VsdC51c2VEZXB0aHM7CgoJCSAgICByZXR1cm4gZ3VpZDsKCQkgIH0sCgoJCSAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQobm9kZSkgewoJCSAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogU2FuaXR5IGNvZGUgKi8KCQkgICAgaWYgKCF0aGlzW25vZGUudHlwZV0pIHsKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVW5rbm93biB0eXBlOiAnICsgbm9kZS50eXBlLCBub2RlKTsKCQkgICAgfQoKCQkgICAgdGhpcy5zb3VyY2VOb2RlLnVuc2hpZnQobm9kZSk7CgkJICAgIHZhciByZXQgPSB0aGlzW25vZGUudHlwZV0obm9kZSk7CgkJICAgIHRoaXMuc291cmNlTm9kZS5zaGlmdCgpOwoJCSAgICByZXR1cm4gcmV0OwoJCSAgfSwKCgkJICBQcm9ncmFtOiBmdW5jdGlvbiBQcm9ncmFtKHByb2dyYW0pIHsKCQkgICAgdGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLnVuc2hpZnQocHJvZ3JhbS5ibG9ja1BhcmFtcyk7CgoJCSAgICB2YXIgYm9keSA9IHByb2dyYW0uYm9keSwKCQkgICAgICAgIGJvZHlMZW5ndGggPSBib2R5Lmxlbmd0aDsKCQkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib2R5TGVuZ3RoOyBpKyspIHsKCQkgICAgICB0aGlzLmFjY2VwdChib2R5W2ldKTsKCQkgICAgfQoKCQkgICAgdGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLnNoaWZ0KCk7CgoJCSAgICB0aGlzLmlzU2ltcGxlID0gYm9keUxlbmd0aCA9PT0gMTsKCQkgICAgdGhpcy5ibG9ja1BhcmFtcyA9IHByb2dyYW0uYmxvY2tQYXJhbXMgPyBwcm9ncmFtLmJsb2NrUGFyYW1zLmxlbmd0aCA6IDA7CgoJCSAgICByZXR1cm4gdGhpczsKCQkgIH0sCgoJCSAgQmxvY2tTdGF0ZW1lbnQ6IGZ1bmN0aW9uIEJsb2NrU3RhdGVtZW50KGJsb2NrKSB7CgkJICAgIHRyYW5zZm9ybUxpdGVyYWxUb1BhdGgoYmxvY2spOwoKCQkgICAgdmFyIHByb2dyYW0gPSBibG9jay5wcm9ncmFtLAoJCSAgICAgICAgaW52ZXJzZSA9IGJsb2NrLmludmVyc2U7CgoJCSAgICBwcm9ncmFtID0gcHJvZ3JhbSAmJiB0aGlzLmNvbXBpbGVQcm9ncmFtKHByb2dyYW0pOwoJCSAgICBpbnZlcnNlID0gaW52ZXJzZSAmJiB0aGlzLmNvbXBpbGVQcm9ncmFtKGludmVyc2UpOwoKCQkgICAgdmFyIHR5cGUgPSB0aGlzLmNsYXNzaWZ5U2V4cHIoYmxvY2spOwoKCQkgICAgaWYgKHR5cGUgPT09ICdoZWxwZXInKSB7CgkJICAgICAgdGhpcy5oZWxwZXJTZXhwcihibG9jaywgcHJvZ3JhbSwgaW52ZXJzZSk7CgkJICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3NpbXBsZScpIHsKCQkgICAgICB0aGlzLnNpbXBsZVNleHByKGJsb2NrKTsKCgkJICAgICAgLy8gbm93IHRoYXQgdGhlIHNpbXBsZSBtdXN0YWNoZSBpcyByZXNvbHZlZCwgd2UgbmVlZCB0bwoJCSAgICAgIC8vIGV2YWx1YXRlIGl0IGJ5IGV4ZWN1dGluZyBgYmxvY2tIZWxwZXJNaXNzaW5nYAoJCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIHByb2dyYW0pOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIGludmVyc2UpOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdlbXB0eUhhc2gnKTsKCQkgICAgICB0aGlzLm9wY29kZSgnYmxvY2tWYWx1ZScsIGJsb2NrLnBhdGgub3JpZ2luYWwpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMuYW1iaWd1b3VzU2V4cHIoYmxvY2ssIHByb2dyYW0sIGludmVyc2UpOwoKCQkgICAgICAvLyBub3cgdGhhdCB0aGUgc2ltcGxlIG11c3RhY2hlIGlzIHJlc29sdmVkLCB3ZSBuZWVkIHRvCgkJICAgICAgLy8gZXZhbHVhdGUgaXQgYnkgZXhlY3V0aW5nIGBibG9ja0hlbHBlck1pc3NpbmdgCgkJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgcHJvZ3JhbSk7CgkJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgaW52ZXJzZSk7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2VtcHR5SGFzaCcpOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdhbWJpZ3VvdXNCbG9ja1ZhbHVlJyk7CgkJICAgIH0KCgkJICAgIHRoaXMub3Bjb2RlKCdhcHBlbmQnKTsKCQkgIH0sCgoJCSAgRGVjb3JhdG9yQmxvY2s6IGZ1bmN0aW9uIERlY29yYXRvckJsb2NrKGRlY29yYXRvcikgewoJCSAgICB2YXIgcHJvZ3JhbSA9IGRlY29yYXRvci5wcm9ncmFtICYmIHRoaXMuY29tcGlsZVByb2dyYW0oZGVjb3JhdG9yLnByb2dyYW0pOwoJCSAgICB2YXIgcGFyYW1zID0gdGhpcy5zZXR1cEZ1bGxNdXN0YWNoZVBhcmFtcyhkZWNvcmF0b3IsIHByb2dyYW0sIHVuZGVmaW5lZCksCgkJICAgICAgICBwYXRoID0gZGVjb3JhdG9yLnBhdGg7CgoJCSAgICB0aGlzLnVzZURlY29yYXRvcnMgPSB0cnVlOwoJCSAgICB0aGlzLm9wY29kZSgncmVnaXN0ZXJEZWNvcmF0b3InLCBwYXJhbXMubGVuZ3RoLCBwYXRoLm9yaWdpbmFsKTsKCQkgIH0sCgoJCSAgUGFydGlhbFN0YXRlbWVudDogZnVuY3Rpb24gUGFydGlhbFN0YXRlbWVudChwYXJ0aWFsKSB7CgkJICAgIHRoaXMudXNlUGFydGlhbCA9IHRydWU7CgoJCSAgICB2YXIgcHJvZ3JhbSA9IHBhcnRpYWwucHJvZ3JhbTsKCQkgICAgaWYgKHByb2dyYW0pIHsKCQkgICAgICBwcm9ncmFtID0gdGhpcy5jb21waWxlUHJvZ3JhbShwYXJ0aWFsLnByb2dyYW0pOwoJCSAgICB9CgoJCSAgICB2YXIgcGFyYW1zID0gcGFydGlhbC5wYXJhbXM7CgkJICAgIGlmIChwYXJhbXMubGVuZ3RoID4gMSkgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbnN1cHBvcnRlZCBudW1iZXIgb2YgcGFydGlhbCBhcmd1bWVudHM6ICcgKyBwYXJhbXMubGVuZ3RoLCBwYXJ0aWFsKTsKCQkgICAgfSBlbHNlIGlmICghcGFyYW1zLmxlbmd0aCkgewoJCSAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwbGljaXRQYXJ0aWFsQ29udGV4dCkgewoJCSAgICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hMaXRlcmFsJywgJ3VuZGVmaW5lZCcpOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICBwYXJhbXMucHVzaCh7IHR5cGU6ICdQYXRoRXhwcmVzc2lvbicsIHBhcnRzOiBbXSwgZGVwdGg6IDAgfSk7CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICB2YXIgcGFydGlhbE5hbWUgPSBwYXJ0aWFsLm5hbWUub3JpZ2luYWwsCgkJICAgICAgICBpc0R5bmFtaWMgPSBwYXJ0aWFsLm5hbWUudHlwZSA9PT0gJ1N1YkV4cHJlc3Npb24nOwoJCSAgICBpZiAoaXNEeW5hbWljKSB7CgkJICAgICAgdGhpcy5hY2NlcHQocGFydGlhbC5uYW1lKTsKCQkgICAgfQoKCQkgICAgdGhpcy5zZXR1cEZ1bGxNdXN0YWNoZVBhcmFtcyhwYXJ0aWFsLCBwcm9ncmFtLCB1bmRlZmluZWQsIHRydWUpOwoKCQkgICAgdmFyIGluZGVudCA9IHBhcnRpYWwuaW5kZW50IHx8ICcnOwoJCSAgICBpZiAodGhpcy5vcHRpb25zLnByZXZlbnRJbmRlbnQgJiYgaW5kZW50KSB7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2FwcGVuZENvbnRlbnQnLCBpbmRlbnQpOwoJCSAgICAgIGluZGVudCA9ICcnOwoJCSAgICB9CgoJCSAgICB0aGlzLm9wY29kZSgnaW52b2tlUGFydGlhbCcsIGlzRHluYW1pYywgcGFydGlhbE5hbWUsIGluZGVudCk7CgkJICAgIHRoaXMub3Bjb2RlKCdhcHBlbmQnKTsKCQkgIH0sCgkJICBQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQ6IGZ1bmN0aW9uIFBhcnRpYWxCbG9ja1N0YXRlbWVudChwYXJ0aWFsQmxvY2spIHsKCQkgICAgdGhpcy5QYXJ0aWFsU3RhdGVtZW50KHBhcnRpYWxCbG9jayk7CgkJICB9LAoKCQkgIE11c3RhY2hlU3RhdGVtZW50OiBmdW5jdGlvbiBNdXN0YWNoZVN0YXRlbWVudChtdXN0YWNoZSkgewoJCSAgICB0aGlzLlN1YkV4cHJlc3Npb24obXVzdGFjaGUpOwoKCQkgICAgaWYgKG11c3RhY2hlLmVzY2FwZWQgJiYgIXRoaXMub3B0aW9ucy5ub0VzY2FwZSkgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdhcHBlbmRFc2NhcGVkJyk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2FwcGVuZCcpOwoJCSAgICB9CgkJICB9LAoJCSAgRGVjb3JhdG9yOiBmdW5jdGlvbiBEZWNvcmF0b3IoZGVjb3JhdG9yKSB7CgkJICAgIHRoaXMuRGVjb3JhdG9yQmxvY2soZGVjb3JhdG9yKTsKCQkgIH0sCgoJCSAgQ29udGVudFN0YXRlbWVudDogZnVuY3Rpb24gQ29udGVudFN0YXRlbWVudChjb250ZW50KSB7CgkJICAgIGlmIChjb250ZW50LnZhbHVlKSB7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2FwcGVuZENvbnRlbnQnLCBjb250ZW50LnZhbHVlKTsKCQkgICAgfQoJCSAgfSwKCgkJICBDb21tZW50U3RhdGVtZW50OiBmdW5jdGlvbiBDb21tZW50U3RhdGVtZW50KCkge30sCgoJCSAgU3ViRXhwcmVzc2lvbjogZnVuY3Rpb24gU3ViRXhwcmVzc2lvbihzZXhwcikgewoJCSAgICB0cmFuc2Zvcm1MaXRlcmFsVG9QYXRoKHNleHByKTsKCQkgICAgdmFyIHR5cGUgPSB0aGlzLmNsYXNzaWZ5U2V4cHIoc2V4cHIpOwoKCQkgICAgaWYgKHR5cGUgPT09ICdzaW1wbGUnKSB7CgkJICAgICAgdGhpcy5zaW1wbGVTZXhwcihzZXhwcik7CgkJICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2hlbHBlcicpIHsKCQkgICAgICB0aGlzLmhlbHBlclNleHByKHNleHByKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLmFtYmlndW91c1NleHByKHNleHByKTsKCQkgICAgfQoJCSAgfSwKCQkgIGFtYmlndW91c1NleHByOiBmdW5jdGlvbiBhbWJpZ3VvdXNTZXhwcihzZXhwciwgcHJvZ3JhbSwgaW52ZXJzZSkgewoJCSAgICB2YXIgcGF0aCA9IHNleHByLnBhdGgsCgkJICAgICAgICBuYW1lID0gcGF0aC5wYXJ0c1swXSwKCQkgICAgICAgIGlzQmxvY2sgPSBwcm9ncmFtICE9IG51bGwgfHwgaW52ZXJzZSAhPSBudWxsOwoKCQkgICAgdGhpcy5vcGNvZGUoJ2dldENvbnRleHQnLCBwYXRoLmRlcHRoKTsKCgkJICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIHByb2dyYW0pOwoJCSAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBpbnZlcnNlKTsKCgkJICAgIHBhdGguc3RyaWN0ID0gdHJ1ZTsKCQkgICAgdGhpcy5hY2NlcHQocGF0aCk7CgoJCSAgICB0aGlzLm9wY29kZSgnaW52b2tlQW1iaWd1b3VzJywgbmFtZSwgaXNCbG9jayk7CgkJICB9LAoKCQkgIHNpbXBsZVNleHByOiBmdW5jdGlvbiBzaW1wbGVTZXhwcihzZXhwcikgewoJCSAgICB2YXIgcGF0aCA9IHNleHByLnBhdGg7CgkJICAgIHBhdGguc3RyaWN0ID0gdHJ1ZTsKCQkgICAgdGhpcy5hY2NlcHQocGF0aCk7CgkJICAgIHRoaXMub3Bjb2RlKCdyZXNvbHZlUG9zc2libGVMYW1iZGEnKTsKCQkgIH0sCgoJCSAgaGVscGVyU2V4cHI6IGZ1bmN0aW9uIGhlbHBlclNleHByKHNleHByLCBwcm9ncmFtLCBpbnZlcnNlKSB7CgkJICAgIHZhciBwYXJhbXMgPSB0aGlzLnNldHVwRnVsbE11c3RhY2hlUGFyYW1zKHNleHByLCBwcm9ncmFtLCBpbnZlcnNlKSwKCQkgICAgICAgIHBhdGggPSBzZXhwci5wYXRoLAoJCSAgICAgICAgbmFtZSA9IHBhdGgucGFydHNbMF07CgoJCSAgICBpZiAodGhpcy5vcHRpb25zLmtub3duSGVscGVyc1tuYW1lXSkgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdpbnZva2VLbm93bkhlbHBlcicsIHBhcmFtcy5sZW5ndGgsIG5hbWUpOwoJCSAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5rbm93bkhlbHBlcnNPbmx5KSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1lvdSBzcGVjaWZpZWQga25vd25IZWxwZXJzT25seSwgYnV0IHVzZWQgdGhlIHVua25vd24gaGVscGVyICcgKyBuYW1lLCBzZXhwcik7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcGF0aC5zdHJpY3QgPSB0cnVlOwoJCSAgICAgIHBhdGguZmFsc3kgPSB0cnVlOwoKCQkgICAgICB0aGlzLmFjY2VwdChwYXRoKTsKCQkgICAgICB0aGlzLm9wY29kZSgnaW52b2tlSGVscGVyJywgcGFyYW1zLmxlbmd0aCwgcGF0aC5vcmlnaW5hbCwgX2FzdDJbJ2RlZmF1bHQnXS5oZWxwZXJzLnNpbXBsZUlkKHBhdGgpKTsKCQkgICAgfQoJCSAgfSwKCgkJICBQYXRoRXhwcmVzc2lvbjogZnVuY3Rpb24gUGF0aEV4cHJlc3Npb24ocGF0aCkgewoJCSAgICB0aGlzLmFkZERlcHRoKHBhdGguZGVwdGgpOwoJCSAgICB0aGlzLm9wY29kZSgnZ2V0Q29udGV4dCcsIHBhdGguZGVwdGgpOwoKCQkgICAgdmFyIG5hbWUgPSBwYXRoLnBhcnRzWzBdLAoJCSAgICAgICAgc2NvcGVkID0gX2FzdDJbJ2RlZmF1bHQnXS5oZWxwZXJzLnNjb3BlZElkKHBhdGgpLAoJCSAgICAgICAgYmxvY2tQYXJhbUlkID0gIXBhdGguZGVwdGggJiYgIXNjb3BlZCAmJiB0aGlzLmJsb2NrUGFyYW1JbmRleChuYW1lKTsKCgkJICAgIGlmIChibG9ja1BhcmFtSWQpIHsKCQkgICAgICB0aGlzLm9wY29kZSgnbG9va3VwQmxvY2tQYXJhbScsIGJsb2NrUGFyYW1JZCwgcGF0aC5wYXJ0cyk7CgkJICAgIH0gZWxzZSBpZiAoIW5hbWUpIHsKCQkgICAgICAvLyBDb250ZQ==", "base64"));
  res.write(new Buffer("eHQgcmVmZXJlbmNlLCBpLmUuIGB7e2ZvbyAufX1gIG9yIGB7e2ZvbyAuLn19YAoJCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoQ29udGV4dCcpOwoJCSAgICB9IGVsc2UgaWYgKHBhdGguZGF0YSkgewoJCSAgICAgIHRoaXMub3B0aW9ucy5kYXRhID0gdHJ1ZTsKCQkgICAgICB0aGlzLm9wY29kZSgnbG9va3VwRGF0YScsIHBhdGguZGVwdGgsIHBhdGgucGFydHMsIHBhdGguc3RyaWN0KTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLm9wY29kZSgnbG9va3VwT25Db250ZXh0JywgcGF0aC5wYXJ0cywgcGF0aC5mYWxzeSwgcGF0aC5zdHJpY3QsIHNjb3BlZCk7CgkJICAgIH0KCQkgIH0sCgoJCSAgU3RyaW5nTGl0ZXJhbDogZnVuY3Rpb24gU3RyaW5nTGl0ZXJhbChzdHJpbmcpIHsKCQkgICAgdGhpcy5vcGNvZGUoJ3B1c2hTdHJpbmcnLCBzdHJpbmcudmFsdWUpOwoJCSAgfSwKCgkJICBOdW1iZXJMaXRlcmFsOiBmdW5jdGlvbiBOdW1iZXJMaXRlcmFsKG51bWJlcikgewoJCSAgICB0aGlzLm9wY29kZSgncHVzaExpdGVyYWwnLCBudW1iZXIudmFsdWUpOwoJCSAgfSwKCgkJICBCb29sZWFuTGl0ZXJhbDogZnVuY3Rpb24gQm9vbGVhbkxpdGVyYWwoYm9vbCkgewoJCSAgICB0aGlzLm9wY29kZSgncHVzaExpdGVyYWwnLCBib29sLnZhbHVlKTsKCQkgIH0sCgoJCSAgVW5kZWZpbmVkTGl0ZXJhbDogZnVuY3Rpb24gVW5kZWZpbmVkTGl0ZXJhbCgpIHsKCQkgICAgdGhpcy5vcGNvZGUoJ3B1c2hMaXRlcmFsJywgJ3VuZGVmaW5lZCcpOwoJCSAgfSwKCgkJICBOdWxsTGl0ZXJhbDogZnVuY3Rpb24gTnVsbExpdGVyYWwoKSB7CgkJICAgIHRoaXMub3Bjb2RlKCdwdXNoTGl0ZXJhbCcsICdudWxsJyk7CgkJICB9LAoKCQkgIEhhc2g6IGZ1bmN0aW9uIEhhc2goaGFzaCkgewoJCSAgICB2YXIgcGFpcnMgPSBoYXNoLnBhaXJzLAoJCSAgICAgICAgaSA9IDAsCgkJICAgICAgICBsID0gcGFpcnMubGVuZ3RoOwoKCQkgICAgdGhpcy5vcGNvZGUoJ3B1c2hIYXNoJyk7CgoJCSAgICBmb3IgKDsgaSA8IGw7IGkrKykgewoJCSAgICAgIHRoaXMucHVzaFBhcmFtKHBhaXJzW2ldLnZhbHVlKTsKCQkgICAgfQoJCSAgICB3aGlsZSAoaS0tKSB7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2Fzc2lnblRvSGFzaCcsIHBhaXJzW2ldLmtleSk7CgkJICAgIH0KCQkgICAgdGhpcy5vcGNvZGUoJ3BvcEhhc2gnKTsKCQkgIH0sCgoJCSAgLy8gSEVMUEVSUwoJCSAgb3Bjb2RlOiBmdW5jdGlvbiBvcGNvZGUobmFtZSkgewoJCSAgICB0aGlzLm9wY29kZXMucHVzaCh7IG9wY29kZTogbmFtZSwgYXJnczogc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLCBsb2M6IHRoaXMuc291cmNlTm9kZVswXS5sb2MgfSk7CgkJICB9LAoKCQkgIGFkZERlcHRoOiBmdW5jdGlvbiBhZGREZXB0aChkZXB0aCkgewoJCSAgICBpZiAoIWRlcHRoKSB7CgkJICAgICAgcmV0dXJuOwoJCSAgICB9CgoJCSAgICB0aGlzLnVzZURlcHRocyA9IHRydWU7CgkJICB9LAoKCQkgIGNsYXNzaWZ5U2V4cHI6IGZ1bmN0aW9uIGNsYXNzaWZ5U2V4cHIoc2V4cHIpIHsKCQkgICAgdmFyIGlzU2ltcGxlID0gX2FzdDJbJ2RlZmF1bHQnXS5oZWxwZXJzLnNpbXBsZUlkKHNleHByLnBhdGgpOwoKCQkgICAgdmFyIGlzQmxvY2tQYXJhbSA9IGlzU2ltcGxlICYmICEhdGhpcy5ibG9ja1BhcmFtSW5kZXgoc2V4cHIucGF0aC5wYXJ0c1swXSk7CgoJCSAgICAvLyBhIG11c3RhY2hlIGlzIGFuIGVsaWdpYmxlIGhlbHBlciBpZjoKCQkgICAgLy8gKiBpdHMgaWQgaXMgc2ltcGxlIChhIHNpbmdsZSBwYXJ0LCBub3QgYHRoaXNgIG9yIGAuLmApCgkJICAgIHZhciBpc0hlbHBlciA9ICFpc0Jsb2NrUGFyYW0gJiYgX2FzdDJbJ2RlZmF1bHQnXS5oZWxwZXJzLmhlbHBlckV4cHJlc3Npb24oc2V4cHIpOwoKCQkgICAgLy8gaWYgYSBtdXN0YWNoZSBpcyBhbiBlbGlnaWJsZSBoZWxwZXIgYnV0IG5vdCBhIGRlZmluaXRlCgkJICAgIC8vIGhlbHBlciwgaXQgaXMgYW1iaWd1b3VzLCBhbmQgd2lsbCBiZSByZXNvbHZlZCBpbiBhIGxhdGVyCgkJICAgIC8vIHBhc3Mgb3IgYXQgcnVudGltZS4KCQkgICAgdmFyIGlzRWxpZ2libGUgPSAhaXNCbG9ja1BhcmFtICYmIChpc0hlbHBlciB8fCBpc1NpbXBsZSk7CgoJCSAgICAvLyBpZiBhbWJpZ3VvdXMsIHdlIGNhbiBwb3NzaWJseSByZXNvbHZlIHRoZSBhbWJpZ3VpdHkgbm93CgkJICAgIC8vIEFuIGVsaWdpYmxlIGhlbHBlciBpcyBvbmUgdGhhdCBkb2VzIG5vdCBoYXZlIGEgY29tcGxleCBwYXRoLCBpLmUuIGB0aGlzLmZvb2AsIGAuLi9mb29gIGV0Yy4KCQkgICAgaWYgKGlzRWxpZ2libGUgJiYgIWlzSGVscGVyKSB7CgkJICAgICAgdmFyIF9uYW1lMiA9IHNleHByLnBhdGgucGFydHNbMF0sCgkJICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7CgoJCSAgICAgIGlmIChvcHRpb25zLmtub3duSGVscGVyc1tfbmFtZTJdKSB7CgkJICAgICAgICBpc0hlbHBlciA9IHRydWU7CgkJICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmtub3duSGVscGVyc09ubHkpIHsKCQkgICAgICAgIGlzRWxpZ2libGUgPSBmYWxzZTsKCQkgICAgICB9CgkJICAgIH0KCgkJICAgIGlmIChpc0hlbHBlcikgewoJCSAgICAgIHJldHVybiAnaGVscGVyJzsKCQkgICAgfSBlbHNlIGlmIChpc0VsaWdpYmxlKSB7CgkJICAgICAgcmV0dXJuICdhbWJpZ3VvdXMnOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiAnc2ltcGxlJzsKCQkgICAgfQoJCSAgfSwKCgkJICBwdXNoUGFyYW1zOiBmdW5jdGlvbiBwdXNoUGFyYW1zKHBhcmFtcykgewoJCSAgICBmb3IgKHZhciBpID0gMCwgbCA9IHBhcmFtcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCQkgICAgICB0aGlzLnB1c2hQYXJhbShwYXJhbXNbaV0pOwoJCSAgICB9CgkJICB9LAoKCQkgIHB1c2hQYXJhbTogZnVuY3Rpb24gcHVzaFBhcmFtKHZhbCkgewoJCSAgICB2YXIgdmFsdWUgPSB2YWwudmFsdWUgIT0gbnVsbCA/IHZhbC52YWx1ZSA6IHZhbC5vcmlnaW5hbCB8fCAnJzsKCgkJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgewoJCSAgICAgIGlmICh2YWx1ZS5yZXBsYWNlKSB7CgkJICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL14oXC4/XC5cLykqL2csICcnKS5yZXBsYWNlKC9cLy9nLCAnLicpOwoJCSAgICAgIH0KCgkJICAgICAgaWYgKHZhbC5kZXB0aCkgewoJCSAgICAgICAgdGhpcy5hZGREZXB0aCh2YWwuZGVwdGgpOwoJCSAgICAgIH0KCQkgICAgICB0aGlzLm9wY29kZSgnZ2V0Q29udGV4dCcsIHZhbC5kZXB0aCB8fCAwKTsKCQkgICAgICB0aGlzLm9wY29kZSgncHVzaFN0cmluZ1BhcmFtJywgdmFsdWUsIHZhbC50eXBlKTsKCgkJICAgICAgaWYgKHZhbC50eXBlID09PSAnU3ViRXhwcmVzc2lvbicpIHsKCQkgICAgICAgIC8vIFN1YkV4cHJlc3Npb25zIGdldCBldmFsdWF0ZWQgYW5kIHBhc3NlZCBpbgoJCSAgICAgICAgLy8gaW4gc3RyaW5nIHBhcmFtcyBtb2RlLgoJCSAgICAgICAgdGhpcy5hY2NlcHQodmFsKTsKCQkgICAgICB9CgkJICAgIH0gZWxzZSB7CgkJICAgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsKCQkgICAgICAgIHZhciBibG9ja1BhcmFtSW5kZXggPSB1bmRlZmluZWQ7CgkJICAgICAgICBpZiAodmFsLnBhcnRzICYmICFfYXN0MlsnZGVmYXVsdCddLmhlbHBlcnMuc2NvcGVkSWQodmFsKSAmJiAhdmFsLmRlcHRoKSB7CgkJICAgICAgICAgIGJsb2NrUGFyYW1JbmRleCA9IHRoaXMuYmxvY2tQYXJhbUluZGV4KHZhbC5wYXJ0c1swXSk7CgkJICAgICAgICB9CgkJICAgICAgICBpZiAoYmxvY2tQYXJhbUluZGV4KSB7CgkJICAgICAgICAgIHZhciBibG9ja1BhcmFtQ2hpbGQgPSB2YWwucGFydHMuc2xpY2UoMSkuam9pbignLicpOwoJCSAgICAgICAgICB0aGlzLm9wY29kZSgncHVzaElkJywgJ0Jsb2NrUGFyYW0nLCBibG9ja1BhcmFtSW5kZXgsIGJsb2NrUGFyYW1DaGlsZCk7CgkJICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICB2YWx1ZSA9IHZhbC5vcmlnaW5hbCB8fCB2YWx1ZTsKCQkgICAgICAgICAgaWYgKHZhbHVlLnJlcGxhY2UpIHsKCQkgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL150aGlzKD86XC58JCkvLCAnJykucmVwbGFjZSgvXlwuXC8vLCAnJykucmVwbGFjZSgvXlwuJC8sICcnKTsKCQkgICAgICAgICAgfQoKCQkgICAgICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hJZCcsIHZhbC50eXBlLCB2YWx1ZSk7CgkJICAgICAgICB9CgkJICAgICAgfQoJCSAgICAgIHRoaXMuYWNjZXB0KHZhbCk7CgkJICAgIH0KCQkgIH0sCgoJCSAgc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXM6IGZ1bmN0aW9uIHNldHVwRnVsbE11c3RhY2hlUGFyYW1zKHNleHByLCBwcm9ncmFtLCBpbnZlcnNlLCBvbWl0RW1wdHkpIHsKCQkgICAgdmFyIHBhcmFtcyA9IHNleHByLnBhcmFtczsKCQkgICAgdGhpcy5wdXNoUGFyYW1zKHBhcmFtcyk7CgoJCSAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBwcm9ncmFtKTsKCQkgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgaW52ZXJzZSk7CgoJCSAgICBpZiAoc2V4cHIuaGFzaCkgewoJCSAgICAgIHRoaXMuYWNjZXB0KHNleHByLmhhc2gpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdlbXB0eUhhc2gnLCBvbWl0RW1wdHkpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gcGFyYW1zOwoJCSAgfSwKCgkJICBibG9ja1BhcmFtSW5kZXg6IGZ1bmN0aW9uIGJsb2NrUGFyYW1JbmRleChuYW1lKSB7CgkJICAgIGZvciAodmFyIGRlcHRoID0gMCwgbGVuID0gdGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLmxlbmd0aDsgZGVwdGggPCBsZW47IGRlcHRoKyspIHsKCQkgICAgICB2YXIgYmxvY2tQYXJhbXMgPSB0aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXNbZGVwdGhdLAoJCSAgICAgICAgICBwYXJhbSA9IGJsb2NrUGFyYW1zICYmIF91dGlscy5pbmRleE9mKGJsb2NrUGFyYW1zLCBuYW1lKTsKCQkgICAgICBpZiAoYmxvY2tQYXJhbXMgJiYgcGFyYW0gPj0gMCkgewoJCSAgICAgICAgcmV0dXJuIFtkZXB0aCwgcGFyYW1dOwoJCSAgICAgIH0KCQkgICAgfQoJCSAgfQoJCX07CgoJCWZ1bmN0aW9uIHByZWNvbXBpbGUoaW5wdXQsIG9wdGlvbnMsIGVudikgewoJCSAgaWYgKGlucHV0ID09IG51bGwgfHwgdHlwZW9mIGlucHV0ICE9PSAnc3RyaW5nJyAmJiBpbnB1dC50eXBlICE9PSAnUHJvZ3JhbScpIHsKCQkgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1lvdSBtdXN0IHBhc3MgYSBzdHJpbmcgb3IgSGFuZGxlYmFycyBBU1QgdG8gSGFuZGxlYmFycy5wcmVjb21waWxlLiBZb3UgcGFzc2VkICcgKyBpbnB1dCk7CgkJICB9CgoJCSAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgkJICBpZiAoISgnZGF0YScgaW4gb3B0aW9ucykpIHsKCQkgICAgb3B0aW9ucy5kYXRhID0gdHJ1ZTsKCQkgIH0KCQkgIGlmIChvcHRpb25zLmNvbXBhdCkgewoJCSAgICBvcHRpb25zLnVzZURlcHRocyA9IHRydWU7CgkJICB9CgoJCSAgdmFyIGFzdCA9IGVudi5wYXJzZShpbnB1dCwgb3B0aW9ucyksCgkJICAgICAgZW52aXJvbm1lbnQgPSBuZXcgZW52LkNvbXBpbGVyKCkuY29tcGlsZShhc3QsIG9wdGlvbnMpOwoJCSAgcmV0dXJuIG5ldyBlbnYuSmF2YVNjcmlwdENvbXBpbGVyKCkuY29tcGlsZShlbnZpcm9ubWVudCwgb3B0aW9ucyk7CgkJfQoKCQlmdW5jdGlvbiBjb21waWxlKGlucHV0LCBvcHRpb25zLCBlbnYpIHsKCQkgIGlmIChvcHRpb25zID09PSB1bmRlZmluZWQpIG9wdGlvbnMgPSB7fTsKCgkJICBpZiAoaW5wdXQgPT0gbnVsbCB8fCB0eXBlb2YgaW5wdXQgIT09ICdzdHJpbmcnICYmIGlucHV0LnR5cGUgIT09ICdQcm9ncmFtJykgewoJCSAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnWW91IG11c3QgcGFzcyBhIHN0cmluZyBvciBIYW5kbGViYXJzIEFTVCB0byBIYW5kbGViYXJzLmNvbXBpbGUuIFlvdSBwYXNzZWQgJyArIGlucHV0KTsKCQkgIH0KCgkJICBpZiAoISgnZGF0YScgaW4gb3B0aW9ucykpIHsKCQkgICAgb3B0aW9ucy5kYXRhID0gdHJ1ZTsKCQkgIH0KCQkgIGlmIChvcHRpb25zLmNvbXBhdCkgewoJCSAgICBvcHRpb25zLnVzZURlcHRocyA9IHRydWU7CgkJICB9CgoJCSAgdmFyIGNvbXBpbGVkID0gdW5kZWZpbmVkOwoKCQkgIGZ1bmN0aW9uIGNvbXBpbGVJbnB1dCgpIHsKCQkgICAgdmFyIGFzdCA9IGVudi5wYXJzZShpbnB1dCwgb3B0aW9ucyksCgkJICAgICAgICBlbnZpcm9ubWVudCA9IG5ldyBlbnYuQ29tcGlsZXIoKS5jb21waWxlKGFzdCwgb3B0aW9ucyksCgkJICAgICAgICB0ZW1wbGF0ZVNwZWMgPSBuZXcgZW52LkphdmFTY3JpcHRDb21waWxlcigpLmNvbXBpbGUoZW52aXJvbm1lbnQsIG9wdGlvbnMsIHVuZGVmaW5lZCwgdHJ1ZSk7CgkJICAgIHJldHVybiBlbnYudGVtcGxhdGUodGVtcGxhdGVTcGVjKTsKCQkgIH0KCgkJICAvLyBUZW1wbGF0ZSBpcyBvbmx5IGNvbXBpbGVkIG9uIGZpcnN0IHVzZSBhbmQgY2FjaGVkIGFmdGVyIHRoYXQgcG9pbnQuCgkJICBmdW5jdGlvbiByZXQoY29udGV4dCwgZXhlY09wdGlvbnMpIHsKCQkgICAgaWYgKCFjb21waWxlZCkgewoJCSAgICAgIGNvbXBpbGVkID0gY29tcGlsZUlucHV0KCk7CgkJICAgIH0KCQkgICAgcmV0dXJuIGNvbXBpbGVkLmNhbGwodGhpcywgY29udGV4dCwgZXhlY09wdGlvbnMpOwoJCSAgfQoJCSAgcmV0Ll9zZXR1cCA9IGZ1bmN0aW9uIChzZXR1cE9wdGlvbnMpIHsKCQkgICAgaWYgKCFjb21waWxlZCkgewoJCSAgICAgIGNvbXBpbGVkID0gY29tcGlsZUlucHV0KCk7CgkJICAgIH0KCQkgICAgcmV0dXJuIGNvbXBpbGVkLl9zZXR1cChzZXR1cE9wdGlvbnMpOwoJCSAgfTsKCQkgIHJldC5fY2hpbGQgPSBmdW5jdGlvbiAoaSwgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocykgewoJCSAgICBpZiAoIWNvbXBpbGVkKSB7CgkJICAgICAgY29tcGlsZWQgPSBjb21waWxlSW5wdXQoKTsKCQkgICAgfQoJCSAgICByZXR1cm4gY29tcGlsZWQuX2NoaWxkKGksIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOwoJCSAgfTsKCQkgIHJldHVybiByZXQ7CgkJfQoKCQlmdW5jdGlvbiBhcmdFcXVhbHMoYSwgYikgewoJCSAgaWYgKGEgPT09IGIpIHsKCQkgICAgcmV0dXJuIHRydWU7CgkJICB9CgoJCSAgaWYgKF91dGlscy5pc0FycmF5KGEpICYmIF91dGlscy5pc0FycmF5KGIpICYmIGEubGVuZ3RoID09PSBiLmxlbmd0aCkgewoJCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHsKCQkgICAgICBpZiAoIWFyZ0VxdWFscyhhW2ldLCBiW2ldKSkgewoJCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJCSAgICAgIH0KCQkgICAgfQoJCSAgICByZXR1cm4gdHJ1ZTsKCQkgIH0KCQl9CgoJCWZ1bmN0aW9uIHRyYW5zZm9ybUxpdGVyYWxUb1BhdGgoc2V4cHIpIHsKCQkgIGlmICghc2V4cHIucGF0aC5wYXJ0cykgewoJCSAgICB2YXIgbGl0ZXJhbCA9IHNleHByLnBhdGg7CgkJICAgIC8vIENhc3RpbmcgdG8gc3RyaW5nIGhlcmUgdG8gbWFrZSBmYWxzZSBhbmQgMCBsaXRlcmFsIHZhbHVlcyBwbGF5IG5pY2VseSB3aXRoIHRoZSByZXN0CgkJICAgIC8vIG9mIHRoZSBzeXN0ZW0uCgkJICAgIHNleHByLnBhdGggPSB7CgkJICAgICAgdHlwZTogJ1BhdGhFeHByZXNzaW9uJywKCQkgICAgICBkYXRhOiBmYWxzZSwKCQkgICAgICBkZXB0aDogMCwKCQkgICAgICBwYXJ0czogW2xpdGVyYWwub3JpZ2luYWwgKyAnJ10sCgkJICAgICAgb3JpZ2luYWw6IGxpdGVyYWwub3JpZ2luYWwgKyAnJywKCQkgICAgICBsb2M6IGxpdGVyYWwubG9jCgkJICAgIH07CgkJICB9CgkJfQoKCS8qKiovIH0sCgkvKiAzMSAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfYmFzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7CgoJCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBfY29kZUdlbiA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpOwoKCQl2YXIgX2NvZGVHZW4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29kZUdlbik7CgoJCWZ1bmN0aW9uIExpdGVyYWwodmFsdWUpIHsKCQkgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCQl9CgoJCWZ1bmN0aW9uIEphdmFTY3JpcHRDb21waWxlcigpIHt9CgoJCUphdmFTY3JpcHRDb21waWxlci5wcm90b3R5cGUgPSB7CgkJICAvLyBQVUJMSUMgQVBJOiBZb3UgY2FuIG92ZXJyaWRlIHRoZXNlIG1ldGhvZHMgaW4gYSBzdWJjbGFzcyB0byBwcm92aWRlCgkJICAvLyBhbHRlcm5hdGl2ZSBjb21waWxlZCBmb3JtcyBmb3IgbmFtZSBsb29rdXAgYW5kIGJ1ZmZlcmluZyBzZW1hbnRpY3MKCQkgIG5hbWVMb29rdXA6IGZ1bmN0aW9uIG5hbWVMb29rdXAocGFyZW50LCBuYW1lIC8qICwgdHlwZSovKSB7CgkJICAgIGlmIChKYXZhU2NyaXB0Q29tcGlsZXIuaXNWYWxpZEphdmFTY3JpcHRWYXJpYWJsZU5hbWUobmFtZSkpIHsKCQkgICAgICByZXR1cm4gW3BhcmVudCwgJy4nLCBuYW1lXTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICByZXR1cm4gW3BhcmVudCwgJ1snLCBKU09OLnN0cmluZ2lmeShuYW1lKSwgJ10nXTsKCQkgICAgfQoJCSAgfSwKCQkgIGRlcHRoZWRMb29rdXA6IGZ1bmN0aW9uIGRlcHRoZWRMb29rdXAobmFtZSkgewoJCSAgICByZXR1cm4gW3RoaXMuYWxpYXNhYmxlKCdjb250YWluZXIubG9va3VwJyksICcoZGVwdGhzLCAiJywgbmFtZSwgJyIpJ107CgkJICB9LAoKCQkgIGNvbXBpbGVySW5mbzogZnVuY3Rpb24gY29tcGlsZXJJbmZvKCkgewoJCSAgICB2YXIgcmV2aXNpb24gPSBfYmFzZS5DT01QSUxFUl9SRVZJU0lPTiwKCQkgICAgICAgIHZlcnNpb25zID0gX2Jhc2UuUkVWSVNJT05fQ0hBTkdFU1tyZXZpc2lvbl07CgkJICAgIHJldHVybiBbcmV2aXNpb24sIHZlcnNpb25zXTsKCQkgIH0sCgoJCSAgYXBwZW5kVG9CdWZmZXI6IGZ1bmN0aW9uIGFwcGVuZFRvQnVmZmVyKHNvdXJjZSwgbG9jYXRpb24sIGV4cGxpY2l0KSB7CgkJICAgIC8vIEZvcmNlIGEgc291cmNlIGFzIHRoaXMgc2ltcGxpZmllcyB0aGUgbWVyZ2UgbG9naWMuCgkJICAgIGlmICghX3V0aWxzLmlzQXJyYXkoc291cmNlKSkgewoJCSAgICAgIHNvdXJjZSA9IFtzb3VyY2VdOwoJCSAgICB9CgkJICAgIHNvdXJjZSA9IHRoaXMuc291cmNlLndyYXAoc291cmNlLCBsb2NhdGlvbik7CgoJCSAgICBpZiAodGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSkgewoJCSAgICAgIHJldHVybiBbJ3JldHVybiAnLCBzb3VyY2UsICc7J107CgkJICAgIH0gZWxzZSBpZiAoZXhwbGljaXQpIHsKCQkgICAgICAvLyBUaGlzIGlzIGEgY2FzZSB3aGVyZSB0aGUgYnVmZmVyIG9wZXJhdGlvbiBvY2N1cnMgYXMgYSBjaGlsZCBvZiBhbm90aGVyCgkJICAgICAgLy8gY29uc3RydWN0LCBnZW5lcmFsbHkgYnJhY2VzLiBXZSBoYXZlIHRvIGV4cGxpY2l0bHkgb3V0cHV0IHRoZXNlIGJ1ZmZlcgoJCSAgICAgIC8vIG9wZXJhdGlvbnMgdG8gZW5zdXJlIHRoYXQgdGhlIGVtaXR0ZWQgY29kZSBnb2VzIGluIHRoZSBjb3JyZWN0IGxvY2F0aW9uLgoJCSAgICAgIHJldHVybiBbJ2J1ZmZlciArPSAnLCBzb3VyY2UsICc7J107CgkJICAgIH0gZWxzZSB7CgkJICAgICAgc291cmNlLmFwcGVuZFRvQnVmZmVyID0gdHJ1ZTsKCQkgICAgICByZXR1cm4gc291cmNlOwoJCSAgICB9CgkJICB9LAoKCQkgIGluaXRpYWxpemVCdWZmZXI6IGZ1bmN0aW9uIGluaXRpYWxpemVCdWZmZXIoKSB7CgkJICAgIHJldHVybiB0aGlzLnF1b3RlZFN0cmluZygnJyk7CgkJICB9LAoJCSAgLy8gRU5EIFBVQkxJQyBBUEkKCgkJICBjb21waWxlOiBmdW5jdGlvbiBjb21waWxlKGVudmlyb25tZW50LCBvcHRpb25zLCBjb250ZXh0LCBhc09iamVjdCkgewoJCSAgICB0aGlzLmVudmlyb25tZW50ID0gZW52aXJvbm1lbnQ7CgkJICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CgkJICAgIHRoaXMuc3RyaW5nUGFyYW1zID0gdGhpcy5vcHRpb25zLnN0cmluZ1BhcmFtczsKCQkgICAgdGhpcy50cmFja0lkcyA9IHRoaXMub3B0aW9ucy50cmFja0lkczsKCQkgICAgdGhpcy5wcmVjb21waWxlID0gIWFzT2JqZWN0OwoKCQkgICAgdGhpcy5uYW1lID0gdGhpcy5lbnZpcm9ubWVudC5uYW1lOwoJCSAgICB0aGlzLmlzQ2hpbGQgPSAhIWNvbnRleHQ7CgkJICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQgfHwgewoJCSAgICAgIGRlY29yYXRvcnM6IFtdLAoJCSAgICAgIHByb2dyYW1zOiBbXSwKCQkgICAgICBlbnZpcm9ubWVudHM6IFtdCgkJICAgIH07CgoJCSAgICB0aGlzLnByZWFtYmxlKCk7CgoJCSAgICB0aGlzLnN0YWNrU2xvdCA9IDA7CgkJICAgIHRoaXMuc3RhY2tWYXJzID0gW107CgkJICAgIHRoaXMuYWxpYXNlcyA9IHt9OwoJCSAgICB0aGlzLnJlZ2lzdGVycyA9IHsgbGlzdDogW10gfTsKCQkgICAgdGhpcy5oYXNoZXMgPSBbXTsKCQkgICAgdGhpcy5jb21waWxlU3RhY2sgPSBbXTsKCQkgICAgdGhpcy5pbmxpbmVTdGFjayA9IFtdOwoJCSAgICB0aGlzLmJsb2NrUGFyYW1zID0gW107CgoJCSAgICB0aGlzLmNvbXBpbGVDaGlsZHJlbihlbnZpcm9ubWVudCwgb3B0aW9ucyk7CgoJCSAgICB0aGlzLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzIHx8IGVudmlyb25tZW50LnVzZURlcHRocyB8fCBlbnZpcm9ubWVudC51c2VEZWNvcmF0b3JzIHx8IHRoaXMub3B0aW9ucy5jb21wYXQ7CgkJICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IGVudmlyb25tZW50LnVzZUJsb2NrUGFyYW1zOwoKCQkgICAgdmFyIG9wY29kZXMgPSBlbnZpcm9ubWVudC5vcGNvZGVzLAoJCSAgICAgICAgb3Bjb2RlID0gdW5kZWZpbmVkLAoJCSAgICAgICAgZmlyc3RMb2MgPSB1bmRlZmluZWQsCgkJICAgICAgICBpID0gdW5kZWZpbmVkLAoJCSAgICAgICAgbCA9IHVuZGVmaW5lZDsKCgkJICAgIGZvciAoaSA9IDAsIGwgPSBvcGNvZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJCSAgICAgIG9wY29kZSA9IG9wY29kZXNbaV07CgoJCSAgICAgIHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbiA9IG9wY29kZS5sb2M7CgkJICAgICAgZmlyc3RMb2MgPSBmaXJzdExvYyB8fCBvcGNvZGUubG9jOwoJCSAgICAgIHRoaXNbb3Bjb2RlLm9wY29kZV0uYXBwbHkodGhpcywgb3Bjb2RlLmFyZ3MpOwoJCSAgICB9CgoJCSAgICAvLyBGbHVzaCBhbnkgdHJhaWxpbmcgY29udGVudCB0aGF0IG1pZ2h0IGJlIHBlbmRpbmcuCgkJICAgIHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbiA9IGZpcnN0TG9jOwoJCSAgICB0aGlzLnB1c2hTb3VyY2UoJycpOwoKCQkgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQkgICAgaWYgKHRoaXMuc3RhY2tTbG90IHx8IHRoaXMuaW5saW5lU3RhY2subGVuZ3RoIHx8IHRoaXMuY29tcGlsZVN0YWNrLmxlbmd0aCkgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdDb21waWxlIGNvbXBsZXRlZCB3aXRoIGNvbnRlbnQgbGVmdCBvbiBzdGFjaycpOwoJCSAgICB9CgoJCSAgICBpZiAoIXRoaXMuZGVjb3JhdG9ycy5pc0VtcHR5KCkpIHsKCQkgICAgICB0aGlzLnVzZURlY29yYXRvcnMgPSB0cnVlOwoKCQkgICAgICB0aGlzLmRlY29yYXRvcnMucHJlcGVuZCgndmFyIGRlY29yYXRvcnMgPSBjb250YWluZXIuZGVjb3JhdG9ycztcbicpOwoJCSAgICAgIHRoaXMuZGVjb3JhdG9ycy5wdXNoKCdyZXR1cm4gZm47Jyk7CgoJCSAgICAgIGlmIChhc09iamVjdCkgewoJCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzID0gRnVuY3Rpb24uYXBwbHkodGhpcywgWydmbicsICdwcm9wcycsICdjb250YWluZXInLCAnZGVwdGgwJywgJ2RhdGEnLCAnYmxvY2tQYXJhbXMnLCAnZGVwdGhzJywgdGhpcy5kZWNvcmF0b3JzLm1lcmdlKCldKTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzLnByZXBlbmQoJ2Z1bmN0aW9uKGZuLCBwcm9wcywgY29udGFpbmVyLCBkZXB0aDAsIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHtcbicpOwoJCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzLnB1c2goJ31cbicpOwoJCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzID0gdGhpcy5kZWNvcmF0b3JzLm1lcmdlKCk7CgkJICAgICAgfQoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMuZGVjb3JhdG9ycyA9IHVuZGVmaW5lZDsKCQkgICAgfQoKCQkgICAgdmFyIGZuID0gdGhpcy5jcmVhdGVGdW5jdGlvbkNvbnRleHQoYXNPYmplY3QpOwoJCSAgICBpZiAoIXRoaXMuaXNDaGlsZCkgewoJCSAgICAgIHZhciByZXQgPSB7CgkJICAgICAgICBjb21waWxlcjogdGhpcy5jb21waWxlckluZm8oKSwKCQkgICAgICAgIG1haW46IGZuCgkJICAgICAgfTsKCgkJICAgICAgaWYgKHRoaXMuZGVjb3JhdG9ycykgewoJCSAgICAgICAgcmV0Lm1haW5fZCA9IHRoaXMuZGVjb3JhdG9yczsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjYW1lbGNhc2UKCQkgICAgICAgIHJldC51c2VEZWNvcmF0b3JzID0gdHJ1ZTsKCQkgICAgICB9CgoJCSAgICAgIHZhciBfY29udGV4dCA9IHRoaXMuY29udGV4dDsKCQkgICAgICB2YXIgcHJvZ3JhbXMgPSBfY29udGV4dC5wcm9ncmFtczsKCQkgICAgICB2YXIgZGVjb3JhdG9ycyA9IF9jb250ZXh0LmRlY29yYXRvcnM7CgoJCSAgICAgIGZvciAoaSA9IDAsIGwgPSBwcm9ncmFtcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCQkgICAgICAgIGlmIChwcm9ncmFtc1tpXSkgewoJCSAgICAgICAgICByZXRbaV0gPSBwcm9ncmFtc1tpXTsKCQkgICAgICAgICAgaWYgKGRlY29yYXRvcnNbaV0pIHsKCQkgICAgICAgICAgICByZXRbaSArICdfZCddID0gZGVjb3JhdG9yc1tpXTsKCQkgICAgICAgICAgICByZXQudXNlRGVjb3JhdG9ycyA9IHRydWU7CgkJICAgICAgICAgIH0KCQkgICAgICAgIH0KCQkgICAgICB9CgoJCSAgICAgIGlmICh0aGlzLmVudmlyb25tZW50LnVzZVBhcnRpYWwpIHsKCQkgICAgICAgIHJldC51c2VQYXJ0aWFsID0gdHJ1ZTsKCQkgICAgICB9CgkJICAgICAgaWYgKHRoaXMub3B0aW9ucy5kYXRhKSB7CgkJICAgICAgICByZXQudXNlRGF0YSA9IHRydWU7CgkJICAgICAgfQoJCSAgICAgIGlmICh0aGlzLnVzZURlcHRocykgewoJCSAgICAgICAgcmV0LnVzZURlcHRocyA9IHRydWU7CgkJICAgICAgfQoJCSAgICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zKSB7CgkJICAgICAgICByZXQudXNlQmxvY2tQYXJhbXMgPSB0cnVlOwoJCSAgICAgIH0KCQkgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhdCkgewoJCSAgICAgICAgcmV0LmNvbXBhdCA9IHRydWU7CgkJICAgICAgfQoKCQkgICAgICBpZiAoIWFzT2JqZWN0KSB7CgkJICAgICAgICByZXQuY29tcGlsZXIgPSBKU09OLnN0cmluZ2lmeShyZXQuY29tcGlsZXIpOwoKCQkgICAgICAgIHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbiA9IHsgc3RhcnQ6IHsgbGluZTogMSwgY29sdW1uOiAwIH0gfTsKCQkgICAgICAgIHJldCA9IHRoaXMub2JqZWN0TGl0ZXJhbChyZXQpOwoKCQkgICAgICAgIGlmIChvcHRpb25zLnNyY05hbWUpIHsKCQkgICAgICAgICAgcmV0ID0gcmV0LnRvU3RyaW5nV2l0aFNvdXJjZU1hcCh7IGZpbGU6IG9wdGlvbnMuZGVzdE5hbWUgfSk7CgkJICAgICAgICAgIHJldC5tYXAgPSByZXQubWFwICYmIHJldC5tYXAudG9TdHJpbmcoKTsKCQkgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgIHJldCA9IHJldC50b1N0cmluZygpOwoJCSAgICAgICAgfQoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICByZXQuY29tcGlsZXJPcHRpb25zID0gdGhpcy5vcHRpb25zOwoJCSAgICAgIH0KCgkJICAgICAgcmV0dXJuIHJldDsKCQkgICAgfSBlbHNlIHsKCQkgICAgICByZXR1cm4gZm47CgkJICAgIH0KCQkgIH0sCgoJCSAgcHJlYW1ibGU6IGZ1bmN0aW9uIHByZWFtYmxlKCkgewoJCSAgICAvLyB0cmFjayB0aGUgbGFzdCBjb250ZXh0IHB1c2hlZCBpbnRvIHBsYWNlIHRvIGFsbG93IHNraXBwaW5nIHRoZQoJCSAgICAvLyBnZXRDb250ZXh0IG9wY29kZSB3aGVuIGl0IHdvdWxkIGJlIGEgbm9vcAoJCSAgICB0aGlzLmxhc3RDb250ZXh0ID0gMDsKCQkgICAgdGhpcy5zb3VyY2UgPSBuZXcgX2NvZGVHZW4yWydkZWZhdWx0J10odGhpcy5vcHRpb25zLnNyY05hbWUpOwoJCSAgICB0aGlzLmRlY29yYXRvcnMgPSBuZXcgX2NvZGVHZW4yWydkZWZhdWx0J10odGhpcy5vcHRpb25zLnNyY05hbWUpOwoJCSAgfSwKCgkJICBjcmVhdGVGdW5jdGlvbkNvbnRleHQ6IGZ1bmN0aW9uIGNyZWF0ZUZ1bmN0aW9uQ29udGV4dChhc09iamVjdCkgewoJCSAgICB2YXIgdmFyRGVjbGFyYXRpb25zID0gJyc7CgoJCSAgICB2YXIgbG9jYWxzID0gdGhpcy5zdGFja1ZhcnMuY29uY2F0KHRoaXMucmVnaXN0ZXJzLmxpc3QpOwoJCSAgICBpZiAobG9jYWxzLmxlbmd0aCA+IDApIHsKCQkgICAgICB2YXJEZWNsYXJhdGlvbnMgKz0gJywgJyArIGxvY2Fscy5qb2luKCcsICcpOwoJCSAgICB9CgoJCSAgICAvLyBHZW5lcmF0ZSBtaW5pbWl6ZXIgYWxpYXMgbWFwcGluZ3MKCQkgICAgLy8KCQkgICAgLy8gV2hlbiB1c2luZyB0cnVlIFNvdXJjZU5vZGVzLCB0aGlzIHdpbGwgdXBkYXRlIGFsbCByZWZlcmVuY2VzIHRvIHRoZSBnaXZlbiBhbGlhcwoJCSAgICAvLyBhcyB0aGUgc291cmNlIG5vZGVzIGFyZSByZXVzZWQgaW4gc2l0dS4gRm9yIHRoZSBub24tc291cmNlIG5vZGUgY29tcGlsYXRpb24gbW9kZSwKCQkgICAgLy8gYWxpYXNlcyB3aWxsIG5vdCBiZSB1c2VkLCBidXQgdGhpcyBjYXNlIGlzIGFscmVhZHkgYmVpbmcgcnVuIG9uIHRoZSBjbGllbnQgYW5kCgkJICAgIC8vIHdlIGFyZW4ndCBjb25jZXJuIGFib3V0IG1pbmltaXppbmcgdGhlIHRlbXBsYXRlIHNpemUuCgkJICAgIHZhciBhbGlhc0NvdW50ID0gMDsKCQkgICAgZm9yICh2YXIgYWxpYXMgaW4gdGhpcy5hbGlhc2VzKSB7CgkJICAgICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBndWFyZC1mb3ItaW4KCQkgICAgICB2YXIgbm9kZSA9IHRoaXMuYWxpYXNlc1thbGlhc107CgoJCSAgICAgIGlmICh0aGlzLmFsaWFzZXMuaGFzT3duUHJvcGVydHkoYWxpYXMpICYmIG5vZGUuY2hpbGRyZW4gJiYgbm9kZS5yZWZlcmVuY2VDb3VudCA+IDEpIHsKCQkgICAgICAgIHZhckRlY2xhcmF0aW9ucyArPSAnLCBhbGlhcycgKyArK2FsaWFzQ291bnQgKyAnPScgKyBhbGlhczsKCQkgICAgICAgIG5vZGUuY2hpbGRyZW5bMF0gPSAnYWxpYXMnICsgYWxpYXNDb3VudDsKCQkgICAgICB9CgkJICAgIH0KCgkJICAgIHZhciBwYXJhbXMgPSBbJ2NvbnRhaW5lcicsICdkZXB0aDAnLCAnaGVscGVycycsICdwYXJ0aWFscycsICdkYXRhJ107CgoJCSAgICBpZiAodGhpcy51c2VCbG9ja1BhcmFtcyB8fCB0aGlzLnVzZURlcHRocykgewoJCSAgICAgIHBhcmFtcy5wdXNoKCdibG9ja1BhcmFtcycpOwoJCSAgICB9CgkJICAgIGlmICh0aGlzLnVzZURlcHRocykgewoJCSAgICAgIHBhcmFtcy5wdXNoKCdkZXB0aHMnKTsKCQkgICAgfQoKCQkgICAgLy8gUGVyZm9ybSBhIHNlY29uZCBwYXNzIG92ZXIgdGhlIG91dHB1dCB0byBtZXJnZSBjb250ZW50IHdoZW4gcG9zc2libGUKCQkgICAgdmFyIHNvdXJjZSA9IHRoaXMubWVyZ2VTb3VyY2UodmFyRGVjbGFyYXRpb25zKTsKCgkJICAgIGlmIChhc09iamVjdCkgewoJCSAgICAgIHBhcmFtcy5wdXNoKHNvdXJjZSk7CgoJCSAgICAgIHJldHVybiBGdW5jdGlvbi5hcHBseSh0aGlzLCBwYXJhbXMpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiB0aGlzLnNvdXJjZS53cmFwKFsnZnVuY3Rpb24oJywgcGFyYW1zLmpvaW4oJywnKSwgJykge1xuICAnLCBzb3VyY2UsICd9J10pOwoJCSAgICB9CgkJICB9LAoJCSAgbWVyZ2VTb3VyY2U6IGZ1bmN0aW9uIG1lcmdlU291cmNlKHZhckRlY2xhcmF0aW9ucykgewoJCSAgICB2YXIgaXNTaW1wbGUgPSB0aGlzLmVudmlyb25tZW50LmlzU2ltcGxlLAoJCSAgICAgICAgYXBwZW5kT25seSA9ICF0aGlzLmZvcmNlQnVmZmVyLAoJCSAgICAgICAgYXBwZW5kRmlyc3QgPSB1bmRlZmluZWQsCgkJICAgICAgICBzb3VyY2VTZWVuID0gdW5kZWZpbmVkLAoJCSAgICAgICAgYnVmZmVyU3RhcnQgPSB1bmRlZmluZWQsCgkJICAgICAgICBidWZmZXJFbmQgPSB1bmRlZmluZWQ7CgkJICAgIHRoaXMuc291cmNlLmVhY2goZnVuY3Rpb24gKGxpbmUpIHsKCQkgICAgICBpZiAobGluZS5hcHBlbmRUb0J1ZmZlcikgewoJCSAgICAgICAgaWYgKGJ1ZmZlclN0YXJ0KSB7CgkJICAgICAgICAgIGxpbmUucHJlcGVuZCgnICArICcpOwoJCSAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgYnVmZmVyU3RhcnQgPSBsaW5lOwoJCSAgICAgICAgfQoJCSAgICAgICAgYnVmZmVyRW5kID0gbGluZTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgaWYgKGJ1ZmZlclN0YXJ0KSB7CgkJICAgICAgICAgIGlmICghc291cmNlU2VlbikgewoJCSAgICAgICAgICAgIGFwcGVuZEZpcnN0ID0gdHJ1ZTsKCQkgICAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgICBidWZmZXJTdGFydC5wcmVwZW5kKCdidWZmZXIgKz0gJyk7CgkJICAgICAgICAgIH0KCQkgICAgICAgICAgYnVmZmVyRW5kLmFkZCgnOycpOwoJCSAgICAgICAgICBidWZmZXJTdGFydCA9IGJ1ZmZlckVuZCA9IHVuZGVmaW5lZDsKCQkgICAgICAgIH0KCgkJICAgICAgICBzb3VyY2VTZWVuID0gdHJ1ZTsKCQkgICAgICAgIGlmICghaXNTaW1wbGUpIHsKCQkgICAgICAgICAgYXBwZW5kT25seSA9IGZhbHNlOwoJCSAgICAgICAgfQoJCSAgICAgIH0KCQkgICAgfSk7CgoJCSAgICBpZiAoYXBwZW5kT25seSkgewoJCSAgICAgIGlmIChidWZmZXJTdGFydCkgewoJCSAgICAgICAgYnVmZmVyU3RhcnQucHJlcGVuZCgncmV0dXJuICcpOwoJCSAgICAgICAgYnVmZmVyRW5kLmFkZCgnOycpOwoJCSAgICAgIH0gZWxzZSBpZiAoIXNvdXJjZVNlZW4pIHsKCQkgICAgICAgIHRoaXMuc291cmNlLnB1c2goJ3JldHVybiAiIjsnKTsKCQkgICAgICB9CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdmFyRGVjbGFyYXRpb25zICs9ICcsIGJ1ZmZlciA9ICcgKyAoYXBwZW5kRmlyc3QgPyAnJyA6IHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcigpKTsKCgkJICAgICAgaWYgKGJ1ZmZlclN0YXJ0KSB7CgkJICAgICAgICBidWZmZXJTdGFydC5wcmVwZW5kKCdyZXR1cm4gYnVmZmVyICsgJyk7CgkJICAgICAgICBidWZmZXJFbmQuYWRkKCc7Jyk7CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIHRoaXMuc291cmNlLnB1c2goJ3JldHVybiBidWZmZXI7Jyk7CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICBpZiAodmFyRGVjbGFyYXRpb25zKSB7CgkJICAgICAgdGhpcy5zb3VyY2UucHJlcGVuZCgndmFyICcgKyB2YXJEZWNsYXJhdGlvbnMuc3Vic3RyaW5nKDIpICsgKGFwcGVuZEZpcnN0ID8gJycgOiAnO1xuJykpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gdGhpcy5zb3VyY2UubWVyZ2UoKTsKCQkgIH0sCgoJCSAgLy8gW2Jsb2NrVmFsdWVdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgdmFsdWUKCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmV0dXJuIHZhbHVlIG9mIGJsb2NrSGVscGVyTWlzc2luZwoJCSAgLy8KCQkgIC8vIFRoZSBwdXJwb3NlIG9mIHRoaXMgb3Bjb2RlIGlzIHRvIHRha2UgYSBibG9jayBvZiB0aGUgZm9ybQoJCSAgLy8gYHt7I3RoaXMuZm9vfX0uLi57ey90aGlzLmZvb319YCwgcmVzb2x2ZSB0aGUgdmFsdWUgb2YgYGZvb2AsIGFuZAoJCSAgLy8gcmVwbGFjZSBpdCBvbiB0aGUgc3RhY2sgd2l0aCB0aGUgcmVzdWx0IG9mIHByb3Blcmx5CgkJICAvLyBpbnZva2luZyBibG9ja0hlbHBlck1pc3NpbmcuCgkJICBibG9ja1ZhbHVlOiBmdW5jdGlvbiBibG9ja1ZhbHVlKG5hbWUpIHsKCQkgICAgdmFyIGJsb2NrSGVscGVyTWlzc2luZyA9IHRoaXMuYWxpYXNhYmxlKCdoZWxwZXJzLmJsb2NrSGVscGVyTWlzc2luZycpLAoJCSAgICAgICAgcGFyYW1zID0gW3RoaXMuY29udGV4dE5hbWUoMCldOwoJCSAgICB0aGlzLnNldHVwSGVscGVyQXJncyhuYW1lLCAwLCBwYXJhbXMpOwoKCQkgICAgdmFyIGJsb2NrTmFtZSA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgcGFyYW1zLnNwbGljZSgxLCAwLCBibG9ja05hbWUpOwoKCQkgICAgdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChibG9ja0hlbHBlck1pc3NpbmcsICdjYWxsJywgcGFyYW1zKSk7CgkJICB9LAoKCQkgIC8vIFthbWJpZ3VvdXNCbG9ja1ZhbHVlXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIGludmVyc2UsIHByb2dyYW0sIHZhbHVlCgkJICAvLyBDb21waWxlciB2YWx1ZSwgYmVmb3JlOiBsYXN0SGVscGVyPXZhbHVlIG9mIGxhc3QgZm91bmQgaGVscGVyLCBpZiBhbnkKCQkgIC8vIE9uIHN0YWNrLCBhZnRlciwgaWYgbm8gbGFzdEhlbHBlcjogc2FtZSBhcyBbYmxvY2tWYWx1ZV0KCQkgIC8vIE9uIHN0YWNrLCBhZnRlciwgaWYgbGFzdEhlbHBlcjogdmFsdWUKCQkgIGFtYmlndW91c0Jsb2NrVmFsdWU6IGZ1bmN0aW9uIGFtYmlndW91c0Jsb2NrVmFsdWUoKSB7CgkJICAgIC8vIFdlJ3JlIGJlaW5nIGEgYml0IGNoZWVreSBhbmQgcmV1c2luZyB0aGUgb3B0aW9ucyB2YWx1ZSBmcm9tIHRoZSBwcmlvciBleGVjCgkJICAgIHZhciBibG9ja0hlbHBlck1pc3NpbmcgPSB0aGlzLmFsaWFzYWJsZSgnaGVscGVycy5ibG9ja0hlbHBlck1pc3NpbmcnKSwKCQkgICAgICAgIHBhcmFtcyA9IFt0aGlzLmNvbnRleHROYW1lKDApXTsKCQkgICAgdGhpcy5zZXR1cEhlbHBlckFyZ3MoJycsIDAsIHBhcmFtcywgdHJ1ZSk7CgoJCSAgICB0aGlzLmZsdXNoSW5saW5lKCk7CgoJCSAgICB2YXIgY3VycmVudCA9IHRoaXMudG9wU3RhY2soKTsKCQkgICAgcGFyYW1zLnNwbGljZSgxLCAwLCBjdXJyZW50KTsKCgkJICAgIHRoaXMucHVzaFNvdXJjZShbJ2lmICghJywgdGhpcy5sYXN0SGVscGVyLCAnKSB7ICcsIGN1cnJlbnQsICcgPSAnLCB0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoYmxvY2tIZWxwZXJNaXNzaW5nLCAnY2FsbCcsIHBhcmFtcyksICd9J10pOwoJCSAgfSwKCgkJICAvLyBbYXBwZW5kQ29udGVudF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uCgkJICAvLwoJCSAgLy8gQXBwZW5kcyB0aGUgc3RyaW5nIHZhbHVlIG9mIGBjb250ZW50YCB0byB0aGUgY3VycmVudCBidWZmZXIKCQkgIGFwcGVuZENvbnRlbnQ6IGZ1bmN0aW9uIGFwcGVuZENvbnRlbnQoY29udGVudCkgewoJCSAgICBpZiAodGhpcy5wZW5kaW5nQ29udGVudCkgewoJCSAgICAgIGNvbnRlbnQgPSB0aGlzLnBlbmRpbmdDb250ZW50ICsgY29udGVudDsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLnBlbmRpbmdMb2NhdGlvbiA9IHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbjsKCQkgICAgfQoKCQkgICAgdGhpcy5wZW5kaW5nQ29udGVudCA9IGNvbnRlbnQ7CgkJICB9LAoKCQkgIC8vIFthcHBlbmRdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4KCQkgIC8vCgkJICAvLyBDb2VyY2VzIGB2YWx1ZWAgdG8gYSBTdHJpbmcgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGN1cnJlbnQgYnVmZmVyLgoJCSAgLy8KCQkgIC8vIElmIGB2YWx1ZWAgaXMgdHJ1dGh5LCBvciAwLCBpdCBpcyBjb2VyY2VkIGludG8gYSBzdHJpbmcgYW5kIGFwcGVuZGVkCgkJICAvLyBPdGhlcndpc2UsIHRoZSBlbXB0eSBzdHJpbmcgaXMgYXBwZW5kZWQKCQkgIGFwcGVuZDogZnVuY3Rpb24gYXBwZW5kKCkgewoJCSAgICBpZiAodGhpcy5pc0lubGluZSgpKSB7CgkJICAgICAgdGhpcy5yZXBsYWNlU3RhY2soZnVuY3Rpb24gKGN1cnJlbnQpIHsKCQkgICAgICAgIHJldHVybiBbJyAhPSBudWxsID8gJywgY3VycmVudCwgJyA6ICIiJ107CgkJICAgICAgfSk7CgoJCSAgICAgIHRoaXMucHVzaFNvdXJjZSh0aGlzLmFwcGVuZFRvQnVmZmVyKHRoaXMucG9wU3RhY2soKSkpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHZhciBsb2NhbCA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgICB0aGlzLnB1c2hTb3VyY2UoWydpZiAoJywgbG9jYWwsICcgIT0gbnVsbCkgeyAnLCB0aGlzLmFwcGVuZFRvQnVmZmVyKGxvY2FsLCB1bmRlZmluZWQsIHRydWUpLCAnIH0nXSk7CgkJICAgICAgaWYgKHRoaXMuZW52aXJvbm1lbnQuaXNTaW1wbGUpIHsKCQkgICAgICAgIHRoaXMucHVzaFNvdXJjZShbJ2Vsc2UgeyAnLCB0aGlzLmFwcGVuZFRvQnVmZmVyKCInJyIsIHVuZGVmaW5lZCwgdHJ1ZSksICcgfSddKTsKCQkgICAgICB9CgkJICAgIH0KCQkgIH0sCgoJCSAgLy8gW2FwcGVuZEVzY2FwZWRdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4KCQkgIC8vCgkJICAvLyBFc2NhcGUgYHZhbHVlYCBhbmQgYXBwZW5kIGl0IHRvIHRoZSBidWZmZXIKCQkgIGFwcGVuZEVzY2FwZWQ6IGZ1bmN0aW9uIGFwcGVuZEVzY2FwZWQoKSB7CgkJICAgIHRoaXMucHVzaFNvdXJjZSh0aGlzLmFwcGVuZFRvQnVmZmVyKFt0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24nKSwgJygnLCB0aGlzLnBvcFN0YWNrKCksICcpJ10pKTsKCQkgIH0sCgoJCSAgLy8gW2dldENvbnRleHRdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLgoJCSAgLy8gQ29tcGlsZXIgdmFsdWUsIGFmdGVyOiBsYXN0Q29udGV4dD1kZXB0aAoJCSAgLy8KCQkgIC8vIFNldCB0aGUgdmFsdWUgb2YgdGhlIGBsYXN0Q29udGV4dGAgY29tcGlsZXIgdmFsdWUgdG8gdGhlIGRlcHRoCgkJICBnZXRDb250ZXh0OiBmdW5jdGlvbiBnZXRDb250ZXh0KGRlcHRoKSB7CgkJICAgIHRoaXMubGFzdENvbnRleHQgPSBkZXB0aDsKCQkgIH0sCgoJCSAgLy8gW3B1c2hDb250ZXh0XQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBjdXJyZW50Q29udGV4dCwgLi4uCgkJICAvLwoJCSAgLy8gUHVzaGVzIHRoZSB2YWx1ZSBvZiB0aGUgY3VycmVudCBjb250ZXh0IG9udG8gdGhlIHN0YWNrLgoJCSAgcHVzaENvbnRleHQ6IGZ1bmN0aW9uIHB1c2hDb250ZXh0KCkgewoJCSAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwodGhpcy5jb250ZXh0TmFtZSh0aGlzLmxhc3RDb250ZXh0KSk7CgkJICB9LAoKCQkgIC8vIFtsb29rdXBPbkNvbnRleHRdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IGN1cnJlbnRDb250ZXh0W25hbWVdLCAuLi4KCQkgIC8vCgkJICAvLyBMb29rcyB1cCB0aGUgdmFsdWUgb2YgYG5hbWVgIG9uIHRoZSBjdXJyZW50IGNvbnRleHQgYW5kIHB1c2hlcwoJCSAgLy8gaXQgb250byB0aGUgc3RhY2suCgkJICBsb29rdXBPbkNvbnRleHQ6IGZ1bmN0aW9uIGxvb2t1cE9uQ29udGV4dChwYXJ0cywgZmFsc3ksIHN0cmljdCwgc2NvcGVkKSB7CgkJICAgIHZhciBpID0gMDsKCgkJICAgIGlmICghc2NvcGVkICYmIHRoaXMub3B0aW9ucy5jb21wYXQgJiYgIXRoaXMubGFzdENvbnRleHQpIHsKCQkgICAgICAvLyBUaGUgZGVwdGhlZCBxdWVyeSBpcyBleHBlY3RlZCB0byBoYW5kbGUgdGhlIHVuZGVmaW5lZCBsb2dpYyBmb3IgdGhlIHJvb3QgbGV2ZWwgdGhhdAoJCSAgICAgIC8vIGlzIGltcGxlbWVudGVkIGJlbG93LCBzbyB3ZSBldmFsdWF0ZSB0aGF0IGRpcmVjdGx5IGluIGNvbXBhdCBtb2RlCgkJICAgICAgdGhpcy5wdXNoKHRoaXMuZGVwdGhlZExvb2t1cChwYXJ0c1tpKytdKSk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5wdXNoQ29udGV4dCgpOwoJCSAgICB9CgoJCSAgICB0aGlzLnJlc29sdmVQYXRoKCdjb250ZXh0JywgcGFydHMsIGksIGZhbHN5LCBzdHJpY3QpOwoJCSAgfSwKCgkJICAvLyBbbG9va3VwQmxvY2tQYXJhbV0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogYmxvY2tQYXJhbVtuYW1lXSwgLi4uCgkJICAvLwoJCSAgLy8gTG9va3MgdXAgdGhlIHZhbHVlIG9mIGBwYXJ0c2Agb24gdGhlIGdpdmVuIGJsb2NrIHBhcmFtIGFuZCBwdXNoZXMKCQkgIC8vIGl0IG9udG8gdGhlIHN0YWNrLgoJCSAgbG9va3VwQmxvY2tQYXJhbTogZnVuY3Rpb24gbG9va3VwQmxvY2tQYXJhbShibG9ja1BhcmFtSWQsIHBhcnRzKSB7CgkJICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0cnVlOwoKCQkgICAgdGhpcy5wdXNoKFsnYmxvY2tQYXJhbXNbJywgYmxvY2tQYXJhbUlkWzBdLCAnXVsnLCBibG9ja1BhcmFtSWRbMV0sICddJ10pOwoJCSAgICB0aGlzLnJlc29sdmVQYXRoKCdjb250ZXh0JywgcGFydHMsIDEpOwoJCSAgfSwKCgkJICAvLyBbbG9va3VwRGF0YV0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogZGF0YSwgLi4uCgkJICAvLwoJCSAgLy8gUHVzaCB0aGUgZGF0YSBsb29rdXAgb3BlcmF0b3IKCQkgIGxvb2t1cERhdGE6IGZ1bmN0aW9uIGxvb2t1cERhdGEoZGVwdGgsIHBhcnRzLCBzdHJpY3QpIHsKCQkgICAgaWYgKCFkZXB0aCkgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnZGF0YScpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnY29udGFpbmVyLmRhdGEoZGF0YSwgJyArIGRlcHRoICsgJyknKTsKCQkgICAgfQoKCQkgICAgdGhpcy5yZXNvbHZlUGF0aCgnZGF0YScsIHBhcnRzLCAwLCB0cnVlLCBzdHJpY3QpOwoJCSAgfSwKCgkJICByZXNvbHZlUGF0aDogZnVuY3Rpb24gcmVzb2x2ZVBhdGgodHlwZSwgcGFydHMsIGksIGZhbHN5LCBzdHJpY3QpIHsKCQkgICAgLy8gaXN0YW5idWwgaWdub3JlIG5leHQKCgkJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJCSAgICBpZiAodGhpcy5vcHRpb25zLnN0cmljdCB8fCB0aGlzLm9wdGlvbnMuYXNzdW1lT2JqZWN0cykgewoJCSAgICAgIHRoaXMucHVzaChzdHJpY3RMb29rdXAodGhpcy5vcHRpb25zLnN0cmljdCAmJiBzdHJpY3QsIHRoaXMsIHBhcnRzLCB0eXBlKSk7CgkJICAgICAgcmV0dXJuOwoJCSAgICB9CgoJCSAgICB2YXIgbGVuID0gcGFydHMubGVuZ3RoOwoJCSAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tbG9vcC1mdW5jICovCgkJICAgICAgdGhpcy5yZXBsYWNlU3RhY2soZnVuY3Rpb24gKGN1cnJlbnQpIHsKCQkgICAgICAgIHZhciBsb29rdXAgPSBfdGhpcy5uYW1lTG9va3VwKGN1cnJlbnQsIHBhcnRzW2ldLCB0eXBlKTsKCQkgICAgICAgIC8vIFdlIHdhbnQgdG8gZW5zdXJlIHRoYXQgemVybyBhbmQgZmFsc2UgYXJlIGhhbmRsZWQgcHJvcGVybHkgaWYgdGhlIGNvbnRleHQgKGZhbHN5IGZsYWcpCgkJICAgICAgICAvLyBuZWVkcyB0byBoYXZlIHRoZSBzcGVjaWFsIGhhbmRsaW5nIGZvciB0aGVzZSB2YWx1ZXMuCgkJICAgICAgICBpZiAoIWZhbHN5KSB7CgkJICAgICAgICAgIHJldHVybiBbJyAhPSBudWxsID8gJywgbG9va3VwLCAnIDogJywgY3VycmVudF07CgkJICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAvLyBPdGhlcndpc2Ugd2UgY2FuIHVzZSBnZW5lcmljIGZhbHN5IGhhbmRsaW5nCgkJICAgICAgICAgIHJldHVybiBbJyAmJiAnLCBsb29rdXBdOwoJCSAgICAgICAgfQoJCSAgICAgIH0pOwoJCSAgICAgIC8qIGVzbGludC1lbmFibGUgbm8tbG9vcC1mdW5jICovCgkJICAgIH0KCQkgIH0sCgoJCSAgLy8gW3Jlc29sdmVQb3NzaWJsZUxhbWJkYV0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiB2YWx1ZSwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc29sdmVkIHZhbHVlLCAuLi4KCQkgIC8vCgkJICAvLyBJZiB0aGUgYHZhbHVlYCBpcyBhIGxhbWJkYSwgcmVwbGFjZSBpdCBvbiB0aGUgc3RhY2sgYnkKCQkgIC8vIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGxhbWJkYQoJCSAgcmVzb2x2ZVBvc3NpYmxlTGFtYmRhOiBmdW5jdGlvbiByZXNvbHZlUG9zc2libGVMYW1iZGEoKSB7CgkJICAgIHRoaXMucHVzaChbdGhpcy5hbGlhc2FibGUoJ2NvbnRhaW5lci5sYW1iZGEnKSwgJygnLCB0aGlzLnBvcFN0YWNrKCksICcsICcsIHRoaXMuY29udGV4dE5hbWUoMCksICcpJ10pOwoJCSAgfSwKCgkJICAvLyBbcHVzaFN0cmluZ1BhcmFtXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBzdHJpbmcsIGN1cnJlbnRDb250ZXh0LCAuLi4KCQkgIC8vCgkJICAvLyBUaGlzIG9wY29kZSBpcyBkZXNpZ25lZCBmb3IgdXNlIGluIHN0cmluZyBtb2RlLCB3aGljaAoJCSAgLy8gcHJvdmlkZXMgdGhlIHN0cmluZyB2YWx1ZSBvZiBhIHBhcmFtZXRlciBhbG9uZyB3aXRoIGl0cwoJCSAgLy8gZGVwdGggcmF0aGVyIHRoYW4gcmVzb2x2aW5nIGl0IGltbWVkaWF0ZWx5LgoJCSAgcHVzaFN0cmluZ1BhcmFtOiBmdW5jdGlvbiBwdXNoU3RyaW5nUGFyYW0oc3RyaW5nLCB0eXBlKSB7CgkJICAgIHRoaXMucHVzaENvbnRleHQoKTsKCQkgICAgdGhpcy5wdXNoU3RyaW5nKHR5cGUpOwoKCQkgICAgLy8gSWYgaXQncyBhIHN1YmV4cHJlc3Npb24sIHRoZSBzdHJpbmcgcmVzdWx0CgkJICAgIC8vIHdpbGwgYmUgcHVzaGVkIGFmdGVyIHRoaXMgb3Bjb2RlLgoJCSAgICBpZiAodHlwZSAhPT0gJ1N1YkV4cHJlc3Npb24nKSB7CgkJICAgICAgaWYgKHR5cGVvZiBzdHJpbmcgPT09ICdzdHJpbmcnKSB7CgkJICAgICAgICB0aGlzLnB1c2hTdHJpbmcoc3RyaW5nKTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKHN0cmluZyk7CgkJICAgICAgfQoJCSAgICB9CgkJICB9LAoKCQkgIGVtcHR5SGFzaDogZnVuY3Rpb24gZW1wdHlIYXNoKG9taXRFbXB0eSkgewoJCSAgICBpZiAodGhpcy50cmFja0lkcykgewoJCSAgICAgIHRoaXMucHVzaCgne30nKTsgLy8gaGFzaElkcwoJCSAgICB9CgkJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgewoJCSAgICAgIHRoaXMucHVzaCgne30nKTsgLy8gaGFzaENvbnRleHRzCgkJICAgICAgdGhpcy5wdXNoKCd7fScpOyAvLyBoYXNoVHlwZXMKCQkgICAgfQoJCSAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwob21pdEVtcHR5ID8gJ3VuZGVmaW5lZCcgOiAne30nKTsKCQkgIH0sCgkJICBwdXNoSGFzaDogZnVuY3Rpb24gcHVzaEhhc2goKSB7CgkJICAgIGlmICh0aGlzLmhhc2gpIHsKCQkgICAgICB0aGlzLmhhc2hlcy5wdXNoKHRoaXMuaGFzaCk7CgkJICAgIH0KCQkgICAgdGhpcy5oYXNoID0geyB2YWx1ZXM6IFtdLCB0eXBlczogW10sIGNvbnRleHRzOiBbXSwgaWRzOiBbXSB9OwoJCSAgfSwKCQkgIHBvcEhhc2g6IGZ1bmN0aW9uIHBvcEhhc2goKSB7CgkJICAgIHZhciBoYXNoID0gdGhpcy5oYXNoOwoJCSAgICB0aGlzLmhhc2ggPSB0aGlzLmhhc2hlcy5wb3AoKTsKCgkJICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7CgkJICAgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLmlkcykpOwoJCSAgICB9CgkJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgewoJCSAgICAgIHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwoaGFzaC5jb250ZXh0cykpOwoJCSAgICAgIHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwoaGFzaC50eXBlcykpOwoJCSAgICB9CgoJCSAgICB0aGlzLnB1c2godGhpcy5vYmplY3RMaXRlcmFsKGhhc2gudmFsdWVzKSk7CgkJICB9LAoKCQkgIC8vIFtwdXNoU3RyaW5nXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBxdW90ZWRTdHJpbmcoc3RyaW5nKSwgLi4uCgkJICAvLwoJCSAgLy8gUHVzaCBhIHF1b3RlZCB2ZXJzaW9uIG9mIGBzdHJpbmdgIG9udG8gdGhlIHN0YWNrCgkJICBwdXNoU3RyaW5nOiBmdW5jdGlvbiBwdXNoU3RyaW5nKHN0cmluZykgewoJCSAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwodGhpcy5xdW90ZWRTdHJpbmcoc3RyaW5nKSk7CgkJICB9LAoKCQkgIC8vIFtwdXNoTGl0ZXJhbF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogdmFsdWUsIC4uLgoJCSAgLy8KCQkgIC8vIFB1c2hlcyBhIHZhbHVlIG9udG8gdGhlIHN0YWNrLiBUaGlzIG9wZXJhdGlvbiBwcmV2ZW50cwoJCSAgLy8gdGhlIGNvbXBpbGVyIGZyb20gY3JlYXRpbmcgYSB0ZW1wb3JhcnkgdmFyaWFibGUgdG8gaG9sZAoJCSAgLy8gaXQuCgkJICBwdXNoTGl0ZXJhbDogZnVuY3Rpb24gcHVzaExpdGVyYWwodmFsdWUpIHsKCQkgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKHZhbHVlKTsKCQkgIH0sCgoJCSAgLy8gW3B1c2hQcm9ncmFtXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBwcm9ncmFtKGd1aWQpLCAuLi4KCQkgIC8vCgkJICAvLyBQdXNoIGEgcHJvZ3JhbSBleHByZXNzaW9uIG9udG8gdGhlIHN0YWNrLiBUaGlzIHRha2VzCgkJICAvLyBhIGNvbXBpbGUtdGltZSBndWlkIGFuZCBjb252ZXJ0cyBpdCBpbnRvIGEgcnVudGltZS1hY2Nlc3NpYmxlCgkJICAvLyBleHByZXNzaW9uLgoJCSAgcHVzaFByb2dyYW06IGZ1bmN0aW9uIHB1c2hQcm9ncmFtKGd1aWQpIHsKCQkgICAgaWYgKGd1aWQgIT0gbnVsbCkgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLnByb2dyYW1FeHByZXNzaW9uKGd1aWQpKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwobnVsbCk7CgkJICAgIH0KCQkgIH0sCgoJCSAgLy8gW3JlZ2lzdGVyRGVjb3JhdG9yXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIHByb2dyYW0sIHBhcmFtcy4uLiwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLgoJCSAgLy8KCQkgIC8vIFBvcHMgb2ZmIHRoZSBkZWNvcmF0b3IncyBwYXJhbWV0ZXJzLCBpbnZva2VzIHRoZSBkZWNvcmF0b3IsCgkJICAvLyBhbmQgaW5zZXJ0cyB0aGUgZGVjb3JhdG9yIGludG8gdGhlIGRlY29yYXRvcnMgbGlzdC4KCQkgIHJlZ2lzdGVyRGVjb3JhdG9yOiBmdW5jdGlvbiByZWdpc3RlckRlY29yYXRvcihwYXJhbVNpemUsIG5hbWUpIHsKCQkgICAgdmFyIGZvdW5kRGVjb3JhdG9yID0gdGhpcy5uYW1lTG9va3VwKCdkZWNvcmF0b3JzJywgbmFtZSwgJ2RlY29yYXRvcicpLAoJCSAgICAgICAgb3B0aW9ucyA9IHRoaXMuc2V0dXBIZWxwZXJBcmdzKG5hbWUsIHBhcmFtU2l6ZSk7CgoJCSAgICB0aGlzLmRlY29yYXRvcnMucHVzaChbJ2ZuID0gJywgdGhpcy5kZWNvcmF0b3JzLmZ1bmN0aW9uQ2FsbChmb3VuZERlY29yYXRvciwgJycsIFsnZm4nLCAncHJvcHMnLCAnY29udGFpbmVyJywgb3B0aW9uc10pLCAnIHx8IGZuOyddKTsKCQkgIH0sCgoJCSAgLy8gW2ludm9rZUhlbHBlcl0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiBoYXNoLCBpbnZlcnNlLCBwcm9ncmFtLCBwYXJhbXMuLi4sIC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiByZXN1bHQgb2YgaGVscGVyIGludm9jYXRpb24KCQkgIC8vCgkJICAvLyBQb3BzIG9mZiB0aGUgaGVscGVyJ3MgcGFyYW1ldGVycywgaW52b2tlcyB0aGUgaGVscGVyLAoJCSAgLy8gYW5kIHB1c2hlcyB0aGUgaGVscGVyJ3MgcmV0dXJuIHZhbHVlIG9udG8gdGhlIHN0YWNrLgoJCSAgLy8KCQkgIC8vIElmIHRoZSBoZWxwZXIgaXMgbm90IGZvdW5kLCBgaGVscGVyTWlzc2luZ2AgaXMgY2FsbGVkLgoJCSAgaW52b2tlSGVscGVyOiBmdW5jdGlvbiBpbnZva2VIZWxwZXIocGFyYW1TaXplLCBuYW1lLCBpc1NpbXBsZSkgewoJCSAgICB2YXIgbm9uSGVscGVyID0gdGhpcy5wb3BTdGFjaygpLAoJCSAgICAgICAgaGVscGVyID0gdGhpcy5zZXR1cEhlbHBlcihwYXJhbVNpemUsIG5hbWUpLAoJCSAgICAgICAgc2ltcGxlID0gaXNTaW1wbGUgPyBbaGVscGVyLm5hbWUsICcgfHwgJ10gOiAnJzsKCgkJICAgIHZhciBsb29rdXAgPSBbJygnXS5jb25jYXQoc2ltcGxlLCBub25IZWxwZXIpOwoJCSAgICBpZiAoIXRoaXMub3B0aW9ucy5zdHJpY3QpIHsKCQkgICAgICBsb29rdXAucHVzaCgnIHx8ICcsIHRoaXMuYWxpYXNhYmxlKCdoZWxwZXJzLmhlbHBlck1pc3NpbmcnKSk7CgkJICAgIH0KCQkgICAgbG9va3VwLnB1c2goJyknKTsKCgkJICAgIHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwobG9va3VwLCAnY2FsbCcsIGhlbHBlci5jYWxsUGFyYW1zKSk7CgkJICB9LAoKCQkgIC8vIFtpbnZva2VLbm93bkhlbHBlcl0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiBoYXNoLCBpbnZlcnNlLCBwcm9ncmFtLCBwYXJhbXMuLi4sIC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiByZXN1bHQgb2YgaGVscGVyIGludm9jYXRpb24KCQkgIC8vCgkJICAvLyBUaGlzIG9wZXJhdGlvbiBpcyB1c2VkIHdoZW4gdGhlIGhlbHBlciBpcyBrbm93biB0byBleGlzdCwKCQkgIC8vIHNvIGEgYGhlbHBlck1pc3NpbmdgIGZhbGxiYWNrIGlzIG5vdCByZXF1aXJlZC4KCQkgIGludm9rZUtub3duSGVscGVyOiBmdW5jdGlvbiBpbnZva2VLbm93bkhlbHBlcihwYXJhbVNpemUsIG5hbWUpIHsKCQkgICAgdmFyIGhlbHBlciA9IHRoaXMuc2V0dXBIZWxwZXIocGFyYW1TaXplLCBuYW1lKTsKCQkgICAgdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChoZWxwZXIubmFtZSwgJ2NhbGwnLCBoZWxwZXIuY2FsbFBhcmFtcykpOwoJCSAgfSwKCgkJICAvLyBbaW52b2tlQW1iaWd1b3VzXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIGludmVyc2UsIHByb2dyYW0sIHBhcmFtcy4uLiwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc3VsdCBvZiBkaXNhbWJpZ3VhdGlvbgoJCSAgLy8KCQkgIC8vIFRoaXMgb3BlcmF0aW9uIGlzIHVzZWQgd2hlbiBhbiBleHByZXNzaW9uIGxpa2UgYHt7Zm9vfX1gCgkJICAvLyBpcyBwcm92aWRlZCwgYnV0IHdlIGRvbid0IGtub3cgYXQgY29tcGlsZS10aW1lIHdoZXRoZXIgaXQKCQkgIC8vIGlzIGEgaGVscGVyIG9yIGEgcGF0aC4KCQkgIC8vCgkJICAvLyBUaGlzIG9wZXJhdGlvbiBlbWl0cyBtb3JlIGNvZGUgdGhhbiB0aGUgb3RoZXIgb3B0aW9ucywKCQkgIC8vIGFuZCBjYW4gYmUgYXZvaWRlZCBieSBwYXNzaW5nIHRoZSBga25vd25IZWxwZXJzYCBhbmQKCQkgIC8vIGBrbm93bkhlbHBlcnNPbmx5YCBmbGFncyBhdCBjb21waWxlLXRpbWUuCgkJICBpbnZva2VBbWJpZ3VvdXM6IGZ1bmN0aW9uIGludm9rZUFtYmlndW91cyhuYW1lLCBoZWxwZXJDYWxsKSB7CgkJICAgIHRoaXMudXNlUmVnaXN0ZXIoJ2hlbHBlcicpOwoKCQkgICAgdmFyIG5vbkhlbHBlciA9IHRoaXMucG9wU3RhY2soKTsKCgkJICAgIHRoaXMuZW1wdHlIYXNoKCk7CgkJICAgIHZhciBoZWxwZXIgPSB0aGlzLnNldHVwSGVscGVyKDAsIG5hbWUsIGhlbHBlckNhbGwpOwoKCQkgICAgdmFyIGhlbHBlck5hbWUgPSB0aGlzLmxhc3RIZWxwZXIgPSB0aGlzLm5hbWVMb29rdXAoJ2hlbHBlcnMnLCBuYW1lLCAnaGVscGVyJyk7CgoJCSAgICB2YXIgbG9va3VwID0gWycoJywgJyhoZWxwZXIgPSAnLCBoZWxwZXJOYW1lLCAnIHx8ICcsIG5vbkhlbHBlciwgJyknXTsKCQkgICAgaWYgKCF0aGlzLm9wdGlvbnMuc3RyaWN0KSB7CgkJICAgICAgbG9va3VwWzBdID0gJyhoZWxwZXIgPSAnOwoJCSAgICAgIGxvb2t1cC5wdXNoKCcgIT0gbnVsbCA/IGhlbHBlciA6ICcsIHRoaXMuYWxpYXNhYmxlKCdoZWxwZXJzLmhlbHBlck1pc3NpbmcnKSk7CgkJICAgIH0KCgkJICAgIHRoaXMucHVzaChbJygnLCBsb29rdXAsIGhlbHBlci5wYXJhbXNJbml0ID8gWycpLCgnLCBoZWxwZXIucGFyYW1zSW5pdF0gOiBbXSwgJyksJywgJyh0eXBlb2YgaGVscGVyID09PSAnLCB0aGlzLmFsaWFzYWJsZSgnImZ1bmN0aW9uIicpLCAnID8gJywgdGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKCdoZWxwZXInLCAnY2FsbCcsIGhlbHBlci5jYWxsUGFyYW1zKSwgJyA6IGhlbHBlcikpJ10pOwoJCSAgfSwKCgkJICAvLyBbaW52b2tlUGFydGlhbF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiBjb250ZXh0LCAuLi4KCQkgIC8vIE9uIHN0YWNrIGFmdGVyOiByZXN1bHQgb2YgcGFydGlhbCBpbnZvY2F0aW9uCgkJICAvLwoJCSAgLy8gVGhpcyBvcGVyYXRpb24gcG9wcyBvZmYgYSBjb250ZXh0LCBpbnZva2VzIGEgcGFydGlhbCB3aXRoIHRoYXQgY29udGV4dCwKCQkgIC8vIGFuZCBwdXNoZXMgdGhlIHJlc3VsdCBvZiB0aGUgaW52b2NhdGlvbiBiYWNrLgoJCSAgaW52b2tlUGFydGlhbDogZnVuY3Rpb24gaW52b2tlUGFydGlhbChpc0R5bmFtaWMsIG5hbWUsIGluZGVudCkgewoJCSAgICB2YXIgcGFyYW1zID0gW10sCgkJICAgICAgICBvcHRpb25zID0gdGhpcy5zZXR1cFBhcmFtcyhuYW1lLCAxLCBwYXJhbXMpOwoKCQkgICAgaWYgKGlzRHluYW1pYykgewoJCSAgICAgIG5hbWUgPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgICAgZGVsZXRlIG9wdGlvbnMubmFtZTsKCQkgICAgfQoKCQkgICAgaWYgKGluZGVudCkgewoJCSAgICAgIG9wdGlvbnMuaW5kZW50ID0gSlNPTi5zdHJpbmdpZnkoaW5kZW50KTsKCQkgICAgfQoJCSAgICBvcHRpb25zLmhlbHBlcnMgPSAnaGVscGVycyc7CgkJICAgIG9wdGlvbnMucGFydGlhbHMgPSAncGFydGlhbHMnOwoJCSAgICBvcHRpb25zLmRlY29yYXRvcnMgPSAnY29udGFpbmVyLmRlY29yYXRvcnMnOwoKCQkgICAgaWYgKCFpc0R5bmFtaWMpIHsKCQkgICAgICBwYXJhbXMudW5zaGlmdCh0aGlzLm5hbWVMb29rdXAoJ3BhcnRpYWxzJywgbmFtZSwgJ3BhcnRpYWwnKSk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcGFyYW1zLnVuc2hpZnQobmFtZSk7CgkJICAgIH0KCgkJICAgIGlmICh0aGlzLm9wdGlvbnMuY29tcGF0KSB7CgkJICAgICAgb3B0aW9ucy5kZXB0aHMgPSAnZGVwdGhzJzsKCQkgICAgfQoJCSAgICBvcHRpb25zID0gdGhpcy5vYmplY3RMaXRlcmFsKG9wdGlvbnMpOwoJCSAgICBwYXJhbXMucHVzaChvcHRpb25zKTsKCgkJICAgIHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoJ2NvbnRhaW5lci5pbnZva2VQYXJ0aWFsJywgJycsIHBhcmFtcykpOwoJCSAgfSwKCgkJICAvLyBbYXNzaWduVG9IYXNoXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IHZhbHVlLCAuLi4sIGhhc2gsIC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4sIGhhc2gsIC4uLgoJCSAgLy8KCQkgIC8vIFBvcHMgYSB2YWx1ZSBvZmYgdGhlIHN0YWNrIGFuZCBhc3NpZ25zIGl0IHRvIHRoZSBjdXJyZW50IGhhc2gKCQkgIGFzc2lnblRvSGFzaDogZnVuY3Rpb24gYXNzaWduVG9IYXNoKGtleSkgewoJCSAgICB2YXIgdmFsdWUgPSB0aGlzLnBvcFN0YWNrKCksCgkJICAgICAgICBjb250ZXh0ID0gdW5kZWZpbmVkLAoJCSAgICAgICAgdHlwZSA9IHVuZGVmaW5lZCwKCQkgICAgICAgIGlkID0gdW5kZWZpbmVkOwoKCQkgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsKCQkgICAgICBpZCA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgfQoJCSAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsKCQkgICAgICB0eXBlID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICAgIGNvbnRleHQgPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgIH0KCgkJICAgIHZhciBoYXNoID0gdGhpcy5oYXNoOwoJCSAgICBpZiAoY29udGV4dCkgewoJCSAgICAgIGhhc2guY29udGV4dHNba2V5XSA9IGNvbnRleHQ7CgkJICAgIH0KCQkgICAgaWYgKHR5cGUpIHsKCQkgICAgICBoYXNoLnR5cGVzW2tleV0gPSB0eXBlOwoJCSAgICB9CgkJICAgIGlmIChpZCkgewoJCSAgICAgIGhhc2guaWRzW2tleV0gPSBpZDsKCQkgICAgfQoJCSAgICBoYXNoLnZhbHVlc1trZXldID0gdmFsdWU7CgkJICB9LAoKCQkgIHB1c2hJZDogZnVuY3Rpb24gcHVzaElkKHR5cGUsIG5hbWUsIGNoaWxkKSB7CgkJICAgIGlmICh0eXBlID09PSAnQmxvY2tQYXJhbScpIHsKCQkgICAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwoJ2Jsb2NrUGFyYW1zWycgKyBuYW1lWzBdICsgJ10ucGF0aFsnICsgbmFtZVsxXSArICddJyArIChjaGlsZCA/ICcgKyAnICsgSlNPTi5zdHJpbmdpZnkoJy4nICsgY2hpbGQpIDogJycpKTsKCQkgICAgfSBlbHNlIGlmICh0eXBlID09PSAnUGF0aEV4cHJlc3Npb24nKSB7CgkJICAgICAgdGhpcy5wdXNoU3RyaW5nKG5hbWUpOwoJCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdTdWJFeHByZXNzaW9uJykgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgndHJ1ZScpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnbnVsbCcpOwoJCSAgICB9CgkJICB9LAoKCQkgIC8vIEhFTFBFUlMKCgkJICBjb21waWxlcjogSmF2YVNjcmlwdENvbXBpbGVyLAoKCQkgIGNvbXBpbGVDaGlsZHJlbjogZnVuY3Rpb24gY29tcGlsZUNoaWxkcmVuKGVudmlyb25tZW50LCBvcHRpb25zKSB7CgkJICAgIHZhciBjaGlsZHJlbiA9IGVudmlyb25tZW50LmNoaWxkcmVuLAoJCSAgICAgICAgY2hpbGQgPSB1bmRlZmluZWQsCgkJICAgICAgICBjb21waWxlciA9IHVuZGVmaW5lZDsKCgkJICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkJICAgICAgY2hpbGQgPSBjaGlsZHJlbltpXTsKCQkgICAgICBjb21waWxlciA9IG5ldyB0aGlzLmNvbXBpbGVyKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbmV3LWNhcAoKCQkgICAgICB2YXIgZXhpc3RpbmcgPSB0aGlzLm1hdGNoRXhpc3RpbmdQcm9ncmFtKGNoaWxkKTsKCgkJICAgICAgaWYgKGV4aXN0aW5nID09IG51bGwpIHsKCQkgICAgICAgIHRoaXMuY29udGV4dC5wcm9ncmFtcy5wdXNoKCcnKTsgLy8gUGxhY2Vob2xkZXIgdG8gcHJldmVudCBuYW1lIGNvbmZsaWN0cyBmb3IgbmVzdGVkIGNoaWxkcmVuCgkJICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmNvbnRleHQucHJvZ3JhbXMubGVuZ3RoOwoJCSAgICAgICAgY2hpbGQuaW5kZXggPSBpbmRleDsKCQkgICAgICAgIGNoaWxkLm5hbWUgPSAncHJvZ3JhbScgKyBpbmRleDsKCQkgICAgICAgIHRoaXMuY29udGV4dC5wcm9ncmFtc1tpbmRleF0gPSBjb21waWxlci5jb21waWxlKGNoaWxkLCBvcHRpb25zLCB0aGlzLmNvbnRleHQsICF0aGlzLnByZWNvbXBpbGUpOwoJCSAgICAgICAgdGhpcy5jb250ZXh0LmRlY29yYXRvcnNbaW5kZXhdID0gY29tcGlsZXIuZGVjb3JhdG9yczsKCQkgICAgICAgIHRoaXMuY29udGV4dC5lbnZpcm9ubWVudHNbaW5kZXhdID0gY2hpbGQ7CgoJCSAgICAgICAgdGhpcy51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocyB8fCBjb21waWxlci51c2VEZXB0aHM7CgkJICAgICAgICB0aGlzLnVzZUJsb2NrUGFyYW1zID0gdGhpcy51c2VCbG9ja1BhcmFtcyB8fCBjb21waWxlci51c2VCbG9ja1BhcmFtczsKCQkgICAgICAgIGNoaWxkLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzOwoJCSAgICAgICAgY2hpbGQudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICBjaGlsZC5pbmRleCA9IGV4aXN0aW5nLmluZGV4OwoJCSAgICAgICAgY2hpbGQubmFtZSA9ICdwcm9ncmFtJyArIGV4aXN0aW5nLmluZGV4OwoKCQkgICAgICAgIHRoaXMudXNlRGVwdGhzID0gdGhpcy51c2VEZXB0aHMgfHwgZXhpc3RpbmcudXNlRGVwdGhzOwoJCSAgICAgICAgdGhpcy51c2VCbG9ja1BhcmFtcyA9IHRoaXMudXNlQmxvY2tQYXJhbXMgfHwgZXhpc3RpbmcudXNlQmxvY2tQYXJhbXM7CgkJICAgICAgfQoJCSAgICB9CgkJICB9LAoJCSAgbWF0Y2hFeGlzdGluZ1Byb2dyYW06IGZ1bmN0aW9uIG1hdGNoRXhpc3RpbmdQcm9ncmFtKGNoaWxkKSB7CgkJICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgICAgdmFyIGVudmlyb25tZW50ID0gdGhpcy5jb250ZXh0LmVudmlyb25tZW50c1tpXTsKCQkgICAgICBpZiAoZW52aXJvbm1lbnQgJiYgZW52aXJvbm1lbnQuZXF1YWxzKGNoaWxkKSkgewoJCSAgICAgICAgcmV0dXJuIGVudmlyb25tZW50OwoJCSAgICAgIH0KCQkgICAgfQoJCSAgfSwKCgkJICBwcm9ncmFtRXhwcmVzc2lvbjogZnVuY3Rpb24gcHJvZ3JhbUV4cHJlc3Npb24oZ3VpZCkgewoJCSAgICB2YXIgY2hpbGQgPSB0aGlzLmVudmlyb25tZW50LmNoaWxkcmVuW2d1aWRdLAoJCSAgICAgICAgcHJvZ3JhbVBhcmFtcyA9IFtjaGlsZC5pbmRleCwgJ2RhdGEnLCBjaGlsZC5ibG9ja1BhcmFtc107CgoJCSAgICBpZiAodGhpcy51c2VCbG9ja1BhcmFtcyB8fCB0aGlzLnVzZURlcHRocykgewoJCSAgICAgIHByb2dyYW1QYXJhbXMucHVzaCgnYmxvY2tQYXJhbXMnKTsKCQkgICAgfQoJCSAgICBpZiAodGhpcy51c2VEZXB0aHMpIHsKCQkgICAgICBwcm9ncmFtUGFyYW1zLnB1c2goJ2RlcHRocycpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gJ2NvbnRhaW5lci5wcm9ncmFtKCcgKyBwcm9ncmFtUGFyYW1zLmpvaW4oJywgJykgKyAnKSc7CgkJICB9LAoKCQkgIHVzZVJlZ2lzdGVyOiBmdW5jdGlvbiB1c2VSZWdpc3RlcihuYW1lKSB7CgkJICAgIGlmICghdGhpcy5yZWdpc3RlcnNbbmFtZV0pIHsKCQkgICAgICB0aGlzLnJlZ2lzdGVyc1tuYW1lXSA9IHRydWU7CgkJICAgICAgdGhpcy5yZWdpc3RlcnMubGlzdC5wdXNoKG5hbWUpOwoJCSAgICB9CgkJICB9LAoKCQkgIHB1c2g6IGZ1bmN0aW9uIHB1c2goZXhwcikgewoJCSAgICBpZiAoIShleHByIGluc3RhbmNlb2YgTGl0ZXJhbCkpIHsKCQkgICAgICBleHByID0gdGhpcy5zb3VyY2Uud3JhcChleHByKTsKCQkgICAgfQoKCQkgICAgdGhpcy5pbmxpbmVTdGFjay5wdXNoKGV4cHIpOwoJCSAgICByZXR1cm4gZXhwcjsKCQkgIH0sCgoJCSAgcHVzaFN0YWNrTGl0ZXJhbDogZnVuY3Rpb24gcHVzaFN0YWNrTGl0ZXJhbChpdGVtKSB7CgkJICAgIHRoaXMucHVzaChuZXcgTGl0ZXJhbChpdGVtKSk7CgkJICB9LAoKCQkgIHB1c2hTb3VyY2U6IGZ1bmN0aW9uIHB1c2hTb3VyY2Uoc291cmNlKSB7CgkJICAgIGlmICh0aGlzLnBlbmRpbmdDb250ZW50KSB7CgkJICAgICAgdGhpcy5zb3VyY2UucHVzaCh0aGlzLmFwcGVuZFRvQnVmZmVyKHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyh0aGlzLnBlbmRpbmdDb250ZW50KSwgdGhpcy5wZW5kaW5nTG9jYXRpb24pKTsKCQkgICAgICB0aGlzLnBlbmRpbmdDb250ZW50ID0gdW5kZWZpbmVkOwoJCSAgICB9CgoJCSAgICBpZiAoc291cmNlKSB7CgkJICAgICAgdGhpcy5zb3VyY2UucHVzaChzb3VyY2UpOwoJCSAgICB9CgkJICB9LAoKCQkgIHJlcGxhY2VTdGFjazogZnVuY3Rpb24gcmVwbGFjZVN0YWNrKGNhbGxiYWNrKSB7CgkJICAgIHZhciBwcmVmaXggPSBbJygnXSwKCQkgICAgICAgIHN0YWNrID0gdW5kZWZpbmVkLAoJCSAgICAgICAgY3JlYXRlZFN0YWNrID0gdW5kZWZpbmVkLAoJCSAgICAgICAgdXNlZExpdGVyYWwgPSB1bmRlZmluZWQ7CgoJCSAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgICBpZiAoIXRoaXMuaXNJbmxpbmUoKSkgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdyZXBsYWNlU3RhY2sgb24gbm9uLWlubGluZScpOwoJCSAgICB9CgoJCSAgICAvLyBXZSB3YW50IHRvIG1lcmdlIHRoZSBpbmxpbmUgc3RhdGVtZW50IGludG8gdGhlIHJlcGxhY2VtZW50IHN0YXRlbWVudCB2aWEgJywnCgkJICAgIHZhciB0b3AgPSB0aGlzLnBvcFN0YWNrKHRydWUpOwoKCQkgICAgaWYgKHRvcCBpbnN0YW5jZW9mIExpdGVyYWwpIHsKCQkgICAgICAvLyBMaXRlcmFscyBkbyBub3QgbmVlZCB0byBiZSBpbmxpbmVkCgkJICAgICAgc3RhY2sgPSBbdG9wLnZhbHVlXTsKCQkgICAgICBwcmVmaXggPSBbJygnLCBzdGFja107CgkJICAgICAgdXNlZExpdGVyYWwgPSB0cnVlOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIC8vIEdldCBvciBjcmVhdGUgdGhlIGN1cnJlbnQgc3RhY2sgbmFtZSBmb3IgdXNlIGJ5IHRoZSBpbmxpbmUKCQkgICAgICBjcmVhdGVkU3RhY2sgPSB0cnVlOwoJCSAgICAgIHZhciBfbmFtZSA9IHRoaXMuaW5jclN0YWNrKCk7CgoJCSAgICAgIHByZWZpeCA9IFsnKCgnLCB0aGlzLnB1c2goX25hbWUpLCAnID0gJywgdG9wLCAnKSddOwoJCSAgICAgIHN0YWNrID0gdGhpcy50b3BTdGFjaygpOwoJCSAgICB9CgoJCSAgICB2YXIgaXRlbSA9IGNhbGxiYWNrLmNhbGwodGhpcywgc3RhY2spOwoKCQkgICAgaWYgKCF1c2VkTGl0ZXJhbCkgewoJCSAgICAgIHRoaXMucG9wU3RhY2soKTsKCQkgICAgfQoJCSAgICBpZiAoY3JlYXRlZFN0YWNrKSB7CgkJICAgICAgdGhpcy5zdGFja1Nsb3QtLTsKCQkgICAgfQoJCSAgICB0aGlzLnB1c2gocHJlZml4LmNvbmNhdChpdGVtLCAnKScpKTsKCQkgIH0sCgoJCSAgaW5jclN0YWNrOiBmdW5jdGlvbiBpbmNyU3RhY2soKSB7CgkJICAgIHRoaXMuc3RhY2tTbG90Kys7CgkJICAgIGlmICh0aGlzLnN0YWNrU2xvdCA+IHRoaXMuc3RhY2tWYXJzLmxlbmd0aCkgewoJCSAgICAgIHRoaXMuc3RhY2tWYXJzLnB1c2goJ3N0YWNrJyArIHRoaXMuc3RhY2tTbG90KTsKCQkgICAgfQoJCSAgICByZXR1cm4gdGhpcy50b3BTdGFja05hbWUoKTsKCQkgIH0sCgkJICB0b3BTdGFja05hbWU6IGZ1bmN0aW9uIHRvcFN0YWNrTmFtZSgpIHsKCQkgICAgcmV0dXJuICdzdGFjaycgKyB0aGlzLnN0YWNrU2xvdDsKCQkgIH0sCgkJICBmbHVzaElubGluZTogZnVuY3Rpb24gZmx1c2hJbmxpbmUoKSB7CgkJICAgIHZhciBpbmxpbmVTdGFjayA9IHRoaXMuaW5saW5lU3RhY2s7CgkJICAgIHRoaXMuaW5saW5lU3RhY2sgPSBbXTsKCQkgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGlubGluZVN0YWNrLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgICAgdmFyIGVudHJ5ID0gaW5saW5lU3RhY2tbaV07CgkJICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCgkJICAgICAgaWYgKGVudHJ5IGluc3RhbmNlb2YgTGl0ZXJhbCkgewoJCSAgICAgICAgdGhpcy5jb21waWxlU3RhY2sucHVzaChlbnRyeSk7CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIHZhciBzdGFjayA9IHRoaXMuaW5jclN0YWNrKCk7CgkJICAgICAgICB0aGlzLnB1c2hTb3VyY2UoW3N0YWNrLCAnID0gJywgZW50cnksICc7J10pOwoJCSAgICAgICAgdGhpcy5jb21waWxlU3RhY2sucHVzaChzdGFjayk7CgkJICAgICAgfQoJCSAgICB9CgkJICB9LAoJCSAgaXNJbmxpbmU6IGZ1bmN0aW9uIGlzSW5saW5lKCkgewoJCSAgICByZXR1cm4gdGhpcy5pbmxpbmVTdGFjay5sZW5ndGg7CgkJICB9LAoKCQkgIHBvcFN0YWNrOiBmdW5jdGlvbiBwb3BTdGFjayh3cmFwcGVkKSB7CgkJICAgIHZhciBpbmxpbmUgPSB0aGlzLmlzSW5saW5lKCksCgkJICAgICAgICBpdGVtID0gKGlubGluZSA/IHRoaXMuaW5saW5lU3RhY2sgOiB0aGlzLmNvbXBpbGVTdGFjaykucG9wKCk7CgoJCSAgICBpZiAoIXdyYXBwZWQgJiYgaXRlbSBpbnN0YW5jZW9mIExpdGVyYWwpIHsKCQkgICAgICByZXR1cm4gaXRlbS52YWx1ZTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICBpZiAoIWlubGluZSkgewoJCSAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQkgICAgICAgIGlmICghdGhpcy5zdGFja1Nsb3QpIHsKCQkgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ0ludmFsaWQgc3RhY2sgcG9wJyk7CgkJICAgICAgICB9CgkJICAgICAgICB0aGlzLnN0YWNrU2xvdC0tOwoJCSAgICAgIH0KCQkgICAgICByZXR1cm4gaXRlbTsKCQkgICAgfQoJCSAgfSwKCgkJICB0b3BTdGFjazogZnVuY3Rpb24gdG9wU3RhY2soKSB7CgkJICAgIHZhciBzdGFjayA9IHRoaXMuaXNJbmxpbmUoKSA/IHRoaXMuaW5saW5lU3RhY2sgOiB0aGlzLmNvbXBpbGVTdGFjaywKCQkgICAgICAgIGl0ZW0gPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTsKCgkJICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwoJCSAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIExpdGVyYWwpIHsKCQkgICAgICByZXR1cm4gaXRlbS52YWx1ZTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICByZXR1cm4gaXRlbTsKCQkgICAgfQoJCSAgfSwKCgkJICBjb250ZXh0TmFtZTogZnVuY3Rpb24gY29udGV4dE5hbWUoY29udGV4dCkgewoJCSAgICBpZiAodGhpcy51c2VEZXB0aHMgJiYgY29udGV4dCkgewoJCSAgICAgIHJldHVybiAnZGVwdGhzWycgKyBjb250ZXh0ICsgJ10nOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiAnZGVwdGgnICsgY29udGV4dDsKCQkgICAgfQoJCSAgfSwKCgkJICBxdW90ZWRTdHJpbmc6IGZ1bmN0aW9uIHF1b3RlZFN0cmluZyhzdHIpIHsKCQkgICAgcmV0dXJuIHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyhzdHIpOwoJCSAgfSwKCgkJICBvYmplY3RMaXRlcmFsOiBmdW5jdGlvbiBvYmplY3RMaXRlcmFsKG9iaikgewoJCSAgICByZXR1cm4gdGhpcy5zb3VyY2Uub2JqZWN0TGl0ZXJhbChvYmopOwoJCSAgfSwKCgkJICBhbGlhc2FibGU6IGZ1bmN0aW9uIGFsaWFzYWJsZShuYW1lKSB7CgkJICAgIHZhciByZXQgPSB0aGlzLmFsaWFzZXNbbmFtZV07CgkJICAgIGlmIChyZXQpIHsKCQkgICAgICByZXQucmVmZXJlbmNlQ291bnQrKzsKCQkgICAgICByZXR1cm4gcmV0OwoJCSAgICB9CgoJCSAgICByZXQgPSB0aGlzLmFsaWFzZXNbbmFtZV0gPSB0aGlzLnNvdXJjZS53cmFwKG5hbWUpOwoJCSAgICByZXQuYWxpYXNhYmxlID0gdHJ1ZTsKCQkgICAgcmV0LnJlZmVyZW5jZUNvdW50ID0gMTsKCgkJICAgIHJldHVybiByZXQ7CgkJICB9LAoKCQkgIHNldHVwSGVscGVyOiBmdW5jdGlvbiBzZXR1cEhlbHBlcihwYXJhbVNpemUsIG5hbWUsIGJsb2NrSGVscGVyKSB7CgkJICAgIHZhciBwYXJhbXMgPSBbXSwKCQkgICAgICAgIHBhcmFtc0luaXQgPSB0aGlzLnNldHVwSGVscGVyQXJncyhuYW1lLCBwYXJhbVNpemUsIHBhcmFtcywgYmxvY2tIZWxwZXIpOwoJCSAgICB2YXIgZm91bmRIZWxwZXIgPSB0aGlzLm5hbWVMb29rdXAoJ2hlbHBlcnMnLCBuYW1lLCAnaGVscGVyJyksCgkJICAgICAgICBjYWxsQ29udGV4dCA9IHRoaXMuYWxpYXNhYmxlKHRoaXMuY29udGV4dE5hbWUoMCkgKyAnICE9IG51bGwgPyAnICsgdGhpcy5jb250ZXh0TmFtZSgwKSArICcgOiB7fScpOwoKCQkgICAgcmV0dXJuIHsKCQkgICAgICBwYXJhbXM6IHBhcmFtcywKCQkgICAgICBwYXJhbXNJbml0OiBwYXJhbXNJbml0LAoJCSAgICAgIG5hbWU6IGZvdW5kSGVscGVyLAoJCSAgICAgIGNhbGxQYXJhbXM6IFtjYWxsQ29udGV4dF0uY29uY2F0KHBhcmFtcykKCQkgICAgfTsKCQkgIH0sCgoJCSAgc2V0dXBQYXJhbXM6IGZ1bmN0aW9uIHNldHVwUGFyYW1zKGhlbHBlciwgcGFyYW1TaXplLCBwYXJhbXMpIHsKCQkgICAgdmFyIG9wdGlvbnMgPSB7fSwKCQkgICAgICAgIGNvbnRleHRzID0gW10sCgkJICAgICAgICB0eXBlcyA9IFtdLAoJCSAgICAgICAgaWRzID0gW10sCgkJICAgICAgICBvYmplY3RBcmdzID0gIXBhcmFtcywKCQkgICAgICAgIHBhcmFtID0gdW5kZWZpbmVkOwoKCQkgICAgaWYgKG9iamVjdEFyZ3MpIHsKCQkgICAgICBwYXJhbXMgPSBbXTsKCQkgICAgfQoKCQkgICAgb3B0aW9ucy5uYW1lID0gdGhpcy5xdW90ZWRTdHJpbmcoaGVscGVyKTsKCQkgICAgb3B0aW9ucy5oYXNoID0gdGhpcy5wb3BTdGFjaygpOwoKCQkgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsKCQkgICAgICBvcHRpb25zLmhhc2hJZHMgPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgIH0KCQkgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7CgkJICAgICAgb3B0aW9ucy5oYXNoVHlwZXMgPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgICAgb3B0aW9ucy5oYXNoQ29udGV4dHMgPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgIH0KCgkJICAgIHZhciBpbnZlcnNlID0gdGhpcy5wb3BTdGFjaygpLAoJCSAgICAgICAgcHJvZ3JhbSA9IHRoaXMucG9wU3RhY2soKTsKCgkJICAgIC8vIEF2b2lkIHNldHRpbmcgZm4gYW5kIGludmVyc2UgaWYgbmVpdGhlciBhcmUgc2V0LiBUaGlzIGFsbG93cwoJCSAgICAvLyBoZWxwZXJzIHRvIGRvIGEgY2hlY2sgZm9yIGBpZiAob3B0aW9ucy5mbilgCgkJICAgIGlmIChwcm9ncmFtIHx8IGludmVyc2UpIHsKCQkgICAgICBvcHRpb25zLmZuID0gcHJvZ3JhbSB8fCAnY29udGFpbmVyLm5vb3AnOwoJCSAgICAgIG9wdGlvbnMuaW52ZXJzZSA9IGludmVyc2UgfHwgJ2NvbnRhaW5lci5ub29wJzsKCQkgICAgfQoKCQkgICAgLy8gVGhlIHBhcmFtZXRlcnMgZ28gb24gdG8gdGhlIHN0YWNrIGluIG9yZGVyIChtYWtpbmcgc3VyZSB0aGF0IHRoZXkgYXJlIGV2YWx1YXRlZCBpbiBvcmRlcikKCQkgICAgLy8gc28gd2UgbmVlZCB0byBwb3AgdGhlbSBvZmYgdGhlIHN0YWNrIGluIHJldmVyc2Ugb3JkZXIKCQkgICAgdmFyIGkgPSBwYXJhbVNpemU7CgkJICAgIHdoaWxlIChpLS0pIHsKCQkgICAgICBwYXJhbSA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgICBwYXJhbXNbaV0gPSBwYXJhbTsKCgkJICAgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsKCQkgICAgICAgIGlkc1tpXSA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgICB9CgkJICAgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7CgkJICAgICAgICB0eXBlc1tpXSA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgICAgIGNvbnRleHRzW2ldID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgaWYgKG9iamVjdEFyZ3MpIHsKCQkgICAgICBvcHRpb25zLmFyZ3MgPSB0aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KHBhcmFtcyk7CgkJICAgIH0KCgkJICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7CgkJICAgICAgb3B0aW9ucy5pZHMgPSB0aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KGlkcyk7CgkJICAgIH0KCQkgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7CgkJICAgICAgb3B0aW9ucy50eXBlcyA9IHRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkodHlwZXMpOwoJCSAgICAgIG9wdGlvbnMuY29udGV4dHMgPSB0aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KGNvbnRleHRzKTsKCQkgICAgfQoKCQkgICAgaWYgKHRoaXMub3B0aW9ucy5kYXRhKSB7CgkJICAgICAgb3B0aW9ucy5kYXRhID0gJ2RhdGEnOwoJCSAgICB9CgkJICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zKSB7CgkJICAgICAgb3B0aW9ucy5ibG9ja1BhcmFtcyA9ICdibG9ja1BhcmFtcyc7CgkJICAgIH0KCQkgICAgcmV0dXJuIG9wdGlvbnM7CgkJICB9LAoKCQkgIHNldHVwSGVscGVyQXJnczogZnVuY3Rpb24gc2V0dXBIZWxwZXJBcmdzKGhlbHBlciwgcGFyYW1TaXplLCBwYXJhbXMsIHVzZVJlZ2lzdGVyKSB7CgkJICAgIHZhciBvcHRpb25zID0gdGhpcy5zZXR1cFBhcmFtcyhoZWxwZXIsIHBhcmFtU2l6ZSwgcGFyYW1zKTsKCQkgICAgb3B0aW9ucyA9IHRoaXMub2JqZWN0TGl0ZXJhbChvcHRpb25zKTsKCQkgICAgaWYgKHVzZVJlZ2lzdGVyKSB7CgkJICAgICAgdGhpcy51c2VSZWdpc3Rlcignb3B0aW9ucycpOwoJCSAgICAgIHBhcmFtcy5wdXNoKCdvcHRpb25zJyk7CgkJICAgICAgcmV0dXJuIFsnb3B0aW9ucz0nLCBvcHRpb25zXTsKCQkgICAgfSBlbHNlIGlmIChwYXJhbXMpIHsKCQkgICAgICBwYXJhbXMucHVzaChvcHRpb25zKTsKCQkgICAgICByZXR1cm4gJyc7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcmV0dXJuIG9wdGlvbnM7CgkJICAgIH0KCQkgIH0KCQl9OwoKCQkoZnVuY3Rpb24gKCkgewoJCSAgdmFyIHJlc2VydmVkV29yZHMgPSAoJ2JyZWFrIGVsc2UgbmV3IHZhcicgKyAnIGNhc2UgZmluYWxseSByZXR1cm4gdm9pZCcgKyAnIGNhdGNoIGZvciBzd2l0Y2ggd2hpbGUnICsgJyBjb250aW51ZSBmdW5jdGlvbiB0aGlzIHdpdGgnICsgJyBkZWZhdWx0IGlmIHRocm93JyArICcgZGVsZXRlIGluIHRyeScgKyAnIGRvIGluc3RhbmNlb2YgdHlwZW9mJyArICcgYWJzdHJhY3QgZW51bSBpbnQgc2hvcnQnICsgJyBib29sZWFuIGV4cG9ydCBpbnRlcmZhY2Ugc3RhdGljJyArICcgYnl0ZSBleHRlbmRzIGxvbmcgc3VwZXInICsgJyBjaGFyIGZpbmFsIG5hdGl2ZSBzeW5jaHJvbml6ZWQnICsgJyBjbGFzcyBmbG9hdCBwYWNrYWdlIHRocm93cycgKyAnIGNvbnN0IGdvdG8gcHJpdmF0ZSB0cmFuc2llbnQnICsgJyBkZWJ1Z2dlciBpbXBsZW1lbnRzIHByb3RlY3RlZCB2b2xhdGlsZScgKyAnIGRvdWJsZSBpbXBvcnQgcHVibGljIGxldCB5aWVsZCBhd2FpdCcgKyAnIG51bGwgdHJ1ZSBmYWxzZScpLnNwbGl0KCcgJyk7CgoJCSAgdmFyIGNvbXBpbGVyV29yZHMgPSBKYXZhU2NyaXB0Q29tcGlsZXIuUkVTRVJWRURfV09SRFMgPSB7fTsKCgkJICBmb3IgKHZhciBpID0gMCwgbCA9IHJlc2VydmVkV29yZHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkJICAgIGNvbXBpbGVyV29yZHNbcmVzZXJ2ZWRXb3Jkc1tpXV0gPSB0cnVlOwoJCSAgfQoJCX0pKCk7CgoJCUphdmFTY3JpcHRDb21waWxlci5pc1ZhbGlkSmF2YVNjcmlwdFZhcmlhYmxlTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJICByZXR1cm4gIUphdmFTY3JpcHRDb21waWxlci5SRVNFUlZFRF9XT1JEU1tuYW1lXSAmJiAvXlthLXpBLVpfJF1bMC05YS16QS1aXyRdKiQvLnRlc3QobmFtZSk7CgkJfTsKCgkJZnVuY3Rpb24gc3RyaWN0TG9va3VwKHJlcXVpcmVUZXJtaW5hbCwgY29tcGlsZXIsIHBhcnRzLCB0eXBlKSB7CgkJICB2YXIgc3RhY2sgPSBjb21waWxlci5wb3BTdGFjaygpLAoJCSAgICAgIGkgPSAwLAoJCSAgICAgIGxlbiA9IHBhcnRzLmxlbmd0aDsKCQkgIGlmIChyZXF1aXJlVGVybWluYWwpIHsKCQkgICAgbGVuLS07CgkJICB9CgoJCSAgZm9yICg7IGkgPCBsZW47IGkrKykgewoJCSAgICBzdGFjayA9IGNvbXBpbGVyLm5hbWVMb29rdXAoc3RhY2ssIHBhcnRzW2ldLCB0eXBlKTsKCQkgIH0KCgkJICBpZiAocmVxdWlyZVRlcm1pbmFsKSB7CgkJICAgIHJldHVybiBbY29tcGlsZXIuYWxpYXNhYmxlKCdjb250YWluZXIuc3RyaWN0JyksICcoJywgc3RhY2ssICcsICcsIGNvbXBpbGVyLnF1b3RlZFN0cmluZyhwYXJ0c1tpXSksICcpJ107CgkJICB9IGVsc2UgewoJCSAgICByZXR1cm4gc3RhY2s7CgkJICB9CgkJfQoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBKYXZhU2NyaXB0Q29tcGlsZXI7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDMyICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJLyogZ2xvYmFsIGRlZmluZSAqLwoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBTb3VyY2VOb2RlID0gdW5kZWZpbmVkOwoKCQl0cnkgewoJCSAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQkgIGlmIChmYWxzZSkgewoJCSAgICAvLyBXZSBkb24ndCBzdXBwb3J0IHRoaXMgaW4gQU1EIGVudmlyb25tZW50cy4gRm9yIHRoZXNlIGVudmlyb25tZW50cywgd2UgYXN1c21lIHRoYXQKCQkgICAgLy8gdGhleSBhcmUgcnVubmluZyBvbiB0aGUgYnJvd3NlciBhbmQgdGh1cyBoYXZlIG5vIG5lZWQgZm9yIHRoZSBzb3VyY2UtbWFwIGxpYnJhcnkuCgkJICAgIHZhciBTb3VyY2VNYXAgPSByZXF1aXJlKCdzb3VyY2UtbWFwJyk7CgkJICAgIFNvdXJjZU5vZGUgPSBTb3VyY2VNYXAuU291cmNlTm9kZTsKCQkgIH0KCQl9IGNhdGNoIChlcnIpIHt9CgkJLyogTk9QICovCgoJCS8qIGlzdGFuYnVsIGlnbm9yZSBpZjogdGVzdGVkIGJ1dCBub3QgY292ZXJlZCBpbiBpc3RhbmJ1bCBkdWUgdG8gZGlzdCBidWlsZCAgKi8KCQlpZiAoIVNvdXJjZU5vZGUpIHsKCQkgIFNvdXJjZU5vZGUgPSBmdW5jdGlvbiAobGluZSwgY29sdW1uLCBzcmNGaWxlLCBjaHVua3MpIHsKCQkgICAgdGhpcy5zcmMgPSAnJzsKCQkgICAgaWYgKGNodW5rcykgewoJCSAgICAgIHRoaXMuYWRkKGNodW5rcyk7CgkJICAgIH0KCQkgIH07CgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgU291cmNlTm9kZS5wcm90b3R5cGUgPSB7CgkJICAgIGFkZDogZnVuY3Rpb24gYWRkKGNodW5rcykgewoJCSAgICAgIGlmIChfdXRpbHMuaXNBcnJheShjaHVua3MpKSB7CgkJICAgICAgICBjaHVua3MgPSBjaHVua3Muam9pbignJyk7CgkJICAgICAgfQoJCSAgICAgIHRoaXMuc3JjICs9IGNodW5rczsKCQkgICAgfSwKCQkgICAgcHJlcGVuZDogZnVuY3Rpb24gcHJlcGVuZChjaHVua3MpIHsKCQkgICAgICBpZiAoX3V0aWxzLmlzQXJyYXkoY2h1bmtzKSkgewoJCSAgICAgICAgY2h1bmtzID0gY2h1bmtzLmpvaW4oJycpOwoJCSAgICAgIH0KCQkgICAgICB0aGlzLnNyYyA9IGNodW5rcyArIHRoaXMuc3JjOwoJCSAgICB9LAoJCSAgICB0b1N0cmluZ1dpdGhTb3VyY2VNYXA6IGZ1bmN0aW9uIHRvU3RyaW5nV2l0aFNvdXJjZU1hcCgpIHsKCQkgICAgICByZXR1cm4geyBjb2RlOiB0aGlzLnRvU3RyaW5nKCkgfTsKCQkgICAgfSwKCQkgICAgdG9TdHJpbmc6IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewoJCSAgICAgIHJldHVybiB0aGlzLnNyYzsKCQkgICAgfQoJCSAgfTsKCQl9CgoJCWZ1bmN0aW9uIGNhc3RDaHVuayhjaHVuaywgY29kZUdlbiwgbG9jKSB7CgkJICBpZiAoX3V0aWxzLmlzQXJyYXkoY2h1bmspKSB7CgkJICAgIHZhciByZXQgPSBbXTsKCgkJICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjaHVuay5sZW5ndGg7IGkgPCBsZW47IGkrKykgewoJCSAgICAgIHJldC5wdXNoKGNvZGVHZW4ud3JhcChjaHVua1tpXSwgbG9jKSk7CgkJICAgIH0KCQkgICAgcmV0dXJuIHJldDsKCQkgIH0gZWxzZSBpZiAodHlwZW9mIGNodW5rID09PSAnYm9vbGVhbicgfHwgdHlwZW9mIGNodW5rID09PSAnbnVtYmVyJykgewoJCSAgICAvLyBIYW5kbGUgcHJpbWl0aXZlcyB0aGF0IHRoZSBTb3VyY2VOb2RlIHdpbGwgdGhyb3cgdXAgb24KCQkgICAgcmV0dXJuIGNodW5rICsgJyc7CgkJICB9CgkJICByZXR1cm4gY2h1bms7CgkJfQoKCQlmdW5jdGlvbiBDb2RlR2VuKHNyY0ZpbGUpIHsKCQkgIHRoaXMuc3JjRmlsZSA9IHNyY0ZpbGU7CgkJICB0aGlzLnNvdXJjZSA9IFtdOwoJCX0KCgkJQ29kZUdlbi5wcm90b3R5cGUgPSB7CgkJICBpc0VtcHR5OiBmdW5jdGlvbiBpc0VtcHR5KCkgewoJCSAgICByZXR1cm4gIXRoaXMuc291cmNlLmxlbmd0aDsKCQkgIH0sCgkJICBwcmVwZW5kOiBmdW5jdGlvbiBwcmVwZW5kKHNvdXJjZSwgbG9jKSB7CgkJICAgIHRoaXMuc291cmNlLnVuc2hpZnQodGhpcy53cmFwKHNvdXJjZSwgbG9jKSk7CgkJICB9LAoJCSAgcHVzaDogZnVuY3Rpb24gcHVzaChzb3VyY2UsIGxvYykgewoJCSAgICB0aGlzLnNvdXJjZS5wdXNoKHRoaXMud3JhcChzb3VyY2UsIGxvYykpOwoJCSAgfSwKCgkJICBtZXJnZTogZnVuY3Rpb24gbWVyZ2UoKSB7CgkJICAgIHZhciBzb3VyY2UgPSB0aGlzLmVtcHR5KCk7CgkJICAgIHRoaXMuZWFjaChmdW5jdGlvbiAobGluZSkgewoJCSAgICAgIHNvdXJjZS5hZGQoWycgICcsIGxpbmUsICdcbiddKTsKCQkgICAgfSk7CgkJICAgIHJldHVybiBzb3VyY2U7CgkJICB9LAoKCQkgIGVhY2g6IGZ1bmN0aW9uIGVhY2goaXRlcikgewoJCSAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5zb3VyY2UubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICBpdGVyKHRoaXMuc291cmNlW2ldKTsKCQkgICAgfQoJCSAgfSwKCgkJICBlbXB0eTogZnVuY3Rpb24gZW1wdHkoKSB7CgkJICAgIHZhciBsb2MgPSB0aGlzLmN1cnJlbnRMb2NhdGlvbiB8fCB7IHN0YXJ0OiB7fSB9OwoJCSAgICByZXR1cm4gbmV3IFNvdXJjZU5vZGUobG9jLnN0YXJ0LmxpbmUsIGxvYy5zdGFydC5jb2x1bW4sIHRoaXMuc3JjRmlsZSk7CgkJICB9LAoJCSAgd3JhcDogZnVuY3Rpb24gd3JhcChjaHVuaykgewoJCSAgICB2YXIgbG9jID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gdGhpcy5jdXJyZW50TG9jYXRpb24gfHwgeyBzdGFydDoge30gfSA6IGFyZ3VtZW50c1sxXTsKCgkJICAgIGlmIChjaHVuayBpbnN0YW5jZW9mIFNvdXJjZU5vZGUpIHsKCQkgICAgICByZXR1cm4gY2h1bms7CgkJICAgIH0KCgkJICAgIGNodW5rID0gY2FzdENodW5rKGNodW5rLCB0aGlzLCBsb2MpOwoKCQkgICAgcmV0dXJuIG5ldyBTb3VyY2VOb2RlKGxvYy5zdGFydC5saW5lLCBsb2Muc3RhcnQuY29sdW1uLCB0aGlzLnNyY0ZpbGUsIGNodW5rKTsKCQkgIH0sCgoJCSAgZnVuY3Rpb25DYWxsOiBmdW5jdGlvbiBmdW5jdGlvbkNhbGwoZm4sIHR5cGUsIHBhcmFtcykgewoJCSAgICBwYXJhbXMgPSB0aGlzLmdlbmVyYXRlTGlzdChwYXJhbXMpOwoJCSAgICByZXR1cm4gdGhpcy53cmFwKFtmbiwgdHlwZSA/ICcuJyArIHR5cGUgKyAnKCcgOiAnKCcsIHBhcmFtcywgJyknXSk7CgkJICB9LAoKCQkgIHF1b3RlZFN0cmluZzogZnVuY3Rpb24gcXVvdGVkU3RyaW5nKHN0cikgewoJCSAgICByZXR1cm4gJyInICsgKHN0ciArICcnKS5yZXBsYWNlKC9cXC9nLCAnXFxcXCcpLnJlcGxhY2UoLyIvZywgJ1xcIicpLnJlcGxhY2UoL1xuL2csICdcXG4nKS5yZXBsYWNlKC9cci9nLCAnXFxyJykucmVwbGFjZSgvXHUyMDI4L2csICdcXHUyMDI4JykgLy8gUGVyIEVjbWEtMjYyIDcuMyArIDcuOC40CgkJICAgIC5yZXBsYWNlKC9cdTIwMjkvZywgJ1xcdTIwMjknKSArICciJzsKCQkgIH0sCgoJCSAgb2JqZWN0TGl0ZXJhbDogZnVuY3Rpb24gb2JqZWN0TGl0ZXJhbChvYmopIHsKCQkgICAgdmFyIHBhaXJzID0gW107CgoJCSAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CgkJICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CgkJICAgICAgICB2YXIgdmFsdWUgPSBjYXN0Q2h1bmsob2JqW2tleV0sIHRoaXMpOwoJCSAgICAgICAgaWYgKHZhbHVlICE9PSAndW5kZWZpbmVkJykgewoJCSAgICAgICAgICBwYWlycy5wdXNoKFt0aGlzLnF1b3RlZFN0cmluZyhrZXkpLCAnOicsIHZhbHVlXSk7CgkJICAgICAgICB9CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICB2YXIgcmV0ID0gdGhpcy5nZW5lcmF0ZUxpc3QocGFpcnMpOwoJCSAgICByZXQucHJlcGVuZCgneycpOwoJCSAgICByZXQuYWRkKCd9Jyk7CgkJICAgIHJldHVybiByZXQ7CgkJICB9LAoKCQkgIGdlbmVyYXRlTGlzdDogZnVuY3Rpb24gZ2VuZXJhdGVMaXN0KGVudHJpZXMpIHsKCQkgICAgdmFyIHJldCA9IHRoaXMuZW1wdHkoKTsKCgkJICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBlbnRyaWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgICAgaWYgKGkpIHsKCQkgICAgICAgIHJldC5hZGQoJywnKTsKCQkgICAgICB9CgoJCSAgICAgIHJldC5hZGQoY2FzdENodW5rKGVudHJpZXNbaV0sIHRoaXMpKTsKCQkgICAgfQoKCQkgICAgcmV0dXJuIHJldDsKCQkgIH0sCgoJCSAgZ2VuZXJhdGVBcnJheTogZnVuY3Rpb24gZ2VuZXJhdGVBcnJheShlbnRyaWVzKSB7CgkJICAgIHZhciByZXQgPSB0aGlzLmdlbmVyYXRlTGlzdChlbnRyaWVzKTsKCQkgICAgcmV0LnByZXBlbmQoJ1snKTsKCQkgICAgcmV0LmFkZCgnXScpOwoKCQkgICAgcmV0dXJuIHJldDsKCQkgIH0KCQl9OwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBDb2RlR2VuOwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0KCS8qKioqKiovIF0pCgl9KTsKCTsKCi8qKiovIH0sCi8qIDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOyd1c2Ugc3RyaWN0JzsKCgkhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbX193ZWJwYWNrX3JlcXVpcmVfXyg3KSwgX193ZWJwYWNrX3JlcXVpcmVfXyg5KV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24gKF8sIENvb2tpZSkgewoKCSAgdmFyIFNFQ1VSRURfQ09PS0lFID0gL15odHRwcy8udGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZik7CgoJICByZXR1cm4gewoJICAgIHNldENvb2tpZTogZnVuY3Rpb24gc2V0Q29va2llKG5hbWUsIHZhbHVlLCBvcHRpb25zKSB7CgkgICAgICBDb29raWUuc2V0KG5hbWUsIHZhbHVlLCBfLmRlZmF1bHRzKG9wdGlvbnMgfHwge30sIHsKCSAgICAgICAgc2VjdXJlOiBTRUNVUkVEX0NPT0tJRSwKCSAgICAgICAgcGF0aDogJy8nCgkgICAgICB9KSk7CgkgICAgfSwKCgkgICAgZ2V0Q29va2llOiBmdW5jdGlvbiBnZXRDb29raWUoKSB7CgkgICAgICByZXR1cm4gQ29va2llLmdldC5hcHBseShDb29raWUsIGFyZ3VtZW50cyk7CgkgICAgfSwKCgkgICAgcmVtb3ZlQ29va2llOiBmdW5jdGlvbiByZW1vdmVDb29raWUoKSB7CgkgICAgICByZXR1cm4gQ29va2llLnJlbW92ZS5hcHBseShDb29raWUsIGFyZ3VtZW50cyk7CgkgICAgfQoJICB9OwoJfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoKLyoqKi8gfSwKLyogNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187J3VzZSBzdHJpY3QnOwoKCS8qIGVzbGludCBva3RhL2VuZm9yY2UtcmVxdWlyZWpzLW5hbWVzOiAwLCBva3RhL25vLXNwZWNpZmljLW1ldGhvZHM6IDAsIG9rdGEvbm8tc3BlY2lmaWMtbW9kdWxlczogMCAqLwoJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18oOCksIF9fd2VicGFja19yZXF1aXJlX18oNSldLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uICh1bmRlcnNjb3JlLCBIYW5kbGViYXJzKSB7CgoJICB2YXIgXyA9IHVuZGVyc2NvcmUubm9Db25mbGljdCgpOwoKCSAgXy5taXhpbih7CgoJICAgIHJlc3VsdEN0eDogZnVuY3Rpb24gcmVzdWx0Q3R4KG9iamVjdCwgcHJvcGVydHksIGNvbnRleHQsIGRlZmF1bHRWYWx1ZSkgewoJICAgICAgdmFyIHZhbHVlID0gXy5pc09iamVjdChvYmplY3QpID8gb2JqZWN0W3Byb3BlcnR5XSA6IHZvaWQgMDsKCSAgICAgIGlmIChfLmlzRnVuY3Rpb24odmFsdWUpKSB7CgkgICAgICAgIHZhbHVlID0gdmFsdWUuY2FsbChjb250ZXh0IHx8IG9iamVjdCk7CgkgICAgICB9CgkgICAgICBpZiAodmFsdWUpIHsKCSAgICAgICAgcmV0dXJuIHZhbHVlOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmV0dXJuICFfLmlzVW5kZWZpbmVkKGRlZmF1bHRWYWx1ZSkgPyBkZWZhdWx0VmFsdWUgOiB2YWx1ZTsKCSAgICAgIH0KCSAgICB9LAoKCSAgICBpc0ludGVnZXI6IGZ1bmN0aW9uIGlzSW50ZWdlcih4KSB7CgkgICAgICByZXR1cm4gXy5pc051bWJlcih4KSAmJiB4ICUgMSA9PT0gMDsKCSAgICB9LAoKCSAgICB0ZW1wbGF0ZTogZnVuY3Rpb24gdGVtcGxhdGUoc291cmNlLCBkYXRhKSB7CgkgICAgICB2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoc291cmNlKTsKCSAgICAgIHJldHVybiBkYXRhID8gdGVtcGxhdGUoZGF0YSkgOiBmdW5jdGlvbiAoZGF0YSkgewoJICAgICAgICByZXR1cm4gdGVtcGxhdGUoZGF0YSk7CgkgICAgICB9OwoJICAgIH0KCgkgIH0pOwoKCSAgcmV0dXJuIF87Cgl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgovKioqLyB9LAovKiA4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvLyAgICAgVW5kZXJzY29yZS5qcyAxLjguMwoJLy8gICAgIGh0dHA6Ly91bmRlcnNjb3JlanMub3JnCgkvLyAgICAgKGMpIDIwMDktMjAxNSBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9ycwoJLy8gICAgIFVuZGVyc2NvcmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCgoJKGZ1bmN0aW9uKCkgewoKCSAgLy8gQmFzZWxpbmUgc2V0dXAKCSAgLy8gLS0tLS0tLS0tLS0tLS0KCgkgIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZXhwb3J0c2Agb24gdGhlIHNlcnZlci4KCSAgdmFyIHJvb3QgPSB0aGlzOwoKCSAgLy8gU2F2ZSB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGBfYCB2YXJpYWJsZS4KCSAgdmFyIHByZXZpb3VzVW5kZXJzY29yZSA9IHJvb3QuXzsKCgkgIC8vIFNhdmUgYnl0ZXMgaW4gdGhlIG1pbmlmaWVkIChidXQgbm90IGd6aXBwZWQpIHZlcnNpb246CgkgIHZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlLCBPYmpQcm90byA9IE9iamVjdC5wcm90b3R5cGUsIEZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKCgkgIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFyaWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLgoJICB2YXIKCSAgICBwdXNoICAgICAgICAgICAgID0gQXJyYXlQcm90by5wdXNoLAoJICAgIHNsaWNlICAgICAgICAgICAgPSBBcnJheVByb3RvLnNsaWNlLAoJICAgIHRvU3RyaW5nICAgICAgICAgPSBPYmpQcm90by50b1N0cmluZywKCSAgICBoYXNPd25Qcm9wZXJ0eSAgID0gT2JqUHJvdG8uaGFzT3duUHJvcGVydHk7CgoJICAvLyBBbGwgKipFQ01BU2NyaXB0IDUqKiBuYXRpdmUgZnVuY3Rpb24gaW1wbGVtZW50YXRpb25zIHRoYXQgd2UgaG9wZSB0byB1c2UKCSAgLy8gYXJlIGRlY2xhcmVkIGhlcmUuCgkgIHZhcgoJICAgIG5hdGl2ZUlzQXJyYXkgICAgICA9IEFycmF5LmlzQXJyYXksCgkgICAgbmF0aXZlS2V5cyAgICAgICAgID0gT2JqZWN0LmtleXMsCgkgICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQsCgkgICAgbmF0aXZlQ3JlYXRlICAgICAgID0gT2JqZWN0LmNyZWF0ZTsKCgkgIC8vIE5ha2VkIGZ1bmN0aW9uIHJlZmVyZW5jZSBmb3Igc3Vycm9nYXRlLXByb3RvdHlwZS1zd2FwcGluZy4KCSAgdmFyIEN0b3IgPSBmdW5jdGlvbigpe307CgoJICAvLyBDcmVhdGUgYSBzYWZlIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yIHVzZSBiZWxvdy4KCSAgdmFyIF8gPSBmdW5jdGlvbihvYmopIHsKCSAgICBpZiAob2JqIGluc3RhbmNlb2YgXykgcmV0dXJuIG9iajsKCSAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgXykpIHJldHVybiBuZXcgXyhvYmopOwoJICAgIHRoaXMuX3dyYXBwZWQgPSBvYmo7CgkgIH07CgoJICAvLyBFeHBvcnQgdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciAqKk5vZGUuanMqKiwgd2l0aAoJICAvLyBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eSBmb3IgdGhlIG9sZCBgcmVxdWlyZSgpYCBBUEkuIElmIHdlJ3JlIGluCgkgIC8vIHRoZSBicm93c2VyLCBhZGQgYF9gIGFzIGEgZ2xvYmFsIG9iamVjdC4KCSAgaWYgKHRydWUpIHsKCSAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHsKCSAgICAgIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF87CgkgICAgfQoJICAgIGV4cG9ydHMuXyA9IF87CgkgIH0gZWxzZSB7CgkgICAgcm9vdC5fID0gXzsKCSAgfQoKCSAgLy8gQ3VycmVudCB2ZXJzaW9uLgoJICBfLlZFUlNJT04gPSAnMS44LjMnOwoKCSAgLy8gSW50ZXJuYWwgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIGVmZmljaWVudCAoZm9yIGN1cnJlbnQgZW5naW5lcykgdmVyc2lvbgoJICAvLyBvZiB0aGUgcGFzc2VkLWluIGNhbGxiYWNrLCB0byBiZSByZXBlYXRlZGx5IGFwcGxpZWQgaW4gb3RoZXIgVW5kZXJzY29yZQoJICAvLyBmdW5jdGlvbnMuCgkgIHZhciBvcHRpbWl6ZUNiID0gZnVuY3Rpb24oZnVuYywgY29udGV4dCwgYXJnQ291bnQpIHsKCSAgICBpZiAoY29udGV4dCA9PT0gdm9pZCAwKSByZXR1cm4gZnVuYzsKCSAgICBzd2l0Y2ggKGFyZ0NvdW50ID09IG51bGwgPyAzIDogYXJnQ291bnQpIHsKCSAgICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7CgkgICAgICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCwgdmFsdWUpOwoJICAgICAgfTsKCSAgICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBvdGhlcikgewoJICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIHZhbHVlLCBvdGhlcik7CgkgICAgICB9OwoJICAgICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7CgkgICAgICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTsKCSAgICAgIH07CgkgICAgICBjYXNlIDQ6IHJldHVybiBmdW5jdGlvbihhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7CgkgICAgICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCwgYWNjdW11bGF0b3IsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7CgkgICAgICB9OwoJICAgIH0KCSAgICByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgICByZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpOwoJICAgIH07CgkgIH07CgoJICAvLyBBIG1vc3RseS1pbnRlcm5hbCBmdW5jdGlvbiB0byBnZW5lcmF0ZSBjYWxsYmFja3MgdGhhdCBjYW4gYmUgYXBwbGllZAoJICAvLyB0byBlYWNoIGVsZW1lbnQgaW4gYSBjb2xsZWN0aW9uLCByZXR1cm5pbmcgdGhlIGRlc2lyZWQgcmVzdWx0IOKAlCBlaXRoZXIKCSAgLy8gaWRlbnRpdHksIGFuIGFyYml0cmFyeSBjYWxsYmFjaywgYSBwcm9wZXJ0eSBtYXRjaGVyLCBvciBhIHByb3BlcnR5IGFjY2Vzc29yLgoJICB2YXIgY2IgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpIHsKCSAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIF8uaWRlbnRpdHk7CgkgICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHJldHVybiBvcHRpbWl6ZUNiKHZhbHVlLCBjb250ZXh0LCBhcmdDb3VudCk7CgkgICAgaWYgKF8uaXNPYmplY3QodmFsdWUpKSByZXR1cm4gXy5tYXRjaGVyKHZhbHVlKTsKCSAgICByZXR1cm4gXy5wcm9wZXJ0eSh2YWx1ZSk7CgkgIH07CgkgIF8uaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCkgewoJICAgIHJldHVybiBjYih2YWx1ZSwgY29udGV4dCwgSW5maW5pdHkpOwoJICB9OwoKCSAgLy8gQW4gaW50ZXJuYWwgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIGFzc2lnbmVyIGZ1bmN0aW9ucy4KCSAgdmFyIGNyZWF0ZUFzc2lnbmVyID0gZnVuY3Rpb24oa2V5c0Z1bmMsIHVuZGVmaW5lZE9ubHkpIHsKCSAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7CgkgICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsKCSAgICAgIGlmIChsZW5ndGggPCAyIHx8IG9iaiA9PSBudWxsKSByZXR1cm4gb2JqOwoJICAgICAgZm9yICh2YXIgaW5kZXggPSAxOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewoJICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2luZGV4XSwKCSAgICAgICAgICAgIGtleXMgPSBrZXlzRnVuYyhzb3VyY2UpLAoJICAgICAgICAgICAgbCA9IGtleXMubGVuZ3RoOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykgewoJICAgICAgICAgIHZhciBrZXkgPSBrZXlzW2ldOwoJICAgICAgICAgIGlmICghdW5kZWZpbmVkT25seSB8fCBvYmpba2V5XSA9PT0gdm9pZCAwKSBvYmpba2V5XSA9IHNvdXJjZVtrZXldOwoJICAgICAgICB9CgkgICAgICB9CgkgICAgICByZXR1cm4gb2JqOwoJICAgIH07CgkgIH07CgoJICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgYSBuZXcgb2JqZWN0IHRoYXQgaW5oZXJpdHMgZnJvbSBhbm90aGVyLgoJICB2YXIgYmFzZUNyZWF0ZSA9IGZ1bmN0aW9uKHByb3RvdHlwZSkgewoJICAgIGlmICghXy5pc09iamVjdChwcm90b3R5cGUpKSByZXR1cm4ge307CgkgICAgaWYgKG5hdGl2ZUNyZWF0ZSkgcmV0dXJuIG5hdGl2ZUNyZWF0ZShwcm90b3R5cGUpOwoJICAgIEN0b3IucHJvdG90eXBlID0gcHJvdG90eXBlOwoJICAgIHZhciByZXN1bHQgPSBuZXcgQ3RvcjsKCSAgICBDdG9yLnByb3RvdHlwZSA9IG51bGw7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfTsKCgkgIHZhciBwcm9wZXJ0eSA9IGZ1bmN0aW9uKGtleSkgewoJICAgIHJldHVybiBmdW5jdGlvbihvYmopIHsKCSAgICAgIHJldHVybiBvYmogPT0gbnVsbCA/IHZvaWQgMCA6IG9ialtrZXldOwoJICAgIH07CgkgIH07CgoJICAvLyBIZWxwZXIgZm9yIGNvbGxlY3Rpb24gbWV0aG9kcyB0byBkZXRlcm1pbmUgd2hldGhlciBhIGNvbGxlY3Rpb24KCSAgLy8gc2hvdWxkIGJlIGl0ZXJhdGVkIGFzIGFuIGFycmF5IG9yIGFzIGFuIG9iamVjdAoJICAvLyBSZWxhdGVkOiBodHRwOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy10b2xlbmd0aAoJICAvLyBBdm9pZHMgYSB2ZXJ5IG5hc3R5IGlPUyA4IEpJVCBidWcgb24gQVJNLTY0LiAjMjA5NAoJICB2YXIgTUFYX0FSUkFZX0lOREVYID0gTWF0aC5wb3coMiwgNTMpIC0gMTsKCSAgdmFyIGdldExlbmd0aCA9IHByb3BlcnR5KCdsZW5ndGgnKTsKCSAgdmFyIGlzQXJyYXlMaWtlID0gZnVuY3Rpb24oY29sbGVjdGlvbikgewoJICAgIHZhciBsZW5ndGggPSBnZXRMZW5ndGgoY29sbGVjdGlvbik7CgkgICAgcmV0dXJuIHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicgJiYgbGVuZ3RoID49IDAgJiYgbGVuZ3RoIDw9IE1BWF9BUlJBWV9JTkRFWDsKCSAgfTsKCgkgIC8vIENvbGxlY3Rpb24gRnVuY3Rpb25zCgkgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoJICAvLyBUaGUgY29ybmVyc3RvbmUsIGFuIGBlYWNoYCBpbXBsZW1lbnRhdGlvbiwgYWthIGBmb3JFYWNoYC4KCSAgLy8gSGFuZGxlcyByYXcgb2JqZWN0cyBpbiBhZGRpdGlvbiB0byBhcnJheS1saWtlcy4gVHJlYXRzIGFsbAoJICAvLyBzcGFyc2UgYXJyYXktbGlrZXMgYXMgaWYgdGhleSB3ZXJlIGRlbnNlLgoJICBfLmVhY2ggPSBfLmZvckVhY2ggPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICB2YXIgaSwgbGVuZ3RoOwoJICAgIGlmIChpc0FycmF5TGlrZShvYmopKSB7CgkgICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgICAgaXRlcmF0ZWUob2JqW2ldLCBpLCBvYmopOwoJICAgICAgfQoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopOwoJICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICBpdGVyYXRlZShvYmpba2V5c1tpXV0sIGtleXNbaV0sIG9iaik7CgkgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBvYmo7CgkgIH07CgoJICAvLyBSZXR1cm4gdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlIHRvIGVhY2ggZWxlbWVudC4KCSAgXy5tYXAgPSBfLmNvbGxlY3QgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CgkgICAgdmFyIGtleXMgPSAhaXNBcnJheUxpa2Uob2JqKSAmJiBfLmtleXMob2JqKSwKCSAgICAgICAgbGVuZ3RoID0gKGtleXMgfHwgb2JqKS5sZW5ndGgsCgkgICAgICAgIHJlc3VsdHMgPSBBcnJheShsZW5ndGgpOwoJICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKCSAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7CgkgICAgICByZXN1bHRzW2luZGV4XSA9IGl0ZXJhdGVlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKTsKCSAgICB9CgkgICAgcmV0dXJuIHJlc3VsdHM7CgkgIH07CgoJICAvLyBDcmVhdGUgYSByZWR1Y2luZyBmdW5jdGlvbiBpdGVyYXRpbmcgbGVmdCBvciByaWdodC4KCSAgZnVuY3Rpb24gY3JlYXRlUmVkdWNlKGRpcikgewoJICAgIC8vIE9wdGltaXplZCBpdGVyYXRvciBmdW5jdGlvbiBhcyB1c2luZyBhcmd1bWVudHMubGVuZ3RoCgkgICAgLy8gaW4gdGhlIG1haW4gZnVuY3Rpb24gd2lsbCBkZW9wdGltaXplIHRoZSwgc2VlICMxOTkxLgoJICAgIGZ1bmN0aW9uIGl0ZXJhdG9yKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGtleXMsIGluZGV4LCBsZW5ndGgpIHsKCSAgICAgIGZvciAoOyBpbmRleCA+PSAwICYmIGluZGV4IDwgbGVuZ3RoOyBpbmRleCArPSBkaXIpIHsKCSAgICAgICAgdmFyIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDsKCSAgICAgICAgbWVtbyA9IGl0ZXJhdGVlKG1lbW8sIG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKTsKCSAgICAgIH0KCSAgICAgIHJldHVybiBtZW1vOwoJICAgIH0KCgkgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGNvbnRleHQpIHsKCSAgICAgIGl0ZXJhdGVlID0gb3B0aW1pemVDYihpdGVyYXRlZSwgY29udGV4dCwgNCk7CgkgICAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLAoJICAgICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLAoJICAgICAgICAgIGluZGV4ID0gZGlyID4gMCA/IDAgOiBsZW5ndGggLSAxOwoJICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBpbml0aWFsIHZhbHVlIGlmIG5vbmUgaXMgcHJvdmlkZWQuCgkgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgbWVtbyA9IG9ialtrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleF07CgkgICAgICAgIGluZGV4ICs9IGRpcjsKCSAgICAgIH0KCSAgICAgIHJldHVybiBpdGVyYXRvcihvYmosIGl0ZXJhdGVlLCBtZW1vLCBrZXlzLCBpbmRleCwgbGVuZ3RoKTsKCSAgICB9OwoJICB9CgoJICAvLyAqKlJlZHVjZSoqIGJ1aWxkcyB1cCBhIHNpbmdsZSByZXN1bHQgZnJvbSBhIGxpc3Qgb2YgdmFsdWVzLCBha2EgYGluamVjdGAsCgkgIC8vIG9yIGBmb2xkbGAuCgkgIF8ucmVkdWNlID0gXy5mb2xkbCA9IF8uaW5qZWN0ID0gY3JlYXRlUmVkdWNlKDEpOwoKCSAgLy8gVGhlIHJpZ2h0LWFzc29jaWF0aXZlIHZlcnNpb24gb2YgcmVkdWNlLCBhbHNvIGtub3duIGFzIGBmb2xkcmAuCgkgIF8ucmVkdWNlUmlnaHQgPSBfLmZvbGRyID0gY3JlYXRlUmVkdWNlKC0xKTsKCgkgIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC4KCSAgXy5maW5kID0gXy5kZXRlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewoJICAgIHZhciBrZXk7CgkgICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHsKCSAgICAgIGtleSA9IF8uZmluZEluZGV4KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTsKCSAgICB9IGVsc2UgewoJICAgICAga2V5ID0gXy5maW5kS2V5KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTsKCSAgICB9CgkgICAgaWYgKGtleSAhPT0gdm9pZCAwICYmIGtleSAhPT0gLTEpIHJldHVybiBvYmpba2V5XTsKCSAgfTsKCgkgIC8vIFJldHVybiBhbGwgdGhlIGVsZW1lbnRzIHRoYXQgcGFzcyBhIHRydXRoIHRlc3QuCgkgIC8vIEFsaWFzZWQgYXMgYHNlbGVjdGAuCgkgIF8uZmlsdGVyID0gXy5zZWxlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewoJICAgIHZhciByZXN1bHRzID0gW107CgkgICAgcHJlZGljYXRlID0gY2IocHJlZGljYXRlLCBjb250ZXh0KTsKCSAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHsKCSAgICAgIGlmIChwcmVkaWNhdGUodmFsdWUsIGluZGV4LCBsaXN0KSkgcmVzdWx0cy5wdXNoKHZhbHVlKTsKCSAgICB9KTsKCSAgICByZXR1cm4gcmVzdWx0czsKCSAgfTsKCgkgIC8vIFJldHVybiBhbGwgdGhlIGVsZW1lbnRzIGZvciB3aGljaCBhIHRydXRoIHRlc3QgZmFpbHMuCgkgIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICByZXR1cm4gXy5maWx0ZXIob2JqLCBfLm5lZ2F0ZShjYihwcmVkaWNhdGUpKSwgY29udGV4dCk7CgkgIH07CgoJICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC4KCSAgLy8gQWxpYXNlZCBhcyBgYWxsYC4KCSAgXy5ldmVyeSA9IF8uYWxsID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpOwoJICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksCgkgICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoOwoJICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKCSAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7CgkgICAgICBpZiAoIXByZWRpY2F0ZShvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaikpIHJldHVybiBmYWxzZTsKCSAgICB9CgkgICAgcmV0dXJuIHRydWU7CgkgIH07CgoJICAvLyBEZXRlcm1pbmUgaWYgYXQgbGVhc3Qgb25lIGVsZW1lbnQgaW4gdGhlIG9iamVjdCBtYXRjaGVzIGEgdHJ1dGggdGVzdC4KCSAgLy8gQWxpYXNlZCBhcyBgYW55YC4KCSAgXy5zb21lID0gXy5hbnkgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewoJICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgdmFyIGtleXMgPSAhaXNBcnJheUxpa2Uob2JqKSAmJiBfLmtleXMob2JqKSwKCSAgICAgICAgbGVuZ3RoID0gKGtleXMgfHwgb2JqKS5sZW5ndGg7CgkgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewoJICAgICAgdmFyIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDsKCSAgICAgIGlmIChwcmVkaWNhdGUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopKSByZXR1cm4gdHJ1ZTsKCSAgICB9CgkgICAgcmV0dXJuIGZhbHNlOwoJICB9OwoKCSAgLy8gRGV0ZXJtaW5lIGlmIHRoZSBhcnJheSBvciBvYmplY3QgY29udGFpbnMgYSBnaXZlbiBpdGVtICh1c2luZyBgPT09YCkuCgkgIC8vIEFsaWFzZWQgYXMgYGluY2x1ZGVzYCBhbmQgYGluY2x1ZGVgLgoJICBfLmNvbnRhaW5zID0gXy5pbmNsdWRlcyA9IF8uaW5jbHVkZSA9IGZ1bmN0aW9uKG9iaiwgaXRlbSwgZnJvbUluZGV4LCBndWFyZCkgewoJICAgIGlmICghaXNBcnJheUxpa2Uob2JqKSkgb2JqID0gXy52YWx1ZXMob2JqKTsKCSAgICBpZiAodHlwZW9mIGZyb21JbmRleCAhPSAnbnVtYmVyJyB8fCBndWFyZCkgZnJvbUluZGV4ID0gMDsKCSAgICByZXR1cm4gXy5pbmRleE9mKG9iaiwgaXRlbSwgZnJvbUluZGV4KSA+PSAwOwoJICB9OwoKCSAgLy8gSW52b2tlIGEgbWV0aG9kICh3aXRoIGFyZ3VtZW50cykgb24gZXZlcnkgaXRlbSBpbiBhIGNvbGxlY3Rpb24uCgkgIF8uaW52b2tlID0gZnVuY3Rpb24ob2JqLCBtZXRob2QpIHsKCSAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKCSAgICB2YXIgaXNGdW5jID0gXy5pc0Z1bmN0aW9uKG1ldGhvZCk7CgkgICAgcmV0dXJuIF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUpIHsKCSAgICAgIHZhciBmdW5jID0gaXNGdW5jID8gbWV0aG9kIDogdmFsdWVbbWV0aG9kXTsKCSAgICAgIHJldHVybiBmdW5jID09IG51bGwgPyBmdW5jIDogZnVuYy5hcHBseSh2YWx1ZSwgYXJncyk7CgkgICAgfSk7CgkgIH07CgoJICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBtYXBgOiBmZXRjaGluZyBhIHByb3BlcnR5LgoJICBfLnBsdWNrID0gZnVuY3Rpb24ob2JqLCBrZXkpIHsKCSAgICByZXR1cm4gXy5tYXAob2JqLCBfLnByb3BlcnR5KGtleSkpOwoJICB9OwoKCSAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgZmlsdGVyYDogc2VsZWN0aW5nIG9ubHkgb2JqZWN0cwoJICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLgoJICBfLndoZXJlID0gZnVuY3Rpb24ob2JqLCBhdHRycykgewoJICAgIHJldHVybiBfLmZpbHRlcihvYmosIF8ubWF0Y2hlcihhdHRycykpOwoJICB9OwoKCSAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgZmluZGA6IGdldHRpbmcgdGhlIGZpcnN0IG9iamVjdAoJICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLgoJICBfLmZpbmRXaGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHsKCSAgICByZXR1cm4gXy5maW5kKG9iaiwgXy5tYXRjaGVyKGF0dHJzKSk7CgkgIH07CgoJICAvLyBSZXR1cm4gdGhlIG1heGltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuCgkgIF8ubWF4ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewoJICAgIHZhciByZXN1bHQgPSAtSW5maW5pdHksIGxhc3RDb21wdXRlZCA9IC1JbmZpbml0eSwKCSAgICAgICAgdmFsdWUsIGNvbXB1dGVkOwoJICAgIGlmIChpdGVyYXRlZSA9PSBudWxsICYmIG9iaiAhPSBudWxsKSB7CgkgICAgICBvYmogPSBpc0FycmF5TGlrZShvYmopID8gb2JqIDogXy52YWx1ZXMob2JqKTsKCSAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgICAgdmFsdWUgPSBvYmpbaV07CgkgICAgICAgIGlmICh2YWx1ZSA+IHJlc3VsdCkgewoJICAgICAgICAgIHJlc3VsdCA9IHZhbHVlOwoJICAgICAgICB9CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpOwoJICAgICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CgkgICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KTsKCSAgICAgICAgaWYgKGNvbXB1dGVkID4gbGFzdENvbXB1dGVkIHx8IGNvbXB1dGVkID09PSAtSW5maW5pdHkgJiYgcmVzdWx0ID09PSAtSW5maW5pdHkpIHsKCSAgICAgICAgICByZXN1bHQgPSB2YWx1ZTsKCSAgICAgICAgICBsYXN0Q29tcHV0ZWQgPSBjb21wdXRlZDsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAvLyBSZXR1cm4gdGhlIG1pbmltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuCgkgIF8ubWluID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewoJICAgIHZhciByZXN1bHQgPSBJbmZpbml0eSwgbGFzdENvbXB1dGVkID0gSW5maW5pdHksCgkgICAgICAgIHZhbHVlLCBjb21wdXRlZDsKCSAgICBpZiAoaXRlcmF0ZWUgPT0gbnVsbCAmJiBvYmogIT0gbnVsbCkgewoJICAgICAgb2JqID0gaXNBcnJheUxpa2Uob2JqKSA/IG9iaiA6IF8udmFsdWVzKG9iaik7CgkgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHZhbHVlID0gb2JqW2ldOwoJICAgICAgICBpZiAodmFsdWUgPCByZXN1bHQpIHsKCSAgICAgICAgICByZXN1bHQgPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgICAgfQoJICAgIH0gZWxzZSB7CgkgICAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewoJICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCk7CgkgICAgICAgIGlmIChjb21wdXRlZCA8IGxhc3RDb21wdXRlZCB8fCBjb21wdXRlZCA9PT0gSW5maW5pdHkgJiYgcmVzdWx0ID09PSBJbmZpbml0eSkgewoJICAgICAgICAgIHJlc3VsdCA9IHZhbHVlOwoJICAgICAgICAgIGxhc3RDb21wdXRlZCA9IGNvbXB1dGVkOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfTsKCgkgIC8vIFNodWZmbGUgYSBjb2xsZWN0aW9uLCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlCgkgIC8vIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXLigJNZYXRlc19zaHVmZmxlKS4KCSAgXy5zaHVmZmxlID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgdmFyIHNldCA9IGlzQXJyYXlMaWtlKG9iaikgPyBvYmogOiBfLnZhbHVlcyhvYmopOwoJICAgIHZhciBsZW5ndGggPSBzZXQubGVuZ3RoOwoJICAgIHZhciBzaHVmZmxlZCA9IEFycmF5KGxlbmd0aCk7CgkgICAgZm9yICh2YXIgaW5kZXggPSAwLCByYW5kOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewoJICAgICAgcmFuZCA9IF8ucmFuZG9tKDAsIGluZGV4KTsKCSAgICAgIGlmIChyYW5kICE9PSBpbmRleCkgc2h1ZmZsZWRbaW5kZXhdID0gc2h1ZmZsZWRbcmFuZF07CgkgICAgICBzaHVmZmxlZFtyYW5kXSA9IHNldFtpbmRleF07CgkgICAgfQoJICAgIHJldHVybiBzaHVmZmxlZDsKCSAgfTsKCgkgIC8vIFNhbXBsZSAqKm4qKiByYW5kb20gdmFsdWVzIGZyb20gYSBjb2xsZWN0aW9uLgoJICAvLyBJZiAqKm4qKiBpcyBub3Qgc3BlY2lmaWVkLCByZXR1cm5zIGEgc2luZ2xlIHJhbmRvbSBlbGVtZW50LgoJICAvLyBUaGUgaW50ZXJuYWwgYGd1YXJkYCBhcmd1bWVudCBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBtYXBgLgoJICBfLnNhbXBsZSA9IGZ1bmN0aW9uKG9iaiwgbiwgZ3VhcmQpIHsKCSAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSB7CgkgICAgICBpZiAoIWlzQXJyYXlMaWtlKG9iaikpIG9iaiA9IF8udmFsdWVzKG9iaik7CgkgICAgICByZXR1cm4gb2JqW18ucmFuZG9tKG9iai5sZW5ndGggLSAxKV07CgkgICAgfQoJICAgIHJldHVybiBfLnNodWZmbGUob2JqKS5zbGljZSgwLCBNYXRoLm1heCgwLCBuKSk7CgkgIH07CgoJICAvLyBTb3J0IHRoZSBvYmplY3QncyB2YWx1ZXMgYnkgYSBjcml0ZXJpb24gcHJvZHVjZWQgYnkgYW4gaXRlcmF0ZWUuCgkgIF8uc29ydEJ5ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewoJICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpOwoJICAgIHJldHVybiBfLnBsdWNrKF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CgkgICAgICByZXR1cm4gewoJICAgICAgICB2YWx1ZTogdmFsdWUsCgkgICAgICAgIGluZGV4OiBpbmRleCwKCSAgICAgICAgY3JpdGVyaWE6IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCkKCSAgICAgIH07CgkgICAgfSkuc29ydChmdW5jdGlvbihsZWZ0LCByaWdodCkgewoJICAgICAgdmFyIGEgPSBsZWZ0LmNyaXRlcmlhOwoJICAgICAgdmFyIGIgPSByaWdodC5jcml0ZXJpYTsKCSAgICAgIGlmIChhICE9PSBiKSB7CgkgICAgICAgIGlmIChhID4gYiB8fCBhID09PSB2b2lkIDApIHJldHVybiAxOwoJICAgICAgICBpZiAoYSA8IGIgfHwgYiA9PT0gdm9pZCAwKSByZXR1cm4gLTE7CgkgICAgICB9CgkgICAgICByZXR1cm4gbGVmdC5pbmRleCAtIHJpZ2h0LmluZGV4OwoJICAgIH0pLCAndmFsdWUnKTsKCSAgfTsKCgkgIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIHVzZWQgZm9yIGFnZ3JlZ2F0ZSAiZ3JvdXAgYnkiIG9wZXJhdGlvbnMuCgkgIHZhciBncm91cCA9IGZ1bmN0aW9uKGJlaGF2aW9yKSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICAgIHZhciByZXN1bHQgPSB7fTsKCSAgICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpOwoJICAgICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7CgkgICAgICAgIHZhciBrZXkgPSBpdGVyYXRlZSh2YWx1ZSwgaW5kZXgsIG9iaik7CgkgICAgICAgIGJlaGF2aW9yKHJlc3VsdCwgdmFsdWUsIGtleSk7CgkgICAgICB9KTsKCSAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgfTsKCgkgIC8vIEdyb3VwcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLiBQYXNzIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGUKCSAgLy8gdG8gZ3JvdXAgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBjcml0ZXJpb24uCgkgIF8uZ3JvdXBCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkgewoJICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldLnB1c2godmFsdWUpOyBlbHNlIHJlc3VsdFtrZXldID0gW3ZhbHVlXTsKCSAgfSk7CgoJICAvLyBJbmRleGVzIHRoZSBvYmplY3QncyB2YWx1ZXMgYnkgYSBjcml0ZXJpb24sIHNpbWlsYXIgdG8gYGdyb3VwQnlgLCBidXQgZm9yCgkgIC8vIHdoZW4geW91IGtub3cgdGhhdCB5b3VyIGluZGV4IHZhbHVlcyB3aWxsIGJlIHVuaXF1ZS4KCSAgXy5pbmRleEJ5ID0gZ3JvdXAoZnVuY3Rpb24ocmVzdWx0LCB2YWx1ZSwga2V5KSB7CgkgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTsKCSAgfSk7CgoJICAvLyBDb3VudHMgaW5zdGFuY2VzIG9mIGFuIG9iamVjdCB0aGF0IGdyb3VwIGJ5IGEgY2VydGFpbiBjcml0ZXJpb24uIFBhc3MKCSAgLy8gZWl0aGVyIGEgc3RyaW5nIGF0dHJpYnV0ZSB0byBjb3VudCBieSwgb3IgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlCgkgIC8vIGNyaXRlcmlvbi4KCSAgXy5jb3VudEJ5ID0gZ3JvdXAoZnVuY3Rpb24ocmVzdWx0LCB2YWx1ZSwga2V5KSB7CgkgICAgaWYgKF8uaGFzKHJlc3VsdCwga2V5KSkgcmVzdWx0W2tleV0rKzsgZWxzZSByZXN1bHRba2V5XSA9IDE7CgkgIH0pOwoKCSAgLy8gU2FmZWx5IGNyZWF0ZSBhIHJlYWwsIGxpdmUgYXJyYXkgZnJvbSBhbnl0aGluZyBpdGVyYWJsZS4KCSAgXy50b0FycmF5ID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgaWYgKCFvYmopIHJldHVybiBbXTsKCSAgICBpZiAoXy5pc0FycmF5KG9iaikpIHJldHVybiBzbGljZS5jYWxsKG9iaik7CgkgICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHJldHVybiBfLm1hcChvYmosIF8uaWRlbnRpdHkpOwoJICAgIHJldHVybiBfLnZhbHVlcyhvYmopOwoJICB9OwoKCSAgLy8gUmV0dXJuIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYW4gb2JqZWN0LgoJICBfLnNpemUgPSBmdW5jdGlvbihvYmopIHsKCSAgICBpZiAob2JqID09IG51bGwpIHJldHVybiAwOwoJICAgIHJldHVybiBpc0FycmF5TGlrZShvYmopID8gb2JqLmxlbmd0aCA6IF8ua2V5cyhvYmopLmxlbmd0aDsKCSAgfTsKCgkgIC8vIFNwbGl0IGEgY29sbGVjdGlvbiBpbnRvIHR3byBhcnJheXM6IG9uZSB3aG9zZSBlbGVtZW50cyBhbGwgc2F0aXNmeSB0aGUgZ2l2ZQ==", "base64"));
  res.write(new Buffer("bgoJICAvLyBwcmVkaWNhdGUsIGFuZCBvbmUgd2hvc2UgZWxlbWVudHMgYWxsIGRvIG5vdCBzYXRpc2Z5IHRoZSBwcmVkaWNhdGUuCgkgIF8ucGFydGl0aW9uID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpOwoJICAgIHZhciBwYXNzID0gW10sIGZhaWwgPSBbXTsKCSAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmopIHsKCSAgICAgIChwcmVkaWNhdGUodmFsdWUsIGtleSwgb2JqKSA/IHBhc3MgOiBmYWlsKS5wdXNoKHZhbHVlKTsKCSAgICB9KTsKCSAgICByZXR1cm4gW3Bhc3MsIGZhaWxdOwoJICB9OwoKCSAgLy8gQXJyYXkgRnVuY3Rpb25zCgkgIC8vIC0tLS0tLS0tLS0tLS0tLQoKCSAgLy8gR2V0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBmaXJzdCBOCgkgIC8vIHZhbHVlcyBpbiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYGhlYWRgIGFuZCBgdGFrZWAuIFRoZSAqKmd1YXJkKiogY2hlY2sKCSAgLy8gYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgXy5tYXBgLgoJICBfLmZpcnN0ID0gXy5oZWFkID0gXy50YWtlID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CgkgICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiB2b2lkIDA7CgkgICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkgcmV0dXJuIGFycmF5WzBdOwoJICAgIHJldHVybiBfLmluaXRpYWwoYXJyYXksIGFycmF5Lmxlbmd0aCAtIG4pOwoJICB9OwoKCSAgLy8gUmV0dXJucyBldmVyeXRoaW5nIGJ1dCB0aGUgbGFzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEVzcGVjaWFsbHkgdXNlZnVsIG9uCgkgIC8vIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIGFsbCB0aGUgdmFsdWVzIGluCgkgIC8vIHRoZSBhcnJheSwgZXhjbHVkaW5nIHRoZSBsYXN0IE4uCgkgIF8uaW5pdGlhbCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkgewoJICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBNYXRoLm1heCgwLCBhcnJheS5sZW5ndGggLSAobiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pKSk7CgkgIH07CgoJICAvLyBHZXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheS4gUGFzc2luZyAqKm4qKiB3aWxsIHJldHVybiB0aGUgbGFzdCBOCgkgIC8vIHZhbHVlcyBpbiB0aGUgYXJyYXkuCgkgIF8ubGFzdCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkgewoJICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwOwoJICAgIGlmIChuID09IG51bGwgfHwgZ3VhcmQpIHJldHVybiBhcnJheVthcnJheS5sZW5ndGggLSAxXTsKCSAgICByZXR1cm4gXy5yZXN0KGFycmF5LCBNYXRoLm1heCgwLCBhcnJheS5sZW5ndGggLSBuKSk7CgkgIH07CgoJICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYHRhaWxgIGFuZCBgZHJvcGAuCgkgIC8vIEVzcGVjaWFsbHkgdXNlZnVsIG9uIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nIGFuICoqbioqIHdpbGwgcmV0dXJuCgkgIC8vIHRoZSByZXN0IE4gdmFsdWVzIGluIHRoZSBhcnJheS4KCSAgXy5yZXN0ID0gXy50YWlsID0gXy5kcm9wID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CgkgICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIG4gPT0gbnVsbCB8fCBndWFyZCA/IDEgOiBuKTsKCSAgfTsKCgkgIC8vIFRyaW0gb3V0IGFsbCBmYWxzeSB2YWx1ZXMgZnJvbSBhbiBhcnJheS4KCSAgXy5jb21wYWN0ID0gZnVuY3Rpb24oYXJyYXkpIHsKCSAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIF8uaWRlbnRpdHkpOwoJICB9OwoKCSAgLy8gSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gb2YgYSByZWN1cnNpdmUgYGZsYXR0ZW5gIGZ1bmN0aW9uLgoJICB2YXIgZmxhdHRlbiA9IGZ1bmN0aW9uKGlucHV0LCBzaGFsbG93LCBzdHJpY3QsIHN0YXJ0SW5kZXgpIHsKCSAgICB2YXIgb3V0cHV0ID0gW10sIGlkeCA9IDA7CgkgICAgZm9yICh2YXIgaSA9IHN0YXJ0SW5kZXggfHwgMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGlucHV0KTsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgdmFsdWUgPSBpbnB1dFtpXTsKCSAgICAgIGlmIChpc0FycmF5TGlrZSh2YWx1ZSkgJiYgKF8uaXNBcnJheSh2YWx1ZSkgfHwgXy5pc0FyZ3VtZW50cyh2YWx1ZSkpKSB7CgkgICAgICAgIC8vZmxhdHRlbiBjdXJyZW50IGxldmVsIG9mIGFycmF5IG9yIGFyZ3VtZW50cyBvYmplY3QKCSAgICAgICAgaWYgKCFzaGFsbG93KSB2YWx1ZSA9IGZsYXR0ZW4odmFsdWUsIHNoYWxsb3csIHN0cmljdCk7CgkgICAgICAgIHZhciBqID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOwoJICAgICAgICBvdXRwdXQubGVuZ3RoICs9IGxlbjsKCSAgICAgICAgd2hpbGUgKGogPCBsZW4pIHsKCSAgICAgICAgICBvdXRwdXRbaWR4KytdID0gdmFsdWVbaisrXTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIGlmICghc3RyaWN0KSB7CgkgICAgICAgIG91dHB1dFtpZHgrK10gPSB2YWx1ZTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIG91dHB1dDsKCSAgfTsKCgkgIC8vIEZsYXR0ZW4gb3V0IGFuIGFycmF5LCBlaXRoZXIgcmVjdXJzaXZlbHkgKGJ5IGRlZmF1bHQpLCBvciBqdXN0IG9uZSBsZXZlbC4KCSAgXy5mbGF0dGVuID0gZnVuY3Rpb24oYXJyYXksIHNoYWxsb3cpIHsKCSAgICByZXR1cm4gZmxhdHRlbihhcnJheSwgc2hhbGxvdywgZmFsc2UpOwoJICB9OwoKCSAgLy8gUmV0dXJuIGEgdmVyc2lvbiBvZiB0aGUgYXJyYXkgdGhhdCBkb2VzIG5vdCBjb250YWluIHRoZSBzcGVjaWZpZWQgdmFsdWUocykuCgkgIF8ud2l0aG91dCA9IGZ1bmN0aW9uKGFycmF5KSB7CgkgICAgcmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTsKCSAgfTsKCgkgIC8vIFByb2R1Y2UgYSBkdXBsaWNhdGUtZnJlZSB2ZXJzaW9uIG9mIHRoZSBhcnJheS4gSWYgdGhlIGFycmF5IGhhcyBhbHJlYWR5CgkgIC8vIGJlZW4gc29ydGVkLCB5b3UgaGF2ZSB0aGUgb3B0aW9uIG9mIHVzaW5nIGEgZmFzdGVyIGFsZ29yaXRobS4KCSAgLy8gQWxpYXNlZCBhcyBgdW5pcXVlYC4KCSAgXy51bmlxID0gXy51bmlxdWUgPSBmdW5jdGlvbihhcnJheSwgaXNTb3J0ZWQsIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgaWYgKCFfLmlzQm9vbGVhbihpc1NvcnRlZCkpIHsKCSAgICAgIGNvbnRleHQgPSBpdGVyYXRlZTsKCSAgICAgIGl0ZXJhdGVlID0gaXNTb3J0ZWQ7CgkgICAgICBpc1NvcnRlZCA9IGZhbHNlOwoJICAgIH0KCSAgICBpZiAoaXRlcmF0ZWUgIT0gbnVsbCkgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CgkgICAgdmFyIHJlc3VsdCA9IFtdOwoJICAgIHZhciBzZWVuID0gW107CgkgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGdldExlbmd0aChhcnJheSk7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaV0sCgkgICAgICAgICAgY29tcHV0ZWQgPSBpdGVyYXRlZSA/IGl0ZXJhdGVlKHZhbHVlLCBpLCBhcnJheSkgOiB2YWx1ZTsKCSAgICAgIGlmIChpc1NvcnRlZCkgewoJICAgICAgICBpZiAoIWkgfHwgc2VlbiAhPT0gY29tcHV0ZWQpIHJlc3VsdC5wdXNoKHZhbHVlKTsKCSAgICAgICAgc2VlbiA9IGNvbXB1dGVkOwoJICAgICAgfSBlbHNlIGlmIChpdGVyYXRlZSkgewoJICAgICAgICBpZiAoIV8uY29udGFpbnMoc2VlbiwgY29tcHV0ZWQpKSB7CgkgICAgICAgICAgc2Vlbi5wdXNoKGNvbXB1dGVkKTsKCSAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7CgkgICAgICAgIH0KCSAgICAgIH0gZWxzZSBpZiAoIV8uY29udGFpbnMocmVzdWx0LCB2YWx1ZSkpIHsKCSAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpOwoJICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSB1bmlvbjogZWFjaCBkaXN0aW5jdCBlbGVtZW50IGZyb20gYWxsIG9mCgkgIC8vIHRoZSBwYXNzZWQtaW4gYXJyYXlzLgoJICBfLnVuaW9uID0gZnVuY3Rpb24oKSB7CgkgICAgcmV0dXJuIF8udW5pcShmbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgdHJ1ZSkpOwoJICB9OwoKCSAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIGV2ZXJ5IGl0ZW0gc2hhcmVkIGJldHdlZW4gYWxsIHRoZQoJICAvLyBwYXNzZWQtaW4gYXJyYXlzLgoJICBfLmludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKGFycmF5KSB7CgkgICAgdmFyIHJlc3VsdCA9IFtdOwoJICAgIHZhciBhcmdzTGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsKCSAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgaXRlbSA9IGFycmF5W2ldOwoJICAgICAgaWYgKF8uY29udGFpbnMocmVzdWx0LCBpdGVtKSkgY29udGludWU7CgkgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGFyZ3NMZW5ndGg7IGorKykgewoJICAgICAgICBpZiAoIV8uY29udGFpbnMoYXJndW1lbnRzW2pdLCBpdGVtKSkgYnJlYWs7CgkgICAgICB9CgkgICAgICBpZiAoaiA9PT0gYXJnc0xlbmd0aCkgcmVzdWx0LnB1c2goaXRlbSk7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAvLyBUYWtlIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gb25lIGFycmF5IGFuZCBhIG51bWJlciBvZiBvdGhlciBhcnJheXMuCgkgIC8vIE9ubHkgdGhlIGVsZW1lbnRzIHByZXNlbnQgaW4ganVzdCB0aGUgZmlyc3QgYXJyYXkgd2lsbCByZW1haW4uCgkgIF8uZGlmZmVyZW5jZSA9IGZ1bmN0aW9uKGFycmF5KSB7CgkgICAgdmFyIHJlc3QgPSBmbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgdHJ1ZSwgMSk7CgkgICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBmdW5jdGlvbih2YWx1ZSl7CgkgICAgICByZXR1cm4gIV8uY29udGFpbnMocmVzdCwgdmFsdWUpOwoJICAgIH0pOwoJICB9OwoKCSAgLy8gWmlwIHRvZ2V0aGVyIG11bHRpcGxlIGxpc3RzIGludG8gYSBzaW5nbGUgYXJyYXkgLS0gZWxlbWVudHMgdGhhdCBzaGFyZQoJICAvLyBhbiBpbmRleCBnbyB0b2dldGhlci4KCSAgXy56aXAgPSBmdW5jdGlvbigpIHsKCSAgICByZXR1cm4gXy51bnppcChhcmd1bWVudHMpOwoJICB9OwoKCSAgLy8gQ29tcGxlbWVudCBvZiBfLnppcC4gVW56aXAgYWNjZXB0cyBhbiBhcnJheSBvZiBhcnJheXMgYW5kIGdyb3VwcwoJICAvLyBlYWNoIGFycmF5J3MgZWxlbWVudHMgb24gc2hhcmVkIGluZGljZXMKCSAgXy51bnppcCA9IGZ1bmN0aW9uKGFycmF5KSB7CgkgICAgdmFyIGxlbmd0aCA9IGFycmF5ICYmIF8ubWF4KGFycmF5LCBnZXRMZW5ndGgpLmxlbmd0aCB8fCAwOwoJICAgIHZhciByZXN1bHQgPSBBcnJheShsZW5ndGgpOwoKCSAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CgkgICAgICByZXN1bHRbaW5kZXhdID0gXy5wbHVjayhhcnJheSwgaW5kZXgpOwoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgLy8gQ29udmVydHMgbGlzdHMgaW50byBvYmplY3RzLiBQYXNzIGVpdGhlciBhIHNpbmdsZSBhcnJheSBvZiBgW2tleSwgdmFsdWVdYAoJICAvLyBwYWlycywgb3IgdHdvIHBhcmFsbGVsIGFycmF5cyBvZiB0aGUgc2FtZSBsZW5ndGggLS0gb25lIG9mIGtleXMsIGFuZCBvbmUgb2YKCSAgLy8gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWVzLgoJICBfLm9iamVjdCA9IGZ1bmN0aW9uKGxpc3QsIHZhbHVlcykgewoJICAgIHZhciByZXN1bHQgPSB7fTsKCSAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGxpc3QpOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIGlmICh2YWx1ZXMpIHsKCSAgICAgICAgcmVzdWx0W2xpc3RbaV1dID0gdmFsdWVzW2ldOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmVzdWx0W2xpc3RbaV1bMF1dID0gbGlzdFtpXVsxXTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfTsKCgkgIC8vIEdlbmVyYXRvciBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIGZpbmRJbmRleCBhbmQgZmluZExhc3RJbmRleCBmdW5jdGlvbnMKCSAgZnVuY3Rpb24gY3JlYXRlUHJlZGljYXRlSW5kZXhGaW5kZXIoZGlyKSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKGFycmF5LCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgICB2YXIgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsKCSAgICAgIHZhciBpbmRleCA9IGRpciA+IDAgPyAwIDogbGVuZ3RoIC0gMTsKCSAgICAgIGZvciAoOyBpbmRleCA+PSAwICYmIGluZGV4IDwgbGVuZ3RoOyBpbmRleCArPSBkaXIpIHsKCSAgICAgICAgaWYgKHByZWRpY2F0ZShhcnJheVtpbmRleF0sIGluZGV4LCBhcnJheSkpIHJldHVybiBpbmRleDsKCSAgICAgIH0KCSAgICAgIHJldHVybiAtMTsKCSAgICB9OwoJICB9CgoJICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBpbmRleCBvbiBhbiBhcnJheS1saWtlIHRoYXQgcGFzc2VzIGEgcHJlZGljYXRlIHRlc3QKCSAgXy5maW5kSW5kZXggPSBjcmVhdGVQcmVkaWNhdGVJbmRleEZpbmRlcigxKTsKCSAgXy5maW5kTGFzdEluZGV4ID0gY3JlYXRlUHJlZGljYXRlSW5kZXhGaW5kZXIoLTEpOwoKCSAgLy8gVXNlIGEgY29tcGFyYXRvciBmdW5jdGlvbiB0byBmaWd1cmUgb3V0IHRoZSBzbWFsbGVzdCBpbmRleCBhdCB3aGljaAoJICAvLyBhbiBvYmplY3Qgc2hvdWxkIGJlIGluc2VydGVkIHNvIGFzIHRvIG1haW50YWluIG9yZGVyLiBVc2VzIGJpbmFyeSBzZWFyY2guCgkgIF8uc29ydGVkSW5kZXggPSBmdW5jdGlvbihhcnJheSwgb2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewoJICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQsIDEpOwoJICAgIHZhciB2YWx1ZSA9IGl0ZXJhdGVlKG9iaik7CgkgICAgdmFyIGxvdyA9IDAsIGhpZ2ggPSBnZXRMZW5ndGgoYXJyYXkpOwoJICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7CgkgICAgICB2YXIgbWlkID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTsKCSAgICAgIGlmIChpdGVyYXRlZShhcnJheVttaWRdKSA8IHZhbHVlKSBsb3cgPSBtaWQgKyAxOyBlbHNlIGhpZ2ggPSBtaWQ7CgkgICAgfQoJICAgIHJldHVybiBsb3c7CgkgIH07CgoJICAvLyBHZW5lcmF0b3IgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBpbmRleE9mIGFuZCBsYXN0SW5kZXhPZiBmdW5jdGlvbnMKCSAgZnVuY3Rpb24gY3JlYXRlSW5kZXhGaW5kZXIoZGlyLCBwcmVkaWNhdGVGaW5kLCBzb3J0ZWRJbmRleCkgewoJICAgIHJldHVybiBmdW5jdGlvbihhcnJheSwgaXRlbSwgaWR4KSB7CgkgICAgICB2YXIgaSA9IDAsIGxlbmd0aCA9IGdldExlbmd0aChhcnJheSk7CgkgICAgICBpZiAodHlwZW9mIGlkeCA9PSAnbnVtYmVyJykgewoJICAgICAgICBpZiAoZGlyID4gMCkgewoJICAgICAgICAgICAgaSA9IGlkeCA+PSAwID8gaWR4IDogTWF0aC5tYXgoaWR4ICsgbGVuZ3RoLCBpKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGxlbmd0aCA9IGlkeCA+PSAwID8gTWF0aC5taW4oaWR4ICsgMSwgbGVuZ3RoKSA6IGlkeCArIGxlbmd0aCArIDE7CgkgICAgICAgIH0KCSAgICAgIH0gZWxzZSBpZiAoc29ydGVkSW5kZXggJiYgaWR4ICYmIGxlbmd0aCkgewoJICAgICAgICBpZHggPSBzb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7CgkgICAgICAgIHJldHVybiBhcnJheVtpZHhdID09PSBpdGVtID8gaWR4IDogLTE7CgkgICAgICB9CgkgICAgICBpZiAoaXRlbSAhPT0gaXRlbSkgewoJICAgICAgICBpZHggPSBwcmVkaWNhdGVGaW5kKHNsaWNlLmNhbGwoYXJyYXksIGksIGxlbmd0aCksIF8uaXNOYU4pOwoJICAgICAgICByZXR1cm4gaWR4ID49IDAgPyBpZHggKyBpIDogLTE7CgkgICAgICB9CgkgICAgICBmb3IgKGlkeCA9IGRpciA+IDAgPyBpIDogbGVuZ3RoIC0gMTsgaWR4ID49IDAgJiYgaWR4IDwgbGVuZ3RoOyBpZHggKz0gZGlyKSB7CgkgICAgICAgIGlmIChhcnJheVtpZHhdID09PSBpdGVtKSByZXR1cm4gaWR4OwoJICAgICAgfQoJICAgICAgcmV0dXJuIC0xOwoJICAgIH07CgkgIH0KCgkgIC8vIFJldHVybiB0aGUgcG9zaXRpb24gb2YgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gaXRlbSBpbiBhbiBhcnJheSwKCSAgLy8gb3IgLTEgaWYgdGhlIGl0ZW0gaXMgbm90IGluY2x1ZGVkIGluIHRoZSBhcnJheS4KCSAgLy8gSWYgdGhlIGFycmF5IGlzIGxhcmdlIGFuZCBhbHJlYWR5IGluIHNvcnQgb3JkZXIsIHBhc3MgYHRydWVgCgkgIC8vIGZvciAqKmlzU29ydGVkKiogdG8gdXNlIGJpbmFyeSBzZWFyY2guCgkgIF8uaW5kZXhPZiA9IGNyZWF0ZUluZGV4RmluZGVyKDEsIF8uZmluZEluZGV4LCBfLnNvcnRlZEluZGV4KTsKCSAgXy5sYXN0SW5kZXhPZiA9IGNyZWF0ZUluZGV4RmluZGVyKC0xLCBfLmZpbmRMYXN0SW5kZXgpOwoKCSAgLy8gR2VuZXJhdGUgYW4gaW50ZWdlciBBcnJheSBjb250YWluaW5nIGFuIGFyaXRobWV0aWMgcHJvZ3Jlc3Npb24uIEEgcG9ydCBvZgoJICAvLyB0aGUgbmF0aXZlIFB5dGhvbiBgcmFuZ2UoKWAgZnVuY3Rpb24uIFNlZQoJICAvLyBbdGhlIFB5dGhvbiBkb2N1bWVudGF0aW9uXShodHRwOi8vZG9jcy5weXRob24ub3JnL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjcmFuZ2UpLgoJICBfLnJhbmdlID0gZnVuY3Rpb24oc3RhcnQsIHN0b3AsIHN0ZXApIHsKCSAgICBpZiAoc3RvcCA9PSBudWxsKSB7CgkgICAgICBzdG9wID0gc3RhcnQgfHwgMDsKCSAgICAgIHN0YXJ0ID0gMDsKCSAgICB9CgkgICAgc3RlcCA9IHN0ZXAgfHwgMTsKCgkgICAgdmFyIGxlbmd0aCA9IE1hdGgubWF4KE1hdGguY2VpbCgoc3RvcCAtIHN0YXJ0KSAvIHN0ZXApLCAwKTsKCSAgICB2YXIgcmFuZ2UgPSBBcnJheShsZW5ndGgpOwoKCSAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrLCBzdGFydCArPSBzdGVwKSB7CgkgICAgICByYW5nZVtpZHhdID0gc3RhcnQ7CgkgICAgfQoKCSAgICByZXR1cm4gcmFuZ2U7CgkgIH07CgoJICAvLyBGdW5jdGlvbiAoYWhlbSkgRnVuY3Rpb25zCgkgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLQoKCSAgLy8gRGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGV4ZWN1dGUgYSBmdW5jdGlvbiBhcyBhIGNvbnN0cnVjdG9yCgkgIC8vIG9yIGEgbm9ybWFsIGZ1bmN0aW9uIHdpdGggdGhlIHByb3ZpZGVkIGFyZ3VtZW50cwoJICB2YXIgZXhlY3V0ZUJvdW5kID0gZnVuY3Rpb24oc291cmNlRnVuYywgYm91bmRGdW5jLCBjb250ZXh0LCBjYWxsaW5nQ29udGV4dCwgYXJncykgewoJICAgIGlmICghKGNhbGxpbmdDb250ZXh0IGluc3RhbmNlb2YgYm91bmRGdW5jKSkgcmV0dXJuIHNvdXJjZUZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CgkgICAgdmFyIHNlbGYgPSBiYXNlQ3JlYXRlKHNvdXJjZUZ1bmMucHJvdG90eXBlKTsKCSAgICB2YXIgcmVzdWx0ID0gc291cmNlRnVuYy5hcHBseShzZWxmLCBhcmdzKTsKCSAgICBpZiAoXy5pc09iamVjdChyZXN1bHQpKSByZXR1cm4gcmVzdWx0OwoJICAgIHJldHVybiBzZWxmOwoJICB9OwoKCSAgLy8gQ3JlYXRlIGEgZnVuY3Rpb24gYm91bmQgdG8gYSBnaXZlbiBvYmplY3QgKGFzc2lnbmluZyBgdGhpc2AsIGFuZCBhcmd1bWVudHMsCgkgIC8vIG9wdGlvbmFsbHkpLiBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgRnVuY3Rpb24uYmluZGAgaWYKCSAgLy8gYXZhaWxhYmxlLgoJICBfLmJpbmQgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0KSB7CgkgICAgaWYgKG5hdGl2ZUJpbmQgJiYgZnVuYy5iaW5kID09PSBuYXRpdmVCaW5kKSByZXR1cm4gbmF0aXZlQmluZC5hcHBseShmdW5jLCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpOwoJICAgIGlmICghXy5pc0Z1bmN0aW9uKGZ1bmMpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdCaW5kIG11c3QgYmUgY2FsbGVkIG9uIGEgZnVuY3Rpb24nKTsKCSAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKCSAgICB2YXIgYm91bmQgPSBmdW5jdGlvbigpIHsKCSAgICAgIHJldHVybiBleGVjdXRlQm91bmQoZnVuYywgYm91bmQsIGNvbnRleHQsIHRoaXMsIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpOwoJICAgIH07CgkgICAgcmV0dXJuIGJvdW5kOwoJICB9OwoKCSAgLy8gUGFydGlhbGx5IGFwcGx5IGEgZnVuY3Rpb24gYnkgY3JlYXRpbmcgYSB2ZXJzaW9uIHRoYXQgaGFzIGhhZCBzb21lIG9mIGl0cwoJICAvLyBhcmd1bWVudHMgcHJlLWZpbGxlZCwgd2l0aG91dCBjaGFuZ2luZyBpdHMgZHluYW1pYyBgdGhpc2AgY29udGV4dC4gXyBhY3RzCgkgIC8vIGFzIGEgcGxhY2Vob2xkZXIsIGFsbG93aW5nIGFueSBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMgdG8gYmUgcHJlLWZpbGxlZC4KCSAgXy5wYXJ0aWFsID0gZnVuY3Rpb24oZnVuYykgewoJICAgIHZhciBib3VuZEFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CgkgICAgdmFyIGJvdW5kID0gZnVuY3Rpb24oKSB7CgkgICAgICB2YXIgcG9zaXRpb24gPSAwLCBsZW5ndGggPSBib3VuZEFyZ3MubGVuZ3RoOwoJICAgICAgdmFyIGFyZ3MgPSBBcnJheShsZW5ndGgpOwoJICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICBhcmdzW2ldID0gYm91bmRBcmdzW2ldID09PSBfID8gYXJndW1lbnRzW3Bvc2l0aW9uKytdIDogYm91bmRBcmdzW2ldOwoJICAgICAgfQoJICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgYXJndW1lbnRzLmxlbmd0aCkgYXJncy5wdXNoKGFyZ3VtZW50c1twb3NpdGlvbisrXSk7CgkgICAgICByZXR1cm4gZXhlY3V0ZUJvdW5kKGZ1bmMsIGJvdW5kLCB0aGlzLCB0aGlzLCBhcmdzKTsKCSAgICB9OwoJICAgIHJldHVybiBib3VuZDsKCSAgfTsKCgkgIC8vIEJpbmQgYSBudW1iZXIgb2YgYW4gb2JqZWN0J3MgbWV0aG9kcyB0byB0aGF0IG9iamVjdC4gUmVtYWluaW5nIGFyZ3VtZW50cwoJICAvLyBhcmUgdGhlIG1ldGhvZCBuYW1lcyB0byBiZSBib3VuZC4gVXNlZnVsIGZvciBlbnN1cmluZyB0aGF0IGFsbCBjYWxsYmFja3MKCSAgLy8gZGVmaW5lZCBvbiBhbiBvYmplY3QgYmVsb25nIHRvIGl0LgoJICBfLmJpbmRBbGwgPSBmdW5jdGlvbihvYmopIHsKCSAgICB2YXIgaSwgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCwga2V5OwoJICAgIGlmIChsZW5ndGggPD0gMSkgdGhyb3cgbmV3IEVycm9yKCdiaW5kQWxsIG11c3QgYmUgcGFzc2VkIGZ1bmN0aW9uIG5hbWVzJyk7CgkgICAgZm9yIChpID0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICBrZXkgPSBhcmd1bWVudHNbaV07CgkgICAgICBvYmpba2V5XSA9IF8uYmluZChvYmpba2V5XSwgb2JqKTsKCSAgICB9CgkgICAgcmV0dXJuIG9iajsKCSAgfTsKCgkgIC8vIE1lbW9pemUgYW4gZXhwZW5zaXZlIGZ1bmN0aW9uIGJ5IHN0b3JpbmcgaXRzIHJlc3VsdHMuCgkgIF8ubWVtb2l6ZSA9IGZ1bmN0aW9uKGZ1bmMsIGhhc2hlcikgewoJICAgIHZhciBtZW1vaXplID0gZnVuY3Rpb24oa2V5KSB7CgkgICAgICB2YXIgY2FjaGUgPSBtZW1vaXplLmNhY2hlOwoJICAgICAgdmFyIGFkZHJlc3MgPSAnJyArIChoYXNoZXIgPyBoYXNoZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSA6IGtleSk7CgkgICAgICBpZiAoIV8uaGFzKGNhY2hlLCBhZGRyZXNzKSkgY2FjaGVbYWRkcmVzc10gPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkgICAgICByZXR1cm4gY2FjaGVbYWRkcmVzc107CgkgICAgfTsKCSAgICBtZW1vaXplLmNhY2hlID0ge307CgkgICAgcmV0dXJuIG1lbW9pemU7CgkgIH07CgoJICAvLyBEZWxheXMgYSBmdW5jdGlvbiBmb3IgdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMsIGFuZCB0aGVuIGNhbGxzCgkgIC8vIGl0IHdpdGggdGhlIGFyZ3VtZW50cyBzdXBwbGllZC4KCSAgXy5kZWxheSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHsKCSAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKCSAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpewoJICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7CgkgICAgfSwgd2FpdCk7CgkgIH07CgoJICAvLyBEZWZlcnMgYSBmdW5jdGlvbiwgc2NoZWR1bGluZyBpdCB0byBydW4gYWZ0ZXIgdGhlIGN1cnJlbnQgY2FsbCBzdGFjayBoYXMKCSAgLy8gY2xlYXJlZC4KCSAgXy5kZWZlciA9IF8ucGFydGlhbChfLmRlbGF5LCBfLCAxKTsKCgkgIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgd2hlbiBpbnZva2VkLCB3aWxsIG9ubHkgYmUgdHJpZ2dlcmVkIGF0IG1vc3Qgb25jZQoJICAvLyBkdXJpbmcgYSBnaXZlbiB3aW5kb3cgb2YgdGltZS4gTm9ybWFsbHksIHRoZSB0aHJvdHRsZWQgZnVuY3Rpb24gd2lsbCBydW4KCSAgLy8gYXMgbXVjaCBhcyBpdCBjYW4sIHdpdGhvdXQgZXZlciBnb2luZyBtb3JlIHRoYW4gb25jZSBwZXIgYHdhaXRgIGR1cmF0aW9uOwoJICAvLyBidXQgaWYgeW91J2QgbGlrZSB0byBkaXNhYmxlIHRoZSBleGVjdXRpb24gb24gdGhlIGxlYWRpbmcgZWRnZSwgcGFzcwoJICAvLyBge2xlYWRpbmc6IGZhbHNlfWAuIFRvIGRpc2FibGUgZXhlY3V0aW9uIG9uIHRoZSB0cmFpbGluZyBlZGdlLCBkaXR0by4KCSAgXy50aHJvdHRsZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIG9wdGlvbnMpIHsKCSAgICB2YXIgY29udGV4dCwgYXJncywgcmVzdWx0OwoJICAgIHZhciB0aW1lb3V0ID0gbnVsbDsKCSAgICB2YXIgcHJldmlvdXMgPSAwOwoJICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IHt9OwoJICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkgewoJICAgICAgcHJldmlvdXMgPSBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlID8gMCA6IF8ubm93KCk7CgkgICAgICB0aW1lb3V0ID0gbnVsbDsKCSAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CgkgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIHZhciBub3cgPSBfLm5vdygpOwoJICAgICAgaWYgKCFwcmV2aW91cyAmJiBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlKSBwcmV2aW91cyA9IG5vdzsKCSAgICAgIHZhciByZW1haW5pbmcgPSB3YWl0IC0gKG5vdyAtIHByZXZpb3VzKTsKCSAgICAgIGNvbnRleHQgPSB0aGlzOwoJICAgICAgYXJncyA9IGFyZ3VtZW50czsKCSAgICAgIGlmIChyZW1haW5pbmcgPD0gMCB8fCByZW1haW5pbmcgPiB3YWl0KSB7CgkgICAgICAgIGlmICh0aW1lb3V0KSB7CgkgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwoJICAgICAgICAgIHRpbWVvdXQgPSBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHByZXZpb3VzID0gbm93OwoJICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpOwoJICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDsKCSAgICAgIH0gZWxzZSBpZiAoIXRpbWVvdXQgJiYgb3B0aW9ucy50cmFpbGluZyAhPT0gZmFsc2UpIHsKCSAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHJlbWFpbmluZyk7CgkgICAgICB9CgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgIH07CgoJICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90CgkgIC8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3IKCSAgLy8gTiBtaWxsaXNlY29uZHMuIElmIGBpbW1lZGlhdGVgIGlzIHBhc3NlZCwgdHJpZ2dlciB0aGUgZnVuY3Rpb24gb24gdGhlCgkgIC8vIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuCgkgIF8uZGVib3VuY2UgPSBmdW5jdGlvbihmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHsKCSAgICB2YXIgdGltZW91dCwgYXJncywgY29udGV4dCwgdGltZXN0YW1wLCByZXN1bHQ7CgoJICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkgewoJICAgICAgdmFyIGxhc3QgPSBfLm5vdygpIC0gdGltZXN0YW1wOwoKCSAgICAgIGlmIChsYXN0IDwgd2FpdCAmJiBsYXN0ID49IDApIHsKCSAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQgLSBsYXN0KTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIHRpbWVvdXQgPSBudWxsOwoJICAgICAgICBpZiAoIWltbWVkaWF0ZSkgewoJICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CgkgICAgICAgICAgaWYgKCF0aW1lb3V0KSBjb250ZXh0ID0gYXJncyA9IG51bGw7CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICB9OwoKCSAgICByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgICBjb250ZXh0ID0gdGhpczsKCSAgICAgIGFyZ3MgPSBhcmd1bWVudHM7CgkgICAgICB0aW1lc3RhbXAgPSBfLm5vdygpOwoJICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7CgkgICAgICBpZiAoIXRpbWVvdXQpIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTsKCSAgICAgIGlmIChjYWxsTm93KSB7CgkgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CgkgICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDsKCSAgICAgIH0KCgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgIH07CgoJICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBmdW5jdGlvbiBwYXNzZWQgYXMgYW4gYXJndW1lbnQgdG8gdGhlIHNlY29uZCwKCSAgLy8gYWxsb3dpbmcgeW91IHRvIGFkanVzdCBhcmd1bWVudHMsIHJ1biBjb2RlIGJlZm9yZSBhbmQgYWZ0ZXIsIGFuZAoJICAvLyBjb25kaXRpb25hbGx5IGV4ZWN1dGUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uLgoJICBfLndyYXAgPSBmdW5jdGlvbihmdW5jLCB3cmFwcGVyKSB7CgkgICAgcmV0dXJuIF8ucGFydGlhbCh3cmFwcGVyLCBmdW5jKTsKCSAgfTsKCgkgIC8vIFJldHVybnMgYSBuZWdhdGVkIHZlcnNpb24gb2YgdGhlIHBhc3NlZC1pbiBwcmVkaWNhdGUuCgkgIF8ubmVnYXRlID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgICAgcmV0dXJuICFwcmVkaWNhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgICB9OwoJICB9OwoKCSAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgaXMgdGhlIGNvbXBvc2l0aW9uIG9mIGEgbGlzdCBvZiBmdW5jdGlvbnMsIGVhY2gKCSAgLy8gY29uc3VtaW5nIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZ1bmN0aW9uIHRoYXQgZm9sbG93cy4KCSAgXy5jb21wb3NlID0gZnVuY3Rpb24oKSB7CgkgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7CgkgICAgdmFyIHN0YXJ0ID0gYXJncy5sZW5ndGggLSAxOwoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIHZhciBpID0gc3RhcnQ7CgkgICAgICB2YXIgcmVzdWx0ID0gYXJnc1tzdGFydF0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgICAgIHdoaWxlIChpLS0pIHJlc3VsdCA9IGFyZ3NbaV0uY2FsbCh0aGlzLCByZXN1bHQpOwoJICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICB9OwoKCSAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGJlIGV4ZWN1dGVkIG9uIGFuZCBhZnRlciB0aGUgTnRoIGNhbGwuCgkgIF8uYWZ0ZXIgPSBmdW5jdGlvbih0aW1lcywgZnVuYykgewoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIGlmICgtLXRpbWVzIDwgMSkgewoJICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgICAgfQoJICAgIH07CgkgIH07CgoJICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgdXAgdG8gKGJ1dCBub3QgaW5jbHVkaW5nKSB0aGUgTnRoIGNhbGwuCgkgIF8uYmVmb3JlID0gZnVuY3Rpb24odGltZXMsIGZ1bmMpIHsKCSAgICB2YXIgbWVtbzsKCSAgICByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgICBpZiAoLS10aW1lcyA+IDApIHsKCSAgICAgICAgbWVtbyA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgICAgIH0KCSAgICAgIGlmICh0aW1lcyA8PSAxKSBmdW5jID0gbnVsbDsKCSAgICAgIHJldHVybiBtZW1vOwoJICAgIH07CgkgIH07CgoJICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGV4ZWN1dGVkIGF0IG1vc3Qgb25lIHRpbWUsIG5vIG1hdHRlciBob3cKCSAgLy8gb2Z0ZW4geW91IGNhbGwgaXQuIFVzZWZ1bCBmb3IgbGF6eSBpbml0aWFsaXphdGlvbi4KCSAgXy5vbmNlID0gXy5wYXJ0aWFsKF8uYmVmb3JlLCAyKTsKCgkgIC8vIE9iamVjdCBGdW5jdGlvbnMKCSAgLy8gLS0tLS0tLS0tLS0tLS0tLQoKCSAgLy8gS2V5cyBpbiBJRSA8IDkgdGhhdCB3b24ndCBiZSBpdGVyYXRlZCBieSBgZm9yIGtleSBpbiAuLi5gIGFuZCB0aHVzIG1pc3NlZC4KCSAgdmFyIGhhc0VudW1CdWcgPSAhe3RvU3RyaW5nOiBudWxsfS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgndG9TdHJpbmcnKTsKCSAgdmFyIG5vbkVudW1lcmFibGVQcm9wcyA9IFsndmFsdWVPZicsICdpc1Byb3RvdHlwZU9mJywgJ3RvU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLCAnaGFzT3duUHJvcGVydHknLCAndG9Mb2NhbGVTdHJpbmcnXTsKCgkgIGZ1bmN0aW9uIGNvbGxlY3ROb25FbnVtUHJvcHMob2JqLCBrZXlzKSB7CgkgICAgdmFyIG5vbkVudW1JZHggPSBub25FbnVtZXJhYmxlUHJvcHMubGVuZ3RoOwoJICAgIHZhciBjb25zdHJ1Y3RvciA9IG9iai5jb25zdHJ1Y3RvcjsKCSAgICB2YXIgcHJvdG8gPSAoXy5pc0Z1bmN0aW9uKGNvbnN0cnVjdG9yKSAmJiBjb25zdHJ1Y3Rvci5wcm90b3R5cGUpIHx8IE9ialByb3RvOwoKCSAgICAvLyBDb25zdHJ1Y3RvciBpcyBhIHNwZWNpYWwgY2FzZS4KCSAgICB2YXIgcHJvcCA9ICdjb25zdHJ1Y3Rvcic7CgkgICAgaWYgKF8uaGFzKG9iaiwgcHJvcCkgJiYgIV8uY29udGFpbnMoa2V5cywgcHJvcCkpIGtleXMucHVzaChwcm9wKTsKCgkgICAgd2hpbGUgKG5vbkVudW1JZHgtLSkgewoJICAgICAgcHJvcCA9IG5vbkVudW1lcmFibGVQcm9wc1tub25FbnVtSWR4XTsKCSAgICAgIGlmIChwcm9wIGluIG9iaiAmJiBvYmpbcHJvcF0gIT09IHByb3RvW3Byb3BdICYmICFfLmNvbnRhaW5zKGtleXMsIHByb3ApKSB7CgkgICAgICAgIGtleXMucHVzaChwcm9wKTsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIC8vIFJldHJpZXZlIHRoZSBuYW1lcyBvZiBhbiBvYmplY3QncyBvd24gcHJvcGVydGllcy4KCSAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYE9iamVjdC5rZXlzYAoJICBfLmtleXMgPSBmdW5jdGlvbihvYmopIHsKCSAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdOwoJICAgIGlmIChuYXRpdmVLZXlzKSByZXR1cm4gbmF0aXZlS2V5cyhvYmopOwoJICAgIHZhciBrZXlzID0gW107CgkgICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKF8uaGFzKG9iaiwga2V5KSkga2V5cy5wdXNoKGtleSk7CgkgICAgLy8gQWhlbSwgSUUgPCA5LgoJICAgIGlmIChoYXNFbnVtQnVnKSBjb2xsZWN0Tm9uRW51bVByb3BzKG9iaiwga2V5cyk7CgkgICAgcmV0dXJuIGtleXM7CgkgIH07CgoJICAvLyBSZXRyaWV2ZSBhbGwgdGhlIHByb3BlcnR5IG5hbWVzIG9mIGFuIG9iamVjdC4KCSAgXy5hbGxLZXlzID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgaWYgKCFfLmlzT2JqZWN0KG9iaikpIHJldHVybiBbXTsKCSAgICB2YXIga2V5cyA9IFtdOwoJICAgIGZvciAodmFyIGtleSBpbiBvYmopIGtleXMucHVzaChrZXkpOwoJICAgIC8vIEFoZW0sIElFIDwgOS4KCSAgICBpZiAoaGFzRW51bUJ1ZykgY29sbGVjdE5vbkVudW1Qcm9wcyhvYmosIGtleXMpOwoJICAgIHJldHVybiBrZXlzOwoJICB9OwoKCSAgLy8gUmV0cmlldmUgdGhlIHZhbHVlcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLgoJICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7CgkgICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoOwoJICAgIHZhciB2YWx1ZXMgPSBBcnJheShsZW5ndGgpOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIHZhbHVlc1tpXSA9IG9ialtrZXlzW2ldXTsKCSAgICB9CgkgICAgcmV0dXJuIHZhbHVlczsKCSAgfTsKCgkgIC8vIFJldHVybnMgdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgb2JqZWN0CgkgIC8vIEluIGNvbnRyYXN0IHRvIF8ubWFwIGl0IHJldHVybnMgYW4gb2JqZWN0CgkgIF8ubWFwT2JqZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewoJICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpOwoJICAgIHZhciBrZXlzID0gIF8ua2V5cyhvYmopLAoJICAgICAgICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoLAoJICAgICAgICAgIHJlc3VsdHMgPSB7fSwKCSAgICAgICAgICBjdXJyZW50S2V5OwoJICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewoJICAgICAgICBjdXJyZW50S2V5ID0ga2V5c1tpbmRleF07CgkgICAgICAgIHJlc3VsdHNbY3VycmVudEtleV0gPSBpdGVyYXRlZShvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaik7CgkgICAgICB9CgkgICAgICByZXR1cm4gcmVzdWx0czsKCSAgfTsKCgkgIC8vIENvbnZlcnQgYW4gb2JqZWN0IGludG8gYSBsaXN0IG9mIGBba2V5LCB2YWx1ZV1gIHBhaXJzLgoJICBfLnBhaXJzID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTsKCSAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CgkgICAgdmFyIHBhaXJzID0gQXJyYXkobGVuZ3RoKTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICBwYWlyc1tpXSA9IFtrZXlzW2ldLCBvYmpba2V5c1tpXV1dOwoJICAgIH0KCSAgICByZXR1cm4gcGFpcnM7CgkgIH07CgoJICAvLyBJbnZlcnQgdGhlIGtleXMgYW5kIHZhbHVlcyBvZiBhbiBvYmplY3QuIFRoZSB2YWx1ZXMgbXVzdCBiZSBzZXJpYWxpemFibGUuCgkgIF8uaW52ZXJ0ID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgdmFyIHJlc3VsdCA9IHt9OwoJICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7CgkgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIHJlc3VsdFtvYmpba2V5c1tpXV1dID0ga2V5c1tpXTsKCSAgICB9CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfTsKCgkgIC8vIFJldHVybiBhIHNvcnRlZCBsaXN0IG9mIHRoZSBmdW5jdGlvbiBuYW1lcyBhdmFpbGFibGUgb24gdGhlIG9iamVjdC4KCSAgLy8gQWxpYXNlZCBhcyBgbWV0aG9kc2AKCSAgXy5mdW5jdGlvbnMgPSBfLm1ldGhvZHMgPSBmdW5jdGlvbihvYmopIHsKCSAgICB2YXIgbmFtZXMgPSBbXTsKCSAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CgkgICAgICBpZiAoXy5pc0Z1bmN0aW9uKG9ialtrZXldKSkgbmFtZXMucHVzaChrZXkpOwoJICAgIH0KCSAgICByZXR1cm4gbmFtZXMuc29ydCgpOwoJICB9OwoKCSAgLy8gRXh0ZW5kIGEgZ2l2ZW4gb2JqZWN0IHdpdGggYWxsIHRoZSBwcm9wZXJ0aWVzIGluIHBhc3NlZC1pbiBvYmplY3QocykuCgkgIF8uZXh0ZW5kID0gY3JlYXRlQXNzaWduZXIoXy5hbGxLZXlzKTsKCgkgIC8vIEFzc2lnbnMgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIG93biBwcm9wZXJ0aWVzIGluIHRoZSBwYXNzZWQtaW4gb2JqZWN0KHMpCgkgIC8vIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvYXNzaWduKQoJICBfLmV4dGVuZE93biA9IF8uYXNzaWduID0gY3JlYXRlQXNzaWduZXIoXy5rZXlzKTsKCgkgIC8vIFJldHVybnMgdGhlIGZpcnN0IGtleSBvbiBhbiBvYmplY3QgdGhhdCBwYXNzZXMgYSBwcmVkaWNhdGUgdGVzdAoJICBfLmZpbmRLZXkgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewoJICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgdmFyIGtleXMgPSBfLmtleXMob2JqKSwga2V5OwoJICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICBrZXkgPSBrZXlzW2ldOwoJICAgICAgaWYgKHByZWRpY2F0ZShvYmpba2V5XSwga2V5LCBvYmopKSByZXR1cm4ga2V5OwoJICAgIH0KCSAgfTsKCgkgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCBvbmx5IGNvbnRhaW5pbmcgdGhlIHdoaXRlbGlzdGVkIHByb3BlcnRpZXMuCgkgIF8ucGljayA9IGZ1bmN0aW9uKG9iamVjdCwgb2l0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgdmFyIHJlc3VsdCA9IHt9LCBvYmogPSBvYmplY3QsIGl0ZXJhdGVlLCBrZXlzOwoJICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdDsKCSAgICBpZiAoXy5pc0Z1bmN0aW9uKG9pdGVyYXRlZSkpIHsKCSAgICAgIGtleXMgPSBfLmFsbEtleXMob2JqKTsKCSAgICAgIGl0ZXJhdGVlID0gb3B0aW1pemVDYihvaXRlcmF0ZWUsIGNvbnRleHQpOwoJICAgIH0gZWxzZSB7CgkgICAgICBrZXlzID0gZmxhdHRlbihhcmd1bWVudHMsIGZhbHNlLCBmYWxzZSwgMSk7CgkgICAgICBpdGVyYXRlZSA9IGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iaikgeyByZXR1cm4ga2V5IGluIG9iajsgfTsKCSAgICAgIG9iaiA9IE9iamVjdChvYmopOwoJICAgIH0KCSAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgdmFyIGtleSA9IGtleXNbaV07CgkgICAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTsKCSAgICAgIGlmIChpdGVyYXRlZSh2YWx1ZSwga2V5LCBvYmopKSByZXN1bHRba2V5XSA9IHZhbHVlOwoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCB3aXRob3V0IHRoZSBibGFja2xpc3RlZCBwcm9wZXJ0aWVzLgoJICBfLm9taXQgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgaWYgKF8uaXNGdW5jdGlvbihpdGVyYXRlZSkpIHsKCSAgICAgIGl0ZXJhdGVlID0gXy5uZWdhdGUoaXRlcmF0ZWUpOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIga2V5cyA9IF8ubWFwKGZsYXR0ZW4oYXJndW1lbnRzLCBmYWxzZSwgZmFsc2UsIDEpLCBTdHJpbmcpOwoJICAgICAgaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwga2V5KSB7CgkgICAgICAgIHJldHVybiAhXy5jb250YWlucyhrZXlzLCBrZXkpOwoJICAgICAgfTsKCSAgICB9CgkgICAgcmV0dXJuIF8ucGljayhvYmosIGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgfTsKCgkgIC8vIEZpbGwgaW4gYSBnaXZlbiBvYmplY3Qgd2l0aCBkZWZhdWx0IHByb3BlcnRpZXMuCgkgIF8uZGVmYXVsdHMgPSBjcmVhdGVBc3NpZ25lcihfLmFsbEtleXMsIHRydWUpOwoKCSAgLy8gQ3JlYXRlcyBhbiBvYmplY3QgdGhhdCBpbmhlcml0cyBmcm9tIHRoZSBnaXZlbiBwcm90b3R5cGUgb2JqZWN0LgoJICAvLyBJZiBhZGRpdGlvbmFsIHByb3BlcnRpZXMgYXJlIHByb3ZpZGVkIHRoZW4gdGhleSB3aWxsIGJlIGFkZGVkIHRvIHRoZQoJICAvLyBjcmVhdGVkIG9iamVjdC4KCSAgXy5jcmVhdGUgPSBmdW5jdGlvbihwcm90b3R5cGUsIHByb3BzKSB7CgkgICAgdmFyIHJlc3VsdCA9IGJhc2VDcmVhdGUocHJvdG90eXBlKTsKCSAgICBpZiAocHJvcHMpIF8uZXh0ZW5kT3duKHJlc3VsdCwgcHJvcHMpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuCgkgIF8uY2xvbmUgPSBmdW5jdGlvbihvYmopIHsKCSAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIG9iajsKCSAgICByZXR1cm4gXy5pc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IF8uZXh0ZW5kKHt9LCBvYmopOwoJICB9OwoKCSAgLy8gSW52b2tlcyBpbnRlcmNlcHRvciB3aXRoIHRoZSBvYmosIGFuZCB0aGVuIHJldHVybnMgb2JqLgoJICAvLyBUaGUgcHJpbWFyeSBwdXJwb3NlIG9mIHRoaXMgbWV0aG9kIGlzIHRvICJ0YXAgaW50byIgYSBtZXRob2QgY2hhaW4sIGluCgkgIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLgoJICBfLnRhcCA9IGZ1bmN0aW9uKG9iaiwgaW50ZXJjZXB0b3IpIHsKCSAgICBpbnRlcmNlcHRvcihvYmopOwoJICAgIHJldHVybiBvYmo7CgkgIH07CgoJICAvLyBSZXR1cm5zIHdoZXRoZXIgYW4gb2JqZWN0IGhhcyBhIGdpdmVuIHNldCBvZiBga2V5OnZhbHVlYCBwYWlycy4KCSAgXy5pc01hdGNoID0gZnVuY3Rpb24ob2JqZWN0LCBhdHRycykgewoJICAgIHZhciBrZXlzID0gXy5rZXlzKGF0dHJzKSwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CgkgICAgaWYgKG9iamVjdCA9PSBudWxsKSByZXR1cm4gIWxlbmd0aDsKCSAgICB2YXIgb2JqID0gT2JqZWN0KG9iamVjdCk7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgdmFyIGtleSA9IGtleXNbaV07CgkgICAgICBpZiAoYXR0cnNba2V5XSAhPT0gb2JqW2tleV0gfHwgIShrZXkgaW4gb2JqKSkgcmV0dXJuIGZhbHNlOwoJICAgIH0KCSAgICByZXR1cm4gdHJ1ZTsKCSAgfTsKCgoJICAvLyBJbnRlcm5hbCByZWN1cnNpdmUgY29tcGFyaXNvbiBmdW5jdGlvbiBmb3IgYGlzRXF1YWxgLgoJICB2YXIgZXEgPSBmdW5jdGlvbihhLCBiLCBhU3RhY2ssIGJTdGFjaykgewoJICAgIC8vIElkZW50aWNhbCBvYmplY3RzIGFyZSBlcXVhbC4gYDAgPT09IC0wYCwgYnV0IHRoZXkgYXJlbid0IGlkZW50aWNhbC4KCSAgICAvLyBTZWUgdGhlIFtIYXJtb255IGBlZ2FsYCBwcm9wb3NhbF0oaHR0cDovL3dpa2kuZWNtYXNjcmlwdC5vcmcvZG9rdS5waHA/aWQ9aGFybW9ueTplZ2FsKS4KCSAgICBpZiAoYSA9PT0gYikgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT09IDEgLyBiOwoJICAgIC8vIEEgc3RyaWN0IGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5IGJlY2F1c2UgYG51bGwgPT0gdW5kZWZpbmVkYC4KCSAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7CgkgICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuCgkgICAgaWYgKGEgaW5zdGFuY2VvZiBfKSBhID0gYS5fd3JhcHBlZDsKCSAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkOwoJICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuCgkgICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7CgkgICAgaWYgKGNsYXNzTmFtZSAhPT0gdG9TdHJpbmcuY2FsbChiKSkgcmV0dXJuIGZhbHNlOwoJICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7CgkgICAgICAvLyBTdHJpbmdzLCBudW1iZXJzLCByZWd1bGFyIGV4cHJlc3Npb25zLCBkYXRlcywgYW5kIGJvb2xlYW5zIGFyZSBjb21wYXJlZCBieSB2YWx1ZS4KCSAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6CgkgICAgICAvLyBSZWdFeHBzIGFyZSBjb2VyY2VkIHRvIHN0cmluZ3MgZm9yIGNvbXBhcmlzb24gKE5vdGU6ICcnICsgL2EvaSA9PT0gJy9hL2knKQoJICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzoKCSAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGAiNSJgIGlzCgkgICAgICAgIC8vIGVxdWl2YWxlbnQgdG8gYG5ldyBTdHJpbmcoIjUiKWAuCgkgICAgICAgIHJldHVybiAnJyArIGEgPT09ICcnICsgYjsKCSAgICAgIGNhc2UgJ1tvYmplY3QgTnVtYmVyXSc6CgkgICAgICAgIC8vIGBOYU5gcyBhcmUgZXF1aXZhbGVudCwgYnV0IG5vbi1yZWZsZXhpdmUuCgkgICAgICAgIC8vIE9iamVjdChOYU4pIGlzIGVxdWl2YWxlbnQgdG8gTmFOCgkgICAgICAgIGlmICgrYSAhPT0gK2EpIHJldHVybiArYiAhPT0gK2I7CgkgICAgICAgIC8vIEFuIGBlZ2FsYCBjb21wYXJpc29uIGlzIHBlcmZvcm1lZCBmb3Igb3RoZXIgbnVtZXJpYyB2YWx1ZXMuCgkgICAgICAgIHJldHVybiArYSA9PT0gMCA/IDEgLyArYSA9PT0gMSAvIGIgOiArYSA9PT0gK2I7CgkgICAgICBjYXNlICdbb2JqZWN0IERhdGVdJzoKCSAgICAgIGNhc2UgJ1tvYmplY3QgQm9vbGVhbl0nOgoJICAgICAgICAvLyBDb2VyY2UgZGF0ZXMgYW5kIGJvb2xlYW5zIHRvIG51bWVyaWMgcHJpbWl0aXZlIHZhbHVlcy4gRGF0ZXMgYXJlIGNvbXBhcmVkIGJ5IHRoZWlyCgkgICAgICAgIC8vIG1pbGxpc2Vjb25kIHJlcHJlc2VudGF0aW9ucy4gTm90ZSB0aGF0IGludmFsaWQgZGF0ZXMgd2l0aCBtaWxsaXNlY29uZCByZXByZXNlbnRhdGlvbnMKCSAgICAgICAgLy8gb2YgYE5hTmAgYXJlIG5vdCBlcXVpdmFsZW50LgoJICAgICAgICByZXR1cm4gK2EgPT09ICtiOwoJICAgIH0KCgkgICAgdmFyIGFyZUFycmF5cyA9IGNsYXNzTmFtZSA9PT0gJ1tvYmplY3QgQXJyYXldJzsKCSAgICBpZiAoIWFyZUFycmF5cykgewoJICAgICAgaWYgKHR5cGVvZiBhICE9ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7CgoJICAgICAgLy8gT2JqZWN0cyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVpdmFsZW50LCBidXQgYE9iamVjdGBzIG9yIGBBcnJheWBzCgkgICAgICAvLyBmcm9tIGRpZmZlcmVudCBmcmFtZXMgYXJlLgoJICAgICAgdmFyIGFDdG9yID0gYS5jb25zdHJ1Y3RvciwgYkN0b3IgPSBiLmNvbnN0cnVjdG9yOwoJICAgICAgaWYgKGFDdG9yICE9PSBiQ3RvciAmJiAhKF8uaXNGdW5jdGlvbihhQ3RvcikgJiYgYUN0b3IgaW5zdGFuY2VvZiBhQ3RvciAmJgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uaXNGdW5jdGlvbihiQ3RvcikgJiYgYkN0b3IgaW5zdGFuY2VvZiBiQ3RvcikKCSAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgIH0KCSAgICB9CgkgICAgLy8gQXNzdW1lIGVxdWFsaXR5IGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpYwoJICAgIC8vIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMSBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gLgoKCSAgICAvLyBJbml0aWFsaXppbmcgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuCgkgICAgLy8gSXQncyBkb25lIGhlcmUgc2luY2Ugd2Ugb25seSBuZWVkIHRoZW0gZm9yIG9iamVjdHMgYW5kIGFycmF5cyBjb21wYXJpc29uLgoJICAgIGFTdGFjayA9IGFTdGFjayB8fCBbXTsKCSAgICBiU3RhY2sgPSBiU3RhY2sgfHwgW107CgkgICAgdmFyIGxlbmd0aCA9IGFTdGFjay5sZW5ndGg7CgkgICAgd2hpbGUgKGxlbmd0aC0tKSB7CgkgICAgICAvLyBMaW5lYXIgc2VhcmNoLiBQZXJmb3JtYW5jZSBpcyBpbnZlcnNlbHkgcHJvcG9ydGlvbmFsIHRvIHRoZSBudW1iZXIgb2YKCSAgICAgIC8vIHVuaXF1ZSBuZXN0ZWQgc3RydWN0dXJlcy4KCSAgICAgIGlmIChhU3RhY2tbbGVuZ3RoXSA9PT0gYSkgcmV0dXJuIGJTdGFja1tsZW5ndGhdID09PSBiOwoJICAgIH0KCgkgICAgLy8gQWRkIHRoZSBmaXJzdCBvYmplY3QgdG8gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzLgoJICAgIGFTdGFjay5wdXNoKGEpOwoJICAgIGJTdGFjay5wdXNoKGIpOwoKCSAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cy4KCSAgICBpZiAoYXJlQXJyYXlzKSB7CgkgICAgICAvLyBDb21wYXJlIGFycmF5IGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeS4KCSAgICAgIGxlbmd0aCA9IGEubGVuZ3RoOwoJICAgICAgaWYgKGxlbmd0aCAhPT0gYi5sZW5ndGgpIHJldHVybiBmYWxzZTsKCSAgICAgIC8vIERlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXMuCgkgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgaWYgKCFlcShhW2xlbmd0aF0sIGJbbGVuZ3RoXSwgYVN0YWNrLCBiU3RhY2spKSByZXR1cm4gZmFsc2U7CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIC8vIERlZXAgY29tcGFyZSBvYmplY3RzLgoJICAgICAgdmFyIGtleXMgPSBfLmtleXMoYSksIGtleTsKCSAgICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoOwoJICAgICAgLy8gRW5zdXJlIHRoYXQgYm90aCBvYmplY3RzIGNvbnRhaW4gdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXMgYmVmb3JlIGNvbXBhcmluZyBkZWVwIGVxdWFsaXR5LgoJICAgICAgaWYgKF8ua2V5cyhiKS5sZW5ndGggIT09IGxlbmd0aCkgcmV0dXJuIGZhbHNlOwoJICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7CgkgICAgICAgIC8vIERlZXAgY29tcGFyZSBlYWNoIG1lbWJlcgoJICAgICAgICBrZXkgPSBrZXlzW2xlbmd0aF07CgkgICAgICAgIGlmICghKF8uaGFzKGIsIGtleSkgJiYgZXEoYVtrZXldLCBiW2tleV0sIGFTdGFjaywgYlN0YWNrKSkpIHJldHVybiBmYWxzZTsKCSAgICAgIH0KCSAgICB9CgkgICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBvYmplY3QgZnJvbSB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuCgkgICAgYVN0YWNrLnBvcCgpOwoJICAgIGJTdGFjay5wb3AoKTsKCSAgICByZXR1cm4gdHJ1ZTsKCSAgfTsKCgkgIC8vIFBlcmZvcm0gYSBkZWVwIGNvbXBhcmlzb24gdG8gY2hlY2sgaWYgdHdvIG9iamVjdHMgYXJlIGVxdWFsLgoJICBfLmlzRXF1YWwgPSBmdW5jdGlvbihhLCBiKSB7CgkgICAgcmV0dXJuIGVxKGEsIGIpOwoJICB9OwoKCSAgLy8gSXMgYSBnaXZlbiBhcnJheSwgc3RyaW5nLCBvciBvYmplY3QgZW1wdHk/CgkgIC8vIEFuICJlbXB0eSIgb2JqZWN0IGhhcyBubyBlbnVtZXJhYmxlIG93bi1wcm9wZXJ0aWVzLgoJICBfLmlzRW1wdHkgPSBmdW5jdGlvbihvYmopIHsKCSAgICBpZiAob2JqID09IG51bGwpIHJldHVybiB0cnVlOwoJICAgIGlmIChpc0FycmF5TGlrZShvYmopICYmIChfLmlzQXJyYXkob2JqKSB8fCBfLmlzU3RyaW5nKG9iaikgfHwgXy5pc0FyZ3VtZW50cyhvYmopKSkgcmV0dXJuIG9iai5sZW5ndGggPT09IDA7CgkgICAgcmV0dXJuIF8ua2V5cyhvYmopLmxlbmd0aCA9PT0gMDsKCSAgfTsKCgkgIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYSBET00gZWxlbWVudD8KCSAgXy5pc0VsZW1lbnQgPSBmdW5jdGlvbihvYmopIHsKCSAgICByZXR1cm4gISEob2JqICYmIG9iai5ub2RlVHlwZSA9PT0gMSk7CgkgIH07CgoJICAvLyBJcyBhIGdpdmVuIHZhbHVlIGFuIGFycmF5PwoJICAvLyBEZWxlZ2F0ZXMgdG8gRUNNQTUncyBuYXRpdmUgQXJyYXkuaXNBcnJheQoJICBfLmlzQXJyYXkgPSBuYXRpdmVJc0FycmF5IHx8IGZ1bmN0aW9uKG9iaikgewoJICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7CgkgIH07CgoJICAvLyBJcyBhIGdpdmVuIHZhcmlhYmxlIGFuIG9iamVjdD8KCSAgXy5pc09iamVjdCA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHZhciB0eXBlID0gdHlwZW9mIG9iajsKCSAgICByZXR1cm4gdHlwZSA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlID09PSAnb2JqZWN0JyAmJiAhIW9iajsKCSAgfTsKCgkgIC8vIEFkZCBzb21lIGlzVHlwZSBtZXRob2RzOiBpc0FyZ3VtZW50cywgaXNGdW5jdGlvbiwgaXNTdHJpbmcsIGlzTnVtYmVyLCBpc0RhdGUsIGlzUmVnRXhwLCBpc0Vycm9yLgoJICBfLmVhY2goWydBcmd1bWVudHMnLCAnRnVuY3Rpb24nLCAnU3RyaW5nJywgJ051bWJlcicsICdEYXRlJywgJ1JlZ0V4cCcsICdFcnJvciddLCBmdW5jdGlvbihuYW1lKSB7CgkgICAgX1snaXMnICsgbmFtZV0gPSBmdW5jdGlvbihvYmopIHsKCSAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0ICcgKyBuYW1lICsgJ10nOwoJICAgIH07CgkgIH0pOwoKCSAgLy8gRGVmaW5lIGEgZmFsbGJhY2sgdmVyc2lvbiBvZiB0aGUgbWV0aG9kIGluIGJyb3dzZXJzIChhaGVtLCBJRSA8IDkpLCB3aGVyZQoJICAvLyB0aGVyZSBpc24ndCBhbnkgaW5zcGVjdGFibGUgIkFyZ3VtZW50cyIgdHlwZS4KCSAgaWYgKCFfLmlzQXJndW1lbnRzKGFyZ3VtZW50cykpIHsKCSAgICBfLmlzQXJndW1lbnRzID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgICByZXR1cm4gXy5oYXMob2JqLCAnY2FsbGVlJyk7CgkgICAgfTsKCSAgfQoKCSAgLy8gT3B0aW1pemUgYGlzRnVuY3Rpb25gIGlmIGFwcHJvcHJpYXRlLiBXb3JrIGFyb3VuZCBzb21lIHR5cGVvZiBidWdzIGluIG9sZCB2OCwKCSAgLy8gSUUgMTEgKCMxNjIxKSwgYW5kIGluIFNhZmFyaSA4ICgjMTkyOSkuCgkgIGlmICh0eXBlb2YgLy4vICE9ICdmdW5jdGlvbicgJiYgdHlwZW9mIEludDhBcnJheSAhPSAnb2JqZWN0JykgewoJICAgIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikgewoJICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTsKCSAgICB9OwoJICB9CgoJICAvLyBJcyBhIGdpdmVuIG9iamVjdCBhIGZpbml0ZSBudW1iZXI/CgkgIF8uaXNGaW5pdGUgPSBmdW5jdGlvbihvYmopIHsKCSAgICByZXR1cm4gaXNGaW5pdGUob2JqKSAmJiAhaXNOYU4ocGFyc2VGbG9hdChvYmopKTsKCSAgfTsKCgkgIC8vIElzIHRoZSBnaXZlbiB2YWx1ZSBgTmFOYD8gKE5hTiBpcyB0aGUgb25seSBudW1iZXIgd2hpY2ggZG9lcyBub3QgZXF1YWwgaXRzZWxmKS4KCSAgXy5pc05hTiA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHJldHVybiBfLmlzTnVtYmVyKG9iaikgJiYgb2JqICE9PSArb2JqOwoJICB9OwoKCSAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/CgkgIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZSB8fCBvYmogPT09IGZhbHNlIHx8IHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQm9vbGVhbl0nOwoJICB9OwoKCSAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBlcXVhbCB0byBudWxsPwoJICBfLmlzTnVsbCA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHJldHVybiBvYmogPT09IG51bGw7CgkgIH07CgoJICAvLyBJcyBhIGdpdmVuIHZhcmlhYmxlIHVuZGVmaW5lZD8KCSAgXy5pc1VuZGVmaW5lZCA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHJldHVybiBvYmogPT09IHZvaWQgMDsKCSAgfTsKCgkgIC8vIFNob3J0Y3V0IGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gcHJvcGVydHkgZGlyZWN0bHkKCSAgLy8gb24gaXRzZWxmIChpbiBvdGhlciB3b3Jkcywgbm90IG9uIGEgcHJvdG90eXBlKS4KCSAgXy5oYXMgPSBmdW5jdGlvbihvYmosIGtleSkgewoJICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTsKCSAgfTsKCgkgIC8vIFV0aWxpdHkgRnVuY3Rpb25zCgkgIC8vIC0tLS0tLS0tLS0tLS0tLS0tCgoJICAvLyBSdW4gVW5kZXJzY29yZS5qcyBpbiAqbm9Db25mbGljdCogbW9kZSwgcmV0dXJuaW5nIHRoZSBgX2AgdmFyaWFibGUgdG8gaXRzCgkgIC8vIHByZXZpb3VzIG93bmVyLiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdC4KCSAgXy5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oKSB7CgkgICAgcm9vdC5fID0gcHJldmlvdXNVbmRlcnNjb3JlOwoJICAgIHJldHVybiB0aGlzOwoJICB9OwoKCSAgLy8gS2VlcCB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gYXJvdW5kIGZvciBkZWZhdWx0IGl0ZXJhdGVlcy4KCSAgXy5pZGVudGl0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7CgkgICAgcmV0dXJuIHZhbHVlOwoJICB9OwoKCSAgLy8gUHJlZGljYXRlLWdlbmVyYXRpbmcgZnVuY3Rpb25zLiBPZnRlbiB1c2VmdWwgb3V0c2lkZSBvZiBVbmRlcnNjb3JlLgoJICBfLmNvbnN0YW50ID0gZnVuY3Rpb24odmFsdWUpIHsKCSAgICByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgICByZXR1cm4gdmFsdWU7CgkgICAgfTsKCSAgfTsKCgkgIF8ubm9vcCA9IGZ1bmN0aW9uKCl7fTsKCgkgIF8ucHJvcGVydHkgPSBwcm9wZXJ0eTsKCgkgIC8vIEdlbmVyYXRlcyBhIGZ1bmN0aW9uIGZvciBhIGdpdmVuIG9iamVjdCB0aGF0IHJldHVybnMgYSBnaXZlbiBwcm9wZXJ0eS4KCSAgXy5wcm9wZXJ0eU9mID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgcmV0dXJuIG9iaiA9PSBudWxsID8gZnVuY3Rpb24oKXt9IDogZnVuY3Rpb24oa2V5KSB7CgkgICAgICByZXR1cm4gb2JqW2tleV07CgkgICAgfTsKCSAgfTsKCgkgIC8vIFJldHVybnMgYSBwcmVkaWNhdGUgZm9yIGNoZWNraW5nIHdoZXRoZXIgYW4gb2JqZWN0IGhhcyBhIGdpdmVuIHNldCBvZgoJICAvLyBga2V5OnZhbHVlYCBwYWlycy4KCSAgXy5tYXRjaGVyID0gXy5tYXRjaGVzID0gZnVuY3Rpb24oYXR0cnMpIHsKCSAgICBhdHRycyA9IF8uZXh0ZW5kT3duKHt9LCBhdHRycyk7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikgewoJICAgICAgcmV0dXJuIF8uaXNNYXRjaChvYmosIGF0dHJzKTsKCSAgICB9OwoJICB9OwoKCSAgLy8gUnVuIGEgZnVuY3Rpb24gKipuKiogdGltZXMuCgkgIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRlZSwgY29udGV4dCkgewoJICAgIHZhciBhY2N1bSA9IEFycmF5KE1hdGgubWF4KDAsIG4pKTsKCSAgICBpdGVyYXRlZSA9IG9wdGltaXplQ2IoaXRlcmF0ZWUsIGNvbnRleHQsIDEpOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBhY2N1bVtpXSA9IGl0ZXJhdGVlKGkpOwoJICAgIHJldHVybiBhY2N1bTsKCSAgfTsKCgkgIC8vIFJldHVybiBhIHJhbmRvbSBpbnRlZ2VyIGJldHdlZW4gbWluIGFuZCBtYXggKGluY2x1c2l2ZSkuCgkgIF8ucmFuZG9tID0gZnVuY3Rpb24obWluLCBtYXgpIHsKCSAgICBpZiAobWF4ID09IG51bGwpIHsKCSAgICAgIG1heCA9IG1pbjsKCSAgICAgIG1pbiA9IDA7CgkgICAgfQoJICAgIHJldHVybiBtaW4gKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpOwoJICB9OwoKCSAgLy8gQSAocG9zc2libHkgZmFzdGVyKSB3YXkgdG8gZ2V0IHRoZSBjdXJyZW50IHRpbWVzdGFtcCBhcyBhbiBpbnRlZ2VyLgoJICBfLm5vdyA9IERhdGUubm93IHx8IGZ1bmN0aW9uKCkgewoJICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKCSAgfTsKCgkgICAvLyBMaXN0IG9mIEhUTUwgZW50aXRpZXMgZm9yIGVzY2FwaW5nLgoJICB2YXIgZXNjYXBlTWFwID0gewoJICAgICcmJzogJyZhbXA7JywKCSAgICAnPCc6ICcmbHQ7JywKCSAgICAnPic6ICcmZ3Q7JywKCSAgICAnIic6ICcmcXVvdDsnLAoJICAgICInIjogJyYjeDI3OycsCgkgICAgJ2AnOiAnJiN4NjA7JwoJICB9OwoJICB2YXIgdW5lc2NhcGVNYXAgPSBfLmludmVydChlc2NhcGVNYXApOwoKCSAgLy8gRnVuY3Rpb25zIGZvciBlc2NhcGluZyBhbmQgdW5lc2NhcGluZyBzdHJpbmdzIHRvL2Zyb20gSFRNTCBpbnRlcnBvbGF0aW9uLgoJICB2YXIgY3JlYXRlRXNjYXBlciA9IGZ1bmN0aW9uKG1hcCkgewoJICAgIHZhciBlc2NhcGVyID0gZnVuY3Rpb24obWF0Y2gpIHsKCSAgICAgIHJldHVybiBtYXBbbWF0Y2hdOwoJICAgIH07CgkgICAgLy8gUmVnZXhlcyBmb3IgaWRlbnRpZnlpbmcgYSBrZXkgdGhhdCBuZWVkcyB0byBiZSBlc2NhcGVkCgkgICAgdmFyIHNvdXJjZSA9ICcoPzonICsgXy5rZXlzKG1hcCkuam9pbignfCcpICsgJyknOwoJICAgIHZhciB0ZXN0UmVnZXhwID0gUmVnRXhwKHNvdXJjZSk7CgkgICAgdmFyIHJlcGxhY2VSZWdleHAgPSBSZWdFeHAoc291cmNlLCAnZycpOwoJICAgIHJldHVybiBmdW5jdGlvbihzdHJpbmcpIHsKCSAgICAgIHN0cmluZyA9IHN0cmluZyA9PSBudWxsID8gJycgOiAnJyArIHN0cmluZzsKCSAgICAgIHJldHVybiB0ZXN0UmVnZXhwLnRlc3Qoc3RyaW5nKSA/IHN0cmluZy5yZXBsYWNlKHJlcGxhY2VSZWdleHAsIGVzY2FwZXIpIDogc3RyaW5nOwoJICAgIH07CgkgIH07CgkgIF8uZXNjYXBlID0gY3JlYXRlRXNjYXBlcihlc2NhcGVNYXApOwoJICBfLnVuZXNjYXBlID0gY3JlYXRlRXNjYXBlcih1bmVzY2FwZU1hcCk7CgoJICAvLyBJZiB0aGUgdmFsdWUgb2YgdGhlIG5hbWVkIGBwcm9wZXJ0eWAgaXMgYSBmdW5jdGlvbiB0aGVuIGludm9rZSBpdCB3aXRoIHRoZQoJICAvLyBgb2JqZWN0YCBhcyBjb250ZXh0OyBvdGhlcndpc2UsIHJldHVybiBpdC4KCSAgXy5yZXN1bHQgPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5LCBmYWxsYmFjaykgewoJICAgIHZhciB2YWx1ZSA9IG9iamVjdCA9PSBudWxsID8gdm9pZCAwIDogb2JqZWN0W3Byb3BlcnR5XTsKCSAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgewoJICAgICAgdmFsdWUgPSBmYWxsYmFjazsKCSAgICB9CgkgICAgcmV0dXJuIF8uaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKG9iamVjdCkgOiB2YWx1ZTsKCSAgfTsKCgkgIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGludGVnZXIgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lvbikuCgkgIC8vIFVzZWZ1bCBmb3IgdGVtcG9yYXJ5IERPTSBpZHMuCgkgIHZhciBpZENvdW50ZXIgPSAwOwoJICBfLnVuaXF1ZUlkID0gZnVuY3Rpb24ocHJlZml4KSB7CgkgICAgdmFyIGlkID0gKytpZENvdW50ZXIgKyAnJzsKCSAgICByZXR1cm4gcHJlZml4ID8gcHJlZml4ICsgaWQgOiBpZDsKCSAgfTsKCgkgIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUgdXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZQoJICAvLyBmb2xsb3dpbmcgdGVtcGxhdGUgc2V0dGluZ3MgdG8gdXNlIGFsdGVybmF0aXZlIGRlbGltaXRlcnMuCgkgIF8udGVtcGxhdGVTZXR0aW5ncyA9IHsKCSAgICBldmFsdWF0ZSAgICA6IC88JShbXHNcU10rPyklPi9nLAoJICAgIGludGVycG9sYXRlIDogLzwlPShbXHNcU10rPyklPi9nLAoJICAgIGVzY2FwZSAgICAgIDogLzwlLShbXHNcU10rPyklPi9nCgkgIH07CgoJICAvLyBXaGVuIGN1c3RvbWl6aW5nIGB0ZW1wbGF0ZVNldHRpbmdzYCwgaWYgeW91IGRvbid0IHdhbnQgdG8gZGVmaW5lIGFuCgkgIC8vIGludGVycG9sYXRpb24sIGV2YWx1YXRpb24gb3IgZXNjYXBpbmcgcmVnZXgsIHdlIG5lZWQgb25lIHRoYXQgaXMKCSAgLy8gZ3VhcmFudGVlZCBub3QgdG8gbWF0Y2guCgkgIHZhciBub01hdGNoID0gLyguKV4vOwoKCSAgLy8gQ2VydGFpbiBjaGFyYWN0ZXJzIG5lZWQgdG8gYmUgZXNjYXBlZCBzbyB0aGF0IHRoZXkgY2FuIGJlIHB1dCBpbnRvIGEKCSAgLy8gc3RyaW5nIGxpdGVyYWwuCgkgIHZhciBlc2NhcGVzID0gewoJICAgICInIjogICAgICAiJyIsCgkgICAgJ1xcJzogICAgICdcXCcsCgkgICAgJ1xyJzogICAgICdyJywKCSAgICAnXG4nOiAgICAgJ24nLAoJICAgICdcdTIwMjgnOiAndTIwMjgnLAoJICAgICdcdTIwMjknOiAndTIwMjknCgkgIH07CgoJICB2YXIgZXNjYXBlciA9IC9cXHwnfFxyfFxufFx1MjAyOHxcdTIwMjkvZzsKCgkgIHZhciBlc2NhcGVDaGFyID0gZnVuY3Rpb24obWF0Y2gpIHsKCSAgICByZXR1cm4gJ1xcJyArIGVzY2FwZXNbbWF0Y2hdOwoJICB9OwoKCSAgLy8gSmF2YVNjcmlwdCBtaWNyby10ZW1wbGF0aW5nLCBzaW1pbGFyIHRvIEpvaG4gUmVzaWcncyBpbXBsZW1lbnRhdGlvbi4KCSAgLy8gVW5kZXJzY29yZSB0ZW1wbGF0aW5nIGhhbmRsZXMgYXJiaXRyYXJ5IGRlbGltaXRlcnMsIHByZXNlcnZlcyB3aGl0ZXNwYWNlLAoJICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS4KCSAgLy8gTkI6IGBvbGRTZXR0aW5nc2Agb25seSBleGlzdHMgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LgoJICBfLnRlbXBsYXRlID0gZnVuY3Rpb24odGV4dCwgc2V0dGluZ3MsIG9sZFNldHRpbmdzKSB7CgkgICAgaWYgKCFzZXR0aW5ncyAmJiBvbGRTZXR0aW5ncykgc2V0dGluZ3MgPSBvbGRTZXR0aW5nczsKCSAgICBzZXR0aW5ncyA9IF8uZGVmYXVsdHMoe30sIHNldHRpbmdzLCBfLnRlbXBsYXRlU2V0dGluZ3MpOwoKCSAgICAvLyBDb21iaW5lIGRlbGltaXRlcnMgaW50byBvbmUgcmVndWxhciBleHByZXNzaW9uIHZpYSBhbHRlcm5hdGlvbi4KCSAgICB2YXIgbWF0Y2hlciA9IFJlZ0V4cChbCgkgICAgICAoc2V0dGluZ3MuZXNjYXBlIHx8IG5vTWF0Y2gpLnNvdXJjZSwKCSAgICAgIChzZXR0aW5ncy5pbnRlcnBvbGF0ZSB8fCBub01hdGNoKS5zb3VyY2UsCgkgICAgICAoc2V0dGluZ3MuZXZhbHVhdGUgfHwgbm9NYXRjaCkuc291cmNlCgkgICAgXS5qb2luKCd8JykgKyAnfCQnLCAnZycpOwoKCSAgICAvLyBDb21waWxlIHRoZSB0ZW1wbGF0ZSBzb3VyY2UsIGVzY2FwaW5nIHN0cmluZyBsaXRlcmFscyBhcHByb3ByaWF0ZWx5LgoJICAgIHZhciBpbmRleCA9IDA7CgkgICAgdmFyIHNvdXJjZSA9ICJfX3ArPSciOwoJICAgIHRleHQucmVwbGFjZShtYXRjaGVyLCBmdW5jdGlvbihtYXRjaCwgZXNjYXBlLCBpbnRlcnBvbGF0ZSwgZXZhbHVhdGUsIG9mZnNldCkgewoJICAgICAgc291cmNlICs9IHRleHQuc2xpY2UoaW5kZXgsIG9mZnNldCkucmVwbGFjZShlc2NhcGVyLCBlc2NhcGVDaGFyKTsKCSAgICAgIGluZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoOwoKCSAgICAgIGlmIChlc2NhcGUpIHsKCSAgICAgICAgc291cmNlICs9ICInK1xuKChfX3Q9KCIgKyBlc2NhcGUgKyAiKSk9PW51bGw/Jyc6Xy5lc2NhcGUoX190KSkrXG4nIjsKCSAgICAgIH0gZWxzZSBpZiAoaW50ZXJwb2xhdGUpIHsKCSAgICAgICAgc291cmNlICs9ICInK1xuKChfX3Q9KCIgKyBpbnRlcnBvbGF0ZSArICIpKT09bnVsbD8nJzpfX3QpK1xuJyI7CgkgICAgICB9IGVsc2UgaWYgKGV2YWx1YXRlKSB7CgkgICAgICAgIHNvdXJjZSArPSAiJztcbiIgKyBldmFsdWF0ZSArICJcbl9fcCs9JyI7CgkgICAgICB9CgoJICAgICAgLy8gQWRvYmUgVk1zIG5lZWQgdGhlIG1hdGNoIHJldHVybmVkIHRvIHByb2R1Y2UgdGhlIGNvcnJlY3Qgb2ZmZXN0LgoJICAgICAgcmV0dXJuIG1hdGNoOwoJICAgIH0pOwoJICAgIHNvdXJjZSArPSAiJztcbiI7CgoJICAgIC8vIElmIGEgdmFyaWFibGUgaXMgbm90IHNwZWNpZmllZCwgcGxhY2UgZGF0YSB2YWx1ZXMgaW4gbG9jYWwgc2NvcGUuCgkgICAgaWYgKCFzZXR0aW5ncy52YXJpYWJsZSkgc291cmNlID0gJ3dpdGgob2JqfHx7fSl7XG4nICsgc291cmNlICsgJ31cbic7CgoJICAgIHNvdXJjZSA9ICJ2YXIgX190LF9fcD0nJyxfX2o9QXJyYXkucHJvdG90eXBlLmpvaW4sIiArCgkgICAgICAicHJpbnQ9ZnVuY3Rpb24oKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyk7fTtcbiIgKwoJICAgICAgc291cmNlICsgJ3JldHVybiBfX3A7XG4nOwoKCSAgICB0cnkgewoJICAgICAgdmFyIHJlbmRlciA9IG5ldyBGdW5jdGlvbihzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJywgJ18nLCBzb3VyY2UpOwoJICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgIGUuc291cmNlID0gc291cmNlOwoJICAgICAgdGhyb3cgZTsKCSAgICB9CgoJICAgIHZhciB0ZW1wbGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHsKCSAgICAgIHJldHVybiByZW5kZXIuY2FsbCh0aGlzLCBkYXRhLCBfKTsKCSAgICB9OwoKCSAgICAvLyBQcm92aWRlIHRoZSBjb21waWxlZCBzb3VyY2UgYXMgYSBjb252ZW5pZW5jZSBmb3IgcHJlY29tcGlsYXRpb24uCgkgICAgdmFyIGFyZ3VtZW50ID0gc2V0dGluZ3MudmFyaWFibGUgfHwgJ29iaic7CgkgICAgdGVtcGxhdGUuc291cmNlID0gJ2Z1bmN0aW9uKCcgKyBhcmd1bWVudCArICcpe1xuJyArIHNvdXJjZSArICd9JzsKCgkgICAgcmV0dXJuIHRlbXBsYXRlOwoJICB9OwoKCSAgLy8gQWRkIGEgImNoYWluIiBmdW5jdGlvbi4gU3RhcnQgY2hhaW5pbmcgYSB3cmFwcGVkIFVuZGVyc2NvcmUgb2JqZWN0LgoJICBfLmNoYWluID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgdmFyIGluc3RhbmNlID0gXyhvYmopOwoJICAgIGluc3RhbmNlLl9jaGFpbiA9IHRydWU7CgkgICAgcmV0dXJuIGluc3RhbmNlOwoJICB9OwoKCSAgLy8gT09QCgkgIC8vIC0tLS0tLS0tLS0tLS0tLQoJICAvLyBJZiBVbmRlcnNjb3JlIGlzIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhhdAoJICAvLyBjYW4gYmUgdXNlZCBPTy1zdHlsZS4gVGhpcyB3cmFwcGVyIGhvbGRzIGFsdGVyZWQgdmVyc2lvbnMgb2YgYWxsIHRoZQoJICAvLyB1bmRlcnNjb3JlIGZ1bmN0aW9ucy4gV3JhcHBlZCBvYmplY3RzIG1heSBiZSBjaGFpbmVkLgoKCSAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnRpbnVlIGNoYWluaW5nIGludGVybWVkaWF0ZSByZXN1bHRzLgoJICB2YXIgcmVzdWx0ID0gZnVuY3Rpb24oaW5zdGFuY2UsIG9iaikgewoJICAgIHJldHVybiBpbnN0YW5jZS5fY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajsKCSAgfTsKCgkgIC8vIEFkZCB5b3VyIG93biBjdXN0b20gZnVuY3Rpb25zIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdC4KCSAgXy5taXhpbiA9IGZ1bmN0aW9uKG9iaikgewoJICAgIF8uZWFjaChfLmZ1bmN0aW9ucyhvYmopLCBmdW5jdGlvbihuYW1lKSB7CgkgICAgICB2YXIgZnVuYyA9IF9bbmFtZV0gPSBvYmpbbmFtZV07CgkgICAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkgewoJICAgICAgICB2YXIgYXJncyA9IFt0aGlzLl93cmFwcGVkXTsKCSAgICAgICAgcHVzaC5hcHBseShhcmdzLCBhcmd1bWVudHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0KHRoaXMsIGZ1bmMuYXBwbHkoXywgYXJncykpOwoJICAgICAgfTsKCSAgICB9KTsKCSAgfTsKCgkgIC8vIEFkZCBhbGwgb2YgdGhlIFVuZGVyc2NvcmUgZnVuY3Rpb25zIHRvIHRoZSB3cmFwcGVyIG9iamVjdC4KCSAgXy5taXhpbihfKTsKCgkgIC8vIEFkZCBhbGwgbXV0YXRvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCgkgIF8uZWFjaChbJ3BvcCcsICdwdXNoJywgJ3JldmVyc2UnLCAnc2hpZnQnLCAnc29ydCcsICdzcGxpY2UnLCAndW5zaGlmdCddLCBmdW5jdGlvbihuYW1lKSB7CgkgICAgdmFyIG1ldGhvZCA9IEFycmF5UHJvdG9bbmFtZV07CgkgICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKCSAgICAgIHZhciBvYmogPSB0aGlzLl93cmFwcGVkOwoJICAgICAgbWV0aG9kLmFwcGx5KG9iaiwgYXJndW1lbnRzKTsKCSAgICAgIGlmICgobmFtZSA9PT0gJ3NoaWZ0JyB8fCBuYW1lID09PSAnc3BsaWNlJykgJiYgb2JqLmxlbmd0aCA9PT0gMCkgZGVsZXRlIG9ialswXTsKCSAgICAgIHJldHVybiByZXN1bHQodGhpcywgb2JqKTsKCSAgICB9OwoJICB9KTsKCgkgIC8vIEFkZCBhbGwgYWNjZXNzb3IgQXJyYXkgZnVuY3Rpb25zIHRvIHRoZSB3cmFwcGVyLgoJICBfLmVhY2goWydjb25jYXQnLCAnam9pbicsICdzbGljZSddLCBmdW5jdGlvbihuYW1lKSB7CgkgICAgdmFyIG1ldGhvZCA9IEFycmF5UHJvdG9bbmFtZV07CgkgICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKCSAgICAgIHJldHVybiByZXN1bHQodGhpcywgbWV0aG9kLmFwcGx5KHRoaXMuX3dyYXBwZWQsIGFyZ3VtZW50cykpOwoJICAgIH07CgkgIH0pOwoKCSAgLy8gRXh0cmFjdHMgdGhlIHJlc3VsdCBmcm9tIGEgd3JhcHBlZCBhbmQgY2hhaW5lZCBvYmplY3QuCgkgIF8ucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24oKSB7CgkgICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7CgkgIH07CgoJICAvLyBQcm92aWRlIHVud3JhcHBpbmcgcHJveHkgZm9yIHNvbWUgbWV0aG9kcyB1c2VkIGluIGVuZ2luZSBvcGVyYXRpb25zCgkgIC8vIHN1Y2ggYXMgYXJpdGhtZXRpYyBhbmQgSlNPTiBzdHJpbmdpZmljYXRpb24uCgkgIF8ucHJvdG90eXBlLnZhbHVlT2YgPSBfLnByb3RvdHlwZS50b0pTT04gPSBfLnByb3RvdHlwZS52YWx1ZTsKCgkgIF8ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CgkgICAgcmV0dXJuICcnICsgdGhpcy5fd3JhcHBlZDsKCSAgfTsKCgkgIC8vIEFNRCByZWdpc3RyYXRpb24gaGFwcGVucyBhdCB0aGUgZW5kIGZvciBjb21wYXRpYmlsaXR5IHdpdGggQU1EIGxvYWRlcnMKCSAgLy8gdGhhdCBtYXkgbm90IGVuZm9yY2UgbmV4dC10dXJuIHNlbWFudGljcyBvbiBtb2R1bGVzLiBFdmVuIHRob3VnaCBnZW5lcmFsCgkgIC8vIHByYWN0aWNlIGZvciBBTUQgcmVnaXN0cmF0aW9uIGlzIHRvIGJlIGFub255bW91cywgdW5kZXJzY29yZSByZWdpc3RlcnMKCSAgLy8gYXMgYSBuYW1lZCBtb2R1bGUgYmVjYXVzZSwgbGlrZSBqUXVlcnksIGl0IGlzIGEgYmFzZSBsaWJyYXJ5IHRoYXQgaXMKCSAgLy8gcG9wdWxhciBlbm91Z2ggdG8gYmUgYnVuZGxlZCBpbiBhIHRoaXJkIHBhcnR5IGxpYiwgYnV0IG5vdCBiZSBwYXJ0IG9mCgkgIC8vIGFuIEFNRCBsb2FkIHJlcXVlc3QuIFRob3NlIGNhc2VzIGNvdWxkIGdlbmVyYXRlIGFuIGVycm9yIHdoZW4gYW4KCSAgLy8gYW5vbnltb3VzIGRlZmluZSgpIGlzIGNhbGxlZCBvdXRzaWRlIG9mIGEgbG9hZGVyIHJlcXVlc3QuCgkgIGlmICh0cnVlKSB7CgkgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7CgkgICAgICByZXR1cm4gXzsKCSAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgkgIH0KCX0uY2FsbCh0aGlzKSk7CgoKLyoqKi8gfSwKLyogOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIEphdmFTY3JpcHQgQ29va2llIHYyLjEuMAoJICogaHR0cHM6Ly9naXRodWIuY29tL2pzLWNvb2tpZS9qcy1jb29raWUKCSAqCgkgKiBDb3B5cmlnaHQgMjAwNiwgMjAxNSBLbGF1cyBIYXJ0bCAmIEZhZ25lciBCcmFjawoJICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlCgkgKi8KCShmdW5jdGlvbiAoZmFjdG9yeSkgewoJCWlmICh0cnVlKSB7CgkJCSEoX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID0gKGZhY3RvcnkpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9ICh0eXBlb2YgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID09PSAnZnVuY3Rpb24nID8gKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXy5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHMsIG1vZHVsZSkpIDogX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJCX0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7CgkJCW1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwoJCX0gZWxzZSB7CgkJCXZhciBfT2xkQ29va2llcyA9IHdpbmRvdy5Db29raWVzOwoJCQl2YXIgYXBpID0gd2luZG93LkNvb2tpZXMgPSBmYWN0b3J5KCk7CgkJCWFwaS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkgewoJCQkJd2luZG93LkNvb2tpZXMgPSBfT2xkQ29va2llczsKCQkJCXJldHVybiBhcGk7CgkJCX07CgkJfQoJfShmdW5jdGlvbiAoKSB7CgkJZnVuY3Rpb24gZXh0ZW5kICgpIHsKCQkJdmFyIGkgPSAwOwoJCQl2YXIgcmVzdWx0ID0ge307CgkJCWZvciAoOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkJCQl2YXIgYXR0cmlidXRlcyA9IGFyZ3VtZW50c1sgaSBdOwoJCQkJZm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHsKCQkJCQlyZXN1bHRba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gcmVzdWx0OwoJCX0KCgkJZnVuY3Rpb24gaW5pdCAoY29udmVydGVyKSB7CgkJCWZ1bmN0aW9uIGFwaSAoa2V5LCB2YWx1ZSwgYXR0cmlidXRlcykgewoJCQkJdmFyIHJlc3VsdDsKCgkJCQkvLyBXcml0ZQoKCQkJCWlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkgewoJCQkJCWF0dHJpYnV0ZXMgPSBleHRlbmQoewoJCQkJCQlwYXRoOiAnLycKCQkJCQl9LCBhcGkuZGVmYXVsdHMsIGF0dHJpYnV0ZXMpOwoKCQkJCQlpZiAodHlwZW9mIGF0dHJpYnV0ZXMuZXhwaXJlcyA9PT0gJ251bWJlcicpIHsKCQkJCQkJdmFyIGV4cGlyZXMgPSBuZXcgRGF0ZSgpOwoJCQkJCQlleHBpcmVzLnNldE1pbGxpc2Vjb25kcyhleHBpcmVzLmdldE1pbGxpc2Vjb25kcygpICsgYXR0cmlidXRlcy5leHBpcmVzICogODY0ZSs1KTsKCQkJCQkJYXR0cmlidXRlcy5leHBpcmVzID0gZXhwaXJlczsKCQkJCQl9CgoJCQkJCXRyeSB7CgkJCQkJCXJlc3VsdCA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTsKCQkJCQkJaWYgKC9eW1x7XFtdLy50ZXN0KHJlc3VsdCkpIHsKCQkJCQkJCXZhbHVlID0gcmVzdWx0OwoJCQkJCQl9CgkJCQkJfSBjYXRjaCAoZSkge30KCgkJCQkJaWYgKCFjb252ZXJ0ZXIud3JpdGUpIHsKCQkJCQkJdmFsdWUgPSBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHZhbHVlKSkKCQkJCQkJCS5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDNBfDNDfDNFfDNEfDJGfDNGfDQwfDVCfDVEfDVFfDYwfDdCfDdEfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXZhbHVlID0gY29udmVydGVyLndyaXRlKHZhbHVlLCBrZXkpOwoJCQkJCX0KCgkJCQkJa2V5ID0gZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhrZXkpKTsKCQkJCQlrZXkgPSBrZXkucmVwbGFjZSgvJSgyM3wyNHwyNnwyQnw1RXw2MHw3QykvZywgZGVjb2RlVVJJQ29tcG9uZW50KTsKCQkJCQlrZXkgPSBrZXkucmVwbGFjZSgvW1woXCldL2csIGVzY2FwZSk7CgoJCQkJCXJldHVybiAoZG9jdW1lbnQuY29va2llID0gWwoJCQkJCQlrZXksICc9JywgdmFsdWUsCgkJCQkJCWF0dHJpYnV0ZXMuZXhwaXJlcyAmJiAnOyBleHBpcmVzPScgKyBhdHRyaWJ1dGVzLmV4cGlyZXMudG9VVENTdHJpbmcoKSwgLy8gdXNlIGV4cGlyZXMgYXR0cmlidXRlLCBtYXgtYWdlIGlzIG5vdCBzdXBwb3J0ZWQgYnkgSUUKCQkJCQkJYXR0cmlidXRlcy5wYXRoICAgICYmICc7IHBhdGg9JyArIGF0dHJpYnV0ZXMucGF0aCwKCQkJCQkJYXR0cmlidXRlcy5kb21haW4gICYmICc7IGRvbWFpbj0nICsgYXR0cmlidXRlcy5kb21haW4sCgkJCQkJCWF0dHJpYnV0ZXMuc2VjdXJlID8gJzsgc2VjdXJlJyA6ICcnCgkJCQkJXS5qb2luKCcnKSk7CgkJCQl9CgoJCQkJLy8gUmVhZAoKCQkJCWlmICgha2V5KSB7CgkJCQkJcmVzdWx0ID0ge307CgkJCQl9CgoJCQkJLy8gVG8gcHJldmVudCB0aGUgZm9yIGxvb3AgaW4gdGhlIGZpcnN0IHBsYWNlIGFzc2lnbiBhbiBlbXB0eSBhcnJheQoJCQkJLy8gaW4gY2FzZSB0aGVyZSBhcmUgbm8gY29va2llcyBhdCBhbGwuIEFsc28gcHJldmVudHMgb2RkIHJlc3VsdCB3aGVuCgkJCQkvLyBjYWxsaW5nICJnZXQoKSIKCQkJCXZhciBjb29raWVzID0gZG9jdW1lbnQuY29va2llID8gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7ICcpIDogW107CgkJCQl2YXIgcmRlY29kZSA9IC8oJVswLTlBLVpdezJ9KSsvZzsKCQkJCXZhciBpID0gMDsKCgkJCQlmb3IgKDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHsKCQkJCQl2YXIgcGFydHMgPSBjb29raWVzW2ldLnNwbGl0KCc9Jyk7CgkJCQkJdmFyIG5hbWUgPSBwYXJ0c1swXS5yZXBsYWNlKHJkZWNvZGUsIGRlY29kZVVSSUNvbXBvbmVudCk7CgkJCQkJdmFyIGNvb2tpZSA9IHBhcnRzLnNsaWNlKDEpLmpvaW4oJz0nKTsKCgkJCQkJaWYgKGNvb2tpZS5jaGFyQXQoMCkgPT09ICciJykgewoJCQkJCQljb29raWUgPSBjb29raWUuc2xpY2UoMSwgLTEpOwoJCQkJCX0KCgkJCQkJdHJ5IHsKCQkJCQkJY29va2llID0gY29udmVydGVyLnJlYWQgPwoJCQkJCQkJY29udmVydGVyLnJlYWQoY29va2llLCBuYW1lKSA6IGNvbnZlcnRlcihjb29raWUsIG5hbWUpIHx8CgkJCQkJCQljb29raWUucmVwbGFjZShyZGVjb2RlLCBkZWNvZGVVUklDb21wb25lbnQpOwoKCQkJCQkJaWYgKHRoaXMuanNvbikgewoJCQkJCQkJdHJ5IHsKCQkJCQkJCQljb29raWUgPSBKU09OLnBhcnNlKGNvb2tpZSk7CgkJCQkJCQl9IGNhdGNoIChlKSB7fQoJCQkJCQl9CgoJCQkJCQlpZiAoa2V5ID09PSBuYW1lKSB7CgkJCQkJCQlyZXN1bHQgPSBjb29raWU7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoKCQkJCQkJaWYgKCFrZXkpIHsKCQkJCQkJCXJlc3VsdFtuYW1lXSA9IGNvb2tpZTsKCQkJCQkJfQoJCQkJCX0gY2F0Y2ggKGUpIHt9CgkJCQl9CgoJCQkJcmV0dXJuIHJlc3VsdDsKCQkJfQoKCQkJYXBpLmdldCA9IGFwaS5zZXQgPSBhcGk7CgkJCWFwaS5nZXRKU09OID0gZnVuY3Rpb24gKCkgewoJCQkJcmV0dXJuIGFwaS5hcHBseSh7CgkJCQkJanNvbjogdHJ1ZQoJCQkJfSwgW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTsKCQkJfTsKCQkJYXBpLmRlZmF1bHRzID0ge307CgoJCQlhcGkucmVtb3ZlID0gZnVuY3Rpb24gKGtleSwgYXR0cmlidXRlcykgewoJCQkJYXBpKGtleSwgJycsIGV4dGVuZChhdHRyaWJ1dGVzLCB7CgkJCQkJZXhwaXJlczogLTEKCQkJCX0pKTsKCQkJfTsKCgkJCWFwaS53aXRoQ29udmVydGVyID0gaW5pdDsKCgkJCXJldHVybiBhcGk7CgkJfQoKCQlyZXR1cm4gaW5pdChmdW5jdGlvbiAoKSB7fSk7Cgl9KSk7CgoKLyoqKi8gfSwKLyogMTAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJIShtb2R1bGUuZXhwb3J0cyA9IHsKCSAgImNvdW50cnkiOiAiY291bnRyeS5kNTUzZTRkYWVkOWQwYzRjMzc4YTMwZDc3ZDlmN2UzYyIsCgkgICJjb3VudHJ5X2NzIjogImNvdW50cnlfY3MuODZhNmU3OTQ4MTQ5Nzg1NTBmZTNkMDBiMmUwMmExY2IiLAoJICAiY291bnRyeV9kYSI6ICJjb3VudHJ5X2RhLjEzOThlOWE5YTM2YTg4ODFjOTJmNDRiYmQyNzQ2MjVmIiwKCSAgImNvdW50cnlfZGUiOiAiY291bnRyeV9kZS4zNjIzZWE4NjBiYjk4MmYzNWJlODhkNzMzZjg1MDM0YSIsCgkgICJjb3VudHJ5X2VzIjogImNvdW50cnlfZXMuMzIwNzE2OWIwYzUzMDdjNDE0ZmY5YTBlMDc2MTNkMzIiLAoJICAiY291bnRyeV9maSI6ICJjb3VudHJ5X2ZpLjM4YjNiY2YwNWE0MmE2YzQ0MDg1YWE1NWM3MzU3Mjk5IiwKCSAgImNvdW50cnlfZnIiOiAiY291bnRyeV9mci45NjA2ZTgyNjBlYjA5NDQ3NWY1ZDNlY2NhOGRlZjE0YiIsCgkgICJjb3VudHJ5X2h1IjogImNvdW50cnlfaHUuNzVmNDIxNGRmNTE0MWNlZDMwMGQ2NGZlZTBjOTExMWUiLAoJICAiY291bnRyeV9pZCI6ICJjb3VudHJ5X2lkLjAxOTM5MTMyMTJmMWZiNzBiOWQyMzRhMjk3OTQyMzhjIiwKCSAgImNvdW50cnlfaW4iOiAiY291bnRyeV9pbi4wMTkzOTEzMjEyZjFmYjcwYjlkMjM0YTI5Nzk0MjM4YyIsCgkgICJjb3VudHJ5X2l0IjogImNvdW50cnlfaXQuMjdhNzU3ZjEzZmUwZmNkYjg0YmZiYmJjYjRhNGM0NjUiLAoJICAiY291bnRyeV9qYSI6ICJjb3VudHJ5X2phLmVhOWUxMTRkY2M3MGIyMjhjYmRhZWY1ZjRlNmMwODVkIiwKCSAgImNvdW50cnlfa28iOiAiY291bnRyeV9rby5lYzhmMzkwMjBhYzk0NzdlMmY4MDBiODY1N2ZmNjhlNiIsCgkgICJjb3VudHJ5X21zIjogImNvdW50cnlfbXMuNGQ0OTJhMzlkZGJlNjEwYTgyMjJkZjMyYzM0MWQ1MTQiLAoJICAiY291bnRyeV9ubF9OTCI6ICJjb3VudHJ5X25sX05MLjNlZjE1YjlhYmMxZDM3MGY3NzU4YmRmZDBkNmE3MzZhIiwKCSAgImNvdW50cnlfcGwiOiAiY291bnRyeV9wbC4zOGYwNzFjYTk3MjQ2ODkwMzRmYTAxNGIxNTNiNjM4NyIsCgkgICJjb3VudHJ5X3B0X0JSIjogImNvdW50cnlfcHRfQlIuNDZkMWM1YTJmZDBjYTg4NGVhNTk5MzY5NWJkNTJkNzIiLAoJICAiY291bnRyeV9ybyI6ICJjb3VudHJ5X3JvLmEzM2Q3YTQ3NjA1MDZhNWQwMmZmMDg0ODE5YmI2MTEwIiwKCSAgImNvdW50cnlfcnUiOiAiY291bnRyeV9ydS5jYWI3MGIxM2E4N2Y5ZDI3NGJiZWU4YzVhZDc5NDExYyIsCgkgICJjb3VudHJ5X3N2IjogImNvdW50cnlfc3YuYjI4NjlhOTkyY2Y0NjYwZDAwMDBmMzE4MGYxYjdlMjEiLAoJICAiY291bnRyeV90aCI6ICJjb3VudHJ5X3RoLmM2N2FlZWU5OGRhMDUxOWI0ZTA1MWVhMDMwOTAzMzIyIiwKCSAgImNvdW50cnlfdWsiOiAiY291bnRyeV91ay44OWVlYTU2ZDE5N2VlMzY5M2I0ZjY1ZGQwZDhkM2E2YSIsCgkgICJjb3VudHJ5X3poX0NOIjogImNvdW50cnlfemhfQ04uMDZmYzVhZTEzYTQ5ZTI0Y2UwYzZiZjc2M2E5NjcwMTYiLAoJICAiY291bnRyeV96aF9UVyI6ICJjb3VudHJ5X3poX1RXLmJmNjNmZDc2MmMxZmUxZTI1ZjVhOGY0YzQ5MzUyOWU1IiwKCSAgImxvZ2luIjogImxvZ2luLjFlYTgxZDA3OWUzNjg4MjgxNmM1OTkyNjg1M2FjNzQyIiwKCSAgImxvZ2luX2NzIjogImxvZ2luX2NzLjQxMmU2ZjJkMTc1MzcyZDAzM2Q1YWRjYzEwYTM0MzUyIiwKCSAgImxvZ2luX2RhIjogImxvZ2luX2RhLjk2YTA4MjM0MmVlZmQwNzM0MjlmNzk5MWVmYWNkMGRkIiwKCSAgImxvZ2luX2RlIjogImxvZ2luX2RlLmI4NzM3NGM3MDc2ZTYxMWZlNDRkZGIzMWY3NDlmYmUxIiwKCSAgImxvZ2luX2VzIjogImxvZ2luX2VzLjM0N2RlYTQxZmNmYWRmYzdjYjk3NDI2NzkyNzY0NGY2IiwKCSAgImxvZ2luX2ZpIjogImxvZ2luX2ZpLjA0M2QzOTdmZTJjYTcxOGE4Y2NkNWM5Y2Q5ZTNiNzk0IiwKCSAgImxvZ2luX2ZyIjogImxvZ2luX2ZyLmE0NjYzZDk1MWU2MGU3MTE4YTE1OTdiMmUwZTM3NjkwIiwKCSAgImxvZ2luX2h1IjogImxvZ2luX2h1LjFhYTJiM2RhNjAwMGE3Yjg1NjM3YTQyNGVhNWI4YjZjIiwKCSAgImxvZ2luX2lkIjogImxvZ2luX2lkLjM1YzIwZjBmOWRjZjA2YjVjNDg1Y2Q4YTk2MTFlNmJlIiwKCSAgImxvZ2luX2luIjogImxvZ2luX2luLjM1YzIwZjBmOWRjZjA2YjVjNDg1Y2Q4YTk2MTFlNmJlIiwKCSAgImxvZ2luX2l0IjogImxvZ2luX2l0LjM5MmEyZDM3YTU2NzRkYmQ0ODlkYTlmZDczNjZjMTY2IiwKCSAgImxvZ2luX2phIjogImxvZ2luX2phLjRlMjlkYjc4M2M2ODUwZWIwODYwNjliZTQ1NGJjN2M2IiwKCSAgImxvZ2luX2tvIjogImxvZ2luX2tvLjdlMDRiYjc4YWI3MmFiOGEzNTA3YWU5MjEyMDcxMTdhIiwKCSAgImxvZ2luX21zIjogImxvZ2luX21zLjBkMWNlMzhiMTNiMGIxZTZiOWZhNjc0ZDRjMWUxNjI3IiwKCSAgImxvZ2luX25sX05MIjogImxvZ2luX25sX05MLjIzNmEzZDU1ZjM1YTliNDFkMjFjZjY0Mzg2MGY5ODkwIiwKCSAgImxvZ2luX3BsIjogImxvZ2luX3BsLjFkNGZiNzVlMmY2NDk2NDdkOTJhZWRjMzg1ZTY3YWEzIiwKCSAgImxvZ2luX3B0X0JSIjogImxvZ2luX3B0X0JSLjNiMWJkZDcyOTAwZDE0M2M0MDE1NDY3OWY4MDFjZmI0IiwKCSAgImxvZ2luX3JvIjogImxvZ2luX3JvLjgzZDU5YWU5MjMxYTc5ZjZmYjBlZTAxNmJiYjY0OWM0IiwKCSAgImxvZ2luX3J1IjogImxvZ2luX3J1LjBkYmI1YWEzM2E3NDAxZDFjNDhlOWNhZjY2MjQ5YzdiIiwKCSAgImxvZ2luX3N2IjogImxvZ2luX3N2LmRjY2EzODhhNTc2ODg0MzA2MmExYTFmMGMwODIwZTk3IiwKCSAgImxvZ2luX3RoIjogImxvZ2luX3RoLjE1ZmJmZmFkZjY0NTc0ZmRiZmJiZDMxZWMwMDZmMjI2IiwKCSAgImxvZ2luX3VrIjogImxvZ2luX3VrLmEzNmRiZWIwMTM2ZmM5ODVmOTQ3MTMwYWY1M2ExMWUxIiwKCSAgImxvZ2luX3poX0NOIjogImxvZ2luX3poX0NOLmM1NjljOTVjM2EzNGExNzJiOWEyMzkyNzhjMDY5YjA3IiwKCSAgImxvZ2luX3poX1RXIjogImxvZ2luX3poX1RXLmNkYmY0Y2M0ZWZhOWUwOGQwNGEwMmUyYTEzYTJlYmY1IgoJfSk7CgovKioqLyB9LAovKiAxMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyohCgkgKiBqUXVlcnkgQnJvd3NlciBQbHVnaW4gMC4xLjAKCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nYWJjZWIvanF1ZXJ5LWJyb3dzZXItcGx1Z2luCgkgKgoJICogT3JpZ2luYWwganF1ZXJ5LWJyb3dzZXIgY29kZSBDb3B5cmlnaHQgMjAwNSwgMjAxNSBqUXVlcnkgRm91bmRhdGlvbiwgSW5jLiBhbmQgb3RoZXIgY29udHJpYnV0b3JzCgkgKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCgkgKgoJICogTW9kaWZpY2F0aW9ucyBDb3B5cmlnaHQgMjAxNSBHYWJyaWVsIENlYnJpYW4KCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nYWJjZWIKCSAqCgkgKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UKCSAqCgkgKiBEYXRlOiAwNS0wNy0yMDE1CgkgKi8KCS8qZ2xvYmFsIHdpbmRvdzogZmFsc2UgKi8KCgkoZnVuY3Rpb24gKGZhY3RvcnkpIHsKCSAgaWYgKHRydWUpIHsKCSAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuCgkgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18oNCldLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uICgkKSB7CgkgICAgICByZXR1cm4gZmFjdG9yeSgkKTsKCSAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgkgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAnb2JqZWN0JykgewoJICAgIC8vIE5vZGUtbGlrZSBlbnZpcm9ubWVudAoJICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKCdqcXVlcnknKSk7CgkgIH0gZWxzZSB7CgkgICAgLy8gQnJvd3NlciBnbG9iYWxzCgkgICAgZmFjdG9yeSh3aW5kb3cualF1ZXJ5KTsKCSAgfQoJfShmdW5jdGlvbihqUXVlcnkpIHsKCSAgInVzZSBzdHJpY3QiOwoKCSAgZnVuY3Rpb24gdWFNYXRjaCggdWEgKSB7CgkgICAgLy8gSWYgYW4gVUEgaXMgbm90IHByb3ZpZGVkLCBkZWZhdWx0IHRvIHRoZSBjdXJyZW50IGJyb3dzZXIgVUEuCgkgICAgaWYgKCB1YSA9PT0gdW5kZWZpbmVkICkgewoJICAgICAgdWEgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDsKCSAgICB9CgkgICAgdWEgPSB1YS50b0xvd2VyQ2FzZSgpOwoKCSAgICB2YXIgbWF0Y2ggPSAvKGVkZ2UpXC8oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKG9wcilbXC9dKFtcdy5dKykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhjaHJvbWUpWyBcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGllbW9iaWxlKVtcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKHZlcnNpb24pKGFwcGxld2Via2l0KVsgXC9dKFtcdy5dKykuKihzYWZhcmkpWyBcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKHdlYmtpdClbIFwvXShbXHcuXSspLioodmVyc2lvbilbIFwvXShbXHcuXSspLiooc2FmYXJpKVsgXC9dKFtcdy5dKykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyh3ZWJraXQpWyBcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKG9wZXJhKSg/Oi4qdmVyc2lvbnwpWyBcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKG1zaWUpIChbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIHVhLmluZGV4T2YoInRyaWRlbnQiKSA+PSAwICYmIC8ocnYpKD86OnwgKShbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIHVhLmluZGV4T2YoImNvbXBhdGlibGUiKSA8IDAgJiYgLyhtb3ppbGxhKSg/Oi4qPyBydjooW1x3Ll0rKXwpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIFtdOwoKCSAgICB2YXIgcGxhdGZvcm1fbWF0Y2ggPSAvKGlwYWQpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8oaXBvZCkvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyh3aW5kb3dzIHBob25lKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGlwaG9uZSkvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhraW5kbGUpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8oc2lsaykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhhbmRyb2lkKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKHdpbikvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhtYWMpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8obGludXgpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8oY3JvcykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhwbGF5Ym9vaykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhiYikvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhibGFja2JlcnJ5KS8uZXhlYyggdWEgKSB8fAoJICAgICAgICBbXTsKCgkgICAgdmFyIGJyb3dzZXIgPSB7fSwKCSAgICAgICAgbWF0Y2hlZCA9IHsKCSAgICAgICAgICBicm93c2VyOiBtYXRjaFsgNSBdIHx8IG1hdGNoWyAzIF0gfHwgbWF0Y2hbIDEgXSB8fCAiIiwKCSAgICAgICAgICB2ZXJzaW9uOiBtYXRjaFsgMiBdIHx8IG1hdGNoWyA0IF0gfHwgIjAiLAoJICAgICAgICAgIHZlcnNpb25OdW1iZXI6IG1hdGNoWyA0IF0gfHwgbWF0Y2hbIDIgXSB8fCAiMCIsCgkgICAgICAgICAgcGxhdGZvcm06IHBsYXRmb3JtX21hdGNoWyAwIF0gfHwgIiIKCSAgICAgICAgfTsKCgkgICAgaWYgKCBtYXRjaGVkLmJyb3dzZXIgKSB7CgkgICAgICBicm93c2VyWyBtYXRjaGVkLmJyb3dzZXIgXSA9IHRydWU7CgkgICAgICBicm93c2VyLnZlcnNpb24gPSBtYXRjaGVkLnZlcnNpb247CgkgICAgICBicm93c2VyLnZlcnNpb25OdW1iZXIgPSBwYXJzZUludChtYXRjaGVkLnZlcnNpb25OdW1iZXIsIDEwKTsKCSAgICB9CgoJICAgIGlmICggbWF0Y2hlZC5wbGF0Zm9ybSApIHsKCSAgICAgIGJyb3dzZXJbIG1hdGNoZWQucGxhdGZvcm0gXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBUaGVzZSBhcmUgYWxsIGNvbnNpZGVyZWQgbW9iaWxlIHBsYXRmb3JtcywgbWVhbmluZyB0aGV5IHJ1biBhIG1vYmlsZSBicm93c2VyCgkgICAgaWYgKCBicm93c2VyLmFuZHJvaWQgfHwgYnJvd3Nlci5iYiB8fCBicm93c2VyLmJsYWNrYmVycnkgfHwgYnJvd3Nlci5pcGFkIHx8IGJyb3dzZXIuaXBob25lIHx8CgkgICAgICBicm93c2VyLmlwb2QgfHwgYnJvd3Nlci5raW5kbGUgfHwgYnJvd3Nlci5wbGF5Ym9vayB8fCBicm93c2VyLnNpbGsgfHwgYnJvd3NlclsgIndpbmRvd3MgcGhvbmUiIF0pIHsKCSAgICAgIGJyb3dzZXIubW9iaWxlID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIFRoZXNlIGFyZSBhbGwgY29uc2lkZXJlZCBkZXNrdG9wIHBsYXRmb3JtcywgbWVhbmluZyB0aGV5IHJ1biBhIGRlc2t0b3AgYnJvd3NlcgoJICAgIGlmICggYnJvd3Nlci5jcm9zIHx8IGJyb3dzZXIubWFjIHx8IGJyb3dzZXIubGludXggfHwgYnJvd3Nlci53aW4gKSB7CgkgICAgICBicm93c2VyLmRlc2t0b3AgPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gQ2hyb21lLCBPcGVyYSAxNSsgYW5kIFNhZmFyaSBhcmUgd2Via2l0IGJhc2VkIGJyb3dzZXJzCgkgICAgaWYgKCBicm93c2VyLmNocm9tZSB8fCBicm93c2VyLm9wciB8fCBicm93c2VyLnNhZmFyaSApIHsKCSAgICAgIGJyb3dzZXIud2Via2l0ID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIElFMTEgaGFzIGEgbmV3IHRva2VuIHNvIHdlIHdpbGwgYXNzaWduIGl0IG1zaWUgdG8gYXZvaWQgYnJlYWtpbmcgY2hhbmdlcwoJICAgIGlmICggYnJvd3Nlci5ydiB8fCBicm93c2VyLmllbW9iaWxlKSB7CgkgICAgICB2YXIgaWUgPSAibXNpZSI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0gaWU7CgkgICAgICBicm93c2VyW2llXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBFZGdlIGlzIG9mZmljaWFsbHkga25vd24gYXMgTWljcm9zb2Z0IEVkZ2UsIHNvIHJld3JpdGUgdGhlIGtleSB0byBtYXRjaAoJICAgIGlmICggYnJvd3Nlci5lZGdlICkgewoJICAgICAgZGVsZXRlIGJyb3dzZXIuZWRnZTsKCSAgICAgIHZhciBtc2VkZ2UgPSAibXNlZGdlIjsKCgkgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBtc2VkZ2U7CgkgICAgICBicm93c2VyW21zZWRnZV0gPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gQmxhY2tiZXJyeSBicm93c2VycyBhcmUgbWFya2VkIGFzIFNhZmFyaSBvbiBCbGFja0JlcnJ5CgkgICAgaWYgKCBicm93c2VyLnNhZmFyaSAmJiBicm93c2VyLmJsYWNrYmVycnkgKSB7CgkgICAgICB2YXIgYmxhY2tiZXJyeSA9ICJibGFja2JlcnJ5IjsKCgkgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBibGFja2JlcnJ5OwoJICAgICAgYnJvd3NlcltibGFja2JlcnJ5XSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBQbGF5Ym9vayBicm93c2VycyBhcmUgbWFya2VkIGFzIFNhZmFyaSBvbiBQbGF5Ym9vawoJICAgIGlmICggYnJvd3Nlci5zYWZhcmkgJiYgYnJvd3Nlci5wbGF5Ym9vayApIHsKCSAgICAgIHZhciBwbGF5Ym9vayA9ICJwbGF5Ym9vayI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0gcGxheWJvb2s7CgkgICAgICBicm93c2VyW3BsYXlib29rXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBCQjEwIGlzIGEgbmV3ZXIgT1MgdmVyc2lvbiBvZiBCbGFja0JlcnJ5CgkgICAgaWYgKCBicm93c2VyLmJiICkgewoJICAgICAgdmFyIGJiID0gImJsYWNrYmVycnkiOwoKCSAgICAgIG1hdGNoZWQuYnJvd3NlciA9IGJiOwoJICAgICAgYnJvd3NlcltiYl0gPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gT3BlcmEgMTUrIGFyZSBpZGVudGlmaWVkIGFzIG9wcgoJICAgIGlmICggYnJvd3Nlci5vcHIgKSB7CgkgICAgICB2YXIgb3BlcmEgPSAib3BlcmEiOwoKCSAgICAgIG1hdGNoZWQuYnJvd3NlciA9IG9wZXJhOwoJICAgICAgYnJvd3NlcltvcGVyYV0gPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gU3RvY2sgQW5kcm9pZCBicm93c2VycyBhcmUgbWFya2VkIGFzIFNhZmFyaSBvbiBBbmRyb2lkLgoJICAgIGlmICggYnJvd3Nlci5zYWZhcmkgJiYgYnJvd3Nlci5hbmRyb2lkICkgewoJICAgICAgdmFyIGFuZHJvaWQgPSAiYW5kcm9pZCI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0gYW5kcm9pZDsKCSAgICAgIGJyb3dzZXJbYW5kcm9pZF0gPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gS2luZGxlIGJyb3dzZXJzIGFyZSBtYXJrZWQgYXMgU2FmYXJpIG9uIEtpbmRsZQoJICAgIGlmICggYnJvd3Nlci5zYWZhcmkgJiYgYnJvd3Nlci5raW5kbGUgKSB7CgkgICAgICB2YXIga2luZGxlID0gImtpbmRsZSI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0ga2luZGxlOwoJICAgICAgYnJvd3NlcltraW5kbGVdID0gdHJ1ZTsKCSAgICB9CgoJICAgICAvLyBLaW5kbGUgU2lsayBicm93c2VycyBhcmUgbWFya2VkIGFzIFNhZmFyaSBvbiBLaW5kbGUKCSAgICBpZiAoIGJyb3dzZXIuc2FmYXJpICYmIGJyb3dzZXIuc2lsayApIHsKCSAgICAgIHZhciBzaWxrID0gInNpbGsiOwoKCSAgICAgIG1hdGNoZWQuYnJvd3NlciA9IHNpbGs7CgkgICAgICBicm93c2VyW3NpbGtdID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIEFzc2lnbiB0aGUgbmFtZSBhbmQgcGxhdGZvcm0gdmFyaWFibGUKCSAgICBicm93c2VyLm5hbWUgPSBtYXRjaGVkLmJyb3dzZXI7CgkgICAgYnJvd3Nlci5wbGF0Zm9ybSA9IG1hdGNoZWQucGxhdGZvcm07CgkgICAgcmV0dXJuIGJyb3dzZXI7CgkgIH0KCgkgIC8vIFJ1biB0aGUgbWF0Y2hpbmcgcHJvY2VzcywgYWxzbyBhc3NpZ24gdGhlIGZ1bmN0aW9uIHRvIHRoZSByZXR1cm5lZCBvYmplY3QKCSAgLy8gZm9yIG1hbnVhbCwgalF1ZXJ5LWZyZWUgdXNlIGlmIGRlc2lyZWQKCSAgd2luZG93LmpRQnJvd3NlciA9IHVhTWF0Y2goIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50ICk7CgkgIHdpbmRvdy5qUUJyb3dzZXIudWFNYXRjaCA9IHVhTWF0Y2g7CgoJICAvLyBPbmx5IGFzc2lnbiB0byBqUXVlcnkuYnJvd3NlciBpZiBqUXVlcnkgaXMgbG9hZGVkCgkgIGlmICggalF1ZXJ5ICkgewoJICAgIGpRdWVyeS5icm93c2VyID0gd2luZG93LmpRQnJvd3NlcjsKCSAgfQoKCSAgcmV0dXJuIHdpbmRvdy5qUUJyb3dzZXI7Cgl9KSk7CgoKLyoqKi8gfSwKLyogMTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOyd1c2Ugc3RyaWN0JzsKCgkvLyBTaW1wbGUgY2xhc3MgdGhhdCBwb3N0cyBsb2dpbiBkYXRhIHRvIHRoZSBhY2NvdW50IGNob29zZXIgZGlzY292ZXJ5IHVybCBvbgoJLy8gc3VjY2Vzc2Z1bCBsb2dpbnMuIFRoaXMgdXJsIGlzIGEgY3Jvc3Mgb3JpZ2luIG9rdGEgZG9tYWluIHRoYXQgY2FuIGJlCgkvLyBhY2Nlc3NlZCBieSBhbnkgb2t0YSBvcmlnaW4gaW50ZXJlc3RlZCBpbiBzZWVpbmcgd2hpY2ggYWNjb3VudHMgdGhlIGN1cnJlbnQKCS8vIHVzZXIgaGFzIHNpZ25lZCBpbnRvLgoJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18oNCksIF9fd2VicGFja19yZXF1aXJlX18oNSldLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uICgkLCBIYW5kbGViYXJzKSB7CgoJICAvLyBNYXggdGltZSB0byB3YWl0IGZvciBhIHJlc3BvbnNlIGZyb20gYWNjb3VudCBjaG9vc2VyIGlmcmFtZSBhZnRlcgoJICAvLyBsb2dpbiBtZXNzYWdlIGlzIHNlbnQuCgkgIHZhciBNQVhfV0FJVCA9IDEwMDA7CgoJICB2YXIgaWZyYW1lVHBsID0gSGFuZGxlYmFycy5jb21waWxlKCdcCgkgICAgPGlmcmFtZSBkYXRhLXNlPSJhY2NvdW50LWNob29zZXIiIHNyYz0ie3tzcmN9fSIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+PC9pZnJhbWU+XAoJICAnKTsKCgkgIGZ1bmN0aW9uIEFjY291bnRDaG9vc2VyKG9wdGlvbnMpIHsKCSAgICB2YXIgaWZyYW1lID0gJChpZnJhbWVUcGwoeyBzcmM6IG9wdGlvbnMuZGlzY292ZXJ5VXJsIH0pKTsKCSAgICB0aGlzLmRpc2NvdmVyeVVybCA9IG9wdGlvbnMuZGlzY292ZXJ5VXJsOwoJICAgIHRoaXMuaWZyYW1lID0gaWZyYW1lLmdldCgwKTsKCSAgICAkKGZ1bmN0aW9uICgpIHsKCSAgICAgICQoJ2JvZHknKS5hcHBlbmQoaWZyYW1lKTsKCSAgICB9KTsKCSAgfQoKCSAgLy8gUG9zdHMgbG9naW4gbWVzc2FnZSB0byBhY2NvdW50IGNob29zZXIgaWZyYW1lLiBUaGUgYWNjb3VudCBjaG9vc2VyCgkgIC8vIHdpbGwgc3RvcmUgdGhpcyBkYXRhIGluIGxvY2FsU3RvcmFnZSBmb3IgZnV0dXJlIGNyb3NzIG9yaWdpbiBhY2Nlc3MuCgkgIEFjY291bnRDaG9vc2VyLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uICh1c2VyUHJvZmlsZSwgY2IpIHsKCSAgICB2YXIgbXNnLCBtYXRjaGVzLCB0YXJnZXRPcmlnaW4sIG1heFRpbWVvdXQ7CgoJICAgIG1zZyA9IHsKCSAgICAgIG1lc3NhZ2VUeXBlOiAnbG9naW4nLAoJICAgICAgZGlzcGxheU5hbWU6IHVzZXJQcm9maWxlLmZpcnN0TmFtZSArICcgJyArIHVzZXJQcm9maWxlLmxhc3ROYW1lLAoJICAgICAgbG9naW46IHVzZXJQcm9maWxlLmxvZ2luCgkgICAgfTsKCgkgICAgLy8gQXV0b21hdGljYWxseSByZWRpcmVjdCBhZnRlciBNQVhfV0FJVCBtcyBpbiB0aGUgZXZlbnQgdGhhdCB0aGUgYWNjb3VudAoJICAgIC8vIGNob29zZXIgZG9tYWluIGlzIHRvbyBzbG93IHRvIHJlc3BvbmQuCgkgICAgbWF4VGltZW91dCA9IHNldFRpbWVvdXQoY2IsIE1BWF9XQUlUKTsKCgkgICAgbWF0Y2hlcyA9IG5ldyBSZWdFeHAoJ15odHRwcz86Ly9bXi9dKycpLmV4ZWModGhpcy5kaXNjb3ZlcnlVcmwpOwoJICAgIHRhcmdldE9yaWdpbiA9IG1hdGNoZXMgPyBtYXRjaGVzWzBdIDogbnVsbDsKCgkgICAgaWYgKHRhcmdldE9yaWdpbikgewoJICAgICAgLy8gMS4gU2V0dXAgdGhlIHJlc3BvbnNlIG1lc3NhZ2UgaGFuZGxlcgoJICAgICAgJCh3aW5kb3cpLm9uKCdtZXNzYWdlLmFjY291bnRDaG9vc2VyJywgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgLy8gT25seSBsaXN0ZW4gdG8gbWVzc2FnZXMgZnJvbSB0aGUgZGlzY292ZXJ5IGRvbWFpbgoJICAgICAgICBpZiAoZS5vcmlnaW5hbEV2ZW50Lm9yaWdpbiAhPT0gdGFyZ2V0T3JpZ2luKSB7CgkgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGlmIChlLm9yaWdpbmFsRXZlbnQuZGF0YS5tZXNzYWdlVHlwZSA9PT0gJ3Byb2Nlc3NlZF9sb2dpbicpIHsKCSAgICAgICAgICAkKHdpbmRvdykub2ZmKCdtZXNzYWdlLmFjY291bnRDaG9vc2VyJyk7CgkgICAgICAgICAgY2xlYXJUaW1lb3V0KG1heFRpbWVvdXQpOwoJICAgICAgICAgIGNiKCk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoKCSAgICAgIC8vIDIuIFNlbmQgdGhlIHVzZXIgcHJvZmlsZSBkYXRhIHRvIHRoZSBhY2NvdW50IGNob29zZXIgb3JpZ2luCgkgICAgICB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKG1zZywgdGFyZ2V0T3JpZ2luKTsKCSAgICB9CgkgIH07CgoJICByZXR1cm4gQWNjb3VudENob29zZXI7Cgl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgovKioqLyB9LAovKiAxMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187J3VzZSBzdHJpY3QnOwoKCS8vIFBvcnRlZCBvdmVyIGZyb20gdGhlIG9yaWdpbmFsIGltcGxlbWVudGF0aW9uOgoJLy8gL2pzL3NlY3Rpb25zL21vYmlsZS1zc28tbG9naW4uanMKCS8qIGVzbGludCBjYW1lbGNhc2U6IDAgKi8KCSEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbiAoJCwgVXRpbCwgSGFuZGxlYmFycykgewoKCSAgdmFyIHRwbCA9IEhhbmRsZWJhcnMuY29tcGlsZSwKCSAgICAgIHRva2VuVHBsID0gdHBsKCcvb2F1dGgyL3Rva2VuP2NsaWVudF9pZD17e2NsaWVudElkfX0mZ3JhbnRfdHlwZT1zZXNzaW9uJmNvZGU9e3tjbGllbnRDb2RlfX0nKSwKCSAgICAgIGNvZGVUcGwgPSB0cGwoJy9vYXV0aDIvY29kZT9jbGllbnRfaWQ9e3tjbGllbnRJZH19JyksCgkgICAgICBva3RhU1NPVHBsID0gdHBsKCdva3Rhc3NvOi8vdjEvb2F1dGgvdmFsaWRhdGUve3t1c2VyQ29kZX19JyksCgkgICAgICBva3RhVW5pdmVyc2FsTGlua1RwbCA9IHRwbCgne3tkb21haW59fS9hdXRoL29rdGFtb2JpbGUvP3NpdGVOYW1lPXt7c2l0ZU5hbWV9fSZvcmc9e3tvcmd9fScgKyAnJnVzZXJOYW1lPXt7dXNlck5hbWV9fSZhcHBOYW1lPXt7YXBwTmFtZX19JmFwcEV4dGVybmFsS2V5PXt7YXBwRXh0ZXJuYWxLZXl9fScgKyAnJmFwcExpbmtJZD17e2FwcExpbmtJZH19JnVzZXJDb2RlPXt7dXNlckNvZGV9fSZyZWRpcmVjdFVybD17e3JlZGlyZWN0VXJsfX0nICsgJyZ0aW1lb3V0SW50ZXJ2YWw9e3t0aW1lb3V0SW50ZXJ2YWx9fScpLAoJICAgICAgbW9iaWxlTGluayA9ICdodHRwczovL2l0dW5lcy5hcHBsZS5jb20vdXMvYXBwL29rdGEtbW9iaWxlL2lkNTgwNzA5MjUxP210PTgnOwoKCSAgLyogZXNsaW50IG1heC1wYXJhbXM6IFsyLCA2XSwgbWF4LXN0YXRlbWVudHM6IFsyLCAyOV0gKi8KCSAgcmV0dXJuIGZ1bmN0aW9uIGluaXRNb2JpbGVTU08oZnJvbVVyaSwgcGFyYW1zKSB7CgkgICAgdmFyIGxpbmtQYXJhbXMgPSBwYXJhbXM7CgkgICAgdmFyIG9rdGFNb2JpbGUgPSB7CgkgICAgICBjbGllbnRDb2RlOiB1bmRlZmluZWQsCgkgICAgICB1c2VyQ29kZTogdW5kZWZpbmVkLAoJICAgICAgcG9sbEludGVydmFsOiA1MDAwLAoJICAgICAgLy8gMTAgbWludHVlcyAtLSBPa3RhIE9BdXRoIGNvZGUgZXhwaXJhdGlvbiB0aW1lOyBzZWUgT2t0YU9BdXRoMjBTZXJ2aWNlLk9BVVRIX0NPREVfRVhQSVJBVElPTl9NSU5VVEVTCgkgICAgICB0aW1lb3V0SW50ZXJ2YWw6IDYwMDAwMCwKCSAgICAgIGNsaWVudElkOiAnY2FwaHhjUUtQT1ZPSUpVR0FYSUMnLAoJICAgICAgcmVxdWlyZVVzZXJUcmlnZ2VyOiB0cnVlLAoJICAgICAgbWFudWFsTG9naW46IGZhbHNlCgkgICAgfTsKCgkgICAgdmFyIHRpbWVvdXRUaW1lTXM7CgoJICAgIHZhciBzY3JlZW5zID0gewoJICAgICAgYWNjZXNzU2NyZWVuSWQ6ICdtb2JpbGVTU09fYWNjZXNzJywKCSAgICAgIG9wZW5pbmdTY3JlZW5JZDogJ21vYmlsZVNTT19vcGVuaW5nJywKCSAgICAgIGxvYWRpbmdTY3JlZW5JZDogJ21vYmlsZVNTT19sb2FkaW5nJywKCSAgICAgIHRyYWRpdGlvbmFsTG9naW5TY3JlZW5JZDogJ21vYmlsZVNTT190cmFkaXRpb25hbExvZ2luJywKCSAgICAgIGVycm9yU2NyZWVuSWQ6ICdtb2JpbGVTU09fZXJyb3InCgkgICAgfTsKCgkgICAgZnVuY3Rpb24gc2hvd1NjcmVlbihzY3JlZW5JZCkgewoJICAgICAgJC5lYWNoKHNjcmVlbnMsIGZ1bmN0aW9uIChrZXksIHZhbCkgewoJICAgICAgICAkKCcjJyArIHZhbCkudG9nZ2xlKHZhbCA9PT0gc2NyZWVuSWQpOwoJICAgICAgfSk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiB1c2VyQ29kZVN1Y2Nlc3NDYWxsYmFjayh1c2VyQ29kZSkgewoJICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBva3RhU1NPVHBsKHsgdXNlckNvZGU6IHVzZXJDb2RlIH0pOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gdXNlckNvZGVTdWNjZXNzQ2FsbGJhY2tGb3JVaW52ZXJzYWxMaW5rKGxpbmtQYXJhbXMpIHsKCSAgICAgIHZhciBsaW5rID0gb2t0YVVuaXZlcnNhbExpbmtUcGwoeyBkb21haW46IGxpbmtQYXJhbXMuZG9tYWluLAoJICAgICAgICBzaXRlTmFtZTogbGlua1BhcmFtcy5zaXRlTmFtZSwKCSAgICAgICAgb3JnOiBsaW5rUGFyYW1zLm9yZywKCSAgICAgICAgdXNlck5hbWU6IGxpbmtQYXJhbXMudXNlck5hbWUsCgkgICAgICAgIGFwcE5hbWU6IGxpbmtQYXJhbXMuYXBwTmFtZSwKCSAgICAgICAgYXBwRXh0ZXJuYWxLZXk6IGxpbmtQYXJhbXMuYXBwRXh0ZXJuYWxLZXksCgkgICAgICAgIGFwcExpbmtJZDogbGlua1BhcmFtcy5hcHBMaW5rSWQsCgkgICAgICAgIHVzZXJDb2RlOiBsaW5rUGFyYW1zLnVzZXJDb2RlLAoJICAgICAgICByZWRpcmVjdFVybDogbGlua1BhcmFtcy5yZWRpcmVjdFVybCwKCSAgICAgICAgdGltZW91dEludGVydmFsOiBva3RhTW9iaWxlLnRpbWVvdXRJbnRlcnZhbAoJICAgICAgfSk7CgkgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGxpbms7CgkgICAgfQoKCSAgICBmdW5jdGlvbiBwb2xsT25PQXV0aENvZGUoKSB7CgkgICAgICBpZiAob2t0YU1vYmlsZS5tYW51YWxMb2dpbikgewoJICAgICAgICByZXR1cm47CgkgICAgICB9CgoJICAgICAgdmFyIGN1cnJlbnRUaW1lTXMgPSBEYXRlLm5vdygpOwoJICAgICAgaWYgKHRpbWVvdXRUaW1lTXMgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50VGltZU1zID4gdGltZW91dFRpbWVNcykgewoJICAgICAgICBzaG93U2NyZWVuKHNjcmVlbnMuZXJyb3JTY3JlZW5JZCk7CgkgICAgICB9CgoJICAgICAgaWYgKG9rdGFNb2JpbGUudGltZW91dFRpbWVNcyA9PT0gdW5kZWZpbmVkIHx8IGN1cnJlbnRUaW1lTXMgPD0gdGltZW91dFRpbWVNcyArIG9rdGFNb2JpbGUudGltZW91dEludGVydmFsICogMTApIHsKCSAgICAgICAgJC5hamF4KHsKCSAgICAgICAgICB0eXBlOiAnUE9TVCcsCgkgICAgICAgICAgdXJsOiB0b2tlblRwbCh7IGNsaWVudElkOiBva3RhTW9iaWxlLmNsaWVudElkLCBjbGllbnRDb2RlOiBva3RhTW9iaWxlLmNsaWVudENvZGUgfSksCgkgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKCSAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHsKCSAgICAgICAgICAgIGlmIChkYXRhLnNlc3Npb24gJiYgZGF0YS5zZXNzaW9uLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgVXRpbC5wb3N0VG9VcmwoZnJvbVVyaSwgJCgnYm9keScpKTsKCSAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgIHNldFRpbWVvdXQocG9sbE9uT0F1dGhDb2RlLCBva3RhTW9iaWxlLnBvbGxJbnRlcnZhbCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSwKCSAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gZXJyb3IoKSB7CgkgICAgICAgICAgICBzZXRUaW1lb3V0KHBvbGxPbk9BdXRoQ29kZSwgb2t0YU1vYmlsZS5wb2xsSW50ZXJ2YWwpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiByZXF1ZXN0T0F1dGhDb2RlKCkgewoJICAgICAgdGltZW91dFRpbWVNcyA9IERhdGUubm93KCkgKyBva3RhTW9iaWxlLnRpbWVvdXRJbnRlcnZhbDsKCSAgICAgICQuYWpheCh7CgkgICAgICAgIHR5cGU6ICdQT1NUJywKCSAgICAgICAgdXJsOiBjb2RlVHBsKHsgY2xpZW50SWQ6IG9rdGFNb2JpbGUuY2xpZW50SWQgfSksCgkgICAgICAgIGRhdGFUeXBlOiAnanNvbicsCgkgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkgewoJICAgICAgICAgIG9rdGFNb2JpbGUuY2xpZW50Q29kZSA9IGRhdGEuY2xpZW50X2NvZGU7CgkgICAgICAgICAgb2t0YU1vYmlsZS51c2VyQ29kZSA9IGRhdGEudXNlcl9jb2RlOwoKCSAgICAgICAgICBzaG93U2NyZWVuKHNjcmVlbnMub3BlbmluZ1NjcmVlbklkKTsKCSAgICAgICAgICBzZXRUaW1lb3V0KHBvbGxPbk9BdXRoQ29kZSwgb2t0YU1vYmlsZS5wb2xsSW50ZXJ2YWwpOwoJICAgICAgICAgIHVzZXJDb2RlU3VjY2Vzc0NhbGxiYWNrKGRhdGEudXNlcl9jb2RlKTsKCSAgICAgICAgfSwKCSAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKCkgewoJICAgICAgICAgIHNob3dTY3JlZW4oc2NyZWVucy5lcnJvclNjcmVlbklkKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiByZXF1ZXN0T0F1dGhDb2RlRm9yVWludmVyc2FsTGluaygpIHsKCSAgICAgIHRpbWVvdXRUaW1lTXMgPSBEYXRlLm5vdygpICsgb2t0YU1vYmlsZS50aW1lb3V0SW50ZXJ2YWw7CgkgICAgICAkLmFqYXgoewoJICAgICAgICB0eXBlOiAnUE9TVCcsCgkgICAgICAgIHVybDogY29kZVRwbCh7IGNsaWVudElkOiBva3RhTW9iaWxlLmNsaWVudElkIH0pLAoJICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAoJICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHsKCSAgICAgICAgICBva3RhTW9iaWxlLmNsaWVudENvZGUgPSBkYXRhLmNsaWVudF9jb2RlOwoJICAgICAgICAgIG9rdGFNb2JpbGUudXNlckNvZGUgPSBkYXRhLnVzZXJfY29kZTsKCSAgICAgICAgICBsaW5rUGFyYW1zLnVzZXJDb2RlID0gZGF0YS51c2VyX2NvZGU7CgoJICAgICAgICAgIHNldFRpbWVvdXQocG9sbE9uT0F1dGhDb2RlLCBva3RhTW9iaWxlLnBvbGxJbnRlcnZhbCk7CgkgICAgICAgICAgJCgnI21vYmlsZURldmljZVRydXN0TG9naW5CdXR0b24nKS5jbGljayhsYXVuY2hPa3RhTW9iaWxlRm9yVW5pdmVyc2FsTGluayk7CgkgICAgICAgICAgJCgnI21vYmlsZURldmljZVRydXN0RXhwaXJlZExvZ2luQnV0dG9uJykuY2xpY2socHVyZUxhdW5jaE9rdGFNb2JpbGVGb3JVbml2ZXJzYWxMaW5rKTsKCSAgICAgICAgfSwKCSAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKCkgewoJICAgICAgICAgIHNob3dTY3JlZW4oc2NyZWVucy5lcnJvclNjcmVlbklkKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiBsYXVuY2hPa3RhTW9iaWxlRm9yVW5pdmVyc2FsTGluaygpIHsKCSAgICAgIHNob3dTY3JlZW4oc2NyZWVucy5sb2FkaW5nU2NyZWVuSWQpOwoJICAgICAgdXNlckNvZGVTdWNjZXNzQ2FsbGJhY2tGb3JVaW52ZXJzYWxMaW5rKGxpbmtQYXJhbXMpOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gcHVyZUxhdW5jaE9rdGFNb2JpbGVGb3JVbml2ZXJzYWxMaW5rKCkgewoJICAgICAgdXNlckNvZGVTdWNjZXNzQ2FsbGJhY2tGb3JVaW52ZXJzYWxMaW5rKGxpbmtQYXJhbXMpOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gc2hvd1RyYWRpdGlvbmFsTG9naW4oKSB7CgkgICAgICAvLyBOb3RlOiBUaGlzIGRpZmZlcnMgZnJvbSB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb24gaW4gdGhhdCBpdCBqdXN0CgkgICAgICAvLyB0b2dnbGVzIHRvIHRoZSBuZXcgbG9naW4gZmxvdwoJICAgICAgLy8gMS4gUmVtb3ZlIGFsbCBzY3JlZW5zCgkgICAgICBzaG93U2NyZWVuKCk7CgkgICAgICBva3RhTW9iaWxlLm1hbnVhbExvZ2luID0gdHJ1ZTsKCSAgICAgIC8vIDIuIERpc3BsYXkgbmV3IGxvZ2luIGZsb3csIG1pbnVzIGZvb3RlcgoJICAgICAgJCgnI3NpZ25pbi1jb250YWluZXInKS5zaG93KCk7CgkgICAgICAkKCcjbW9iaWxlU1NPX292ZXJsYXknKS5oaWRlKCk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiBpbml0KCkgewoJICAgICAgaWYgKG9rdGFNb2JpbGUucmVxdWlyZVVzZXJUcmlnZ2VyID09PSBmYWxzZSkgewoJICAgICAgICBva3RhTW9iaWxlLnNob3dTY3JlZW4oc2NyZWVucy5vcGVuaW5nU2NyZWVuSWQpOwoJICAgICAgICByZXF1ZXN0T0F1dGhDb2RlKCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBpZiAobGlua1BhcmFtcyAmJiBsaW5rUGFyYW1zLmRvbWFpbikgewoJICAgICAgICAgIHJlcXVlc3RPQXV0aENvZGVGb3JVaW52ZXJzYWxMaW5rKCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgJCgnI21vYmlsZVNTT0xvZ2luQnV0dG9uJykuY2xpY2socmVxdWVzdE9BdXRoQ29kZSk7CgkgICAgICAgIH0KCSAgICAgIH0KCgkgICAgICAkKCcjZ2V0T2t0YU1vYmlsZUJ1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtb2JpbGVMaW5rOwoJICAgICAgfSk7CgoJICAgICAgJCgnI3RyYWRpdGlvbmFsTG9naW5CdXR0b24sICNyZXR1cm5Ub0xvZ2luQnV0dG9uJykuY2xpY2soc2hvd1RyYWRpdGlvbmFsTG9naW4pOwoJICAgIH0KCgkgICAgJChpbml0KTsKCSAgfTsKCX0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTsKCi8qKiovIH0sCi8qIDE0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIQoJICogalF1ZXJ5IFNtYXJ0IEJhbm5lcgoJICogQ29weXJpZ2h0IChjKSAyMDEyIEFybm9sZCBEYW5pZWxzIDxhcm5vbGRAamFzbnkubmV0PgoJICogQmFzZWQgb24gJ2pRdWVyeSBTbWFydCBXZWIgQXBwIEJhbm5lcicgYnkgS3VydCBaZW5pc2VrIEAga3plbmkuY29tCgkgKi8KCShmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewoJICBpZiAodHJ1ZSkgewoJICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtfX3dlYnBhY2tfcmVxdWlyZV9fKDQpXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID0gKGZhY3RvcnkpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9ICh0eXBlb2YgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID09PSAnZnVuY3Rpb24nID8gKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXy5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSkgOiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgkgIH0gZWxzZSB7CgkgICAgZmFjdG9yeShyb290LmpRdWVyeSk7CgkgIH0KCX0pKHRoaXMsIGZ1bmN0aW9uICgkKSB7CgkgICAgdmFyIFNtYXJ0QmFubmVyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKCSAgICAgICAgdGhpcy5vcmlnSHRtbE1hcmdpbiA9IHBhcnNlRmxvYXQoJCgnaHRtbCcpLmNzcygnbWFyZ2luLXRvcCcpKTsgLy8gR2V0IHRoZSBvcmlnaW5hbCBtYXJnaW4tdG9wIG9mIHRoZSBIVE1MIGVsZW1lbnQgc28gd2UgY2FuIHRha2UgdGhhdCBpbnRvIGFjY291bnQKCSAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sICQuc21hcnRiYW5uZXIuZGVmYXVsdHMsIG9wdGlvbnMpOwoKCSAgICAgICAgdmFyIHN0YW5kYWxvbmUgPSBuYXZpZ2F0b3Iuc3RhbmRhbG9uZTsgLy8gQ2hlY2sgaWYgaXQncyBhbHJlYWR5IGEgc3RhbmRhbG9uZSB3ZWIgYXBwIG9yIHJ1bm5pbmcgd2l0aGluIGEgd2VidWkgdmlldyBvZiBhbiBhcHAgKG5vdCBtb2JpbGUgc2FmYXJpKQoJICAgICAgICB2YXIgVUEgPSBuYXZpZ2F0b3IudXNlckFnZW50OwoKCSAgICAgICAgLy8gRGV0ZWN0IGJhbm5lciB0eXBlIChpT1Mgb3IgQW5kcm9pZCkKCSAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5mb3JjZSkgewoJICAgICAgICAgICAgdGhpcy50eXBlID0gdGhpcy5vcHRpb25zLmZvcmNlOwoJICAgICAgICB9IGVsc2UgaWYgKFVBLm1hdGNoKC9XaW5kb3dzIFBob25lL2kpICE9PSBudWxsICYmIFVBLm1hdGNoKC9FZGdlfFRvdWNoL2kpICE9PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnR5cGUgPSAnd2luZG93cyc7CgkgICAgICAgIH0gZWxzZSBpZiAoVUEubWF0Y2goL2lQaG9uZXxpUG9kL2kpICE9PSBudWxsIHx8IChVQS5tYXRjaCgvaVBhZC8pICYmIHRoaXMub3B0aW9ucy5pT1NVbml2ZXJzYWxBcHApKSB7CgkgICAgICAgICAgICBpZiAoVUEubWF0Y2goL1NhZmFyaS9pKSAhPT0gbnVsbCAmJgoJICAgICAgICAgICAgICAgKFVBLm1hdGNoKC9DcmlPUy9pKSAhPT0gbnVsbCB8fAoJICAgICAgICAgICAgICAgd2luZG93Lk51bWJlcihVQS5zdWJzdHIoVUEuaW5kZXhPZignT1MgJykgKyAzLCAzKS5yZXBsYWNlKCdfJywgJy4nKSkgPCA2KSkgdGhpcy50eXBlID0gJ2lvcyc7IC8vIENoZWNrIHdlYnZpZXcgYW5kIG5hdGl2ZSBzbWFydCBiYW5uZXIgc3VwcG9ydCAoaU9TIDYrKQoJICAgICAgICB9IGVsc2UgaWYgKFVBLm1hdGNoKC9cYlNpbGtcLyguKlxiTW9iaWxlIFNhZmFyaVxiKT8vKSB8fCBVQS5tYXRjaCgvXGJLRlx3LykgfHwgVUEubWF0Y2goJ0tpbmRsZSBGaXJlJykpIHsKCSAgICAgICAgICAgIHRoaXMudHlwZSA9ICdraW5kbGUnOwoJICAgICAgICB9IGVsc2UgaWYgKFVBLm1hdGNoKC9BbmRyb2lkL2kpICE9PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnR5cGUgPSAnYW5kcm9pZCc7CgkgICAgICAgIH0KCgkgICAgICAgIC8vIERvbid0IHNob3cgYmFubmVyIGlmIGRldmljZSBpc24ndCBpT1Mgb3IgQW5kcm9pZCwgd2Vic2l0ZSBpcyBsb2FkZWQgaW4gYXBwIG9yIHVzZXIgZGlzbWlzc2VkIGJhbm5lcgoJICAgICAgICBpZiAoIXRoaXMudHlwZSB8fCBzdGFuZGFsb25lIHx8IHRoaXMuZ2V0Q29va2llKCdzYi1jbG9zZWQnKSB8fCB0aGlzLmdldENvb2tpZSgnc2ItaW5zdGFsbGVkJykpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoKCSAgICAgICAgLy8gQ2FsY3VsYXRlIHNjYWxlCgkgICAgICAgIHRoaXMuc2NhbGUgPSB0aGlzLm9wdGlvbnMuc2NhbGUgPT0gJ2F1dG8nID8gJCh3aW5kb3cpLndpZHRoKCkgLyB3aW5kb3cuc2NyZWVuLndpZHRoIDogdGhpcy5vcHRpb25zLnNjYWxlOwoJICAgICAgICBpZiAodGhpcy5zY2FsZSA8IDEpIHRoaXMuc2NhbGUgPSAxOwoKCSAgICAgICAgLy8gR2V0IGluZm8gZnJvbSBtZXRhIGRhdGEKCSAgICAgICAgdmFyIG1ldGEgPSAkKHRoaXMudHlwZSA9PSAnYW5kcm9pZCcgPyAnbWV0YVtuYW1lPSJnb29nbGUtcGxheS1hcHAiXScgOgoJICAgICAgICAgICAgdGhpcy50eXBlID09ICdpb3MnID8gJ21ldGFbbmFtZT0iYXBwbGUtaXR1bmVzLWFwcCJdJyA6CgkgICAgICAgICAgICB0aGlzLnR5cGUgPT0gJ2tpbmRsZScgPyAnbWV0YVtuYW1lPSJraW5kbGUtZmlyZS1hcHAiXScgOiAnbWV0YVtuYW1lPSJtc0FwcGxpY2F0aW9uLUlEIl0nKTsKCSAgICAgICAgaWYgKG1ldGEubGVuZ3RoID09PSAwKSByZXR1cm47CgoJICAgICAgICAvLyBGb3IgV2luZG93cyBTdG9yZSBhcHBzLCBnZXQgdGhlIFBhY2thZ2VGYW1pbHlOYW1lIGZvciBwcm90b2NvbCBsYXVuY2gKCSAgICAgICAgaWYgKHRoaXMudHlwZSA9PSAnd2luZG93cycpIHsKCSAgICAgICAgICAgIHRoaXMuYXBwSWQgPSAkKCdtZXRhW25hbWU9Im1zQXBwbGljYXRpb24tUGFja2FnZUZhbWlseU5hbWUiXScpLmF0dHIoJ2NvbnRlbnQnKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIC8vIFRyeSB0byBwdWxsIHRoZSBhcHBJZCBvdXQgb2YgdGhlIG1ldGEgdGFnIGFuZCBzdG9yZSB0aGUgcmVzdWx0CgkgICAgICAgICAgICB2YXIgcGFyc2VkTWV0YUNvbnRlbnQgPSAvYXBwLWlkPShbXlxzLF0rKS8uZXhlYyhtZXRhLmF0dHIoJ2NvbnRlbnQnKSk7CgoJICAgICAgICAgICAgaWYocGFyc2VkTWV0YUNvbnRlbnQpIHsKCSAgICAgICAgICAgICAgdGhpcy5hcHBJZCA9IHBhcnNlZE1ldGFDb250ZW50WzFdOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICB0aGlzLnRpdGxlID0gdGhpcy5vcHRpb25zLnRpdGxlID8gdGhpcy5vcHRpb25zLnRpdGxlIDogbWV0YS5kYXRhKCd0aXRsZScpIHx8ICQoJ3RpdGxlJykudGV4dCgpLnJlcGxhY2UoL1xzKlt8XC3Ct10uKiQvLCAnJyk7CgkgICAgICAgIHRoaXMuYXV0aG9yID0gdGhpcy5vcHRpb25zLmF1dGhvciA/IHRoaXMub3B0aW9ucy5hdXRob3IgOiBtZXRhLmRhdGEoJ2F1dGhvcicpIHx8ICgkKCdtZXRhW25hbWU9ImF1dGhvciJdJykubGVuZ3RoID8gJCgnbWV0YVtuYW1lPSJhdXRob3IiXScpLmF0dHIoJ2NvbnRlbnQnKSA6IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSk7CgkgICAgICAgIHRoaXMuaWNvblVybCA9IG1ldGEuZGF0YSgnaWNvbi11cmwnKTsKCSAgICAgICAgdGhpcy5wcmljZSA9IG1ldGEuZGF0YSgncHJpY2UnKTsKCgkgICAgICAgIC8vIFNldCBkZWZhdWx0IG9uSW5zdGFsbCBjYWxsYmFjayBpZiBub3Qgc2V0IGluIG9wdGlvbnMKCSAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMub25JbnN0YWxsID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25JbnN0YWxsID0gdGhpcy5vcHRpb25zLm9uSW5zdA==", "base64"));
  res.write(new Buffer("YWxsOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uSW5zdGFsbCA9IGZ1bmN0aW9uICgpIHt9OwoJICAgICAgICB9CgoJICAgICAgICAvLyBTZXQgZGVmYXVsdCBvbkNsb3NlIGNhbGxiYWNrIGlmIG5vdCBzZXQgaW4gb3B0aW9ucwoJICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5vbkNsb3NlID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25DbG9zZSA9IHRoaXMub3B0aW9ucy5vbkNsb3NlOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uQ2xvc2UgPSBmdW5jdGlvbiAoKSB7fTsKCSAgICAgICAgfQoKCSAgICAgICAgLy8gQ3JlYXRlIGJhbm5lcgoJICAgICAgICB0aGlzLmNyZWF0ZSgpOwoJICAgICAgICB0aGlzLnNob3coKTsKCSAgICAgICAgdGhpcy5saXN0ZW4oKTsKCSAgICB9OwoKCSAgICBTbWFydEJhbm5lci5wcm90b3R5cGUgPSB7CgoJICAgICAgICBjb25zdHJ1Y3RvcjogU21hcnRCYW5uZXIKCgkgICAgICAsIGNyZWF0ZTogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgdmFyIGljb25VUkw7CgkgICAgICAgICAgICB2YXIgbGluayA9ICh0aGlzLm9wdGlvbnMudXJsID8gdGhpcy5vcHRpb25zLnVybCA6ICh0aGlzLnR5cGUgPT0gJ3dpbmRvd3MnID8gJ21zLXdpbmRvd3Mtc3RvcmU6bmF2aWdhdGU/YXBwaWQ9JyA6ICh0aGlzLnR5cGUgPT0gJ2FuZHJvaWQnID8gJ21hcmtldDovL2RldGFpbHM/aWQ9JyA6ICh0aGlzLnR5cGUgPT0gJ2tpbmRsZScgPyAnYW16bjovL2FwcHMvYW5kcm9pZD9hc2luPScgOiAnaHR0cHM6Ly9pdHVuZXMuYXBwbGUuY29tLycgKyB0aGlzLm9wdGlvbnMuYXBwU3RvcmVMYW5ndWFnZSArICcvYXBwL2lkJykpKSArIHRoaXMuYXBwSWQpOwoJICAgICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5wcmljZSB8fCB0aGlzLm9wdGlvbnMucHJpY2U7CgkgICAgICAgICAgICB2YXIgaW5TdG9yZSA9IHByaWNlID8gcHJpY2UgKyAnIC0gJyArICh0aGlzLnR5cGUgPT0gJ2FuZHJvaWQnID8gdGhpcy5vcHRpb25zLmluR29vZ2xlUGxheSA6IHRoaXMudHlwZSA9PSAna2luZGxlJyA/IHRoaXMub3B0aW9ucy5pbkFtYXpvbkFwcFN0b3JlIDogdGhpcy50eXBlID09ICdpb3MnID8gdGhpcy5vcHRpb25zLmluQXBwU3RvcmUgOiB0aGlzLm9wdGlvbnMuaW5XaW5kb3dzU3RvcmUpIDogJyc7CgkgICAgICAgICAgICB2YXIgZ2xvc3MgPSB0aGlzLm9wdGlvbnMuaWNvbkdsb3NzID09PSBudWxsID8gKHRoaXMudHlwZT09J2lvcycpIDogdGhpcy5vcHRpb25zLmljb25HbG9zczsKCgkgICAgICAgICAgICBpZiAodGhpcy50eXBlID09ICdhbmRyb2lkJyAmJiB0aGlzLm9wdGlvbnMuR29vZ2xlUGxheVBhcmFtcykgewoJICAgICAgICAgICAgICBsaW5rID0gbGluayArICcmcmVmZXJyZXI9JyArIHRoaXMub3B0aW9ucy5Hb29nbGVQbGF5UGFyYW1zOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIHZhciBiYW5uZXIgPSAnPGRpdiBpZD0ic21hcnRiYW5uZXIiIGNsYXNzPSInICsgdGhpcy50eXBlICsgJyI+PGRpdiBjbGFzcz0ic2ItY29udGFpbmVyIj48YSBocmVmPSIjIiBjbGFzcz0ic2ItY2xvc2UiPiZ0aW1lczs8L2E+PHNwYW4gY2xhc3M9InNiLWljb24iPjwvc3Bhbj48ZGl2IGNsYXNzPSJzYi1pbmZvIj48c3Ryb25nPicgKyB0aGlzLnRpdGxlICsgJzwvc3Ryb25nPjxzcGFuPicgKyB0aGlzLmF1dGhvciArICc8L3NwYW4+PHNwYW4+JyArIGluU3RvcmUgKyAnPC9zcGFuPjwvZGl2PjxhIGhyZWY9IicgKyBsaW5rICsgJyIgY2xhc3M9InNiLWJ1dHRvbiI+PHNwYW4+JyArIHRoaXMub3B0aW9ucy5idXR0b24gKyAnPC9zcGFuPjwvYT48L2Rpdj48L2Rpdj4nOwoJICAgICAgICAgICAgKHRoaXMub3B0aW9ucy5sYXllcikgPyAkKHRoaXMub3B0aW9ucy5hcHBlbmRUb1NlbGVjdG9yKS5hcHBlbmQoYmFubmVyKSA6ICQodGhpcy5vcHRpb25zLmFwcGVuZFRvU2VsZWN0b3IpLnByZXBlbmQoYmFubmVyKTsKCgkgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmljb24pIHsKCSAgICAgICAgICAgICAgICBpY29uVVJMID0gdGhpcy5vcHRpb25zLmljb247CgkgICAgICAgICAgICB9IGVsc2UgaWYodGhpcy5pY29uVXJsKSB7CgkgICAgICAgICAgICAgICAgaWNvblVSTCA9IHRoaXMuaWNvblVybDsKCSAgICAgICAgICAgIH0gZWxzZSBpZiAoJCgnbGlua1tyZWw9ImFwcGxlLXRvdWNoLWljb24tcHJlY29tcG9zZWQiXScpLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICBpY29uVVJMID0gJCgnbGlua1tyZWw9ImFwcGxlLXRvdWNoLWljb24tcHJlY29tcG9zZWQiXScpLmF0dHIoJ2hyZWYnKTsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmljb25HbG9zcyA9PT0gbnVsbCkgZ2xvc3MgPSBmYWxzZTsKCSAgICAgICAgICAgIH0gZWxzZSBpZiAoJCgnbGlua1tyZWw9ImFwcGxlLXRvdWNoLWljb24iXScpLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICBpY29uVVJMID0gJCgnbGlua1tyZWw9ImFwcGxlLXRvdWNoLWljb24iXScpLmF0dHIoJ2hyZWYnKTsKCSAgICAgICAgICAgIH0gZWxzZSBpZiAoJCgnbWV0YVtuYW1lPSJtc0FwcGxpY2F0aW9uLVRpbGVJbWFnZSJdJykubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICBpY29uVVJMID0gJCgnbWV0YVtuYW1lPSJtc0FwcGxpY2F0aW9uLVRpbGVJbWFnZSJdJykuYXR0cignY29udGVudCcpOwoJICAgICAgICAgICAgfSBlbHNlIGlmICgkKCdtZXRhW25hbWU9Im1zYXBwbGljYXRpb24tVGlsZUltYWdlIl0nKS5sZW5ndGggPiAwKSB7IC8qIHJlZHVuZGFudCBiZWNhdXNlIG1zIGRvY3Mgc2hvdyB0d28gY2FzZSB1c2FnZXMgKi8KCSAgICAgICAgICAgICAgaWNvblVSTCA9ICQoJ21ldGFbbmFtZT0ibXNhcHBsaWNhdGlvbi1UaWxlSW1hZ2UiXScpLmF0dHIoJ2NvbnRlbnQnKTsKCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBpZiAoaWNvblVSTCkgewoJICAgICAgICAgICAgICAgICQoJyNzbWFydGJhbm5lciAuc2ItaWNvbicpLmNzcygnYmFja2dyb3VuZC1pbWFnZScsJ3VybCgnICsgaWNvblVSTCArICcpJyk7CgkgICAgICAgICAgICAgICAgaWYgKGdsb3NzKSAkKCcjc21hcnRiYW5uZXIgLnNiLWljb24nKS5hZGRDbGFzcygnZ2xvc3MnKTsKCSAgICAgICAgICAgIH0gZWxzZXsKCSAgICAgICAgICAgICAgICAkKCcjc21hcnRiYW5uZXInKS5hZGRDbGFzcygnbm8taWNvbicpOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIHRoaXMuYmFubmVySGVpZ2h0ID0gJCgnI3NtYXJ0YmFubmVyJykub3V0ZXJIZWlnaHQoKSArIDI7CgoJICAgICAgICAgICAgaWYgKHRoaXMuc2NhbGUgPiAxKSB7CgkgICAgICAgICAgICAgICAgJCgnI3NtYXJ0YmFubmVyJykKCSAgICAgICAgICAgICAgICAgICAgLmNzcygndG9wJywgcGFyc2VGbG9hdCgkKCcjc21hcnRiYW5uZXInKS5jc3MoJ3RvcCcpKSAqIHRoaXMuc2NhbGUpCgkgICAgICAgICAgICAgICAgICAgIC5jc3MoJ2hlaWdodCcsIHBhcnNlRmxvYXQoJCgnI3NtYXJ0YmFubmVyJykuY3NzKCdoZWlnaHQnKSkgKiB0aGlzLnNjYWxlKQoJICAgICAgICAgICAgICAgICAgICAuaGlkZSgpOwoJICAgICAgICAgICAgICAgICQoJyNzbWFydGJhbm5lciAuc2ItY29udGFpbmVyJykKCSAgICAgICAgICAgICAgICAgICAgLmNzcygnLXdlYmtpdC10cmFuc2Zvcm0nLCAnc2NhbGUoJyArIHRoaXMuc2NhbGUgKyAnKScpCgkgICAgICAgICAgICAgICAgICAgIC5jc3MoJy1tc2llLXRyYW5zZm9ybScsICdzY2FsZSgnICsgdGhpcy5zY2FsZSArICcpJykKCSAgICAgICAgICAgICAgICAgICAgLmNzcygnLW1vei10cmFuc2Zvcm0nLCAnc2NhbGUoJyArIHRoaXMuc2NhbGUgKyAnKScpCgkgICAgICAgICAgICAgICAgICAgIC5jc3MoJ3dpZHRoJywgJCh3aW5kb3cpLndpZHRoKCkgLyB0aGlzLnNjYWxlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgICQoJyNzbWFydGJhbm5lcicpLmNzcygncG9zaXRpb24nLCAodGhpcy5vcHRpb25zLmxheWVyKSA/ICdhYnNvbHV0ZScgOiAnc3RhdGljJyk7CgkgICAgICAgIH0KCgkgICAgICAsIGxpc3RlbjogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgJCgnI3NtYXJ0YmFubmVyIC5zYi1jbG9zZScpLm9uKCdjbGljaycsJC5wcm94eSh0aGlzLmNsb3NlLCB0aGlzKSk7CgkgICAgICAgICAgICAkKCcjc21hcnRiYW5uZXIgLnNiLWJ1dHRvbicpLm9uKCdjbGljaycsJC5wcm94eSh0aGlzLmluc3RhbGwsIHRoaXMpKTsKCSAgICAgICAgfQoKCSAgICAgICwgc2hvdzogZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkgICAgICAgICAgICB2YXIgYmFubmVyID0gJCgnI3NtYXJ0YmFubmVyJyk7CgkgICAgICAgICAgICBiYW5uZXIuc3RvcCgpOwoKCSAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubGF5ZXIpIHsKCSAgICAgICAgICAgICAgICBiYW5uZXIuYW5pbWF0ZSh7dG9wOiAwLCBkaXNwbGF5OiAnYmxvY2snfSwgdGhpcy5vcHRpb25zLnNwZWVkSW4pLmFkZENsYXNzKCdzaG93bicpLnNob3coKTsKCSAgICAgICAgICAgICAgICAkKHRoaXMucHVzaFNlbGVjdG9yKS5hbmltYXRlKHtwYWRkaW5nVG9wOiB0aGlzLm9yaWdIdG1sTWFyZ2luICsgKHRoaXMuYmFubmVySGVpZ2h0ICogdGhpcy5zY2FsZSl9LCB0aGlzLm9wdGlvbnMuc3BlZWRJbiwgJ3N3aW5nJywgY2FsbGJhY2spOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICBpZiAoJC5zdXBwb3J0LnRyYW5zaXRpb24pIHsKCSAgICAgICAgICAgICAgICAgICAgYmFubmVyLmFuaW1hdGUoe3RvcDowfSx0aGlzLm9wdGlvbnMuc3BlZWRJbikuYWRkQ2xhc3MoJ3Nob3duJyk7CgkgICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAkKCdodG1sJykucmVtb3ZlQ2xhc3MoJ3NiLWFuaW1hdGlvbicpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfTsKCSAgICAgICAgICAgICAgICAgICAgJCh0aGlzLnB1c2hTZWxlY3RvcikuYWRkQ2xhc3MoJ3NiLWFuaW1hdGlvbicpLm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIHRyYW5zaXRpb25DYWxsYmFjaykuZW11bGF0ZVRyYW5zaXRpb25FbmQodGhpcy5vcHRpb25zLnNwZWVkSW4pLmNzcygnbWFyZ2luLXRvcCcsIHRoaXMub3JpZ0h0bWxNYXJnaW4gKyAodGhpcy5iYW5uZXJIZWlnaHQgKiB0aGlzLnNjYWxlKSk7CgkgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgYmFubmVyLnNsaWRlRG93bih0aGlzLm9wdGlvbnMuc3BlZWRJbikuYWRkQ2xhc3MoJ3Nob3duJyk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgLCBoaWRlOiBmdW5jdGlvbiAoY2FsbGJhY2spIHsKCSAgICAgICAgICAgIHZhciBiYW5uZXIgPSAkKCcjc21hcnRiYW5uZXInKTsKCSAgICAgICAgICAgIGJhbm5lci5zdG9wKCk7CgoJICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5sYXllcikgewoJICAgICAgICAgICAgICAgIGJhbm5lci5hbmltYXRlKHt0b3A6IC0xICogdGhpcy5iYW5uZXJIZWlnaHQgKiB0aGlzLnNjYWxlLCBkaXNwbGF5OiAnYmxvY2snfSwgdGhpcy5vcHRpb25zLnNwZWVkSW4pLnJlbW92ZUNsYXNzKCdzaG93bicpOwoJICAgICAgICAgICAgICAgICQodGhpcy5wdXNoU2VsZWN0b3IpLmFuaW1hdGUoe3BhZGRpbmdUb3A6IHRoaXMub3JpZ0h0bWxNYXJnaW59LCB0aGlzLm9wdGlvbnMuc3BlZWRJbiwgJ3N3aW5nJywgY2FsbGJhY2spOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICBpZiAoJC5zdXBwb3J0LnRyYW5zaXRpb24pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLnR5cGUgIT09ICdhbmRyb2lkJyApCgkgICAgICAgICAgICAgICAgICAgICAgYmFubmVyLmNzcygndG9wJywgLTEgKiB0aGlzLmJhbm5lckhlaWdodCAqIHRoaXMuc2NhbGUpLnJlbW92ZUNsYXNzKCdzaG93bicpOwoJICAgICAgICAgICAgICAgICAgICBlbHNlCgkgICAgICAgICAgICAgICAgICAgICAgYmFubmVyLmNzcyh7ZGlzcGxheTonbm9uZSd9KS5yZW1vdmVDbGFzcygnc2hvd24nKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25DYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICQoJ2h0bWwnKS5yZW1vdmVDbGFzcygnc2ItYW5pbWF0aW9uJyk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9OwoJICAgICAgICAgICAgICAgICAgICAkKHRoaXMucHVzaFNlbGVjdG9yKS5hZGRDbGFzcygnc2ItYW5pbWF0aW9uJykub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgdHJhbnNpdGlvbkNhbGxiYWNrKS5lbXVsYXRlVHJhbnNpdGlvbkVuZCh0aGlzLm9wdGlvbnMuc3BlZWRPdXQpLmNzcygnbWFyZ2luLXRvcCcsIHRoaXMub3JpZ0h0bWxNYXJnaW4pOwoJICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGJhbm5lci5zbGlkZVVwKHRoaXMub3B0aW9ucy5zcGVlZE91dCkucmVtb3ZlQ2xhc3MoJ3Nob3duJyk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgLCBjbG9zZTogZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCSAgICAgICAgICAgIHRoaXMuaGlkZSgpOwoJICAgICAgICAgICAgdGhpcy5zZXRDb29raWUoJ3NiLWNsb3NlZCcsJ3RydWUnLHRoaXMub3B0aW9ucy5kYXlzSGlkZGVuKTsKCSAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkNsb3NlKGUpOwoJICAgICAgICB9CgoJICAgICAgLCBpbnN0YWxsOiBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oaWRlT25JbnN0YWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLnNldENvb2tpZSgnc2ItaW5zdGFsbGVkJywndHJ1ZScsdGhpcy5vcHRpb25zLmRheXNSZW1pbmRlcik7CgkgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25JbnN0YWxsKGUpOwoJICAgICAgICB9CgoJICAgICAgLCBzZXRDb29raWU6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgZXhkYXlzKSB7CgkgICAgICAgICAgICB2YXIgZXhkYXRlID0gbmV3IERhdGUoKTsKCSAgICAgICAgICAgIGV4ZGF0ZS5zZXREYXRlKGV4ZGF0ZS5nZXREYXRlKCkgKyBleGRheXMpOwoJICAgICAgICAgICAgdmFsdWUgPSBlbmNvZGVVUkkodmFsdWUpICsgKChleGRheXMgPT09IG51bGwpID8gJycgOiAnOyBleHBpcmVzPScgKyBleGRhdGUudG9VVENTdHJpbmcoKSk7CgkgICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz0nICsgdmFsdWUgKyAnOyBwYXRoPS87JzsKCSAgICAgICAgfQoKCSAgICAgICwgZ2V0Q29va2llOiBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICAgICAgdmFyIGkseCx5LEFSUmNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoIjsiKTsKCSAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBBUlJjb29raWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICAgICAgeCA9IEFSUmNvb2tpZXNbaV0uc3Vic3RyKDAsQVJSY29va2llc1tpXS5pbmRleE9mKCI9IikpOwoJICAgICAgICAgICAgICAgIHkgPSBBUlJjb29raWVzW2ldLnN1YnN0cihBUlJjb29raWVzW2ldLmluZGV4T2YoIj0iKSArIDEpOwoJICAgICAgICAgICAgICAgIHggPSB4LnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKTsKCSAgICAgICAgICAgICAgICBpZiAoeCA9PSBuYW1lKSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUkkoeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCgkgICAgICAvLyBEZW1vIG9ubHkKCSAgICAgICwgc3dpdGNoVHlwZTogZnVuY3Rpb24gKCkgewoJICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsKCgkgICAgICAgICAgdGhpcy5oaWRlKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgICAgdGhhdC50eXBlID0gdGhhdC50eXBlID09ICdhbmRyb2lkJyA/ICdpb3MnIDogJ2FuZHJvaWQnOwoJICAgICAgICAgICAgICB2YXIgbWV0YSA9ICQodGhhdC50eXBlID09ICdhbmRyb2lkJyA/ICdtZXRhW25hbWU9Imdvb2dsZS1wbGF5LWFwcCJdJyA6ICdtZXRhW25hbWU9ImFwcGxlLWl0dW5lcy1hcHAiXScpLmF0dHIoJ2NvbnRlbnQnKTsKCSAgICAgICAgICAgICAgdGhhdC5hcHBJZCA9IC9hcHAtaWQ9KFteXHMsXSspLy5leGVjKG1ldGEpWzFdOwoKCSAgICAgICAgICAgICAgJCgnI3NtYXJ0YmFubmVyJykuZGV0YWNoKCk7CgkgICAgICAgICAgICAgIHRoYXQuY3JlYXRlKCk7CgkgICAgICAgICAgICAgIHRoYXQuc2hvdygpOwoJICAgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH07CgoJICAgICQuc21hcnRiYW5uZXIgPSBmdW5jdGlvbiAob3B0aW9uKSB7CgkgICAgICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpOwoJICAgICAgICB2YXIgZGF0YSA9ICR3aW5kb3cuZGF0YSgnc21hcnRiYW5uZXInKTsKCSAgICAgICAgdmFyIG9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9uID09ICdvYmplY3QnICYmIG9wdGlvbjsKCSAgICAgICAgaWYgKCFkYXRhKSAkd2luZG93LmRhdGEoJ3NtYXJ0YmFubmVyJywgKGRhdGEgPSBuZXcgU21hcnRCYW5uZXIob3B0aW9ucykpKTsKCSAgICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXSgpOwoJICAgIH07CgoJICAgIC8vIG92ZXJyaWRlIHRoZXNlIGdsb2JhbGx5IGlmIHlvdSBsaWtlICh0aGV5IGFyZSBhbGwgb3B0aW9uYWwpCgkgICAgJC5zbWFydGJhbm5lci5kZWZhdWx0cyA9IHsKCSAgICAgICAgdGl0bGU6IG51bGwsIC8vIFdoYXQgdGhlIHRpdGxlIG9mIHRoZSBhcHAgc2hvdWxkIGJlIGluIHRoZSBiYW5uZXIgKGRlZmF1bHRzIHRvIDx0aXRsZT4pCgkgICAgICAgIGF1dGhvcjogbnVsbCwgLy8gV2hhdCB0aGUgYXV0aG9yIG9mIHRoZSBhcHAgc2hvdWxkIGJlIGluIHRoZSBiYW5uZXIgKGRlZmF1bHRzIHRvIDxtZXRhIG5hbWU9ImF1dGhvciI+IG9yIGhvc3RuYW1lKQoJICAgICAgICBwcmljZTogJ0ZSRUUnLCAvLyBQcmljZSBvZiB0aGUgYXBwCgkgICAgICAgIGFwcFN0b3JlTGFuZ3VhZ2U6ICd1cycsIC8vIExhbmd1YWdlIGNvZGUgZm9yIEFwcCBTdG9yZQoJICAgICAgICBpbkFwcFN0b3JlOiAnT24gdGhlIEFwcCBTdG9yZScsIC8vIFRleHQgb2YgcHJpY2UgZm9yIGlPUwoJICAgICAgICBpbkdvb2dsZVBsYXk6ICdJbiBHb29nbGUgUGxheScsIC8vIFRleHQgb2YgcHJpY2UgZm9yIEFuZHJvaWQKCSAgICAgICAgaW5BbWF6b25BcHBTdG9yZTogJ0luIHRoZSBBbWF6b24gQXBwc3RvcmUnLAoJICAgICAgICBpbldpbmRvd3NTdG9yZTogJ0luIHRoZSBXaW5kb3dzIFN0b3JlJywgLy9UZXh0IG9mIHByaWNlIGZvciBXaW5kb3dzCgkgICAgICAgIEdvb2dsZVBsYXlQYXJhbXM6IG51bGwsIC8vIEFkaXRpb25hbCBwYXJhbWV0ZXJzIGZvciB0aGUgbWFya2V0CgkgICAgICAgIGljb246IG51bGwsIC8vIFRoZSBVUkwgb2YgdGhlIGljb24gKGRlZmF1bHRzIHRvIDxtZXRhIG5hbWU9ImFwcGxlLXRvdWNoLWljb24iPikKCSAgICAgICAgaWNvbkdsb3NzOiBudWxsLCAvLyBGb3JjZSBnbG9zcyBlZmZlY3QgZm9yIGlPUyBldmVuIGZvciBwcmVjb21wb3NlZAoJICAgICAgICBidXR0b246ICdWSUVXJywgLy8gVGV4dCBmb3IgdGhlIGluc3RhbGwgYnV0dG9uCgkgICAgICAgIHVybDogbnVsbCwgLy8gVGhlIFVSTCBmb3IgdGhlIGJ1dHRvbi4gS2VlcCBudWxsIGlmIHlvdSB3YW50IHRoZSBidXR0b24gdG8gbGluayB0byB0aGUgYXBwIHN0b3JlLgoJICAgICAgICBzY2FsZTogJ2F1dG8nLCAvLyBTY2FsZSBiYXNlZCBvbiB2aWV3cG9ydCBzaXplIChzZXQgdG8gMSB0byBkaXNhYmxlKQoJICAgICAgICBzcGVlZEluOiAzMDAsIC8vIFNob3cgYW5pbWF0aW9uIHNwZWVkIG9mIHRoZSBiYW5uZXIKCSAgICAgICAgc3BlZWRPdXQ6IDQwMCwgLy8gQ2xvc2UgYW5pbWF0aW9uIHNwZWVkIG9mIHRoZSBiYW5uZXIKCSAgICAgICAgZGF5c0hpZGRlbjogMTUsIC8vIER1cmF0aW9uIHRvIGhpZGUgdGhlIGJhbm5lciBhZnRlciBiZWluZyBjbG9zZWQgKDAgPSBhbHdheXMgc2hvdyBiYW5uZXIpCgkgICAgICAgIGRheXNSZW1pbmRlcjogOTAsIC8vIER1cmF0aW9uIHRvIGhpZGUgdGhlIGJhbm5lciBhZnRlciAiVklFVyIgaXMgY2xpY2tlZCAqc2VwYXJhdGUgZnJvbSB3aGVuIHRoZSBjbG9zZSBidXR0b24gaXMgY2xpY2tlZCogKDAgPSBhbHdheXMgc2hvdyBiYW5uZXIpCgkgICAgICAgIGZvcmNlOiBudWxsLCAvLyBDaG9vc2UgJ2lvcycsICdhbmRyb2lkJyBvciAnd2luZG93cycuIERvbid0IGRvIGEgYnJvd3NlciBjaGVjaywganVzdCBhbHdheXMgc2hvdyB0aGlzIGJhbm5lcgoJICAgICAgICBoaWRlT25JbnN0YWxsOiB0cnVlLCAvLyBIaWRlIHRoZSBiYW5uZXIgYWZ0ZXIgIlZJRVciIGlzIGNsaWNrZWQuCgkgICAgICAgIGxheWVyOiBmYWxzZSwgLy8gRGlzcGxheSBhcyBvdmVybGF5IGxheWVyIG9yIHNsaWRlIGRvd24gdGhlIHBhZ2UKCSAgICAgICAgaU9TVW5pdmVyc2FsQXBwOiB0cnVlLCAvLyBJZiB0aGUgaU9TIEFwcCBpcyBhIHVuaXZlcnNhbCBhcHAgZm9yIGJvdGggaVBhZCBhbmQgaVBob25lLCBkaXNwbGF5IFNtYXJ0IEJhbm5lciB0byBpUGFkIHVzZXJzLCB0b28uCgkgICAgICAgIGFwcGVuZFRvU2VsZWN0b3I6ICdib2R5JywgLy9BcHBlbmQgdGhlIGJhbm5lciB0byBhIHNwZWNpZmljIHNlbGVjdG9yCgkgICAgICAgIHB1c2hTZWxlY3RvcjogJ2h0bWwnIC8vIFdoYXQgZWxlbWVudCBpcyBnb2luZyB0byBwdXNoIHRoZSBzaXRlIGNvbnRlbnQgZG93bjsgdGhpcyBpcyB3aGVyZSB0aGUgYmFubmVyIGFwcGVuZCBhbmltYXRpb24gd2lsbCBzdGFydC4KCSAgICB9OwoKCSAgICAkLnNtYXJ0YmFubmVyLkNvbnN0cnVjdG9yID0gU21hcnRCYW5uZXI7CgoKCSAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAgICAvLyBCb290c3RyYXAgdHJhbnNpdGlvbgoJICAgIC8vIENvcHlyaWdodCAyMDExLTIwMTQgVHdpdHRlciwgSW5jLgoJICAgIC8vIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpCgoJICAgIGZ1bmN0aW9uIHRyYW5zaXRpb25FbmQgKCkgewoJICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzbWFydGJhbm5lcicpOwoKCSAgICAgICAgdmFyIHRyYW5zRW5kRXZlbnROYW1lcyA9IHsKCSAgICAgICAgICAgIFdlYmtpdFRyYW5zaXRpb246ICd3ZWJraXRUcmFuc2l0aW9uRW5kJywKCSAgICAgICAgICAgIE1velRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJywKCSAgICAgICAgICAgIE9UcmFuc2l0aW9uOiAnb1RyYW5zaXRpb25FbmQgb3RyYW5zaXRpb25lbmQnLAoJICAgICAgICAgICAgdHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnCgkgICAgICAgIH07CgoJICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRyYW5zRW5kRXZlbnROYW1lcykgewoJICAgICAgICAgICAgaWYgKGVsLnN0eWxlW25hbWVdICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4ge2VuZDogdHJhbnNFbmRFdmVudE5hbWVzW25hbWVdfTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBleHBsaWNpdCBmb3IgaWU4ICggIC5fLikKCSAgICB9CgoJICAgIGlmICgkLnN1cHBvcnQudHJhbnNpdGlvbiAhPT0gdW5kZWZpbmVkKQoJICAgICAgICByZXR1cm47IC8vIFByZXZlbnQgY29uZmxpY3Qgd2l0aCBUd2l0dGVyIEJvb3RzdHJhcAoKCSAgICAvLyBodHRwOi8vYmxvZy5hbGV4bWFjY2F3LmNvbS9jc3MtdHJhbnNpdGlvbnMKCSAgICAkLmZuLmVtdWxhdGVUcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gKGR1cmF0aW9uKSB7CgkgICAgICAgIHZhciBjYWxsZWQgPSBmYWxzZSwgJGVsID0gdGhpczsKCSAgICAgICAgJCh0aGlzKS5vbmUoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBjYWxsZWQgPSB0cnVlOwoJICAgICAgICB9KTsKCSAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKCFjYWxsZWQpICQoJGVsKS50cmlnZ2VyKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCk7CgkgICAgICAgIH07CgkgICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIGR1cmF0aW9uKTsKCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCgkgICAgJChmdW5jdGlvbiAoKSB7CgkgICAgICAgICQuc3VwcG9ydC50cmFuc2l0aW9uID0gdHJhbnNpdGlvbkVuZCgpOwoJICAgIH0pOwoJICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCX0pOwoKCi8qKiovIH0KLyoqKioqKi8gXSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW1haW4tbG9naW5wYWdlLnBhY2suanMubWFw", "base64"));
  res.end();

  return __filename;
};
